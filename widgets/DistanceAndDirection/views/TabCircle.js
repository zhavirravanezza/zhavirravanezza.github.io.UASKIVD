// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/DistanceAndDirection/templates/TabCircle.html":'\x3cdiv class\x3d"tabPanel" data-dojo-attach-point\x3d"circleContainer"\x3e\r\n  \x3cdiv class\x3d"controls"\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel\x3e${nls.circleTitle}\x3c/label\x3e\r\n      \x3cdiv class\x3d"controlItem"\x3e\r\n        \x3cselect aria-label\x3d"${nls.circleTitle}" style\x3d"width:100%;" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n          data-dojo-attach-point\x3d"creationType" class\x3d"esriCTDropdownObj"\x3e\r\n          \x3coption value\x3d"Radius" selected\x3d"selected"\x3e${nls.radiusLabel}\x3c/option\x3e\r\n          \x3coption value\x3d"Diameter"\x3e${nls.diameterLabel}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel data-dojo-attach-point\x3d"coordInputLabel"\x3e${nls.centerPointLabel}\x3c/label\x3e\r\n      \x3cdiv class\x3d"controlItem"\x3e\r\n        \x3cdiv class\x3d"jimu-input coordInput" data-dojo-attach-point\x3d"startPointCoords"\r\n          placeholder\x3d"${nls.startPointPlaceHolderLabel}" role\x3d"textbox"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"controlItem paddedLeft"\x3e\r\n          \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n            \x3cspan title\x3d"${nls.formatInputLabel}" class\x3d"jimu-icon settingBtn safariOnly"\r\n              data-dojo-attach-point\x3d"coordinateFormatButton" tabindex\x3d"0" role\x3d"button"\r\n              aria-label\x3d"${nls.formatInputLabel}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n            \x3cdiv title\x3d"${nls.drawCircleLabel}" class\x3d"drawPointBtn" data-dojo-attach-point\x3d"addPointBtn" tabindex\x3d"0"\r\n              role\x3d"button" aria-label\x3d"${nls.drawCircleLabel}"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"controlGroup"\x3e\r\n        \x3cinput aria-label\x3d"${nls.createCircleInteractivelyLabel}" class\x3d"interactive-checkbox esriCTCheckboxObj"\r\n          type\x3d"checkbox" data-dojo-attach-point\x3d"interactiveCircle"\r\n          aria-label\x3d"${nls.createCircleInteractivelyLabel}" /\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"interactiveLabel"\x3e${nls.createCircleInteractivelyLabel}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel data-dojo-attach-point\x3d"radiusDiameterLabel"\x3e${nls.radiusLabel}\x3c/label\x3e\r\n      \x3cdiv class\x3d"controlItem" data-dojo-attach-point\x3d"radiusInputDiv"\x3e\r\n        \x3cinput aria-label\x3d"${nls.radiusLabel}" style\x3d"width: calc(100% - 108px);"\r\n          data-dojo-type\x3d\'dijit/form/NumberTextBox\' required\x3d"true" value\x3d"1000" data-dojo-props\x3d"constraints: {min: 0.001}"\r\n          data-dojo-attach-point\x3d"radiusInput"\x3e\r\n        \x3c/input\x3e\r\n        \x3cselect aria-label\x3d"${nls.radiusLabel}" style\x3d"width: 100px" class\x3d"controlSpace noResize"\r\n          data-dojo-type\x3d"jimu/dijit/formSelect" data-dojo-attach-point\x3d"lengthUnitDD"\x3e\r\n          \x3coption value\x3d"feet"\x3e${nls.units.feet}\x3c/option\x3e\r\n          \x3coption value\x3d"kilometers"\x3e${nls.units.kilometers}\x3c/option\x3e\r\n          \x3coption value\x3d"miles"\x3e${nls.units.miles}\x3c/option\x3e\r\n          \x3coption value\x3d"meters" selected\x3d"selected"\x3e${nls.units.meters}\x3c/option\x3e\r\n          \x3coption value\x3d"nautical-miles"\x3e${nls.units.nauticalMiles}\x3c/option\x3e\r\n          \x3coption value\x3d"yards"\x3e${nls.units.yards}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup" data-dojo-attach-point\x3d\'distCalcControlDiv\'\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d\'distCalcControl\' data-dojo-type\x3d"dijit/TitlePane" data-dojo-props\x3d"open: false"\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n          \x3clabel\x3e${nls.timeLabel}\r\n            \x3clabel\x3e\r\n              \x3cdiv class\x3d"controlItem"\x3e\r\n                \x3cinput aria-label\x3d"${nls.timeLabel}" style\x3d\'width: calc(100% - 108px);\' data-dojo-type\x3d\'dijit/form/NumberTextBox\'\r\n                  required\x3d"true" value\x3d"1" data-dojo-props\x3d"constraints: {min: 1}" data-dojo-attach-point\x3d"timeInput"\x3e\r\n                \x3c/input\x3e\r\n                \x3cselect aria-label\x3d"${nls.timeLabel}" class\x3d"controlSpace noResize"\r\n                  data-dojo-type\x3d"jimu/dijit/formSelect" data-dojo-attach-point\x3d"timeUnitDD"\x3e\r\n                  \x3coption value\x3d"3600"\x3e${nls.hoursLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"60" selected\x3d"selected"\x3e${nls.minutesLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1"\x3e${nls.secondsLabel}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"controlGroup"\x3e\r\n          \x3clabel\x3e${nls.rateLabel}\r\n            \x3clabel\x3e\r\n              \x3cdiv class\x3d"controlItem"\x3e\r\n                \x3cinput aria-label\x3d"${nls.rateLabel}" style\x3d\'width: calc(100% - 108px)\' data-dojo-type\x3d\'dijit/form/NumberTextBox\'\r\n                  required\x3d"true" value\x3d"1" data-dojo-props\x3d"constraints: {min: 1}"\r\n                  data-dojo-attach-point\x3d"distanceInput"\x3e\r\n                \x3c/input\x3e\r\n                \x3cselect aria-label\x3d"${nls.rateLabel}" class\x3d"controlSpace noResize"\r\n                  data-dojo-type\x3d"jimu/dijit/formSelect" data-dojo-attach-point\x3d"distanceUnitDD"\x3e\r\n                  \x3coption value\x3d"0.3048;1"\x3e${nls.feetSecondsLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"0.3048;3600"\x3e${nls.feetHourLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1000;1"\x3e${nls.kmSecondLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1000;3600"\x3e${nls.kmHourLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1;1" selected\x3d"selected"\x3e${nls.metersSecondLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1;3600"\x3e${nls.metersHourLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1609.344;1"\x3e${nls.milesSecondLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1609.344;3600"\x3e${nls.milesHourLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1852;1"\x3e${nls.nauticalMilesSecondLabel}\x3c/option\x3e\r\n                  \x3coption value\x3d"1852;3600"\x3e${nls.nauticalMilesHourLabel}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \r\n    \x3cdiv class\x3d"controlGroup" data-dojo-attach-point\x3d\'symbologyControlDiv\'\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d\'symbolControl\' title\x3d"${nls.symbolAndLabelSettingsLabel}"\r\n        data-dojo-type\x3d"dijit/TitlePane" data-dojo-props\x3d"open: false"\x3e\r\n        \x3cdiv class\x3d"controlGroup" style\x3d"margin-top: 0px;"\x3e\r\n    \r\n          \x3cdiv class\x3d"controlItem esriCTPaddingBottom10"\x3e\r\n            \x3cdiv class\x3d"esriCTLabel"\x3e${nls.symbologyPreviewLabel}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTSymbolNode" tabindex\x3d"0" aria-label\x3d"${nls.symbologyPreviewLabel}" data-dojo-attach-point\x3d"circleSymbolNode"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n    \r\n          \x3cdiv class\x3d"controlItem esriCTPaddingBottom10 esriCTLabelSettings"\x3e\r\n            \x3cdiv class\x3d"esriCTLabel"\x3e${nls.ColorAndSizeLabel}\x3c/div\x3e\r\n            \x3cdiv style\x3d"margin-right:10px;" tabindex\x3d"0" aria-label\x3d"${nls.ColorAndSizeLabel}${nls.colorPickerLabel}"\r\n              data-dojo-attach-point\x3d"labelColorPickerNode"\x3e\x3c/div\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"labelTextSizeSpinner" aria-label\x3d"${nls.ColorAndSizeLabel}"\r\n              data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n              data-dojo-props\x3d\'value:12,smallDelta:1,constraints:{min:1, max:36, places: 0}\' type\x3d"text"\r\n              style\x3d"width: calc(100% - 185px)" required\x3d"true"/\x3e\r\n          \x3c/div\x3e\r\n    \r\n          \x3cdiv class\x3d"esriCTHintCheck"\x3e${nls.editSymbologyHint}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"buttonContainer"\x3e\r\n      \x3cdiv class\x3d\'jimu-btn jimu-state-disabled\' data-dojo-attach-point\x3d\'okButton\' style\x3d"width: 49%;"\r\n        data-dojo-attach-event\x3d"onclick: okButtonClicked" aria-label\x3d"${nls.common.ok}" role\x3d"button"\x3e${nls.common.ok}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d\'jimu-btn\' tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.clearGraphicsLabel}" style\x3d"width: 49%;"\r\n        data-dojo-attach-point\x3d\'clearGraphicsButton\'\x3e${nls.clearGraphicsLabel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/on dojo/topic dojo/has dojo/touch dojo/dom-attr dojo/dom-class dojo/string dojo/mouse dojo/number dojo/keys dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/popup jimu/dijit/Message jimu/LayerInfos/LayerInfos esri/layers/FeatureLayer esri/symbols/SimpleFillSymbol esri/symbols/SimpleMarkerSymbol esri/symbols/TextSymbol esri/graphic esri/geometry/Polyline esri/geometry/Polygon esri/geometry/Point esri/geometry/Circle esri/tasks/FeatureSet ../models/CircleFeedback ../views/CoordinateInput ../views/EditOutputCoordinate dojo/text!../templates/TabCircle.html jimu/utils dijit/focus dojo/_base/event dojo/aspect dojo/dom-construct jimu/symbolUtils ../SymbolChooserPopup ../setting/js/ColorPickerEditor dojo/_base/Color esri/layers/GraphicsLayer dijit/form/NumberSpinner dijit/form/NumberTextBox jimu/dijit/formSelect jimu/dijit/CheckBox dijit/TitlePane".split(" "),
function(u,c,C,e,r,D,E,p,m,F,G,v,f,H,I,J,K,h,w,x,L,y,M,N,z,O,P,Q,R,S,T,U,V,W,q,g,k,X,t,Y,Z,aa,ba,ca){return u([H,I,J],{templateString:W,baseClass:"jimu-widget-TabCircle",_restrictFocusOnAddCenterPointBtn:!1,_centerPointInputKeyPressed:!1,_gl:null,constructor:function(a){u.safeMixin(this,a);this._textGL=this._gl=null},destroy:function(){this._gl&&this.map.removeLayer(this._gl);this._textGL&&this.map.removeLayer(this._textGL);this.tabSwitched()},postCreate:function(){this._centerPointInputKeyPressed=
this._restrictFocusOnAddCenterPointBtn=this.useCalculatedDistance=!1;this.currentLengthUnit=this.lengthUnitDD.get("value");this._circleSym=new y(this.circleSymbol);this._ptSym=new M(this.pointSymbol);this._labelSym=new N(this.labelSymbol);this._textGL=new ca;this.map.addLayer(this.getLayer());this.map.addLayer(this._textGL);this.own(e(this._gl,"visibility-change",c.hitch(this,function(b){this._textGL&&this._textGL.setVisibility(b.visible)})));if(this._gl.loaded){var a=x.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Circle Graphics");
a.showLabels();a.enablePopup()}else this._gl.on("load",c.hitch(this,function(){var b=x.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Circle Graphics");b.showLabels();b.enablePopup()}));this.coordTool=new U({appConfig:this.appConfig,nls:this.nls,"aria-label":this.nls.centerPointLabel},this.startPointCoords);this.coordTool.inputCoordinate.formatType="DD";this.coordinateFormat=new K({content:new V({nls:this.nls}),style:"width: 400px"});X.after(this.coordinateFormat,"onClose",c.hitch(this,
function(){g.focus(this.coordinateFormatButton);if(this._restrictFocusOnAddCenterPointBtn){var b=this.coordTool.getValue();if(""===b||null===b||void 0===b)this._restrictFocusOnAddCenterPointBtn=!1}}));"DartTheme"===this.appConfig.theme.name&&m.add(this.coordinateFormat.domNode,"dartThemeClaroDijitTooltipContainerOverride");this.dt=new T({appConfig:this.appConfig,map:this.map,coordTool:this.coordTool.inputCoordinate.util,nls:this.nls});this.dt.setFillSymbol(this._circleSym);this._createSymbolPicker(this.circleSymbolNode,
"circleSymbol","esriGeometryPolygon",this.nls.circleSymbologyPopupTittle);this.labelColorPicker=this._createColorPicker(this.labelColorPickerNode);this._setColorPicker(this.labelSymbol.color);this.labelTextSizeSpinner.set("value",this.labelSymbol.font.size);this.syncEvents();this.checkValidInputs();this.radiusInput.invalidMessage=this.nls.numericInvalidMessage;this.radiusInput.rangeMessage=this.nls.rangeErrorMessage;this.timeInput.invalidMessage=this.nls.numericInvalidMessage;this.timeInput.rangeMessage=
this.nls.invalidTimeMessage;this.distanceInput.invalidMessage=this.nls.numericInvalidMessage;this.distanceInput.rangeMessage=this.nls.invalidDistanceMessage;this.distCalcControl.set("title",this.nls.distanceCalculatorLabel)},getLayer:function(){if(!this._gl){var a={layerDefinition:{id:"circleLayer",geometryType:"esriGeometryPolygon",objectIdField:"ObjectID",fields:[{name:"ObjectID",alias:"ObjectID",type:"esriFieldTypeOID"},{name:"Label",type:"esriFieldTypeString",alias:"Label"}]},featureSet:new S};
return this._gl=new L(a,{id:"Distance \x26 Direction - Circle Graphics",showLabels:!0,outFields:["*"]})}},syncEvents:function(){r.subscribe("TAB_SWITCHED",c.hitch(this,this.tabSwitched));r.subscribe("DD-WIDGET-CLOSED",c.hitch(this,this._closeDijit));this.distCalcControl.watch("open",c.hitch(this,this.distCalcDidExpand));this.dt.watch("length",c.hitch(this,function(a,b,d){this.circleLengthDidChange(d)}));this.dt.watch("startPoint",c.hitch(this,function(a,b,d){this.dt.addStartGraphic(d,this._ptSym)}));
this.dt.watch("startPointDD",c.hitch(this,function(a,b,d){this.coordTool.inputCoordinate.set("coordinateEsriGeometry",d);this.coordTool.inputCoordinate.set("inputType",this.coordTool.inputCoordinate.formatType)}));this.dt.watch("endPoint",c.hitch(this,function(a,b,d){this.coordTool.inputCoordinate.set("coordinateEsriGeometry",d)}));this.coordTool.inputCoordinate.watch("outputString",c.hitch(this,function(a,b,d){this.coordTool.manualInput||(this.coordTool.set("value",d),this.currentCircle=null,this._restrictFocusOnAddCenterPointBtn?
this._restrictFocusOnAddCenterPointBtn=!1:this._centerPointInputKeyPressed?this._centerPointInputKeyPressed=!1:g.focus(this.addPointBtn))}));this.dt.on("draw-complete",c.hitch(this,this.feedbackDidComplete));this.own(e(this.coordTool,"keydown",c.hitch(this,this.coordToolKeyWasPressed)),this.lengthUnitDD.on("change",c.hitch(this,this.lengthUnitDDDidChange)),this.creationType.on("change",c.hitch(this,this.creationTypeDidChange)),this.distanceUnitDD.on("change",c.hitch(this,this.distanceInputDidChange)),
this.timeUnitDD.on("change",c.hitch(this,this.timeInputDidChange)),e(this.radiusInput,"change",c.hitch(this,function(){this.currentCircle=null})),e(this.coordinateFormatButton,"click",c.hitch(this,this.coordinateFormatButtonWasClicked)),e(this.coordinateFormatButton,"keydown",c.hitch(this,function(a){if(a.keyCode===f.ENTER||a.keyCode===f.SPACE)k.stop(a),this.coordinateFormatButtonWasClicked()})),e(this.addPointBtn,"keydown",c.hitch(this,function(a){if(a.keyCode===f.ENTER||a.keyCode===f.SPACE)k.stop(a),
this.pointButtonWasClicked()})),e(this.timeInput,"change",c.hitch(this,this.timeInputDidChange)),e(this.distanceInput,"change",c.hitch(this,this.distanceInputDidChange)),e(this.distanceInput,"keyup",c.hitch(this,this.distanceInputKeyWasPressed)),e(this.clearGraphicsButton,"click",c.hitch(this,this.clearGraphics)),e(this.clearGraphicsButton,"keydown",c.hitch(this,function(a){if(a.keyCode===f.ENTER||a.keyCode===f.SPACE)k.stop(a),this.clearGraphics()})),e(this.interactiveCircle,"change",c.hitch(this,
this.interactiveCheckBoxChanged)),e(this.interactiveCircle,"keydown",c.hitch(this,function(a){a.keyCode===f.ENTER&&(this.interactiveCircle.checked=this.interactiveCircle.checked?!1:!0,this.interactiveCheckBoxChanged())})),e(this.coordinateFormat.content.applyButton,"click",c.hitch(this,function(){this._restrictFocusOnAddCenterPointBtn=!0;var a=this.coordinateFormat.content.formats[this.coordinateFormat.content.ct],b=a.defaultFormat,d=this.coordinateFormat.content.frmtSelect.get("value");a.useCustom&&
(b=a.customFormat);this.coordTool.inputCoordinate.set("formatPrefix",this.coordinateFormat.content.addSignChkBox.checked);this.coordTool.inputCoordinate.set("formatString",b);this.coordTool.inputCoordinate.set("formatType",d);this.setCoordLabel(d);h.close(this.coordinateFormat);g.focus(this.coordinateFormatButton)})),e(this.coordinateFormat.content.applyButton,"keydown",c.hitch(this,function(a){if(a.keyCode===f.ENTER||a.keyCode===f.SPACE){k.stop(a);this._restrictFocusOnAddCenterPointBtn=!0;var b=
this.coordinateFormat.content.formats[this.coordinateFormat.content.ct],d=b.defaultFormat,l=this.coordinateFormat.content.frmtSelect.get("value");b.useCustom&&(d=b.customFormat);this.coordTool.inputCoordinate.set("formatPrefix",this.coordinateFormat.content.addSignChkBox.checked);this.coordTool.inputCoordinate.set("formatString",d);this.coordTool.inputCoordinate.set("formatType",l);this.setCoordLabel(l);h.close(this.coordinateFormat);g.focus(this.coordinateFormatButton)}a.keyCode===f.ESCAPE&&(k.stop(a),
h.close(this.coordinateFormat),g.focus(this.coordinateFormatButton))})),e(this.coordinateFormat.content.cancelButton,"click",c.hitch(this,function(){h.close(this.coordinateFormat)})),e(this.coordinateFormat.content.cancelButton,"keydown",c.hitch(this,function(a){if(a.keyCode===f.ENTER||a.keyCode===f.SPACE)k.stop(a),h.close(this.coordinateFormat),g.focus(this.coordinateFormatButton);a.keyCode===f.ESCAPE&&(k.stop(a),h.close(this.coordinateFormat),g.focus(this.coordinateFormatButton))})),e(this.coordinateFormat.content.frmtSelect,
"keydown",c.hitch(this,function(a){a.keyCode===f.ESCAPE&&(k.stop(a),h.close(this.coordinateFormat),g.focus(this.coordinateFormatButton))})),e(this.coordinateFormat.content.frmtVal,"keydown",c.hitch(this,function(a){a.keyCode===f.ESCAPE&&(k.stop(a),h.close(this.coordinateFormat),g.focus(this.coordinateFormatButton))})),e(this.coordinateFormat.content.addSignChkBox,"keydown",c.hitch(this,function(a){a.keyCode===f.ESCAPE&&(k.stop(a),h.close(this.coordinateFormat),g.focus(this.coordinateFormatButton));
a.keyCode===f.ENTER&&(k.stop(a),this.coordinateFormat.content.addSignChkBox.checked=this.coordinateFormat.content.addSignChkBox.checked?!1:!0)})),e(this.radiusInputDiv,G.leave,c.hitch(this,this.checkValidInputs)),e(this.okButton,"keydown",c.hitch(this,function(a){if(a.keyCode===f.ENTER||a.keyCode===f.SPACE)k.stop(a),this.okButtonClicked()})));D("esri-touch")?this.own(e(this.addPointBtn,E.press,c.hitch(this,this.pointButtonWasClicked))):this.own(e(this.addPointBtn,"click",c.hitch(this,this.pointButtonWasClicked)));
this.own(e(this.labelColorPicker,"colorChanged",c.hitch(this,function(a){"circle"===a&&(this._labelSym.color=this._getColorPicker())})));this.own(e(this.labelTextSizeSpinner,"change",c.hitch(this,function(){this._labelSym.font.size=this.labelTextSizeSpinner.getValue()})));this.own(e(this.labelColorPickerNode,"keydown",c.hitch(this,function(a){a.keyCode!==f.ENTER&&a.keyCode!==f.SPACE||this.labelColorPicker.colorPicker.domNode.click()})));this.own(e(this.labelTextSizeSpinner,"blur",c.hitch(this,function(){this.labelTextSizeSpinner.isValid()||
this.labelTextSizeSpinner.set("value",this.labelSymbol.font.size)})))},circleLengthDidChange:function(a){var b=v.format(a,{places:2,locale:C.locale});this.radiusInput.set("displayedValue",b);this.radiusInput.set("value",a)},interactiveCheckBoxChanged:function(){this.tabSwitched();this.interactiveCircle.checked?(this.radiusInput.set("disabled",!0),this.distCalcControl.set("open",!1),this.distCalcControl.set("open",!1),this.distCalcControl.set("toggleable",!1)):(this.radiusInput.set("disabled",!1),
this.distCalcControl.set("disabled",!1),this.distCalcControl.set("toggleable",!0));this.checkValidInputs()},coordToolKeyWasPressed:function(a){this.dt.removeStartGraphic();a.keyCode===f.ENTER&&(this._centerPointInputKeyPressed=this._restrictFocusOnAddCenterPointBtn=!0,this.coordTool.inputCoordinate.getInputType().then(c.hitch(this,function(b){"UNKNOWN"===b.inputType?(new w({message:this.nls.invalidCoordinateTypeMessage}),this.coordTool.inputCoordinate.coordinateEsriGeometry=null,this.checkValidInputs()):
this.dt.getProjectedGeometry(b.coordinateEsriGeometry,this.map.spatialReference).then(c.hitch(this,c.hitch(this,function(d){r.publish("manual-circle-center-point-input",d);this.setCoordLabel(b.inputType);this.coordTool.inputCoordinate.set("formatString",this.coordinateFormat.content.formats[b.inputType].defaultFormat);this.coordTool.inputCoordinate.set("formatType",b.inputType);this.dt.addStartGraphic(d,this._ptSym);this.checkValidInputs()})))})))},coordinateFormatButtonWasClicked:function(){this.coordinateFormat.content.set("ct",
this.coordTool.inputCoordinate.formatType);h.open({popup:this.coordinateFormat,around:this.coordinateFormatButton});g.focus(this.coordinateFormat.content.frmtSelect.focusNode)},_closeDijit:function(){this.coordinateFormat&&this.coordinateFormat.domNode.offsetParent&&h.close(this.coordinateFormat)},distCalcDidExpand:function(){this.dt.deactivate();this.dt.cleanup();this.dt.disconnectOnMouseMoveHandler();this.coordTool.inputCoordinate.isManual=!0;this.distCalcControl.get("open")?this.radiusInput.set("disabled",
!0):(this.radiusInput.set("disabled",!1),this.timeInput.set("value",1),this.distanceInput.set("value",1))},timeInputDidChange:function(){this.currentTimeInSeconds=this.timeInput.get("value")*this.timeUnitDD.get("value");this.getCalculatedDistance();this.currentCircle=null},distanceInputKeyWasPressed:function(a){this.distanceInputDidChange();a.keyCode===f.ENTER&&(this.coordTool.inputCoordinate.outputString&&""!==this.coordTool.inputCoordinate.inputString?(this.removeManualGraphic(),this.setGraphic(!0),
this.dt._onDoubleClickHandler()):new w({message:this.nls.noCenterPointSetMessage}))},okButtonClicked:function(){m.contains(this.okButton,"jimu-state-disabled")||(this._restrictFocusOnAddCenterPointBtn=!0,this.removeManualGraphic(),this.currentCircle||this.setGraphic(!0),this.emit("show-publish",this._gl))},distanceInputDidChange:function(){this.currentDistanceInMeters=this.distanceInput.get("value")*this.distanceUnitDD.value.split(";")[0]/this.distanceUnitDD.value.split(";")[1];this.getCalculatedDistance();
this.currentCircle=null},getCalculatedDistance:function(){if(this.currentTimeInSeconds&&0<this.currentTimeInSeconds&&this.currentDistanceInMeters&&0<this.currentDistanceInMeters){this.calculatedRadiusInMeters=this.currentTimeInSeconds*this.currentDistanceInMeters;this.useCalculatedDistance=!0;var a=0;switch(this.currentLengthUnit){case "feet":a=3.2808399*this.calculatedRadiusInMeters;break;case "meters":a=this.calculatedRadiusInMeters;break;case "yards":a=1.0936133*this.calculatedRadiusInMeters;break;
case "kilometers":a=.001*this.calculatedRadiusInMeters;break;case "miles":a=6.21371192E-4*this.calculatedRadiusInMeters;break;case "nautical-miles":a=5.39957E-4*this.calculatedRadiusInMeters}a="Diameter"===this.creationType.get("value")?2*a:a;a=v.format(a,{places:"4"});this.radiusInput.set("value",a)}else this.calculatedRadiusInMeters=null,this.useCalculatedDistance=!0},pointButtonWasClicked:function(){m.contains(this.addPointBtn,"drawPointBtn-active")?(this.dt.deactivate(),this._setMapNavigation(!0)):
(this.coordTool.manualInput=!1,r.publish("clear-points"),this._setMapNavigation(!1),this.dt.set("isDiameter","Diameter"===this.creationType.get("value")),this.distCalcControl.get("open")?this.dt.activate("point"):this.interactiveCircle.checked?this.dt.activate("polyline"):this.dt.activate("point"));m.toggle(this.addPointBtn,"drawPointBtn-active")},lengthUnitDDDidChange:function(){this.currentLengthUnit=this.lengthUnitDD.get("value");this.dt.set("lengthUnit",this.currentLengthUnit);this.distCalcControl.get("open")&&
this.distanceInputDidChange();this.currentCircle=null},creationTypeDidChange:function(){var a="Diameter"===this.creationType.get("value")?this.nls.diameterLabel:this.nls.radiusLabel;this.radiusDiameterLabel.innerHTML=q.sanitizeHTML(a);p.set(this.radiusInput,"aria-label",a);p.set(this.lengthUnitDD,"aria-label",a);this.currentCircle=null},feedbackDidComplete:function(a){if(a.geometry.center){var b=a.geometry.center,d=new Q(a.geometry.rings[0][0][0],a.geometry.rings[0][0][1],a.geometry.center.spatialReference);
a=new O(a.geometry.center.spatialReference);a.addPath([b,d]);this.setGraphic(!1,a);g.focus(this.addPointBtn)}else m.toggle(this.addPointBtn,"drawPointBtn-active"),this._setMapNavigation(!0),this.dt.deactivate(),this.checkValidInputs()},setCoordLabel:function(a){a=q.sanitizeHTML(F.substitute(this.nls.centerPointLabel+" (${crdType})",{crdType:a}));this.coordInputLabel.innerHTML=a;p.set(this.coordTool.textbox,"aria-label",a)},removeManualGraphic:function(){null!==this.tempGraphic&&this._gl.remove(this.tempGraphic);
this.dt.removeStartGraphic()},setGraphic:function(a,b){a||m.toggle(this.addPointBtn,"drawPointBtn-active");this._setMapNavigation(!0);this.dt.deactivate();this.dt.removeStartGraphic();b="Diameter"===this.creationType.get("value")?this.radiusInput.get("value")/2:this.radiusInput.get("value");b=this.coordTool.inputCoordinate.util.convertToMeters(b,this.lengthUnitDD.get("value"));a=this.coordTool.inputCoordinate.coordinateEsriGeometry;b=new R({center:a,radius:b,geodesic:!0,numberOfPoints:360});a=new P(a.spatialReference);
a.addRing(b.rings[0]);this.dt.getProjectedGeometry(a,this.map.spatialReference).then(c.hitch(this,function(d){var l="Diameter"===this.creationType.get("value")?parseFloat(this.radiusInput.get("value"))/2:parseFloat(this.radiusInput.get("value"));var n=window.isRTL?this._getLengthAbbrevation(this.lengthUnitDD.get("value"))+" "+this.radiusInput.get("displayedValue")+" "+this.creationType.get("displayedValue"):this.creationType.get("displayedValue")+" "+this.radiusInput.get("displayedValue")+" "+this._getLengthAbbrevation(this.lengthUnitDD.get("value"));
l=new z(d,this._circleSym,{ObjectID:this._gl.graphics.length+1,Label:n,CenterPoint:this.coordTool.get("value"),RadiusDistance:l,RadiusUnit:this.currentLengthUnit});this._textGL.add(new z(d,c.clone(this._labelSym).setText(n)));this.checkValidInputs();this.map.setExtent(d.getExtent().expand(3));this.currentCircle=l;this._gl.add(l);this._gl.refresh();this.dt.set("startPoint",null)}))},clearGraphics:function(){this._gl&&(this._gl.clear(),this._gl.refresh(),this._textGL.clear(),this.clearUI(!1));this.tabSwitched();
this.checkValidInputs();this.currentCircle=null;for(var a=0;a<this.map.graphicsLayerIds.length;a++)this.map.getLayer(this.map.graphicsLayerIds[a]).refresh()},clearUI:function(a){a||this.coordTool.clear();this.dt.set("startPoint",null);this.useCalculatedDistance=!1;m.remove(this.addPointBtn,"drawPointBtn-active");p.set(this.startPointCoords,"value","");this.radiusInput.set("value",1E3);this.timeInput.set("value",1);this.distanceInput.set("value",1)},setGraphicsHidden:function(){this._gl&&this._gl.hide()},
setGraphicsShown:function(){this._gl&&this._gl.show()},checkValidInputs:function(){m.add(this.okButton,"jimu-state-disabled");p.set(this.okButton,"tabindex",-1);null!==this.coordTool.inputCoordinate.coordinateEsriGeometry&&this.radiusInput.isValid()&&(m.remove(this.okButton,"jimu-state-disabled"),p.set(this.okButton,"tabindex",0));this.okButton.innerHTML=this.interactiveCircle.checked?this.nls.publishDDBtn:this.nls.common.ok},tabSwitched:function(){this.dt&&(this.dt.deactivate(),this.dt.cleanup(),
this.dt.disconnectOnMouseMoveHandler(),this.dt.set("startPoint",null));this._setMapNavigation(!0);this.dt&&this.dt.removeStartGraphic();this.addPointBtn&&m.remove(this.addPointBtn,"drawPointBtn-active");this.coordinateFormat&&h.close(this.coordinateFormat)},_setMapNavigation:function(a){a?this.map.enableMapNavigation():(this.map.disableMapNavigation(),this.map.enableScrollWheelZoom())},_getLengthAbbrevation:function(a){var b=null;if(a)switch(a){case "feet":b=this.nls.abbrevFeetLabel;break;case "kilometers":b=
this.nls.abbrevKmLabel;break;case "miles":b=this.nls.abbrevMilesLabel;break;case "meters":b=this.nls.abbrevMetersLabel;break;case "nautical-miles":b=this.nls.abbrevNauticalMilesLabel;break;case "yards":b=this.nls.abbrevYardsLabel;break;default:b=a}return b},_getDegreeAbbreviation:function(a){var b=null;if(a)switch(a){case "degrees":b=this.nls.abbrevDegreesLabel;break;case "mils":b=this.nls.abbrevMilsLabel;break;default:b=a}return b},_getTimeAbbreviation:function(a){var b=null;if(a)switch(a){case "3600":b=
this.nls.abbrevHoursLabel;break;case "60":b=this.nls.abbrevMinutesLabel;break;case "1":b=this.nls.abbrevSecondsLabel;break;default:b=a}return b},_getRateAbbreviation:function(a){var b=null;if(a)switch(a){case "0.3048;1":b=this.nls.abbrevFeetSecondsLabel;break;case "0.3048;3600":b=this.nls.abbrevFeetHourLabel;break;case "1000;1":b=this.nls.abbrevKmSecondLabel;break;case "1000;3600":b=this.nls.abbrevKmHourLabel;break;case "1;1":b=this.nls.abbrevMetersSecondLabel;break;case "1;3600":b=this.nls.abbrevMetersHourLabel;
break;case "1609.344;1":b=this.nls.abbrevMilesSecondLabel;break;case "1609.344;3600":b=this.nls.abbrevMilesHourLabel;break;case "1852;1":b=this.nls.abbrevNauticalMilesSecondLabel;break;case "1852;3600":b=this.nls.abbrevNauticalMilesHourLabel;break;default:b=a}return b},setFirstFocusNode:function(){q.initFirstFocusNode(this.domNodeObj,this.creationType.domNode)},focusFirstNodeOfSelectedTab:function(){g.focus(this.creationType.focusNode)},setLastFocusNode:function(){q.initLastFocusNode(this.domNodeObj,
this.clearGraphicsButton)},_createSymbolPicker:function(a,b,d,l){if(d){var n={};n.type=q.getSymbolTypeByGeometryType(d);this.hasOwnProperty("_circleSym")&&(n.symbol=this._circleSym);var A={symbolChooserTitle:l,symbolParams:n,nls:this.nls,symbolType:b};this._showSelectedSymbol(a,n.symbol);this.own(e(a,"click",c.hitch(this,function(){n.symbol=this._circleSym;this._initSymbolChooserPopup(A,a)})));this.own(e(a,"keydown",c.hitch(this,function(B){if(B.keyCode===f.ENTER||B.keyCode===f.SPACE)n.symbol=this._circleSym,
this._initSymbolChooserPopup(A,a)})))}},_initSymbolChooserPopup:function(a,b){var d=new Z(a);d.onOkClick=c.hitch(this,function(){var l=d.symbolChooser.getSymbol();this._showSelectedSymbol(b,l);d.popup.close();g.focus(this.circleSymbolNode)})},_showSelectedSymbol:function(a,b){t.empty(a);if(b){var d=Y.createSymbolNode(b);d||(d=t.create("div"));t.place(d,a);this._circleSym=new y(b.toJson());this.dt.setFillSymbol(this._circleSym)}},_createColorPicker:function(a){var b=new aa({nls:this.nls,tab:"circle"});
b.placeAt(a);b.startup();return b},_getColorPicker:function(){return this.labelColorPicker.getValues()},_setColorPicker:function(a){this.labelColorPicker.setValues({color:new ba(a)})}})});