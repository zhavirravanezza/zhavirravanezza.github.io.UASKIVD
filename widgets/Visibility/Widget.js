// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
/*
 jQuery Knob*/
require({cache:{"widgets/Visibility/js/VisibilityControl":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/event dojo/Deferred dojo/_base/lang dojo/_base/array dojo/on dojo/number dojo/string dojo/dom-style dojo/mouse dojo/promise/all dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!../templates/VisibilityControl.html jimu/dijit/Message esri/dijit/util/busyIndicator esri/graphic esri/layers/GraphicsLayer esri/tasks/FeatureSet esri/graphicsUtils esri/symbols/SimpleMarkerSymbol esri/renderers/SimpleRenderer esri/Color esri/dijit/analysis/CreateViewshed esri/layers/FeatureLayer esri/geometry/Polygon esri/geometry/geometryEngine ./geometryUtils jimu/dijit/CoordinateControl ./util jimu/utils dojo/keys dijit/focus ./portal-publish dojo/dom-class dojo/dom-construct esri/renderers/UniqueValueRenderer jimu/LayerStructure ../js/symbologySettings esri/tasks/GeometryService dijit/form/NumberTextBox jimu/dijit/CheckBox ./jquery.knob.min".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da,Q){return H([c,g,p],{templateString:q,baseClass:"jimu-widget-visibility-control",FOV:180,LA:180,map:null,_currentOpenPanel:"mainPage",portalPublishObj:null,_renderer:null,Azimuth1:null,Azimuth2:null,graphics:null,_layerList:null,fillStyles:null,lineStyles:null,constructor:function(K){H.safeMixin(this,K);this.nls=K.nls},postCreate:function(){this.openAtStartAysn=!0;this.fillStyles={esriSFSBackwardDiagonal:"backwarddiagonal",
esriSFSCross:"cross",esriSFSDiagonalCross:"diagonalcross",esriSFSForwardDiagonal:"forwarddiagonal",esriSFSHorizontal:"horizontal",esriSFSNull:"none",esriSFSSolid:"solid",esriSFSVertical:"vertical"};this.lineStyles={esriSLSDash:"dash",esriSLSDashDot:"dashdot",esriSLSDashDotDot:"longdashdotdot",esriSLSDot:"dot",esriSLSLongDash:"longdash",esriSLSLongDashDot:"longdashdot",esriSLSNull:"none",esriSLSShortDash:"shortdash",esriSLSShortDashDot:"shortdashdot",esriSLSShortDashDotDot:"shortdashdotdot",esriSLSShortDot:"shortdot",
esriSLSSolid:"solid"};var K=[],E;k.forEach("meters kilometers miles feet yards nauticalMiles".split(" "),l.hitch(this,function(I){E={value:I,label:window.jimuNls.units[I]};K.push(E)}));this.observerHeightDD.addOption(K);this.utils=new T({appConfig:this.appConfig,nls:this.nls});this.distanceUnitDD.addOption(l.clone(K));this.config.hasOwnProperty("observeHeight")&&this.observerHeight.setValue(this.config.observeHeight);this.config.hasOwnProperty("minimumObservableDistanceValue")&&this.minObsRange.setValue(this.config.minimumObservableDistanceValue);
this.config.hasOwnProperty("maximumObservableDistanceValue")&&this.maxObsRange.setValue(this.config.maximumObservableDistanceValue);this.observerHeightDD.set("value",this.config.defaultObserverHeightUnit);this.distanceUnitDD.set("value",this.config.defaultObservableDistanceUnit);this.angleUnits.setValue(this.config.defaultAngleUnits);if(this.portalUrl){this._initGL();this._createSettings();this._layerList=this._getAllMapLayers();this._ptSym=new F(this.pointSymbol);var N=new x(this._ptSym);this._observerLocation=
new y({id:"observerLocation"});this._observerLocation.spatialReference=this.map.spatialReference;this._observerLocation.setRenderer(N);this.map.addLayer(this._observerLocation);this.distanceUnit=this.distanceUnitDD.get("value");this.observerHeightUnit=this.observerHeightDD.get("value");this.inputControl=new R({parentWidget:this.parentWidget,label:this.nls.observerLocation,input:!0,showCopyButton:!1,showFormatButton:!0,showDrawPoint:!0,drawButtonLabel:this.nls.addPointToolTip,graphicsLayer:this._observerLocation});
this.inputControl.placeAt(this.observerCoordsContainer);this.inputControl.startup();this._syncEvents();this.minObsRange.invalidMessage=this.nls.invalidMessage;this.minObsRange.rangeMessage=this.nls.minimumRangeMessage;this.maxObsRange.invalidMessage=this.nls.invalidMessage;this.maxObsRange.rangeMessage=this.nls.maximumRangeMessage;this.observerHeight.invalidMessage=this.nls.invalidMessage;this.observerHeight.rangeMessage=this.nls.observerRangeMessage}else this._showPortalURLError(this.nls.portalURLError);
this.resetInputColor();setTimeout(l.hitch(this,function(){this._suppoprtAccessibility()}),100)},startup:function(){this.busyIndicator=v.create({target:this.domNode.parentNode.parentNode.parentNode,backgroundOpacity:0});this.FOVInput.id="fovinput"+this.parentWidget.id;var K=l.hitch(this,function(E,N,I){this.LA=this.angleUnits.checked?E/17.777777777778:E;this.FOV=Math.round(N);this.tooltip.innerHTML=this.angleUnits.checked?$("#"+this.FOVInput.id).val()+" "+this.nls.milsLabel:I+" "+this.nls.degreesLabel});
$("#"+this.FOVInput.id).knob({min:0,max:360,cursor:360,width:160,height:160,draw:function(){K(this.v,this.o.cursor,this.cv);window.isRTL&&this.i.css({"margin-right":"-"+(3*this.w/4+2>>0)+"px","margin-left":"auto"})}})},destroy:function(){this.map.removeLayer(this._observerLocation);this.map.removeLayer(this.graphicsLayer)},_showPortalURLError:function(K){f.set(this.controls,"display","none");f.set(this.buttonContainer,"display","none");this.errorText.innerHTML=K;f.set(this.errorText,"display","")},
_initGL:function(){this.graphicsLayer=new y;this.graphicsLayer.name="Viewshed Layer";this.map.addLayer(this.graphicsLayer)},_syncEvents:function(){this.own(b(this.btnCreate,"click",l.hitch(this,this.createButtonWasClicked)),b(this.btnCreate,"keydown",l.hitch(this,function(K){K.keyCode!==ca.ENTER&&K.keyCode!==ca.SPACE||this.createButtonWasClicked()})),b(this.btnClear,"click",l.hitch(this,function(){oa.add(this.saveToLayerIcon,"esriCTHidden");this.onClearBtnClicked();this._suppoprtAccessibility()})),
b(this.btnClear,"keydown",l.hitch(this,function(K){if(K.keyCode===ca.ENTER||K.keyCode===ca.SPACE)oa.add(this.saveToLayerIcon,"esriCTHidden"),this.onClearBtnClicked(),this._suppoprtAccessibility()})),b(this.minObsRange,"change",l.hitch(this,this.minObsRangeKeyWasPressed)),b(this.FOVInput,"mousemove",l.hitch(this,this.mouseMoveOverFOVInput)),b(this.FOVInput,e.leave,l.hitch(this,this.mouseMoveOutFOVInput)),b(this.FOVGroup,e.leave,l.hitch(this,function(){this.tooltip.hidden=!0})),b(this.FOVGroup,e.enter,
l.hitch(this,this.mouseMoveOverFOVGroup)),b(this.FOVInput,e.enter,l.hitch(this,function(){this.tooltip.hidden=!0})),b(this.FOVInput,"keypress",l.hitch(this,function(K){isNaN(K.key)&&13!==K.charCode&&n.stop(K)})),this.angleUnits.on("change",l.hitch(this,this.angleUnitsDidChange)),this.observerHeightDD.on("change",l.hitch(this,this.distanceUnitDDDidChange)),this.distanceUnitDD.on("change",l.hitch(this,this.distanceUnitDDDidChange)),b(this.inputControl.dt,"DrawComplete",l.hitch(this,function(){this.feedbackDidComplete();
ba.focus(this.inputControl.coordtext)})),b(this.inputControl,"get-coordinate-complete",l.hitch(this,this.feedbackDidComplete)),b(this.saveToLayerIcon,"click",l.hitch(this,function(){oa.contains(this.saveToLayerIcon,"esriCTHidden")||this._showPanel("publishPage")})),b(this.saveToLayerIcon,"keydown",l.hitch(this,function(K){if(K.keyCode===ca.ENTER||K.keyCode===ca.SPACE)oa.contains(this.saveToLayerIcon,"esriCTHidden")||this._showPanel("publishPage")})),b(this.settingsIcon,"click",l.hitch(this,function(){oa.contains(this.settingsIcon,
"esriCTHidden")||this._showPanel("settingsPage")})),b(this.settingsIcon,"keydown",l.hitch(this,function(K){if(K.keyCode===ca.ENTER||K.keyCode===ca.SPACE)oa.contains(this.settingsIcon,"esriCTHidden")||this._showPanel("settingsPage")})),b(this.settingsPanelBackButton,"click",l.hitch(this,function(){oa.contains(this.settingsPanelBackButton,"esriCTHidden")||(this._SettingsInstance.onSettingsChanged(),this._showPanel("mainPage"))})),b(this.settingsPanelBackButton,"keydown",l.hitch(this,function(K){K.keyCode!==
ca.ENTER&&K.keyCode!==ca.SPACE||oa.contains(this.settingsPanelBackButton,"esriCTHidden")||(this._SettingsInstance.onSettingsChanged(),this._showPanel("mainPage"))})))},minObsRangeKeyWasPressed:function(){this.minObsRange.isValid()&&(this.maxObsRange.constraints.min=Number(this.minObsRange.value)+.001,this.maxObsRange.set("value",this.maxObsRange.value&&this.maxObsRange.value>this.minObsRange.value?this.maxObsRange.value:Number(this.minObsRange.value)+1))},mouseMoveOverFOVGroup:function(){!1===this.FOVInput.disabled&&
(this.mouseMoveOverFOVInput(),this.tooltip.hidden=!1)},mouseMoveOverFOVInput:function(){var K=this.tooltip;!1===this.FOVInput.disabled&&$(document).ready(function(){$(document).mousemove(function(E){f.set(K,{left:E.pageX+10+"px",top:E.pageY+10+"px"})})})},mouseMoveOutFOVInput:function(){this.tooltip.hidden=!1;this.FOVInput.blur()},angleUnitsDidChange:function(){this.angleUnits.checked?($("#"+this.FOVInput.id).trigger("configure",{max:6400,units:"mils",milsValue:6400}),$("#"+this.FOVInput.id).val(6400).trigger("change")):
($("#"+this.FOVInput.id).trigger("configure",{max:360,units:"degrees",milsValue:6400}),$("#"+this.FOVInput.id).val(360).trigger("change"));this.resetInputColor()},distanceUnitDDDidChange:function(){var K="",E={};this.distanceUnit=this.distanceUnitDD.get("value");this.observerHeightUnit=this.observerHeightDD.get("value");if(this.distanceUnit){switch(this.distanceUnit){case "miles":E.max=31;break;case "nauticalMiles":E.max=26.9383;break;case "kilometers":E.max=50;break;case "yards":E.max=54680;break;
case "feet":E.max=164041;break;case "meters":E.max=5E4}K=d.substitute(this.nls.maximumRangeMessage,{units:window.jimuNls.units[this.distanceUnit],limit:a.format(E.max,{places:2,locale:m.locale})});E.min=Number(this.minObsRange.value)+.001;this.maxObsRange.set("constraints",E);this.maxObsRange.set("rangeMessage",K)}},feedbackDidComplete:function(){this.inputControl.deactivateDrawTool();this.map.enableMapNavigation();this.enableFOVDial()},enableFOVDial:function(){this.FOVInput.disabled&&(this.FOVInput.disabled=
!1,$("#"+this.FOVInput.id).trigger("configure",{fgColor:"#00ff66",bgColor:"#f37371",inputColor:"#ccc"}));this.resetInputColor()},_createWedgesUsingBuffers:function(K,E,N,I){E=B.getGeometries(E);I=J.geodesicBuffer(E,[I],"meters",!0);0<N?(N=J.geodesicBuffer(E,[N],"meters",!0),I=J.difference(I[0],N[0])):I=I[0];K.resolve([I,I])},_createWedgesUsingAngles:function(K,E,N,I,O,U){E=E.geometry;var ha=[];var ia=[];this.Azimuth1=N>I?N-360:N;U=L.getPointsForArc(N,I,E,U);ia.push([E.x,E.y]);k.forEach(U,function(W){ia.push([W.x,
W.y])});ia.push([E.x,E.y]);if(0<O){var S=L.getDestinationPoint(E,N,O);N=L.getPointsForArc(N,I,E,O);ha.push([S.x,S.y]);k.forEach(U,function(W){ha.push([W.x,W.y])});N.reverse();k.forEach(N,function(W){ha.push([W.x,W.y])});ha.push([S.x,S.y])}else ha=ia;N=new G(ha);N.setSpatialReference(E.spatialReference);I=new G(ia);I.setSpatialReference(E.spatialReference);K.resolve([N,I])},_createWedges:function(K,E,N){var I=new r;this.Azimuth1=parseInt(this.LA-this.FOV/2,10);0>this.Azimuth1&&(this.Azimuth1+=360);
this.Azimuth2=parseInt(this.LA+this.FOV/2,10);360<this.Azimuth2&&(this.Azimuth2-=360);360===this.FOV?(this.Azimuth1=0,this.Azimuth2=360,this._createWedgesUsingBuffers(I,K,E,N)):this._createWedgesUsingAngles(I,K[0],this.Azimuth1,this.Azimuth2,E,N);return I.promise},_getFeatureCollectionLayer:function(K){k.forEach(K,l.hitch(this,function(E,N){E.attributes={};E.attributes.ObjectID=N}));return new z({featureSet:{features:K,geometryType:"esriGeometryPoint"},layerDefinition:{name:"InputLayer",geometryType:"esriGeometryPoint",
objectIdField:"ObjectID",fields:[{name:"ObjectID",alias:"ObjectID",type:"esriFieldTypeOID"}]}})},_initAnalysisProcess:function(K){this._createWedges(K.InputObserver.features,K.MinimumRadius,K.MaximumRadius).then(l.hitch(this,function(E){var N=[];if(E&&2===E.length){var I=this.appConfig.geometryService;var O=new Q(I);I=L.getProjectedGeometry(E[0],this.map.spatialReference,O).then(l.hitch(this,function(U){this._wedgeGeometry=U}));N.push(I);E=L.getProjectedGeometry(E[1],this.map.spatialReference,O).then(l.hitch(this,
function(U){this._fullWedgeGeometry=U}));N.push(E);h(N).then(l.hitch(this,function(){this._createViewShed(K)}))}}))},_createViewShed:function(K){K={portalUrl:this.portalUrl,inputLayer:this._getFeatureCollectionLayer(K.InputObserver.features),maxDistanceUnits:"Meters",maximumDistance:K.MaximumRadius,observerHeightUnits:"Meters",observerHeight:K.ObserverHeight,showSelectAnalysisLayer:!1,targetHeightUnits:"Meters",map:this.map,showChooseExtent:!1,returnFeatureCollection:!0};K=new A(K);K.startup();K.on("job-result",
l.hitch(this,this._onViewShedCreated));K.on("job-status",l.hitch(this,function(E){"esriJobFailed"===E.jobStatus&&this._showJobError(E)}));K.on("job-fail",l.hitch(this,this._showJobError));K._form.validate()?(this.busyIndicator.show(),K._handleSaveBtnClick()):new u({message:this.nls.validationError})},_showJobError:function(K){new u({message:K.message});this.busyIndicator.hide()},_onViewShedCreated:function(K){var E=[];k.forEach(K.value.featureSet.features,l.hitch(this,function(N){N=new G(N.geometry);
N.setSpatialReference(this.map.spatialReference);(N=J.difference(this._wedgeGeometry,N))&&(N=J.difference(this._wedgeGeometry,N));N=new t(N);N.setAttributes({type:1});E.push(N)}));this._showGraphicsOnMap(E)},_drawWedge:function(K,E){for(var N=new r,I=0,O=K.length;I<O;I++){var U=K[I];U&&U.geometry&&(E?U.setAttributes({type:2}):U.setAttributes({type:3}),this.graphicsLayer.add(U))}N.resolve("success");return N.promise},_drawViewshed:function(K){var E=new r;this.graphics=[];var N=new t(this._wedgeGeometry);
N.setAttributes({type:0,regionType:"nonVisible"});for(var I=0,O=K.length;I<O;I++){var U=K[I];if(U&&U.geometry){var ha=U.geometry;U.setAttributes({type:1,regionType:"visible"});var ia=U;this.graphicsLayer.add(U)}}ha&&(this.graphics.push(ia),K=J.difference(this._wedgeGeometry,ha),N=new t(K),N.setAttributes({type:0,regionType:"nonVisible"}));this.graphics.push(N);this.graphicsLayer.add(N);E.resolve("success");return E.promise},_showGraphicsOnMap:function(K){this._drawWedge([new t(this._fullWedgeGeometry)],
!0);this._drawWedge([new t(this._wedgeGeometry)],!1);this._drawViewshed(K).then(l.hitch(this,function(){this.map.setExtent(B.graphicsExtent(this.graphicsLayer.graphics),!0);oa.remove(this.saveToLayerIcon,"esriCTHidden");this.busyIndicator.hide();this._createPortalPublishUI();this._suppoprtAccessibility()}))},createButtonWasClicked:function(){if(this.inputControl.getMapCoordinateDD()&&this.minObsRange.isValid()&&this.maxObsRange.isValid()&&this.observerHeight.isValid()&&0!==parseInt(this.FOVInput.value,
10)&&!isNaN(parseInt(this.FOVInput.value,10))){var K=new t(this.inputControl.getMapCoordinateDD()),E=new C;E.features=[K];K={InputObserver:E,MinimumRadius:this.utils.convertToMeters(this.minObsRange.value,this.distanceUnit),MaximumRadius:this.utils.convertToMeters(this.maxObsRange.value,this.distanceUnit),ObserverHeight:this.utils.convertToMeters(this.observerHeight.value,this.observerHeightUnit)};this._initAnalysisProcess(K)}else new u({message:this.nls.validationError})},onClearBtnClicked:function(){this.angleUnits&&
(this.angleUnits.setValue(this.config.defaultAngleUnits),this.observerHeightDD.set("value",this.config.defaultObserverHeightUnit),this.distanceUnitDD.set("value",this.config.defaultObservableDistanceUnit),this.config.hasOwnProperty("observeHeight")&&this.observerHeight.setValue(this.config.observeHeight),this.config.hasOwnProperty("minimumObservableDistanceValue")&&this.minObsRange.setValue(this.config.minimumObservableDistanceValue),this.config.hasOwnProperty("maximumObservableDistanceValue")&&setTimeout(l.hitch(this,
function(){this.maxObsRange.setValue(this.config.maximumObservableDistanceValue)}),100),this.minObsRangeKeyWasPressed(),this.graphicsLayer.clear(),this.inputControl.clear(),this.FOVInput.disabled=!0,this.angleUnitsDidChange(),$("#"+this.FOVInput.id).trigger("configure",{fgColor:"#ccc",bgColor:"#ccc",inputColor:"#ccc"}),this.tooltip.hidden=!0,this.resetInputColor())},resetInputColor:function(){setTimeout(l.hitch(this,function(){f.set(this.FOVInput,"color","gray")}),100)},_suppoprtAccessibility:function(){"mainPage"===
this._currentOpenPanel&&(aa.initFirstFocusNode(this.parentWidget.domNode,this.settingsIcon),aa.isAutoFocusFirstNodeWidget(this)&&ba.focus(this.settingsIcon),aa.initLastFocusNode(this.parentWidget.domNode,this.btnClear));"publishPage"===this._currentOpenPanel&&this.portalPublishObj._setFirstLastFocusNodes();"settingsPage"===this._currentOpenPanel&&(aa.initFirstFocusNode(this.parentWidget.domNode,this.settingsPanelBackButton),this._SettingsInstance._setLastFocusNode())},_createPortalPublishUI:function(){this.portalPublishObj=
new la({config:this.config,appConfig:this.appConfig,graphicsLayer:this.graphicsLayer,graphics:this.graphics,_renderer:this._renderer,map:this.map,nls:this.nls,parentNode:this.parentWidget.domNode,observerHeight:this.observerHeight.value,minObsRange:this.minObsRange.value,maxObsRange:this.maxObsRange.value,distanceUnitDD:this.distanceUnitDD.getOptions(this.distanceUnitDD.value).label,observerHeightDD:this.observerHeightDD.getOptions(this.observerHeightDD.value).label,angleUnits:this.nls.degreesLabel,
centerPoint:this.inputControl.coordtext.value,fovStartAngle:this.Azimuth1,fovEndAngle:this.Azimuth2,_layerList:this._layerList});fa.empty(this.portalPublishContainer);this.portalPublishObj.placeAt(this.portalPublishContainer);this.portalPublishObj.startup();this.own(b(this.portalPublishObj,"displayMainPageOnBack",l.hitch(this,function(){this._showPanel("mainPage")})));this._showPanel("publishPage")},_showPanel:function(K){if(this._currentOpenPanel){var E=this._getNodeByName(this._currentOpenPanel);
oa.add(E,"esriCTHidden")}E=this._getNodeByName(K);oa.remove(E,"esriCTHidden");this._lastOpenPanel=this._currentOpenPanel;this._currentOpenPanel=K;this._suppoprtAccessibility()},_getNodeByName:function(K){switch(K){case "mainPage":var E=this.visibiltyWidget;break;case "publishPage":E=this.portalPublishContainer;break;case "settingsPage":E=this.settingsContainer}return E},_createRendererForPublishLayer:function(K){var E=new w(K.visibleSectionFillColor.color),N=255*(1-K.visibleSectionFillColor.transparency),
I=new w(K.visibleSectionOutlineColor.color),O=255*(1-K.visibleSectionOutlineColor.transparency),U=new w(K.nonVisibleSectionFillColor.color),ha=255*(1-K.nonVisibleSectionFillColor.transparency),ia=new w(K.nonVisibleSectionOutlineColor.color);this._renderer=new M({type:"uniqueValue",field1:"RegionType",uniqueValueInfos:[{value:1,symbol:{color:[E.r,E.g,E.b,N],outline:{color:[I.r,I.g,I.b,O],width:.75,type:"esriSLS",style:K.visibleSectionOutlineColor.type},type:"esriSFS",style:K.visibleSectionFillColor.type}},
{value:0,symbol:{color:[U.r,U.g,U.b,ha],outline:{color:[ia.r,ia.g,ia.b,255*(1-K.nonVisibleSectionOutlineColor.transparency)],width:1,type:"esriSLS",style:K.nonVisibleSectionOutlineColor.type},type:"esriSFS",style:K.nonVisibleSectionFillColor.type}}]});this._renderer.removeValue("others")},_createRendererForGraphicsLayer:function(K){var E=new w(K.visibleSectionFillColor.color),N=255*(1-K.visibleSectionFillColor.transparency),I=new w(K.visibleSectionOutlineColor.color),O=255*(1-K.visibleSectionOutlineColor.transparency),
U=new w(K.nonVisibleSectionFillColor.color),ha=255*(1-K.nonVisibleSectionFillColor.transparency),ia=new w(K.nonVisibleSectionOutlineColor.color);K=new M({type:"uniqueValue",field1:"type",uniqueValueInfos:[{value:1,symbol:{color:[E.r,E.g,E.b,N],outline:{color:[I.r,I.g,I.b,O],width:.75,type:"esriSLS",style:K.visibleSectionOutlineColor.type},type:"esriSFS",style:K.visibleSectionFillColor.type}},{value:0,symbol:{color:[U.r,U.g,U.b,ha],outline:{color:[ia.r,ia.g,ia.b,255*(1-K.nonVisibleSectionOutlineColor.transparency)],
width:1,type:"esriSLS",style:K.nonVisibleSectionOutlineColor.type},type:"esriSFS",style:K.nonVisibleSectionFillColor.type}},{value:2,symbol:{color:[0,0,0,0],outline:{color:[0,0,0,1],width:1,type:"esriSLS",style:"esriSLSDash"},type:"esriSFS",style:"esriSFSSolid"}},{value:3,symbol:{color:[0,0,0,0],outline:{color:[255,0,0,1],width:1,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}]});K.removeValue("others");this.graphicsLayer.setRenderer(K);this.graphicsLayer.refresh()},_getAllMapLayers:function(){var K=
[];X.getInstance().traversal(function(E){"undefined"!==typeof E._layerInfo.layerObject.type&&-1===E._layerInfo.layerObject.type.indexOf("tile")&&"esriGeometryPolygon"===E._layerInfo.layerObject.geometryType&&K.push(E._layerInfo.layerObject)});return K},_createSettings:function(){this._SettingsInstance=new da({nls:this.nls,config:this.config,appConfig:this.appConfig,refDomNode:this.parentWidget.domNode},fa.create("div",{},this.symbologySettingsNode));this.own(this._SettingsInstance.on("settingsChanged",
l.hitch(this,function(K){this._createRendererForPublishLayer(K);this._createRendererForGraphicsLayer(K)})));this._SettingsInstance.startup()}})})},"esri/dijit/util/busyIndicator":function(){define("dijit/registry dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-construct dojox/widget/Standby require".split(" "),function(H,m,n,r,l,k,b){var a={_defaultStandbyParams:{image:b.toUrl("../images/loading-throb.gif"),color:"#fff",opacity:.75,duration:200},create:function(d){if(d=this._normalizeParams(d))return d=
new k(a._toStandbyParams(d)),l.place(d.domNode,n.doc.body),a._createHandle(d)},_normalizeParams:function(d){if(d){if(d.target)return d;if("string"===typeof d){var f=H.byId(d);d=f?f.domNode:r.byId(d)}else d=d.domNode?d.domNode:r.byId(d);if(d)return{target:d}}},_toStandbyParams:function(d){d.imageUrl&&(d.image=d.imageUrl);d.backgroundColor&&(d.color=d.backgroundColor);d.backgroundOpacity&&(d.opacity=d.backgroundOpacity);d.fadeDuration&&(d.duration=d.fadeDuration);return m.mixin({},a._defaultStandbyParams,
d)},_createHandle:function(d){return{show:function(){d&&d.show()},hide:function(){d&&d.hide()},destroy:function(){d&&(d.destroy(),d=null)}}}};return a})},"dojox/widget/Standby":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/event dojo/_base/sniff dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/window dojo/_base/window dojo/_base/fx dojo/fx dijit/_Widget dijit/_TemplatedMixin dijit/registry".split(" "),function(H,m,n,r,l,k,b,a,d,
f,e,h,c,g,p,q,u){H.experimental("dojox.widget.Standby");return m("dojox.widget.Standby",[p,q],{image:require.toUrl("dojox/widget/Standby/images/loading.gif").toString(),imageText:"Please Wait...",text:"Please wait...",centerIndicator:"image",target:"",color:"#C0C0C0",duration:500,zIndex:"auto",opacity:.75,templateString:'\x3cdiv\x3e\x3cdiv style\x3d"display: none; opacity: 0; z-index: 9999; position: absolute; cursor:wait;" dojoAttachPoint\x3d"_underlayNode"\x3e\x3c/div\x3e\x3cimg src\x3d"${image}" style\x3d"opacity: 0; display: none; z-index: -10000; position: absolute; top: 0px; left: 0px; cursor:wait;" dojoAttachPoint\x3d"_imageNode"\x3e\x3cdiv style\x3d"opacity: 0; display: none; z-index: -10000; position: absolute; top: 0px;" dojoAttachPoint\x3d"_textNode"\x3e\x3c/div\x3e\x3c/div\x3e',
_underlayNode:null,_imageNode:null,_textNode:null,_centerNode:null,_displayed:!1,_resizeCheck:null,_started:!1,_parent:null,startup:function(v){if(!this._started){if("string"===typeof this.target){var t=u.byId(this.target);this.target=t?t.domNode:k.byId(this.target)}this.text&&(this._textNode.innerHTML=this.text);"image"===this.centerIndicator?(this._centerNode=this._imageNode,b.set(this._imageNode,"src",this.image),b.set(this._imageNode,"alt",this.imageText)):this._centerNode=this._textNode;f.set(this._underlayNode,
{display:"none",backgroundColor:this.color});f.set(this._centerNode,"display","none");this.connect(this._underlayNode,"onclick","_ignore");this.domNode.parentNode&&this.domNode.parentNode!=h.body()&&h.body().appendChild(this.domNode);7==l("ie")&&(this._ieFixNode=a.create("div"),f.set(this._ieFixNode,{opacity:"0",zIndex:"-1000",position:"absolute",top:"-1000px"}),h.body().appendChild(this._ieFixNode));this.inherited(arguments)}},show:function(){this._displayed||(this._anim&&(this._anim.stop(),delete this._anim),
this._displayed=!0,this._size(),this._disableOverflow(),this._fadeIn())},hide:function(){if(this._displayed)try{this._anim&&(this._anim.stop(),delete this._anim),this._size()}catch(v){console.error(v)}finally{this._fadeOut(),this._displayed=!1,null!==this._resizeCheck&&(clearInterval(this._resizeCheck),this._resizeCheck=null)}},isVisible:function(){return this._displayed},onShow:function(){},onHide:function(){},uninitialize:function(){this._displayed=!1;this._resizeCheck&&clearInterval(this._resizeCheck);
f.set(this._centerNode,"display","none");f.set(this._underlayNode,"display","none");7==l("ie")&&this._ieFixNode&&(h.body().removeChild(this._ieFixNode),delete this._ieFixNode);this._anim&&(this._anim.stop(),delete this._anim);this._centerNode=this._textNode=this._imageNode=this.target=null;this.inherited(arguments)},_size:function(){if(this._displayed){var v=b.get(h.body(),"dir");v&&(v=v.toLowerCase());var t=this._scrollerWidths(),y=this.target,C=f.get(this._centerNode,"display");f.set(this._centerNode,
"display","block");var B=d.position(y,!0);if(y===h.body()||y===h.doc)B=e.getBox(),B.x=B.l,B.y=B.t;var F=d.getMarginBox(this._centerNode);f.set(this._centerNode,"display",C);if(this._ieFixNode){var x=-this._ieFixNode.offsetTop/1E3;B.x=Math.floor((B.x+.9)/x);B.y=Math.floor((B.y+.9)/x);B.w=Math.floor((B.w+.9)/x);B.h=Math.floor((B.h+.9)/x)}var w=f.get(y,"zIndex"),A=C=w;if("auto"===this.zIndex)if("auto"!=w)C=parseInt(C,10),A=parseInt(A,10);else{var z=y;if(z&&z!==h.body()&&z!==h.doc)for(z=y.parentNode,
x=-1E5;z&&z!==h.body();)(w=f.get(z,"zIndex"))&&"auto"!==w&&(w=parseInt(w,10),x<w&&(x=w,C=w+1,A=w+1)),z=z.parentNode}else C=parseInt(this.zIndex,10),A=parseInt(this.zIndex,10);f.set(this._centerNode,"zIndex",A);f.set(this._underlayNode,"zIndex",C);if((C=y.parentNode)&&C!==h.body()&&y!==h.body()&&y!==h.doc){z=B.h;A=B.w;y=d.position(C,!0);this._ieFixNode&&(x=-this._ieFixNode.offsetTop/1E3,y.x=Math.floor((y.x+.9)/x),y.y=Math.floor((y.y+.9)/x),y.w=Math.floor((y.w+.9)/x),y.h=Math.floor((y.h+.9)/x));y.w-=
C.scrollHeight>C.clientHeight&&0<C.clientHeight?t.v:0;y.h-=C.scrollWidth>C.clientWidth&&0<C.clientWidth?t.h:0;"rtl"===v&&(l("opera")?(B.x+=C.scrollHeight>C.clientHeight&&0<C.clientHeight?t.v:0,y.x+=C.scrollHeight>C.clientHeight&&0<C.clientHeight?t.v:0):l("ie")?y.x+=C.scrollHeight>C.clientHeight&&0<C.clientHeight?t.v:0:l("webkit"));y.w<B.w&&(B.w-=y.w);y.h<B.h&&(B.h-=y.h);var G=y.y,J=y.y+y.h,L=B.y,R=B.y+z;v=y.x;x=y.x+y.w;w=B.x;var T=B.x+A;if(R>G&&L<G)B.y=y.y,z-=G-L,B.h=z<y.h?z:B.h-2*(C.scrollWidth>
C.clientWidth&&0<C.clientWidth?t.h:0);else if(L<J&&R>J)B.h=J-L;else if(R<=G||L>=J)B.h=0;if(T>v&&w<v)B.x=y.x,A-=v-w,B.w=A<y.w?A:B.w-2*(C.scrollHeight>C.clientHeight&&0<C.clientHeight?t.w:0);else if(w<x&&T>x)B.w=x-w;else if(T<=v||w>=x)B.w=0}0<B.h&&0<B.w?(f.set(this._underlayNode,{display:"block",width:B.w+"px",height:B.h+"px",top:B.y+"px",left:B.x+"px"}),t=["borderRadius","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],this._cloneStyles(t),l("ie")||(t=
"MozBorderRadius MozBorderRadiusTopleft MozBorderRadiusTopright MozBorderRadiusBottomleft MozBorderRadiusBottomright WebkitBorderRadius WebkitBorderTopLeftRadius WebkitBorderTopRightRadius WebkitBorderBottomLeftRadius WebkitBorderBottomRightRadius".split(" "),this._cloneStyles(t,this)),t=B.h/2-F.h/2,C=B.w/2-F.w/2,B.h>=F.h&&B.w>=F.w?f.set(this._centerNode,{top:t+B.y+"px",left:C+B.x+"px",display:"block"}):f.set(this._centerNode,"display","none")):(f.set(this._underlayNode,"display","none"),f.set(this._centerNode,
"display","none"));if(null===this._resizeCheck){var aa=this;this._resizeCheck=setInterval(function(){aa._size()},100)}}},_cloneStyles:function(v){n.forEach(v,function(t){f.set(this._underlayNode,t,f.get(this.target,t))},this)},_fadeIn:function(){var v=this,t=c.animateProperty({duration:v.duration,node:v._underlayNode,properties:{opacity:{start:0,end:v.opacity}}}),y=c.animateProperty({duration:v.duration,node:v._centerNode,properties:{opacity:{start:0,end:1}},onEnd:function(){v.onShow();delete v._anim}});
this._anim=g.combine([t,y]);this._anim.play()},_fadeOut:function(){var v=this,t=c.animateProperty({duration:v.duration,node:v._underlayNode,properties:{opacity:{start:v.opacity,end:0}},onEnd:function(){f.set(this.node,{display:"none",zIndex:"-1000"})}}),y=c.animateProperty({duration:v.duration,node:v._centerNode,properties:{opacity:{start:1,end:0}},onEnd:function(){f.set(this.node,{display:"none",zIndex:"-1000"});v.onHide();v._enableOverflow();delete v._anim}});this._anim=g.combine([t,y]);this._anim.play()},
_ignore:function(v){v&&r.stop(v)},_scrollerWidths:function(){var v=a.create("div");f.set(v,{position:"absolute",opacity:0,overflow:"hidden",width:"50px",height:"50px",zIndex:"-100",top:"-200px",padding:"0px",margin:"0px"});var t=a.create("div");f.set(t,{width:"200px",height:"10px"});v.appendChild(t);h.body().appendChild(v);t=d.getContentBox(v);f.set(v,"overflow","scroll");var y=d.getContentBox(v);h.body().removeChild(v);return{v:t.w-y.w,h:t.h-y.h}},_setTextAttr:function(v){this.text=this._textNode.innerHTML=
v},_setColorAttr:function(v){f.set(this._underlayNode,"backgroundColor",v);this.color=v},_setImageTextAttr:function(v){b.set(this._imageNode,"alt",v);this.imageText=v},_setImageAttr:function(v){b.set(this._imageNode,"src",v);this.image=v},_setCenterIndicatorAttr:function(v){this.centerIndicator=v;"image"===v?(this._centerNode=this._imageNode,f.set(this._textNode,"display","none")):(this._centerNode=this._textNode,f.set(this._imageNode,"display","none"))},_setTargetAttr:function(v){if("string"===typeof v){var t=
u.byId(v);this._set("target",t?t.domNode:k.byId(v))}else this._set("target",v)},_disableOverflow:function(){if(this.target===h.body()||this.target===h.doc){this._overflowDisabled=!0;var v=h.body();this._oldOverflow=v.style&&v.style.overflow?f.get(v,"overflow"):"";if(l("ie")&&!l("quirks")){if(v.parentNode&&v.parentNode.style&&v.parentNode.style.overflow)this._oldBodyParentOverflow=v.parentNode.style.overflow;else try{this._oldBodyParentOverflow=f.get(v.parentNode,"overflow")}catch(t){this._oldBodyParentOverflow=
"scroll"}f.set(v.parentNode,"overflow","hidden")}f.set(v,"overflow","hidden")}},_enableOverflow:function(){if(this._overflowDisabled){delete this._overflowDisabled;var v=h.body();l("ie")&&!l("quirks")&&(v.parentNode.style.overflow=this._oldBodyParentOverflow,delete this._oldBodyParentOverflow);f.set(v,"overflow",this._oldOverflow);if(l("webkit")){var t=a.create("div",{style:{height:"2px"}});v.appendChild(t);setTimeout(function(){v.removeChild(t)},0)}delete this._oldOverflow}}})})},"esri/dijit/analysis/CreateViewshed":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/json dojo/has dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/number dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/Button dijit/form/CheckBox dijit/form/Form dijit/form/Select dijit/form/TextBox dijit/form/NumberSpinner dijit/form/ValidationTextBox dijit/layout/ContentPane dijit/form/FilteringSelect dijit/Dialog ../../kernel ../../lang ./AnalysisBase ./_AnalysisOptions ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../toolbars/draw ../PopupTemplate ../../layers/FeatureLayer ../../graphic ./utils ./AnalysisRegistry ./CreditEstimator ../../symbols/PictureMarkerSymbol dijit/form/HorizontalSlider dijit/form/HorizontalRule dijit/form/HorizontalRuleLabels dojo/i18n!../../nls/jsapi dojo/text!./templates/CreateViewshed.html".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da,Q,K,E,N,I,O,U,ha,ia,S){H=m([u,v,t,y,C,la,ba],{declaredClass:"esri.dijit.analysis.CreateViewshed",templateString:S,widgetsInTemplate:!0,inputLayer:null,maximumDistance:15,maxDistanceUnits:"Kilometers",targetHeight:0,targetHeightUnits:"Meters",observerHeight:1.75,observerHeightUnits:"Meters",outputLayerName:null,i18n:null,map:null,toolName:"CreateViewshed",helpFileName:"CreateViewshed",resultParameter:"viewshedLayer",
constructor:function(W,ka){ka=W.distanceDefaultUnits||"Miles";this._pbConnects=[];W.containerNode&&(this.container=W.containerNode);this.maxDistanceUnits=W.maxDistanceUnits?W.maxDistanceUnits:ka;this.maximumDistance=ca.isDefined(W.maximumDistance)?W.maximumDistance:"Miles"===ka?9:15;this.observerHeightUnits=W.observerHeightUnits?W.observerHeightUnits:"Miles"===ka?"Feet":"Meters";this.observerHeight=ca.isDefined(W.observerHeight)?W.observerHeight:"Miles"===ka?6:1.75;this.targetHeightUnits=W.targetHeightUnits?
W.targetHeightUnits:"Miles"===ka?"Feet":"Meters"},destroy:function(){this.inherited(arguments);r.forEach(this._pbConnects,l.disconnect);delete this._pbConnects},postMixInProperties:function(){this.inherited(arguments);n.mixin(this.i18n,ia.findHotSpotsTool);n.mixin(this.i18n,ia.createViewshedTool);this.set("drawPointLayerName",this.i18n.pointlayerName)},postCreate:function(){this.inherited(arguments);p.add(this._form.domNode,"esriSimpleForm");this._outputLayerInput.set("validator",n.hitch(this,this.validateServiceName));
this.showCredits=!1;this._buildUI()},startup:function(){},_handleModeCrumbClick:function(W){W.preventDefault();this._onClose(!0)},_onClose:function(W){W&&this._pointfeatureLayer&&(this.map.removeLayer(this._pointfeatureLayer),r.forEach(this.inputLayers,function(ka,ja){ka===this._pointfeatureLayer&&(this._analysisSelect.removeOption({value:ja+1,label:this._pointfeatureLayer.name}),this.inputLayers.splice(ja,1))},this));this._handleInputDrawPointChange(!1);this.emit("close",{save:!W})},clear:function(){this._pointfeatureLayer&&
(this.map.removeLayer(this._pointfeatureLayer),r.forEach(this.inputLayers,function(W,ka){W===this._pointfeatureLayer&&(this._analysisSelect.removeOption({value:ka+1,label:this._pointfeatureLayer.name}),this.inputLayers.splice(ka,1))},this));this._handleInputDrawPointChange(!1)},_handleShowCreditsClick:function(W){W.preventDefault();W={};var ka=this.get("observerHeight"),ja=this.get("targetHeight"),ma=this.get("maximumDistance");this._form.validate()&&(W.inputLayer=b.toJson(this.constructAnalysisInputLyrObj(this.get("inputLayer"))),
0<=ma&&(W.maximumDistance=ma,W.maxDistanceUnits=this.get("maxDistanceUnits")),0<=ka&&(W.observerHeight=ka,W.observerHeightUnits=this.get("observerHeightUnits")),0<=ja&&(W.targetHeight=ja,W.targetHeightUnits=this.get("targetHeightUnits")),this.returnFeatureCollection||(W.OutputName=b.toJson({serviceProperties:{name:this.get("outputLayerName")}})),this.returnFeatureCollection||(W.OutputName=b.toJson({serviceProperties:{name:this.get("outputLayerName")}})),this.showChooseExtent&&this._useExtentCheck.get("checked")&&
(W.context=b.toJson({extent:this.map.extent._normalize(!0)})),this.getCreditsEstimate(this.toolName,W).then(n.hitch(this,function(ta){this._usageForm.set("content",ta);this._usageDialog.show()})))},_handleSaveBtnClick:function(W){if(this._form.validate()){this._saveBtn.set("disabled",!0);W={};var ka={};var ja=this.get("observerHeight");var ma=this.get("targetHeight"),ta=this.get("maximumDistance");W.inputLayer=b.toJson(this.constructAnalysisInputLyrObj(this.get("inputLayer")));0<=ta&&(W.maximumDistance=
ta,W.maxDistanceUnits=this.get("maxDistanceUnits"));0<=ja&&(W.observerHeight=ja,W.observerHeightUnits=this.get("observerHeightUnits"));0<=ma&&(W.targetHeight=ma,W.targetHeightUnits=this.get("targetHeightUnits"));this.returnFeatureCollection||(W.OutputName=b.toJson({serviceProperties:{name:this.get("outputLayerName")}}));this.showChooseExtent&&!this.get("disableExtent")&&this._useExtentCheck.get("checked")&&(W.context=b.toJson({extent:this.map.extent._normalize(!0)}));this.returnFeatureCollection&&
(ja={outSR:this.map.spatialReference},this.showChooseExtent&&this._useExtentCheck.get("checked")&&(ja.extent=this.map.extent._normalize(!0)),W.context=b.toJson(ja));W.returnFeatureCollection=this.returnFeatureCollection;ka.jobParams=W;ka.itemParams={description:this.i18n.itemDescription,tags:f.substitute(this.i18n.itemTags,{layername:this.inputLayer.name,fieldname:W.field?W.field:""}),snippet:this.i18n.itemSnippet};this.showSelectFolder&&(ka.itemParams.folder=this.get("folderId"));this.execute(ka)}},
_save:function(){},_buildUI:function(){this._loadConnections();this.signInPromise.then(n.hitch(this,K.initHelpLinks,this.domNode,this.showHelp,{analysisGpServer:this.analysisGpServer}));var W=!0;this.get("showSelectAnalysisLayer")&&(this.inputLayers&&this.inputLayer&&!K.isLayerInLayers(this.inputLayer,this.inputLayers)&&(this.inputLayers.push(this.inputLayer),-1!==this.inputLayer.name.indexOf("Drawn Input Points")&&(this.map.addLayer(this.inputLayer),this._pointfeatureLayer=this.inputLayer)),this.get("inputLayer")||
!this.get("inputLayers")||this.rerun||this.set("inputLayer",this.inputLayers[0]),K.populateAnalysisLayers(this,"inputLayer","inputLayers",{posIncrement:1}));this.outputLayerName&&(this._outputLayerInput.set("value",this.outputLayerName),W=!1);K.addReadyToUseLayerOption(this,[this._analysisSelect]);this._updateAnalysisLayerUI(W);e.set(this._chooseFolderRow,"display",!0===this.showSelectFolder?"block":"none");this.showSelectFolder&&this.getFolderStore().then(n.hitch(this,function(ka){this.folderStore=
ka;K.setupFoldersUI({folderStore:this.folderStore,folderId:this.folderId,folderName:this.folderName,folderSelect:this._webMapFolderSelect,username:this.portalUser?this.portalUser.username:""})}));e.set(this._chooseExtentDiv,"display",!0===this.showChooseExtent?"inline-block":"none");e.set(this._showCreditsLink,"display",!0===this.showCredits?"block":"none");this._distanceUnitsSelect.addOption([{value:"Miles",label:this.i18n.miles},{value:"Yards",label:this.i18n.yards},{value:"Feet",label:this.i18n.feet},
{type:"separator"},{value:"Kilometers",label:this.i18n.kilometers},{value:"Meters",label:this.i18n.meters}]);this.maxDistanceUnits&&(this._distanceUnitsSelect.set("value",this.maxDistanceUnits),this._handleMaxDstUnitsChange(this.maxDistanceUnits));this.maximumDistance&&this._maximumDistanceInput.set("value",this.maximumDistance);this._obsrUnitsSelect.addOption([{value:"Miles",label:this.i18n.miles},{value:"Yards",label:this.i18n.yards},{value:"Feet",label:this.i18n.feet},{type:"separator"},{value:"Kilometers",
label:this.i18n.kilometers},{value:"Meters",label:this.i18n.meters}]);this.observerHeightUnits&&this._obsrUnitsSelect.set("value",this.observerHeightUnits);this.observerHeight&&this._obsrHeightInput.set("value",this.observerHeight);this._targetUnitsSelect.addOption([{value:"Miles",label:this.i18n.miles},{value:"Yards",label:this.i18n.yards},{value:"Feet",label:this.i18n.feet},{type:"separator"},{value:"Kilometers",label:this.i18n.kilometers},{value:"Meters",label:this.i18n.meters}]);this.targetHeightUnits&&
this._targetUnitsSelect.set("value",this.targetHeightUnits);this.targetHeight&&this._targetHgtInput.set("value",this.targetHeight)},_loadConnections:function(){this.on("start",n.hitch(this,"_onClose",!1));this._connect(this._closeBtn,"onclick",n.hitch(this,"_onClose",!0))},validateServiceName:function(W){return K.validateServiceName(W,{textInput:this._outputLayerInput,isItem:!this.returnFeatureCollection})},_handleInputDrawPointChange:function(W){W?(this.emit("drawtool-activate",{}),this._pointfeatureLayer||
this._createPointFeatColl(),this._pointtoolbar.activate(M.POINT)):this._pointtoolbar.deactivate()},_createPointFeatColl:function(){var W=K.createPointFeatureCollection(this.drawPointLayerName);this._pointfeatureLayer=new da(W,{id:this.drawPointLayerName});this.map.addLayer(this._pointfeatureLayer);l.connect(this._pointfeatureLayer,"onClick",n.hitch(this,function(ka){this.map.infoWindow.setFeatures([ka.graphic])}))},_addPointFeatures:function(W){var ka=[],ja={};W=new Q(W);ja.description="blayer desc";
ja.title="blayer";W.setAttributes(ja);ka.push(W);this._pointfeatureLayer.applyEdits(ka,null,null);if(0===this.inputLayers.length||this.inputLayers[this.inputLayers.length-1]!==this._pointfeatureLayer)this.inputLayers.push(this._pointfeatureLayer),ka=this.inputLayers.length-1,ja=this._analysisSelect.getOptions(),this._analysisSelect.removeOption(ja),ja=r.map(ja,function(ma){ma.selected=!1;return ma}),this._analysisSelect.addOption({value:ka+1,label:this._pointfeatureLayer.name,selected:!0}),this._analysisSelect.addOption(ja),
this._handleAnalysisLayerChange(ka+1)},_handleMaxDstChange:function(){this._maximumDistanceInput.validate()},_handleMaxDstUnitsChange:function(W){var ka="",ja={min:0};"Miles"===W?(ja.max=31,ka=f.substitute(this.i18n.maxDistanceValidMsg,{units:W,limit:31})):"Kilometers"===W?(ja.max=50,ka=f.substitute(this.i18n.maxDistanceValidMsg,{units:W,limit:50})):"Yards"===W?(ja.max=54680,ka=f.substitute(this.i18n.maxDistanceValidMsg,{units:W,limit:54680})):"Feet"===W?(ja.max=164041,ka=f.substitute(this.i18n.maxDistanceValidMsg,
{units:W,limit:164041})):"Meters"===W&&(ja.max=5E4,ka=f.substitute(this.i18n.maxDistanceValidMsg,{units:W,limit:5E4}));this._maximumDistanceInput.set("constraints",ja);this._maximumDistanceInput.set("rangeMessage",ka)},_handleAnalysisLayerChange:function(W){"browse"===W||"browselayers"===W?(this._createBrowseItems({browseValue:W,disabledSubResources:[this.inputLayer]},{tags:["point"],geometryTypes:[E.GeometryTypes.Point,E.GeometryTypes.MultiPoint]},this._analysisSelect),this._analysisPointDrawBtn.reset()):
(this.inputLayer=this.inputLayers[W-1],this._updateAnalysisLayerUI(!0))},_handleBrowseItemsSelect:function(W,ka){W&&W.selection&&K.addAnalysisReadyLayer({item:W.selection,layers:this.inputLayers,layersSelect:this._analysisSelect,posIncrement:1,browseDialog:W.dialog||this._browsedlg,widget:this},ka).always(n.hitch(this,this._updateAnalysisLayerUI,!0))},_updateAnalysisLayerUI:function(W){this.inputLayer&&(h.set(this._interpolateToolDescription,"innerHTML",f.substitute(this.i18n.toolDefine,{layername:this.inputLayer.name})),
W&&(this.outputLayerName=f.substitute(this.i18n.outputLayerName,{layername:this.inputLayer.name})),this._outputLayerInput.set("value",this.outputLayerName),this._pointfeatureLayer&&this._pointfeatureLayer.name!==this.inputLayer.name&&this._analysisPointDrawBtn.reset())},_setAnalysisGpServerAttr:function(W){W&&(this.analysisGpServer=W,this.set("toolServiceUrl",this.analysisGpServer+"/"+this.toolName))},_setInputLayersAttr:function(W){this.inputLayers=W||[]},_setInputLayerAttr:function(W){this.inputLayer=
W},_getInputLayerAttr:function(){return this.inputLayer},_getOutputLayerNameAttr:function(){this._outputLayerInput&&(this.outputLayerName=this._outputLayerInput.get("value"));return this.outputLayerName},_setOutputLayerNameAttr:function(W){this.outputLayerName=W},_setMapAttr:function(W){this.map=W;this._pointtoolbar=new M(this.map);l.connect(this._pointtoolbar,"onDrawEnd",n.hitch(this,this._addPointFeatures))},_getMapAttr:function(){return this.map},_setDisableRunAnalysisAttr:function(W){this._saveBtn.set("disabled",
W)},_setDisableExtentAttr:function(W){this._useExtentCheck.set("checked",!W);this._useExtentCheck.set("disabled",W)},_getDisableExtentAttr:function(){this._useExtentCheck.get("disabled")},_setMaxDistanceUnitsAttr:function(W){this.maxDistanceUnits=W},_getMaxDistanceUnitsAttr:function(){this._distanceUnitsSelect&&this._distanceUnitsSelect.get("value")&&(this.maxDistanceUnits=this._distanceUnitsSelect.get("value"));return this.maxDistanceUnits},_setMaximumDistanceAttr:function(W){this.maximumDistance=
W},_getMaximumDistanceAttr:function(){return this._maximumDistanceInput.get("value")},_setObserverHeightUnitsAttr:function(W){this.observerHeightUnits=W},_getObserverHeightUnitsAttr:function(){this._obsrUnitsSelect&&this._obsrUnitsSelect.get("value")&&(this.observerHeightUnits=this._obsrUnitsSelect.get("value"));return this.observerHeightUnits},_setObserverHeightAttr:function(W){this.observerHeight=W},_getObserverHeightAttr:function(){return this._obsrHeightInput.get("value")},_setTargetHeightUnitsAttr:function(W){this.targetHeightUnits=
W},_getTargetHeightUnitsAttr:function(){this._targetUnitsSelect&&this._targetUnitsSelect.get("value")&&(this.targetHeightUnits=this._targetUnitsSelect.get("value"));return this.targetHeightUnits},_setTargetHeightAttr:function(W){this.targetHeight=W},_getTargetHeightAttr:function(){return this._targetHgtInput.get("value")},_setDrawPointLayerNameAttr:function(W){this.drawPointLayerName=W},_getDrawPointLayerNameAttr:function(){return this._pointfeatureLayer.name},_getDrawLayerAttr:function(){var W=[];
this._featureLayer&&W.push(this._featureLayer);this._pointfeatureLayer&&W.push(this._pointfeatureLayer);return W},_connect:function(W,ka,ja){this._pbConnects.push(l.connect(W,ka,ja))}});a("extend-esri")&&n.setObject("dijit.analysis.CreateViewshed",H,aa);return H})},"esri/dijit/analysis/AnalysisBase":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/json dojo/Deferred dojo/promise/all dojo/when dojo/data/ItemFileWriteStore dojo/string dojo/Evented dojo/_base/kernel dojo/Stateful ../../kernel ../../lang ../../request ../../tasks/Geoprocessor dojo/i18n!../../nls/jsapi ./utils ./storageUtils ./ItemTypes ../../IdentityManager".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F){m=m([p,c],{declaredClass:"esri.dijit.analysis.AnalysisBase",isOutputLayerItemUpdated:!1,analysisGpServer:null,toolName:null,portalUrl:null,jobParams:null,itemParams:null,gp:null,resultParameter:null,signInPromise:null,getResultLyrInfos:!1,checkCreditLimits:!1,useGPCreditTask:!0,_isGPCreditSync:!0,_jobInfo:null,_popupInfo:null,_toolServiceUrl:null,_counter:null,_analysisType:"feature",doRefreshItem:!0,doSaveJobInfo:!1,doSaveInStorage:!1,_doDeleteViewResult:!1,
outputName:"OutputName",_freeGPTools:["CreateWatersheds","CreateViewshed","TraceDownstream"],constructor:function(x){this.isOutputLayerItemUpdated=!1;this._rids=[];this._counter=0;this._popupInfo=[];x.analysisGpServer?this._signIn(x.analysisGpServer):x.portalUrl&&(this.portalUrl=x.portalUrl,this._signIn(x.portalUrl,!0));this.i18n={};n.mixin(this.i18n,y.common);n.mixin(this.i18n,y.analysisTools);n.mixin(this.i18n,y.analysisMsgCodes);n.mixin(this.i18n,y.analysisSettings);this.signInPromise.then(n.hitch(this,
this._initErrorHelpMap))},execute:function(x){var w;this.jobParams=x.jobParams;this.jobParams.actualOutputName=this.outputName;var A=this.jobParams[this.outputName];this._analysisType=x.analysisType||"feature";this._updateContext();var z=l.fromJson(this.jobParams.context);A&&(w=l.fromJson(A));!A||w&&!w.serviceProperties?(this.itemParams=null,this.jobParams.resultName=this.get("resultName")):this.showGeoAnalyticsParams&&A&&z&&z.dataStore&&-1===["BDS","GDB"].indexOf(z.dataStore)?(this.jobParams._gaxOutName=
w.serviceProperties.name.replace(/[\s]|\-|\./g,"_"),this.jobParams[this.outputName]=null,this.jobParams.outputType=F.BDFSTEMPLATE,this.itemParams=null):(this.showGeoAnalyticsParams&&"CopyToDataStore"===this.toolName&&z&&z.dataStore&&-1!==["BDS","GDB"].indexOf(z.dataStore)&&(delete z.dataStore,this.jobParams.context=l.toJson(z)),this.itemParams=x.itemParams);u.isDefined(x.isSpatioTemporalDataStore)&&(this._isSpatioTemporalDataStore=C.settingsVM&&C.settingsVM.datastore&&"CopyToDataStore"!==this.toolName?
"BDS"===C.settingsVM.datastore:x.isSpatioTemporalDataStore);this.signInPromise.then(n.hitch(this,this._checkUser))},_updateContext:function(){var x;this.rerun&&this.context&&this._useExtentCheck&&!this._useExtentCheck.get("checked")&&(this.context.extent=null);this.context&&((x=l.fromJson(this.jobParams.context))||(x={}),this.context.outSR&&!x.outSR&&(x.outSR=this.context.outSR),this.context.processSR&&!x.processSR&&(x.processSR=this.context.processSR),this.context.extent&&!x.extent&&(x.extent=this.context.extent),
this.showGeoAnalyticsParams&&this.context.dataStore&&!x.dataStore&&(x.dataStore=this.context.dataStore),"raster"===this.analysisMode&&(this.context.cellSize&&!x.cellSize&&(x.cellSize=this.context.cellSize),this.context.mask&&!x.mask&&(x.mask=this.context.mask),!this.context.snapRaster||x.snapRaster||this.isDetectObjectTool||(x.snapRaster=this.context.snapRaster),this.isDLTool||this.isOutputFeatureTool||this.isProximityTool||!this.context.resamplingMethod||x.resamplingMethod||(x.resamplingMethod=this.context.resamplingMethod)),
this.isDLTool&&(this.context.processorType&&!x.processorType&&(x.processorType=this.context.processorType),"feature"===this._analysisType&&this.context.cellSize&&!x.cellSize&&(x.cellSize=this.context.cellSize)),this.isPPFTool&&this.context.parallelProcessingFactor&&!x.parallelProcessingFactor&&(x.parallelProcessingFactor=this.context.parallelProcessingFactor),this.jobParams.context=l.toJson(x))},_checkUser:function(){var x;if(x=q.id.findCredential(this.portalUrl).userId)x=this.portalUrl+"/sharing/rest/community/users/"+
x,v({url:x,content:{f:"json"}}).then(n.hitch(this,this._handleUserProfileResponse),n.hitch(this,function(w){this.emit("job-fail",{message:w.message+(w.details?w.details.toString():""),jobParams:this.jobParams})}))},getUserProfile:function(){var x=new a;this.userProfile?x.resolve(this.userProfile):this.signInPromise.then(n.hitch(this,function(w){if(w=w.userId)w=this.portalUrl+"/sharing/rest/community/users/"+w,v({url:w,content:{f:"json"}}).then(n.hitch(this,function(A){this.userProfile=A;x.resolve(A)}),
n.hitch(this,function(A){x.reject(A)}))}));return x.promise},_handleUserProfileResponse:function(x){var w=this.jobParams.outputType&&this.jobParams.outputType===F.FLAYERVIEW;if(u.isDefined(x)&&u.isDefined(x.orgId))if(-1===r.indexOf(["account_admin","account_publisher","org_admin","org_publisher"],x.role))this.emit("job-fail",{message:this.i18n.pubRoleMsg,messageCode:"AB_0001",jobParams:this.jobParams});else if(u.isDefined(x.availableCredits)&&this.get("checkCreditLimits")&&!w&&!this._byPassCreditCheck(this.toolName)){var A,
z={},G=this.toolName,J=new a;var L=this._cleanUpJobParamsForSubmit();for(A in L)L.hasOwnProperty(A)&&("object"===typeof L[A]?z[A]=l.toJson(L[A]):-1!==r.indexOf(["measurementtype"],A.toLowerCase())&&"StraightLine"!==L[A]?(w=l.fromJson(L[A]),z[A]=w?w.name.replace(/[\s~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g,""):"DrivingTime"):z[A]=L[A]);this.isRaster&&(G=this.rasterGPToolName,z.functionArguments&&(z.functionArguments=l.fromJson(z.functionArguments)),z.context&&(z.context=l.fromJson(z.context)));u.isDefined(this.itemParams)&&
!this.isRaster?J=this._checkServiceName(x.orgId,!0):J.resolve(!0);J.then(n.hitch(this,function(R){R&&(this.isRaster&&u.isDefined(this.estimatedCost)?x.availableCredits>this.estimatedCost?this._runJob():this.emit("job-fail",{message:this.i18n.insufficientCreditsMsg,messageCode:"AB_0001",jobParams:this.jobParams}):this.getCreditsEstimate(G,z,this.isRaster).always(n.hitch(this,function(T){var aa=T&&u.isDefined(T.cost)?T.cost:T.maximumCost;u.isDefined(aa)&&x.availableCredits>aa?this._runJob():T&&(T.messageCode||
T.message)&&0!==T.status?(aa=u.isDefined(this.i18n[T.messageCode])?this.i18n[T.messageCode]:T.message,aa=u.isDefined(T.params)?h.substitute(aa,T.params):aa,this.emit("job-fail",{message:aa,messageCode:"AB_0001",jobParams:this.jobParams})):this.isRaster&&u.isDefined(aa)&&x.availableCredits<aa?this.emit("job-fail",{message:this.i18n.insufficientCreditsMsg,messageCode:"AB_0001",jobParams:this.jobParams}):this._runJob()})))}))}else u.isDefined(this.itemParams)?this._checkServiceName(x.orgId):(this.emit("start",
this.jobParams),this._submitGpJob());else this.emit("job-fail",{message:this.i18n.orgUsrMsg,jobParams:this.jobParams})},_runJob:function(){u.isDefined(this.itemParams)?("raster"===this._analysisType?this._createImageService():this._createService(),this.emit("start",this.jobParams)):(this.emit("start",this.jobParams),this._submitGpJob())},_checkServiceName:function(x,w){var A=new a;q.id.findCredential(this.portalUrl);x=this.portalUrl+"/sharing/rest/portals/"+x+"/isServiceNameAvailable";var z=l.fromJson(this.jobParams[this.outputName]);
u.isDefined(z.serviceProperties)&&u.isDefined(z.serviceProperties.name)&&(z.serviceProperties.name=z.serviceProperties.name.replace(/[\s]|\-|\./g,"_"),this.jobParams[this.outputName]=l.toJson(z));v({url:x,content:{name:z.serviceProperties.name,type:"raster"===this._analysisType?"Image Service":"Feature Service",f:"json"}}).then(n.hitch(this,function(G){G.available?(w||("raster"===this._analysisType?this._createImageService():this._createService(),this.emit("start",this.jobParams)),A.resolve(!0)):
(this.emit("job-fail",{message:this.i18n.servNameExists,type:"warning",messageCode:"AB_0002",jobParams:this.jobParams}),A.resolve(!1))}),n.hitch(this,function(G){this.emit("job-fail",{message:G.message+(G.details?G.details.toString():""),jobParams:this.jobParams});A.resolve(!1)}));return A},_checkServiceNameOnly:function(x,w){var A=new a;q.id.findCredential(this.portalUrl);v({url:this.portalUrl+"/sharing/rest/portals/"+x+"/isServiceNameAvailable",content:{name:w,type:"Image Service",f:"json"}}).then(n.hitch(this,
function(z){z.available?A.resolve(!0):(this.emit("job-fail",{message:this.i18n.servNameExists,type:"warning",messageCode:"AB_0002",jobParams:this.jobParams}),A.resolve(!1))}),n.hitch(this,function(z){this.emit("job-fail",{message:z.message+(z.details?z.details.toString():""),jobParams:this.jobParams});A.resolve(!1)}));return A},_createService:function(){var x=this._submitGpJob;var w=q.id.findCredential(this.portalUrl).userId;var A=l.fromJson(this.jobParams[this.outputName]);if(w){var z=this.itemParams.folder;
w=this.portalUrl+"/sharing/rest/content/users/"+w+(z&&"/"!==z?"/"+z:"")+"/createService";A={createParameters:l.toJson({currentVersion:10.2,serviceDescription:"",hasVersionedData:!1,supportsDisconnectedEditing:!1,hasStaticData:!0,maxRecordCount:2E3,supportedQueryFormats:"JSON",capabilities:"Query",description:"",copyrightText:"",allowGeometryUpdates:!1,syncEnabled:!1,editorTrackingInfo:{enableEditorTracking:!1,enableOwnershipAccessControl:!1,allowOthersToUpdate:!0,allowOthersToDelete:!0},xssPreventionInfo:{xssPreventionEnabled:!0,
xssPreventionRule:"InputOnly",xssInputRule:"rejectInvalid"},tables:[],name:A.serviceProperties.name}),outputType:"featureService",f:"json"};this._isSpatioTemporalDataStore&&(z=l.fromJson(A.createParameters),z.options={dataSourceType:"spatiotemporal"},A.createParameters=l.toJson(z));this.jobParams.outputType&&this.jobParams.outputType===F.FLAYERVIEW&&(z=l.fromJson(A.createParameters),n.mixin(A,this._getViewCreateParams()),A.createParameters=l.toJson(z),x=this._addViewDefinition);v({url:w,content:A},
{usePost:!0}).then(n.hitch(this,x),n.hitch(this,this._handleCreateServiceError))}},_createImageService:function(){var x=q.id.findCredential(this.portalUrl).userId;var w=l.fromJson(this.jobParams[this.outputName]);if(x){var A=this.itemParams.folder;x=this.portalUrl+"/sharing/rest/content/users/"+x+(A&&"/"!==A?"/"+A:"")+"/createService";w={createParameters:l.toJson({name:w.serviceProperties.name,description:"",capabilities:w.serviceProperties.capabilities||"Image",properties:{isCached:!0,path:"@",description:"",
copyright:""}}),outputType:"imageService",f:"json"};v({url:x,content:w},{usePost:!0}).then(n.hitch(this,this._submitGpJob),n.hitch(this,this._handleCreateServiceError))}},_handleCreateServiceError:function(x){this.emit("job-fail",{message:x.message+(x.details?x.details.toString():""),jobParams:this.jobParams})},_getViewCreateParams:function(){return{isView:!0}},_addViewDefinition:function(x){var w;if(this.itemParams){this.currentGpItemId=x.itemId;var A=l.fromJson(this.jobParams[this.outputName]);
A.serviceProperties&&(A.serviceProperties.serviceUrl=x.serviceurl);A.itemProperties={itemId:x.itemId};this.itemParams.folder&&(A.itemProperties.folderId=this.itemParams.folder);this.jobParams[this.outputName]=l.toJson(A)}this.getViewParams({jobParams:this.jobParams,resultService:{url:x.serviceurl,itemId:x.itemId}}).then(n.hitch(this,function(z){w=z;var G={jobId:"ViewJob_"+(new Date).getTime(),jobStatus:"esriJobSubmitted",jobParams:this.jobParams};this._addToDefinition(x.serviceurl,w).then(n.hitch(this,
function(J){var L={value:{}};this._doDeleteViewResult||(this._jobInfo.jobStatus="esriJobSucceeded",setTimeout(n.hitch(this,function(){this.itemParams.properties={jobUrl:J.serviceurl+"/jobs/"+this._jobInfo.jobId,jobType:"GPServer",jobId:this._jobInfo.jobId,jobStatus:"completed"};this._readItem()}),300),this.doSaveJobInfo&&this.saveJobInfo(this._jobInfo),L.outputLayerName=l.fromJson(this.jobParams[this.outputName]).serviceProperties.name,L.value.itemId=this.currentGpItemId,L.analysisInfo={toolName:this.toolName,
secondaryOutputs:this.secondaryOutputs,jobParams:this.jobParams},this.emit("job-result",L))}),n.hitch(this,this._gpJobFailed));this.emit("job-submit",this.jobParams);setTimeout(n.hitch(this,function(){this._jobInfo=G;this._jobInfo.jobStatus="esriJobExecuting";this._readItem();this.emit("job-status",this._jobInfo)},0))}),n.hitch(this,this._gpJobFailed))},_addToDefinition:function(x,w){x=x.replace("/rest/services","/rest/admin/services")+"/addToDefinition";var A=q.id.findCredential(this.portalUrl);
w={f:"json",addToDefinition:l.toJson(w),token:A.token};return v({url:x,content:w},{usePost:!0})},_getAdminLayerInfo:function(x){x=x.replace("/rest/services","/rest/admin/services");var w={f:"json",token:q.id.findCredential(this.portalUrl).token};return v({url:x,content:w})},_getSelf:function(x){return v({url:x+"/sharing/rest/portals/self",content:{culture:g.locale,f:"json"},callbackParamName:"callback",timeout:0},{})},_submitGpJob:function(x){var w=l.fromJson(this.jobParams.context);this._doCancelCleanup=
!1;if(this.itemParams){this.currentGpItemId=x.itemId;var A=l.fromJson(this.jobParams[this.outputName]);A.serviceProperties&&(A.serviceProperties.serviceUrl=x.serviceurl);A.itemProperties={itemId:x.itemId};this.itemParams.folder&&(A.itemProperties.folderId=this.itemParams.folder);this.jobParams[this.outputName]=l.toJson(A)}if(this.analysisGpServer){this._toolServiceUrl&&this.gp||this.set("toolServiceUrl",this.analysisGpServer+"/"+this.toolName);this.gp.setUpdateDelay(3E3);if(this.showGeoAnalyticsParams&&
this.jobParams._gaxOutName&&w.dataStore&&-1===["BDS","GDB"].indexOf(w.dataStore)){var z=this.jobParams[this.outputName]=this.jobParams._gaxOutName;delete this.jobParams._gaxOutName}this.itemParams||delete this.jobParams.resultName;this.gp.submitJob(this._cleanUpJobParamsForSubmit(),n.hitch(this,this._gpJobComplete),n.hitch(this,this._gpJobStatus),n.hitch(this,this._gpJobFailed));this.itemParams||(this.jobParams.resultName=this.get("resultName"));z&&(this.jobParams[this.outputName]=null);this.emit("job-submit",
this.jobParams)}else this._getSelf(this.portalUrl).then(n.hitch(this,function(G){this.analysisGpServer=G.helperServices.analysis&&G.helperServices.analysis.url?G.helperServices.analysis.url:null;this.set("toolServiceUrl",this.analysisGpServer+"/"+this.toolName);this.gp.setUpdateDelay(3E3);this.itemParams||delete this.jobParams.resultName;this.gp.submitJob(this.jobParams,n.hitch(this,this._gpJobComplete),n.hitch(this,this._gpJobStatus),n.hitch(this,this._gpJobFailed));this.itemParams||(this.jobParams.resultName=
this.get("resultName"));this.emit("job-submit",this.jobParams)}))},_cleanUpJobParamsForSubmit:function(){var x=n.mixin({},this.jobParams),w=["actualOutputName","aLayer","attributeExprObj","data","resultName"].concat(this.removeJobParamKeys||[]),A;for(A in x)x.hasOwnProperty(A)&&-1!==w.indexOf(A)&&delete x[A];return x},_updateItem:function(x){var w;if(w=q.id.findCredential(this.portalUrl).userId){var A=this.itemParams.folder;w=this.portalUrl+"/sharing/rest/content/users/"+w+(A&&"/"!==A?"/"+A:"")+"/items/"+
this.currentGpItemId+"/update";if(x)var z=x.item.properties;u.isDefined(z)||(z={});u.isDefined(z.jobUrl)||(z.jobUrl=this._toolServiceUrl+"/jobs/"+this._jobInfo.jobId,z.jobType="GPServer",z.jobId=this._jobInfo.jobId,z.jobStatus="processing",this.itemParams.properties=z);z=n.mixin({f:"json"},this.itemParams);x&&z.folder===x.item.folder&&delete z.folder;x&&x.item&&z.tags===x.item.tags.toString()&&delete z.tags;x&&x.item&&z.snippet===x.item.snippet&&delete z.snippet;x&&x.item&&z.description===x.item.description&&
delete z.description;z.properties&&(z.properties=l.toJson(z.properties));z.text&&(z.text=l.toJson(z.text));x=v({url:w,content:z},{usePost:!0});x.then(n.hitch(this,this._handleItemUpdate),n.hitch(this,this._handleUpdateItemError));return x}},_handleItemUpdate:function(x){this.isOutputLayerItemUpdated=!0},_handleItemDataUpdate:function(x){},_handleUpdateItemError:function(x){this.isOutputLayerItemUpdated=!0;this.emit("job-fail",{message:x.message+(x.details?x.details.toString():""),jobParams:this.jobParams})},
_handleErrorResponse:function(x){this.emit("job-fail",x)},_refreshItem:function(){var x;if(x=q.id.findCredential(this.portalUrl).userId){var w=this.itemParams.folder;x=this.portalUrl+"/sharing/rest/content/users/"+x+(w&&"/"!==w?"/"+w:"")+"/items/"+this.currentGpItemId+"/refresh";x=v({url:x,content:{f:"json"}},{usePost:!0})}else x=new a,x.resolve();return x.promise},_handleItemRefresh:function(x){},_readItem:function(){var x;if(x=q.id.findCredential(this.portalUrl).userId){var w=this.itemParams.folder;
x=this.portalUrl+"/sharing/rest/content/users/"+x+(w&&"/"!==w?"/"+w:"")+"/items/"+this.currentGpItemId;x=v({url:x,content:{f:"json"}});return x.then(n.hitch(this,this._updateItem))}},getItemInfo:function(x){if(q.id.findCredential(this.portalUrl).userId)return x=this.portalUrl+"/sharing/rest/content/items/"+x,v({url:x,content:{f:"json"}})},_gpJobStatus:function(x){x.jobParams=this.jobParams;x.resultParameter=this.resultParameter;x.returnProcessInfo=this.jobParams.returnProcessInfo;x.getResultLyrInfos=
this.getResultLyrInfos;x.currentGpItemId=this.currentGpItemId;x.itemParams=this.itemParams;"esriJobFailed"===x.jobStatus||"esriJobSucceeded"===x.jobStatus||"esriJobTimedOut"===x.jobStatus?(x.messages&&(x.message=this._buildErrorMsg(x)),this._checkTimer&&(clearInterval(this._checkTimer),this._checkTimer=null,this._gpJobComplete(x)),"esriJobFailed"!==x.jobStatus&&"esriJobTimedOut"!==x.jobStatus||this._deleteItem(!1)):-1===["esriJobCancelling","esriJobCancelled"].indexOf(x.jobStatus)||this._doCancelCleanup||
(this._handleOnCancel(x),this._doCancelCleanup=!0);this.doSaveJobInfo&&this.saveJobInfo(x);this.emit("job-status",x);this._jobInfo=x;this.itemParams&&!this.isOutputLayerItemUpdated&&this._readItem()},_updateRefreshItem:function(x){var w=[],A=x[0];w.push(this._readItem(this.doRefreshItem));d(w).then(n.hitch(this,function(z){A.outputLayerName=l.fromJson(this.jobParams[this.outputName]).serviceProperties.name;A.value.itemId=this.currentGpItemId;A.analysisInfo={toolName:this.toolName,secondaryOutputs:this.secondaryOutputs,
jobParams:this.jobParams};this.doRefreshItem?this._refreshItem().always(n.hitch(this,function(){this.emit("job-result",A)})):this.emit("job-result",A)}),n.hitch(this,this._handleDeleteItemError))},_gpJobComplete:function(x){var w;"esriJobSucceeded"===x.jobStatus&&(x.jobParams=this.jobParams,this.emit("job-success",x),d(this._getGpResultData(x)).then(n.hitch(this,function(A){A=r.filter(A,function(z){var G=!0;u.isDefined(z.value.empty)?G=z.value.empty:u.isDefined(z.value.url)||u.isDefined(z.value.itemId)?
G=!1:u.isDefined(z.value.featureSet)?G=!1:this.jobParams.outputType===F.BDFSTEMPLATE&&(G=!1);if(!G)return z},this);0===A.length?(this.currentGpItemId&&this._deleteItem(!1),this.showGeoAnalyticsParams&&x.messages&&(x.message=this._buildErrorMsg(x)),this.emit("job-fail",{message:this.showGeoAnalyticsParams?x.message:this.i18n.emptyResultInfoMsg,type:"warning",jobParams:this.jobParams})):(u.isDefined(this.itemParams)&&this.itemParams.properties&&this.itemParams.properties.jobStatus&&"processing"===this.itemParams.properties.jobStatus&&
(this.itemParams.properties.jobStatus="completed"),r.forEach(A,function(z){if(z.value.featureSet&&!z.value.url)z.value.featureSet.spatialReference=z.value.layerDefinition.spatialReference;else if(z.value.url&&-1!==z.value.url.indexOf("/FeatureServer/")&&z.value.layerInfo&&z.value.layerInfo.popupInfo){var G=z.value.url.match(/[0-9]+$/g)[0];this._popupInfo[G]=z.value.layerInfo.popupInfo}},this),w=A[0],w.results=A,this.jobParams.returnProcessInfo?this.gp.getResultData(x.jobId,"processInfo").then(n.hitch(this,
function(z){var G=[];r.forEach(z.value,function(J){G.push(l.fromJson(J))},this);this.currentGpItemId?(this.itemParams.description=C.buildReport(G),this._updateRefreshItem(A)):(w.analysisReport=C.buildReport(G),w.outputLayerName=this.jobParams.resultName,this.emit("job-result",w))})):this.currentGpItemId?this._updateRefreshItem(A):(w.outputLayerName=this.jobParams.resultName,this.emit("job-result",w)))})))},_gpJobFailed:function(x){var w=n.clone(x);w.jobParams=this.jobParams;this._checkTimer&&(clearInterval(this._checkTimer),
this._checkTimer=null);x.messages&&(x.message=this._buildErrorMsg(x));this.emit("job-fail",w)},_getGpResultData:function(x){var w=[],A=[];"string"===typeof this.resultParameter?A.push(this.resultParameter):this.resultParameter instanceof Array&&(A=this.resultParameter,this.secondaryOutputs&&this.secondaryOutputNames&&(A=r.filter(A,function(z){z=this.secondaryOutputs.indexOf(z);return-1===z?!0:x.jobParams.hasOwnProperty(this.secondaryOutputNames[z])},this)));r.forEach(A,function(z,G){w.push(this.gp.getResultData(x.jobId,
z))},this);return w},_handleOnCancel:function(x){this.itemParams?this._deleteItem(!0,x):this.emit("job-cancel",x)},cancel:function(x){this.jobParams.outputType&&this.jobParams.outputType===F.FLAYERVIEW?(this._doDeleteViewResult=!0,this._deleteItem(!0)):this.gp.cancelJob(x.jobId).then(n.hitch(this,function(w){"esriJobCancelled"===w.jobStatus&&this._handleOnCancel(w)}),function(w){})},checkJobStatus:function(x){this.signInPromise.then(n.hitch(this,function(){this.gp.setUpdateDelay(3E3);this._checkTimer=
setInterval(n.hitch(this,this._checkStatus,x,n.hitch(this,this._gpJobStatus),n.hitch(this,this._gpJobFailed)),3E3)}))},_checkStatus:function(x,w,A){this.gp.checkJobStatus(x,w,A)},_deleteItem:function(x,w){var A;if((A=q.id.findCredential(this.portalUrl).userId)&&this.itemParams){var z=u.isDefined(this.itemParams.folder)?this.itemParams.folder:"";A=this.portalUrl+"/sharing/rest/content/users/"+A+(z&&"/"!==z?"/"+z:"")+"/items/"+this.currentGpItemId+"/delete";v({url:A,content:{f:"json"}},{usePost:!0}).then(n.hitch(this,
this._handleItemDelete,x,w),n.hitch(this,this._handleDeleteItemError))}},_handleItemDelete:function(x,w,A){x&&this.emit("job-cancel",w)},_handleDeleteItemError:function(x){this.emit("job-fail",{message:x.message+(x.details?x.details.toString():""),jobParams:this.jobParams})},_initFolderStore:function(x,w){this._fportal=this.portalSelf?new x.Portal({url:this.portalUrl,self:this.portalSelf}):new x.Portal(this.portalUrl);this._fportal.signIn().then(n.hitch(this,function(A){this.portalUser=A;this.portalUser.getFolders().then(n.hitch(this,
function(z){z=C.createFolderStore(z,this.portalUser.username);w.resolve(z)}))}))},getFolderStore:function(){var x=new a,w,A,z,G;this.folderStore?x.resolve(this.folderStore):this.signInPromise.then(n.hitch(this,function(J){w=["../../arcgis/Portal"];A=this._counter++;z=this;this._rids&&this._rids.push(A);H(w,function(L){G=z._rids?r.indexOf(z._rids,A):-1;-1!==G&&(z._rids.splice(G,1),z._initFolderStore(L,x))})}));return x},_checkToolUrl:function(){var x=new a;this.analysisGpServer?(this._toolServiceUrl&&
this.gp||this.set("toolServiceUrl",this.analysisGpServer+"/"+this.toolName),x.resolve({success:!0})):this._getSelf(this.portalUrl).then(n.hitch(this,function(w){(this.analysisGpServer=w.helperServices.analysis&&w.helperServices.analysis.url?w.helperServices.analysis.url:null)&&this.set("toolServiceUrl",this.analysisGpServer+"/"+this.toolName);x.resolve({success:!0})}));return x},getCreditsEstimate:function(x,w,A){this.start=window.performance.now();var z,G,J,L,R,T={};var aa=new a;this._checkToolUrl().then(n.hitch(this,
function(ca){this._toolServiceUrl?L=this._toolServiceUrl:(J=this.portalUrl&&-1!==this.portalUrl.indexOf("dev")?"dev":this.portalUrl&&-1!==this.portalUrl.indexOf("qa")?"qa":"",L="http://analysis"+J+".arcgis.com/arcgis/rest/services/tasks/GPServer/"+this.toolName);this.useGPCreditTask?(R=this.portalSelf||this._portal,A?(z=R&&R.helperServices&&R.helperServices.rasterAnalytics.url?R.helperServices.rasterAnalytics.url+"/EstimateRasterAnalysisCost":L.replace("/tasks/GPServer/"+x,"/RasterAnalysisTools/GPServer/EstimateRasterAnalysisCost"),
T.name=x,T.parameters=w,ca=w.context,ca.cellSize=this.context.cellSize,!ca.extent&&this.context.extent&&(ca.extent=this.context.extent),ca={jobParams:{inputAnalysisTask:l.toJson(T),context:l.toJson(ca)},resultParameter:"outCost",def:aa,isGPCreditSync:!1}):(z=R&&R.helperServices&&R.helperServices.creditEstimation&&R.helperServices.creditEstimation.url?R.helperServices.creditEstimation.url+"/EstimateCredits":L.replace("/tasks/GPServer/"+x,"/Estimate/GPServer/EstimateCredits"),ca={jobParams:{taskName:x,
taskParameters:l.toJson(w)},resultParameter:"creditEstimate",def:aa,isGPCreditSync:this._isGPCreditSync}),this._getGPCreditEstimate(z,ca)):(z=L.replace("/"+x,"/exts/Estimate/"+x),G=n.mixin({f:"json"},w),v({url:z,content:G},{usePost:!0}).then(n.hitch(this,function(ba){this.end=window.performance.now();console.log("Analysis Credit Estimator SOE Sync Time : "+(this.end-this.start)+" milliseconds");aa.resolve(ba)}),function(ba){aa.resolve(ba)}))}));return aa.promise},_getGPCreditEstimate:function(x,w){this.creditGP=
new t(x);this.creditGP.setUpdateDelay(1E3);w.isGPCreditSync?this.creditGP.execute(w.jobParams,n.hitch(this,this._getGPCreditResult,w.def,w.resultParameter,w.isGPCreditSync),n.hitch(this,this._creditGPJobFailed,w.def,w.isGPCreditSync)):this.creditGP.submitJob(w.jobParams,n.hitch(this,this._getGPCreditResult,w.def,w.resultParameter,w.isGPCreditSync),n.hitch(this,this._creditGPJobFailed,w.def,w.isGPCreditSync),n.hitch(this,this._creditGPJobFailed,w.def,w.isGPCreditSync))},_getGPCreditResult:function(x,
w,A,z){A?(this.end=window.performance.now(),console.log("Analysis Credit Estimator GP Sync Time : "+(this.end-this.start)+" milliseconds"),x.resolve(z[0].value)):this.creditGP.getResultData(z.jobId,w).then(n.hitch(this,function(G,J){J&&J.value&&0<=J.value.credits&&(J.value.cost=J.value.credits);this.end=window.performance.now();console.log("Analysis Credit Estimator GP Async Time : "+(this.end-this.start)+" milliseconds");G.resolve(J.value)},x),n.hitch(this,function(G,J){G.resolve(J)},x))},_creditGPJobFailed:function(x,
w,A){w?!A.code||400!==A.code&&-1===A.code.indexOf("IdentityManagerBase.")?0===A.status&&A.message&&(A.messages=[A.message],x.resolve(this._buildErrorMsg(A))):(A.messages=A.details,x.resolve(A)):"esriJobFailed"!==A.jobStatus&&"esriJobCancelled"!==A.jobStatus||x.resolve(this._buildErrorMsg(A))},_signIn:function(x,w){var A,z;this.signInPromise=new a;if(w){w=["../../arcgis/Portal"];var G=this._counter++;var J=this;this._rids&&this._rids.push(G);H(w,n.hitch(this,function(L){A=J._rids?r.indexOf(J._rids,
G):-1;-1!==A&&(J._rids.splice(A,1),this._portal=this.portalSelf?new L.Portal({url:x,self:this.portalSelf}):new L.Portal(x),this._portal.signIn().then(n.hitch(this,function(R){this.portalUser=R;this._portal.helperServices&&this._portal.helperServices.analysis&&this._portal.helperServices.analysis.url?(this.analysisGpServer=this._portal.helperServices.analysis.url,this.showGeoAnalyticsParams&&this._portal.helperServices.geoanalytics&&(this.analysisGpServer=this._portal.helperServices.geoanalytics.url),
v({url:this.analysisGpServer,content:{f:"json"},callbackParamName:"callback"}).then(n.hitch(this,function(T){z=q.id.findCredential(this.analysisGpServer);this.signInPromise.resolve(z)}),n.hitch(this,function(T){this.signInPromise.reject(T)}))):this.signInPromise.resolve(R)}),n.hitch(this,this._handleSignInError)))}))}else v({url:x,content:{f:"json"},callbackParamName:"callback"}).then(n.hitch(this,function(L){L=q.id.findCredential(x);if(u.isDefined(L)){var R=q.id.findServerInfo(this._toolServiceUrl);
u.isDefined(R)&&u.isDefined(R.owningSystemUrl)&&(this.portalUrl=R.owningSystemUrl);this.signInPromise.resolve(L)}else q.id.getCredential(x).then(n.hitch(this,function(T){T=q.id.findCredential(x);R=q.id.findServerInfo(this._toolServiceUrl);u.isDefined(R)&&u.isDefined(R.owningSystemUrl)&&(this.portalUrl=R.owningSystemUrl);this.signInPromise.resolve(T)}),n.hitch(this,this._handleSignInError))}),n.hitch(this,this._handleSignInError));return this.signInPromise},_handleSignInError:function(x){this.emit("job-fail",
{message:this.i18n.analysisSignInErrorMsg,messageCode:"AB_0003"});this.signInPromise.reject(x)},_buildErrorMsg:function(x){var w="",A=[],z,G;this.errorHelpMap||this._initErrorHelpMap();A=r.filter(x.messages,function(J){if(("esriJobMessageTypeError"===J.type||"esriJobMessageTypeWarning"===J.type)&&-1!==J.description.indexOf("messageCode"))return J.description},this);0<A.length&&r.forEach(A,function(J){try{z=l.fromJson(J.description)}catch(L){z=J.description}G="";"esriJobMessageTypeWarning"===J.type&&
(x.type="warning");z.messageCode?(G=u.isDefined(this.i18n[z.messageCode])?this.i18n[z.messageCode]:z.message,G=u.isDefined(z.params)?h.substitute(G,z.params):G,w+=G+"\x26nbsp;",(J=this._addLearnMoreErrorLink(z.messageCode))&&(w+=J)):z.error&&z.error.messageCode?(G=u.isDefined(this.i18n[z.error.messageCode])?this.i18n[z.error.messageCode]:z.error.message,G=u.isDefined(z.error.params)?h.substitute(G,z.error.params):G,w+=G+"\x26nbsp;",(J=this._addLearnMoreErrorLink(z.error.messageCode))&&(w+=J)):w+=
z+"\x26nbsp;"},this);return w},_toolServiceUrlSetter:function(x){this._toolServiceUrl=x;this.gp=new t(x)},_setToolServiceUrlAttr:function(x){this._toolServiceUrl=x;this.gp=new t(x)},checkCreditLimitsAttr:function(x){this.checkCreditLimits=x},saveJobInfo:function(x){if(this.doSaveJobInfo&&this.currentGpItemId&&-1!==r.indexOf(["esriJobSucceeded"],x.jobStatus)){n.mixin(x.jobParams,{extentCheck:this._useExtentCheck&&this._useExtentCheck.get("checked")});r.forEach(x.messages,function(z){z.description=
C.safetagsReplace(z.description)},this);x={toolName:this.toolName,jobParams:x.jobParams,timestamp:Date.now(),portalUrl:this.portalUrl,jobInfo:{jobId:x.jobId,jobStatus:x.jobStatus,messages:x.messages,analysisServer:"bigdata"===this.analysisMode?"geoanalytics":"default"===this.analysisMode?"standard":this.analysisMode}};"CopyToDataStore"===this.toolName&&(x.jobParams.isSpatioTemporalDataStore=this._isSpatioTemporalDataStore);"bigdata"===this.analysisMode&&x.jobParams.timeStepReference&&(x.jobParams.timeReferenceType=
this.get("timeReferenceType"));"bigdata"===this.analysisMode&&x.jobParams.timeBoundaryReference&&(x.jobParams.timeBoundaryReferenceType=this.get("timeBoundaryReferenceType"));for(A in x.jobParams)if(x.jobParams.hasOwnProperty(A)&&u.isDefined(x.jobParams[A])){if("object"===typeof x.jobParams[A]&&x.jobParams[A].serviceToken||"string"===typeof x.jobParams[A]&&-1!==x.jobParams[A].indexOf("serviceToken")){var w="string"===typeof x.jobParams[A]?l.fromJson(x.jobParams[A]):x.jobParams[A];w&&w.serviceToken&&
(delete w.serviceToken,x.jobParams[A]="string"===typeof x.jobParams[A]?l.toJson(w):w)}if("object"===typeof x.jobParams[A]&&!n.isArray(x.jobParams[A])&&x.jobParams[A].filter||"string"===typeof x.jobParams[A]&&-1!==x.jobParams[A].search(/[<>]/g))"object"===typeof x.jobParams[A]&&x.jobParams[A].filter&&!n.isArray(x.jobParams[A])?x.jobParams[A].filter=C.safetagsReplace(x.jobParams[A].filter):"string"===typeof x.jobParams[A]&&-1!==x.jobParams[A].search(/[<>]/g)&&(x.jobParams[A]=C.safetagsReplace(x.jobParams[A]))}var A=
q.id.findCredential(this.portalUrl);this.currentGpItemId&&(A={id:this.currentGpItemId,folderId:this.itemParams.folder,owner:A.userId},B.addToItemResource(A,x));this.doSaveInStorage&&B.addToStorage(x)}},_initErrorHelpMap:function(){if(this.isSingleTenant){var x=H.toUrl("./help/errorhelpmap_enterprise.json");v({url:x}).then(n.hitch(this,function(w){this.errorHelpMap=w.map}))}},_addLearnMoreErrorLink:function(x){if(this.isSingleTenant){var w=this.portalSelf&&this.portalSelf.helpMap&&this.portalSelf.helpMap.m;
x=w&&w[this.errorHelpMap[x]];w=this&&this.portalSelf?this.portalSelf.helpBase:null;var A=this.analysisGpServer&&-1!==this.analysisGpServer.indexOf("dev")?"dev":this.analysisGpServer&&-1!==this.analysisGpServer.indexOf("qa")?"uat":"";if(u.isDefined(x)){var z="http://doc"+A+".arcgis.com/en/arcgis-online/analyze/"+x;this.isSingleTenant&&w?z=w+x:this.isSingleTenant&&!w&&(z="http://server"+A+".arcgis.com/en/portal/latest/use/"+x)}z&&(z="\x3cbr/\x3e\x3cbr/\x3e\x3cdiv class\x3d'esriHelpPopup'\x3e\x3ca class\x3d'action zoomTo' href\x3d'"+
z+"' target\x3d'_help'\x3e"+this.i18n.learnMore+"\x3c/a\x3e\x3c/div\x3e\x3cbr/\x3e\x3cbr/\x3e");return z}},getLearnMoreLink:function(x){return x?this._addLearnMoreErrorLink(x):""},_byPassCreditCheck:function(x){return-1!==this._freeGPTools.indexOf(x)}});k("extend-esri")&&n.setObject("dijit.analysis.AnalysisBase",m,q);return m})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F){H=H(h,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(x){this._jobUpdateHandler=m.hitch(this,this._jobUpdateHandler);this._getJobStatus=m.hitch(this,this._getJobStatus);this._getResultDataHandler=
m.hitch(this,this._getResultDataHandler);this._getResultImageHandler=m.hitch(this,this._getResultImageHandler);this._executeHandler=m.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(x){this.updateDelay=x},setProcessSpatialReference:function(x){this.processSpatialReference=x},setOutputSpatialReference:function(x){this._setOutSR(x)},setOutSpatialReference:function(x){this._setOutSR(x)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(x){this.outSpatialReference=this.outputSpatialReference=x},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(x,w,A){for(var z in x){var G=x[z];m.isArray(G)?x[z]=l.toJson(n.map(G,function(J){return this._gpEncode({item:J},!0).item},this)):G instanceof Date&&(x[z]=G.getTime())}return this._encode(x,w,A)},_decode:function(x){var w=x.dataType,
A=new y(x);if(-1!==n.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],w))return A;if("GPLinearUnit"===w)A.value=new q(A.value);else if("GPFeatureRecordSetLayer"===w||"GPRecordSet"===w)A.value=new c(A.value);else if("GPDataFile"===w)A.value=new u(A.value);else if("GPDate"===w)x=A.value,m.isString(x)?A.value=new t({date:x}):A.value=new Date(x);else if("GPRasterData"===w||"GPRasterDataLayer"===w)x=x.value.mapImage,A.value=x?new F(x):new v(A.value);else if(-1!==w.indexOf("GPMultiValue:")){var z=w.split(":")[1];
x=A.value;A.value=n.map(x,function(G){return this._decode({paramName:"_name",dataType:z,value:G}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+A.dataType),A=null;return A},submitJob:function(x,w,A,z,G){var J=this._getOutSR(),L=G.assembly;x=this._gpEncode(m.mixin({},this._url.query,{f:"json","env:outSR":J?J.wkid||l.toJson(J.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||l.toJson(this.processSpatialReference.toJson()):
null},x),null,L&&L[0]);var R=this._jobUpdateHandler,T=this._errorHandler;return d({url:this._url.path+"/submitJob",content:x,callbackParamName:"callback",load:function(aa,ca){R(aa,ca,!1,w,A,G.dfd)},error:function(aa){T(aa,z,G.dfd)}})},_jobUpdateHandler:function(x,w,A,z,G,J){var L=x.jobId;w=new g(x);this._successHandler([w],"onStatusUpdate",G,A&&J);if(!A)switch(clearTimeout(this._updateTimers[L]),this._updateTimers[L]=null,J&&J.progress(w),x.jobStatus){case g.STATUS_SUBMITTED:case g.STATUS_EXECUTING:case g.STATUS_WAITING:case g.STATUS_NEW:var R=
this._getJobStatus;this._updateTimers[L]=setTimeout(function(){R(L,A,z,G,J)},this.updateDelay);break;default:this._successHandler([w],"onJobComplete",z,J)}},_getJobStatus:function(x,w,A,z,G){var J=this._jobUpdateHandler;d({url:this._url.path+"/jobs/"+x,content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(L,R){J(L,R,w,A,z,G)},error:this._errorHandler})},_getResultDataHandler:function(x,w,A,z,G){try{var J=this._decode(x);this._successHandler([J],"onGetResultDataComplete",
A,G)}catch(L){this._errorHandler(L,z,G)}},getResultData:function(x,w,A,z){var G=this._getResultDataHandler,J=this._errorHandler,L=new r(f._dfdCanceller);L._pendingDfd=d({url:this._url.path+"/jobs/"+x+"/results/"+w,content:m.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(R,T){G(R,T,A,z,L)},error:function(R){J(R,z,L)}});return L},checkJobStatus:function(x,w,A){var z=this._jobUpdateHandler,G=this._errorHandler,J=new r(f._dfdCanceller);J._pendingDfd=
d({url:this._url.path+"/jobs/"+x,content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(L,R){z(L,R,!0,null,w,J)},error:function(L){G(L,A,J)}});return J},cancelJob:function(x,w,A){var z=this._errorHandler,G=new r(f._dfdCanceller);G._pendingDfd=d({url:this._url.path+"/jobs/"+x+"/cancel",content:m.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:m.hitch(this,function(J,L){this._successHandler([J],"onJobCancel",w,G)}),error:function(J){z(J,A,G)}});
return G},execute:function(x,w,A,z){var G=this._getOutSR(),J=z.assembly;x=this._gpEncode(m.mixin({},this._url.query,{f:"json","env:outSR":G?G.wkid||l.toJson(G.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||l.toJson(this.processSpatialReference.toJson()):null},x),null,J&&J[0]);var L=this._executeHandler,R=this._errorHandler;return d({url:this._url.path+"/execute",content:x,callbackParamName:"callback",load:function(T,aa){L(T,aa,w,A,z.dfd)},error:function(T){R(T,
A,z.dfd)}})},_executeHandler:function(x,w,A,z,G){try{var J=x.results,L,R=x.messages;var T=0;for(L=J.length;T<L;T++)J[T]=this._decode(J[T]);T=0;for(L=R.length;T<L;T++)R[T]=new p(R[T]);this._successHandler([J,R],"onExecuteComplete",A,G)}catch(aa){this._errorHandler(aa,z,G)}},_getResultImageHandler:function(x,w,A,z,G){try{var J=this._decode(x);this._successHandler([J],"onGetResultImageComplete",A,G)}catch(L){this._errorHandler(L,z,G)}},getResultImage:function(x,w,A,z,G){var J=this._getResultImageHandler,
L=this._errorHandler;A=this._gpEncode(m.mixin({},this._url.query,{f:"json"},A.toJson()));var R=new r(f._dfdCanceller);R._pendingDfd=d({url:this._url.path+"/jobs/"+x+"/results/"+w,content:A,callbackParamName:"callback",load:function(T,aa){J(T,aa,z,G,R)},error:function(T){L(T,G,R)}});return R},cancelJobStatusUpdates:function(x){clearTimeout(this._updateTimers[x]);this._updateTimers[x]=null},getResultImageLayer:function(x,w,A,z){if(null==w){var G=this._url.path.indexOf("/GPServer/");x=this._url.path.substring(0,
G)+"/MapServer/jobs/"+x}else x=this._url.path+"/jobs/"+x+"/results/"+w;this._url.query&&(x+="?"+b.objectToQuery(this._url.query));w=null==w?new B(x,{imageParameters:A}):new C(x,{imageParameters:A},!0);this.onGetResultImageLayerComplete(w);z&&z(w);return w},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});e._createWrappers(H);
k("extend-esri")&&m.setObject("tasks.Geoprocessor",H,a);return H})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(H,m,n,r,l){H=H(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(k){this.messages=[];m.mixin(this,k);k=this.messages;var b,a=k.length;for(b=0;b<a;b++)k[b]=new l(k[b])},jobId:"",jobStatus:""});m.mixin(H,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",
STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});n("extend-esri")&&m.setObject("tasks.JobInfo",H,r);return H})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(H,m,n,r){H=H(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(l){m.mixin(this,
l)}});m.mixin(H,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});n("extend-esri")&&m.setObject("tasks.GPMessage",H,r);return H})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(H,m,n,r){H=H(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(l){l&&m.mixin(this,l)},distance:0,units:null,toJson:function(){var l={};this.distance&&(l.distance=this.distance);this.units&&(l.units=this.units);return l}});n("extend-esri")&&m.setObject("tasks.LinearUnit",H,r);return H})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(H,m,n,r){H=H(null,{declaredClass:"esri.tasks.DataFile",
constructor:function(l){l&&m.mixin(this,l)},url:null,itemID:null,toJson:function(){var l={};this.url&&(l.url=this.url);this.itemID&&(l.itemID=this.itemID);return l}});n("extend-esri")&&m.setObject("tasks.DataFile",H,r);return H})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(H,m,n,r){H=H(null,{declaredClass:"esri.tasks.RasterData",constructor:function(l){l&&m.mixin(this,l)},url:null,format:null,itemID:null,toJson:function(){var l=
{};this.url&&(l.url=this.url);this.format&&(l.format=this.format);this.itemID&&(l.itemID=this.itemID);return l}});n("extend-esri")&&m.setObject("tasks.RasterData",H,r);return H})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(H,m,n,r,l){H=H(null,{declaredClass:"esri.tasks.Date",constructor:function(k){k&&(k.format&&(this.format=k.format),this.date=n.parse(k.date,{selector:"date",datePattern:this.format}))},date:new Date,
format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:n.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}});r("extend-esri")&&m.setObject("tasks.Date",H,l);return H})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(H,m,n,r){H=H(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(l){m.mixin(this,l)}});n("extend-esri")&&m.setObject("tasks.ParameterValue",H,r);return H})},
"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(H,m,n,r,l,k,b){H=H(b,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(a,d){d&&d.imageParameters&&d.imageParameters.extent&&(this.initialExtent=this.fullExtent=d.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=m.hitch(this,this.getImageUrl);
this.loaded=!0;this.onLoad(this)},getImageUrl:function(a,d,f,e){var h=a.spatialReference.wkid;e(this._url.path+"?"+l.objectToQuery(m.mixin(this._params,{f:"image",bbox:n.toJson(a.toJson()),bboxSR:h,imageSR:h,size:d+","+f})))}});r("extend-esri")&&m.setObject("tasks._GPResultImageLayer",H,k);return H})},"esri/dijit/analysis/utils":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/_base/fx dojo/_base/json dojo/_base/kernel dojo/dom-attr dojo/has dojo/i18n dojo/io-query dojo/i18n!../../nls/jsapi dojo/json dojo/string dojo/query dojo/date/locale dojo/dom-style dojo/dom-class dojo/dom-construct dojo/Deferred dojo/promise/all dojo/fx/easing dojo/number dojo/_base/window dojo/when dojo/dom dojo/on dojo/data/ItemFileWriteStore dojo/topic dojo/store/Memory dojox/mvc/equals dijit/registry dijit/Dialog dijit/form/CheckBox ../../kernel ../../lang ../../units ../../request ./HelpWindow ../../tasks/query ../../dijit/BrowseItems ../../layers/FeatureLayer ./PluginAnalysisLayers ../../tasks/Geoprocessor ../../dijit/SingleFilter ./FeatureRecordSetLayer ./PluginLayers ./PCSList ./ItemTypes ../../layers/ArcGISImageServiceLayer ../../layers/RasterXLayer ../../layers/RasterFunction ./AnalysisRegistry ../RasterFunctionEditor/utils".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da,Q,K,E,N,I,O,U,ha,ia,S,W,ka,ja,ma,ta){m={};n.mixin(m,{_helpDialog:null,systemRFTGroupName:"Raster Function Templates",i18n:null,UNITSMAP:{Feet:"esriFeet",Yards:"esriYards",Miles:"esriMiles",Meters:"esriMeters",Kilometers:"esriKilometers",NauticalMiles:"esriNauticalMiles"},initHelpLinks:function(D,P,Y){if(D){var Z=ca.byNode(D),V=Z?Z.get("helpFileName"):Y&&Y.helpFileName?Y.helpFileName:null,ea=Z?Z.get("isSingleTenant"):
Y&&Y.isSingleTenant?Y.isSingleTenant:!1,na=ma.Modes.standard,pa=Z&&Z.portalSelf?Z.portalSelf.helpBase:Y&&Y.helpBase?Y.helpBase:null,sa=Z&&Z.portalSelf;this._helpDialog||(this._helpDialog=new da({isPortal:ea,portalSelf:sa}));Z&&(Z.showGeoAnalyticsParams||Z.showBigData)||Y&&Y.analysisMode&&Y.analysisMode===ma.Modes.Bigdata?(V+="_bd",na=ma.Modes.Bigdata):Y&&Y.analysisMode&&"raster"===Y.analysisMode&&(V+="_ra",na=ma.Modes.Raster);u("[esriHelpTopic]",D).forEach(function(ua,Aa,wa){ua&&(t.set(ua,"display",
fa.isDefined(P)&&!0!==P?"none":""),fa.isDefined(ua._helpClickHandler)&&(ua._helpClickHandler.remove(),ua._helpClickHandler=null),ua._helpClickHandler=J(ua,"click",n.hitch(this,function(va){k.stop(va);Y&&Y.showHelpFromUrl&&Y.helpUrl?this._helpDialog.show(va,{showHelpFromUrl:Y.showHelpFromUrl,helpUrl:Y.helpUrl}):this._helpDialog.show(va,{helpId:f.get(ua,"esriHelpTopic"),helpFileName:V,analysisGpServer:Y&&Y.analysisGpServer?Y.analysisGpServer:null,helpParentNode:D,isPortal:ea,analysisMode:na,helpBase:pa,
portalSelf:Z&&Z.portalSelf})})))},this)}},constructAnalysisFeatColl:function(D){var P={},Y;P.featureCollection=D.layerDefinition;for(Y in P.featureCollection)P.featureCollection.hasOwnProperty(Y)&&"objectIdField"===Y&&(P.featureCollection.objectIdFieldName=n.clone(P.featureCollection.objectIdField),delete P.featureCollection.objectIdField);P.featureCollection.features=D.featureSet.features;return P},constructAnalysisInputLyrObj:function(D,P,Y){if(D instanceof W||"Image Service"===D.type||"esri.layers.RasterXLayer"===
D.declaredClass)return ta.getRasterJsonFromLayer(D);var Z={},V="";fa.isDefined(Y)||(Y=!0);if(D.getMap)var ea=D.getMap();else D._map&&(ea=D._map);if(D.url&&!D._collection)Z={url:D.url},this.isHostedService(D.url),D.getDefinitionExpression&&D.getDefinitionExpression()?Z.filter=D.getDefinitionExpression():fa.isDefined(D.definitionExpression)&&""!==D.definitionExpression&&(Z.filter=D.definitionExpression),D.useMapTime&&D.timeInfo&&ea&&ea.timeExtent&&Y&&(ea.timeExtent.startTime?(V+=ea.timeExtent.startTime.getTime(),
ea.timeExtent.endTime&&(V+=","+ea.timeExtent.endTime.getTime())):ea.timeExtent.endTime&&(V+=ea.timeExtent.endTime.getTime()),V&&(Z.time=V)),D.credential&&(Z.serviceToken=D.credential.token),-1!==Z.url.indexOf("?")&&(Y=Z.url.substring(Z.url.indexOf("?")+1,Z.url.length),Y=c.queryToObject(Y),n.mixin(Z,Y),Z.url=Z.url.substring(0,Z.url.indexOf("?")));else if(!D.url||D._collection)try{Z=D.toJson()}catch(na){D._json=p.parse(D._json),Z=D.toJson()}Z.name=D.name;P&&(Z=new U(Z));return Z},formatDate:function(D){return v.format(D,
{datePattern:"yyyy-MM-dd",selector:"date"})+" "+v.format(D,{selector:"time",timePattern:"HH:mm:ss"})},isHostedService:function(D){if(!D)return!1;var P=-1!==D.indexOf(".arcgis.com/");D=-1!==D.indexOf("/services")||-1!==D.indexOf("//tiles")||-1!==D.indexOf("//features");return P&&D},isPortalHostedService:function(D){return D?-1!==D.toLowerCase().indexOf("/hosted/"):!1},isTimeEnabled:function(D){var P=10.2<=D.version&&D._useStandardizedQueries;return D.useMapTime&&D.timeInfo&&(P||10.2<=D.version)||fa.isDefined(D.time)},
isTimeInstantLayer:function(D){return fa.isDefined(D.timeInfo)&&fa.isDefined(D.timeInfo.startTimeField)&&!fa.isDefined(D.timeInfo.endTimeField)||fa.isDefined(D.time)&&fa.isDefined(D.time.timeType)&&"instant"===D.time.timeType},buildReport:function(D,P){var Y="";P||(P={},n.mixin(P,g.analysisMsgCodes));r.forEach(D,function(Z,V){if("string"===typeof Z.message){var ea=fa.isDefined(P[Z.messageCode])?P[Z.messageCode]:Z.message;Y+=Z.style.substring(0,Z.style.indexOf("\x3c/"))+(this._isEmptyObject(Z.params)?
ea:q.substitute(ea,Z.params))+Z.style.substring(Z.style.indexOf("\x3c/"))}else if(n.isArray(Z.message)){var na=[];var pa=n.clone(Z.style);r.forEach(Z.message,function(sa,ua){pa=pa.replace(/<\//,"${"+ua+"}");ea=fa.isDefined(P[Z.messageCode+"_"+ua])?P[Z.messageCode+"_"+ua]:sa;ea=this._isEmptyObject(Z.params)?ea:q.substitute(ea,Z.params);"string"===typeof ea&&(ea=this.safetagsReplace(ea));na.push(ea+"\x3c/")},this);pa=q.substitute(pa,na);Y+=pa}},this);return Y},getLayerFeatureCount:function(D,P){var Y=
new Q,Z=new B;P||(P={});Y.geometry=P.geometry;Y.geometryType=P.geometryType||"esriGeometryEnvelope";D.url||Y.geometry?(D.url&&(Y.where=P.where||"1\x3d1",D.getDefinitionExpression&&D.getDefinitionExpression()&&!P.where?Y.where=D.getDefinitionExpression():fa.isDefined(D.definitionExpression)&&""!==D.definitionExpression&&!P.where&&(Y.where=D.definitionExpression)),Z=D.queryCount(Y)):Z.resolve(D.graphics.length);return Z.promise},createPolygonFeatureCollection:function(D){var P={layerDefinition:null,
featureSet:{features:[],geometryType:ma.GeometryTypes.Polygon}};P.layerDefinition={currentVersion:10.2,copyrightText:"",defaultVisibility:!0,relationships:[],isDataVersioned:!1,supportsRollbackOnFailureParameter:!0,supportsStatistics:!0,supportsAdvancedQueries:!0,geometryType:ma.GeometryTypes.Polygon,minScale:0,maxScale:0,objectIdField:"OBJECTID",templates:[],type:"Feature Layer",displayField:"TITLE",visibilityField:"VISIBLE",name:D,hasAttachments:!1,typeIdField:"TYPEID",capabilities:"Query",allowGeometryUpdates:!0,
htmlPopupType:"",hasM:!1,hasZ:!1,globalIdField:"",supportedQueryFormats:"JSON",hasStaticData:!1,maxRecordCount:-1,indexes:[],types:[],drawingInfo:{renderer:{type:"simple",symbol:{color:[0,0,0,255],outline:{color:[0,0,0,255],width:3,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSNull"},label:"",description:""},transparency:0,labelingInfo:null,fixedSymbols:!0},fields:[{alias:"OBJECTID",name:"OBJECTID",type:"esriFieldTypeOID",editable:!1},{alias:"Title",name:"TITLE",length:50,type:"esriFieldTypeString",
editable:!0},{alias:"Visible",name:"VISIBLE",type:"esriFieldTypeInteger",editable:!0},{alias:"Description",name:"DESCRIPTION",length:1073741822,type:"esriFieldTypeString",editable:!0},{alias:"Type ID",name:"TYPEID",type:"esriFieldTypeInteger",editable:!0}]};return P},createPointFeatureCollection:function(D){var P={layerDefinition:null,featureSet:{features:[],geometryType:ma.GeometryTypes.Point}};P.layerDefinition={objectIdField:"OBJECTID",templates:[],type:"Feature Layer",drawingInfo:{renderer:{field1:"TYPEID",
type:"simple",symbol:{height:24,xoffset:0,yoffset:12,width:24,contentType:"image/png",type:"esriPMS",url:H.toUrl("./images/GreenStickpin.png")},description:"",value:"0",label:"Stickpin"}},displayField:"TITLE",visibilityField:"VISIBLE",name:D,hasAttachments:!1,typeIdField:"TYPEID",capabilities:"Query",types:[],geometryType:ma.GeometryTypes.Point,fields:[{alias:"OBJECTID",name:"OBJECTID",type:"esriFieldTypeOID",editable:!1},{alias:"Title",name:"TITLE",length:50,type:"esriFieldTypeString",editable:!0},
{alias:"Visible",name:"VISIBLE",type:"esriFieldTypeInteger",editable:!0},{alias:"Description",name:"DESCRIPTION",length:1073741822,type:"esriFieldTypeString",editable:!0},{alias:"Type ID",name:"TYPEID",type:"esriFieldTypeInteger",editable:!0}]};return P},createFolderStore:function(D,P){var Y=new L({data:{identifier:"id",label:"name",items:[]}});Y.newItem({name:P,id:""});r.forEach(D,function(Z){Y.newItem({name:Z.title,id:Z.id})});return Y},setupFoldersUI:function(D){D.folderSelect.set("store",D.folderStore);
D.folderSelect.set("required",!0);D.folderSelect.set("searchAttr","name");fa.isDefined(D.folderId)?D.folderStore.get(D.folderId).then(n.hitch(this,function(P){fa.isDefined(P)?D.folderSelect.set("item",P):D.folderStore.get("").then(function(Y){D.folderSelect.set("item",Y)},this)})):D.folderName?D.folderStore.fetch({query:{name:D.folderName},onComplete:n.hitch(this,function(P){fa.isDefined(P)&&0<P.length?D.folderSelect.set("item",P[0]):D.folderStore.get("").then(function(Y){D.folderSelect.set("item",
Y)},this)})}):D.username?D.folderSelect.set("displayedValue",D.username):D.folderStore.get("").then(function(P){D.folderSelect.set("item",P)},this)},_isEmptyObject:function(D){for(var P in D)if(D.hasOwnProperty(P))return!1;return!0},validateServiceName:function(D,P){var Y=/(:|&|<|>|%|#|\?|\\|"|\/|\+|=|\*|@|'|;|\||,)/g.test(D),Z=!0,V=!0;if(fa.isDefined(P)&&P.textInput)var ea=P.textInput;fa.isDefined(P)&&fa.isDefined(P.isItem)&&(V=P.isItem);this.initI18n();if(0===D.length||0===q.trim(D).length){var na=
this.i18n.requiredValue;Z=!1}else if(Y)na=this.i18n.invalidServiceName,Z=!1;else if(V&&98<D.length)na=this.i18n.invalidServiceNameLength,Z=!1;else if(V&&170<encodeURIComponent(D).length){for(D+="";170<encodeURIComponent(D).length;)D=D.substring(0,D.length-1);na=q.substitute(this.i18n.suggestedServiceNameLength,{count:D.length});Z=!1}ea&&!Z&&ea.set("invalidMessage",na);return Z},getStepNumber:function(D){u(".esriAnalysisNumberLabel",D).forEach(function(P,Y){Y=this._getNumberLabel(Y);f.set(P,"innerHTML",
Y)},this)},_getNumberLabel:function(D){var P="";this.initI18n();switch(D){case 0:P=this.i18n.oneLabel;break;case 1:P=this.i18n.twoLabel;break;case 2:P=this.i18n.threeLabel;break;case 3:P=this.i18n.fourLabel;break;case 4:P=this.i18n.fiveLabel;break;case 5:P=this.i18n.sixLabel;break;case 6:P=this.i18n.sevenLabel;break;case 7:P=this.i18n.eightLabel;break;case 8:P=this.i18n.nineLabel;break;case 9:P=this.i18n.tenLabel;break;case 10:P=this.i18n.elevenLabel;break;case 11:P=this.i18n.twelveLabel;break;case 12:P=
this.i18n.thirteenLabel}return P},populateAnalysisLayers:function(D,P,Y,Z){if(D){var V=[],ea=D.get(P);P=Z&&Z.layerSelect?Z.layerSelect:D._analysisSelect;D.rerun&&!ea&&(Z||(Z={}),Z.chooseBlank=!0);D._titleRow&&t.set(D._titleRow,"display","none");D._analysisLabelRow&&t.set(D._analysisLabelRow,"display","table-row");D._selectAnalysisRow&&(t.set(D._selectAnalysisRow,"display","table-row"),t.set(D._analysisSelect.domNode.parentNode,"padding-bottom","1em"));D.domNode&&this.getStepNumber(D.domNode);fa.isDefined(Z)&&
Z.chooseLabel&&V.push({value:-1,label:this.i18n.chooseLabel});fa.isDefined(Z)&&Z.chooseBlank&&V.push({value:"  ",label:""});fa.isDefined(Z)&&fa.isDefined(Z.posIncrement)||(fa.isDefined(Z)||(Z={}),Z.posIncrement=0);D.get(Y)||D.set(Y,[]);r.forEach(D.get(Y),function(na,pa){pa+=Z.posIncrement;pa={value:fa.isDefined(Z)&&Z.chooseLabel?""+pa+1:""+pa,label:na.name};ea&&(na.name===ea.name||na.url&&ea.url&&na.url===ea.url)&&(pa.selected=!0);V.push(pa)},this);P.addOption(V);P.set("required",!0);Z.chooseBlank&&
"  "===P.get("value")&&setTimeout(n.hitch(this,this._validateSelectUI,P),100)}},isValidAnalysisLayer:function(D){var P="",Y=!0;var Z={isValid:Y,validationMessage:P};var V,ea,na=0,pa=0,sa=0,ua,Aa,wa,va=!0;if(!fa.isDefined(D)||!fa.isDefined(D.toolName))return Z;this.initI18n();Z=D.toolName;var ra=D.layers;var qa=D.analysisLayer;var ya=Z.charAt(0).toLowerCase()+Z.substring(1);var Ba=this.i18n;D=D.showReadyToUseLayers||!1;r.forEach(ra,function(Ca){va=!1;if(Ca instanceof W||"esri.layers.RasterXLayer"===
Ca.declaredClass)ua=!0;ua&&1<Ca.bandCount&&(Aa=!0);ua&&1===Ca.bandCount&&(wa=!0);Ca.geometryType===ma.GeometryTypes.Point&&(La=!0,na++);if(Ca.geometryType===ma.GeometryTypes.Point||Ca.geometryType===ma.GeometryTypes.MultiPoint)V=!0;Ca.geometryType===ma.GeometryTypes.Line&&(ea=!0,sa++);Ca.geometryType===ma.GeometryTypes.Polygon&&(Fa=!0,pa++)},this);if(-1!==r.indexOf(["CreateDriveTimeAreas","PlanRoutes","ConnectOriginsToDestinations"],Z)&&(!La||qa&&qa.geometryType!==ma.GeometryTypes.Point))P=q.substitute(this.i18n.selectPointLayer,
{toolName:Ba[ya]}),Y=!1;else if("AggregatePoints"!==Z&&"InterpolatePoints"!==Z||(!qa||qa.geometryType===ma.GeometryTypes.Point||qa.geometryType===ma.GeometryTypes.MultiPoint)&&V)if("CalculateDensity"===Z&&(!V&&!ea||qa&&qa.geometryType!==ma.GeometryTypes.Point&&qa.geometryType!==ma.GeometryTypes.MultiPoint&&qa.geometryType!==ma.GeometryTypes.Line))P=q.substitute(this.i18n.areaFeatureInvalidMsg,{toolName:Ba[ya]}),Y=!1;else if("FindHotSpots"!==Z&&"FindOutliers"!==Z||D||!(!V&&!Fa||qa&&qa.geometryType!==
ma.GeometryTypes.Point&&qa.geometryType!==ma.GeometryTypes.MultiPoint&&qa.geometryType!==ma.GeometryTypes.Polygon))if("OverlayLayers"!==Z&&"AggregatePoints"!==Z&&"SummarizeWithin"!==Z&&"SummarizeNearby"!==Z&&"FindNearest"!==Z&&"MergeLayers"!==Z||D||0!==ra.length&&(1!==ra.length||ra[0]!==qa&&fa.isDefined(qa)))if("ConnectOriginsToDestinations"===Z&&!D&&(va||2>na))P=q.substitute(this.i18n.odPointMsg,{toolName:Ba[ya]}),Y=!1;else if(this.isFindCentroids(Z)&&this.isPointLayer(qa))P=q.substitute(this.i18n.selectNoPointLayer,
{toolName:Ba[ya]}),Y=!1;else if("AggregatePoints"===Z&&!D&&1<ra.length){var Fa=r.some(ra,function(Ca){return Ca.geometryType===ma.GeometryTypes.Polygon});Fa||(P=q.substitute(this.i18n.aggregatePolyMsg,{toolName:Ba[ya]}),Y=!1)}else if("MergeLayers"===Z&&!D&&1<ra.length)1<na||1<sa||1<pa||(P=this.i18n.mergeValidationMsg,Y=!1);else if("SummarizeWithin"!==Z&&"DissolveBoundaries"!==Z||(!qa||qa.geometryType===ma.GeometryTypes.Polygon)&&Fa||D)if("ExtractData"===Z)(Y=r.some(ra,function(Ca){return-1!==Ca.capabilities.indexOf("Extract")}))||
(P=q.substitute(this.i18n.extractValidationMsg));else if(("ConnectOriginsToDestinations"===Z||Z===ma.Tools.ChooseBestFacilities)&&1<ra.length){var La=r.some(ra,function(Ca){var Ia=fa.isDefined(qa)&&qa.id===Ca.id;return Ca.geometryType===ma.GeometryTypes.Point&&!Ia});La||(P=q.substitute(Z===ma.Tools.ChooseBestFacilities?this.i18n.selectPointLayer:this.i18n.odPointMsg,{toolName:Ba[ya]}),Y=!1)}else"CalculateSlope"===Z||"DeriveAspect"===Z||"RemapValues"===Z?ua?wa||(Y=!1,P=q.substitute(this.i18n.noSingleBandISMsg,
{toolName:Ba[ya]})):(Y=!1,P=q.substitute(this.i18n.noImageServiceMsg,{toolName:Ba[ya]})):"ExtractRaster"===Z?ua||(Y=!1,P=q.substitute(this.i18n.noImageServiceMsg,{toolName:Ba[ya]})):"MonitorVegetation"===Z&&(ua?Aa||(Y=!1,P=q.substitute(this.i18n.noMultiBandISMsg,{toolName:Ba[ya]})):(Y=!1,P=q.substitute(this.i18n.noImageServiceMsg,{toolName:Ba[ya]})));else P=q.substitute(this.i18n.selectPolyLayer,{toolName:Ba[ya]}),Y=!1;else P=q.substitute(this.i18n.overlayValidationMsg,{toolName:Ba[ya]}),Y=!1;else P=
q.substitute(this.i18n.hotspotsLineFeatureMsg,{toolName:Ba[ya]}),Y=!1;else P=q.substitute(this.i18n.selectPointLayer,{toolName:Ba[ya]}),Y=!1;return Z={isValid:Y,validationMessage:P}},isFindCentroids:function(D){return D===ma.Tools.FindCentroids},isPointLayer:function(D){return D&&D.geometryType===ma.GeometryTypes.Point},initI18n:function(){this.i18n||(this.i18n={},n.mixin(this.i18n,g.common),n.mixin(this.i18n,g.analysisTools),n.mixin(this.i18n,g.analysisMsgCodes),n.mixin(this.i18n,g.browseLayersDlg),
n.mixin(this.i18n,g.driveTimes),n.mixin(this.i18n,g.calculateFields))},addBrowseAnalysisDialog:function(D){if(D&&D.widget){this.i18n||this.initI18n();var P="esri/dijit/analysis/PluginAnalysisLayers",Y=function(ra){return"\x3cimg class\x3d'grid-item galleryThumbnail' width\x3d'120px' height\x3d'80px' alt\x3d'' src\x3d'"+(ra.thumbnailUrl||this._portal.staticImagesUrl+"/desktopapp.png")+"'\x3e"},Z=function(ra){return'\x3cdiv class\x3d"galleryLabelContainer"\x3e\x3cspan alt\x3d\''+(ra.title||ra.name||
"\x3cNo Title\x3e")+"'\x3e"+(ra.title.replace(/_/g," ")||ra.name.replace(/_/g," ")||"\x3cNo Title\x3e")+"\x3c/span\x3e\x3c/div\x3e"},V=function(ra){return"\x3cimg class\x3d'grid-item-thumb' width\x3d'16px' height\x3d'16px' alt\x3d'' src\x3d'"+ra.iconUrl+"'/\x3e"},ea=function(ra){return"\x3cimg class\x3d'grid-item-thumb' width\x3d'16px' height\x3d'16px' alt\x3d'' src\x3d'"+ra.iconUrl+"'/\x3e"},na=A.doc.createDocumentFragment();na=C.create("div",{style:"width:100%;height:100%;"},na);var pa=C.create("div",
{style:"width:100%;height:10%;","class":""}),sa=C.create("div",{style:"width:100%"},na),ua=this._isCustomAnalysisQuery(D.widget);1===D.browseType?(P="esri/dijit/analysis/PluginLayers",P={portalUrl:D.widget.get("portalUrl"),message:"",plugin:P,sortDescending:!0,sort:"title",self:D.widget.get("portalSelf"),itemsPerPage:100,demandList:!0,extent:D.widget.get("map").extent,useExtent:!1,fetchTimeout:600,galleryTemplate:"\x3cdiv class\x3d'listServiceTitle'\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' width\x3d'100%'\x3e\x3ctr width\x3d'100%'\x3e\x3ctd nowrap\x3d'nowrap'\x3e  \x3cdiv  style\x3d\"position:absolute;left:80px; top:10px; width:1px; height:1px; background: transparent;\"\x3e\x3c/div\x3e\x3cdiv style\x3d'overflow:hidden;'\x3e\x3ca style\x3d\"height:16px;\"\x3e${item.title}\x3c/a\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' width\x3d'100%'\x3e\x3ctr width\x3d'100%' class\x3d'bottomRowTable'\x3e\x3ctd width\x3d'20'\x3e  \x3cspan class\x3d'esriAlignLeading'\x3e${item:_formatThumbnail}\x3c/span\x3e\x3c/td\x3e\x3ctd nowrap\x3d'nowrap'\x3e  \x3cspan class\x3d'esriAlignLeading' style\x3d'color:#656565;'\x3e${item.owner}\x3c/span\x3e\x3c/td\x3e\x3ctd style\x3d'padding-right:5px;padding-left:3px;'\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e",
showInfoPanel:!0,isAutoClose:!1,checkIsButtonEnabled:!0,formatThumbnail:ea,formatInfoPanelImage:V,"class":"esriAnalysisLayersItems"}):P={portalUrl:D.widget.get("portalUrl"),message:"",plugin:P,sortDescending:!0,sort:"title",self:D.widget.get("portalSelf"),pagingLinks:1,rowsPerPage:6,"class":"esriBrowseAnalysisLayers itemsGallery esriFloatLeading",extent:D.widget.get("map").extent,useExtent:!ua,fetchTimeout:600,galleryTemplate:'\x3cdiv style\x3d\'opacity:1;\' class\x3d\'grid-item gallery-view galleryNode\'\x3e${item:_formatItemTitle}${item:_formatThumbnail}\x3cdiv class\x3d"linksDiv" style\x3d\'display:none;\'\x3e\x3cdiv class\x3d"esriItemLinks"\x3e\x3cdiv class\x3d"esriFloatLeading"\x3e\x3ca style\x3d"text-decoration: none;"\x3e\x3cspan\x3eAdd layer to analysis\x3c/span\x3e\x3cdiv class\x3d"dijitReset dijitInline esriArrows"\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
formatItemTitle:Z,showInfoPanel:!1,showTooltip:!0,formatThumbnail:Y,style:"width:48em;height:100%;clear:both;"};Z=C.toDom('\x3cdiv class\x3d"esriBrowseOptions"\x3e');C.place(Z,pa);Y=C.create("div",{"class":"esriBrowseOption"},Z);if(!D.browseType||1!==D.browseType){Z=C.create("div",{"class":"esriBrowseOption"},Z);var Aa=new la({name:"addlayer",id:D.widget.id+(D.browseType?D.browseType:"")+"_addlayercheck","class":"",value:!1,checked:!1},C.create("input",{},Z));C.create("label",{"for":D.widget.id+"_addlayercheck",
"class":"esriBrowseOption_label",innerHTML:this.i18n.addLayer},Z)}Z=!0;D.browseType&&1===D.browseType?Z=!1:ua&&(Z=!1);Z=new la({name:"extentcheck",id:D.widget.id+(D.browseType?D.browseType:"")+"_addextentcheck","class":"",value:Z,checked:Z},C.create("input",{},Y));C.create("label",{"for":D.widget.id+(D.browseType?D.browseType:"")+"_addextentcheck","class":"esriBrowseOption_label",innerHTML:this.i18n.withinMapArea},Y);P.messageRight=pa;var wa=new K(P,sa);Z.on("change",n.hitch(this,function(ra){wa.set("useExtent",
ra)}));var va=new ba({title:1===D.browseType?this.i18n.browseLayers:ua?this.i18n.browseAnalysisLayers:this.i18n.browseAnalysisTitle,content:na,browseItems:wa,addlayerCheckBox:Aa,style:D.browseType&&1===D.browseType?"":"padding:.75em 0;background-color: #fff;width:50em;"});D.widget.own(va.on("hide",n.hitch(va,function(ra){va.browseItems.reset()})));return va}},addAnalysisReadyLayer:function(D,P){function Y(wa){var va;if("Feature Service"===ea.type){var ra=new E(ea.url,{outFields:["*"]});n.mixin(ea,
ra)}"Image Service"===ea.type&&(ra=-1<wa.capabilities.indexOf("TilesOnly")?new ka(ea.url,{outFields:["*"]}):new W(ea.url,{outFields:["*"]}),n.mixin(ea,ra));n.mixin(ea,wa);ea.id=ea.title+"_"+wa.id;ea.title=D.item.selectedLayer?ea.title+"-"+wa.name:ea.title.replace(/_/g," ");ea.name=ea.title;ea.version=ea.currentVersion;if(pa&&D.widget.showBrowseLayers){var qa=(va=D.layersSelect.get("store"))&&va.data;va=2;va=qa.splice(qa.length-va,va);var ya={id:qa.length,label:ea.title,name:ea.title,url:ea.url};qa.push(ya);
qa=qa.concat(va);va=new T({data:qa,idProperty:"id"});D.layersSelect.set("store",va);D.layersSelect.set("value",ya.name)}else{qa=D.layersSelect.getOptions();if(D.widget.useArcGISComponents&&(D.widget.showBrowseLayers||D.widget.showReadyToUseLayers))va=2;else if(D.widget.showBrowseLayers&&D.widget.showReadyToUseLayers)va=3;else if(D.widget.showBrowseLayers||D.widget.showReadyToUseLayers)va=2;va=qa.splice(qa.length-va,va);D.layersSelect.removeOption(va);qa=D.layers.length;D.posIncrement&&(qa+=D.posIncrement);
qa=""+qa;va.unshift({value:qa,label:ea.title,selected:!0});D.layersSelect.addOption(va);D.layersSelect.set("value",qa)}ra&&(ea.lyr=ra,ra.name=ea.name);ea.linfo=wa;D.layers.push(ea);if(D.browseDialog.addlayerCheckBox&&D.browseDialog.addlayerCheckBox.get("checked")||na||P)this._addLayerHandle&&this._addLayerHandle.remove(),this._addLayerHandle=D.widget.map.on("layer-add",n.hitch(this,function(Ba){this._addLayerHandle.remove();D.widget.emit("add-ready-to-use-layer",{layer:Ba.layer,layerInfo:wa,item:ea})})),
D.widget.map.addLayer(ra);D.browseDialog.browseItems&&D.browseDialog.browseItems.clear()}if(fa.isDefined(D)&&fa.isDefined(D.item)&&fa.isDefined(D.layersSelect)&&fa.isDefined(D.layers)&&fa.isDefined(D.browseDialog)){D.browseDialog.hide&&D.browseDialog.hide();var Z,V;(Z=!D.item.selectedLayer&&D.item.url?D.item.type===S.IS?D.item.url:D.item.url+"/0":D.item.selectedLayer.url)&&-1!==window.location.protocol.indexOf("https:")&&(Z=Z.replace("http:","https:"));var ea={url:Z,itemId:D.item.id,title:D.item.title,
type:D.item.type,analysisReady:!0};Z=r.some(D.layers,function(wa,va){var ra=wa.analysisReady&&ea.analysisReady&&wa.itemId===ea.itemId;D.item.selectedLayer&&D.item.selectedLayer.url&&(ra=wa.itemId&&ea.itemId?wa.itemId===ea.itemId&&wa.url===ea.url:wa.url===ea.url);ra&&(V=va);return ra});var na;D.browseDialog.browseItems&&u(".js-add-layer-checkbox",D.browseDialog.browseItems.infoPanel).forEach(function(wa){na=wa.checked});var pa=-1!==D.layersSelect.baseClass.indexOf("dijitComboBox");var sa=new B;var ua=
"sync";if(Z){D.posIncrement&&(V+=D.posIncrement);if(D.browseDialog.addlayerCheckBox&&D.browseDialog.addlayerCheckBox.get("checked")||na||P){D.posIncrement||(D.posIncrement=0);var Aa=D.layers[V-D.posIncrement];D.widget.map.getLayer(Aa.lyr.id)||(this._addLayerHandle&&this._addLayerHandle.remove(),this._addLayerHandle=D.widget.map.on("layer-add",n.hitch(this,function(wa){this._addLayerHandle.remove();D.widget.emit("add-ready-to-use-layer",{layer:wa.layer,layerInfo:Aa.linfo,item:Aa})})),D.widget.map.addLayer(Aa.lyr))}pa?
D.layersSelect.set("value",D.layers[V-1].name):D.layersSelect.set("value",""+V);D.browseDialog.browseItems&&D.browseDialog.browseItems.clear();sa.resolve()}else D.item.selectedLayer?(ea.url=D.item.selectedLayer.url,sa.then(n.hitch(this,Y)),setTimeout(function(){sa.resolve(D.item.selectedLayer)},500)):(ua=D.item.itemDataUrl?X({url:D.item.itemDataUrl,content:{f:"json"}}):"sync",z(ua,n.hitch(this,function(wa){wa&&wa.layers&&wa.layers[0].id&&(ea.url=ea.url.substring(0,ea.url.lastIndexOf("/0"))+"/"+wa.layers[0].id);
X({url:ea.url,content:{f:"json"}}).then(n.hitch(this,function(va){Y(va);sa.resolve()}))})));return sa.promise}},addReadyToUseLayerOption:function(D,P){D&&(D.showReadyToUseLayers||D.showBrowseLayers)&&(P||(P=[]),D.signInPromise||(D.signInPromise=new B,setTimeout(n.hitch(this,function(){D.signInPromise.resolve()}),100)),D.i18n||(this.initI18n(),D.i18n=this.i18n),D.signInPromise.then(n.hitch(this,function(){r.forEach(P,function(Y){var Z=Y.select||Y;if(-1!==Z.baseClass.indexOf("dijitComboBox")&&D.showBrowseLayers){if(Y=
Z.get("store"))Y.put({id:"separator",name:"separator",label:"\x3chr\x3e"}),Y.put({id:"browselayers",name:"browselayers",label:D.i18n.browseLayers})}else{var V=Z.getOptions();r.some(V,function(ea){return"separator"===ea.type},this)||!D.showReadyToUseLayers&&!D.showBrowseLayers||Z.addOption({type:"separator",value:""});this.addBrowseOptionForTool({select:Z,disableLAAL:Y.disableLAAL},D)}},this);D.showReadyToUseLayers&&!fa.isDefined(D._browsedlg)&&(D._browsedlg=this.addBrowseAnalysisDialog({widget:D}),
D.own(D._browsedlg.browseItems.on("select-change",n.hitch(D,D._handleBrowseItemsSelect)),D._browsedlg.on("hide",n.hitch(D,function(){r.forEach(P,function(Y){"browse"===Y.get("value")&&Y.reset()});D.layersSelect&&D.layersSelect.reset()}))));D.showBrowseLayers&&!fa.isDefined(D._browseLyrsdlg)&&(D._browseLyrsdlg=this.addBrowseAnalysisDialog({widget:D,browseType:1}),D.own(D._browseLyrsdlg.on("browseitems-close",n.hitch(this,function(Y){"add-layer"===Y.action&&(D._browseLyrsdlg.browseItems.plugIn._grid&&
(Y.selection.selectedLayer=D._browseLyrsdlg.browseItems.plugIn._selectedLayer,D._handleBrowseItemsSelect({dialog:D._browseLyrsdlg,selection:Y.selection})),D._browseLyrsdlg.browseItems.closeInfoPanel())})),D._browseLyrsdlg.on("hide",n.hitch(D,function(){r.forEach(P,function(Y){"browselayers"===Y.get("value")&&Y.reset()})}))))})))},addBrowseOptionForTool:function(D,P){var Y=D.select,Z=D.disableLAAL||!1,V=Y.getOptions();D=[];var ea=!1;if(!r.some(V,function(na){return"browselayers"===na.value||"browse"===
na.value},this)){if(0<V.length&&"separator"!==V[V.length-1].type||0===V.length)D.push({type:"separator"}),ea=!0;P.useArcGISComponents&&(P.showBrowseLayers||P.showReadyToUseLayers)?D.push({value:"browselayers",label:P.i18n.browseAnalysisLayers}):(!Z&&P.showReadyToUseLayers&&(Z=P.i18n.browseAnalysisTitle,this._isCustomAnalysisQuery(P)&&(Z=P.i18n.browseAnalysisLayers),D.push({value:"browse",label:Z})),P.showBrowseLayers&&D.push({value:"browselayers",label:P.i18n.browseLayers}));(!0===ea&&1<D.length||
!1===ea&&0<D.length)&&Y.addOption(D)}},_isCustomAnalysisQuery:function(D){var P='title:"Living Atlas Analysis Layers" AND owner:esri',Y=!1;D&&D.isSingleTenant&&(P='title:"Living Atlas Analysis Layers" AND owner:esri_livingatlas');D.portalSelf&&D.portalSelf.analysisLayersGroupQuery&&D.portalSelf.analysisLayersGroupQuery!==P?Y=!0:D._portal&&D._portal.analysisLayersGroupQuery&&D._portal.analysisLayersGroupQuery!==P&&(Y=!0);return Y},getMaxInputByMode:function(D){if(D&&D.units&&D.type&&D.limits&&D.travelMode){var P,
Y=D.limits.maximumBreakDistanceValue,Z=D.limits.maximumBreakDistanceValueUnits,V=D.limits.maximumBreakTimeValue,ea=D.limits.maximumBreakTimeValueUnits,na=this.isWalkingTravelMode(D.travelMode.travelMode);na&&(Y=D.limits.maximumBreakWalkingDistanceValue,Z=D.limits.maximumBreakWalkingDistanceValueUnits,V=D.limits.maximumBreakWalkingTimeValue,ea=D.limits.maximumBreakWalkingTimeValueUnits);"reachableStreets"===D.alternateLimits&&(ea=this.generateLimitsForReachableStreets({limits:D.limits,isWalking:na}),
Y=ea.driveDistanceLimit,Z=ea.driveDistanceUnit,V=ea.driveTimeLimit,ea=ea.driveTimeUnit);"unreachableAreas"===D.alternateLimits&&(ea=this.generateLimitsForUnreachableAreas({limits:D.limits,isWalking:na}),Y=ea.driveDistanceLimit,Z=ea.driveDistanceUnit,V=ea.driveTimeLimit,ea=ea.driveTimeUnit);V*=this.perMinute(ea);Y*=this.perMile(Z);"StraightLine"===D.type?"Miles"===D.units?P=1E3:"Yards"===D.units?P=176E4:"Kilometers"===D.units?P=w.format(1609.344,{places:2}):"Meters"===D.units?P=w.format(1609344,{places:2}):
"Feet"===D.units&&(P=528E4):this.isDistanceMode(D.travelMode)?"Miles"===D.units?P=Y:"Yards"===D.units?P=1760*Y:"Kilometers"===D.units?P=w.format(1.609344*Y,{places:2}):"Meters"===D.units?P=w.format(1609.344*Y,{places:2}):"Feet"===D.units&&(P=5280*Y):this.isTimeMode(D.travelMode)&&("Minutes"===D.units?P=V:"Seconds"===D.units?P=60*V:"Hours"===D.units&&(P=V/60));return"string"===typeof P?w.parse(P):parseFloat(P)}},isWalkingTravelMode:function(D){if(D&&D.restrictionAttributeNames)return D.restrictionAttributeNames.some(function(P){return"walking"===
P.toLowerCase()})},isDistanceMode:function(D){return"Distance"===D.units},isTimeMode:function(D){return"Time"===D.units},generateLimitsForUnreachableAreas:function(D){var P={driveDistanceLimit:null,driveDistanceUnit:null,driveTimeLimit:null,driveTimeUnit:null};D.isWalking?(P.driveDistanceLimit=D.limits.maximumBreakWalkingDistanceValueDetailedPolygons,P.driveDistanceUnit=D.limits.maximumBreakWalkingDistanceValueUnitsDetailedPolygons,P.driveTimeLimit=D.limits.maximumBreakWalkingTimeValueDetailedPolygons,
P.driveTimeUnit=D.limits.maximumBreakWalkingTimeValueUnitsDetailedPolygons):(P.driveDistanceLimit=D.limits.maximumBreakDistanceValueDetailedPolygons,P.driveDistanceUnit=D.limits.maximumBreakDistanceValueUnitsDetailedPolygons,P.driveTimeLimit=D.limits.maximumBreakTimeValueDetailedPolygons,P.driveTimeUnit=D.limits.maximumBreakTimeValueUnitsDetailedPolygons);return P},generateLimitsForReachableStreets:function(D){var P={driveDistanceLimit:null,driveDistanceUnit:null,driveTimeLimit:null,driveTimeUnit:null};
D.isWalking?(P.driveDistanceLimit=D.limits.maximumBreakWalkingDistanceValueServiceAreaLines,P.driveDistanceUnit=D.limits.maximumBreakWalkingDistanceValueUnitsServiceAreaLines,P.driveTimeLimit=D.limits.maximumBreakWalkingTimeValueServiceAreaLines,P.driveTimeUnit=D.limits.maximumBreakWalkingTimeValueUnitsServiceAreaLines):(P.driveDistanceLimit=D.limits.maximumBreakDistanceValueServiceAreaLines,P.driveDistanceUnit=D.limits.maximumBreakDistanceValueUnitsServiceAreaLines,P.driveTimeLimit=D.limits.maximumBreakTimeValueServiceAreaLines,
P.driveTimeUnit=D.limits.maximumBreakTimeValueUnitsServiceAreaLines);return P},updateModeConstraints:function(D){if(D&&D.validateWidget&&D.units&&D.type&&D.travelMode){var P=D.validateWidget.get("constraints");P.max=this.getMaxInputByMode(D);D.validateWidget.set(P)}},getTravelModes:function(D){var P=new B,Y,Z,V,ea;fa.isDefined(this.travelModes)&&0<this.travelModes.length?P.resolve(this.travelModes):D&&D.widget?D.widget.signInPromise.then(n.hitch(this,function(na){(ea=D.widget.get("helperServices"))&&
ea.routingUtilities?(V=ea.routingUtilities.url,Y="sync"):Y=D.widget._getSelf(D.widget.portalUrl);z(Y,n.hitch(this,function(pa){pa&&pa.helperServices&&pa.helperServices.routingUtilities&&(V=pa.helperServices.routingUtilities.url);fa.isDefined(V)?(Z=new I(V+"/GetTravelModes"),Z.execute({}).then(n.hitch(this,function(sa){this.travelModes=r.map(sa[0].value&&sa[0].value.features,function(ua){return a.fromJson(ua.attributes.TravelMode)});sa[1]&&sa[1].paramName&&"defaultTravelMode"===sa[1].paramName&&(this.defaultTravelModeId=
sa[1].value);P.resolve(this.travelModes)}),n.hitch(this,function(sa){P.reject(sa)}))):P.reject(Error("Missing Routing Utility Service to get Travel Modes"))}),function(pa){P.reject(pa)})})):P.reject(Error("Missing parameter: params.widget required parameter"));return P.promise},populateTravelModes:function(D){if(D&&D.selectWidget&&D.widget){var P=[],Y=D.allowmode||"all",Z=!1;this.initI18n();D.addStraightLine&&P.push({value:"StraightLine",label:'\x3cdiv class\x3d"esriFloatLeading bufferIcon esriStraightLineDistanceIcon"\x3e\x3c/div\x3e\x3cdiv class\x3d"esriLeadingMargin4" style\x3d"height:20px;margin-top:10px;"\x3e'+
this.i18n.straightLineDistance+"\x3c/div\x3e",selected:D.value&&"StraightLine"===D.value});this.getTravelModes({widget:D.widget}).then(n.hitch(this,function(V){var ea=fa.isDefined(D.enableTravelModes)&&!D.enableTravelModes;r.forEach(V,function(na,pa){pa=this.createOptionForTravelMode(na,{name:na.name,disabled:ea,separator:D.separator});this.isTravelModeAllowed(Y,pa.units)&&("all"!==Y&&(pa.value=pa.value.replace(pa.units,"")),D.value&&D.value.id===na.id?aa(D.value,na)&&(pa.selected=!pa.disabled,Z=
!0):!D.value&&D.selectDefaultMode&&this.defaultTravelModeId&&this.defaultTravelModeId===na.id&&(pa.selected=!0),P.push(pa))},this);!Z&&this.isRequiredToAddTravelMode(D)&&this.isTravelModeAllowed(Y,this.getTravelModeUnits(D.value))&&P.push(this.getOptionForCustomTravelMode(D,ea));D.selectWidget.removeOption();D.selectWidget.addOption(P);D.widget.emit("travelmodes-added",{travelOptions:P})}),n.hitch(this,function(V){P&&0<P.length&&(D.selectWidget.removeOption(),D.selectWidget.addOption(P),D.widget.emit("travelmodes-added",
{travelOptions:P}))}))}},getTravelModeLabel:function(D,P){P=P?P:D.name;return'\x3cdiv class\x3d"esriFloatLeading bufferIcon esri'+this.getTravelModei18nKey(D.type)+this.getTravelModeUnits(D)+'Icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"esriLeadingMargin4" style\x3d"height:20px;margin-top:10px;" title\x3d"'+D.description+'"\x3e'+P+"\x3c/div\x3e"},getTravelModeUnits:function(D){var P=D.units||name.split(/\s/)[1];return P=D.impedanceAttributeName===D.timeAttributeName?"Time":D.impedanceAttributeName===D.distanceAttributeName?
"Distance":"Other"},getTravelModeValue:function(D,P){return D.replace(/\s/g,P||"")},getTravelModei18nKey:function(D){return"AUTOMOBILE"===D?"Driving":"TRUCK"===D?"Trucking":"WALK"===D?"Walking":"Other"},isTravelModeAllowed:function(D,P){return"all"===D||D.toLowerCase()===P.toLowerCase()},isRequiredToAddTravelMode:function(D){return D.widget.rerun&&"StraightLine"!==D.value},isTrafficBasedTravelMode:function(D){var P=this.getTravelModei18nKey(D.type).toLowerCase();return"time"===this.getTravelModeUnits(D).toLowerCase()&&
("driving"===P||"trucking"===P)},getOptionForCustomTravelMode:function(D,P){D=this.createOptionForTravelMode(D.value,{name:"\x26lt"+D.value.name+"\x26gt",disabled:P,separator:D.separator});D.selected=!0;return D},createOptionForTravelMode:function(D,P){return{label:this.getTravelModeLabel(D,P.name),value:this.getTravelModeValue(P.name,P.separator),travelMode:D,disabled:P.disabled,modei18nKey:this.getTravelModei18nKey(D.type).toLowerCase(),units:this.getTravelModeUnits(D)}},updateDisplay:function(D,
P,Y){(new u.NodeList(D)).style("display",P?Y?Y:"block":"none")},isGreaterThanZero:function(){return 0<this.get("value")},getExprFunctions:function(){this.i18n||this.initI18n();this.exprFunctions||(this.exprFunctions=[{type:"NumType",label:q.substitute(this.i18n.asMetersFunc,{functionName:"as_meters(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"as_meters()"},{type:"NumType",label:q.substitute(this.i18n.asKilometersFunc,{functionName:"as_kilometers(\x3ci\x3enumber\x3c/i\x3e)",
num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"as_kilometers()"},{type:"NumType",label:q.substitute(this.i18n.asFeetFunc,{functionName:"as_feet(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"as_feet()"},{type:"NumType",label:q.substitute(this.i18n.asYardsFunc,{functionName:"as_yards(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"as_yards()"},{type:"NumType",label:q.substitute(this.i18n.asMilesFunc,{functionName:"as_miles(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),
name:"as_miles()"},{type:"NumType",label:q.substitute(this.i18n.asNuaticalMilesFunc,{functionName:"as_nautical_miles(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"as_nautical_miles()"},{type:"NumType",label:q.substitute(this.i18n.absFunc,{functionName:"abs(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"abs()"},{type:"NumType",label:q.substitute(this.i18n.logFunc,{functionName:"log(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"log()"},
{type:"NumType",label:q.substitute(this.i18n.sinFunc,{functionName:"sin(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"sin()"},{type:"NumType",label:q.substitute(this.i18n.cosFunc,{functionName:"cos(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"cos()"},{type:"NumType",label:q.substitute(this.i18n.tanFunc,{functionName:"tan(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"tan()"},{type:"NumType",label:q.substitute(this.i18n.squareRootFunc,
{functionName:"sqrt(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"sqrt()"},{type:"NumType",label:q.substitute(this.i18n.minFunc,{functionName:"min(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"min()"},{type:"NumType",label:q.substitute(this.i18n.maxFunc,{functionName:"max(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"max()"},{type:"NumType",label:q.substitute(this.i18n.constrainFunc,{functionName:"constrain(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3elow\x3c/i\x3e, \x3ci\x3ehigh\x3c/i\x3e",
num:"\x3ci\x3enumber\x3c/i\x3e",low:"\x3ci\x3elow\x3c/i\x3e",high:"\x3ci\x3ehigh\x3c/i\x3e"}),name:"constrain(,,)"},{type:"NumType",label:q.substitute(this.i18n.iffFunc,{functionName:"iif(\x3ci\x3econdition\x3c/i\x3e,\x3ci\x3evalue if TRUE\x3c/i\x3e,\x3ci\x3evalue if FALSE\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"iif(,,)"},{type:"NumType",label:q.substitute(this.i18n.whenFunc,{functionName:"when(\x3ci\x3enumber\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"when(,)"},{type:"NumType",
label:q.substitute(this.i18n.decodeFunc,{functionName:"decode(\x3ci\x3eexpression\x3c/i\x3e, \x3ci\x3ecase1,return1,..caseN,returnN\x3c/i\x3e, \x3ci\x3edefault\x3c/i\x3e)",num:"\x3ci\x3enumber\x3c/i\x3e"}),name:"decode(,,,)"}]);return this.exprFunctions},addAttributeOptions:function(D){this.initI18n();fa.isDefined(D.allowSelectLabel)||(D.allowSelectLabel=!0);var P=[],Y=fa.isDefined(D.emptyValue)?D.emptyValue:"";if(D.allowNumericType||void 0===D.allowNumericType)P=[ma.FieldTypes.Short,ma.FieldTypes.Integer,
ma.FieldTypes.Float,ma.FieldTypes.Double];var Z=D.layer;var V=D.selectWidget;var ea=Z?Z.fields:[];V.removeOption(V.getOptions());D.allowSelectLabel&&V.addOption({value:Y,label:this.i18n.attribute});D.allowStringType&&P.push(ma.FieldTypes.String);D.allowDateType&&P.push(ma.FieldTypes.Date);var na=[];r.forEach(ea,function(pa){-1!==r.indexOf(P,pa.type)&&pa.name!==Z.objectIdField&&na.push({value:pa.name,label:fa.isDefined(pa.alias)&&""!==pa.alias?pa.alias:pa.name,type:pa.type===ma.FieldTypes.String?ma.PseudoFieldTypes.String:
pa.type===ma.FieldTypes.Date?ma.PseudoFieldTypes.Date:ma.PseudoFieldTypes.Number})},this);if(0===na.length)return!1;V.addOption(na);fa.isDefined(D.priorityChange)?V.set("value",Y,D.priorityChange):V.set("value",Y);V.set("disabled",!Z||0===Z.fields.length);return!0},addStatisticsOptions:function(D){this.initI18n();var P=D.selectWidget,Y=[{value:"SUM",label:this.i18n.sum},{value:"MIN",label:this.i18n.minimum},{value:"MAX",label:this.i18n.maximum},{value:"MEAN",label:D.showGeoAnalyticsParams?this.i18n.mean:
this.i18n.average},{value:"STDDEV",label:this.i18n.standardDev}],Z=[{value:"MIN",label:this.i18n.minimum},{value:"MAX",label:this.i18n.maximum}],V=[{value:"First",label:this.i18n.first},{value:"Last",label:this.i18n.last}],ea=fa.isDefined(D.emptyValue)?D.emptyValue:"";P.removeOption(P.getOptions());P.addOption([{value:ea,label:this.i18n.statistic}]);D.showGeoAnalyticsParams&&(P.addOption({value:"COUNT",label:this.i18n.count}),Y.push({value:"VARIANCE",label:this.i18n.variance}),Y.splice(4,0,{value:"RANGE",
label:this.i18n.range}));D.showFirstLastStats&&P.addOption(V);D.type&&"number"!==D.type?D.type&&"string"===D.type?(P.addOption({value:"ANY",label:this.i18n.any}),D.selectWidget.optionsType="string"):D.type&&"date"===D.type&&(P.addOption(Z),D.selectWidget.optionsType="date"):(P.addOption(Y),D.selectWidget.optionsType="number");P.set("value",ea)},addFillOptions:function(D){var P=D.selectWidget,Y=[{value:"ZEROES",label:this.i18n.zeroes},{value:"SPATIAL_NEIGHBORS",label:this.i18n.spatialneighbhors},{value:"SPACE_TIME_NEIGHBORS",
label:this.i18n.spacetimeneighbors},{value:"TEMPORAL_TREND",label:this.i18n.temporaltrend}];P.removeOption(P.getOptions());P.addOption([{value:"0",label:this.i18n.fill}]);D.type&&"number"!==D.type||P.addOption(Y)},perMeter:function(D){var P=1;switch(D){case M.MILLIMETERS:P=1E3;break;case M.CENTIMETERS:P=100;break;case M.DECIMETERS:P=10;break;case M.METERS:P=1;break;case M.KILOMETERS:P=.001;break;case M.INCHES:P=39.370079;break;case M.FEET:P=3.2808399;break;case M.YARDS:P=1.0936133;break;case M.MILES:P=
6.2137119E-4;break;case M.NAUTICAL_MILES:P=5.399568E-4;break;case M.ACRES:P=2.4710538E-4;break;case M.ARES:P=.01;break;case M.HECTARES:P=1E-4;break;case M.SQUARE_INCHES:P=1550.0031;break;case M.SQUARE_FEET:P=10.7639104;break;case M.SQUARE_YARDS:P=1.19599005;break;case M.SQUARE_MILES:P=3.86102159E-7;break;case M.SQUARE_NAUTICAL_MILES:P=2.9155335E-7;break;case M.SQUARE_MILLIMETERS:P=1E6;break;case M.SQUARE_CENTIMETERS:P=1E4;break;case M.SQUARE_DECIMETERS:P=100;break;case M.SQUARE_METERS:P=1;break;case M.SQUARE_KILOMETERS:P=
1E-6}return P},perMile:function(D){var P=1;switch(D){case "Feet":P=1.89394E-4;break;case "Yards":P=5.68182E-4;break;case "Meters":P=6.21371E-4;break;case "Kilometers":P=.621371}return P},perMinute:function(D){var P=1;switch(D){case "Seconds":P=.0166667;break;case "Hours":P=60}return P},getType:function(D){var P=null;switch(D){case M.ACRES:P=2;break;case M.ARES:P=2;break;case M.CENTIMETERS:P=1;break;case M.DECIMETERS:P=1;break;case M.FEET:P=1;break;case M.HECTARES:P=2;break;case M.INCHES:P=1;break;
case M.KILOMETERS:P=1;break;case M.METERS:P=1;break;case M.MILES:P=1;break;case M.MILLIMETERS:P=1;break;case M.NAUTICAL_MILES:P=1;break;case M.SQUARE_CENTIMETERS:P=2;break;case M.SQUARE_DECIMETERS:P=2;break;case M.SQUARE_FEET:P=2;break;case M.SQUARE_INCHES:P=2;break;case M.SQUARE_KILOMETERS:P=2;break;case M.SQUARE_METERS:P=2;break;case M.SQUARE_MILES:P=2;break;case M.SQUARE_MILLIMETERS:P=2;break;case M.SQUARE_NAUTICAL_MILES:P=2;break;case M.SQUARE_YARDS:P=2;break;case M.YARDS:P=1;break;default:P=
0}return P},unitConversion:function(D,P,Y){var Z=!0;fa.isDefined(D)||(this.emitError("The 'From' Value must be a valid numeric value: "+D),Z=!1);fa.isDefined(P)||(this.emitError("The 'From' Units must be defined: "+P),Z=!1);fa.isDefined(Y)||(this.emitError("The 'To' Units must be defined: "+Y),Z=!1);D instanceof Array&&(this.emitError("Only single 'From' Value supported: "+D),Z=!1);P instanceof Array&&(this.emitError("Only single 'From' Units supported: "+P),Z=!1);Y instanceof Array&&(this.emitError("Only single 'To' Units supported: "+
Y),Z=!1);var V=this.getType(P),ea=this.getType(Y);0===V&&(this.emitError("Unsupported 'From' Units: "+P),Z=!1);0===ea&&(this.emitError("Unsupported 'To' Units: "+Y),Z=!1);V!==ea&&(this.emitError("Incompatible 'From' and 'To' Units: "+P+" and "+Y),Z=!1);return Z?P===Y?+D:+D/this.perMeter(P)*this.perMeter(Y):Number.NaN},emitError:function(D){console.log("error",Error(D))},isEmpty:function(D){for(var P in D)if(D.hasOwnProperty(P))return!1;return p.stringify(D)===p.stringify({})},getRoutingUtilities:function(D){var P=
new B,Y={},Z,V,ea,na;D||P.reject(Error("Missing parameter: widget required parameter"));-1!==r.indexOf(["CreateDriveTimeAreas","EnrichLayer","SummarizeNearby"],D.toolName)?n.mixin(Y,{toolName:"GenerateServiceAreas",serviceName:"asyncServiceArea"}):D.toolName===ma.Tools.ChooseBestFacilities?n.mixin(Y,{toolName:"SolveLocationAllocation",serviceName:"asyncLocationAllocation"}):"PlanRoutes"===D.toolName?n.mixin(Y,{toolName:"SolveVehicleRoutingProblem",serviceName:"asyncVRP"}):"FindNearest"===D.toolName?
n.mixin(Y,{toolName:"FindClosestFacilities",serviceName:"asyncClosestFacility"}):"ConnectOriginsToDestinations"===D.toolName&&n.mixin(Y,{toolName:"FindRoutes",serviceName:"asyncRoute"});this.routingUtilities||(this.routingUtilities={});this.routingUtilities&&this.routingUtilities[D.toolName]?P.resolve(this.routingUtilities[D.toolName]):D.signInPromise.then(n.hitch(this,function(pa){(na=D.get("helperServices"))&&na.routingUtilities?(ea=na.routingUtilities.url,Z="sync"):Z=D._getSelf(D.portalUrl);z(Z,
n.hitch(this,function(sa){sa&&sa.helperServices&&sa.helperServices.routingUtilities&&(ea=sa.helperServices.routingUtilities.url);fa.isDefined(ea)||P.reject(Error("Missing Routing Utility Service to get Network Analysis Service Limits."));V=new I(ea+"/GetToolInfo");V.execute(Y).then(n.hitch(this,function(ua){ua&&0<ua.length&&ua[0].value?(this.routingUtilities[D.toolName]=ua[0].value,P.resolve(ua[0].value)):P.reject("Routing Utility Service 'GetToolInfo' job did not return service limits.")}),function(ua){P.reject(ua)})}))}),
function(pa){P.reject(pa)});return P.promise},getNetworkAnalysisLimits:function(D){var P=new B;D||P.reject(Error("Missing parameter: widget required parameter"));this.getRoutingUtilities(D).then(n.hitch(this,function(Y){Y.serviceLimits?P.resolve(Y.serviceLimits):P.reject()}),function(Y){P.reject(Y)});return P.promise},isEsriWorldGeocoder:function(D){var P=this.isAgoWorldGeocodeServer(D);D=this.isAgoWorldGeocodeServerProxy(D);return P||D},isAgoWorldGeocodeServer:function(D){return D&&!!D.match(/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig)},
isCustomGeoEnrichmentServer:function(D,P){var Y=(D||"").toLowerCase();D=-1<Y.indexOf("/geoenrichmentserver")&&-1<Y.indexOf("/servers/")&&-1<Y.indexOf("/rest/services/");P=!P&&Y.indexOf("utility")&&-1<Y.indexOf(".arcgis.com");return D&&P},isAgoWorldGeocodeServerProxy:function(D){return D&&!!D.match(/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig)},isWorldGeoLocator:function(D){return D&&!!D.match(/(\/rest\/services\/world\/geocodeserver).*/ig)},showMessages:function(D,P,Y){f.set(P,
"innerHTML",D);b.fadeIn({node:Y,easing:x.quadIn,onEnd:n.hitch(this,function(){t.set(Y,{display:""})})}).play()},hideMessages:function(D){b.fadeOut({node:D,easing:x.quadOut,onEnd:function(){t.set(D,{display:"none"})}}).play()},getHelpUrl:function(D){if(D.topic&&D.widget){var P;D.widget.portalSelf&&D.widget.portalSelf.helpBase?P=D.widget.portalSelf.helpBase+"index.html#":!D.widget.isSingleTenant||D.widget.portalSelf&&D.widget.portalSelf.helpBase||(P="http://server.arcgis.com/en/portal/latest/use/");
"BufferExpression"===D.topic&&(P+="Use_expressions_with_GeoAnalytics_Tools/019300000183000000/");return P}},isPCS:function(D){return!!D&&!!ia&&-1!==r.indexOf(ia,D)},isPCSByLayerType:function(D){var P=!!D&&!!D.fullExtent&&this.isPCS(D.fullExtent.spatialReference.wkid);!P&&D.extent&&(P=!!D&&!!D.extent&&this.isPCS(D.extent.spatialReference.wkid));!P&&D.spatialReference&&(P=!!D&&!!D.spatialReference&&this.isPCS(D.spatialReference.wkid));return P},checkPCSforAnalysis:function(D){var P=D.widget&&D.widget.toolName,
Y=!!D.widget&&!!D.widget.context&&!!D.widget.context.processSR&&this.isPCS(D.widget.context.processSR.wkid),Z=!0,V=D.jobParams||D.widget.jobParams,ea=!!D.widget&&!!D.widget.context&&!!D.widget.context.processSR&&!!D.widget.context.processSR.wkid;if(!P||!V||!D.widget.showGeoAnalyticsParams)return!1;var na="\x3ca  href\x3d'#' id\x3d'"+D.widget.id+"_warn_settings_link'\x3e"+D.widget.i18n.analysisSettings+"\x3c/a\x3e\x3cdiv class\x3d'esriAnalysisSettingsIcon'\x3e\x3c/div\x3e";var pa=q.substitute(D.widget.i18n.PCSReqMsg,
{defaultSpatialRef:D.widget.i18n.worldCylindrical,settingsIcon:na});"FindHotSpots"!==P&&"FindPointClusters"!==P||Y?"CalculateDensity"!==P&&"FindPointClusters"!==P&&"GeographicallyWeightedRegression"!==P||Y?"AggregatePoints"!==P||-1===r.indexOf(["HEXAGON","SQUARE"],V.binType)||Y?"SummarizeWithin"===P&&V.summaryPolygons&&!Y?Z=this.isPCSByLayerType(D.widget.sumWithinLayer):"SummarizeWithin"!==P||-1===r.indexOf(["HEXAGON","SQUARE"],V.binType)||Y?"JoinFeatures"===P&&V.spatialNearDistance&&"Near"===V.spatialRelationship&&
!Y?(Z=this.isPCSByLayerType(D.widget.targetLayer))||(pa=q.substitute(D.widget.i18n.JFPCSReqMsg,{settingsIcon:na})):"BuildMultiVariableGrid"!==P||Y?"CalculateMotionStatistics"===P&&"Planar"===V.distanceMethod&&(1<V.motionStatistics.split(",").length||1===V.motionStatistics.split(",").length&&-1===V.motionStatistics.indexOf("Duration"))&&!Y?(Z=this.isPCSByLayerType(D.widget.inputLayer))||(pa=q.substitute(D.widget.i18n.CMSPCSReqMsg,{settingsIcon:na})):"TraceProximityEvents"!==P||"Planar"!==V.distanceMethod||
Y||(Z=this.isPCSByLayerType(D.widget.inputLayer))||(pa=q.substitute(D.widget.i18n.TPEPCSReqMsg,{settingsIcon:na})):Z=r.every(D.inputLayers,function(sa){return this.isPCSByLayerType(sa)},this):Z=this.isPCSByLayerType(D.widget.summaryLayer):Z=this.isPCSByLayerType(D.widget.pointLayer):(Z=this.isPCSByLayerType(D.widget.inputLayer),"GeographicallyWeightedRegression"!==P||Z||(pa=q.substitute(D.widget.i18n.GWRPCSReqMsg,{settingsIcon:na}))):(Z=this.isPCSByLayerType(D.widget.analysisLayer),"FindPointClusters"!==
P||Z||(pa=q.substitute(D.widget.i18n.FPCSReqMsg,{settingsIcon:na})));Z||D.hasPCSWarnShown||(D.widget.set("disableRunAnalysis",Z),this.settingsVM&&this.settingsDlg&&D.widget._bodyNode&&D.widget._errorMessagePane&&(this.showMessages(pa,D.widget._bodyNode,D.widget._errorMessagePane),G.byId(D.widget.id+"_warn_settings_link")&&J(G.byId(D.widget.id+"_warn_settings_link"),"click",n.hitch(D.widget,D.widget.showSettingsDlg))));!Z&&D.hasPCSWarnShown&&ea&&(Z=!0);return Z},tryParseJSON:function(D){try{var P=
p.parse(D);if(P&&"object"===typeof P&&null!==P)return P}catch(Y){}return!1},decodeTag:function(D){return{"\x26lt;":"\x3c","\x26gt;":"\x3e"}[D]||D},stringDecode:function(D){return D.replace(/(&lt;|&gt;)/g,this.decodeTag)},jobParamsToWidgetProps:function(D){if(D&&D.jobParams){var P=D.jobParams,Y=new B,Z=[],V=[],ea;for(ea in P){var na;P.hasOwnProperty(ea)&&("string"===typeof P[ea]&&-1!==P[ea].search(/(&lt;|&gt;)/g)&&(P[ea]=this.stringDecode(P[ea])),na="string"===typeof P[ea]?this.tryParseJSON(P[ea]):
P[ea])&&(-1!==ea.toLowerCase().indexOf("layer")&&"object"===typeof na?V.push({key:ea,obj:na}):na&&(na.Raster||na.url)&&V.push({key:ea,obj:na}),P[ea]=na)}for(ea=0;ea<V.length;ea++){na=V[ea].obj;var pa=V[ea].key;"object"===typeof na&&na.length?(P[pa]=[],r.forEach(na,function(sa,ua){this._getFlayers(sa,pa,P,Z,!0,ua)},this)):"object"===typeof na&&na.Raster?(na.url=na.Raster.url,this._getFlayers(na,pa,P,Z,!0,"Raster")):this._getFlayers(na,pa,P,Z)}F(Z).then(n.hitch(this,function(){Y.resolve(D)}),n.hitch(this,
function(){Y.resolve(D)}));return Y.promise}},_getLayerType:function(D){return D?-1!==D.indexOf("BigDataCatalogServer")?S.BIGDATA:-1!==D.indexOf("ImageServer")?S.IS:S.FS:null},_getFlayers:function(D,P,Y,Z,V,ea){if(D.url){var na=X({url:D.url,content:{f:"json"}});var pa=new B;Z.push(pa);na.then(n.hitch(this,function(sa,ua,Aa,wa,va){var ra=this._getLayerType(sa.url);if(ra===S.FS){var qa=new E(sa.url,{mode:E.MODE_ONDEMAND,outFields:["*"],resourceInfo:va});sa.filter&&qa.setDefinitionExpression(sa.filter);
qa.filter=sa.filter}else ra===S.BIGDATA?(qa=va,n.mixin(qa,sa)):ra===S.IS&&(va=sa.Raster||sa,qa=new W(va.url),va.renderingRule&&qa.setRenderingRule(new ja(va.renderingRule)),va.name&&(qa.name=va.name),sa.Raster&&sa.Raster.url===sa.url&&delete sa.url);sa.name&&(qa.name=sa.name);V?Y[ua][wa]=qa:V&&ra===S.IS?n.mixin(Y[ua][wa],qa):Y[ua]=qa;Aa.resolve()},D,P,pa,ea),n.hitch(this,function(sa,ua,Aa,wa,va){sa={name:sa.name,empty:!0};V?Y[ua][wa]=sa:Y[ua]=sa;Aa.resolve()},D,P,pa,ea))}else Z=new E(D,{outFields:["*"]}),
D.name&&(Z.name=D.name),V?Y[P][ea]=Z:Y[P]=Z},isLayerInLayers:function(D,P){return r.some(P,function(Y){return this.isSameLayer(D,Y)},this)},addBlankOption:function(D,P){P&&P.length?P.push({value:"  ",label:""}):D.addOption({value:"  ",label:""});setTimeout(n.hitch(this,this._validateSelectUI,D),100)},_validateSelectUI:function(D){D._hasBeenBlurred=!0;D.set("focused",!0);D.validate();D.set("focused",!1);D._hasBeenBlurred=!1;setTimeout(n.hitch(this,function(){D.reset()}),1E3)},updateExpressions:function(D){D&&
D.selectedInputLayers&&D.inputLayers&&D.data&&D.expressions&&(r.forEach(D.selectedInputLayers,function(P,Y){r.forEach(D.inputLayers,function(Z,V){Z&&P&&(!P.url&&!Z.url&&P.name===Z.name||P.url&&Z.url&&P.url===Z.url)&&(P._oldIndex=Y,P._newIndex=V)})}),r.forEach(D.data,function(P,Y){0<Y&&P&&(Y=D.expressions[Y-1],fa.isDefined(P.layer)&&(P.layer=Y&&Y.layer),fa.isDefined(P.selectingLayer)&&(P.selectingLayer=Y&&Y.selectingLayer))}),r.forEach(D.data,function(P){var Y=!1,Z=!1;r.forEach(D.selectedInputLayers,
function(V){fa.isDefined(P.layer)&&P.layer===V._oldIndex&&!Y&&(P.layer=V._newIndex,Y=!0);fa.isDefined(P.selectingLayer)&&P.selectingLayer===V._oldIndex&&!Z&&(P.selectingLayer=V._newIndex,Z=!0)},this)},this))},isBigDataTypeTobeAdded:function(D){return-1==r.indexOf(D,'type:"Big Data File Share"')?!0:!1},removeDuplicates:function(D,P){for(var Y=[],Z={},V=0;V<D.length;V++)Z[D[V]]?Z[D[V]]+=1:(Y.push(D[V]),Z[D[V]]=1);return P?Z:Y},isPoint:function(D){return D&&D.geometryType===ma.GeometryTypes.Point},isLine:function(D){return D&&
D.geometryType===ma.GeometryTypes.Line},isPolygon:function(D){return D&&D.geometryType===ma.GeometryTypes.Polygon},isSameLayer:function(D,P){return D&&P&&(D.name&&P.name&&D.name===P.name||D.url&&P.url&&D.url===P.url)},getTimeType:function(D){return D?fa.isDefined(D.timeInfo)&&fa.isDefined(D.timeInfo.startTimeField)&&!fa.isDefined(D.timeInfo.endTimeField)?ma.TimeTypes.Instant:fa.isDefined(D.timeInfo)&&fa.isDefined(D.timeInfo.startTimeField)&&fa.isDefined(D.timeInfo.endTimeField)?ma.TimeTypes.Interval:
fa.isDefined(D.time)&&fa.isDefined(D.time.timeType)?D.time.timeType:!1:!1},fetchGroupForRFT:function(D){var P=new B,Y=d.locale,Z=Y?Y.substring(0,2):"en";Y=this.systemRFTGroupName+" owner: ("+("en"===Z?["esri_en"]:["esri_en","esri_"+Z]).join(" OR ")+")";D.queryGroups({q:Y},!0).then(function(V){0<V.total&&V.results?(V=V.results,V=this.findRFTLocaleGroup(V,Z)||this.findRFTLocaleGroup(V,"en"),P.resolve(V)):P.resolve(null)}.bind(this));return P},findRFTLocaleGroup:function(D,P){var Y;D.some(function(Z){var V=
Z.owner;if(V&&V.substring(V.length-2)===P)return Y=Z,!0});return Y},updateOptions:function(D,P){if(D){for(;0<D.getOptions().length;)D.removeOption(D.getOptions());D._setDisplay("");P&&0<P.length&&D.addOption(P)}},addOptionsFromLayers:function(D){D.select&&D.layers&&(D.customOptions=D.customOptions||[],D.forbiddenLayers=D.forbiddenLayers||[],D.layers.forEach(function(P,Y){this.isLayerInLayers(P,D.forbiddenLayers)||D.customOptions.push({value:Y.toString(),label:P.name,selected:D.selectedOption&&this.isSameLayer(D.selectedOption,
P)})},this),this.updateOptions(D.select,D.customOptions),this.addBrowseOptionForTool({select:D.select,disableLAAL:!0},D.widget))},replaceTag:function(D){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;"}[D]||D},safetagsReplace:function(D){return D.replace(/[<>]/g,this.replaceTag)}});e("extend-esri")&&n.setObject("dijit.analysis.utils",m,oa);return m})},"dojo/fx/easing":function(){define(["../_base/lang"],function(H){var m={linear:function(n){return n},quadIn:function(n){return Math.pow(n,
2)},quadOut:function(n){return n*(n-2)*-1},quadInOut:function(n){n*=2;return 1>n?Math.pow(n,2)/2:-1*(--n*(n-2)-1)/2},cubicIn:function(n){return Math.pow(n,3)},cubicOut:function(n){return Math.pow(n-1,3)+1},cubicInOut:function(n){n*=2;return 1>n?Math.pow(n,3)/2:(Math.pow(n-2,3)+2)/2},quartIn:function(n){return Math.pow(n,4)},quartOut:function(n){return-1*(Math.pow(n-1,4)-1)},quartInOut:function(n){n*=2;return 1>n?Math.pow(n,4)/2:-.5*(Math.pow(n-2,4)-2)},quintIn:function(n){return Math.pow(n,5)},quintOut:function(n){return Math.pow(n-
1,5)+1},quintInOut:function(n){n*=2;return 1>n?Math.pow(n,5)/2:(Math.pow(n-2,5)+2)/2},sineIn:function(n){return-1*Math.cos(Math.PI/2*n)+1},sineOut:function(n){return Math.sin(Math.PI/2*n)},sineInOut:function(n){return-1*(Math.cos(Math.PI*n)-1)/2},expoIn:function(n){return 0==n?0:Math.pow(2,10*(n-1))},expoOut:function(n){return 1==n?1:-1*Math.pow(2,-10*n)+1},expoInOut:function(n){if(0==n)return 0;if(1==n)return 1;n*=2;if(1>n)return Math.pow(2,10*(n-1))/2;--n;return(-1*Math.pow(2,-10*n)+2)/2},circIn:function(n){return-1*
(Math.sqrt(1-Math.pow(n,2))-1)},circOut:function(n){return Math.sqrt(1-Math.pow(n-1,2))},circInOut:function(n){n*=2;return 1>n?-.5*(Math.sqrt(1-Math.pow(n,2))-1):.5*(Math.sqrt(1-Math.pow(n-2,2))+1)},backIn:function(n){return Math.pow(n,2)*(2.70158*n-1.70158)},backOut:function(n){--n;return Math.pow(n,2)*(2.70158*n+1.70158)+1},backInOut:function(n){n*=2;if(1>n)return Math.pow(n,2)*(3.5949095*n-2.5949095)/2;n-=2;return(Math.pow(n,2)*(3.5949095*n+2.5949095)+2)/2},elasticIn:function(n){if(0==n||1==n)return n;
--n;return-1*Math.pow(2,10*n)*Math.sin(2*(n-.075)*Math.PI/.3)},elasticOut:function(n){return 0==n||1==n?n:Math.pow(2,-10*n)*Math.sin(2*(n-.075)*Math.PI/.3)+1},elasticInOut:function(n){if(0==n)return 0;n*=2;if(2==n)return 1;var r=.3*1.5,l=r/4;if(1>n)return--n,-.5*Math.pow(2,10*n)*Math.sin(2*(n-l)*Math.PI/r);--n;return.5*Math.pow(2,-10*n)*Math.sin(2*(n-l)*Math.PI/r)+1},bounceIn:function(n){return 1-m.bounceOut(1-n)},bounceOut:function(n){return n=n<1/2.75?7.5625*Math.pow(n,2):n<2/2.75?7.5625*Math.pow(n-
1.5/2.75,2)+.75:n<2.5/2.75?7.5625*Math.pow(n-2.25/2.75,2)+.9375:7.5625*Math.pow(n-2.625/2.75,2)+.984375},bounceInOut:function(n){return.5>n?m.bounceIn(2*n)/2:m.bounceOut(2*n-1)/2+.5}};H.setObject("dojo.fx.easing",m);return m})},"dojox/mvc/equals":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/Stateful","./StatefulArray"],function(H,m,n,r){var l=function(k,b,a){a=a||l;var d=[a.getType(k),a.getType(b)];return d[0]!=d[1]?!1:a["equals"+d[0].replace(/^[a-z]/,function(f){return f.toUpperCase()})](k,
b)};return m.setObject("dojox.mvc.equals",m.mixin(l,{getType:function(k){return m.isArray(k)?"array":m.isFunction((k||{}).getTime)?"date":null!=k&&("[object Object]"=={}.toString.call(k)||m.isFunction((k||{}).set)&&m.isFunction((k||{}).watch))?"object":"value"},equalsArray:function(k,b){for(var a=0,d=Math.max(k.length,b.length);a<d;a++)if(!l(k[a],b[a]))return!1;return!0},equalsDate:function(k,b){return k.getTime()==b.getTime()},equalsObject:function(k,b){var a=m.mixin({},k,b),d;for(d in a)if(!(d in
n.prototype||"_watchCallbacks"==d||l(k[d],b[d])))return!1;return!0},equalsValue:function(k,b){return k===b}}))})},"dojox/mvc/StatefulArray":function(){define(["dojo/_base/lang","dojo/Stateful"],function(H,m){function n(l){l._watchElementCallbacks&&l._watchElementCallbacks(void 0,[],[]);return l}var r=function(l){l=H._toArray(l||[]);l.constructor=r;return H.mixin(l,{pop:function(){return this.splice(this.get("length")-1,1)[0]},push:function(){this.splice.apply(this,[this.get("length"),0].concat(H._toArray(arguments)));
return this.get("length")},reverse:function(){return n([].reverse.apply(this,H._toArray(arguments)))},shift:function(){return this.splice(0,1)[0]},sort:function(){return n([].sort.apply(this,H._toArray(arguments)))},splice:function(k,b){var a=this.get("length");k+=0>k?a:0;var d=Math.min(k,a),f=this.slice(k,k+b),e=H._toArray(arguments).slice(2);[].splice.apply(this,[k,b].concat(Array(e.length)));for(var h=0;h<e.length;h++)this[d+h]=e[h];this._watchElementCallbacks&&this._watchElementCallbacks(k,f,
e);this._watchCallbacks&&this._watchCallbacks("length",a,a-f.length+e.length);return f},unshift:function(){this.splice.apply(this,[0,0].concat(H._toArray(arguments)));return this.get("length")},concat:function(k){return new r([].concat.apply(this,arguments))},join:function(k){for(var b=[],a=this.get("length"),d=0;d<a;d++)b.push(this.get(d));return b.join(k)},slice:function(k,b){var a=this.get("length");k+=0>k?a:0;b=(void 0===b?a:b)+(0>b?a:0);a=[];for(k=k||0;k<Math.min(b,this.get("length"));k++)a.push(this.get(k));
return new r(a)},watchElements:function(k){var b=this._watchElementCallbacks,a=this;b||(b=this._watchElementCallbacks=function(f,e,h){for(var c=[].concat(b.list),g=0;g<c.length;g++)c[g].call(a,f,e,h)},b.list=[]);b.list.push(k);var d={};d.unwatch=d.remove=function(){for(var f=b.list,e=0;e<f.length;e++)if(f[e]==k){f.splice(e,1);break}};return d}},m.prototype,{set:function(k,b){if("length"==k)k=this.get("length"),k<b?this.splice.apply(this,[k,0].concat(Array(b-k))):b<k&&this.splice.apply(this,[b,k-b]);
else{var a=this.length;m.prototype.set.call(this,k,b);a!=this.length&&m.prototype.set.call(this,"length",this.length)}return this},isInstanceOf:function(k){return m.prototype.isInstanceOf.apply(this,arguments)||k==r}})};r._meta={bases:[m]};return H.setObject("dojox.mvc.StatefulArray",r)})},"esri/dijit/analysis/HelpWindow":function(){define("require dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/_base/kernel dojo/aspect dojo/has dojo/dom-construct dojo/dom-class dojo/dom-attr dojo/dom-style dojo/query dojo/window dojo/dom-geometry dijit/_Widget dijit/TooltipDialog dijit/popup ../../kernel ../../lang ../../urlUtils ../../request ../_EventedWidget dojo/i18n!../../nls/jsapi".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w){n=n([u],{declaredClass:"esri.dijit.analysis.HelpWindow",i18n:null,onlineHelpMap:null,showLearnMore:!1,"class":"esriAnalyisHelpWindow",constructor:function(A){this.isPortal=A&&A.isPortal},postMixInProperties:function(){this.inherited(arguments);this.i18n={};r.mixin(this.i18n,w.common);r.mixin(this.i18n,w.analysisHelp)},postCreate:function(){this.inherited(arguments);var A=["ar","he"],z;for(z=0;z<A.length;z+=1){var G=A[z];b.locale&&-1!==b.locale.indexOf(G)&&
(-1!==b.locale.indexOf("-")?-1!==b.locale.indexOf(G+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0)}var J=this.isPortal?"./help/helpmap_enterprise.json":"./help/helpmap.json";A=H.toUrl(J);F({url:A}).then(r.hitch(this,function(L){this.onlineHelpMap=L.map}),function(L){console.error("Unable to load",J,L)});this._initSelfHelpMap()},_getAbsoluteUrl:function(A){var z=B.getProtocolForWebResource();if(/^https?:/i.test(A))return A;if(/^\/\//i.test(A))return z+A;if(/^\//i.test(A))return z+"//"+window.location.host+
A},_computeSize:function(A){var z={w:400,h:200};d("esri-mobile")?z={w:"50%",h:"90%"}:-1!==A.indexOf("Category")?(z.w=400,z.h=320):-1!==A.indexOf("Tool")?(z.w=400,z.h=320):-1!==A.indexOf("toolDescription")&&(z.w=400,z.h=520);return z},_initSelfHelpMap:function(){this.isPortal&&this.portalSelf&&this.portalSelf.helpMap&&(this.selfHelpMap=this.portalSelf.helpMap.m)},_setHelpTopicAttr:function(A){this.tooltipHelpDlg&&(t.close(this.tooltipHelpDlg),this.tooltipHelpDlg.destroy(),this.tooltipHelpDlg=null);
var z="";this.showLearnMore=!1;var G=this._analysisGpServer&&-1!==this._analysisGpServer.indexOf("dev")?"dev":this._analysisGpServer&&-1!==this._analysisGpServer.indexOf("qa")?"uat":"";z=this.isPortal?"-PortalOnly":"-OnlineOnly";var J=r.clone(b.locale);var L="es-es es-mx fr-fr fr-ch it-ch it-it de-de de-ch".split(" ");"nb"===J?J="no":-1!==m.indexOf(L,J)&&(J=J.split("-")[0]);var R="ar bg bs ca cs da de es el et fi fr he hr hu id it ja ko lt lv ru nl no pl pt-br pt-pt ro sl sk sv sr th tr uk vi zh-cn zh-hk zh-tw".split(" ");
var T="ar de es fr it ja ko ru pl pt-br zh-cn".split(" ");if("SHOWHELPURL"===A)L=this.helpIdUrl,this.showLearnMore=!1;else{L=H.toUrl("esri/dijit/analysis/help/"+this.helpFileName+".html");var aa=this.helpFileName;if(C.isDefined(this.onlineHelpMap)&&C.isDefined(this.onlineHelpMap[aa])&&C.isDefined(this.onlineHelpMap[aa][A])){this.showLearnMore=!0;var ca="https://doc"+G+".arcgis.com/en/arcgis-online/analyze/"+this.onlineHelpMap[aa][A];this.isPortal&&this.helpBase&&this.selfHelpMap&&(ca=this.helpBase+
this.selfHelpMap[this.onlineHelpMap[aa][A]])}-1!==m.indexOf(R,J)&&(-1!==J.indexOf("-")&&(J=J.split("-"),J=J[0]+"-"+J[1].toUpperCase()),L=H.toUrl("esri/dijit/analysis/help/"+J+"/"+this.helpFileName+".html"));-1!==m.indexOf(T,J)&&this.showLearnMore&&(ca="https://doc"+G+".arcgis.com/"+J+"/arcgis-online/analyze/"+this.onlineHelpMap[aa][A],this.isPortal&&this.helpBase&&this.selfHelpMap?ca=this.helpBase+this.selfHelpMap[this.onlineHelpMap[aa][A]]:this.isPortal&&!this.helpBase&&(ca="https://server"+G+".arcgis.com/"+
J+"/portal/latest/use/"+this.onlineHelpMap[aa][A]))}this._size=G=this._computeSize(A);this.tooltipHelpDlg=new v({preload:!0,content:"\x3cdiv class\x3d'' style\x3d'position:relative'\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3cdiv class\x3d'esriFloatTrailing' style\x3d'padding:0;'\x3e\x3ca href\x3d'#' class\x3d'esriAnalysisCloseIcon' title\x3d'"+this.i18n.close+"'\x3e\x3c/a\x3e\x3c/div\x3e\x3ciframe frameborder\x3d'0'  id\x3d'"+A+"' src\x3d'"+L+"#"+A+z+"' width\x3d'"+G.w+
"' height\x3d'"+G.h+"' marginheight\x3d'0' marginwidth\x3d'0'\x3e\x3c/iframe\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList"+(this.showLearnMore?"'\x3e":" hidden'\x3e")+"\x3ca class\x3d'action zoomTo' href\x3d'"+(this.showLearnMore?ca:"#")+"' target\x3d'_help'\x3e"+this.i18n.learnMore+"\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e","class":"esriHelpPopup esriHelpPopupWrapper esriAnalyisHelpWindow"});this.tooltipHelpDlg.startup()},
show:function(A,z){this.helpFileName=z.helpFileName;this._analysisGpServer=z.analysisGpServer;this.isPortal=z.isPortal;this.helpBase=z.helpBase;z.portalSelf&&(this.portalSelf=z.portalSelf);this.selfHelpMap||this._initSelfHelpMap();z.analysisMode&&(this.analysisMode=z.analysisMode);z.showHelpFromUrl&&z.helpUrl&&(this.showHelpFromUrl=z.showHelpFromUrl,this.helpIdUrl=z.helpUrl,z.helpId="SHOWHELPURL");this.set("helpTopic",z.helpId);var G=a.after(t,"open",r.hitch(this,function(){g(".esriAnalysisCloseIcon",
this.tooltipHelpDlg.domNode).on("click",r.hitch(this,this.close));G.remove()})),J=A.pageX,L=p.getBox(),R;var T=!1;if(z.helpParentNode)var aa=z.helpParentNode;aa&&(R=q.position(aa));R&&L.w-A.pageX<R.w?(T=!0,J=R.x-this._size.w-10,this._isRightToLeft&&(J-=10)):this._isRightToLeft&&J-40<this._size.w&&(J=R.w+this._size.w+80);t.open({popup:this.tooltipHelpDlg,x:!0===this._isRightToLeft||T?J-40:J+40,y:A.screenY-A.pageY+10,onCancel:r.hitch(this,function(){this.close()}),onExecute:function(){this.close()}});
this.tooltipHelpDlg.domNode.parentNode&&c.set(this.tooltipHelpDlg.domNode.parentNode,"overflowY","hidden")},close:function(A,z){t.close(this.tooltipHelpDlg)}});d("extend-esri")&&r.setObject("dijit.analysis.HelpWindow",n,y);return n})},"esri/dijit/BrowseItems":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/event dojo/dom-class dojo/dom-style dojo/dom-attr dojo/string dojo/on dojo/aspect dojo/has dojo/dom dojo/dom-construct dojo/mouse dojo/topic dojo/query dojo/parser dijit/registry dijit/TooltipDialog dijit/popup dojo/promise/all dojo/Deferred dgrid/Grid dgrid/extensions/Pagination dgrid/extensions/DijitRegistry dgrid/OnDemandGrid dgrid/Selection dgrid/selector dgrid/Keyboard dgrid/util/mouse dgrid/util/touch put-selector/put dojo/store/Observable dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../arcgis/Portal ../Evented ../PluginTarget dojo/i18n!../nls/jsapi ./_AppTemplateFiltersMixin ./_RefreshMixin ../kernel ../lang ../config ../geometry/webMercatorUtils ../tasks/GeometryService ../SpatialReference dojo/NodeList-dom".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da,Q,K,E,N,I,O,U,ha){var ia=H(null,{idProperty:"id",constructor:function(S){H.safeMixin(this,S)},get:function(S,W){return fa.PortalUtil.request(this.portalUrl+"content/items/"+S,W).then(function(ka){return new fa.PortalItem(m.mixin(ka,{portal:this.portal}))})},getIdentity:function(S){return S[this.idProperty]},query:function(S,W){S=m.isObject(S)?S:{q:S};var ka=null;if(W){S=m.mixin(S,{num:W.count,start:(W.start||
0)+1});if(W.sort&&W.sort.length){var ja=W.sort[0];S=m.mixin(S,{sortField:encodeURIComponent("created"===ja.attribute?"uploaded":ja.attribute),sortOrder:ja.descending?"desc":"asc"})}W.useExtent&&W.extent&&(S.bbox=W.extent);W.queryType&&"group"===W.queryType&&(ka="group")}W="group"===ka?this.portal.queryGroups(S,!0).then(function(ma){ma.results.total=ma.total;return ma.results}):this.portal.queryItems(S,!0).then(function(ma){ma.results.total=ma.total;return ma.results});return fa.PortalResult(W)}});
r=H([ba,la,oa,X],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"top-bar"\x3e\x3cdiv  class\x3d"esriFloatLeading instructions"\x3e\x3cspan class\x3d"messageLeft hide" data-dojo-attach-point\x3d"messageNodeLeft"\x3e\x3c/span\x3e\x3cspan class\x3d"messageRight hide" data-dojo-attach-point\x3d"messageNodeRight"\x3e\x3c/span\x3e\x3ca tabIndex\x3d"-1" data-dojo-attach-point\x3d"helpLink" class\x3d"esriHelpIcon hide" title\x3d"${i18n.browseItems.learnMoreConfigurableApps}" href\x3d"#" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv id\x3d"${id}_search"class\x3d"searchBar esriFloatTrailing"\x3e\x3cinput tabIndex\x3d"1" placeholder\x3d"${i18n.browseItems.searchTitle}" class\x3d"esriSearchBox dijitTextBox" type\x3d"search"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"gallery"\x3e\x3cdiv class\x3d"gallery-left  quiet-scroll"\x3e\x3cul class\x3d"filters"\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv class\x3d"templates gallery-right"\x3e\x3cp id\x3d"${id}_filterTitle" class\x3d"filter-title hide" data-dojo-attach-point\x3d"filterDescription"\x3e\x3c/p\x3e\x3cdiv id\x3d"${id}_grid"class\x3d"dgrid-autoheight quiet-scroll"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv  class\x3d"loaderWrap" data-dojo-attach-point\x3d"loaderWrap"\x3e\x3c/div\x3e\x3cdiv  class\x3d"js-info-panel templateInfoPanel" data-dojo-attach-point\x3d"infoPanel"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
galleryTemplate:"\x3cdiv style\x3d'opacity:1;' class\x3d'grid-item gallery-view'\x3e${item:_formatThumbnail}${item:_formatItemTitle}\x3cp class\x3d\"template-overlay\" style\x3d\"display:none;\"\x3e${i18n.browseItems.selectDetails}\x3c/p\x3e\x3c/div\x3e",infoPanelTemplate:'\x3cdiv\x3e\x3cdiv class\x3d"template-info-showing"\x3e\x3cdiv class\x3d"thumbnail"\x3e\x3cimg src\x3d"${item:_formatInfoPanelImage}"\x3e\x3c/div\x3e\x3ch4\x3e${item.title}\x3c/h4\x3e\x3cdiv class\x3d"template-info"\x3e\x3cp class\x3d"quiet-scroll"\x3e${item.snippet}\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"panel-actions"\x3e\x3cbutton class\x3d"btn blue btn-main" id\x3d"on-next"\x3e${i18n.browseItems.configure}\x3c/button\x3e\x3cbutton class\x3d"btn btn-cancel" id\x3d"close-panel"\x3e${i18n.common.close}\x3c/button\x3e\x3c/div\x3e\x3cdiv\x3e',
_popupTemplate:'\x3cdiv class\x3d"esriBrowsePopup quiet-scroll"\x3e\x3cp\x3e{summary}\x3c/p\x3e\x3c/div\x3e',showInfoPanel:!0,isAutoClose:!0,showTooltip:!1,filterWithinGroup:!0,checkIsButtonEnabled:!1,baseClass:"esriBrowseItemsCtr",i18n:da,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.self?(this._portal=new fa.Portal({url:this.portalUrl,self:this.self}),this._init(),this._portal.on("load",m.hitch(this,function(){this.emit("portal-load",
{portal:this._portal});this._fetchData()}))):(this._portal=new fa.Portal(this.portalUrl),this._portal.signIn().then(m.hitch(this,function(){this.emit("portal-load",{portal:this._portal});this._init();this._fetchData()})))},_init:function(){this._canSearchPublic=this.self?this.self.canSearchPublic:this._portal.canSearchPublic;this.query=m.mixin(this.query||{},{get:function(S){return this[S]&&this[S].length?"("+this[S].join(" OR ")+") ":""},toString:function(){return{q:this.get("groups")+this.get("tags")+
this.get("persistentTypekeywords")+this.get("typekeywords")+this.get("types")+this.get("owners")+this.get("orgids")+this.get("custom")+(this.query||"")+(this.search||"")+' -type:"Attachment" -tags:"mature support"'}}});this.self?this.self.canSearchPublic=!0:this._portal.canSearchPublic=!0;this.galleryTemplate=this.plugIn&&this.plugIn.galleryTemplate||this.galleryTemplate;this.infoPanelTemplate=this.plugIn&&this.plugIn.infoPanelTemplate||this.infoPanelTemplate;if(this.helpLinkUrl=this.plugIn&&this.plugIn.helpLinkUrl||
"")a.set(this.helpLink,"href",this.helpLinkUrl),k.remove(this.helpLink,"hide");u(".templates",this.domNode).addClass("fade");u(".dgrid-footer",this.domNode).addClass("hide");b.set(this.infoPanel,"display","none")},destroy:function(){this.inherited(arguments);this._grid&&this._grid.destroy();this._img_connect&&(this._img_connect.remove(),this._img_connect_error.remove());this._queryTimer&&clearTimeout(this._queryTimer);this._grid=this._portal=null},closeInfoPanel:function(){c.byId("close-panel").click()},
_setItemQueryAttr:function(S){this.itemQuery=S},_setPluginAttr:function(S){this.addPlugin(S)},_setMessageAttr:function(S){this.set("messageRight",S)},_setMessageRightAttr:function(S){"string"===typeof S?a.set(this.messageNodeRight,"innerHTML",S):S instanceof HTMLElement&&g.place(S,this.messageNodeRight);k.remove(this.messageNodeRight,"hide")},_setMessageLeftAttr:function(S){"string"===typeof S?a.set(this.messageNodeLeft,"innerHTML",S):S instanceof HTMLElement&&g.place(S,this.messageNodeLeft);k.remove(this.messageNodeLeft,
"hide")},_setDisabledAttr:function(S){var W=t.findWidgets(this.domNode).concat(t.findWidgets(this._content));n.forEach(W,function(ka){ka.set("disabled",S)});k[S?"add":"remove"](this._interval.domNode,"dijitTextBoxDisabled")},_setSortAttr:function(S){this.sortAttribute=S},_setSortDescendingAttr:function(S){this.sortDescending=S},_getSelectionAttr:function(){var S=this._grid.selection,W;for(W in S)if(S.hasOwnProperty(W))break;return W&&this._grid.row(W).data},_setGalleryTemplateAttr:function(S){N.isDefined(S)&&
(this.galleryTemplate=S)},_setFormatThumbnailAttr:function(S){N.isDefined(S)&&"function"===typeof S&&(this._formatThumbnail=S)},_setFormatItemTitleAttr:function(S){N.isDefined(S)&&"function"===typeof S&&(this._formatItemTitle=S)},_setRowsPerPageAttr:function(S){this._set("rowsPerPage",S)},_setPagingLinksAttr:function(S){this._set("pagingLinks",S)},_getQueryAttr:function(){return this.query},_setQueryAttr:function(S){this._set("query",S);this._grid&&this._grid.set("query",S.toString())},_setExtentAttr:function(S){S&&
this._set("extent",this._extentToString(S))},_setUseExtentAttr:function(S){this._set("useExtent",S)},_setQueryTypeAttr:function(S){this._set("queryType",S)},_setFetchTimeoutAttr:function(S){this._set("fetchTimeout",S)},_setShowInfoPanelAttr:function(S){this._set("showInfoPanel",S)},_setSelectionModeAttr:function(S){-1===n.indexOf(["extended","toggle","multiple","single","none"],S)&&(console.log("Incorrect Value provided for selectionMode. It is one of the following: extended, toggle, multiple, single, none"),
S="single");this._set("selectionMode",S)},_setDemandListAttr:function(S){this._set("demandList",S)},_validate:function(){return!!this.get("selection")},reset:function(){u(".esriSearchBox",c.byId(this.id+"_search")).forEach(function(ma){a.set(ma,"value","")});this.query.search="";if(this.plugIn.filters){var S=[],W=[],ka=[],ja=[];u("li.active",this.domNode).forEach(function(ma){k.remove(ma,"active");var ta=this.plugIn.filters[ma.childNodes[0].id];ma=n.map(ta.tags,function(Y){return'tags:"'+Y+'"'},this);
var D=n.map(ta.owners,function(Y){return'owner:"'+Y+'"'},this),P=n.map(ta.orgids,function(Y){return'orgid:"'+Y+'"'},this);ta=n.map(ta.typekeywords,function(Y){return'typekeywords:"'+Y+'"'},this);S.push(ma);ka.push(D);ja.push(P);W.push(ta)},this);this.query.tags=n.filter(this.query.tags,function(ma){return-1!==n.indexOf(S,ma)});this.query.owners=n.filter(this.query.owners,function(ma){return-1!==n.indexOf(ka,ma)});this.query.orgids=n.filter(this.query.orgids,function(ma){return-1!==n.indexOf(ja,ma)});
this.query.typekeywords=n.filter(this.query.typekeywords,function(ma){return-1!==n.indexOf(W,ma)});c.byId("all").click()}},_showPopup:function(S){if(!this._isInsideTooltipDialog){this._closePopup();var W=this._grid.row(S);S=u("img",W.element)[0];if(W={summary:W.data.snippet},W.summary)this._tooltip=new y({content:m.replace(this._popupTemplate,W),onMouseEnter:m.hitch(this,function(){this._isInsideTooltipDialog=!0}),onMouseLeave:m.hitch(this,function(){this._isInsideTooltipDialog=!1;this._closePopup()})}),
C.open({className:"esriBrowsePopupCtr",popup:this._tooltip,around:S,orient:["after-centered","before-centered"]}),this._onCloseConnect=u(".dijitDialogCloseIcon",this._tooltip.domNode).on("click",m.hitch(this,function(ka){ka.preventDefault();this._closePopup()}))}},_closePopup:function(){this._tooltip&&(this._onCloseConnect&&this._onCloseConnect.remove(),C.close(this._tooltip),this._tooltip.destroyRecursive(),this._tooltip=this._onCloseConnect=void 0)},_clearQueryTimeout:function(){clearTimeout(this._queryTimer);
this._queryTimer=null},_clearClosePanelTimeout:function(){clearTimeout(this._panelClosing);this._panelClosing=null;n.forEach(this._panelClickHandles,"item.remove();");g.empty(this.infoPanel)},_createGrid:function(){var S=H([x,w,G,K,A]),W=new ca(new ia({portal:this._portal})),ka=this.query,ja=m.hitch(this,function(D){D.snippet=D.snippet||"";var P=aa("div");D=d.substitute(this.galleryTemplate,{item:D,i18n:this.i18n},null,this);g.place(D,P);return P}),ma={};this.get("demandList")&&(S=H([x,z,G,K,A]));
this.get("useExtent")&&(ma.extent=this.get("extent"),ma.useExtent=this.get("useExtent"));this.get("queryType")&&(ma.queryType=this.get("queryType"));var ta={store:W,query:ka.toString(),selectionMode:this.selectionMode||"single",pagingLinks:this.get("pagingLinks")||2,rowsPerPage:this.plugIn&&this.plugIn.rowsPerPage||this.get("itemsPerPage")||6,loadingMessage:"Loading items...",showLoadingMessage:!1,renderRow:ja,noDataMessage:this.i18n.gallery.noItemsToDisplay,deselectOnRefresh:!("multiple"===this.selectionMode||
"extended"===this.selectionMode||"toggle"===this.selectionMode),sort:[{attribute:this.sortAttribute||"title",descending:this.sortDescending||!1}],queryOptions:ma};this.get("demandList")&&(ta={store:W,query:ka.toString(),minRowsPerPage:this.plugIn&&this.plugIn.rowsPerPage||this.get("itemsPerPage")||50,selectionMode:this.selectionMode||"single",loadingMessage:"Loading items...",showLoadingMessage:!1,renderRow:ja,pagingMethod:"throttleDelayed",noDataMessage:this.i18n.gallery.noItemsToDisplay,deselectOnRefresh:!("multiple"===
this.selectionMode||"extended"===this.selectionMode||"toggle"===this.selectionMode),sort:[{attribute:this.sortAttribute||"title",descending:this.sortDescending||!1}],queryOptions:ma});this._grid=new S(ta,this.id+"_grid");this._grid.startup();this.own(f(this.domNode,"click",m.hitch(this,function(D){c.byId("close-panel")&&this.isAutoClose&&c.byId("close-panel").click()})),this._grid.on(R.enterRow,m.hitch(this,function(D){!1===k.contains(this.domNode,"showing")&&this.showInfoPanel&&this._showOverlay(!0,
D);this.showTooltip&&!this.showInfoPanel&&this._showPopup(D)})),this._grid.on(R.leaveRow,m.hitch(this,function(D){this._showOverlay(!1,D);this.showTooltip&&!this.showInfoPanel&&this._closePopup(D)})),this._grid.on(".dgrid-row:click",m.hitch(this,function(D){this.emit("grid-row-click",D);if(!1===k.contains(this.domNode,"showing")&&this.showInfoPanel){D.preventDefault();l.stop(D);this._clearClosePanelTimeout();var P=this.get("selection");this._showOverlay(!1,D);this.showInfoPanel&&this.infoPanelTemplate?
(b.set(this.infoPanel,"display","block"),g.place(d.substitute(this.infoPanelTemplate,{item:P,i18n:this.i18n},function(Y){return N.isDefined(Y)?Y:""},this),this.infoPanel)):b.set(this.infoPanel,"display","none");this.emit("show-info-panel");k.add(this.domNode,"showing");this._panelClickHandles=[u(".template-info-showing .thumbnail img",this.domNode).on("error",m.hitch(this,function(Y){a.set(Y.target,"src",P.thumbnailUrl)})),u(".panel-actions .btn").on("click",m.hitch(this,function(Y){Y.preventDefault();
l.stop(Y);this.checkIsButtonEnabled&&k.contains(Y.target,"disabled")||("close-panel"===Y.target.id?(k.remove(this.domNode,"showing"),b.set(this.infoPanel,"display","none"),this._panelClosing=setTimeout(m.hitch(this,function(){n.forEach(void 0,"item.remove();");g.empty(this.infoPanel)},250))):(q.publish("/esri/browseitems/close",Y.target.id,this.get("selection")),Y={selection:this.get("selection"),action:Y.target.id},this.emit("browseitems-close",Y)))})),u(".js-info-panel",this.domNode).on("click",
m.hitch(this,function(Y){this.isAutoClose&&(Y.preventDefault(),l.stop(Y))})),f(u(".dgrid-footer,.dgrid-header",this._grid.domNode),p.leave,m.hitch(this,function(Y){this.showTooltip&&!this.showInfoPanel&&this._closePopup()}))]}})),this._grid.on("dgrid-refresh-complete",m.hitch(this,function(D){u(".templates",this.domNode).removeClass("fade");u(".loaderWrap",this.domNode).addClass("hide");u(".dgrid-footer",this.domNode)[this._grid._total<=this._grid.rowsPerPage?"addClass":"removeClass"]("hide");this.showTooltip&&
!this.showInfoPanel&&this._closePopup()})),this._grid.on("refresh",m.hitch(this,function(){this.showTooltip&&!this.showInfoPanel&&this._closePopup();this._img_connect&&(this._img_connect.remove(),this._img_connect_error.remove(),this._img_connect_error=this._img_connect=null);this._img_connect=u(".grid-item-thumb",this._grid.domNode).on("load",m.hitch(this,function(D){(D=this._grid.row(D))&&D.element&&u(".grid-item",D.element).addClass("fadeIn").style("opacity","1")}));this._img_connect_error=u(".grid-item-thumb",
this._grid.domNode).on("error",m.hitch(this,function(D){a.set(D.target,"src",this._portal.staticImagesUrl+"/desktopapp.png")}))})),f(c.byId(this.id+"_search"),"keyup",m.hitch(this,function(D){D.preventDefault();this._clearQueryTimeout();this._queryTimer=setTimeout(m.hitch(this,function(){this.query.search=a.get(D.target,"value");this._fetchItems(this.query).then(m.hitch(this,function(){this._clearQueryTimeout()}))}),this.searchKeypressDelay||450)})),f(c.byId(this.id+"_search"),"search",m.hitch(this,
function(D){this._queryTimer||(D.preventDefault(),this.query.search=a.get(D.target,"value"),this._fetchItems(this.query))})),this.watch("extent",m.hitch(this,function(D,P,Y){this._grid.queryOptions.extent=this.get("extent");this._grid.queryOptions.useExtent=this.get("useExtent");this._grid.query.bbox=this._grid.queryOptions.useExtent?this._grid.queryOptions.extent:"";this._grid.refresh()})),this.watch("useExtent",m.hitch(this,function(D,P,Y){this._grid.queryOptions.extent=this.get("extent");this._grid.queryOptions.useExtent=
Y;this._grid.query.bbox=this._grid.queryOptions.useExtent?this._grid.queryOptions.extent:"";this._grid.refresh()})));this.showInfoPanel||("single"===this._grid.selectionMode?this.own(this._grid.on("dgrid-select,dgrid-deselect",m.hitch(this,function(D){D={selection:this.get("selection")};this.emit("select-change",D)}))):-1!==n.indexOf(["toggle","multiple","extended"],this._grid.selectionMode)&&this.own(this._grid.on("dgrid-select,dgrid-deselect",m.hitch(this,function(D){D=D.grid.selection;var P,Y=
[];for(P in D)D[P]&&Y.push(this._grid.row(P).data);this.emit("select-change",{selection:Y})}))));this.emit("grid-ready",{grid:this._grid,ready:!0})},_createFilters:function(){if(this.plugIn&&this.plugIn.filters){var S=this.plugIn.filters,W=this.plugIn.filterStrings,ka,ja=u(".filters",this.domNode)[0];for(ka in S)g.create("li",{"class":"all"===ka?"active":"",innerHTML:"\x3ca id\x3d'"+ka+"'  href\x3d'#'\x3e"+W[ka].title+"\x3c/a\x3e"},ja);this.own(f(ja,"li a:click",m.hitch(this,function(ma){ma.preventDefault();
var ta=ma.target;u(".active",ja).removeClass("active");k.add(ta.parentNode,"active");u(".templates",this.domNode).addClass("fade");setTimeout(m.hitch(this,function(){k["all"===ta.id?"add":"remove"](this.filterDescription,"hide");a.set(this.filterDescription,"innerHTML",W[ta.id].description||"")}),225);ma=m.mixin({},S[ta.id]||{});this.query.tags=n.map(ma.tags||[],function(D){return'tags:"'+D+'"'});this.query.owners=n.map(ma.owners,function(D){return'owner:"'+D+'"'});this.query.orgids=n.map(ma.orgids,
function(D){return'orgid:"'+D+'"'});this.query.typekeywords=[].concat(n.map(ma.typekeywords||[],function(D){return'typekeywords:"'+D+'"'}));this.filterWithinGroup||(this.query.groups=n.map(ma.groups,function(D){return'group:"'+D+'"'}));this._fetchItems(this.query)})));k.add(this.domNode,"filters");k.remove(this.domNode,"nofilters")}else k.add(this.domNode,"nofilters"+(this.plugIn&&this.plugIn.extraClasses?" "+this.plugIn.extraClasses.join(" "):"")),k.remove(this.domNode,"filters")},_showOverlay:function(S,
W){(W=this._grid.row(W))&&u(".template-overlay",W.element).style("display",S?"":"none")},_fetchData:function(){this._user=this._portal.getPortalUser();return this.plugIn&&this.plugIn.fetchData?this.plugIn.fetchData():this._fetchItems(this.itemQuery)},_fetchItems:function(S,W){var ka={sort:[{attribute:this.sortAttribute||"title",descending:this.sortDescending||!1}]},ja=new F;this.get("useExtent")&&(ka.extent=this.get("extent"),ka.useExtent=this.get("useExtent"));this.get("queryType")&&(ka.queryType=
this.get("queryType"));u(".templates",this.domNode).addClass("fade");u(".dgrid-footer",this.domNode).addClass("hide");u(".loaderWrap",this.domNode).removeClass("hide");setTimeout(m.hitch(this,function(){this.query=m.mixin(this.query,S);this._grid?this._grid.set("query",this.query.toString(),ka):(this._createFilters(),this._createGrid());ja.resolve(this._grid)}),60);return ja},_formatThumbnail:function(S){var W=S.thumbnailUrl||this._portal.staticImagesUrl+"/desktopapp.png";S.thumbnailUrl=W;return"\x3cimg class\x3d'grid-item-thumb' width\x3d'187px' height\x3d'125px' alt\x3d'' src\x3d'"+
W+"'\x3e"},_formatInfoPanelImage:function(S){var W=S.screenshots&&S.screenshots.length?S.screenshots[0]:null;return W?S.itemUrl+"/info/"+W:S.thumbnailUrl},_formatItemTitle:function(S){return"\x3ch5\x3e"+(S.title||S.name||"\x3cNo Title\x3e")+"\x3c/h5\x3e"},clear:function(){this._grid.clearSelection()},doProject:function(S,W){var ka=[102113,102100,3857],ja=new F;var ma=function(D,P){!(D&&0<D.length&&D[0]&&"extent"==D[0].type)||isNaN(D[0].xmin)||isNaN(D[0].ymin)||isNaN(D[0].xmax)||isNaN(D[0].ymax)?D&&
0<D.length&&D[0]&&"point"==D[0].type&&!isNaN(D[0].x)&&!isNaN(D[0].y)&&ja.resolve(D,P):ja.resolve(D,P)};if(null!=S.spatialReference.wkid&&4326==S.spatialReference.wkid&&null!=W.wkid&&this.contains(ka,W.wkid)){S.ymin=Math.max(S.ymin,-89.99);S.ymax=Math.min(S.ymax,89.99);S=O.geographicToWebMercator(S);if((ka=S.spatialReference._getInfo())&&S.xmin>S.xmax){ma=ka.valid[1]-S.xmin;var ta=S.xmax-ka.valid[0];ma>ta?S.xmax=ka.valid[1]+ta:S.xmin=ka.valid[0]-ma}S.spatialReference.wkid=W.wkid;ja.resolve([S])}else null!=
S.spatialReference.wkid&&this.contains(ka,S.spatialReference.wkid)&&null!=W.wkid&&4326==W.wkid?(S=O.webMercatorToGeographic(S),(ka=S.spatialReference._getInfo())&&S.xmin>S.xmax&&(ma=ka.valid[1]-S.xmin,ta=S.xmax-ka.valid[0],ma>ta?S.xmax=ka.valid[1]+ta:S.xmin=ka.valid[0]-ma),ja.resolve([S])):(this.geometryService||(this.geometryService=new U(I.defaults.geometryService)),this.geometryService.project([S],W,ma));return ja},contains:function(S,W){for(var ka=S.length;ka--;)if(S[ka]===W)return!0;return!1},
_extentToGCS:function(S){S=S.shiftCentralMeridian(!0);return O.webMercatorToGeographic(S)},_extentToString:function(S){var W="";null!=S&&(S=this._extentToGCS(S),W=this._roundValue(S.xmin,1E4)+","+this._roundValue(S.ymin,1E4)+","+this._roundValue(S.xmax,1E4)+","+this._roundValue(S.ymax,1E4));return W},_roundValue:function(S,W){return Math.round(S*W)/W}});h("extend-esri")&&m.setObject("dijit.BrowseItems",r,E);return r})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/on dojo/query dojo/string dojo/has put-selector/put ../util/misc dojo/i18n!./nls/pagination dojo/_base/sniff xstyle/css!../css/extensions/Pagination.css".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h){function c(p){p.noDataNode?(f(p.noDataNode,"!"),delete p.noDataNode):p.cleanup();p.contentNode.innerHTML=""}function g(p){if(p.loadingNode)f(p.loadingNode,"!"),delete p.loadingNode;else if(p._oldPageNodes){for(var q in p._oldPageNodes)p.removeRow(p._oldPageNodes[q]);delete p._oldPageNodes;p._oldPageObserver&&(p._oldPageObserver.cancel(),p._numObservers--,delete p._oldPageObserver)}delete p._isLoading}return m("dgrid.extensions.Pagination",H,{rowsPerPage:10,pagingTextBox:!1,
previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:h,showFooter:!0,_currentPage:1,_total:0,buildRendering:function(){this.inherited(arguments);var p=this,q=this.paginationNode=f(this.footerNode,"div.dgrid-pagination"),u=this.paginationStatusNode=f(q,"div.dgrid-status"),v=this.i18nPagination;u.tabIndex=0;this._updatePaginationSizeSelect();this._updateRowsPerPageOption();u.innerHTML=a.substitute(v.status,{start:1,end:1,total:0});q=this.paginationNavigationNode=
f(q,"div.dgrid-navigation");this.firstLastArrows&&(u=this.paginationFirstNode=f(q,"span.dgrid-first.dgrid-page-link","\u00ab"),u.setAttribute("aria-label",v.gotoFirst),u.tabIndex=0);this.previousNextArrows&&(u=this.paginationPreviousNode=f(q,"span.dgrid-previous.dgrid-page-link","\u2039"),u.setAttribute("aria-label",v.gotoPrev),u.tabIndex=0);this.paginationLinksNode=f(q,"span.dgrid-pagination-links");this.previousNextArrows&&(u=this.paginationNextNode=f(q,"span.dgrid-next.dgrid-page-link","\u203a"),
u.setAttribute("aria-label",v.gotoNext),u.tabIndex=0);this.firstLastArrows&&(u=this.paginationLastNode=f(q,"span.dgrid-last.dgrid-page-link","\u00bb"),u.setAttribute("aria-label",v.gotoLast),u.tabIndex=0);this._listeners.push(k(q,".dgrid-page-link:click,.dgrid-page-link:keydown",function(t){if("keydown"!==t.type||13===t.keyCode)if(t=this.className,!(p._isLoading||-1<t.indexOf("dgrid-page-disabled"))){var y=p._currentPage;var C=Math.ceil(p._total/p.rowsPerPage);this===p.paginationPreviousNode?p.gotoPage(y-
1):this===p.paginationNextNode?p.gotoPage(y+1):this===p.paginationFirstNode?p.gotoPage(1):this===p.paginationLastNode?p.gotoPage(C):"dgrid-page-link"===t&&p.gotoPage(+this.innerHTML)}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},_updatePaginationSizeSelect:function(){var p=this.pageSizeOptions,q=this.paginationSizeSelect;if(p&&p.length){if(!q){q=this.paginationSizeSelect=f(this.paginationNode,"select.dgrid-page-size[aria-label\x3d"+
this.i18nPagination.rowsPerPage+"]");var u=this._paginationSizeChangeHandle=k(q,"change",r.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)}));this._listeners.push(u)}for(u=q.options.length=0;u<p.length;u++)f(q,"option",p[u],{value:p[u],selected:this.rowsPerPage===p[u]});this._updateRowsPerPageOption()}else p&&p.length||!q||(f(q,"!"),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove())},_setPageSizeOptions:function(p){this.pageSizeOptions=p&&p.sort(function(q,
u){return q-u});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var p=this.rowsPerPage,q=this.pageSizeOptions,u=this.paginationSizeSelect;u&&(0>n.indexOf(q,p)?this._setPageSizeOptions(q.concat([p])):u.value=""+p)},_setRowsPerPage:function(p){this.rowsPerPage=p;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(){function p(G,J){if(u.pagingTextBox&&G==y&&1<F)J=f(t,"input.dgrid-page-input[type\x3dtext][value\x3d$]",y),J.setAttribute("aria-label",v.jumpPage),
u._pagingTextBoxHandle=k(J,"change",function(){var R=+this.value;!isNaN(R)&&0<R&&R<=F&&u.gotoPage(+this.value)}),w&&"INPUT"===w.tagName&&J.focus();else{var L=G===y;J=f(t,"span"+(L?".dgrid-page-disabled":"")+".dgrid-page-link",G+(J?" ":""));J.setAttribute("aria-label",v.gotoPage);J.tabIndex=L?-1:0;A===G&&(L?G<F?A++:z.focus():J.focus());L||(z=J)}}function q(G,J){f(G,(J?".":"!")+"dgrid-page-disabled");G.tabIndex=J?-1:0}var u=this,v=this.i18nPagination,t=this.paginationLinksNode,y=this._currentPage,C=
this.pagingLinks,B=this.paginationNavigationNode,F=Math.ceil(this._total/this.rowsPerPage),x=this._pagingTextBoxHandle,w=document.activeElement,A,z;w&&e.contains(this.paginationNavigationNode,w)?"dgrid-page-link"===w.className&&(A=+w.innerHTML):w=null;x&&x.remove();t.innerHTML="";b(".dgrid-first, .dgrid-previous",B).forEach(function(G){q(G,1===y)});b(".dgrid-last, .dgrid-next",B).forEach(function(G){q(G,y>=F)});if(C&&0<F){p(1,!0);B=y-C;for(2<B?f(t,"span.dgrid-page-skip","..."):B=2;B<Math.min(y+C+
1,F);B++)p(B,!0);y+C+1<F&&f(t,"span.dgrid-page-skip","...");1<F&&p(F)}else u.pagingTextBox&&p(y);w&&-1===w.tabIndex&&(C=b("[tabindex\x3d'0']",this.paginationNavigationNode),w===this.paginationPreviousNode||w===this.paginationFirstNode?w=C[0]:C.length&&(w=C[C.length-1]),w&&w.focus())},refresh:function(){var p=this;this.inherited(arguments);if(this.store)return this.gotoPage(1).then(function(q){setTimeout(function(){k.emit(p.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:p,results:q})},
0);return q});console.warn("Pagination requires a store to operate.")},_onNotification:function(p){p.length!==this._rowsOnPage&&this.gotoPage(this._currentPage)},renderArray:function(p,q){var u=this,v=this.inherited(arguments);this._lastCollection=null;q||(this._topLevelRequest&&this._topLevelRequest!==p&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof p.cancel&&(this._topLevelRequest=p),l.when(p,function(){u._topLevelRequest&&delete u._topLevelRequest}));return v},
insertRow:function(){var p=this._oldPageNodes,q=this.inherited(arguments);p&&q===p[q.id]&&delete p[q.id];return q},gotoPage:function(p){var q=this,u=new l;this._trackError(function(){var v=q.rowsPerPage,t=(p-1)*v,y=r.mixin(q.get("queryOptions"),{start:t,count:v}),C=q.contentNode,B;if(q.showLoadingMessage){c(q);var F=q.loadingNode=f(C,"div.dgrid-loading");F.innerHTML=q.loadingMessage}else{q._oldPageNodes=F={};C=C.children;var x=0;for(B=C.length;x<B;x++)F[C[x].id]=C[x];q._oldPageObserver=q.observers.pop()}q._isLoading=
!0;var w=q.store.query(q.query,y);l.when(q.renderArray(w,null,y),function(A){g(q);q.scrollTo({y:0});l.when(w.total,function(z){z||(q.noDataNode&&(f(q.noDataNode,"!"),delete q.noDataNode),q.noDataNode=f(q.contentNode,"div.dgrid-no-data"),q.noDataNode.innerHTML=q.noDataMessage);q.paginationStatusNode.innerHTML=a.substitute(q.i18nPagination.status,{start:Math.min(t+1,z),end:Math.min(z,t+v),total:z});q._total=z;q._currentPage=p;q._rowsOnPage=A.length;q._updateNavigation()});(7>d("ie")||d("ie")&&d("quirks"))&&
q.resize();u.resolve(w)},function(A){g(q);u.reject(A)});return u.promise})||u.reject();return u.promise}})})},"dgrid/extensions/DijitRegistry":function(){define(["dojo/_base/declare","dojo/dom-geometry","dijit/registry"],function(H,m,n){return H("dgrid.extensions.DijitRegistry",null,{minSize:0,maxSize:Infinity,layoutPriority:0,showTitle:!0,buildRendering:function(){n.add(this);this.inherited(arguments);this.domNode.setAttribute("widgetId",this.id)},startup:function(){if(!this._started){this.inherited(arguments);
var r=n.getEnclosingWidget(this.domNode.parentNode);r&&r.isLayoutContainer&&this._resizeHandle.remove()}},destroyRecursive:function(){this.destroy()},destroy:function(){this.inherited(arguments);n.remove(this.id)},getChildren:function(){return[]},isLeftToRight:function(){return!this.isRTL},resize:function(r){r&&m.setMarginBox(this.domNode,r);this.inherited(arguments)},_set:function(r,l){this[r]=l},watch:function(){},getParent:function(){return n.getEnclosingWidget(this.domNode.parentNode)}})})},"dgrid/selector":function(){define("dojo/_base/kernel dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/_base/sniff put-selector/put".split(" "),
function(H,m,n,r,l,k,b){n.getObject("dgrid.selector",!0);return dgrid.selector=function(a,d){function f(v){return!p.allowSelect(p.row(v))}function e(v){return function(t){var y=t.rows,C=y.length;t="false";var B;for(B=0;B<C;B++){var F=p.cell(y[B],a.id).element;F&&(F=(F.contents||F).input)&&!F.disabled&&(F.checked=v,F.setAttribute("aria-checked",v))}if("checkbox"==q.type){y=p.selection;C=!1;for(B in y)if(y[B]!=p.allSelected){C=!0;break}q.indeterminate=C;q.checked=p.allSelected;C?t="mixed":p.allSelected&&
(t="true");q.setAttribute("aria-checked",t)}}}function h(v){if("click"==v.type||32==v.keyCode||!k("opera")&&13==v.keyCode||0===v.keyCode){var t=p.row(v);p._selectionTriggerEvent=v;if(t){if(p.allowSelect(t)){var y=p._lastSelected&&p.row(p._lastSelected);"radio"==d?y&&y.id==t.id||(p.clearSelection(),p.select(t,null,!0),p._lastSelected=t.element):t&&(v.shiftKey?e(!0)({rows:[t]}):y=null,y=v.shiftKey?y:null,p.select(y||t,t,y?void 0:null),p._lastSelected=t.element)}}else b(this,(p.allSelected?"!":".")+
"dgrid-select-all"),p[p.allSelected?"clearSelection":"selectAll"]();p._selectionTriggerEvent=null}}function c(){p._hasSelectorInputListener=!0;g.push(p.on(".dgrid-selector:click,.dgrid-selector:keydown",h));var v=p._handleSelect;p._handleSelect=function(C){this.cell(C).column!=a&&v.apply(this,arguments)};if("function"==typeof a.disabled){var t=p.allowSelect,y=a.disabled;p.allowSelect=function(C){var B=t.call(this,C);return y===f?B:B&&!y.call(a,C.data)}}a.disabled=f;g.push(p.on("dgrid-select",e(!0)));
g.push(p.on("dgrid-deselect",e(!1)))}var g=[],p,q;a||(a={});a.type&&(a.selectorType=a.type,H.deprecated("columndef.type","use columndef.selectorType instead","dgrid 0.4"));a.selectorType=d=d||a.selectorType||"checkbox";a.sortable=!1;var u="function"==typeof d?d:function(v,t,y){var C=t.parentNode;p._hasSelectorInputListener||c();var B=a.disabled;b(C&&C.contents?C:t,".dgrid-selector");t=t.input||(t.input=b(t,"input[type\x3d"+d+"]",{tabIndex:isNaN(a.tabIndex)?-1:a.tabIndex,disabled:B&&("function"==typeof B?
B.call(a,y):B),checked:v}));t.setAttribute("aria-checked",!!v);return t};l.after(a,"init",function(){p=a.grid});l.after(a,"destroy",function(){m.forEach(g,function(v){v.remove()});p._hasSelectorInputListener=!1});a.renderCell=function(v,t,y,C,B){t=(t=v&&p.row(v))&&p.selection[t.id];u(t,y,v)};a.renderHeaderCell=function(v){var t="label"in a?a.label:a.field||"";"radio"!=d&&p.allowSelectAll?u(!1,v,{}):(v.appendChild(document.createTextNode(t)),p._hasSelectorInputListener||c());q=v.lastChild};return a}})},
"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(H,m,n,r,l,k,b,a){function d(w){w.preventDefault()}var f={checkbox:1,radio:1,button:1},e=/\bdgrid-cell\b/,h=/\bdgrid-row\b/,c=H("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=r.mixin({},c.defaultKeyMap));
this.headerKeyMap||(this.headerKeyMap=r.mixin({},c.defaultHeaderKeyMap))},postCreate:function(){function w(G){var J=G.target;return J.type&&(!f[J.type]||32==G.keyCode)}function A(G){function J(){z._focusedHeaderNode&&(z._focusedHeaderNode.tabIndex=-1);if(z.showHeader){if(L)for(var ca=0,ba,la=z.headerNode.getElementsByTagName("th");ba=la[ca];++ca){if(R.test(ba.className)){z._focusedHeaderNode=aa=ba;break}}else z._focusedHeaderNode=aa=z.headerNode;aa&&(aa.tabIndex=z.tabIndex)}}var L=z.cellNavigation,
R=L?e:h,T=G===z.headerNode,aa=G;T?(J(),m.after(z,"renderHeader",J,!0)):m.after(z,"renderArray",function(ca){return a.when(ca,function(ba){var la=z._focusedNode||aa;if(R.test(la.className)&&b.contains(G,la))return ba;for(var oa=0,fa=G.getElementsByTagName("*"),M;M=fa[oa];++oa)if(R.test(M.className)){la=z._focusedNode=M;break}la.tabIndex=z.tabIndex;return ba})});z._listeners.push(n(G,"mousedown",function(ca){w(ca)||z._focusOnNode(ca.target,T,ca)}));z._listeners.push(n(G,"keydown",function(ca){if(!ca.metaKey&&
!ca.altKey){var ba=z[T?"headerKeyMap":"keyMap"][ca.keyCode];ba&&!w(ca)&&ba.call(z,ca)}}))}this.inherited(arguments);var z=this;this.tabableHeader&&(A(this.headerNode),this._listeners.push(n(this.headerNode,"dgrid-cellfocusin",function(){z.scrollTo({x:this.scrollLeft})})));A(this.contentNode);this._debouncedEnsureScroll=b.debounce(this._ensureScroll,this)},removeRow:function(w){if(!this._focusedNode)return this.inherited(arguments);var A=this,z=document.activeElement===this._focusedNode,G=this[this.cellNavigation?
"cell":"row"](this._focusedNode),J=G.row||G,L;w=w.element||w;w===J.element&&((L=this.down(J,!0))&&L.element!==w||(L=this.up(J,!0)),this._removedFocus={active:z,rowId:J.id,columnId:G.column&&G.column.id,siblingId:L&&L.element!==w?L.id:void 0},setTimeout(function(){A._removedFocus&&A._restoreFocus(J.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(w){var A=this.inherited(arguments);this._removedFocus&&!this._removedFocus.wait&&this._restoreFocus(A);return A},_restoreFocus:function(w){var A=
this._removedFocus,z;if((w=(w=w&&this.row(w))&&w.element&&w.id===A.rowId?w:"undefined"!==typeof A.siblingId&&this.row(A.siblingId))&&w.element){if(!w.element.parentNode.parentNode){A.wait=!0;return}"undefined"!==typeof A.columnId&&(z=this.cell(w,A.columnId))&&z.element&&(w=z);A.active&&0!==w.element.offsetHeight?this._focusOnNode(w,!1,null):(k(w.element,".dgrid-focus"),w.element.tabIndex=this.tabIndex,this._focusedNode=w.element)}delete this._removedFocus},addKeyHandler:function(w,A,z){return m.after(this[z?
"headerKeyMap":"keyMap"],w,A,!0)},_ensureRowScroll:function(w){var A=this.getScrollPosition().y;A>w.offsetTop?this.scrollTo({y:w.offsetTop}):A+this.contentNode.offsetHeight<w.offsetTop+w.offsetHeight&&this.scrollTo({y:w.offsetTop-this.contentNode.offsetHeight+w.offsetHeight})},_ensureColumnScroll:function(w){var A=this.getScrollPosition().x,z=w.offsetLeft;if(A>z)this.scrollTo({x:z});else{var G=this.bodyNode.clientWidth;w=w.offsetWidth;var J=z+w;A+G<J&&this.scrollTo({x:G>w?J-G:z})}},_ensureScroll:function(w,
A){this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!A&&this._ensureRowScroll(w.row.element);this.bodyNode.clientWidth<this.contentNode.offsetWidth&&this._ensureColumnScroll(w.element)},_focusOnNode:function(w,A,z){var G="_focused"+(A?"Header":"")+"Node",J=this[G],L=this.cellNavigation?"cell":"row",R=this[L](w),T;if(w=R&&R.element){if(this.cellNavigation){var aa=w.getElementsByTagName("input");var ca=0;for(T=aa.length;ca<T;ca++){var ba=aa[ca];if((-1!=ba.tabIndex||"_dgridLastValue"in
ba)&&!ba.disabled){8>l("ie")&&(ba.style.position="relative");ba.focus();8>l("ie")&&(ba.style.position="");var la=!0;break}}}null!==z&&(z=r.mixin({grid:this},z),z.type&&(z.parentType=z.type),z.bubbles||(z.bubbles=!0));J&&(k(J,"!dgrid-focus[!tabIndex]"),8>l("ie")&&(J.style.position=""),z&&(z[L]=this[L](J),n.emit(J,"dgrid-cellfocusout",z)));J=this[G]=w;z&&(z[L]=R);G=this.cellNavigation?e:h;!la&&G.test(w.className)&&(8>l("ie")&&(w.style.position="relative"),w.tabIndex=this.tabIndex,w.focus());k(w,".dgrid-focus");
z&&n.emit(J,"dgrid-cellfocusin",z);this._debouncedEnsureScroll(R,A)}},focusHeader:function(w){this._focusOnNode(w||this._focusedHeaderNode,!0)},focus:function(w){(w=w||this._focusedNode)?this._focusOnNode(w,!1):this.contentNode.focus()}}),g=c.moveFocusVertical=function(w,A){if(this._focusOnNode&&w.target!==this.contentNode){var z=this.cellNavigation,G=this[z?"cell":"row"](w);G=z&&G.column.id;A=this.down(this._focusedNode,A,!0);z&&(A=this.cell(A,G));this._focusOnNode(A,!1,w);w.preventDefault()}};H=
c.moveFocusUp=function(w){g.call(this,w,-1)};var p=c.moveFocusDown=function(w){g.call(this,w,1)},q=c.moveFocusPageUp=function(w){g.call(this,w,-this.pageSkip)},u=c.moveFocusPageDown=function(w){g.call(this,w,this.pageSkip)},v=c.moveFocusHorizontal=function(w,A){if(this.cellNavigation&&w.target!==this.contentNode){var z=!this.row(w);this._focusOnNode(this.right(this["_focused"+(z?"Header":"")+"Node"],A),z,w);w.preventDefault()}},t=c.moveFocusLeft=function(w){v.call(this,w,-1)},y=c.moveFocusRight=function(w){v.call(this,
w,1)},C=c.moveHeaderFocusEnd=function(w,A){if(this.cellNavigation){var z=this.headerNode.getElementsByTagName("th");this._focusOnNode(z[A?0:z.length-1],!0,w)}w.preventDefault()},B=c.moveHeaderFocusHome=function(w){C.call(this,w,!0)},F=c.moveFocusEnd=function(w,A){var z=this,G=this.cellNavigation,J=this.contentNode,L=J.scrollTop+(A?0:J.scrollHeight);J=J[A?"firstChild":"lastChild"];var R=-1<J.className.indexOf("dgrid-preload"),T=R?J[(A?"next":"previous")+"Sibling"]:J,aa=T.offsetTop+(A?0:T.offsetHeight);
if(R){for(;T&&0>T.className.indexOf("dgrid-row");)T=T[(A?"next":"previous")+"Sibling"];if(!T)return}if(!R||1>J.offsetHeight)G&&(T=this.cell(T,this.cell(w).column.id)),this._focusOnNode(T,!1,w);else{l("dom-addeventlistener")||(w=r.mixin({},w));var ca=m.after(this,"renderArray",function(ba){ca.remove();return a.when(ba,function(la){la=la[A?0:la.length-1];G&&(la=z.cell(la,z.cell(w).column.id));z._focusOnNode(la,!1,w)})})}L===aa&&w.preventDefault()},x=c.moveFocusHome=function(w){F.call(this,w,!0)};c.defaultKeyMap=
{32:d,33:q,34:u,35:F,36:x,37:t,38:H,39:y,40:p};c.defaultHeaderKeyMap={32:d,35:C,36:B,37:t,39:y};return c})},"dgrid/util/mouse":function(){define(["dojo/_base/lang","dojo/on","dojo/dom","dojo/query"],function(H,m,n){function r(k,b){return function(a,d){return m(a,k+":"+b,function(f){if(!n.isDescendant(f.relatedTarget,this))return d.call(this,f)})}}var l={enterRow:r(".dgrid-content .dgrid-row","mouseover"),enterCell:r(".dgrid-content .dgrid-cell","mouseover"),enterHeaderCell:r(".dgrid-header .dgrid-cell",
"mouseover"),leaveRow:r(".dgrid-content .dgrid-row","mouseout"),leaveCell:r(".dgrid-content .dgrid-cell","mouseout"),leaveHeaderCell:r(".dgrid-header .dgrid-cell","mouseout"),createDelegatingHandler:r};H.getObject("dgrid.util.mouse",!0);H.mixin(dgrid.util.mouse,l);return l})},"dgrid/util/touch":function(){define(["dojo/on","dojo/query"],function(H,m){function n(l,k,b,a){if(!(1<b.targetTouches.length)){var d=b.changedTouches[0],f=d.screenX,e=d.screenY;a&&b.preventDefault();var h=H(l,"touchend",function(c){var g=
c.changedTouches[0];c.targetTouches.length||(Math.abs(g.screenX-f)<r.tapRadius&&Math.abs(g.screenY-e)<r.tapRadius&&(a&&c.preventDefault(),k.call(this,c)),h.remove())})}}var r={tapRadius:10,dbltapTime:250,selector:function(l,k,b){return function(a,d){var f=k.bubble;f?k=f:!1!==b&&(b=!0);return H(a,k,function(e){var h=e.target;3==h.nodeType&&(h=h.parentNode);for(;!m.matches(h,l,a);)if(h==a||!b||!(h=h.parentNode))return;return d.call(h,e)})}},countCurrentTouches:function(l,k){if(!("touches"in l))return-1;
var b,a,d;for(a=b=0;d=l.touches[b];++b)k.contains(d.target)&&++a;return a},tap:function(l,k){return H(l,"touchstart",function(b){n(l,k,b)})},dbltap:function(l,k){var b,a;return H(l,"touchstart",function(d){b?n(l,function(f){if(b){var e=f.changedTouches[0];Math.abs(e.screenX-b.screenX)<r.tapRadius&&Math.abs(e.screenY-b.screenY)<r.tapRadius&&(a&&clearTimeout(a),b=a=null,k.call(this,f))}},d,!0):n(l,function(f){b=f.changedTouches[0];a=setTimeout(function(){b=a=null},r.dbltapTime)},d)})}};return r})},
"esri/dijit/_AppTemplateFiltersMixin":function(){define(["dojo/_base/declare"],function(){return{rootNodes:{app:{all:{},narrate:{typekeywords:["story"]},collect:{typekeywords:["collect"]},compare:{typekeywords:["compare"]},"3dscene":{typekeywords:["3Dscene"]},analyze:{typekeywords:["summarize"]},present:{typekeywords:["gallery"]},social:{typekeywords:["social"]},local:{typekeywords:["local"]},route:{typekeywords:["route"]},showcase:{typekeywords:["showcase"]}}}}})},"esri/dijit/_RefreshMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/has ../kernel".split(" "),
function(H,m,n,r,l,k){function b(a){"object"!==typeof a&&(a=Error(a));a.grid=this;r.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}H=H(null,{_trackError:function(a){"string"===typeof a&&(a=m.hitch(this,a));try{var d=a()}catch(f){b.call(this,f)}return n.when(d,m.hitch(this,function(){r.emit(this.domNode,"refresh",{cancelable:!0,bubbles:!0})}),m.hitch(this,b))}});l("extend-esri")&&m.setObject("dijit._RefreshMixin",H,k);return H})},"esri/dijit/analysis/PluginAnalysisLayers":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/has ../../kernel dojo/i18n!../../nls/jsapi".split(" "),
function(H,m,n,r,l,k,b){var a=H(null,{filters:{all:{},categoryBoundaries:{tags:["boundaries","places"]},subCategoryBoundaries:{tags:["boundaries"]},subCategoryPlaces:{tags:["places"]},categoryHexBins:{tags:["hex"]},categoryTransportation:{tags:["transportation"]}},constructor:function(d){m.mixin(this,d);this.i18n=m.mixin({},b.browseLayersDlg);this.filterStrings={all:{title:this.i18n.categoryAll},categoryBoundaries:{title:this.i18n.categoryBoundaries},subCategoryBoundaries:{title:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+
this.i18n.subCategoryBoundaries},subCategoryPlaces:{title:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryPlaces},categoryHexBins:{title:this.i18n.categoryHexBins},categoryTransportation:{title:this.i18n.categoryTransportation}}},fetchData:function(){this._portal=this.parent._portal;var d;return this._fetchGroups().then(m.hitch(this,function(f){d=n.map(f||[],function(e){if(e)return'group:"'+e.id+'"'});return this._fetchGroupItems(d)}))},_fetchGroup:function(d,f){this._groups=this._groups||
[];return this._groups[d]||this._portal.queryGroups(f,!0).then(m.hitch(this,function(e){0<e.total&&e.results&&(this._groups[d]=e.results);return this._groups[d]||[]}))},_fetchGroupItems:function(d,f){var e=this._isCustom?['-typekeywords:"Multilayer"']:['typekeywords:"Analysis Ready"'];this._portal&&this._portal.user&&this._portal.user.demographics||e.push('-typekeywords:"Requires Credits"');return this.parent._fetchItems({groups:d,query:f,types:['type:"Map Service"','type:"Feature Service"'],typekeywords:e})},
_fetchGroups:function(){return this._fetchEsriAnalysisLayers()},_fetchEsriAnalysisLayers:function(){if(this._portal&&this._portal.analysisLayersGroupQuery){var d=this._portal.analysisLayersGroupQuery;this._isCustomAnalysisQuery()&&(this.filterStrings=this.filters=null)}return this._fetchGroup("esriAnalysisLayers",{q:d,num:100,start:0}).then(m.hitch(this,function(f){f&&0<f.length&&(this.parent.sortAttribute=f[0].sortField,this.parent.sortDescending="asc"!==f[0].sortOrder);return f}))},_isCustomAnalysisQuery:function(){var d=
'title:"Living Atlas Analysis Layers" AND owner:esri',f=!1;this._portal&&this._portal.isPortal&&(d='title:"Living Atlas Analysis Layers" AND owner:esri_livingatlas');this._portal&&this._portal.analysisLayersGroupQuery&&this._portal.analysisLayersGroupQuery!==d&&(f=!0);return this._isCustom=f}});m.mixin(a,{add:function(d,f){d.plugIn||(f=f||{},f.parent=d,d.plugIn=new a(f))},remove:function(d){d.plugIn&&(d.plugIn.destroy(),delete d.plugIn)}});l("extend-esri")&&m.setObject("dijit.analysis.PluginAnalysisLayers",
a,k);return a})},"esri/dijit/SingleFilter":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/has dojo/json dojo/string dojo/number dojo/dom dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/_base/event dojo/Evented dojo/data/ItemFileWriteStore dojo/date/locale dojo/parser dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/TextBox dijit/form/FilteringSelect dijit/form/RadioButton dijit/form/DateTextBox dijit/form/NumberTextBox ../config ../kernel ../lang ../tasks/GenerateRendererTask ../tasks/UniqueValueDefinition ../tasks/GenerateRendererParameters ../layers/FeatureLayer ../layers/GeoRSSLayer ./analysis/ItemTypes dojo/i18n!../nls/jsapi dojo/text!./templates/SingleFilter.html".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da,Q,K){H=m([B,F,x,w,A,v],{declaredClass:"esri.dijit.SingleFilter",widgetsInTemplate:!0,templateString:K,valueHandlers:[],onFieldChangeEnabled:!0,onOperatorChangeEnabled:!0,onPromptChangeHandler:null,onHintChangeHandler:null,fieldDomains:{},fieldsStore:null,fieldsInfo:{stringFieldsCount:0,numberFieldsCount:0,dateFieldsCount:0},stringOperatorStore:null,dateOperatorStore:null,numberOperatorStore:null,uniqueValuesStore:null,
isEnableInteractiveFilter:!0,uniqueValuesResults:{},partsObj:null,dayInMS:86399E3,allowAllDateTypes:!1,showUnique:!0,postMixInProperties:function(){this.inherited(arguments);this.i18n={};this.i18n=n.mixin(this.i18n,Q.filterDlg)},parseExpressionTemplate:function(){var E=function(ka,ja){e.byId(ja).className="attributeValueContainer";"field_dropdown"===ka?e.byId(ja).innerHTML=N:"operator_dropdown"===ka?e.byId(ja).innerHTML=I:"values_input"===ka?e.byId(ja).innerHTML=O+U:console.error("problem with expressionTemplate from localization file")},
N='\x3cselect id\x3d"'+this.id+'.fieldsList" class\x3d"attributeField" data-dojo-type\x3d"dijit/form/FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"true"\x3e\x3c/select\x3e',I='\x3cselect id\x3d"'+this.id+'.operatorList" class\x3d"operator" data-dojo-type\x3d"dijit/form/FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\x3c/select\x3e',O='\x3cdiv id\x3d"'+this.id+'.attributeValueContainer"\x3e\x3c/div\x3e',U='\x3cdiv class\x3d"attributeValueOptions"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e  \x3ctbody\x3e    \x3ctr\x3e      \x3ctd nowrap\x3d"nowrap"\x3e        \x3cinput id\x3d"'+
this.id+'.radioValue" class\x3d"radioValue attributeValueRadio" checked\x3d"checked" name\x3d"'+this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+this.i18n.valueTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.valueTooltip+'"\x3e'+this.i18n.value+'        \x3c/label\x3e      \x3c/td\x3e      \x3ctd nowrap\x3d"nowrap" class\x3d"esriLeadingPadding05"\x3e        \x3cinput id\x3d"'+this.id+'.radioFields" class\x3d"radioFields attributeValueRadio" name\x3d"'+
this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+this.i18n.fieldTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.fieldTooltip+'"\x3e'+this.i18n.field+'        \x3c/label\x3e      \x3c/td\x3e      \x3ctd id\x3d"'+this.id+'.radioUniqueColumn" nowrap\x3d"nowrap" class\x3d"esriLeadingPadding05"\x3e        \x3cinput id\x3d"'+this.id+'.radioUnique" class\x3d"radioUnique attributeValueRadio" name\x3d"'+this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+
this.i18n.uniqueValueTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.uniqueValueTooltip+'"\x3e'+this.i18n.uniqueValues+"        \x3c/label\x3e      \x3c/td\x3e    \x3c/tr\x3e  \x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",ha=this.i18n.expressionTemplate,ia=ha.indexOf("${"),S=ha.substring(0,ia).trim();e.byId(this.id+".column1").innerHTML=S.length?"\x3cdiv class\x3d'attributeText'\x3e"+S+"\x3c/div\x3e":"";S=ha.indexOf("}",ia+1);var W=ha.substring(ia+2,S);E(W,this.id+".column2");
ia=ha.indexOf("${",ia+1);S=ha.substring(S+1,ia).trim();e.byId(this.id+".column3").innerHTML=S.length?"\x3cdiv class\x3d'attributeText'\x3e"+S+"\x3c/div\x3e":"";S=ha.indexOf("}",ia+1);W=ha.substring(ia+2,S);E(W,this.id+".column4");ia=ha.indexOf("${",ia+1);S=ha.substring(S+1,ia).trim();e.byId(this.id+".column5").innerHTML=S.length?"\x3cdiv class\x3d'attributeText'\x3e"+S+"\x3c/div\x3e":"";S=ha.indexOf("}",ia+1);W=ha.substring(ia+2,S);E(W,this.id+".column6");S=ha.substring(S+1,ha.length).trim();e.byId(this.id+
".column7").innerHTML=S.length?"\x3cdiv class\x3d'attributeText'\x3e"+S+"\x3c/div\x3e":""},postCreate:function(){this.inherited(arguments);this.parseExpressionTemplate();this.createOperatorStores();this.createFieldsStore(this.fields);this.readCodedValues();C.parse(e.byId(this.id+".exprTable")).then(n.hitch(this,function(E){l.connect(this.getFieldsList(),"onChange",this,"onChangeField");l.connect(this.getOperatorList(),"onChange",this,"onChangeOperator");l.connect(z.byId(this.id+".radioValue"),"onClick",
this,"showValueInput");l.connect(z.byId(this.id+".radioFields"),"onClick",this,"showFields");l.connect(z.byId(this.id+".radioUnique"),"onClick",this,"showUniqueList");this.version&&10.1>this.version&&this.mapLayer.url&&this.showUnique&&h.set(e.byId(this.id+".radioUniqueColumn"),"display","none");l.connect(e.byId(this.id+".deleteExpression"),"onclick",this,"onClickDeleteExpression");l.connect(this.interactiveCheck,"onclick",this,"onInteractiveClick");l.connect(this.interactiveArrow,"onclick",this,
"onClickShowHideInteractive");this.enableInteractiveHandlers();this.isEnableInteractiveFilter||h.set(this._interactiveFilterRow,"display","none");h.set(e.byId(this.id+".radioUniqueColumn"),"display",this.showUnique?"block":"none");this.own(this.watch("showUnique",n.hitch(this,function(N,I,O){h.set(e.byId(this.id+".radioUniqueColumn"),"display",O?"block":"none")})))}))},constructor:function(E,N){this.id=E.id||"";this.owner=E.owner;this.version=E.version;this.part=E.part;this.fields=E.fields;this.mapLayer=
E.mapLayer;!1===E.enableEvents&&(this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!1)},init:function(E){if(!E.part||this.mapLayer&&E.mapLayer&&this.mapLayer.id!==E.mapLayer.id)this.clearAttributeValueDijits(),this.mapLayer=E.mapLayer,this.version=E.version,this.fields=E.fields,this.createOperatorStores(),this.createFieldsStore(this.fields),this.readCodedValues(),this.fillFieldsList(this.fieldsStore),this.onChangeField();E.part&&(this.part=E.part,this.onOperatorChangeEnabled=this.onFieldChangeEnabled=
!1,this.buildEditUIField(this.part,this))},destroy:function(){this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!1;this.clearAttributeValueDijits();r.forEach(z.findWidgets(e.byId(this.id)),function(E){E.destroyRecursive()});this.inherited(arguments)},toJson:function(){var E=null;this.isInteractiveChecked()&&(E={prompt:this.promptText.attr("value"),hint:this.hintText.attr("value")});return{fieldObj:this.getField(),operator:this.getOperator(),valueObj:this.getValue(),interactiveObj:E}},buildFriendlyTextExpr:function(E){var N=
this.i18n.expressionTemplate,I=function(ha,ia,S){return d.substitute(N,{field_dropdown:ha,operator_dropdown:ia,values_input:S})};if(!1===E.valueObj.isValid)return"\x26lt;expression is missing value\x26gt;";var O="";if("string"===E.fieldObj.shortType)E.operator===this.i18n.stringOperatorIsBlank||E.operator===this.i18n.stringOperatorIsNotBlank?O=I(E.fieldObj.label,E.operator,""):"field"===E.valueObj.type?O=I(E.fieldObj.label,E.operator,E.valueObj.label):(O=this.getDecodedValue(E.interactiveObj?E.interactiveObj.value:
E.valueObj.value,E.fieldObj.name),O=I(E.fieldObj.label,E.operator,"'"+O+"'"));else if("number"===E.fieldObj.shortType)if(E.operator===this.i18n.numberOperatorIsBetween||E.operator===this.i18n.numberOperatorIsNotBetween)O=E.interactiveObj?E.interactiveObj.value2:E.valueObj.value2,O=I(E.fieldObj.label,E.operator,f.format(E.interactiveObj?E.interactiveObj.value1:E.valueObj.value1,{pattern:"#####0.##########"})+" "+this.i18n.andBetweenValues+" "+f.format(O,{pattern:"#####0.##########"}));else if(E.operator===
this.i18n.numberOperatorIsBlank||E.operator===this.i18n.numberOperatorIsNotBlank)O=I(E.fieldObj.label,E.operator,"");else if("field"===E.valueObj.type)O=I(E.fieldObj.label,E.operator,E.valueObj.label);else{O=E.interactiveObj?E.interactiveObj.value:E.valueObj.value;var U=this.getDecodedValue(O,E.fieldObj.name);O=I(E.fieldObj.label,E.operator,O!==U?"'"+U+"'":f.format(O,{pattern:"#####0.##########"}))}else ba.isDefined(E.valueObj.value)&&"field"!==E.valueObj.type&&"string"===typeof E.valueObj.value&&
(E.valueObj.value=new Date(E.valueObj.value)),O=E.operator===this.i18n.dateOperatorIsBetween||E.operator===this.i18n.dateOperatorIsNotBetween?I(E.fieldObj.label,E.operator,(E.interactiveObj?this.formatFriendlyDate(E.interactiveObj.value1):this.formatFriendlyDate(E.valueObj.value1))+" "+this.i18n.andBetweenValues+" "+(E.interactiveObj?this.formatFriendlyDate(E.interactiveObj.value2):this.formatFriendlyDate(this.addDay(E.valueObj.value2)))):E.operator===this.i18n.dateOperatorIsBlank||E.operator===this.i18n.dateOperatorIsNotBlank?
I(E.fieldObj.label,E.operator,""):"field"===E.valueObj.type?I(E.fieldObj.label,E.operator,E.valueObj.label):I(E.fieldObj.label,E.operator,E.interactiveObj?this.formatFriendlyDate(E.interactiveObj.value):this.formatFriendlyDate(E.valueObj.value));return O},builtSingleFilterString:function(E,N){if(ba.isDefined(E.valueObj.isValid)&&!E.valueObj.isValid)return{whereClause:null};var I=E.valueObj.value,O=E.valueObj.value1,U=E.valueObj.value2,ha=!1;if(E.interactiveObj){if(!E.interactiveObj.prompt||!E.interactiveObj.hint)return{whereClause:null};
ba.isDefined(N)&&(ha=!0,ba.isDefined(E.valueObj.value)&&(I="{"+N+"}"),ba.isDefined(E.valueObj.value1)&&(O="{"+N+"}"),ba.isDefined(E.valueObj.value2)&&(U="{"+(N+1)+"}"))}var ia="",S=E.fieldObj.name;this.mapLayer&&this.mapLayer.url&&-1!==this.mapLayer.url.indexOf("BigDataCatalogServer")&&this.hasWhiteSpace(S)&&(S='"'+S+'"');if("string"===E.fieldObj.shortType)switch(N="",I&&"field"!==E.valueObj.type&&this.isHostedService(this.mapLayer.url)&&this.containsNonLatinCharacter(I)&&(N="N"),E.operator){case this.i18n.stringOperatorIs:ia=
"field"===E.valueObj.type?S+" \x3d "+I:S+" \x3d "+N+"'"+I.replace(/'/g,"''")+"'";break;case this.i18n.stringOperatorIsNot:ia="field"===E.valueObj.type?S+" \x3c\x3e "+I:S+" \x3c\x3e "+N+"'"+I.replace(/'/g,"''")+"'";break;case this.i18n.stringOperatorStartsWith:ia=S+" LIKE "+N+"'"+I.replace(/'/g,"''")+"%'";break;case this.i18n.stringOperatorEndsWith:ia=S+" LIKE "+N+"'%"+I.replace(/'/g,"''")+"'";break;case this.i18n.stringOperatorContains:ia=S+" LIKE "+N+"'%"+I.replace(/'/g,"''")+"%'";break;case this.i18n.stringOperatorDoesNotContain:ia=
S+" NOT LIKE "+N+"'%"+I.replace(/'/g,"''")+"%'";break;case this.i18n.stringOperatorIsBlank:ia=S+" IS NULL";break;case this.i18n.stringOperatorIsNotBlank:ia=S+" IS NOT NULL"}else if("number"===E.fieldObj.shortType)switch(E.operator){case this.i18n.numberOperatorIs:ia=S+" \x3d "+I;break;case this.i18n.numberOperatorIsNot:ia=S+" \x3c\x3e "+I;break;case this.i18n.numberOperatorIsAtLeast:ia=S+" \x3e\x3d "+I;break;case this.i18n.numberOperatorIsLessThan:ia=S+" \x3c "+I;break;case this.i18n.numberOperatorIsAtMost:ia=
S+" \x3c\x3d "+I;break;case this.i18n.numberOperatorIsGreaterThan:ia=S+" \x3e "+I;break;case this.i18n.numberOperatorIsBetween:ia=S+" BETWEEN "+O+" AND "+U;break;case this.i18n.numberOperatorIsNotBetween:ia=S+" NOT BETWEEN "+O+" AND "+U;break;case this.i18n.numberOperatorIsBlank:ia=S+" IS NULL";break;case this.i18n.numberOperatorIsNotBlank:ia=S+" IS NOT NULL"}else switch(ba.isDefined(I)&&"field"!==E.valueObj.type&&"string"===typeof I&&(I=this.parseFriendlyDate(I)),E.operator){case this.i18n.dateOperatorIsOn:ia=
"field"===E.valueObj.type?S+" \x3d "+I:ha?S+" BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+N+"}' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+(N+1)+"}'":S+" BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(I)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(I))+"'";break;case this.i18n.dateOperatorIsNotOn:ia="field"===E.valueObj.type?S+" \x3c\x3e "+I:ha?S+" NOT BETWEEN "+(this.supportsStandardizedQuery?
"timestamp ":"")+"'{"+N+"}' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+(N+1)+"}'":S+" NOT BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(I)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(I))+"'";break;case this.i18n.dateOperatorIsBefore:ia="field"===E.valueObj.type?S+" \x3c "+I:S+" \x3c "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(I)+"'";break;case this.i18n.dateOperatorIsAfter:ia=
"field"===E.valueObj.type?S+" \x3e "+I:S+" \x3e "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(I))+"'";break;case this.i18n.dateOperatorIsBetween:ia=ha?S+" BETWEEN '"+O+"' AND '"+U+"'":S+" BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(O)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(U))+"'";break;case this.i18n.dateOperatorIsNotBetween:ia=ha?S+" NOT BETWEEN '"+O+"' AND '"+U+"'":S+" NOT BETWEEN "+
(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(O)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(U))+"'";break;case this.i18n.dateOperatorIsBlank:ia=S+" IS NULL";break;case this.i18n.dateOperatorIsNotBlank:ia=S+" IS NOT NULL"}return{whereClause:ia}},showDeleteIcon:function(){h.set(e.byId(this.id+".deleteExpression"),"display","block")},hideDeleteIcon:function(){h.set(e.byId(this.id+".deleteExpression"),"display","none")},createFieldsStore:function(E){if(E&&
E.length){E=n.clone(E);E=E.sort(function(I,O){I.label=I.alias||I.name;O.label=O.alias||O.name;return I.label<O.label?-1:I.label>O.label?1:0});var N=this.isHostedService(this.mapLayer.url);this.supportsStandardizedQuery=10.2<=this.mapLayer.version&&(this.mapLayer.useStandardizedQueries||this.isBigDataLayer(this.mapLayer));E=r.filter(E,function(I,O){return"esriFieldTypeString"===I.type||"esriFieldTypeDouble"===I.type||"esriFieldTypeSingle"===I.type||"esriFieldTypeInteger"===I.type||"esriFieldTypeSmallInteger"===
I.type||"esriFieldTypeDate"===I.type&&(this.allowAllDateTypes||N||this.supportsStandardizedQuery)?!0:!1},this);E=r.map(E,function(I,O){switch(I.type){case "esriFieldTypeString":var U="string";this.fieldsInfo.stringFieldsCount++;break;case "esriFieldTypeDate":U="date";this.fieldsInfo.dateFieldsCount++;break;default:U="number",this.fieldsInfo.numberFieldsCount++}return{id:O,label:I.label,shortType:U,alias:I.alias,editable:I.editable,name:I.name,nullable:I.nullable,type:I.type}},this);E.length&&(this.fieldsStore=
new t({data:{identifier:"id",label:"label",items:E}}))}},createOperatorStores:function(){var E=[];E.push({name:this.i18n.stringOperatorIs,name_:this.i18n.stringOperatorIs,id:0});E.push({name:this.i18n.stringOperatorIsNot,name_:this.i18n.stringOperatorIsNot,id:1});E.push({name:this.i18n.stringOperatorStartsWith,name_:this.i18n.stringOperatorStartsWith,id:2});E.push({name:this.i18n.stringOperatorEndsWith,name_:this.i18n.stringOperatorEndsWith,id:3});E.push({name:this.i18n.stringOperatorContains,name_:this.i18n.stringOperatorContains,
id:4});E.push({name:this.i18n.stringOperatorDoesNotContain,name_:this.i18n.stringOperatorDoesNotContain,id:5});E.push({name:this.i18n.stringOperatorIsBlank,name_:this.i18n.stringOperatorIsBlank,id:6});E.push({name:this.i18n.stringOperatorIsNotBlank,name_:this.i18n.stringOperatorIsNotBlank,id:7});this.stringOperatorStore=new t({data:{label:"name",identifier:"id",items:E}});E=[];E.push({name:this.i18n.dateOperatorIsOn,id:0});E.push({name:this.i18n.dateOperatorIsNotOn,id:1});E.push({name:this.i18n.dateOperatorIsBefore,
id:2});E.push({name:this.i18n.dateOperatorIsAfter,id:3});E.push({name:this.i18n.dateOperatorIsBetween,id:6});E.push({name:this.i18n.dateOperatorIsNotBetween,id:7});E.push({name:this.i18n.dateOperatorIsBlank,id:8});E.push({name:this.i18n.dateOperatorIsNotBlank,id:9});this.dateOperatorStore=new t({data:{label:"name",identifier:"id",items:E}});E=[];E.push({name:this.i18n.numberOperatorIs,name_:this.i18n.numberOperatorIs,id:0});E.push({name:this.i18n.numberOperatorIsNot,name_:this.i18n.numberOperatorIsNot,
id:1});E.push({name:this.i18n.numberOperatorIsAtLeast,name_:this.i18n.numberOperatorIsAtLeast,id:2});E.push({name:this.i18n.numberOperatorIsLessThan,name_:this.i18n.numberOperatorIsLessThan,id:3});E.push({name:this.i18n.numberOperatorIsAtMost,name_:this.i18n.numberOperatorIsAtMost,id:4});E.push({name:this.i18n.numberOperatorIsGreaterThan,name_:this.i18n.numberOperatorIsGreaterThan,id:5});E.push({name:this.i18n.numberOperatorIsBetween,name_:this.i18n.numberOperatorIsBetween,id:6});E.push({name:this.i18n.numberOperatorIsNotBetween,
name_:this.i18n.numberOperatorIsNotBetween,id:7});E.push({name:this.i18n.numberOperatorIsBlank,name_:this.i18n.numberOperatorIsBlank,id:8});E.push({name:this.i18n.numberOperatorIsNotBlank,name_:this.i18n.numberOperatorIsNotBlank,id:9});this.numberOperatorStore=new t({data:{label:"name",identifier:"id",items:E}})},readCodedValues:function(){r.forEach(this.mapLayer.fields,function(E){E.domain&&E.domain.codedValues&&(this.fieldDomains[E.name]=E.domain.codedValues)},this)},getDecodedValue:function(E,
N){N=this.getCodedValues(N);var I;if(N)for(I=0;I<N.length;I+=1){var O=N[I];if(O.code===E)return O.name}return E},getCodedValues:function(E){return this.fieldDomains[E]},getFieldsList:function(){return z.byId(this.id+".fieldsList")},getOperatorList:function(){return z.byId(this.id+".operatorList")},getValueFieldsList:function(){return z.byId(this.id+".valueFields")},getAttrValContNode:function(){return e.byId(this.id+".attributeValueContainer")},getField:function(){var E=this.getFieldsList();return{name:E.store.getValue(E.item,
"name"),label:E.store.getValue(E.item,"label"),shortType:E.store.getValue(E.item,"shortType"),type:E.store.getValue(E.item,"type")}},getOperator:function(){var E=this.getOperatorList();return E.item?E.store.getValue(E.item,"name"):""},getValue:function(){return{}},isInteractiveChecked:function(){return this.interactiveCheck.checked},setInteractiveSection:function(E,N,I){this.disableInteractiveHandlers();this.interactiveCheck.checked=E;this.promptText.attr("value",N);this.hintText.attr("value",I);
h.set(this.interactiveSpace,"display","block");this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;";this.enableInteractiveHandlers()},enableInteractiveHandlers:function(){this.onPromptChangeHandler=l.connect(this.promptText,"onChange",this,"onChangeInteractive");this.onHintchangeHandler=l.connect(this.hintText,"onChange",this,"onChangeInteractive")},disableInteractiveHandlers:function(){l.disconnect(this.onPromptChangeHandler);l.disconnect(this.onHintChangeHandler)},fillFieldsList:function(E){var N=
this.getFieldsList();N.set("labelAttr","label");N.set("searchAttr","label");N.set("store",E);N.set("value",0)},fillOperatorList:function(E,N,I){var O=this.getOperatorList();O.set("labelAttr","name");O.set("searchAttr","name");O.set("query",I?I:{});O.set("store",E);if(N){var U=!1;for(I=0;20>I&&(E.fetchItemByIdentity({identity:I,onItem:n.hitch(this,function(ha){ha&&ha.name[0]===N&&(O.set("value",ha.id[0]),U=!0)})}),!U);I++);}else O.set("value",0)},createValueString:function(E){var N=this.getAttrValContNode();
this.clearAttributeValueDijits();g.empty(N);if(E){N=new J({id:this.id+".value","class":"attributeValue",maxHeight:150,sortByLabel:!0},g.create("div",{},N));var I=this.buildCodedValuesStore(E);N.set("store",I);N.set("value",0);this.valueHandlers.push(l.connect(N,"onChange",this,"onValueChange"))}else N=new G({id:this.id+".value","class":"attributeValue",required:!0,placeHolder:"",intermediateChanges:!0},g.create("div",{},N)),this.valueHandlers.push(l.connect(N,"onChange",this,"onValueChange"));this.checkDefaultOption();
this.getValue=function(){var O=z.byId(this.id+".value"),U=!0;E?O.item?O=O.item.code[0]:(O="",U=!1):U=O=O.get("value");return{value:O,isValid:U}}},createValueDate:function(){var E=this.getAttrValContNode();this.clearAttributeValueDijits();g.empty(E);E=new R({id:this.id+".value","class":"attributeValue",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},g.create("div",{},E));this.checkDefaultOption();this.valueHandlers.push(l.connect(E,"onChange",this,"onValueChange"));this.getValue=
function(){var N=z.byId(this.id+".value").get("value");return{value:N,isValid:ba.isDefined(N)}}},createValueNumber:function(E){var N=this.getAttrValContNode();this.clearAttributeValueDijits();g.empty(N);if(E){N=new J({id:this.id+".value","class":"attributeValue",maxHeight:150,sortByLabel:!0},g.create("div",{},N));var I=this.buildCodedValuesStore(E);N.set("store",I);N.set("value",0);this.valueHandlers.push(l.connect(N,"onChange",this,"onValueChange"))}else N=new T({id:this.id+".value","class":"attributeValue",
required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},g.create("div",{},N)),this.valueHandlers.push(l.connect(N,"onChange",this,"onValueChange"));this.checkDefaultOption();this.getValue=function(){var O=z.byId(this.id+".value"),U=!0;E?O.item?O=O.item.code[0]:(O="",U=!1):(O=O.get("value"),U=ba.isDefined(O)&&!isNaN(O));return{value:O,isValid:U}}},createValueBetweenDate:function(){var E=this.getAttrValContNode();this.clearAttributeValueDijits();g.empty(E);var N=
new R({id:this.id+".value1","class":"attributeValue1",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},g.create("div",{},E));g.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},E);E=new R({id:this.id+".value2","class":"attributeValue2",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},g.create("div",{},E));this.checkDefaultOption();this.valueHandlers.push(l.connect(N,"onChange",this,"onValueChange"));this.valueHandlers.push(l.connect(E,
"onChange",this,"onValueChange"));this.getValue=function(){var I=z.byId(this.id+".value1").get("value"),O=z.byId(this.id+".value2").get("value");return{value1:I,value2:O,isValid:ba.isDefined(I)&&ba.isDefined(O)}}},createValueBetweenNumber:function(){var E=this.getAttrValContNode();this.clearAttributeValueDijits();g.empty(E);var N=new T({id:this.id+".value1","class":"attributeValue1",required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},g.create("div",{},E));
g.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},E);E=new T({id:this.id+".value2","class":"attributeValue2",required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},g.create("div",{},E));this.checkDefaultOption();this.valueHandlers.push(l.connect(N,"onChange",this,"onValueChange"));this.valueHandlers.push(l.connect(E,"onChange",this,"onValueChange"));this.getValue=function(){var I=z.byId(this.id+".value1").get("value"),O=z.byId(this.id+
".value2").get("value");return{value1:I,value2:O,isValid:ba.isDefined(I)&&ba.isDefined(O)&&!isNaN(I)&&!isNaN(O)&&I<=O}}},createValueInTheLastDate:function(){},createValueIsBlank:function(){var E=this.getAttrValContNode();this.clearAttributeValueDijits();g.empty(E);E.innerHTML="\x3cinput id\x3d'"+this.id+".value' class\x3d'attributeValue' type\x3d'text' disabled\x3d'true'/\x3e";this.checkDefaultOption();this.getValue=function(){return{value:null,isValid:!0}}},createValueFields:function(E,N,I){var O=
this.getAttrValContNode();this.clearAttributeValueDijits();g.empty(O);var U=new J({id:this.id+".valueFields","class":"attributeValue",maxHeight:150,labelAttr:"label",searchAttr:"label",store:E,query:N},g.create("div",{},O));if(I){var ha=!1;for(O=0;100>O&&(E.fetchItemByIdentity({identity:O,onItem:n.hitch(this,function(ia){ia&&ia.shortType[0]===N.shortType&&ia.name[0]!==I&&(U.set("value",ia.id),ha=!0)})}),!ha);O++);}this.valueHandlers.push(l.connect(U,"onChange",this,"onValueChange"));this.getValue=
function(){var ia=z.byId(this.id+".valueFields");return{value:ia.store.getValue(ia.item,"name"),label:ia.store.getValue(ia.item,"label"),type:"field",isValid:!0}}},createValueUnique:function(E){var N=this.getAttrValContNode();this.clearAttributeValueDijits();g.empty(N);E=new J({id:this.id+".valueUnique","class":"attributeValue",maxHeight:150,store:E},g.create("div",{},N));E.set("value",0);this.valueHandlers.push(l.connect(E,"onChange",this,"onValueChange"));this.getValue=function(){var I=z.byId(this.id+
".valueUnique");return{value:I.store.getValue(I.item,"value"),isValid:!0}}},setValue:function(E,N){if(N)for(var I=0;I<N.length;I++){if(E===N[I].code){z.byId(this.id+".value").set("value",I);break}}else"date"===this.part.fieldObj.shortType?z.byId(this.id+".value").set("value",new Date(E)):("number"===this.part.fieldObj.shortType&&(E=Number(E)),z.byId(this.id+".value").set("value",E))},setValue1:function(E){"date"===this.part.fieldObj.shortType?E=new Date(E):"number"===this.part.fieldObj.shortType&&
(E=Number(E));z.byId(this.id+".value1").set("value",E)},setValue2:function(E){"date"===this.part.fieldObj.shortType?E=new Date(E):"number"===this.part.fieldObj.shortType&&(E=Number(E));z.byId(this.id+".value2").set("value",E)},setValueFieldById:function(E){this.getValueFieldsList().set("value",E)},enableOnFieldChange:function(){this.onFieldChangeEnabled=!0},enableOnOperatorChange:function(){this.onOperatorChangeEnabled=!0},onChangeField:function(E){this.onFieldChangeEnabled&&this._onChangeField(this.getFieldsList(),
this)},onChangeOperator:function(E){this.onOperatorChangeEnabled&&this._onChangeOperator(this.getOperatorList(),this)},onClickDeleteExpression:function(E){this._deleteExpression(this)},_onChangeField:function(E,N,I){var O=!!this.mapLayer&&this.isPortalHostedService(this.mapLayer.url);this.isBigDataLayer(this.mapLayer)||O&&"esriFieldTypeDate"===this.fieldsStore.getValue(E.item,"type")?h.set(e.byId(this.id+".radioUniqueColumn"),"display","none"):h.set(e.byId(this.id+".radioUniqueColumn"),"display",
"");O=N.getOperatorList();switch(this.fieldsStore.getValue(E.item,"type")){case "esriFieldTypeString":var U=null;E=this.fieldsStore.getValue(E.item,"name");this.getCodedValues(E)&&(U=this.i18n.stringOperatorStartsWith,U+="|"+this.i18n.stringOperatorEndsWith,U+="|"+this.i18n.stringOperatorContains,U+="|"+this.i18n.stringOperatorDoesNotContain,U={name_:new RegExp("^(?!("+U+")$)")});O.attr("value")===this.i18n.stringOperatorIs?(N.fillOperatorList(this.stringOperatorStore,this.i18n.stringOperatorIs,U),
this.onChangeOperator(O,N,I)):N.fillOperatorList(this.stringOperatorStore,this.i18n.stringOperatorIs,U);N.createValueString(this.getCodedValues(E));break;case "esriFieldTypeDate":N.fillOperatorList(this.dateOperatorStore,this.i18n.dateOperatorIsOn);N.createValueDate();break;default:U=null,E=this.fieldsStore.getValue(E.item,"name"),this.getCodedValues(E)&&(U=this.i18n.numberOperatorIsBetween,U+="|"+this.i18n.numberOperatorIsNotBetween,U+="|"+this.i18n.numberOperatorIsAtLeast,U+="|"+this.i18n.numberOperatorIsLessThan,
U+="|"+this.i18n.numberOperatorIsAtMost,U+="|"+this.i18n.numberOperatorIsGreaterThan,U={name_:new RegExp("^(?!("+U+")$)")}),O.attr("value")===this.i18n.numberOperatorIs?(N.fillOperatorList(this.numberOperatorStore,this.i18n.numberOperatorIs,U),this.onChangeOperator(O,N,I)):N.fillOperatorList(this.numberOperatorStore,this.i18n.numberOperatorIs,U),N.createValueNumber(this.getCodedValues(E))}"date"===this.fieldsStore.getValue(N.getFieldsList().item,"shortType")?N.disableInteractiveCheck():N.enableInteractiveCheck();
l.publish("filter-expression-change",this)},_onChangeOperator:function(E,N,I){E=E.item?E.item.name[0]:E.value;I=this.fieldsStore.getValue(N.getFieldsList().item,"shortType");var O=this.fieldsStore.getValue(N.getFieldsList().item,"name");N.enableOptions();if("date"!==I&&"number"!==I||E!==this.i18n.dateOperatorIsBetween&&E!==this.i18n.numberOperatorIsBetween&&E!==this.i18n.dateOperatorIsNotBetween&&E!==this.i18n.numberOperatorIsNotBetween)if("date"!==I||E!==this.i18n.dateOperatorInTheLast&&E!==this.i18n.dateOperatorNotInTheLast)if(E===
this.i18n.stringOperatorIsBlank||E===this.i18n.dateOperatorIsBlank||E===this.i18n.numberOperatorIsBlank||E===this.i18n.stringOperatorIsNotBlank||E===this.i18n.dateOperatorIsNotBlank||E===this.i18n.numberOperatorIsNotBlank)N.createValueIsBlank(),N.disableOptions();else switch(I){case "string":N.createValueString(this.getCodedValues(O));break;case "date":N.createValueDate();break;default:N.createValueNumber(this.getCodedValues(O))}else N.disableOptions(),N.createValueInTheLastDate();else N.disableOptions(),
"date"===I?N.createValueBetweenDate():N.createValueBetweenNumber();l.publish("filter-expression-change",this)},onInteractiveClick:function(E){this.isInteractiveChecked()?(h.set(this.interactiveSpace,"display","block"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;"):(h.set(this.interactiveSpace,"display","none"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9660;");l.publish("filter-expression-change",this)},onClickShowHideInteractive:function(E){this.interactiveCheck.disabled||("none"===h.set(this.interactiveSpace,
"display")?(h.set(this.interactiveSpace,"display","block"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;"):(h.set(this.interactiveSpace,"display","none"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9660;"))},onChangeInteractive:function(){l.publish("filter-expression-change",this)},showValueInput:function(E){this._showValueInput(z.byNode(E.target),this)},showFields:function(E){this._showFields(z.byNode(E.target),this)},showUniqueList:function(E){this._showUniqueList(z.byNode(E.target),this)},
onValueChange:function(){this.onValueChangeHandler&&clearTimeout(this.onValueChangeHandler);this.onValueChangeHandler=setTimeout(n.hitch(this,function(){this.onValueChangeHandler=null;l.publish("filter-expression-change",this)}),800)},_showValueInput:function(E,N,I){N.onChangeOperator(E,N,I);N.enableInteractiveCheck()},_showFields:function(E,N,I){I=N.getFieldsList().item;E=this.fieldsStore.getValue(I,"shortType");I=this.fieldsStore.getValue(I,"name");N.createValueFields(this.fieldsStore,{shortType:E,
name:new RegExp("^(?!"+I+"$)")},I);N.disableInteractiveCheck()},_showUniqueList:function(E,N,I){this.uniqueValuesStore&&delete this.uniqueValuesStore;I=this.fieldsStore.getValue(N.getFieldsList().item,"name");if(10.1<=this.version||!this.mapLayer.url){var O=null;this.mapLayer.queryServiceUrl?O=this.mapLayer.queryServiceUrl:this.mapLayer.itemLayers&&r.forEach(this.mapLayer.itemLayers,function(U){U.id===this.layerInfo.id&&U.layerUrl&&(O=U.layerUrl)},this);O||(O=this.mapLayer.url);if(this.uniqueValuesResults[this.mapLayer.id+
"_"+I])this.onGenerateRendererResults(N,E,this.uniqueValuesResults[this.mapLayer.id+"_"+I]);else this.generateRendererUniqueValues(I,O,n.hitch(this,"onGenerateRendererResults",N,E),n.hitch(this,function(){this.showValueInput(E,N)}))}else E&&this.showValueInput(E,N)},onGenerateRendererResults:function(E,N,I){var O=this.fieldsStore.getValue(E.getFieldsList().item,"name"),U=this.fieldsStore.getValue(E.getFieldsList().item,"shortType"),ha=this.fieldsStore.getValue(E.getFieldsList().item,"type");this.uniqueValuesResults[this.mapLayer.id+
"_"+O]=I;var ia=null;r.forEach(this.mapLayer.fields,function(S){S.name===O&&S.domain&&(ia=S.domain)});I=r.filter(I,function(S,W){return"string"===U?"\x3cNull\x3e"!==S&&""!==S.trim():"\x3cNull\x3e"!==S&&""!==S});I.length?("date"===U?(I=r.map(I,function(S){return new Date(S)}),I=I.sort(function(S,W){S=S.getTime();W=W.getTime();return S<W?-1:S>W?1:0}),I=r.map(I,function(S){return this.formatFriendlyDate(S)},this)):"number"===U?(I=r.map(I,function(S){return"esriFieldTypeDouble"===ha||"esriFieldTypeSingle"===
ha?parseFloat(S):parseInt(S,10)}),I=I.sort(function(S,W){return S<W?-1:S>W?1:0})):I=I.sort(function(S,W){return S<W?-1:S>W?1:0}),N=r.map(I,function(S,W){var ka=S;"string"===U&&(ka=""===S?"\x3c"+this.i18n.emptyString+"\x3e":S);if(ia&&ia.codedValues){for(var ja=0;ja<ia.codedValues.length;ja++){var ma=ia.codedValues[ja];if(S===ma.code)return{id:W,name:ma.name||ka,value:S}}return{id:W,name:""+ka,value:S}}if("esriFieldTypeDouble"===ha||"esriFieldTypeSingle"===ha)ka=f.format(S,{pattern:"#####0.##########"});
return{id:W,name:""+ka,value:S}},this),this.uniqueValuesStore=new t({data:{label:"name",identifier:"id",items:N}}),E.createValueUnique(this.uniqueValuesStore)):this.showValueInput(N,E)},generateRendererUniqueValues:function(E,N,I,O){E instanceof Array&&(E=E.toString());var U=new oa;U.attributeField=E;E=new fa;E.classificationDefinition=U;this.mapLayer instanceof X?N=new la(this.mapLayer):this.mapLayer instanceof M&&!this.mapLayer.url?N=new la(this.mapLayer):this.hasDynamicLayers(this.mapLayer)?(U=
this.mapLayer.layerDefinitions&&this.mapLayer.layerDefinitions[this.mapLayer.id]?this.mapLayer.layerDefinitions[this.mapLayer.id]:null,E.where=U?U:null,N=new la(this.mapLayer.url+"/dynamicLayer",{source:this.layerInfo.source})):(U=this.mapLayer.getDefinitionExpression(),E.where=U?U:null,N=new la(N));aa.defaults.io.timeout=1E4;N.execute(E,function(ha){aa.defaults.io.timeout=6E4;ha=r.map(ha.infos,function(ia){return ia.value});I(ha)},n.hitch(this,function(ha){aa.defaults.io.timeout=6E4;O()}))},hasDynamicLayers:function(E){return E&&
E.supportsDynamicLayers?!0:!1},formatDate:function(E){return y.format(E,{datePattern:"yyyy-MM-dd",selector:"date"})+" "+y.format(E,{selector:"time",timePattern:"HH:mm:ss"})},formatFriendlyDate:function(E){return y.format(E,{formatLength:"short",selector:"date"})},parseFriendlyDate:function(E){return y.parse(E,{formatLength:"short",selector:"date"})},parseDate:function(E){var N=y.parse(E,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});N||(N=y.parse(E.replace(" ",", "),{datePattern:"yyyy-MM-dd",
timePattern:"HH:mm:ss"}))||(N=y.parse(E.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return N},addDay:function(E){return new Date(E.getTime()+this.dayInMS)},subtractDay:function(E){return new Date(E.getTime()-this.dayInMS)},containsNonLatinCharacter:function(E){for(var N=0;N<E.length;N++)if(255<E.charCodeAt(N))return!0;return!1},hasWhiteSpace:function(E){return/\s/g.test(E)},buildCodedValuesStore:function(E){E=r.map(E,function(N,I){return{name:N.name,code:N.code,id:I}});
return new t({data:{label:"name",identifier:"id",items:E}})},clearAttributeValueDijits:function(){this.valueHandlers&&0!==this.valueHandlers.length&&(r.forEach(this.valueHandlers,n.hitch(this,function(E){l.disconnect(E);E=null})),this.valueHandlers=[],z.byId(this.id+".value")?z.byId(this.id+".value").destroy():e.byId(this.id+".value")&&this.getAttrValContNode().removeChild(e.byId(this.id+".value")),z.byId(this.id+".value1")?z.byId(this.id+".value1").destroy():e.byId(this.id+".value1")&&this.getAttrValContNode().removeChild(e.byId(this.id+
".value1")),z.byId(this.id+".value2")?z.byId(this.id+".value2").destroy():e.byId(this.id+".value2")&&this.getAttrValContNode().removeChild(e.byId(this.id+".value2")),z.byId(this.id+".valueFields")&&z.byId(this.id+".valueFields").destroy(),z.byId(this.id+".valueUnique")&&z.byId(this.id+".valueUnique").destroy())},checkDefaultOption:function(){p(".attributeValueOptions .attributeValueRadio",this.domNode).forEach(function(E){z.byNode(E).set("checked",-1<E.className.indexOf("radioValue"))})},disableOptions:function(){p(".attributeValueOptions .attributeValueRadio",
this.domNode).forEach(function(E){z.byNode(E).set("disabled",!0)})},enableOptions:function(){p(".attributeValueOptions .attributeValueRadio",this.domNode).forEach(function(E){z.byNode(E).set("disabled",!1)})},checkFieldOption:function(){z.byId(this.id+".radioFields").set("checked",!0)},disableFieldOption:function(){z.byId(this.id+".radioFields").set("disabled",!0)},disableUniqueOption:function(){z.byId(this.id+".radioUnique").set("disabled",!0)},enableInteractiveCheck:function(){this.interactiveCheck.disabled=
!1},disableInteractiveCheck:function(){this.interactiveCheck.checked=!1;this.interactiveCheck.disabled=!0},isBigDataLayer:function(E){return!!E.url&&-1!==E.url.indexOf("BigDataCatalogServer")&&("featureClass"===E.type||"table"===E.type)},isPortalHostedService:function(E){return E?-1!==E.toLowerCase().indexOf("/hosted/"):!1},isHostedService:function(E){if(!E)return!1;var N=-1!==E.indexOf(".arcgis.com/");E=-1!==E.indexOf("//services")||-1!==E.indexOf("//tiles")||-1!==E.indexOf("//features");return N&&
E},buildEditUIField:function(E,N,I){this.getFieldItemByName({name:E.fieldObj.name},n.hitch(this,function(O){N.getFieldsList().set("value",O.id[0],!1);this.buildEditUIOperator(E,N,I)}),n.hitch(this,function(){N.getFieldsList().set("value",0);this.buildEditUIOperator(E,N,I)}))},buildEditUIOperator:function(E,N,I){switch(E.fieldObj.shortType){case "string":N.fillOperatorList(this.stringOperatorStore,E.operator);break;case "date":N.fillOperatorList(this.dateOperatorStore,E.operator);break;default:N.fillOperatorList(this.numberOperatorStore,
E.operator)}setTimeout(n.hitch(this,function(){this.getOperatorItemByName(N.getOperatorList().store,{name:E.operator},n.hitch(this,function(O){N.getOperatorList().set("value",O.id[0],!1);this.buildEditUIValue(E,N,I)}),n.hitch(this,function(){N.getOperatorList().set("value",0);this.buildEditUIValue(E,N,I)}))}),100)},buildEditUIValue:function(E,N,I){this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!0;var O=E.operator;this.onChangeOperator(N.getOperatorList(),N);N.enableOptions();setTimeout(n.hitch(this,
function(){O===this.i18n.stringOperatorIsBlank||O===this.i18n.dateOperatorIsBlank||O===this.i18n.numberOperatorIsBlank||O===this.i18n.stringOperatorIsNotBlank||O===this.i18n.dateOperatorIsNotBlank||O===this.i18n.numberOperatorIsNotBlank?(N.createValueIsBlank(),N.disableOptions()):"field"===E.valueObj.type?(N.createValueFields(this.fieldsStore,{shortType:E.fieldObj.shortType,name:new RegExp("^(?!"+E.fieldObj.name+"$)")}),N.checkFieldOption(),this.getFieldItemByName({name:E.valueObj.value},n.hitch(this,
function(U){N.setValueFieldById(U.id[0])}),n.hitch(this,function(){N.setValueFieldById(0)}))):ba.isDefined(E.valueObj.value1)?(N.setValue1(E.valueObj.value1),N.setValue2(E.valueObj.value2)):N.setValue(E.valueObj.value,this.getCodedValues(E.fieldObj.name))}),100)},getFieldItemByName:function(E,N,I){this.fieldsStore.fetch({query:E,onComplete:n.hitch(this,function(O){O&&O.length?N(O[0]):I()})})},getOperatorItemByName:function(E,N,I,O){E.fetch({query:N,onComplete:n.hitch(this,function(U){U&&U.length?
I(U[0]):O()})})}});b("extend-esri")&&n.setObject("dijit.SingleFilter",H,ca);return H})},"esri/tasks/GenerateRendererTask":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/number dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ../urlUtils ../renderers/jsonUtils ./StatisticDefinition ./Task ./QueryTask ./query dojo/has!extend-esri?./GenerateRendererParameters dojo/has!extend-esri?./ClassificationDefinition dojo/has!extend-esri?./ClassBreaksDefinition dojo/has!extend-esri?./UniqueValueDefinition dojo/has!extend-esri?./ColorRamp dojo/has!extend-esri?./AlgorithmicColorRamp dojo/has!extend-esri?./MultipartColorRamp".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u){m=m(p,{declaredClass:"esri.tasks.GenerateRendererTask",_eventMap:{complete:["renderer"]},constructor:function(v,t){!n.isObject(v)||"esri.layers.FeatureLayer"!==v.declaredClass&&"esri.layers.CSVLayer"!==v.declaredClass?(this.url=v,this._url.path+="/generateRenderer"):v.url&&n.isString(v.url)&&"esri.layers.CSVLayer"!==v.declaredClass?(this.url=v.url,this._url=h.urlToObject(this.url),this._url.path+="/generateRenderer"):this._features=v.graphics;this._handler=
n.hitch(this,this._handler);this.source=t&&t.source;this.gdbVersion=t&&t.gdbVersion;this.checkValueRange=t&&t.checkValueRange;this.registerConnectEvents()},_handler:function(v,t,y,C,B){try{if("esri.renderer.ClassBreaksRenderer"===v.declaredClass||"esri.renderer.UniqueValueRenderer"===v.declaredClass)var F=v;else F=c.fromJson(v),"classBreaks"===v.type&&F.setMaxInclusive(!0);if(this.checkValueRange){var x=new q(this.url),w=new u,A=new g;A.statisticType="min";A.onStatisticField=this._field;var z=new g;
z.statisticType="max";z.onStatisticField=this._field;w.outStatistics=[A,z];x.execute(w).then(n.hitch(this,function(G){G=G.features[0].attributes;for(var J in G)if(0===J.toLowerCase().indexOf("min"))var L=G[J];else var R=G[J];F=this._processRenderer(F,this._prefix,this._unitLabel,this._formatLabel,this._precision,L,R);this._successHandler([F],"onComplete",y,B)}))}else F=this._processRenderer(F,this._prefix,this._unitLabel,this._formatLabel,this._precision),this._successHandler([F],"onComplete",y,B)}catch(G){this._errorHandler(G,
C,B)}},_processRenderer:function(v,t,y,C,B,F,x){"esri.renderer.ClassBreaksRenderer"===v.declaredClass?r.forEach(v.infos,function(w,A){0===A&&void 0!==F&&null!==F&&(w.minValue=F);A===v.infos.length-1&&void 0!==x&&null!==x&&(w.classMaxValue=w.maxValue=x);B&&(w.classMaxValue=w.maxValue=Math.round(w.maxValue/B)*B,w.minValue=Math.round(w.minValue/B)*B);C&&(w.label=l.format(w.minValue)+" - "+l.format(w.maxValue));t&&(w.label=t+" "+w.label);y&&(w.label=w.label+" "+y)}):r.forEach(v.infos,function(w,A){0===
A&&void 0!==F&&null!==F&&(w.value=F);A===v.infos.length-1&&void 0!==x&&null!==x&&(w.value=x);C&&(w.label=l.format(w.value));t&&(w.label=t+" "+w.label);y&&(w.label=w.label+" "+y)});return v},execute:function(v,t,y){var C=this._handler,B=this._errorHandler;this._precision=v.precision;this._prefix=v.prefix;this._unitLabel=v.unitLabel;this._formatLabel=v.formatLabel;if(this._features=v.features||this._features){var F=new b;var x=this._features;H(["./generateRenderer"],function(z){var G;"esri.tasks.ClassBreaksDefinition"===
v.classificationDefinition.declaredClass?G=z.createClassBreaksRenderer({features:x,definition:v.classificationDefinition}):"esri.tasks.UniqueValueDefinition"===v.classificationDefinition.declaredClass&&(G=z.createUniqueValueRenderer({features:x,definition:v.classificationDefinition}));G?C(G,null,t,y,F):B(null,y,F)})}else{var w=n.mixin(v.toJson(),{f:"json"});this._field="esri.tasks.ClassBreaksDefinition"===v.classificationDefinition.declaredClass?v.classificationDefinition.classificationField:v.classificationDefinition.attributeField;
if(this.source){var A={source:this.source.toJson()};w.layer=k.toJson(A)}this.gdbVersion&&(w.gdbVersion=this.gdbVersion);F=new b(e._dfdCanceller);F._pendingDfd=f({url:this._url.path,content:w,callbackParamName:"callback",load:function(z,G){C(z,G,t,y,F)},error:function(z){B(z,y,F)}})}return F},onComplete:function(){}});a("extend-esri")&&n.setObject("tasks.GenerateRendererTask",m,d);return m})},"esri/tasks/UniqueValueDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel",
"./ClassificationDefinition"],function(H,m,n,r,l){H=H(l,{declaredClass:"esri.tasks.UniqueValueDefinition",type:"uniqueValueDef",attributeField:null,attributeField2:null,attributeField3:null,fieldDelimiter:null,toJson:function(){var k=this.inherited(arguments);this.uniqueValueFields=[];this.attributeField&&this.uniqueValueFields.push(this.attributeField);this.attributeField2&&this.uniqueValueFields.push(this.attributeField2);this.attributeField3&&this.uniqueValueFields.push(this.attributeField3);m.mixin(k,
{type:this.type,uniqueValueFields:this.uniqueValueFields});this.fieldDelimiter&&m.mixin(k,{fieldDelimiter:this.fieldDelimiter});return k}});n("extend-esri")&&m.setObject("tasks.UniqueValueDefinition",H,r);return H})},"esri/tasks/ClassificationDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(H,m,n,r){H=H(null,{declaredClass:"esri.tasks.ClassificationDefinition",type:null,baseSymbol:null,colorRamp:null,toJson:function(){var l={};this.baseSymbol&&
m.mixin(l,{baseSymbol:this.baseSymbol.toJson()});this.colorRamp&&!m.isString(this.colorRamp)&&m.mixin(l,{colorRamp:this.colorRamp.toJson()});return l}});n("extend-esri")&&m.setObject("tasks.ClassificationDefinition",H,r);return H})},"esri/tasks/GenerateRendererParameters":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(H,m,n,r,l){H=H(null,{declaredClass:"esri.tasks.GenerateRendererParameters",classificationDefinition:null,where:null,precision:null,
prefix:null,unitLabel:null,formatLabel:null,toJson:function(){return{classificationDef:n.toJson(this.classificationDefinition.toJson()),where:this.where}}});r("extend-esri")&&m.setObject("tasks.GenerateRendererParameters",H,l);return H})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ../urlUtils ./ServiceGeneratedFeatureCollection".split(" "),function(H,m,n,r,l,k,b,a,d){H=H([d],{declaredClass:"esri.layers.GeoRSSLayer",
serviceUrl:a.getProtocolForWebResource()+"//utility.arcgis.com/sharing/rss",constructor:function(f,e){this._url=a.urlToObject(this.url=f);k.defaults.geoRSSService&&(this.serviceUrl=k.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=b({url:this.serviceUrl,content:{url:this.url,refresh:this.loaded?!0:void 0,outSR:this._outSR?n.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"})},_initLayer:function(f){this.inherited(arguments);this.loaded||(this.loaded=!0,
this.onLoad(this))}});r("extend-esri")&&m.setObject("layers.GeoRSSLayer",H,l);return H})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p){H=H([c],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",
constructor:function(q,u){this.pointSymbol=u&&u.pointSymbol;this.polylineSymbol=u&&u.polylineSymbol;this.polygonSymbol=u&&u.polygonSymbol;this._outSR=u&&(u.outSpatialReference||u.outSR)||new d({wkid:4326});this._options=n.mixin({},u)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var q=[];this._fLayers&&(q=q.concat(this._fLayers));return q},onRefresh:function(){},onOpacityChange:function(){},refresh:function(){this.loaded&&this._map&&!this._io&&
this.visible&&this._createLayer()},_createLayer:function(q){var u=this;this._fireUpdateStart();q=this.parse(q);q.addCallback(function(v){u._io=null;u._initLayer(v)});q.addErrback(function(v){u._io=null;v=n.mixin(Error(),v);v.message="Unable to load resource: "+u.url+" "+(v.message||"");u._fireUpdateEnd(v);u.onError(v)})},_initLayer:function(q){this.loaded&&this._removeInternalLayers();this.name=q.name;this.description=q.description;this.snippet=q.snippet;this.featureInfos=q.featureInfos;this.fullExtent=
this.initialExtent=new f(q.lookAtExtent);this.copyright=q.author||q.copyright;var u;(q=n.getObject("featureCollection.layers",!1,q))&&0<q.length&&(this._fLayers=[],r.forEach(q,function(v,t){var y=n.getObject("featureSet.features",!1,v);y&&0<y.length&&(u=n.mixin({outFields:["*"],infoTemplate:v.popupInfo?new p(v.popupInfo):null,editable:!1},this._options),u.id&&(u.id=u.id+"_"+t),u.webgl=!1,v.layerDefinition.capabilities="Query,Data",v=new g(v,u),v.geometryType&&(this["_"+v.geometryType]=v),this._fLayers.push(v))},
this),0===this._fLayers.length&&delete this._fLayers);this.items=[];this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol&&(q=new h(this.pointSymbol),this._esriGeometryPoint.setRenderer(q)));this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),this.polylineSymbol&&(q=new h(this.polylineSymbol),this._esriGeometryPolyline.setRenderer(q)));this._esriGeometryPolygon&&(this.items=this.items.concat(this._esriGeometryPolygon.graphics),
this.polygonSymbol&&(q=new h(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(q)));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var q=this._map;this._fireUpdateStart();var u=q.spatialReference,v=this._outSR;if(u.wkid)var t=u._isWebMercator()&&v._isWebMercator()||u.wkid===v.wkid;else if(u.wkt)t=u.wkt===v.wkt;else{console.log("_setMap - map has invalid spatial reference");return}if(!t)if(u._isWebMercator()&&4326===v.wkid)this._converter=
e.geographicToWebMercator;else if(v._isWebMercator()&&4326===u.wkid)this._converter=e.webMercatorToGeographic;else{console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");return}(u=this._fLayers)&&0<u.length&&r.forEach(u,function(y){if(this._converter){var C=y.graphics,B,F,x=C?C.length:0;for(B=0;B<x;B++)(F=C[B].geometry)&&C[B].setGeometry(this._converter(F))}q.addLayer(y)},this);this.setVisibility(this.visible);
this._fireUpdateEnd()},_removeInternalLayers:function(){var q=this._map;q&&r.forEach(this.getFeatureLayers(),q.removeLayer,q)},setScaleRange:function(q,u){this.inherited(arguments);r.forEach(this.getFeatureLayers(),function(v){v.setScaleRange(q,u)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(q){this.opacity!=q&&(r.forEach(this.getFeatureLayers(),function(u){u.setOpacity(q)}),this.opacity=this._options.opacity=q,this.onOpacityChange(q))},onVisibilityChange:function(q){this._fireUpdateStart();
r.forEach(this.getFeatureLayers(),function(u){u.setVisibility(q)});this._fireUpdateEnd()},_setMap:function(q,u){this.inherited(arguments);this._map=q;var v=this._div=l.create("div",null,u);k.set(v,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return v},_unsetMap:function(q,u){this._io&&this._io.cancel();m.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var v=this._div;v&&(u.removeChild(v),l.destroy(v));this._div=null;this.inherited(arguments)}});
b("extend-esri")&&n.setObject("layers._ServiceGeneratedFeatureCollection",H,a);return H})},"esri/dijit/analysis/ItemTypes":function(){define(["dojo/_base/lang","dojo/has","../../kernel"],function(H,m,n){var r={BIGDATA:"Big Data File Share",CSV:"CSV",XLS:"Microsoft Excel",FS:"Feature Service",MS:"Map Service",IS:"Image Service",FLAYER:"Feature Layer",BDATAFEATURE:"featureClass",TABLE:"Table",BTABLE:"table",FLAYERVIEW:"FeatureLayerView",MVGRID:"Multi-Variable Grid",GPSERVICE:"Geoprocessing Service",
RFT:"Raster function template",BDFSTEMPLATE:"bdfstemplate",DLPK:"Deep Learning Package",FILE:"files",DOC:"documents",IMG:"images",PDF:"pdfs",CSVS:"csvs"};m("extend-esri")&&H.setObject("dijit.analysis.itemTypes",r,n);return r})},"esri/dijit/analysis/FeatureRecordSetLayer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../../tasks/DataFile","../../kernel"],function(H,m,n,r,l){H=H(r,{declaredClass:"esri.dijit.analysis.FeatureRecordSetLayer",constructor:function(k){k&&m.mixin(this,
k)},toJson:function(){var k={};this.url&&(k.url=this.url);this.filter&&(k.filter=this.filter);this.serviceToken&&(k.serviceToken=this.serviceToken);this.featureSet&&(k.featureSet=this.featureSet);this.layerDefinition&&(k.layerDefinition=this.layerDefinition);this.time&&(k.time=this.time);return k}});n("extend-esri")&&m.setObject("dijit.analysis.FeatureRecordSetLayer",H,l);return H})},"esri/dijit/analysis/PluginLayers":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/Deferred dojo/promise/all dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/query dojo/store/Memory dojo/store/Observable dojo/Evented dojo/has ./ItemTypes ../../request ../../kernel ../../lang dgrid/OnDemandGrid dgrid/Selection ./AnalysisRegistry dojo/i18n!../../nls/jsapi".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F){var x=H([g],{infoPanelTemplate:'\x3cdiv\x3e\x3cdiv class\x3d"template-info-showing"\x3e\x3cdiv\x3e\x3cimg width\x3d\'16px\' height\x3d\'16px\' alt\x3d\'\' src\x3d\'${item.iconUrl}\'\x3e\x3c/div\x3e\x3ch4\x3e${item.title}\x3c/h4\x3e\x3cdiv class\x3d"template-info"\x3e\x3cp class\x3d""\x3e${item.snippet}\x3c/p\x3e${item:plugIn._showLayers}\x3cdiv id\x3d"${item.id}_details" class\x3d"quiet-scroll layer-container"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"panel-actions"\x3e${item:plugIn._addLayerToMap}\x3cbutton class\x3d"btn blue btn-main disabled" id\x3d"add-layer"\x3e${i18n.common.addLayerBtnLabel}\x3c/button\x3e\x3cbutton class\x3d"btn btn-cancel" id\x3d"close-panel"\x3e${i18n.common.close}\x3c/button\x3e\x3c/div\x3e\x3cdiv\x3e',
geometryTypes:[B.GeometryTypes.Point,B.GeometryTypes.Point.MultiPoint,B.GeometryTypes.Line,B.GeometryTypes.Polygon],layerTypes:[q.FLAYER,q.BDATAFEATURE,q.BTABLE,q.TABLE],timeTypes:[B.TimeTypes.Instant,B.TimeTypes.Interval],checkGeometryType:!0,checkLayerType:!1,checkTimeFilter:!1,fetchType:['type:"'+q.MS+'"','type:"'+q.FS+'"'],constructor:function(w){m.mixin(this,w);this.filters={all:{},mycontent:{owners:this.self?[this.self.user.username]:[]},esriBoundaryLayers:{owners:["esri_boundaries"]}};this.i18n=
m.mixin({},F.browseLayersDlg);m.mixin(this.i18n,F.browseItems);m.mixin(this.i18n,F.common);this.filterStrings={all:{title:this.self&&this.self.isPortal?this.i18n.items.portalOrg:this.i18n.items.organizationLabel},mycontent:{title:this.i18n.items.contentLabel},esriBoundaryLayers:{title:this.i18n.esriBoundaryLayers}}},fetchData:function(){this._portal=this.parent._portal;this._user=this._portal.getPortalUser();this.filters.mycontent.owner=this._user;this.parent.fetchType&&(this.fetchType=this.parent.fetchType);
return this._fetchItems()},_fetchItems:function(){return this.parent._fetchItems({types:this.fetchType})},_fetchServiceInfo:function(w){var A=new l,z,G={f:"json"};w.url?(-1!==window.location.protocol.indexOf("https:")&&(w.url=w.url.replace("http:","https:")),u({url:w.url,content:G}).then(function(J){A.resolve(J)},m.hitch(this,function(J){z=J.details&&J.details.length?J.details.shift():"";J&&403===J.httpCode&&-1<z.indexOf("SSL Required")?(w.set("url",w.url.replace("http:","https:")),this._fetchServiceInfo(w).then(function(L){A.resolve(L)})):
(w.isLoaded=!0,A.resolve({error:J}))}))):A.resolve(null);return A},_addLayerToMap:function(w){return w.type===q.BIGDATA||w.type===q.CSV||w.type===q.XLS?"":'\x3cdiv class\x3d"esriFloatLeading esriLeadingPadding1 padding-trailer-half js-add-layer-node"\x3e\x3clabel\x3e\x3cinput name\x3d"addlayertomap" class\x3d"js-add-layer-checkbox" type\x3d"checkbox"\x3e\x3cspan class\x3d"esriLeadingPadding1"\x3e'+this.i18n.common.addLayer+"\x3c/span\x3e\x3c/label\x3e\x3c/div\x3e"},_showLayers:function(w){if(w&&-1!==
n.indexOf([q.FS,q.MS,q.IS,q.BIGDATA,q.CSV,q.XLS],w.type)){if(w.type===q.CSV||w.type===q.XLS)w.url=w.itemUrl;this.plugIn._fetchServiceInfo(w).then(m.hitch(this,function(A){var z=[],G={f:"json"};A.layers&&(z=[].concat(z).concat(A.layers));A.tables&&0<A.tables.length&&(z=[].concat(z).concat(A.tables));A.children&&(z=A.children);!w||w.type!==q.CSV&&w.type!==q.XLS&&w.type!==q.IS||(z=[w]);if(!z.length)var J=this.plugIn.i18n.noDataMessages.noItemInfo;this.plugIn._createLayerGrid(r.create("div",null,b.byId(w.id+
"_details")),J);n.forEach(z,function(L,R){w.type===q.BIGDATA?(L.url=w.url+"/"+L.name,L.url=encodeURI(L.url)):L.url=w.type===q.CSV?w.itemUrl:w.type===q.IS?w.url:w.url+"/"+R;-1!==window.location.protocol.indexOf("https:")&&(L.url=L.url.replace("http:","https:"));u({url:L.url,content:G}).then(m.hitch(this,function(T){L=m.mixin(L,T);this.plugIn._store.put(L);this.plugIn._grid.refresh()}),m.hitch(this,function(T){this.plugIn._grid.noDataMessage=this.plugIn.i18n.noDataMessages.noLayerInfo;this.plugIn._grid.refresh()}))},
this)}))}return""},_getLayerHead:function(){return"\x3ctr\x3e\x3cth\x3e\x3c/th\x3e\x3cth\x3eLayer Name\x3c/th\x3e\x3cth\x3e Geometry Type\x3c/th\x3e\x3c/tr\x3e"},_getLayerNode:function(w,A,z){A=w.name;var G='\x3ctr\x3e\x3ctd\x3e\x3cinput type\x3d"checkbox" class\x3d"js-layer-check" name\x3d"layers" value\x3d"'+A+' checked"\x3e\x3c/td\x3e\x3ctd\x3e',J="\x3c/td\x3e\x3ctd\x3e"+w.geometryType+"\x3c/td\x3e\x3c/tr\x3e";return w.itemUrl||w.url?G+'\x3ca class\x3d"'+(z||"")+'"\x3e'+A+"\x3c/a\x3e"+J:G+A+J},
_createLayerGrid:function(w,A){var z=H([y,C]);this._store=c(new h({idProperty:"name"}));this._atleastALayerAvailable=!1;this._grid=new z({store:this._store,query:m.hitch(this,function(G){var J=!0,L=!0,R=!0,T=!0;this.checkGeometryType&&G.type!==q.IS&&(R=-1!==n.indexOf(this.geometryTypes,G.geometryType));this.checkTimeFilter&&(J=-1!==n.indexOf(this.timeTypes,this.getTimeType(G)));this.checkLayerType&&(L=-1!==n.indexOf(this.layerTypes,G.type));"function"===typeof this.customCheckHandler&&(T=this.customCheckHandler(G));
G=G&&R&&J&&L&&T;G||(this._grid.noDataMessage=this.getNoDataMessage({geomCheck:R,timeCheck:J,typeCheck:L,customCheck:T}));!this._atleastALayerAvailable&&G&&(this._atleastALayerAvailable=G);e(".js-add-layer-checkbox",this.parent.infoPanel).forEach(function(aa){a.set(aa,"disabled",!this._atleastALayerAvailable)},this);return G}),selectionMode:"single","class":"esriAnalysisLayersGrid quiet-scroll",noDataMessage:A||this.i18n.noValidLayerMsg,allowSelect:m.hitch(this,function(G){var J;this.checkLayerType&&
G.data&&(J=-1!==n.indexOf(this.layerTypes,G.data.type));J=G.data.geometryType?-1!==n.indexOf(this.geometryTypes,G.data.geometryType)||this.checkLayerType&&J:!0;return G&&G.data&&J}),renderRow:m.hitch(this,this._renderer)},w);this._grid.startup();this._grid.on("dgrid-select,dgrid-deselect",m.hitch(this,function(G){G=G.grid.selection;var J=[];for(L in G)G[L]&&J.push(this._grid.row(L).data);var L={selection:J};e(".panel-actions .btn-main",this.parent.infoPanel).forEach(function(R){d.toggle(R,"disabled",
0===J.length)},this);J[0]&&(this._selectedLayer=J[0]);this.emit("layer-change",L)}))},hasTimeInfo:function(w){return w&&w.timeInfo},getTimeType:function(w){return w?t.isDefined(w.timeInfo)&&t.isDefined(w.timeInfo.startTimeField)&&!t.isDefined(w.timeInfo.endTimeField)?B.TimeTypes.Instant:t.isDefined(w.timeInfo)&&t.isDefined(w.timeInfo.startTimeField)&&t.isDefined(w.timeInfo.endTimeField)?B.TimeTypes.Interval:t.isDefined(w.time)&&t.isDefined(w.time.timeType)?w.time.timeType:!1:!1},getNoDataMessage:function(w){if(w.geomCheck)if(w.timeCheck){if(!w.typeCheck)return this.i18n.noDataMessages.typeCheckFailure;
if(!w.customCheck)return this.customCheckFailureMessage}else return this.i18n.noDataMessages.timeCheckFailure;else return this.i18n.noDataMessages.geomCheckFailure},getDateFields:function(w){return n.filter(w&&w.fields||[],function(A){return A&&"esriFieldTypeDate"===A.type})},_renderer:function(w){w.snippet=w.snippet||"";var A=r.create("div"),z=this._getLabel(w);r.place('\x3cdiv class\x3d"panel panel-white panel-bordered panel-compact border-bottom-clear"\x3e\x3ch5 class\x3d"trailer-0 font-size-0 word-break"\x3e\x3ca\x3e'+
w.name+'\x3c/a\x3e\x3c/h5\x3e\x3cnav class\x3d"inline-block"\x3e\x3ca class\x3d"link-gray font-size--2 esriTrailingPadding1 esriTrailingMargin05"\x3e\x3cspan class\x3d"'+z.icon+'"\x3e\x3c/span\x3e'+z.name+"\x3c/a\x3e"+(w.timeInfo||w.time&&"instant"===w.time.timeType?'\x3ca class\x3d"link-gray font-size--2 esriTrailingPadding1" data-action\x3d"timeSettings" data-layerid\x3d"0"\x3e\x3cspan class\x3d"esri-icon-time-clock"\x3e\x3c/span\x3e'+this.i18n.timeEnabled+"\x3c/a\x3e":'\x3ca class\x3d"esriTrailingPadding1"\x3e\x3c/a\x3e')+
"\x3c/nav\x3e\x3c/div\x3e",A);return A},_getLabel:function(w){var A={icon:"",name:""},z=w.geometryType;z===B.GeometryTypes.Point||z===B.GeometryTypes.MultiPoint?(A.name=this.i18n.points,A.icon="esri-icon-map-pin"):z===B.GeometryTypes.Polygon?(A.name=this.i18n.areas,A.icon="esri-icon-polygon"):z===B.GeometryTypes.Line?(A.name=this.i18n.lines,A.icon="esri-icon-polyline"):w.type===q.IS?(A.name=this.i18n.imageService,A.icon="esri-icon-layers"):(A.name=this.i18n.table,A.icon="esri-icon-table");return A}});
m.mixin(x,{add:function(w,A){w.plugIn||(A=A||{},A.parent=w,A.self=w.self,w.plugIn=new x(A))},remove:function(w){w.plugIn&&(w.plugIn.destroy(),delete w.plugIn)}});p("extend-esri")&&m.setObject("dijit.analysis.PluginLayers",x,v);return x})},"esri/dijit/analysis/AnalysisRegistry":function(){define(["dojo/_base/lang","dojo/has","../../kernel"],function(H,m,n){var r={Modes:{Raster:"raster",Bigdata:"bigdata",Standard:"standard",Feature:"feature"},Tools:{FindCentroids:"FindCentroids",ChooseBestFacilities:"ChooseBestFacilities"},
ProcessInfoTools:{DescribeDataset:{Name:"DescribeDataset",Gax:!0,Std:!1},GeneralizedLinearRegression:{Name:"GeneralizedLinearRegression",Gax:!0,Std:!1},ForestBasedClassificationAndRegression:{Name:"ForestBasedClassificationAndRegression",Gax:!0,Std:!1},GeographicallyWeightedRegression:{Name:"GeographicallyWeightedRegression",Gax:!0,Std:!1},FindSimilarLocations:{Name:"FindSimilarLocations",Gax:!0,Std:!0},FindHotSpots:{Name:"FindHotSpots",Gax:!1,Std:!0},FindOutliers:{Name:"FindOutliers",Gax:!0,Std:!0}},
ToolCategory:{Gax:"GeoAnalyticsTools",Std:"SpatialAnalysisTools"},GeometryTypes:{Polygon:"esriGeometryPolygon",Line:"esriGeometryPolyline",Point:"esriGeometryPoint",MultiPoint:"esriGeometryMultipoint"},PseudoGeometryTypes:{Point:"point",Line:"line",Polygon:"polygon"},TimeTypes:{Instant:"instant",Interval:"interval"},FieldTypes:{ObjectId:"esriFieldTypeOID",String:"esriFieldTypeString",Short:"esriFieldTypeSmallInteger",Integer:"esriFieldTypeInteger",Float:"esriFieldTypeSingle",Double:"esriFieldTypeDouble",
Date:"esriFieldTypeDate"},PseudoFieldTypes:{Number:"number",String:"string",Date:"date"},Shapes:{square:"SQUARE",hexagon:"HEXAGON",transverseHexagon:"TRANSVERSEHEXAGON",triangle:"TRIANGLE",diamond:"DIAMOND"},DistanceMethods:{geodesic:"Geodesic",planar:"Planar"}};m("extend-esri")&&H.setObject("dijit.analysis.AnalysisRegistry",r,n);return r})},"esri/dijit/analysis/PCSList":function(){define(["dojo/_base/lang","dojo/has","../../kernel"],function(H,m,n){var r=[2E3,2001,2002,2003,2004,2005,2006,2007,2008,
2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2070,2071,2072,2073,2074,2075,2076,2077,2078,2079,2080,2081,2082,2083,2084,2085,2086,2087,2088,2089,2090,2091,2092,2093,2094,2095,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2111,2112,2113,2114,2115,2116,2117,2118,2119,
2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2137,2138,2139,2140,2141,2142,2143,2144,2145,2146,2147,2148,2149,2150,2151,2152,2153,2154,2155,2157,2158,2159,2160,2161,2162,2163,2164,2165,2166,2167,2168,2169,2170,2172,2173,2174,2175,2176,2177,2178,2179,2180,2181,2182,2183,2184,2185,2186,2187,2188,2189,2190,2191,2192,2193,2195,2196,2197,2198,2200,2201,2202,2203,2204,2205,2206,2207,2208,2209,2210,2211,2212,2213,2214,2215,2216,2217,2219,2220,2222,2223,2224,2225,2226,
2227,2228,2229,2230,2231,2232,2233,2234,2235,2236,2237,2238,2239,2240,2241,2242,2243,2244,2245,2246,2247,2248,2249,2250,2251,2252,2253,2254,2255,2256,2257,2258,2259,2260,2261,2262,2263,2264,2265,2266,2267,2268,2269,2270,2271,2272,2273,2274,2275,2276,2277,2278,2279,2280,2281,2282,2283,2284,2285,2286,2287,2288,2289,2290,2291,2292,2294,2295,2308,2309,2310,2311,2312,2313,2314,2315,2316,2317,2318,2319,2320,2321,2322,2323,2324,2325,2326,2327,2328,2329,2330,2331,2332,2333,2334,2335,2336,2337,2338,2339,2340,
2341,2342,2343,2344,2345,2346,2347,2348,2349,2350,2351,2352,2353,2354,2355,2356,2357,2358,2359,2360,2361,2362,2363,2364,2365,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2384,2385,2386,2387,2388,2389,2390,2391,2392,2393,2394,2395,2396,2397,2398,2399,2400,2401,2402,2403,2404,2405,2406,2407,2408,2409,2410,2411,2412,2413,2414,2415,2416,2417,2418,2419,2420,2421,2422,2423,2424,2425,2426,2427,2428,2429,2430,2431,2432,2433,2434,2435,2436,2437,2438,2439,2440,2441,
2442,2443,2444,2445,2446,2447,2448,2449,2450,2451,2452,2453,2454,2455,2456,2457,2458,2459,2460,2461,2462,2463,2464,2465,2466,2467,2468,2469,2470,2471,2472,2473,2474,2475,2476,2477,2478,2479,2480,2481,2482,2483,2484,2485,2486,2487,2488,2489,2490,2491,2494,2495,2496,2497,2498,2499,2500,2501,2502,2503,2504,2505,2506,2507,2508,2509,2510,2511,2512,2513,2514,2515,2516,2517,2518,2519,2520,2521,2522,2523,2524,2525,2526,2527,2528,2529,2530,2531,2532,2533,2534,2535,2536,2537,2538,2539,2540,2541,2542,2543,2544,
2545,2546,2547,2548,2549,2550,2551,2552,2553,2554,2555,2556,2557,2558,2559,2560,2561,2562,2563,2564,2565,2566,2567,2568,2569,2570,2571,2572,2573,2574,2575,2576,2577,2578,2579,2580,2581,2582,2583,2584,2585,2586,2587,2588,2589,2590,2591,2592,2593,2594,2595,2596,2597,2598,2599,2600,2601,2602,2603,2604,2605,2606,2607,2608,2609,2610,2611,2612,2613,2614,2615,2616,2617,2618,2619,2620,2621,2622,2623,2624,2625,2626,2627,2628,2629,2630,2631,2632,2633,2634,2635,2636,2637,2638,2639,2640,2641,2642,2643,2644,2645,
2646,2647,2648,2649,2650,2651,2652,2653,2654,2655,2656,2657,2658,2659,2660,2661,2662,2663,2664,2665,2666,2667,2668,2669,2670,2671,2672,2673,2674,2675,2676,2677,2678,2679,2680,2681,2682,2683,2684,2685,2686,2687,2688,2689,2690,2691,2692,2693,2694,2695,2696,2697,2698,2699,2700,2701,2702,2703,2704,2705,2706,2707,2708,2709,2710,2711,2712,2713,2714,2715,2716,2717,2718,2719,2720,2721,2722,2723,2724,2725,2726,2727,2728,2729,2730,2731,2732,2733,2734,2735,2736,2737,2738,2739,2740,2741,2742,2743,2744,2745,2746,
2747,2748,2749,2750,2751,2752,2753,2754,2755,2756,2757,2758,2759,2760,2761,2762,2763,2764,2765,2766,2767,2768,2769,2770,2771,2772,2773,2774,2775,2776,2777,2778,2779,2780,2781,2782,2783,2784,2785,2786,2787,2788,2789,2790,2791,2792,2793,2794,2795,2796,2797,2798,2799,2800,2801,2802,2803,2804,2805,2806,2807,2808,2809,2810,2811,2812,2813,2814,2815,2816,2817,2818,2819,2820,2821,2822,2823,2824,2825,2826,2827,2828,2829,2830,2831,2832,2833,2834,2835,2836,2837,2838,2839,2840,2841,2842,2843,2844,2845,2846,2847,
2848,2849,2850,2851,2852,2853,2854,2855,2856,2857,2858,2859,2860,2861,2862,2863,2864,2865,2866,2867,2868,2869,2870,2871,2872,2873,2874,2875,2876,2877,2878,2879,2880,2881,2882,2883,2884,2885,2886,2887,2888,2891,2892,2893,2894,2895,2896,2897,2898,2899,2900,2901,2902,2903,2904,2905,2906,2907,2908,2909,2910,2911,2912,2913,2914,2915,2916,2917,2918,2919,2920,2921,2922,2923,2924,2925,2926,2927,2928,2929,2930,2931,2932,2933,2934,2935,2936,2937,2938,2939,2940,2941,2942,2943,2944,2945,2946,2947,2948,2949,2950,
2951,2952,2953,2954,2955,2956,2957,2958,2959,2960,2961,2962,2964,2965,2966,2967,2968,2969,2970,2971,2972,2973,2975,2976,2977,2978,2979,2980,2981,2982,2983,2984,2985,2986,2987,2988,2989,2990,2991,2992,2993,2994,2995,2996,2997,2998,2999,3E3,3001,3002,3003,3004,3005,3006,3007,3008,3009,3010,3011,3012,3013,3014,3015,3016,3017,3018,3019,3020,3021,3022,3023,3024,3025,3026,3027,3028,3029,3030,3031,3032,3033,3034,3035,3036,3037,3038,3039,3040,3041,3042,3043,3044,3045,3046,3047,3048,3049,3050,3051,3054,3055,
3056,3057,3058,3059,3060,3061,3062,3063,3064,3065,3066,3067,3068,3069,3070,3071,3072,3073,3074,3075,3076,3077,3078,3079,3080,3081,3082,3083,3084,3085,3086,3087,3088,3089,3090,3091,3092,3093,3094,3095,3096,3097,3098,3099,3100,3101,3102,3106,3107,3108,3109,3110,3111,3112,3113,3114,3115,3116,3117,3118,3119,3120,3121,3122,3123,3124,3125,3126,3127,3128,3129,3130,3131,3132,3133,3134,3135,3136,3137,3138,3141,3142,3146,3147,3148,3149,3150,3151,3153,3154,3155,3156,3157,3158,3159,3160,3161,3162,3163,3164,3165,
3166,3167,3168,3169,3170,3171,3172,3174,3175,3176,3177,3178,3179,3180,3181,3182,3183,3184,3185,3186,3187,3188,3189,3190,3191,3192,3193,3194,3195,3196,3197,3198,3199,3200,3201,3202,3203,3294,3295,3296,3297,3298,3299,3300,3301,3302,3303,3304,3305,3306,3307,3308,3309,3310,3311,3312,3313,3314,3315,3316,3317,3318,3319,3320,3321,3322,3323,3324,3325,3326,3327,3328,3329,3330,3331,3332,3333,3334,3335,3336,3337,3338,3339,3340,3341,3342,3343,3344,3345,3346,3347,3348,3349,3350,3351,3352,3353,3354,3355,3356,3357,
3358,3359,3360,3361,3362,3363,3364,3365,3366,3367,3368,3369,3370,3371,3372,3373,3374,3375,3376,3377,3378,3379,3380,3381,3382,3383,3384,3385,3386,3387,3388,3389,3390,3391,3392,3393,3394,3395,3396,3397,3398,3399,3400,3401,3402,3403,3404,3405,3406,3407,3408,3409,3410,3411,3412,3413,3414,3415,3416,3417,3418,3419,3420,3421,3422,3423,3424,3425,3426,3427,3428,3429,3430,3431,3432,3433,3434,3435,3436,3437,3438,3439,3440,3441,3442,3443,3444,3445,3446,3447,3448,3449,3450,3451,3452,3453,3454,3455,3456,3457,3458,
3459,3460,3461,3462,3463,3464,3465,3466,3467,3468,3469,3470,3471,3472,3473,3474,3475,3476,3477,3478,3479,3480,3481,3482,3483,3484,3485,3486,3487,3488,3489,3490,3491,3492,3493,3494,3495,3496,3497,3498,3499,3500,3501,3502,3503,3504,3505,3506,3507,3508,3509,3510,3511,3512,3513,3514,3515,3516,3517,3518,3519,3520,3521,3522,3523,3524,3525,3526,3527,3528,3529,3530,3531,3532,3533,3534,3535,3536,3537,3538,3539,3540,3541,3542,3543,3544,3545,3546,3547,3548,3549,3550,3551,3552,3553,3554,3555,3556,3557,3558,3559,
3560,3561,3562,3563,3564,3565,3566,3567,3568,3569,3570,3571,3572,3573,3574,3575,3576,3577,3578,3579,3580,3581,3582,3583,3584,3585,3586,3587,3588,3589,3590,3591,3592,3593,3594,3595,3596,3597,3598,3599,3600,3601,3602,3603,3604,3605,3606,3607,3608,3609,3610,3611,3612,3613,3614,3615,3616,3617,3618,3619,3620,3621,3622,3623,3624,3625,3626,3627,3628,3629,3630,3631,3632,3633,3634,3635,3636,3637,3638,3639,3640,3641,3642,3643,3644,3645,3646,3647,3648,3649,3650,3651,3652,3653,3654,3655,3656,3657,3658,3659,3660,
3661,3662,3663,3664,3665,3666,3667,3668,3669,3670,3671,3672,3673,3674,3675,3676,3677,3678,3679,3680,3681,3682,3683,3684,3685,3686,3687,3688,3689,3690,3691,3692,3693,3694,3695,3696,3697,3698,3699,3700,3701,3702,3703,3704,3705,3706,3707,3708,3709,3710,3711,3712,3713,3714,3715,3716,3717,3718,3719,3720,3721,3722,3723,3724,3725,3726,3727,3728,3729,3730,3731,3732,3733,3734,3735,3736,3737,3738,3739,3740,3741,3742,3743,3744,3745,3746,3747,3748,3749,3750,3751,3753,3754,3755,3756,3757,3758,3759,3760,3761,3762,
3763,3764,3765,3766,3767,3768,3769,3770,3771,3772,3773,3775,3776,3777,3779,3780,3781,3783,3784,3785,3788,3789,3790,3791,3793,3794,3797,3798,3799,3800,3801,3802,3812,3814,3815,3816,3825,3826,3827,3828,3829,3832,3833,3834,3835,3836,3837,3838,3839,3840,3841,3844,3845,3846,3847,3848,3849,3850,3851,3852,3854,3857,3873,3874,3875,3876,3877,3878,3879,3880,3881,3882,3883,3884,3885,3890,3891,3892,3893,3907,3908,3909,3910,3911,3912,3920,3942,3943,3944,3945,3946,3947,3948,3949,3950,3968,3969,3970,3973,3974,3975,
3976,3978,3979,3986,3987,3988,3989,3991,3992,3994,3995,3996,3997,4026,4037,4038,4048,4049,4050,4051,4056,4057,4058,4059,4060,4061,4062,4063,4071,4082,4083,4087,4088,4093,4094,4095,4096,4217,4390,4391,4392,4393,4394,4395,4396,4397,4398,4399,4400,4401,4402,4403,4404,4405,4406,4407,4408,4409,4410,4411,4412,4413,4414,4415,4417,4418,4419,4420,4421,4422,4423,4424,4425,4426,4427,4428,4429,4430,4431,4432,4433,4434,4437,4438,4439,4455,4456,4457,4462,4467,4471,4474,4484,4485,4486,4487,4488,4489,4491,4492,4493,
4494,4495,4496,4497,4498,4499,4500,4501,4502,4503,4504,4505,4506,4507,4508,4509,4510,4511,4512,4513,4514,4515,4516,4517,4518,4519,4520,4521,4522,4523,4524,4525,4526,4527,4528,4529,4530,4531,4532,4533,4534,4535,4536,4537,4538,4539,4540,4541,4542,4543,4544,4545,4546,4547,4548,4549,4550,4551,4552,4553,4554,4559,4568,4569,4570,4571,4572,4573,4574,4575,4576,4577,4578,4579,4580,4581,4582,4583,4584,4585,4586,4587,4588,4589,4647,4652,4653,4654,4655,4656,4766,4767,4768,4769,4770,4771,4772,4773,4774,4775,4776,
4777,4778,4779,4780,4781,4782,4783,4784,4785,4786,4787,4788,4789,4790,4791,4792,4793,4794,4795,4796,4797,4798,4799,4800,4822,4826,4839,5014,5015,5016,5018,5048,5069,5070,5071,5072,5105,5106,5107,5108,5109,5110,5111,5112,5113,5114,5115,5116,5117,5118,5119,5120,5121,5122,5123,5124,5125,5126,5127,5128,5129,5130,5167,5168,5173,5174,5175,5176,5177,5178,5179,5180,5181,5182,5183,5184,5185,5186,5187,5188,5221,5223,5234,5235,5243,5247,5253,5254,5255,5256,5257,5258,5259,5266,5269,5270,5271,5272,5273,5274,5275,
5292,5293,5294,5295,5296,5297,5298,5299,5300,5301,5302,5303,5304,5305,5306,5307,5308,5309,5310,5311,5316,5320,5321,5325,5329,5330,5331,5337,5343,5344,5345,5346,5347,5348,5349,5355,5356,5357,5361,5362,5367,5382,5383,5387,5388,5389,5396,5456,5457,5459,5460,5461,5462,5463,5469,5472,5479,5480,5481,5482,5490,5513,5514,5518,5519,5520,5523,5530,5531,5532,5533,5534,5535,5536,5537,5538,5539,5550,5551,5552,5559,5562,5563,5564,5565,5566,5567,5568,5569,5570,5571,5572,5573,5574,5575,5576,5577,5578,5579,5580,5581,
5582,5583,5588,5589,5596,5623,5624,5625,5627,5629,5631,5632,5633,5634,5635,5636,5637,5638,5639,5641,5643,5644,5646,5649,5650,5651,5652,5653,5654,5655,5659,5663,5664,5665,5666,5667,5668,5669,5670,5671,5672,5673,5674,5675,5676,5677,5678,5679,5680,5682,5683,5684,5685,5700,5825,5836,5837,5839,5842,5844,5858,5875,5876,5877,5879,5880,5887,5890,5921,5922,5923,5924,5925,5926,5927,5928,5929,5930,5931,5932,5933,5934,5935,5936,5937,5938,5939,5940,6050,6051,6052,6053,6054,6055,6056,6057,6058,6059,6060,6061,6062,
6063,6064,6065,6066,6067,6068,6069,6070,6071,6072,6073,6074,6075,6076,6077,6078,6079,6080,6081,6082,6083,6084,6085,6086,6087,6088,6089,6090,6091,6092,6093,6094,6095,6096,6097,6098,6099,6100,6101,6102,6103,6104,6105,6106,6107,6108,6109,6110,6111,6112,6113,6114,6115,6116,6117,6118,6119,6120,6121,6122,6123,6124,6125,6128,6129,6141,6204,6210,6211,6244,6245,6246,6247,6248,6249,6250,6251,6252,6253,6254,6255,6256,6257,6258,6259,6260,6261,6262,6263,6264,6265,6266,6267,6268,6269,6270,6271,6272,6273,6274,6275,
6307,6312,6316,6328,6329,6330,6331,6332,6333,6334,6335,6336,6337,6338,6339,6340,6341,6342,6343,6344,6345,6346,6347,6348,6350,6351,6352,6353,6354,6355,6356,6362,6366,6367,6368,6369,6370,6371,6372,6381,6382,6383,6384,6385,6386,6387,6391,6393,6394,6395,6396,6397,6398,6399,6400,6401,6402,6403,6404,6405,6406,6407,6408,6409,6410,6411,6412,6413,6414,6415,6416,6417,6418,6419,6420,6421,6422,6423,6424,6425,6426,6427,6428,6429,6430,6431,6432,6433,6434,6435,6436,6437,6438,6439,6440,6441,6442,6443,6444,6445,6446,
6447,6448,6449,6450,6451,6452,6453,6454,6455,6456,6457,6458,6459,6460,6461,6462,6463,6464,6465,6466,6467,6468,6469,6470,6471,6472,6473,6474,6475,6476,6477,6478,6479,6480,6481,6482,6483,6484,6485,6486,6487,6488,6489,6490,6491,6492,6493,6494,6495,6496,6497,6498,6499,6500,6501,6502,6503,6504,6505,6506,6507,6508,6509,6510,6511,6512,6513,6514,6515,6516,6518,6519,6520,6521,6522,6523,6524,6525,6526,6527,6528,6529,6530,6531,6532,6533,6534,6535,6536,6537,6538,6539,6540,6541,6542,6543,6544,6545,6546,6547,6548,
6549,6550,6551,6552,6553,6554,6555,6556,6557,6558,6559,6560,6561,6562,6563,6564,6565,6566,6567,6568,6569,6570,6571,6572,6573,6574,6575,6576,6577,6578,6579,6580,6581,6582,6583,6584,6585,6586,6587,6588,6589,6590,6591,6592,6593,6594,6595,6596,6597,6598,6599,6600,6601,6602,6603,6605,6606,6607,6608,6609,6610,6611,6612,6613,6614,6615,6616,6617,6618,6619,6620,6621,6622,6623,6624,6625,6626,6627,6628,6629,6630,6631,6632,6633,6634,6635,6636,6637,6646,6669,6670,6671,6672,6673,6674,6675,6676,6677,6678,6679,6680,
6681,6682,6683,6684,6685,6686,6687,6688,6689,6690,6691,6692,6703,6707,6708,6709,6720,6721,6722,6723,6732,6733,6734,6735,6736,6737,6738,6784,6785,6786,6787,6788,6789,6790,6791,6792,6793,6794,6795,6796,6797,6798,6799,6800,6801,6802,6803,6804,6805,6806,6807,6808,6809,6810,6811,6812,6813,6814,6815,6816,6817,6818,6819,6820,6821,6822,6823,6824,6825,6826,6827,6828,6829,6830,6831,6832,6833,6834,6835,6836,6837,6838,6839,6840,6841,6842,6843,6844,6845,6846,6847,6848,6849,6850,6851,6852,6853,6854,6855,6856,6857,
6858,6859,6860,6861,6862,6863,6867,6868,6870,6875,6876,6879,6880,6884,6885,6886,6887,6915,6922,6923,6924,6925,6931,6932,6933,6956,6957,6958,6959,6962,6984,6991,7005,7006,7007,7057,7058,7059,7060,7061,7062,7063,7064,7065,7066,7067,7068,7069,7070,7074,7075,7076,7077,7078,7079,7080,7081,7082,7109,7110,7111,7112,7113,7114,7115,7116,7117,7118,7119,7120,7121,7122,7123,7124,7125,7126,7127,7128,7131,7132,7257,7258,7259,7260,7261,7262,7263,7264,7265,7266,7267,7268,7269,7270,7271,7272,7273,7274,7275,7276,7277,
7278,7279,7280,7281,7282,7283,7284,7285,7286,7287,7288,7289,7290,7291,7292,7293,7294,7295,7296,7297,7298,7299,7300,7301,7302,7303,7304,7305,7306,7307,7308,7309,7310,7311,7312,7313,7314,7315,7316,7317,7318,7319,7320,7321,7322,7323,7324,7325,7326,7327,7328,7329,7330,7331,7332,7333,7334,7335,7336,7337,7338,7339,7340,7341,7342,7343,7344,7345,7346,7347,7348,7349,7350,7351,7352,7353,7354,7355,7356,7357,7358,7359,7360,7361,7362,7363,7364,7365,7366,7367,7368,7369,7370,7374,7375,7376,7528,7529,7530,7531,7532,
7533,7534,7535,7536,7537,7538,7539,7540,7541,7542,7543,7544,7545,7546,7547,7548,7549,7550,7551,7552,7553,7554,7555,7556,7557,7558,7559,7560,7561,7562,7563,7564,7565,7566,7567,7568,7569,7570,7571,7572,7573,7574,7575,7576,7577,7578,7579,7580,7581,7582,7583,7584,7585,7586,7587,7588,7589,7590,7591,7592,7593,7594,7595,7596,7597,7598,7599,7600,7601,7602,7603,7604,7605,7606,7607,7608,7609,7610,7611,7612,7613,7614,7615,7616,7617,7618,7619,7620,7621,7622,7623,7624,7625,7626,7627,7628,7629,7630,7631,7632,7633,
7634,7635,7636,7637,7638,7639,7640,7641,7642,7643,7644,7645,7845,7846,7847,7848,7849,7850,7851,7852,7853,7854,7855,7856,7857,7858,7859,20002,20003,20004,20005,20006,20007,20008,20009,20010,20011,20012,20013,20014,20015,20016,20017,20018,20019,20020,20021,20022,20023,20024,20025,20026,20027,20028,20029,20030,20031,20032,20062,20063,20064,20065,20066,20067,20068,20069,20070,20071,20072,20073,20074,20075,20076,20077,20078,20079,20080,20081,20082,20083,20084,20085,20086,20087,20088,20089,20090,20091,
20092,20135,20136,20137,20138,20248,20249,20250,20251,20252,20253,20254,20255,20256,20257,20258,20348,20349,20350,20351,20352,20353,20354,20355,20356,20357,20358,20436,20437,20438,20439,20440,20499,20538,20539,20790,20791,20822,20823,20824,20934,20935,20936,21035,21036,21037,21095,21096,21097,21148,21149,21150,21291,21292,21413,21414,21415,21416,21417,21418,21419,21420,21421,21422,21423,21473,21474,21475,21476,21477,21478,21479,21480,21481,21482,21483,21500,21780,21781,21782,21817,21818,21891,21892,
21893,21894,21896,21897,21898,21899,22032,22033,22091,22092,22171,22172,22173,22174,22175,22176,22177,22181,22182,22183,22184,22185,22186,22187,22191,22192,22193,22194,22195,22196,22197,22234,22235,22236,22332,22391,22392,22521,22522,22523,22524,22525,22700,22770,22780,22832,22991,22992,22993,22994,23028,23029,23030,23031,23032,23033,23034,23035,23036,23037,23038,23090,23095,23239,23240,23433,23700,23830,23831,23832,23833,23834,23835,23836,23837,23838,23839,23840,23841,23842,23843,23844,23845,23846,
23847,23848,23849,23850,23851,23852,23853,23866,23867,23868,23869,23870,23871,23872,23877,23878,23879,23880,23881,23882,23883,23884,23886,23887,23888,23889,23890,23891,23892,23893,23894,23946,23947,23948,24047,24048,24100,24200,24305,24306,24311,24312,24313,24342,24343,24344,24345,24346,24347,24370,24371,24372,24373,24374,24375,24376,24377,24378,24379,24380,24381,24382,24383,24500,24547,24548,24571,24600,24718,24719,24720,24721,24817,24818,24819,24820,24821,24877,24878,24879,24880,24881,24882,24891,
24892,24893,25E3,25231,25391,25392,25393,25394,25395,25828,25829,25830,25831,25832,25833,25834,25835,25836,25837,25838,25884,25932,26191,26192,26193,26194,26195,26237,26331,26332,26391,26392,26393,26432,26591,26592,26632,26692,26701,26702,26703,26704,26705,26706,26707,26708,26709,26710,26711,26712,26713,26714,26715,26716,26717,26718,26719,26720,26721,26722,26729,26730,26731,26732,26733,26734,26735,26736,26737,26738,26739,26740,26741,26742,26743,26744,26745,26746,26747,26748,26749,26750,26751,26752,
26753,26754,26755,26756,26757,26758,26759,26760,26761,26762,26763,26764,26765,26766,26767,26768,26769,26770,26771,26772,26773,26774,26775,26776,26777,26778,26779,26780,26781,26782,26783,26784,26785,26786,26787,26788,26789,26790,26791,26792,26793,26794,26795,26796,26797,26798,26799,26801,26802,26803,26811,26812,26813,26847,26848,26849,26850,26851,26852,26853,26854,26855,26856,26857,26858,26859,26860,26861,26862,26863,26864,26865,26866,26867,26868,26869,26870,26891,26892,26893,26894,26895,26896,26897,
26898,26899,26901,26902,26903,26904,26905,26906,26907,26908,26909,26910,26911,26912,26913,26914,26915,26916,26917,26918,26919,26920,26921,26922,26923,26929,26930,26931,26932,26933,26934,26935,26936,26937,26938,26939,26940,26941,26942,26943,26944,26945,26946,26948,26949,26950,26951,26952,26953,26954,26955,26956,26957,26958,26959,26960,26961,26962,26963,26964,26965,26966,26967,26968,26969,26970,26971,26972,26973,26974,26975,26976,26977,26978,26979,26980,26981,26982,26983,26984,26985,26986,26987,26988,
26989,26990,26991,26992,26993,26994,26995,26996,26997,26998,27037,27038,27039,27040,27120,27200,27205,27206,27207,27208,27209,27210,27211,27212,27213,27214,27215,27216,27217,27218,27219,27220,27221,27222,27223,27224,27225,27226,27227,27228,27229,27230,27231,27232,27258,27259,27260,27291,27292,27391,27392,27393,27394,27395,27396,27397,27398,27429,27492,27493,27500,27561,27562,27563,27564,27571,27572,27573,27574,27581,27582,27583,27584,27591,27592,27593,27594,27700,28191,28192,28193,28232,28348,28349,
28350,28351,28352,28353,28354,28355,28356,28357,28358,28402,28403,28404,28405,28406,28407,28408,28409,28410,28411,28412,28413,28414,28415,28416,28417,28418,28419,28420,28421,28422,28423,28424,28425,28426,28427,28428,28429,28430,28431,28432,28462,28463,28464,28465,28466,28467,28468,28469,28470,28471,28472,28473,28474,28475,28476,28477,28478,28479,28480,28481,28482,28483,28484,28485,28486,28487,28488,28489,28490,28491,28492,28600,28991,28992,29100,29101,29118,29119,29120,29121,29122,29168,29169,29170,
29171,29172,29177,29178,29179,29180,29181,29182,29183,29184,29185,29187,29188,29189,29190,29191,29192,29193,29194,29195,29220,29221,29333,29635,29636,29701,29738,29739,29849,29850,29871,29872,29873,29900,29901,29902,29903,30161,30162,30163,30164,30165,30166,30167,30168,30169,30170,30171,30172,30173,30174,30175,30176,30177,30178,30179,30200,30339,30340,30491,30492,30493,30494,30591,30592,30729,30730,30731,30732,30791,30792,30800,31028,31121,31154,31170,31171,31251,31252,31253,31254,31255,31256,31257,
31258,31259,31265,31266,31267,31268,31275,31276,31277,31278,31279,31281,31282,31283,31284,31285,31286,31287,31288,31289,31290,31291,31292,31293,31294,31295,31296,31297,31370,31461,31462,31463,31464,31465,31466,31467,31468,31469,31491,31492,31493,31494,31495,31528,31529,31600,31700,31838,31839,31900,31901,31917,31918,31919,31920,31921,31922,31965,31966,31967,31968,31969,31970,31971,31972,31973,31974,31975,31976,31977,31978,31979,31980,31981,31982,31983,31984,31985,31986,31987,31988,31989,31990,31991,
31992,31993,31994,31995,31996,31997,31998,31999,32E3,32001,32002,32003,32005,32006,32007,32008,32009,32010,32011,32012,32013,32014,32015,32016,32017,32018,32019,32020,32021,32022,32023,32024,32025,32026,32027,32028,32029,32030,32031,32033,32034,32035,32036,32037,32038,32039,32040,32041,32042,32043,32044,32045,32046,32047,32048,32049,32050,32051,32052,32053,32054,32055,32056,32057,32058,32059,32060,32061,32062,32064,32065,32066,32067,32074,32075,32076,32077,32081,32082,32083,32084,32085,32086,32098,
32099,32100,32104,32107,32108,32109,32110,32111,32112,32113,32114,32115,32116,32117,32118,32119,32120,32121,32122,32123,32124,32125,32126,32127,32128,32129,32130,32133,32134,32135,32136,32137,32138,32139,32140,32141,32142,32143,32144,32145,32146,32147,32148,32149,32150,32151,32152,32153,32154,32155,32156,32157,32158,32161,32164,32165,32166,32167,32180,32181,32182,32183,32184,32185,32186,32187,32188,32189,32190,32191,32192,32193,32194,32195,32196,32197,32198,32199,32201,32202,32203,32204,32205,32206,
32207,32208,32209,32210,32211,32212,32213,32214,32215,32216,32217,32218,32219,32220,32221,32222,32223,32224,32225,32226,32227,32228,32229,32230,32231,32232,32233,32234,32235,32236,32237,32238,32239,32240,32241,32242,32243,32244,32245,32246,32247,32248,32249,32250,32251,32252,32253,32254,32255,32256,32257,32258,32259,32260,32301,32302,32303,32304,32305,32306,32307,32308,32309,32310,32311,32312,32313,32314,32315,32316,32317,32318,32319,32320,32321,32322,32323,32324,32325,32326,32327,32328,32329,32330,
32331,32332,32333,32334,32335,32336,32337,32338,32339,32340,32341,32342,32343,32344,32345,32346,32347,32348,32349,32350,32351,32352,32353,32354,32355,32356,32357,32358,32359,32360,32601,32602,32603,32604,32605,32606,32607,32608,32609,32610,32611,32612,32613,32614,32615,32616,32617,32618,32619,32620,32621,32622,32623,32624,32625,32626,32627,32628,32629,32630,32631,32632,32633,32634,32635,32636,32637,32638,32639,32640,32641,32642,32643,32644,32645,32646,32647,32648,32649,32650,32651,32652,32653,32654,
32655,32656,32657,32658,32659,32660,32661,32662,32664,32665,32666,32667,32701,32702,32703,32704,32705,32706,32707,32708,32709,32710,32711,32712,32713,32714,32715,32716,32717,32718,32719,32720,32721,32722,32723,32724,32725,32726,32727,32728,32729,32730,32731,32732,32733,32734,32735,32736,32737,32738,32739,32740,32741,32742,32743,32744,32745,32746,32747,32748,32749,32750,32751,32752,32753,32754,32755,32756,32757,32758,32759,32760,32761,32766,53001,53002,53003,53004,53008,53009,53010,53011,53012,53013,
53014,53015,53016,53017,53018,53019,53021,53022,53023,53024,53025,53026,53027,53028,53029,53030,53031,53032,53034,53042,53043,53044,53045,53046,53048,53049,53074,53075,53076,53077,53078,53079,53080,54001,54002,54003,54004,54008,54009,54010,54011,54012,54013,54014,54015,54016,54017,54018,54019,54021,54022,54023,54024,54025,54026,54027,54028,54029,54030,54031,54032,54034,54042,54043,54044,54045,54046,54048,54049,54050,54051,54052,54053,54074,54075,54076,54077,54078,54079,54080,65061,65062,65161,65163,
102001,102002,102003,102004,102005,102006,102007,102008,102009,102010,102011,102012,102013,102014,102015,102016,102017,102018,102019,102020,102021,102022,102023,102024,102025,102026,102027,102028,102029,102030,102031,102032,102033,102034,102035,102036,102037,102038,102039,102040,102041,102042,102043,102044,102045,102046,102047,102048,102049,102050,102051,102052,102053,102054,102055,102056,102057,102058,102059,102060,102061,102062,102063,102064,102065,102066,102067,102068,102069,102070,102071,102072,
102073,102074,102075,102076,102077,102078,102079,102080,102081,102082,102083,102084,102085,102086,102087,102088,102089,102090,102091,102092,102093,102094,102095,102096,102097,102098,102099,102100,102101,102102,102103,102104,102105,102106,102107,102108,102109,102110,102111,102112,102113,102114,102115,102116,102117,102118,102119,102120,102121,102122,102123,102124,102125,102126,102127,102128,102129,102130,102131,102132,102133,102134,102135,102136,102137,102138,102139,102140,102141,102142,102143,102144,
102145,102146,102147,102148,102149,102150,102151,102152,102153,102154,102155,102156,102157,102158,102159,102160,102161,102162,102163,102164,102165,102166,102167,102168,102169,102170,102171,102172,102173,102174,102175,102176,102177,102178,102179,102180,102181,102182,102183,102184,102185,102186,102187,102188,102189,102190,102191,102192,102193,102194,102195,102196,102197,102198,102199,102200,102201,102202,102203,102204,102205,102206,102207,102208,102209,102210,102211,102212,102213,102214,102215,102216,
102217,102218,102219,102220,102221,102222,102223,102224,102225,102226,102227,102228,102229,102230,102231,102232,102233,102234,102235,102236,102237,102238,102239,102240,102241,102242,102243,102244,102245,102246,102247,102248,102249,102250,102251,102252,102253,102254,102255,102256,102257,102258,102259,102260,102261,102262,102263,102264,102265,102266,102267,102268,102269,102270,102271,102272,102273,102274,102275,102276,102277,102278,102279,102280,102281,102282,102283,102284,102285,102286,102287,102288,
102289,102290,102291,102292,102293,102294,102295,102296,102297,102298,102299,102300,102301,102302,102303,102304,102305,102306,102307,102308,102309,102310,102311,102312,102313,102314,102315,102316,102317,102318,102319,102320,102321,102322,102323,102324,102325,102326,102327,102328,102329,102330,102331,102332,102333,102334,102335,102336,102337,102338,102339,102340,102341,102342,102343,102344,102345,102346,102347,102348,102349,102350,102351,102352,102353,102354,102355,102356,102357,102358,102359,102360,
102361,102362,102363,102364,102365,102366,102367,102368,102369,102370,102371,102372,102373,102374,102375,102376,102377,102378,102379,102380,102381,102382,102383,102384,102385,102386,102387,102388,102389,102390,102391,102392,102393,102394,102395,102396,102397,102398,102399,102400,102401,102402,102403,102404,102405,102406,102407,102408,102409,102410,102411,102412,102413,102414,102415,102416,102417,102418,102419,102420,102421,102422,102423,102424,102425,102426,102427,102428,102429,102430,102431,102432,
102433,102434,102435,102436,102437,102438,102439,102440,102441,102442,102443,102444,102445,102446,102447,102448,102449,102450,102451,102452,102453,102454,102455,102456,102457,102458,102459,102460,102461,102462,102463,102464,102465,102466,102467,102468,102469,102470,102471,102472,102473,102474,102475,102476,102477,102478,102479,102480,102481,102482,102483,102484,102485,102486,102487,102488,102489,102490,102491,102492,102493,102494,102495,102496,102500,102501,102502,102503,102504,102505,102506,102507,
102508,102509,102510,102511,102512,102513,102514,102515,102516,102517,102518,102519,102520,102521,102522,102523,102524,102525,102526,102527,102528,102529,102530,102531,102532,102533,102534,102535,102536,102537,102538,102539,102540,102541,102542,102543,102544,102545,102546,102547,102548,102549,102550,102551,102552,102553,102554,102555,102556,102557,102558,102559,102560,102561,102570,102571,102572,102573,102574,102575,102576,102577,102578,102579,102580,102581,102582,102583,102584,102585,102586,102587,
102588,102589,102590,102591,102592,102593,102594,102595,102596,102597,102598,102599,102600,102601,102602,102603,102604,102605,102606,102607,102608,102609,102610,102611,102612,102613,102614,102615,102616,102617,102618,102619,102620,102621,102622,102623,102624,102625,102626,102627,102628,102629,102630,102631,102632,102633,102634,102635,102636,102637,102638,102639,102640,102641,102642,102643,102644,102645,102646,102647,102648,102649,102650,102651,102652,102653,102654,102655,102656,102657,102658,102659,
102660,102661,102662,102663,102664,102665,102666,102667,102668,102669,102670,102671,102672,102673,102674,102675,102676,102677,102678,102679,102680,102681,102682,102683,102684,102685,102686,102687,102688,102689,102690,102691,102692,102693,102694,102695,102696,102697,102698,102699,102700,102701,102702,102703,102704,102705,102706,102707,102708,102709,102710,102711,102712,102713,102714,102715,102716,102717,102718,102719,102720,102721,102722,102723,102724,102725,102726,102727,102728,102729,102730,102733,
102734,102735,102736,102737,102738,102739,102740,102741,102742,102743,102744,102745,102746,102747,102748,102749,102750,102751,102752,102753,102754,102755,102756,102757,102758,102761,102762,102763,102764,102765,102766,102767,102768,102769,102770,102771,102772,102773,102774,102775,102776,102777,102778,102779,102780,102781,102782,102783,102784,102785,102786,102787,102788,102789,102790,102791,102792,102793,102794,102795,102796,102797,102798,102962,102963,102965,102966,102967,102968,102969,102970,102971,
102972,102973,102974,102975,102976,102977,102978,102979,102980,102981,102982,102983,102984,102985,102986,102987,102988,102989,102990,102991,102992,102993,102994,102995,102996,102997,102998,102999,103E3,103001,103002,103003,103004,103005,103006,103007,103008,103009,103010,103011,103012,103013,103014,103015,103016,103017,103018,103019,103020,103021,103022,103023,103024,103025,103026,103027,103028,103029,103030,103031,103032,103033,103034,103035,103036,103037,103038,103039,103040,103041,103042,103043,
103044,103045,103046,103047,103048,103049,103050,103051,103052,103053,103054,103055,103056,103057,103058,103059,103060,103061,103062,103063,103064,103065,103066,103067,103068,103069,103070,103071,103072,103073,103074,103075,103076,103077,103078,103079,103080,103081,103082,103083,103084,103085,103086,103087,103088,103089,103090,103091,103092,103093,103094,103095,103096,103097,103098,103099,103100,103101,103102,103103,103104,103105,103106,103107,103108,103109,103110,103111,103112,103113,103114,103115,
103116,103117,103118,103119,103120,103121,103122,103123,103124,103125,103126,103127,103128,103129,103130,103131,103132,103133,103134,103135,103136,103137,103138,103139,103140,103141,103142,103143,103144,103145,103146,103147,103148,103149,103150,103151,103152,103153,103154,103155,103156,103157,103158,103159,103160,103161,103162,103163,103164,103165,103166,103167,103168,103169,103170,103171,103172,103173,103174,103175,103176,103177,103178,103179,103180,103181,103182,103183,103184,103185,103186,103187,
103188,103189,103190,103191,103192,103193,103194,103195,103196,103197,103198,103199,103200,103201,103202,103203,103204,103205,103206,103207,103208,103209,103210,103211,103212,103213,103214,103215,103216,103217,103218,103219,103220,103221,103222,103223,103224,103225,103226,103227,103228,103229,103230,103231,103232,103233,103234,103235,103236,103237,103238,103239,103240,103241,103242,103243,103244,103245,103246,103247,103248,103249,103250,103251,103252,103253,103254,103255,103256,103257,103258,103259,
103260,103261,103262,103263,103264,103265,103266,103267,103268,103269,103270,103271,103272,103273,103274,103275,103276,103277,103278,103279,103280,103281,103282,103283,103284,103285,103286,103287,103288,103289,103290,103291,103292,103293,103294,103295,103296,103297,103298,103299,103300,103301,103302,103303,103304,103305,103306,103307,103308,103309,103310,103311,103312,103313,103314,103315,103316,103317,103318,103319,103320,103321,103322,103323,103324,103325,103326,103327,103328,103329,103330,103331,
103332,103333,103334,103335,103336,103337,103338,103339,103340,103341,103342,103343,103344,103345,103346,103347,103348,103349,103350,103351,103352,103353,103354,103355,103356,103357,103358,103359,103360,103361,103362,103363,103364,103365,103366,103367,103368,103369,103370,103371,103372,103373,103374,103375,103376,103377,103378,103379,103380,103381,103382,103383,103384,103385,103386,103387,103388,103389,103390,103391,103392,103393,103394,103395,103396,103397,103398,103399,103400,103401,103402,103403,
103404,103405,103406,103407,103408,103409,103410,103411,103412,103413,103414,103415,103416,103417,103418,103419,103420,103421,103422,103423,103424,103425,103426,103427,103428,103429,103430,103431,103432,103433,103434,103435,103436,103437,103438,103439,103440,103441,103442,103443,103444,103445,103446,103447,103448,103449,103450,103451,103452,103453,103454,103455,103456,103457,103458,103459,103460,103461,103462,103463,103464,103465,103466,103467,103468,103469,103470,103471,103472,103473,103474,103475,
103476,103477,103478,103479,103480,103481,103482,103483,103484,103485,103486,103487,103488,103489,103490,103491,103492,103493,103494,103495,103496,103497,103498,103499,103500,103501,103502,103503,103504,103505,103506,103507,103508,103509,103510,103511,103512,103513,103514,103515,103516,103517,103518,103519,103520,103521,103522,103523,103524,103525,103526,103527,103528,103529,103530,103531,103532,103533,103534,103535,103536,103537,103538,103539,103540,103541,103542,103543,103544,103545,103546,103547,
103548,103549,103550,103551,103552,103553,103554,103555,103556,103557,103558,103559,103560,103561,103562,103563,103564,103565,103566,103567,103568,103569,103570,103571,103572,103573,103574,103575,103576,103577,103578,103579,103580,103581,103582,103583,103584,103585,103600,103601,103602,103603,103604,103605,103606,103607,103608,103609,103610,103611,103612,103613,103614,103615,103616,103617,103618,103619,103620,103621,103622,103623,103624,103625,103626,103627,103628,103629,103630,103631,103632,103633,
103634,103635,103636,103637,103638,103639,103640,103641,103642,103643,103644,103645,103646,103647,103648,103649,103650,103651,103652,103653,103654,103655,103656,103657,103658,103659,103660,103661,103662,103663,103664,103665,103666,103667,103668,103669,103670,103671,103672,103673,103674,103675,103676,103677,103678,103679,103680,103681,103682,103683,103684,103685,103686,103687,103688,103689,103690,103691,103692,103693,103694,103695,103700,103701,103702,103703,103704,103705,103706,103707,103708,103709,
103710,103711,103712,103713,103714,103715,103716,103717,103718,103719,103720,103721,103722,103723,103724,103725,103726,103727,103728,103729,103730,103731,103732,103733,103734,103735,103736,103737,103738,103739,103740,103741,103742,103743,103744,103745,103746,103747,103748,103749,103750,103751,103752,103753,103754,103755,103756,103757,103758,103759,103760,103761,103762,103763,103764,103765,103766,103767,103768,103769,103770,103771,103772,103773,103774,103775,103776,103777,103778,103779,103780,103781,
103782,103783,103784,103785,103786,103787,103788,103789,103790,103791,103792,103793,103794,103795,103796,103797,103798,103799,103800,103801,103802,103803,103804,103805,103806,103807,103808,103809,103810,103811,103812,103813,103814,103815,103816,103817,103818,103819,103820,103821,103822,103823,103824,103825,103826,103827,103828,103829,103830,103831,103832,103833,103834,103835,103836,103837,103838,103839,103840,103841,103842,103843,103844,103845,103846,103847,103848,103849,103850,103851,103852,103853,
103854,103855,103856,103857,103858,103859,103860,103861,103862,103863,103864,103865,103866,103867,103868,103869,103870,103871,103900,103901,103902,103903,103904,103905,103906,103907,103908,103909,103910,103911,103912,103913,103914,103915,103916,103917,103918,103919,103920,103921,103922,103923,103924,103925,103926,103927,103928,103929,103930,103931,103932,103933,103934,103935,103936,103937,103938,103939,103940,103941,103942,103943,103944,103945,103946,103947,103948,103949,103950,103951,103952,103953,
103954,103955,103956,103957,103958,103959,103960,103961,103962,103963,103964,103965,103966,103967,103968,103969,103970,103971];m("extend-esri")&&H.setObject("dijit.analysis.PCSList",r,n);return r})},"esri/layers/RasterXLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Deferred dojo/sniff dojo/dom-construct dojo/dom-style dojo/on dojox/gfx/matrix dojo/when dojo/DeferredList ../kernel ../config ../lang ../domUtils ../urlUtils ../graphic ../request ../renderers/ClassBreaksRenderer ../renderers/StretchRenderer ../renderers/UniqueValueRenderer ../renderers/ColormapRenderer ../renderers/ShadedReliefRenderer ../geometry/Extent ../SpatialReference ../geometry/Point ./Field ./TimeInfo ./MosaicRule ./DimensionalDefinition ./PixelBlock ./ImageServiceLayerMixin ./rasterLib/function/StretchFunction ./rasterLib/raster/rasterFactory ./rasterLib/raster/rasterProjectionHelper ./rasterLib/renderer/rasterRendererHelper ./rasterLib/tile/RasterTileInfo ./rasterLib/tile/RasterTileManager ./rasterLib/tile/RasterHandler ./layer".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da){var Q=g.defaults.map.zoomDuration;H=H([da],{declaredClass:"esri.layers.RasterXLayer",managedSuspension:!0,opacity:1,tileMode:!0,useWebGL:!0,drawMode:!0,_eventMap:{"raster-change":!0,"renderer-change":!0},_lastPopup:[],_rasterFieldPrefix:"Raster.",_cachedVariableStats:{},_cachedVariableHistogram:{},constructor:function(K,E){E=E||{};this.tileMode=null!=E.tileMode?E.tileMode:this.tileMode;this.useWebGL=
null!=E.useWebGL?E.useWebGL:this.useWebGL;this.roaming=null!=E.roaming?E.roaming:this.roaming;this.drawMode=null!=E.drawMode?E.drawMode:this.drawMode;this.bandIds=E.bandIds&&0<E.bandIds.length?E.bandIds:null;this.renderer=E.renderer;this._customModules=E.customModules;this.useMapTime=null!=E.useMapTime?E.useMapTime:!0;if(E.multidimensionalDefinition&&0<E.multidimensionalDefinition.length){var N=new L;N.multidimensionalDefinition=E.multidimensionalDefinition.map(function(I){return I.toJson?I:new R(I)});
N.method=L.METHOD_NONE;this.mosaicRule=N}this.infoTemplate=E.infoTemplate;this.drawMode||(this._contextType=E._contextType||E.drawType);this._supportLegacyPropMethods=!1!==E.legacySupport;this._rasterHandler=new X({customModules:this._customModules});this._workInitPromise=this._rasterHandler.start();this.pixelData=null;this._initialize(K,E);d(this,"load",m.hitch(this,function(){e(this._rasterHandler._connected||this._rasterHandler._connectionPromise,m.hitch(this,function(){this._rasterHandler.setLayer({layerId:this.id,
raster:{rasterInfo:this.raster.rasterInfo,rasterFunction:this.raster.rasterFunction&&this.raster.rasterFunction.toJson()},bandCount:this.raster.rasterInfo.bandCount});this.raster.rasterFunction&&this._rasterHandler.setRasterFunction({layerId:this.id,data:this.raster.rasterFunction.toJson(!0)});this._rasterRenderer&&this._rasterHandler.setRasterRenderer({layerId:this.id,data:this._rasterRenderer.toJson(!0)})}))}));this._animatePan2d=m.hitch(this,this._animatePan2d)},setOpacity:function(K){this.opacity!==
K&&(this.opacity=K,this.onOpacityChange(K))},onOpacityChange:function(){},onRendererChange:function(){},refresh:function(){if(this.loaded&&this._map)if(!this._canDraw()||10>k("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else this._map&&this._extentChangeHandler(this._map.extent)},clear:function(K,E,N,I){this._canDraw()&&(this.useWebGL||(N?this._context.clearRect(K,E,N,I):this._context.clearRect(0,0,this._map.width,this._map.height)))},getContext:function(){return this._context},
onResume:function(){this.inherited(arguments);this._toggleTime();q.show(this._div);if("css-transforms"===this._map.navigationMode){var K=this._map.__visibleDelta;this._left=this._tdx=K.x;this._top=this._tdy=K.y;a.set(this._div,c._css.names.transform,c._css.translate(this._left,this._top))}this._displayTimer=this._displayTimer||setTimeout(m.hitch(this,function(){this._extentChangeHandler(this._map.extent,null,!0)}),0)},onSuspend:function(){this.inherited(arguments);this._fireUpdateEnd();this._toggleTime();
q.hide(this._div);clearTimeout(this._displayTimer);this._displayTimer=null},redraw:function(){this.useWebGL&&this._glSetting&&(this._glSetting.hasNewTexture=!1);var K=this.tileMode?this.tileManager.originalPixelData:this.originalPixelData;if(this.tileMode?K&&(K.src||K.texture):K)if(this.tileMode)if(this.useWebGL)this._updateAllTilesOnce(K);else{this.tileManager.tiles.forEach(function(N){N&&(N.update=null,N.completed=!1,N.processedPixelBlock=null,N.renderedPixelBlock=null)});K.processedPixelBlock=
null;var E=this.raster.rasterFunction?this.raster.rasterFunction.read(K):{extent:K.extent,pixelBlock:K.src[this.tileManager.identifiers[0]]&&K.src[this.tileManager.identifiers[0]].pixelBlock};K.renderedPixelBlock=null;K=this._rasterRenderer?this._rasterRenderer.draw(E):E;this._drawOneFrame(K)}else this._supportLegacyPropMethods&&this.pixelFilter?this._setPixelData(this.originalPixelData):(K.processedPixelBlock=null,E=this.raster.rasterFunction?this.raster.rasterFunction.read(K):{extent:K.extent,pixelBlock:K.src?
K.src[this.tileManager.identifiers[0]]&&K.src[this.tileManager.identifiers[0]].pixelBlock:K.pixelBlock},K.renderedPixelBlock=null,K=this._rasterRenderer?this._rasterRenderer.draw(E):E,this._drawOneFrame(K))},getCurrentResolution:function(){var K=this._map.extent;return new z((K.xmax-K.xmin)/this._map.width,(K.ymax-K.ymin)/this._map.height,K.spatialReference)},getCustomRasterFields:function(K){var E=K?K.rasterAttributeTableFieldPrefix:this._rasterFieldPrefix,N={name:this._rasterFieldPrefix+"ServicePixelValue",
alias:"Pixel Value",domain:null,editable:!1,length:50,type:10.3<=this.version?"esriFieldTypeDouble":"esriFieldTypeString"};K=this.fields?m.clone(this.fields):[];K.push(N);(N=this.rasterAttributeTable&&this.rasterAttributeTable.fields)&&0<N.length&&(N=r.filter(N,function(I){return"esriFieldTypeOID"!==I.type&&"value"!==I.name.toLowerCase()}),N=r.map(N,function(I){var O=m.clone(I);O.name=E+I.name;return O}),K=K.concat(N));return K},setRenderer:function(K,E){if(this.loaded&&K){if(K.declaredClass&&-1<
K.declaredClass.indexOf("esri.layers.rasterLib")){this._rasterRenderer=K;this._rasterRenderer.bind({layer:this});var N=this.bandIds=K.bandIndex;this.raster&&this.raster.setFetchParameters({bandIds:N});this._params&&(this._params.bandIds=N&&0<N.length?N.join(","):null);this.renderer=this._getCommonRenderer(K)}else N=m.clone(K.toJson?K.toJson():K),"rasterStretch"===N.type&&(N.bandIndex=this.bandIds,N.bandIndex&&1<N.bandIndex.length||!N.bandIndex&&this.raster&&1<this.raster.rasterInfo.bandCount)&&(N.type=
"rgb"),this._rasterRenderer=oa.create(N),this.renderer=K.declaredClass?K:this._getCommonRenderer(this._rasterRenderer),this._rasterRenderer.bind({layer:this});if(this._map){if(this.loaded&&this._rasterHandler._connected){var I=this._rasterHandler.setRasterRenderer({layerId:this.id,data:this._rasterRenderer.toJson(!0)});this._updateTilingEffects()}E||(I?I.then(m.hitch(this,function(){this.redraw()})):this.redraw());this.onRendererChange()}}},setBandIds:function(K,E){this.bandIds=K;this.raster&&this.raster.setFetchParameters({bandIds:K});
this._params&&(this._params.bandIds=K&&0<K.length?K.join(","):null);this.setRenderer(this.renderer,E)},_setTime:function(K){K=K?K.toJson():null;this._params&&(this._params.time=K);this.raster.setFetchParameters({time:K});this.tileManager&&this.tileManager.tiles&&this.tileManager.resetTiles()},setInfoTemplate:function(K){this.infoTemplate=K;this._updateInfoTemplateFields(this.fields)},setMultiDimensionalDefinition:function(K,E){var N=K&&K.multidimensionalDefinition;if(N&&this.loaded){var I=N&&N[0].variableName;
""===I&&(I=this._multidimensionalInfo.variables[0].name,N.forEach(function(U){U.variableName=I}));if("ImageService"===this.raster.sourceType){var O=this.raster._getAllDimensionDefinition(N,I);O.defChanged&&(K.multidimensionalDefinition=O.definition,this.setMosaicRule(K,!0))}this.raster.setFetchParameters({multidimensionalDefinition:N});this.tileManager&&this.tileManager.tiles&&this.tileManager.resetTiles();I&&this._updateRasterInfo(I);E||this.refresh()}},_updateRasterInfo:function(K){var E=this.raster.rasterInfo,
N=this.getHistograms({variableName:K});K=this.getStatistics(K);(new h([N,K])).then(m.hitch(this,function(I){I[0][0]&&(E.histograms=I[0][1].histograms);I[1][0]&&(E.statistics=I[1][1]);this.refresh()}))},_updateInfoTemplateFields:function(K){if(K&&!(1>K.length)&&this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.fieldInfos&&!(1>this.infoTemplate.info.fieldInfos.length)){var E,N;var I=this.infoTemplate.info.fieldInfos;for(E=0;E<K.length;E++){var O=K[E];for(N=0;N<I.length;N++)if(I[N].fieldName.toLowerCase()===
O.name.toLowerCase()&&I[N].fieldName!==O.name){I[N].fieldName=O.name;break}}}},getPixelData:function(K){return this.tileMode?K?this.tileManager&&this.tileManager.originalPixelData&&this.tileManager.originalPixelData.src&&this.tileManager.originalPixelData.src[this.tileManager.identifiers[0]]:null:this.inherited(arguments)},fetchPopupFromTiles:function(K){var E=new l;this.identify(K.geometry).then(function(N){var I=N.pixelValue;this.hasStdTime()&&I&&I.length&&null!=I[0]&&(I=I.map(function(ha){return this.getStdTimeValue(ha)}.bind(this)).join(", "));
if(I){N={ObjectId:0,"Raster.ServicePixelValue":I};var O=this.rasterAttributeTable&&this.rasterAttributeTable.features;if(O&&0<O.length&&(O=r.filter(O,function(ha){if(ha&&ha.attributes)return ha.attributes.hasOwnProperty("Value")?ha.attributes.Value==I:ha.attributes.VALUE==I}),0<O.length&&(O=m.clone(O[0]))))for(var U in O.attributes)O.attributes.hasOwnProperty(U)&&(N[this._rasterFieldPrefix+U]=O.attributes[U]);U=new v(new w(this.projectedFullExtent||this.fullExtent),null,N);U.setInfoTemplate(this.infoTemplate);
U._layer=this;this._lastPopup=[U];E.resolve([U])}else this._lastPopup=[],E.resolve()}.bind(this),function(N){this._lastPopup=[];E.resolve(N)});return E},getPopupFromTiles:function(){return this._lastPopup},identify:function(K,E){return this.raster?this.raster.identify(K):(K=new l,K.reject("layer must be initialized to identify"),K.promise)},_getCommonRenderer:function(K){switch(K.rendererName){case "RGB":case "Stretch":return new C(K.toCommonRendererJson());case "UniqueValue":return new B(K.toCommonRendererJson());
case "ClassBreaks":return new y(K.toCommonRendererJson());case "Colormap":return new F(K.toCommonRendererJson());case "ShadedRelief":return new x(K.toCommonRendererJson())}},_getProjectedFullExtent:function(K){return this.raster.getProjectedFullExtent(K).then(m.hitch(this,function(E){this.projectedFullExtent=E}))},_initialize:function(K,E){E=E||{};this._supportLegacyPropMethods&&this.constructor._onMap&&(this.constructor._onMap["rendering-change"]={method:"onRenderingChange"},this.constructor._onMap["mosaic-rule-change"]=
{method:"onMosaicRuleChange"},this.constructor._onMap["spatial-reference-change"]={method:"onSpatialReferenceChange"});this.raster={};var N=E.raster?E.raster.url:K;N&&-1<N.toLowerCase().indexOf("/imageserver")&&this._supportLegacyPropMethods&&this._addLegacySupport(N,E);var I=m.hitch(this,function(){this.loaded=!0;this.mosaicRule&&this.mosaicRule.multidimensionalDefinition&&0<this.mosaicRule.multidimensionalDefinition.length&&this.setMultiDimensionalDefinition(this.mosaicRule,!0);this.raster._setRasterHandler(this._rasterHandler);
this.onLoad(this);var O=this._loadCallback;O&&(delete this._loadCallback,O(this))});(K?ba.create(m.mixin({url:K},E)):E.raster&&E.raster.open()).then(m.hitch(this,function(O){if(O){this.raster=O;var U=this._getSourceImageServiceRaster();this.url||(this.url=U&&U.url);this.url&&(this._url=u.urlToObject(K));var ha=E.minScale,ia=E.maxScale,S=O.tileInfo&&"Raster"===O.tileInfo.tileType;null==ia&&(ia=S&&E.zoomFactor?O.tileInfo.lods[O.tileInfo.lods.length-1].scale/E.zoomFactor:this.maxScale);null==ha&&(ha=
S&&E.zoomFactor?O.tileInfo.lods[0].scale*E.zoomFactor:this.minScale);U&&"ImageService"===U.sourceType&&this._supportLegacyPropMethods&&this._addGeneralProperties(K,E);this.initialExtent=this.fullExtent=this.extent=this.raster.rasterInfo.extent;this.spatialReference=this.extent.spatialReference;this.timeInfo=this.raster.rasterInfo.timeInfo?new J(this.raster.rasterInfo.timeInfo):null;this.rasterAttributeTable=this.raster.rasterInfo.vat;this._multidimensionalInfo=this.raster.rasterInfo.multidimensionalInfo;
this.rasterAttributeTable&&(this._rasterAttributeTableFields=this.rasterAttributeTable.fields);this.mosaicRule&&this.raster.setFetchParameters({multidimensionalDefinition:this.mosaicRule.multidimensionalDefinition});this._multidimensionalInfo&&(this._getDefaultMultidimensionalDefinition(this._multidimensionalInfo,!0,!0),this.mosaicRule||(this.mosaicRule=this.defaultMosaicRule,this.raster.setFetchParameters({multidimensionalDefinition:this._defaultMultidimensionalDefinition})),this.raster.defaultMultidimensionalDefinition=
this._defaultMultidimensionalDefinition);null==ha||this._hasMin||this.setMinScale(ha);null==ia||this._hasMax||this.setMaxScale(ia);this._workInitPromise?this._workInitPromise.then(I,I):I()}else console.error("cannot create rasterx layer as the raster data source cannot be opened")}),this._errorHandler)},_getSourceImageServiceRaster:function(){var K=this.raster&&"Function"===this.raster.sourceType?1===this.raster.getMemberRasters().length?this.raster.getMemberRasters()[0]:null:this.raster;if(K&&"ImageService"===
K.sourceType)return K},_addLegacySupport:function(K,E){this._url=u.urlToObject(K);E=E||{};this.format=(K=E.imageServiceParameters)&&K.format;this.compressionTolerance=K&&K.compressionTolerance?K.compressionTolerance:.01;this.interpolation=K?K.interpolation:null;this.compressionQuality=K?K.compressionQuality:null;this.bandIds=K&&K.bandIds||E&&E.bandIds||null;this.mosaicRule||(this.mosaicRule=K?K.mosaicRule:null);this.renderingRule||(this.renderingRule=K?K.renderingRule:null);this.useMapDimensionValue=
E.hasOwnProperty("useMapDimensionValue")?!!E.useMapDimensionValue:!0;this.hasImageFilter=E.hasImageFilter;this.activeMapDimensions=E.activeMapDimensions;this._params=m.mixin({},this._url.query,{f:"image",interpolation:this.interpolation,format:this.format,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null},K?K.toJson():{});this.pixelFilter=E.pixelFilter;this.originalPixelData=this.pixelData=null;this._queryVisibleRastersHandler=m.hitch(this,this._queryVisibleRastersHandler);
this._useRenderingRuleAttributeTable=!1;this._rasterFunctionTemplateInfos={};this._customRenderingRuleId={};this._setDefaultFilter=function(){};var N={setInterpolation:"interpolation",setCompressionQuality:"compressionQuality",setCompressionTolerance:"compressionTolerance",setBandIds:"bandIds",setDefaultBandIds:"bandIds",setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setImageFormat:"format"},I,O=new aa;Object.keys(N).forEach(m.hitch(this,function(U){this[U]=m.hitch(this,function(ha,ia){I=
{};I[N[U]]=ha;this.raster&&(this.raster.setFetchParameters(I),O[U].bind(this)(ha,ia))})}));this.setDisableClientCaching=function(U){O.setDisableClientCaching.bind(this)(U);var ha=this._getSourceImageServiceRaster();ha?ha.disableClientCaching=U:null}.bind(this);this.setDefinitionExpression=O.setDefinitionExpression.bind(this);this.setUseMapTime=O.setUseMapTime.bind(this);this._toggleTime=O._toggleTime.bind(this);this._onTimeExtentChangeHandler=O._onTimeExtentChangeHandler.bind(this);this.setPixelFilter=
O.setPixelFilter.bind(this);this.getHistograms=O.getHistograms.bind(this);this.getRasterFunctionInfos=O.getRasterFunctionInfos.bind(this);this.getKeyProperties=O.getKeyProperties.bind(this);this.getRasterAttributeTable=O.getRasterAttributeTable.bind(this);this.getRenderingRuleServiceInfo=O.getRenderingRuleServiceInfo.bind(this);this._getRenderingRuleId=O._getRenderingRuleId.bind(this);this._isRenderingRuleAProcessingTemplate=O._isRenderingRuleAProcessingTemplate.bind(this);this.handleSpatialReferenceChange=
O.handleSpatialReferenceChange.bind(this);this.onRenderingChange=this.onRenderingChange||function(){};this.onSpatialReferenceChange=this.onSpatialReferenceChange||function(){};this.onMosaicRuleChange=this.onMosaicRuleChange||function(U){};this.setRasterRenderer=this.setRenderer;this.getMultidimensionalInfo=O.getMultidimensionalInfo.bind(this);this.getColormap=O.getColormap.bind(this);this.getRenderingRuleColormap=O.getRenderingRuleColormap.bind(this);this.getDefaultMultidimensionalDefinition=O.getDefaultMultidimensionalDefinition.bind(this);
this._getDefaultMultidimensionalDefinition=O._getDefaultMultidimensionalDefinition.bind(this);this._getDefaultDimensionValue=O._getDefaultDimensionValue.bind(this);this.getStatistics=O.getStatistics.bind(this)},_addGeneralProperties:function(){var K=this._getSourceImageServiceRaster();if(K){var E=["minScale","maxScale","tileInfo"];Object.keys(K.serviceInfo).forEach(function(O){null==this[O]&&-1===E.indexOf(O)&&(this[O]=K.serviceInfo[O])}.bind(this));this.pixelSizeX=parseFloat(this.pixelSizeX);this.pixelSizeY=
parseFloat(this.pixelSizeY);this.bands=K.rasterInfo.statistics;var N,I=[];this.fields=this.fields||[];for(N=0;N<this.fields.length;N++)I.push(new G(this.fields[N]));this.fields=I;this.version=this.currentVersion;this.defaultMosaicRule=K.serviceInfo.defaultMosaicRule}},setDefaultRenderer:function(){if(this.loaded&&this._canvas&&!this.pixelFilter){var K=oa.createDefaultRenderer(this);if(null!=K){var E=this.mosaicRule&&this.mosaicRule.multidimensionalDefinition&&0<this.mosaicRule.multidimensionalDefinition.length;
if(this._multidimensionalInfo&&E&&"Stretch"===K.rendererName){var N=this.mosaicRule.multidimensionalDefinition[0].variableName;(E=this._multidimensionalInfo.variables.filter(function(I){return I.name===N})[0])&&E.histograms&&E.histograms.length&&(K.histograms=E.histograms,6===K.stretchType&&(K.dra=!1));E&&E.statistics&&E.statistics.length&&(K.statistics=E.statistics.map(function(I){return[I.min,I.max,I.mean,I.stddev||I.standardDeviation]}),6!==K.stretchType&&(K.dra=!1))}this.setRenderer(K,!0)}}},
setDefaultInterpolation:function(){if(this.loaded&&this._canvas){var K=this.raster.serviceInfo&&this.raster.serviceInfo.defaultResamplingMethod;if(K)switch(K.toLowerCase()){case "bilinear":this.interpolation="RSP_BilinearInterpolation";break;case "cubic":this.interpolation="RSP_CubicConvolution";break;case "majority":this.interpolation="RSP_Majority";break;case "nearest":this.interpolation="RSP_NearestNeighbor"}else{K=this.raster.dataType&&this.raster.dataType.toLowerCase();var E=!!this.raster.rasterInfo.colormap;
this.raster.rasterInfo.vat||E||"thematic"===K||"StdTime"===K?"RSP_NearestNeighbor":"RSP_BilinearInterpolation"}}},_toggleTime:function(){},_updateTilingEffects:function(){(this._hasTilingEffects=this._rasterRenderer&&this._rasterRenderer.hasTilingEffects()||this.raster&&this.raster.rasterFunction&&this.raster.rasterFunction.hasTilingEffects())&&this._map&&this.tileMode&&this.useWebGL&&this.tileManager&&(this._hasTilingEffects=!1)},_setMap:function(K,E){this.inherited(arguments);K.spatialReference&&
(K.spatialReference.ics||K.spatialReference.icsId)&&(this.roaming=this.useWebGL=this.tileMode=!1);if(this.tileMode){this.virtualTileInfo=new fa(null,{refTileInfo:K.tileInfo,spatialReference:K.spatialReference,extent:this.raster.rasterInfo.extent});var N=this.raster.tileInfo&&(-1<["Elevation","Raster"].indexOf(this.raster.tileInfo.tileType)||3===this.raster.rasterInfo.bandCount&&"U8"===this.raster.rasterInfo.pixelType)?this.raster.tileInfo:this.virtualTileInfo;this._tileParams=this._tileParams||{};
this._tileParams.size=N.cols+","+N.rows;this.tileManager=new M({tileInfo:N,layer:this,mapSR:K.spatialReference})}this._dragOrigin={x:0,y:0};N=this._div=b.create("div",null,E);var I={width:K.width+"px",height:K.height+"px",position:"absolute"};"css-transforms"===K.navigationMode?this.roaming&&this.tileMode&&this.useWebGL||(I[c._css.names.transform]=c._css.translate(K.__visibleDelta.x,K.__visibleDelta.y),this._left=K.__visibleDelta.x,this._top=K.__visibleDelta.y):this._left=this._top=0;a.set(N,I);this._canvas=
b.create("canvas",{width:K.width+"px",height:K.height+"px",style:"position: absolute;"},N);p.isDefined(this.opacity)&&a.set(N,"opacity",this.opacity);this._contextType?(this._context=this._canvas.getContext(this._contextType,null),this.useWebGL=this._context instanceof WebGLRenderingContext):this.useWebGL?(this._context=this._canvas.getContext("webgl",null)||this._canvas.getContext("experimental-webgl",null),this.drawMode=!1):(this._context=this._canvas.getContext("2d"),this.drawMode=!0);this._context||
console.error("Unable to create the context. This browser might not support \x3ccanvas\x3e elements.");this.useWebGL&&(K.acquireWebGLContext(this),this._glSetting={gl:this._context,branchCount:this.raster.rasterFunction?this.raster.rasterFunction.branchCount:0,pingpong:null,branches:null,drawMesh:this._drawMesh,programUniforms:{}});this.raster.rasterFunction&&(this._updateTilingEffects(),this.raster.setProcessingContext({layer:this}));this.setRenderer(this.renderer,!0);this._rasterRenderer||this.setDefaultRenderer();
this.interpolation||this.setDefaultInterpolation();this._mapWidth=K.width;this._mapHeight=K.height;this._connects=[];this._connects.push(n.connect(K,"onPan",this,this._panHandler));this._connects.push(n.connect(K,"onPanEnd",this,this._panEndHandler));"css-transforms"===K.navigationMode?this._connects.push(n.connect(K,"onScale",this,this._onScaleHandler)):(this._connects.push(n.connect(K,"onZoom",this,this._onZoomHandler)),this._connects.push(n.connect(K,"onZoomEnd",this,this._onZoomEndHandler)));
this._connects.push(n.connect(K,"onResize",this,this._onResizeHandler));this._connects.push(n.connect(K,"onExtentChange",this,this._extentChangeHandler));this._connects.push(n.connect(this,"onVisibilityChange",this,this._visibilityChangeHandler));this._connects.push(n.connect(this,"onOpacityChange",this,this._opacityChangeHandler));this._startRect={left:0,top:0,width:K.width,height:K.height};this.evaluateSuspension();if(this.suspended&&!K.loaded)var O=n.connect(K,"onLoad",this,function(){n.disconnect(O);
O=null;this.evaluateSuspension()});return N},_unsetMap:function(K,E){this.useWebGL&&K.releaseWebGLContext(this);r.forEach(this._connects,n.disconnect,this);var N=this._div;N&&(E.removeChild(N),b.destroy(N));this._map=this._canvas=this._context=this.data=this._connects=null;clearTimeout(this._displayTimer);this._displayTimer=null;this.inherited(arguments)},_canDraw:function(){return!!(this._map&&this._canvas&&this._context)},_requestDataErrorHandler:function(K){"CancelError"!==K.name&&(this.clear(),
this.onError(K))},_clonePixelData:function(K){if(null===K||K.texture)return K;var E={};K.extent&&(E.extent=m.clone(K.extent));var N=K.pixelBlock;null!=N&&(E.pixelBlock=N.clone());E.texture=K.texture;return E},_setPixelData:function(K){if(K){K=this._clonePixelData(K);this.pixelFilter&&(this.pixelFilter.filter?(this.pixelFilter.renderTexture=!0,this.pixelFilter.filter(K)):this.pixelFilter(K));this.pixelData=K;if(this._rasterReadPromise&&this._rasterReadPromise.isCanceled())return;this._drawPixelData()}this._rasterReadPromise=
null},_requestData:function(K,E,N){this._rasterReadPromise&&this._rasterReadPromise.cancel();K=m.clone(K)._normalize(!0);this._rasterReadPromise=this.raster.read({extent:K,width:this._map.width,height:this._map.height});this._rasterReadPromise.then(m.hitch(this,function(I){this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this.originalPixelData=I&&I.srcData?{extent:I.extent,src:I.srcData}:I,this.useWebGL&&this._glSetting&&(this._glSetting.hasNewTexture=!0),this._setPixelData(I))}),m.hitch(this,
this._requestDataErrorHandler));return this._rasterReadPromise},_drawPixelData:function(K){a.set(this._canvas,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"});this._startRect={left:0,top:0,width:this._map.width,height:this._map.height};this.drawMode||"css-transforms"!==this._map.navigationMode||(this._tdx=this._left,this._tdy=this._top,this._multiply=null,a.set(this._div,c._css.names.transform,c._css.translate(this._left,this._top)),a.set(this._canvas,c._css.names.transform,
c._css.translate(-this._left,-this._top)),this._dragOrigin={x:0,y:0});this.useWebGL&&this._rasterRenderer&&this._rasterRenderer.draw(this.pixelData);if(this._canDraw()&&this.drawMode&&this.drawMode&&(K=K||this.pixelData)&&K.pixelBlock){var E=this.pixelFilter?this.pixelData:this._rasterRenderer?this._rasterRenderer.draw(K):K;K=E.pixelBlock;var N=this._context,I=N.createImageData(K.width,K.height);I.data.set(K.getAsRGBA());E=E.extent;var O=this._map.extent,U=this.getCurrentResolution(),ha=0,ia=0;Math.abs(E.xmin-
O.xmin)>U.x&&(ha=Math.round((E.xmin-O.xmin)/U.x));Math.abs(O.ymax-E.ymax)>U.y&&(ia=Math.round((O.ymax-E.ymax)/U.y));"css-transforms"===this._map.navigationMode?(this._tdx=this._left,this._tdy=this._top,this._multiply=null,a.set(this._div,c._css.names.transform,c._css.translate(this._left,this._top)),a.set(this._canvas,c._css.names.transform,c._css.translate(-this._left,-this._top))):(a.set(this._div,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}),a.set(this._canvas,
{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}));this._dragOrigin={x:0,y:0};this.tileMode?this.clear(ha,ia,K.width,K.height):this.clear();N.putImageData(I,ha,ia,0,0,K.width,K.height);this._fireUpdateEnd()}},hasStdTime:function(){if(!this.hasMultidimensions||"StdTime"!==this.raster.dataType)return!1;var K=this.mosaicRule&&this.mosaicRule.multidimensionalDefinition;K=K&&K.length?K[0]:this._defaultMultidimensionalDefinition[0];var E=this.raster.rasterInfo.multidimensionalInfo.variables,
N=K?K.variableName:E[0].name;return E.some(function(I){if(I.name===N)return!I.dimensions||0===I.dimensions.length||I.dimensions.some(function(O){return"StdTime"===O.name})})},getStdTimeValue:function(K){return(new Date(864E5*(K-25569))).toString()},computeHistograms:function(K){K=new l;var E=this.getPixelData(!0);if(E&&E.pixelBlock&&E.pixelBlock.pixels&&((new ca({}))._calculateStatisticsHistograms(E),E.pixelBlock.histograms))return K.resolve({histograms:E.pixelBlock.histograms}),K;K.reject();return K},
_animatePan2d:function(){this._oldDelta&&this._delta.x===this._oldDelta.x&&this._delta.y===this._oldDelta.y||(this.tileManager.updateTile(this.tileManager.originalPixelData,!0),this._oldDelta={x:this._delta.x,y:this._delta.y});this._roamingAnimation&&this.tileMode&&this.useWebGL&&(this._roamingAnimation=requestAnimationFrame(this._animatePan2d))},_cancelAnimation:function(){this._animation&&(cancelAnimationFrame(this._animation),this._animation=null)},_updateAllTilesOnce:function(K,E){return this.tileManager.updateTile(K,
!0).then(m.hitch(this,function(N){(this._hasTilingEffects||this.useWebGL||E)&&this._drawOneFrame(N)}))},_drawOneFrame:function(K,E){if(!(this.suspended||!this._map||this.tileMode&&!this._drawTile||(this.tileMode&&this.useWebGL&&this.tileManager.originalPixelData.isEmpty&&this._context.clear(this._context.COLOR_BUFFER_BIT),this.tileMode&&this.useWebGL&&this.tileManager.xformSetting&&this.tileManager.xformSetting.requireProjection&&!this.tileManager.xformSetting.gridConfig))){if(!this._resetCss||this._levelChange)this._levelChange=
!1,this._resetDrawing();if(K&&(K.renderedPixelBlock||K.pixelBlock)&&this._canDraw()&&this.drawMode){E=K.extent;var N=this._map.extent;if(!this._isExtentOutSide(E,N)){var I=K.pixelBlock||K.renderedPixelBlock,O=this._context,U=O.createImageData(I.width,I.height);U.data.set((K.renderedPixelBlock||K.pixelBlock).getAsRGBA());K=this.getCurrentResolution();var ha=0,ia=0;Math.abs(E.xmin-N.xmin)>K.x&&(ha=Math.round((E.xmin-N.xmin)/K.x));Math.abs(N.ymax-E.ymax)>K.y&&(ia=Math.round((N.ymax-E.ymax)/K.y));O.putImageData(U,
ha,ia,0,0,I.width,I.height)}}else this._fireUpdateEnd()}},_isExtentOutSide:function(K,E){return K.xmax<=E.xmin||K.xmin>=E.xmax||K.ymax<=E.ymin||K.ymin>=E.ymax},_resetDrawing:function(){this._resetCss=!0;if(!this.useWebGL)if(this._multiply||this._startRect.width!==this._map.width||this._startRect.height!==this._map.height)this.clear();else{var K=this._context.getImageData(0,0,this._map.width,this._map.height);this.clear();this._context.putImageData(K,this._startRect.left,this._startRect.top)}this._dragOrigin=
{x:0,y:0};this._startRect={left:0,top:0,width:this._map.width,height:this._map.height};a.set(this._canvas,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"});"css-transforms"===this._map.navigationMode?(this.roaming&&this.tileMode&&this.useWebGL&&(this._delta=null),this._tdx=this._left,this._tdy=this._top,this._multiply=null,a.set(this._div,c._css.names.transform,c._css.translate(this._left,this._top)),a.set(this._canvas,c._css.names.transform,c._css.translate(-this._left,
-this._top))):(a.set(this._div,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}),a.set(this._canvas,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}))},_drawAllFrames:function(){if(!this.suspended&&this._map&&(!this.tileMode||this._drawTile))if(this._resetCss){var K=this._frames,E=0,N;for(N=0;N<K.length;N++)if(K[N].completed)E++;else if(K[N].tileData.renderedPixelBlock){K[N].completed=!0;var I=K[N].tileData;break}else if(K[N].tileData._fetched&&
!K[N].tileData.src){K[N].completed=!0;break}else if(K[N].tileData.update&&K[N].tileData.update.isFulfilled()&&!K[N].tileData.renderedPixelBlock){K[N].completed=!0;break}else K[N].tileData.fetch&&(!0===K[N].tileData.fetch||K[N].tileData.fetch.isCanceled()||K[N].tileData.fetch.isRejected())?(K[N].completed=!0,E++):this._isExtentOutSide(K[N].tileData.extent,this._map.extent)&&(K[N].completed=!0,E++);if(I){E++;var O=I.extent,U=this._map.extent,ha=this.getCurrentResolution(),ia=N=0;Math.abs(O.xmin-U.xmin)>
ha.x&&(N=Math.round((O.xmin-U.xmin)/ha.x));Math.abs(U.ymax-O.ymax)>ha.y&&(ia=Math.round((U.ymax-O.ymax)/ha.y));I.renderedPixelBlock?(O=I.renderedPixelBlock,U=this._context.createImageData(O.width,O.height),U.data.set(I.renderedPixelBlock.getAsRGBA()),this._context.putImageData(U,N,ia,0,0,O.width,O.height)):this.clear(N,ia,I.width,I.height)}E===K.length?(this._animation=null,this._fireUpdateEnd()):this._animation=requestAnimationFrame(m.hitch(this,this._drawAllFrames))}else this._resetDrawing(),this._animation=
requestAnimationFrame(m.hitch(this,this._drawAllFrames))},_fetchTiles:function(K,E){if(!this.suspended&&this.loaded){this._cancelAnimation();var N=this.tileManager,I=!(N.xformSetting.requireProjection&&N.xformSetting.requirePE)||la.load();e(I,m.hitch(this,function(){N.updateExtent(K,this.getCurrentResolution());this._resetCss=!1;N.fetchTiles(E);E&&(this._hasTilingEffects||this.useWebGL?this.useWebGL&&0<N.tiles.length?(N.fillupTiles(),N._validateRawPixelBlocks(N.originalPixelData)?this._updateAllTilesOnce(N.originalPixelData):
N.originalPixelData&&N.originalPixelData.src&&N.tiles.some(function(O){return O.updateCompleted})&&this._context.clear(this._context.COLOR_BUFFER_BIT),N.tiles.forEach(m.hitch(this,function(O){O.update&&!O.updateCompleted&&O.update.then(function(U){O.updateCompleted||(O.updateCompleted=!0);(this._hasTilingEffects||this.useWebGL)&&this._drawOneFrame(U)}.bind(this))}))):this._hasTilingEffects&&e(N.fetchAllCompleted.isResolved()||N.fetchAllCompleted,m.hitch(this,function(){this._updateAllTilesOnce(N.originalPixelData)})):
(this._frames=N.tiles.map(function(O){return{completed:!1,tileData:O}}),this._drawAllFrames()))}))}},_redrawTiles:function(){this._fetchTiles(this._map.extent,!0)},_panHandler:function(K,E){this._drawTile=!1;"css-transforms"===this._map.navigationMode?this.roaming&&this.tileMode&&this.useWebGL?(this._delta=E,!this._roamingAnimation&&this.tileMode&&(this._roamingAnimation=requestAnimationFrame(this._animatePan2d))):(this._left=this._map.__visibleDelta.x+E.x,this._top=this._map.__visibleDelta.y+E.y,
a.set(this._div,c._css.names.transform,c._css.translate(this._left,this._top))):a.set(this._div,{left:this._startRect.left+E.x+"px",top:this._startRect.top+E.y+"px"});this.tileMode&&this._fetchTiles(K)},_panEndHandler:function(K,E){E&&(this._startRect.left+=E.x,this._startRect.top+=E.y);this.oldData=null;this._roamingAnimation&&(cancelAnimationFrame(this._roamingAnimation),this._oldDelta=this._roamingAnimation=null)},_onScaleHandler:function(K,E){var N={},I=c._css.names;a.set(this._canvas,I.transition,
E?"none":I.transformName+" "+Q+"ms ease");this._matrix=K;K=this._multiply?f.multiply(K,this._multiply):K;if(this._tdx||this._tdy)K=f.multiply(K,{xx:1,xy:0,yx:0,yy:1,dx:-this._tdx,dy:-this._tdy});N[I.transform]=c._css.matrix(K);a.set(this._canvas,N)},_onZoomHandler:function(K,E,N){var I=this._startRect;K=I.width*E;E*=I.height;var O=I.left-(K-I.width)*(N.x-I.left)/I.width;N=I.top-(E-I.height)*(N.y-I.top)/I.height;a.set(this._canvas,{left:O+"px",top:N+"px",width:K+"px",height:E+"px"});this._endRect=
{left:O,top:N,width:K,height:E}},_onZoomEndHandler:function(){this._endRect&&(this._startRect=this._endRect)},_onResizeHandler:function(K,E,N){a.set(this._div,{width:E+"px",height:N+"px"});a.set(this._canvas,{width:E+"px",height:N+"px"});this._startRect.width=this._canvas.width=E;this._startRect.height=this._canvas.height=N;this.useWebGL&&this._glSetting&&(this._glSetting.pingpong=null,this._glSetting.branches=null)},_extentChangeHandler:function(K,E,N,I){if(this.loaded&&!this.suspended&&(!E||0!==
E.x||0!==E.y||N)){this._drawTile=!0;"css-transforms"===this._map.navigationMode&&(E&&(this._dragOrigin.x+=E.x,this._dragOrigin.y+=E.y),this._left=this._map.__visibleDelta.x,this._top=this._map.__visibleDelta.y,this.roaming&&this.tileMode&&this.useWebGL||N||a.set(this._div,c._css.names.transform,c._css.translate(this._left,this._top)),N&&(a.set(this._canvas,c._css.names.transition,"none"),this._multiply=this._multiply?f.multiply(this._matrix,this._multiply):this._matrix,this._levelChange=!0));this._fireUpdateStart();
var O=this._map;E=this.raster.rasterFunction?this.raster.getMemberRasters().map(function(ha){return ha._rasterId}):[this.raster._rasterId];var U={};this.tileMode?((this.roaming||this.useWebGL)&&this.tileMode||(E.forEach(function(ha,ia){U[ha]={extent:O.extent,pixelBlock:new T({width:O.width,height:O.height,pixels:[],pixelType:"",mask:null,statistics:[]})}}),this.tileManager.originalPixelData={extent:O.extent,src:U}),this.projectedFullExtent?this._fetchTiles(K,!0):this._getProjectedFullExtent(O.spatialReference).then(m.hitch(this,
function(){this._fetchTiles(K,!0)}))):this._requestData(O.extent,O.width,O.height)}},_visibilityChangeHandler:function(K){K?q.show(this._div):q.hide(this._div)},_opacityChangeHandler:function(K){a.set(this._div,"opacity",K)}});k("extend-esri")&&m.setObject("layers.RasterXLayer",H,c);return H})},"esri/layers/rasterLib/function/StretchFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./vertexShaders ./pixelShaders ./RasterFunctionWebGLMixin".split(" "),
function(H,m,n,r,l,k,b){return H([n,b],{declaredClass:"esri.layers.rasterLib.function.StretchFunction",functionName:"Stretch",supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({stretchType:0,min:0,max:255,numberOfStandardDeviations:2,statistics:null,histograms:null,dra:!1,minPercent:.25,maxPercent:.5,useGamma:!1,gamma:null,raster:null,computeGamma:!1},a);this.functionArguments.statistics=this._convertStats(this.functionArguments.statistics);-1===[0,3,
5,6].indexOf(this.functionArguments.stretchType)&&(console.error("The specific stretch type has not been implemented: "+this.functionArguments.stretchType),this.functionArguments.stretchType=5);this.min=null==this.min?0:this.min;this.max=null==this.max?255:this.max},bind:function(a){a=this.getSourceRasterInfo(a);if(!a.raster)return Error("The raster input to stretch function is invalid.");a.raster.statistics&&(this.srcStatistics=this._convertStats(a.raster.statistics));a.raster.histograms&&(this.srcHistograms=
a.raster.histograms);this.rasterInfo=m.mixin({},a.raster,{bandCount:a.raster.bandCount,pixelType:this._calculatePixelType(this.pixelType,"U8"),statistics:null,histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(a){a=a.raster;this._stretch(a);return a},hasTilingEffects:function(a){a=a||this.functionArguments;return!!(a.dra||a.raster&&"object"===typeof a.raster&&a.raster.dra)},_convertStats:function(a){return a?
a.map(function(d){return d&&null!=d.min?[d.min,d.max,d.mean,d.stddev]:d}):null},_updateStatistisHistograms:function(a){var d=this.functionArguments,f=d.histograms||this.srcHistograms;if(a&&a.pixelBlock&&a.pixelBlock.pixels){if(0===d.stretchType)this._statistics=d.statistics&&0<d.statistics.length?d.statistics:this.srcStatistics,this._histograms=f;else{var e=a.pixelBlock,h=e.pixels.length,c=6===d.stretchType&&(d.dra||!f)||3===d.stretchType&&d.dra;c&&(e.statistics||e.calculateStatistics(),this._calculateStatisticsHistograms(a));
if(d.dra)if(e.statistics||e.calculateStatistics(),c)this._statistics=e.statistics,this._histograms=e.histograms;else for(d=e.statistics,this._statistics=[],a=0;a<h;a++)this._statistics[a]=[d[a].minValue,d[a].maxValue,0,0];else this._statistics=d.statistics&&0<d.statistics.length?d.statistics:this.srcStatistics,this._histograms=f}this._statistics=this._convertStats(this._statistics);this._gammaCorrection=this._getGammaCorrection()}else this._statistics=d.statistics&&0<d.statistics.length?d.statistics:
this.srcStatistics,this._histograms=f,this._gammaCorrection=this._getGammaCorrection(),this._statistics=this._convertStats(this._statistics)},_getGammaCorrection:function(){var a=this.functionArguments.gamma;if(a){var d=[],f;for(f=0;f<a.length;f++)d[f]=1<a[f]?2<a[f]?6.5+Math.pow(a[f]-2,2.5):6.5+100*Math.pow(2-a[f],4):1;return d}},_stretch:function(a){if(null!==a&&null!==a.pixelBlock&&null!==a.pixelBlock.pixels&&0!==this.functionArguments.stretchType){this._updateStatistisHistograms(a);var d=a.pixelBlock,
f=d.pixels;d=d.width*d.height;var e=f.length,h,c;this._createLUT(a);if(null==this.LUT)return this._filterNoLUT(a);var g=this.LUT,p=this.LUTOffset;for(h=0;h<e;h++){var q=g[h];for(c=0;c<d;c++){var u=f[h][c];f[h][c]=q[u-p]}}a.pixelBlock.pixelType="U8"}},_calculateStatisticsHistograms:function(a){a=a.pixelBlock;var d=a.pixelType,f=a.pixels,e=a.mask,h=f.length,c,g,p=function(w){this.min=-.5;this.max=255.5;this.size=256;m.mixin(this,w);this.counts=this.counts||new Uint32Array(this.size)},q=[],u,v;for(c=
0;c<h;c++){var t=new p;var y=t.counts;var C=f[c];if("U8"===d)if(e)for(g=0;g<a.width*a.height;g++)e[g]&&y[C[g]]++;else for(g=0;g<a.width*a.height;g++)y[C[g]]++;else{var B=a.statistics[c].minValue;var F=a.statistics[c].maxValue;t.min=B;t.max=F;F=(F-B)/256;var x=new Uint32Array(257);if(e)for(g=0;g<a.width*a.height;g++)e[g]&&x[Math.floor((C[g]-B)/F)]++;else for(g=0;g<a.width*a.height;g++)x[Math.floor((C[g]-B)/F)]++;for(g=0;255>g;g++)y[g]=x[g];y[255]=x[255]+x[256]}q.push(t);C=[];B=a.statistics[c].minValue;
F=a.statistics[c].maxValue;for(g=v=u=x=0;g<t.size;g++)x+=y[g],u+=g*y[g];u/=x;for(g=0;g<t.size;g++)v+=y[g]*Math.pow(g-u,2);y=Math.sqrt(v/(x-1));g=(u+.5)*(t.max-t.min)/t.size+t.min;t=y*(t.max-t.min)/t.size;C.push(B);C.push(F);C.push(g);C.push(t);a.statistics[c]={min:B,minValue:B,max:F,maxValue:F,mean:g,stddev:t}}a.histograms=q},_getCutOffPoints:function(a){var d=this.functionArguments,f=999;a&&a.pixelBlock?f=a.pixelBlock.pixels.length:a&&a.texture&&(f=3);a=Math.min(f,this._statistics.length);var e=
[],h=[],c,g;switch(d.stretchType){case 5:for(c=0;c<a;c++)e[c]=this._statistics[c][0],h[c]=this._statistics[c][1];break;case 3:for(c=0;c<a;c++)e[c]=this._statistics[c][2]-d.numberOfStandardDeviations*this._statistics[c][3],h[c]=this._statistics[c][2]+d.numberOfStandardDeviations*this._statistics[c][3],e[c]<this._statistics[c][0]&&(e[c]=this._statistics[c][0]),h[c]>this._statistics[c][1]&&(h[c]=this._statistics[c][1]);break;case 6:for(c=0;c<a;c++){f=this._histograms[c];var p=new Uint32Array(f.size);
var q=f.counts;var u=0;var v=-.5===f.min&&1===(f.max-f.min)/q?.5:0;for(g=0;g<f.size;g++)u+=q[g],p[g]=u;q=d.minPercent*u/100;for(g=0;g<f.size;g++)if(p[g]>q){e[c]=f.min+(f.max-f.min)/f.size*(g+v);break}q=(1-d.maxPercent/100)*u;for(g=f.size-2;0<=g;g--)if(p[g]<q){h[c]=f.min+(f.max-f.min)/f.size*(g+2-v);break}}break;default:for(c=0;c<f;c++)e[c]=0,h[c]=255}return{minCutOff:e,maxCutOff:h}},_createLUT:function(a){var d=this.functionArguments,f=a.pixelBlock,e=f.pixelType;if("U8"===e||"U16"===e||"S8"===e||
"S16"===e){if(this._LUTSignature&&(e=this._computeLutSignature(),e.length===this._LUTSignature.length&&!e.some(function(A,z){return A!==this._LUTSignature[z]}.bind(this))))return;e=f.pixels.length;var h=[],c=[],g=d.max,p=d.min,q=d.gamma,u=g-p,v=this._getCutOffPoints(a);a=v.minCutOff;v=v.maxCutOff;var t=0,y=256;"S8"===f.pixelType?t=-127:"S16"===f.pixelType&&(t=-32767);if("U16"===f.pixelType||"S16"===f.pixelType)y=65536;for(f=0;f<e;f++)h[f]=v[f]-a[f];var C=this._gammaCorrection;if(d.useGamma)for(f=
0;f<e;f++){var B=[];for(d=0;d<y;d++){var F=d+t;var x=(F-a[f])/h[f];var w=1;1<q[f]&&(w-=Math.pow(1/u,x*C[f]));F<v[f]&&F>a[f]?B[d]=Math.floor(w*u*Math.pow(x,1/q[f]))+p:F>v[f]?B[d]=g:F<a[f]&&(B[d]=p)}c[f]=B}else for(f=0;f<e;f++){B=[];for(d=0;d<y;d++)F=d+t,B[d]=F<a[f]?p:F>v[f]?g:Math.floor((F-a[f])/h[f]*u)+p;c[f]=B}this.LUT=c;this.LUTOffset=t;this._LUTSignature=this._computeLutSignature()}},_computeLutSignature:function(){var a=this.functionArguments,d=[],f,e;d.push(a.stretchType);d.push(a.min);d.push(a.max);
d.push(a.numberOfStandardDeviations);if(this._statistics)for(f=0;f<this._statistics.length;f++)for(e=0;e<this._statistics[f].length;e++)d.push(this._statistics[f][e]);d.push(a.dra?1:0);d.push(a.minPercent);d.push(a.maxPercent);if(a.gamma)for(f=0;f<this._statistics.length;f++)d.push(a.gamma[f]);d.push(a.useGamma?1:0);return d},_filterNoLUT:function(a){if(null!==a&&null!==a.pixelBlock&&null!==a.pixelBlock.pixels){var d=this.functionArguments,f=a.pixelBlock,e=f.pixels,h=f.mask;f=f.width*f.height;var c=
e.length,g=[],p=[],q=d.max,u=d.min,v=d.gamma,t=q-u;var y=this._getCutOffPoints(a);var C=y.minCutOff,B=y.maxCutOff;for(y=0;y<c;y++)g[y]=B[y]-C[y];if(d.useGamma&&null!==v&&v.length>=c)for(y=0;y<c;y++)p[y]=1<v[y]?2<v[y]?6.5+Math.pow(v[y]-2,2.5):6.5+100*Math.pow(2-v[y],4):1;if(d.useGamma)if(void 0!==h&&null!==h)for(d=0;d<f;d++){if(h[d])for(y=0;y<c;y++){var F=e[y][d];var x=(F-C[y])/g[y];var w=1;1<v[y]&&(w-=Math.pow(1/t,x*p[y]));F<B[y]&&F>C[y]?e[y][d]=Math.floor(w*t*Math.pow(x,1/v[y]))+u:F>B[y]?e[y][d]=
q:F<C[y]&&(e[y][d]=u)}}else for(d=0;d<f;d++)for(y=0;y<c;y++)F=e[y][d],x=(F-C[y])/g[y],w=1,1<v[y]&&(w-=Math.pow(1/t,x*p[y])),F<B[y]&&F>C[y]?e[y][d]=Math.floor(w*t*Math.pow(x,1/v[y]))+u:F>B[y]?e[y][d]=q:F<C[y]&&(e[y][d]=u);else if(void 0!==h&&null!==h)for(d=0;d<f;d++){if(h[d])for(y=0;y<c;y++)F=e[y][d],F<B[y]&&F>C[y]?e[y][d]=Math.floor((F-C[y])/g[y]*t)+u:F>B[y]?e[y][d]=q:F<C[y]&&(e[y][d]=u)}else for(d=0;d<f;d++)for(y=0;y<c;y++)F=e[y][d],F<B[y]&&F>C[y]?e[y][d]=Math.floor((F-C[y])/g[y]*t)+u:F>B[y]?e[y][d]=
q:F<C[y]&&(e[y][d]=u);a.pixelBlock.pixelType="U8";return a}},_computeGammaValues:function(a){var d=this._statistics.length,f,e=[];for(f=0;f<d;f++){var h=this._statistics[f][2];"U8"!==a&&(h=255*(h-this._statistics[f][0])/(this._statistics[f][1]-this._statistics[f][0]));e.push(this._computeGammaValue(h))}return e},_computeGammaValue:function(a){if(0!==a&&!(255<a||0>a)){var d=0;0<a&&150!=a&&255>a&&(d=150>=a?45*Math.cos(.01047*a):17*Math.sin(.021*a));d=Math.log((a+d)/255);if(0!==d&&(a=Math.log(a/255)/
d,!isNaN(a)))return Math.min(9.9,Math.max(.01,a))}},readGL:function(a){return this._stretchGL(a.raster)},_stretchGL:function(a){this._performance.start();var d=this.renderTexture,f,e=a.pixelBlock&&a.pixelBlock.pixels&&a.pixelBlock.pixels.length||this.sourceRasterInfo.raster.bandCount,h=a.pixelBlock,c=this.gl,g=c.drawingBufferWidth,p=c.drawingBufferHeight;if(!h&&this.functionArguments.dra){var q=new Float32Array(g*p*4),u=new Uint8Array(g*p);var v=new Float32Array(g*p);var t=new Float32Array(g*p);var y=
new Float32Array(g*p);c.checkFramebufferStatus(c.FRAMEBUFFER)==c.FRAMEBUFFER_COMPLETE&&c.readPixels(0,0,g,p,c.RGBA,c.FLOAT,q);for(f=0;f<g*p;f++)v[f]=q[4*f],t[f]=q[4*f+1],y[f]=q[4*f+2],u[f]=q[4*f+3];a.pixelBlock=new r({width:g,height:p,pixels:[v,t,y],mask:u});a.pixelBlock.calculateStatistics()}!h&&this.functionArguments.dra&&this._useGPUStats?(v=new Float32Array(e),t=new Float32Array(e)):(this._updateStatistisHistograms(a),q=this._getCutOffPoints(a),v=new Float32Array(e),t=new Float32Array(e),v.set(q.minCutOff.slice(0,
e)),t.set(q.maxCutOff.slice(0,e)));this._initializeProgram({fragment:k.stretch,fragmentName:"Stretch"});q=this._setupTextureData(a);u=this.bindFrameBuffer();this.renderTexture=!1;this._performance.start();if(!h&&this.functionArguments.dra&&this._useGPUStats){this._setUniforms({u_sourceDim:[g,p],u_bandCount:e});if(1===e)var C=this._readMinMax(q,2);else{C=this._readMinMax(q,0);var B=this._readMinMax(q,1)}if(6===this.functionArguments.stretchType||3===this.functionArguments.stretchType&&this.functionArguments.dra)f=
this._readHistogram(C,B,a),v=f.minCutOff||v,t=f.minCutOff||t}y=this.functionArguments.max-this.functionArguments.min;a=new Float32Array(e);for(f=0;f<e;f++)a[f]=y/(t[f]-v[f]);this._useGPUStats&&this._initializeProgram({fragment:k.stretch,fragmentName:"Stretch"});c.blendFunc(c.SRC_ALPHA,c.ZERO);y=new Float32Array(3);var F=new Float32Array(3);for(f=0;3>f;f++)y[f]=this.functionArguments.min,F[f]=this.functionArguments.max;f=this.functionArguments.useGamma;var x=this.functionArguments.gamma,w=this._gammaCorrection;
Array.isArray(x)&&x.length>=e||(f=!1);this._setUniforms({u_sourceDim:[g,p],u_bandCount:e,u_minOutput:y,u_maxOutput:F,u_minCutOff:v,u_maxCutOff:t,u_factor:a,u_state:100,u_useGamma:f,u_gamma:x,u_scaled:!d,u_gammaCorrection:w,u_minMaxTexture:!h&&this.functionArguments.dra&&this._useGPUStats?!0:!1});this.renderTexture=d;c.viewport(0,0,g,p);this._bindTexture(q.texture,"u_image");!h&&this.functionArguments.dra&&this._useGPUStats&&(d=c.getUniformLocation(this.rasterProgram,"u_image1"),c.uniform1i(d,1),c.activeTexture(c.TEXTURE1),
c.bindTexture(c.TEXTURE_2D,C.texture),1<e&&(e=c.getUniformLocation(this.rasterProgram,"u_image2"),c.uniform1i(e,2),c.activeTexture(c.TEXTURE2),c.bindTexture(c.TEXTURE_2D,B.texture)));this._drawGL();return{extent:q.extent,texture:u.texture}},_readMinMax:function(a,d){var f=this.gl,e=a.width||f.drawingBufferWidth,h=a.height||f.drawingBufferHeight;this._setUniforms({u_state:d});this.renderTexture=!1;var c=a.texture;for(f.activeTexture(f.TEXTURE0);1<e||1<h;){var g=this._createTexture();d=Math.max(Math.ceil(e/
2),1);var p=Math.max(Math.ceil(h/2),1);f.getExtension("OES_texture_float");f.texImage2D(f.TEXTURE_2D,0,f.RGBA,d,p,0,f.RGBA,f.FLOAT,null);a=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,a);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,g,0);f.viewport(0,0,d,p);f.bindTexture(f.TEXTURE_2D,c);this._setUniforms({u_sourceDim:[e,h]});e=d;h=p;this._drawGL(!0);c=g}a=new Float32Array(e*h*4);f.checkFramebufferStatus(f.FRAMEBUFFER)==f.FRAMEBUFFER_COMPLETE&&f.readPixels(0,0,e,h,
f.RGBA,f.FLOAT,a);return{texture:g,minmax:a}},_readHistogram:function(a,d,f){if(a)try{var e=this.gl,h=e.drawingBufferWidth,c=e.drawingBufferHeight,g,p,q;if(a.texture instanceof WebGLTexture){var u=!0;var v=[1,0,0,1];if(d){var t=a.minmax;var y=d.minmax}else t=[a.minmax[0]],y=[a.minmax[1]]}else for(y=d,t=a,v=new Float32Array(y.length),g=0;g<y.length;g++)v[g]=256/(y[g]-t[g]);var C=new Float32Array(h*c);for(q=0;q<C.length;q++)C[q]=q;if(!this.histogramProgram){var B=l.getShader(e,l.histogram),F=k.getShader(e,
k.constant);this.histogramProgram=this._loadProgram(B,F)}e.blendFunc(e.ONE,e.ONE);e.enable(e.BLEND);e.useProgram(this.histogramProgram);var x=e.getAttribLocation(this.histogramProgram,"a_pixelIndex"),w=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,w);e.bufferData(e.ARRAY_BUFFER,C,e.STATIC_DRAW);e.enableVertexAttribArray(x);e.vertexAttribPointer(x,1,e.FLOAT,!1,0,0);var A=this._setupHistTexture(f),z=this._createTexture();e.getExtension("OES_texture_float");e.texImage2D(e.TEXTURE_2D,0,e.RGBA,257,1,0,
e.RGBA,e.FLOAT,null);var G=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,G);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,z,0);e.viewport(0,0,257,1);var J=e.getUniformLocation(this.histogramProgram,"u_image");e.uniform1i(J,0);e.activeTexture(e.TEXTURE0);e.bindTexture(e.TEXTURE_2D,A);var L=e.getUniformLocation(this.histogramProgram,"u_sourceDim");e.uniform2f(L,h,c);var R=e.getUniformLocation(this.histogramProgram,"u_bandCount");e.uniform1i(R,3);var T=e.getUniformLocation(this.histogramProgram,
"u_halfPixel");e.uniform2f(T,.5/h,.5/c);var aa=e.getUniformLocation(this.histogramProgram,"u_minMaxTexture");if(u){e.uniform1i(aa,1);var ca=e.getUniformLocation(this.histogramProgram,"u_image1");e.uniform1i(ca,1);e.activeTexture(e.TEXTURE1);e.bindTexture(e.TEXTURE_2D,a.texture);if(d){var ba=e.getUniformLocation(this.histogramProgram,"u_image2");e.uniform1i(ba,2);e.activeTexture(e.TEXTURE2);e.bindTexture(e.TEXTURE_2D,d.texture)}}else{var la=e.getUniformLocation(this.histogramProgram,"u_mins");e.uniform4f(la,
t[0],t[0],t[0],t[0]);e.uniform1i(aa,0)}var oa=e.getUniformLocation(this.histogramProgram,"u_color"),fa=e.getUniformLocation(this.histogramProgram,"u_factors"),M=e.getUniformLocation(this.histogramProgram,"u_size");e.uniform1f(M,256);a=[];d=[];e.uniform4fv(oa,[1,0,0,1]);e.uniform4fv(fa,[v[0],0,0,1]);e.drawArrays(e.POINTS,0,C.length);var X=this.sourceRasterInfo.raster.bandCount;1<X&&(e.uniform4fv(oa,[0,1,0,1]),e.uniform4fv(fa,[0,v[0],0,1]),e.drawArrays(e.POINTS,0,C.length),e.uniform4fv(oa,[0,0,1,1]),
e.uniform4fv(fa,[0,0,v[0],1]),e.drawArrays(e.POINTS,0,C.length));if(e.checkFramebufferStatus(e.FRAMEBUFFER)==e.FRAMEBUFFER_COMPLETE){var da=new Float32Array(1028);e.readPixels(0,0,257,1,e.RGBA,e.FLOAT,da);e=0;var Q=-.5===t[0]&&1===(y[0]-t[0])/256?.5:0;for(g=0;g<X;g++){var K=new Float32Array(257);var E=new Float32Array(257);for(q=e=0;256>q;q++)e+=da[4*q+g],K[q]=e,E[q]=da[4*q+g];E[256]=da[1024+g];K[256]=e+da[1024+g];var N=this.functionArguments.minPercent*e/100;if(y){for(p=0;256>p;p++)if(K[p]>N){a[g]=
t[0]+(y[0]-t[0])/256*(p+Q);break}N=(1-this.functionArguments.maxPercent/100)*e;for(p=254;0<=p;p--)if(K[p]<N){d[g]=t[0]+(y[0]-t[0])/256*(p+2-Q);break}}}}return{histogram:da,minCutOff:a,maxCutOff:d}}catch(I){console.debug("webgl filter exception: "+I.message)}},_setupHistTexture:function(a){if(a instanceof WebGLTexture)return a;var d=this.originalHistTexture=this._createTexture(),f=this.gl;a=a.pixelBlock;var e=a.width,h=a.height;f.getExtension("OES_texture_float");this.rgbaFloatData=a.getAsRGBAFloat();
f.texImage2D(f.TEXTURE_2D,0,f.RGBA,e,h,0,f.RGBA,f.FLOAT,this.rgbaFloatData);return d}})})},"esri/layers/rasterLib/function/RasterFunctionX":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/config ../raster/RasterInfo ../../../geometry/Extent ../../PixelBlock".split(" "),function(H,m,n,r,l,k){return H(null,{functionName:null,functionArguments:null,pixelType:"Unknown",rasterInfo:null,constructor:function(b){b&&(this.pixelType=b.outputPixelType||b.OutputPixelType||this.pixelType,this.renderTexture=
b.renderTexture,this._initFunction())},mixinIgnoreCase:function(b,a){var d=Object.keys(b),f=Object.keys(a),e,h,c=d.length;for(e=0;e<f.length;e++){var g=a[f[e]];if(null!=g)for(h=0;h<c;h++)if(d[h].toLowerCase()===f[e].toLowerCase()){b[d[h]]=g;break}}return b},bind:function(b){},setProcessingContext:function(b){if(!b)throw"cannot bind to layer without options";this.useWebGL=!!b.useWebGL;this._tileMode=!!b.tileMode;this._glSetting=b.glSetting;this._rawRasterInfo=b.rawRasterInfo;this._xformSetting=b.xformSetting||
this._xformSetting;if(!this.useWebGL||this._glSetting&&this._glSetting.gl){this.gl=this.useWebGL?this._glSetting.gl:null;this._glSetting&&(this._glSetting.pingpong=null,this._glSetting.branches=null);var a=this.functionArguments.raster,d=this.functionArguments.raster2,f=this.functionArguments.dem,e=this.functionArguments.fillRaster,h=this.functionArguments.rasters;a&&a.functionArguments&&a.setProcessingContext(b);d&&d.functionArguments&&d.setProcessingContext(b);f&&f.functionArguments&&f.setProcessingContext(b);
e&&e.functionArguments&&e.setProcessingContext(b);if(h)for(a=0;a<h.length;a++)h[a]&&h[a].functionArguments&&h[a].setProcessingContext(b);this.bind()}},updateBranchStructure:function(){var b=0,a=this.functionArguments;a.raster&&a.raster.read&&a.raster.functionArguments&&(b+=a.raster.updateBranchStructure());a.raster2&&a.raster2.read&&a.raster2.functionArguments&&(b+=a.raster2.updateBranchStructure(),a.raster2.isBranch=!0,a.raster&&a.raster.read&&(a.raster.isBranch=!0));a.rasters&&(b=a.rasters.length,
a.rasters.forEach(function(d){d.read&&d.functionArguments&&(d.isBranch=!0)}));a.dem&&a.dem.read&&a.dem.functionArguments&&(b+=a.dem.updateBranchStructure());return 1===b?0:b},read:function(b){b=this.processRasterArgument(b);return this.useWebGL?this.readGL(b):this.read2D(b)},hasTilingEffects:function(){return!1},read2D:function(){},readGL:function(){},getSourceRasterInfo:function(){var b,a={};if(this.functionArguments.raster2)a.functionArguments.raster=this._bindRaster(this.functionArguments.raster),
a.functionArguments.raster2=this._bindRaster(this.functionArguments.raster2);else if(this.functionArguments.rasters)for(a.rasters=[],b=0;b<this.functionArguments.rasters.length;b++)a.rasters[b]=this._bindRaster(this.functionArguments.rasters[b]);else a.raster=this._bindRaster(this.functionArguments.raster);return this.sourceRasterInfo=a},processRasterArgument:function(b){var a=this.bind();if(!0!==a)throw a;var d={};if(this.functionArguments.raster2)d.raster=this._readRaster(this.functionArguments.raster,
b),d.raster2=this._readRaster(this.functionArguments.raster2,b);else if(this.functionArguments.rasters)for(d.rasters=[],a=0;a<this.functionArguments.rasters.length;a++)d.rasters[a]=this._readRaster(this.functionArguments.rasters[a],b);else d.raster=this._readRaster(this.functionArguments.raster,b);return d},toJson:function(){var b=this.functionArguments,a=b.raster,d=b.raster2;b=b.rasters;a=a?a.toJson?a.toJson():a:null;d=d?d.toJson?d.toJson():d:null;var f;b&&0<b.length&&(f=b.map(function(e){return e.toJson?
e.toJson():e}));b=m.mixin({},this.functionArguments);b.raster=a;b.raster2=d;b.rasters=f;b=this._fixRasterFunctionJson(b);return{rasterFunction:this.functionName,rasterFunctionArguments:b,outputPixelType:this.pixelType}},_initFunction:function(b){},_getIntegerRange:function(b){switch(b){case "U8":var a=[0,255];break;case "U16":a=[0,65535];break;case "U32":a=[0,4294967295];break;case "S8":a=[-128,127];break;case "S16":a=[-32768,32767];break;case "S32":a=[-2147483648,2147483647]}return a},_calculatePixelType:function(b,
a){return b&&"unknown"!==b.toLowerCase()?b:a},_clonePixelData:function(b){if(null==b)return b;var a={};b.extent&&(a.extent=new l(b.extent.xmin,b.extent.ymin,b.extent.xmax,b.extent.ymax,b.extent.spatialReference));b=b.pixelBlock;if(null==b)return a;a.pixelBlock=b.clone?b.clone():k.prototype.clone(b);return a},_readRaster:function(b,a){if(null==b||"$$"===b)var d=this._clonePixelData(a.src[Object.keys(a.src)[0]]);else b&&b.rasterInfo&&!b.functionArguments?d=this._clonePixelData(a.src[b._rasterId]):isNaN(b)?
b.read&&(d=b.functionArguments?b.read(a):this._clonePixelData(a)):(d=a.src?a.src[Object.keys(a.src)[0]]:a,a=d.pixelBlock,a=new Float32Array(a.width*a.height),a.fill(parseFloat(b)),d=this._clonePixelData(d),d.pixelBlock.pixels=[a],d.isConstant=!0);return d},_bindRaster:function(b){if(b&&"$$"!==b)isNaN(b)?b.rasterInfo?a=b.rasterInfo:b.bind&&b.bind()&&(a=b.rasterInfo):a={};else var a=this._rawRasterInfo;a&&(a=a.clone?a.clone():new r(a),a.bandCount=a.bandCount||3);return a},_getOutputBand:function(b,
a){switch(b){case "U8":b=new Uint8Array(a);break;case "U16":b=new Uint16Array(a);break;case "U32":b=new Uint32Array(a);break;case "S8":b=new Int8Array(a);break;case "S16":b=new Int16Array(a);break;case "S32":b=new Int32Array(a);break;case "U32":b=new Uint32Array(a);break;case "F32":b=new Float32Array(a);break;case "F64":b=new Float64Array(a);break;default:b=new Float32Array(a)}return b},_clampBand:function(b,a,d){if(("F64"===a||"F32"===a)&&!d)return b;var f,e=this._getIntegerRange(a),h=b.length;if(e)for(d=
e[1],e=e[0],a=this._getOutputBand(a,h),f=0;f<h;f++){var c=b[f];a[f]=c>d?d:c<e?e:c}else a=b;return a},_performance:{start:function(){return this._start=self.performance&&self.performance.now()||new Date}.bind(this),elapsed:function(){return(self.performance&&self.performance.now()||new Date)-this._start}.bind(this)},_addPerformanceMetric:function(b){n.isDebug&&(self.rasterFunctionPerformance||(self.rasterFunctionPerformance=[]),self.rasterFunctionPerformance.push(b),50<self.rasterFunctionPerformance.length&&
self.rasterFunctionPerformance.shift())},_fixRasterFunctionJson:function(b){for(var a in b)b.hasOwnProperty(a)&&(null==b[a]?delete b[a]:b[a]instanceof Object&&!b[a].sourceType&&this._fixRasterFunctionJson(b[a],!0));return b}})})},"esri/layers/rasterLib/raster/RasterInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","../../../geometry/Extent","../../../SpatialReference","../tile/RasterTileInfo"],function(H,m,n,r,l){return H(null,{declaredClass:"esri.layers.rasterLib.raster.RasterInfo",
bandCount:null,pixelType:null,extent:null,spatialReference:null,width:null,height:null,colormap:null,attributeTable:null,multiDimensionalInfo:null,statistics:null,histograms:null,catalogInfo:null,keyProperties:null,cellSize:null,format:null,compression:null,compressionQuality:null,packetSize:null,geodataXform:null,constructor:function(k){m.mixin(this,k);this.extent=this.extent?this.extent.toJson?this.extent:new n(this.extent):null;this.spatialReference=this.spatialReference?this.spatialReference.toJson?
this.spatialReference:new r(this.spatialReference):null;this.tileInfo=this.tileInfo?this.tileInfo.toJson?this.tileInfo:new l(this.tileInfo):null},toJson:function(){return{bandCount:this.bandCount,pixelType:this.pixelType,extent:this.extent&&this.extent.toJson?this.extent.toJson():this.extent,spatialReference:this.spatialReference&&this.spatialReference.toJson?this.spatialReference.toJson():this.spatialReference,width:this.width,height:this.height,colormap:this.colormap?m.clone(this.colormap):null,
attributeTable:this.attributeTable?m.clone(this.attributeTable):null,multiDimensionalInfo:this.multiDimensionalInfo?m.clone(this.multiDimensionalInfo):null,statistics:this.statistics?m.clone(this.statistics):null,histograms:this.histograms?m.clone(this.histograms):null,catalogInfo:this.catalogInfo?m.clone(this.catalogInfo):null,keyProperties:this.keyProperties?m.clone(this.keyProperties):null,cellSize:this.cellSize&&this.cellSize.toJson?this.cellSize.toJson():this.cellSize,tileInfo:this.tileInfo&&
this.tileInfo.toJson?this.tileInfo.toJson():this.tileInfo,format:this.format,compression:this.compression,compressionQuality:this.compressionQuality,packetSize:this.packetSize,geodataXform:this.geodataXform?m.clone(this.geodataXform):null}},clone:function(){return new this.constructor(this.toJson())}})})},"esri/layers/rasterLib/tile/RasterTileInfo":function(){define("dojo/_base/declare dojo/_base/lang ../../../geometry/Extent ../../../SpatialReference ../../../geometry/Point ../../../lang ../../TileInfo".split(" "),
function(H,m,n,r,l,k,b){return H([b],{declaredClass:"esri.layers.rasterLib.tile.RasterTileInfo",rows:512,cols:512,compressionQuality:95,lercError:.01,spatialReference:null,origin:null,virtual:!0,tileType:"Raster",constructor:function(a,d){if(a||d){var f=d&&d.refTileInfo;a?this.virtual=!1:(this.virtual=!0,m.mixin(this,{rows:d.rows||this.rows,cols:d.cols||this.cols,compressionQuality:d.compressionQuality||95,lercError:d.compressionTolerance||.01,spatialReference:d.spatialReference,origin:d.origin}),
this.width=this.cols,this.height=this.rows,this.origin||(f?this.origin=f.origin:d.spatialReference.isWebMercator()||d.extent&&360<=Math.max(Math.abs(d.extent.xmin),Math.abs(d.extent.xmax))?this.origin={x:-2.0037508342787E7,y:2.0037508342787E7}:-1<[4326,4269].indexOf(d.spatialReference.wkid)||360>Math.max(Math.abs(d.extent.xmin),Math.abs(d.extent.xmax))?this.origin={x:-180,y:90}:this.origin={x:d.extent.xmin,y:d.extent.ymax}))}},toJson:function(){var a=b.prototype.toJson.apply(this);a.tileType=this.tileType;
a.virtual=this.virtual;a.lercError=this.lercError;return a},clone:function(){return new this.prototype(this.toJson())}})})},"esri/layers/rasterLib/function/vertexShaders":function(){define(["dojo/_base/declare","dojo/_base/lang","./vertexShaderScripts"],function(H,m,n){H={shaderType:"vertex",getShader:function(r,l){var k=r.createShader(r.VERTEX_SHADER);r.shaderSource(k,l);r.compileShader(k);r.getShaderParameter(k,r.COMPILE_STATUS)||(k=null);return k}};m.mixin(H,n);return H})},"esri/layers/rasterLib/function/vertexShaderScripts":function(){define([],
function(){return{basic:"varying vec2 v_texCoord;\nattribute vec2 a_texCoord;\nuniform vec2 u_xformOffset;\nuniform vec2 u_xformScale;\nuniform bool u_flipY;\nvoid main() {\nv_texCoord \x3d u_xformOffset + a_texCoord * u_xformScale;\nif (u_flipY) {\nv_texCoord.t \x3d 1.0 - v_texCoord.t;\n}\nvec2 position \x3d a_texCoord * 2.0 - 1.0;\ngl_Position \x3d vec4(position, 0.0, 1.0);\n}",histogram:"attribute float a_pixelIndex;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nuniform vec2 u_sourceDim;\nuniform vec2 u_halfPixel;\nuniform vec4 u_bandSelection;\nuniform vec4 u_mins;\nuniform vec4 u_factors;\nuniform float u_size;\nuniform int u_bandCount;\nuniform bool u_minMaxTexture;\nvoid main() {\nfloat row \x3d a_pixelIndex/u_sourceDim.s;\nvec2 coord \x3d vec2(fract(row), floor(row)/u_sourceDim.t);\nvec4 pv \x3d texture2D(u_image, coord + u_halfPixel);\nvec4 minVal, maxVal, pvm;\nif (u_minMaxTexture){\nif (u_bandCount \x3d\x3d1){ //min \x3d red, max \x3d green\nvec4 minmax \x3d texture2D(u_image1, vec2(0.5,0.5));\nminVal \x3d vec4(minmax.r, minmax.r, minmax.r, 0.0);\nmaxVal \x3d vec4(minmax.g, minmax.g, minmax.g, 0.0);\n}\nelse if (u_bandCount \x3d\x3d3){ //min \x3d red, max \x3d green\nminVal \x3d texture2D(u_image1, vec2(0.5,0.5));\nmaxVal \x3d texture2D(u_image2, vec2(0.5,0.5));\n}\nvec4 factors \x3d u_size/(maxVal-minVal+vec4(0.0,0.0,0.0,1.0)) * u_factors;\npvm \x3d (pv - minVal) * factors;\n}\nelse {\npvm \x3d (pv - u_mins) * u_factors;\n}\nfloat histVal \x3d min(floor(pvm.r+pvm.g+pvm.b), u_size-1.0);\nhistVal \x3d pv.a \x3d\x3d 1.0? histVal: u_size;\ngl_Position \x3d vec4((histVal+0.1) / (u_size+1.0) * 2.0 - 1.0, 0.5, 0, 1);\ngl_PointSize \x3d 1.0;\n}",
mesh:"varying vec2 v_texCoord;\nattribute vec2 a_texCoord;\nuniform bool u_drawMeshLines;\nuniform bool u_flipY;\nuniform vec2 u_xformOffset;\nuniform vec2 u_xformScale;\nuniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nuniform vec2 u_srcImageSize;\nuniform bool u_projection;\nvec2 projectPixelLocation(vec2 coords) {\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;// + halfPixel;\n}\nvoid main() {\nif (u_projection) {\nv_texCoord \x3d projectPixelLocation(a_texCoord);\n} else {\nv_texCoord \x3d u_xformOffset + a_texCoord * u_xformScale;\n}\nif (u_flipY) {\nv_texCoord.t \x3d 1.0 - v_texCoord.t;\n}\nvec2 position \x3d a_texCoord * 2.0 - 1.0;\nif (u_drawMeshLines){\nvec2 adjustedPos \x3d (v_texCoord - u_xformOffset) / u_xformScale;\ngl_Position \x3d vec4( adjustedPos * 2.0 - 1.0, 0.0, 1.0);\n}\nelse {\ngl_Position \x3d vec4(position, 0.0, 1.0);\n}\n}"}})},
"esri/layers/rasterLib/function/pixelShaders":function(){define(["dojo/_base/declare","dojo/_base/lang","./pixelShaderScripts"],function(H,m,n){H={shaderType:"fragment",getShader:function(r,l){var k=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(k,l);r.compileShader(k);r.getShaderParameter(k,r.COMPILE_STATUS)||(k=null);return k}};m.mixin(H,n);return H})},"esri/layers/rasterLib/function/pixelShaderScripts":function(){define([],function(){return{aspect:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nuniform vec2 u_cellSize;\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\nfloat pi \x3d 3.141592653589793238;\nfloat dz_dx \x3d 0.0;\nfloat dz_dy \x3d 0.0;\nvec4 va, vb, vc,vd,ve,vf,vg,vh,vi;\nvec2 axy \x3d vec2(-1.0,-1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nif (v_texCoord.s \x3c u_resolution.s)\n{\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (v_texCoord.t \x3c u_resolution.t)\n{\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (v_texCoord.s \x3e1.0-u_resolution.s)\n{\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (v_texCoord.t \x3e 1.0- u_resolution.t)\n{\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nif (v_texCoord.s \x3e\x3d u_resolution.s \x26\x26 (1.0-u_resolution.s)\x3e\x3dv_texCoord.s \x26\x26 v_texCoord.t \x3e\x3d u_resolution.t \x26\x26 (1.0-u_resolution.t)\x3e\x3dv_texCoord.t)\n{\nva \x3d texture2D(u_image, v_texCoord + u_resolution* axy);\nvb \x3d texture2D(u_image, v_texCoord + u_resolution* bxy);\nvc \x3d texture2D(u_image, v_texCoord + u_resolution* cxy);\nvd \x3d texture2D(u_image, v_texCoord + u_resolution* dxy);\nve \x3d texture2D(u_image, v_texCoord + u_resolution* vec2(0, 0));\nvf \x3d texture2D(u_image, v_texCoord + u_resolution* fxy);\nvg \x3d texture2D(u_image, v_texCoord + u_resolution* gxy);\nvh \x3d texture2D(u_image, v_texCoord + u_resolution* hxy);\nvi \x3d texture2D(u_image, v_texCoord + u_resolution* ixy);\n}\ndz_dx \x3d (vc+2.0*vf+vi - va - 2.0*vd - vg).r/(8.0*u_cellSize[0]);\ndz_dy \x3d -(vg+2.0*vh+vi - va - 2.0*vb - vc).r/(8.0*u_cellSize[1]);\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\nfloat aspect_rad \x3d 0.0;\nif (dz_dx \x3d\x3d 0.0)\n{\nif (dz_dy \x3e 0.0)\naspect_rad \x3d 0.5 * pi;\nelse if (dz_dy \x3c 0.0)\naspect_rad \x3d 1.5 * pi;\nelse\nalpha \x3d 0.0;//undefined make it nodata\n}\nelse\n{\naspect_rad \x3d 0.5*pi + atan(dz_dy, -dz_dx);\nif (aspect_rad \x3c 0.0)\naspect_rad \x3d 2.0*pi + aspect_rad;\n}\nfloat aspect \x3d aspect_rad * 180.0 / pi;\ngl_FragColor \x3d vec4(aspect, aspect, aspect, alpha);\n}",
bandArithmetic:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform int u_bandId_nir;\nuniform int u_bandId_red;\nuniform bool u_scaled;\nuniform int u_bandCount;\nuniform int u_method;\nuniform float u_constants[6];\nvec4 calculateNDVI() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(u_bandId_red \x3d\x3d 0 ? currentPixel.r : (u_bandId_red \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat nir \x3d float(u_bandId_nir \x3d\x3d 0 ? currentPixel.r : (u_bandId_nir \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat ndvi_denom \x3d nir + red;\nfloat ndvi;\nif (ndvi_denom \x3d\x3d 0.0) {\nndvi \x3d 0.0;\n} else {\nndvi \x3d (nir - red) / ndvi_denom;\nif (u_scaled) {\nndvi \x3d float(floor(ndvi * 100.0 + 100.5));\n}\n}\nreturn vec4(ndvi, ndvi, ndvi, currentPixel.a);\n}\nvec4 calculateSAVI() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(u_bandId_red \x3d\x3d 0 ? currentPixel.r : (u_bandId_red \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat nir \x3d float(u_bandId_nir \x3d\x3d 0 ? currentPixel.r : (u_bandId_nir \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat savi_denom \x3d nir + red + u_constants[0];\nfloat savi;\nif (savi_denom \x3d\x3d 0.0) {\nsavi \x3d 0.0;\n} else {\nsavi \x3d (nir - red) / savi_denom * (1.0 + u_constants[0]);\n}\nreturn vec4(savi, savi, savi, currentPixel.a);\n}\nvec4 calculateMSAVI() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(u_bandId_red \x3d\x3d 0 ? currentPixel.r : (u_bandId_red \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat nir \x3d float(u_bandId_nir \x3d\x3d 0 ? currentPixel.r : (u_bandId_nir \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat msavi \x3d 0.5 * (2.0 * (nir + 1.0) - sqrt(pow((2.0 * nir + 1.0), 2.0) - 8.0 * (nir - red)));\nreturn vec4(msavi, msavi, msavi, currentPixel.a);\n}\nvec4 calculateTSAVI() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(u_bandId_red \x3d\x3d 0 ? currentPixel.r : (u_bandId_red \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat nir \x3d float(u_bandId_nir \x3d\x3d 0 ? currentPixel.r : (u_bandId_nir \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat s \x3d u_constants[0];\nfloat a \x3d u_constants[1];\nfloat x \x3d u_constants[2];\nfloat tsavi_denom \x3d a * nir + red - a * s + x * (1.0 + s * s);\nfloat tsavi;\nif (tsavi_denom \x3d\x3d 0.0) {\ntsavi \x3d 0.0;\n} else {\ntsavi \x3d s * (nir - s * red - a) / tsavi_denom;\n}\nreturn vec4(tsavi, tsavi, tsavi, currentPixel.a);\n}\nvec4 calculatePVI() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(u_bandId_red \x3d\x3d 0 ? currentPixel.r : (u_bandId_red \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat nir \x3d float(u_bandId_nir \x3d\x3d 0 ? currentPixel.r : (u_bandId_nir \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat a \x3d u_constants[0];\nfloat b \x3d u_constants[1];\nfloat pvi \x3d (nir - a * red - b) / sqrt(1.0 + a * 2.0);\nreturn vec4(pvi, pvi, pvi, currentPixel.a);\n}\nvec4 calculateGEMI() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(u_bandId_red \x3d\x3d 0 ? currentPixel.r : (u_bandId_red \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat nir \x3d float(u_bandId_nir \x3d\x3d 0 ? currentPixel.r : (u_bandId_nir \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat gemi;\nif (red \x3d\x3d 1.0) {\ngemi \x3d 0.0;\n} else {\nfloat eta \x3d (2.0 * (nir * nir - red * red) + 1.5 * nir + 0.5 * red) / (nir + red + 0.5);\nfloat gemi \x3d eta * (1.0 - 0.25*eta) - (red - 0.125) / (1.0 - red);\n}\nreturn vec4(gemi, gemi, gemi, currentPixel.a);\n}\nvec4 calculateVARI() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(currentPixel.r);\nfloat green \x3d float(currentPixel.g);\nfloat blue \x3d float(currentPixel.b);\nfloat vari \x3d (green - red) /(green + red - blue);\nreturn vec4(vari, vari, vari, currentPixel.a);\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\nvec4 pv;\nif (u_method \x3c 4) {\nif (u_method \x3d\x3d 1) {\npv \x3d calculateNDVI();\n} else if (u_method \x3d\x3d 2) {\npv \x3d calculateSAVI();\n} else if (u_method \x3d\x3d 3) {\npv \x3d calculateTSAVI();\n} else if (u_method \x3d\x3d 4) {\npv \x3d calculateMSAVI();\n}\n} else {\nif (u_method \x3d\x3d 5) {\npv \x3d calculateGEMI();\n} else if (u_method \x3d\x3d 6) {\npv \x3d calculatePVI();\n} else if (u_method \x3d\x3d 7) {\npv \x3d calculateGEMI();\n} else if (u_method \x3d\x3d 9) {\npv \x3d calculateVARI();\n}\n}\ngl_FragColor \x3d pv;\n}",
colormap:"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nvarying vec2 v_texCoord;\nuniform float u_indexedColormapOffset;\nuniform float u_indexedColormapMaxIndex;\nvec4 colorize() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat clrIndex \x3d currentPixel.r - u_indexedColormapOffset;\nvec4 result;\nif (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_indexedColormapMaxIndex) {\nresult \x3d vec4(0.0, 0.0, 0.0, 0.0);\n}\nelse {\nvec2 clrPosition \x3d vec2(clrIndex / u_indexedColormapMaxIndex, 0.0);\nvec4 color \x3d texture2D(u_image1, clrPosition);\nresult \x3d vec4(color.r, color.g, color.b, color.a);\n}\nreturn result;\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d colorize();\n}",
compositeBand:"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nvarying vec2 v_texCoord;\nuniform int u_rasterCount;\nvec4 composite() {\nvec4 p0, p1, p2;\np0 \x3d texture2D(u_image, v_texCoord);\nvec4 result;\nif (u_rasterCount \x3d\x3d 1){\nresult \x3d p0;\n}\nelse if (u_rasterCount \x3d\x3d 2){\np1 \x3d texture2D(u_image1, v_texCoord);\nresult \x3d vec4(p0.r,p1.r,0.0,min(p0.a,p1.a));\n}\nelse if (u_rasterCount \x3d\x3d 3){\np1 \x3d texture2D(u_image1, v_texCoord);\np2 \x3d texture2D(u_image2, v_texCoord);\nresult \x3d vec4(p0.r,p1.r,p2.r,min(min(p0.a,p1.a),p2.a));\n}\nreturn result;\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d composite();\n}",
constant:"precision mediump float;\nuniform vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}",contrastBrightness:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nuniform float u_scaleFactor;\nvec4 adjustContrastBrightness() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * currentPixel - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * currentPixel - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * currentPixel - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0; //binary contrast with extra mid tone at 0.5\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a); //no contrast\n}\nreturn vec4(v.r / u_scaleFactor, v.g / u_scaleFactor, v.b / u_scaleFactor, currentPixel.a);\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d adjustContrastBrightness();\n}",
convolution:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nuniform float u_kernel[25];\nuniform int u_kernelSize;\nvec4 convolve33(){\nvec4 vp11, vp12, vp13, vp21, vp22, vp23, vp31, vp32, vp33;\nvec2 xy11 \x3d vec2(-1.0, -1.0);\nvec2 xy12 \x3d vec2(0.0, -1.0);\nvec2 xy13 \x3d vec2(1.0, -1.0);\nvec2 xy21 \x3d vec2(-1.0, 0.0);\nvec2 xy23 \x3d vec2(1.0, 0.0);\nvec2 xy31 \x3d vec2(-1.0, 1.0);\nvec2 xy32 \x3d vec2(0.0, 1.0);\nvec2 xy33 \x3d vec2(1.0, 1.0);\nif (v_texCoord.s \x3c u_resolution.s) {\nxy11[0] \x3d 1.0;\nxy21[0] \x3d 1.0;\nxy31[0] \x3d 1.0;\n}\nif (v_texCoord.t \x3c u_resolution.t) {\nxy11[1] \x3d 1.0;\nxy12[1] \x3d 1.0;\nxy13[1] \x3d 1.0;\n}\nif (v_texCoord.s \x3e 1.0 - u_resolution.s) {\nxy13[0] \x3d -1.0;\nxy23[0] \x3d -1.0;\nxy33[0] \x3d -1.0;\n}\nif (v_texCoord.t \x3e 1.0 - u_resolution.t) {\nxy31[1] \x3d -1.0;\nxy32[1] \x3d -1.0;\nxy33[1] \x3d -1.0;\n}\nvec4 convolResult \x3d\ntexture2D(u_image, v_texCoord + u_resolution * xy11) * u_kernel[0] +\ntexture2D(u_image, v_texCoord + u_resolution * xy12) * u_kernel[1] +\ntexture2D(u_image, v_texCoord + u_resolution * xy13) * u_kernel[2] +\ntexture2D(u_image, v_texCoord + u_resolution * xy21) * u_kernel[3] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(0, 0)) * u_kernel[4] +\ntexture2D(u_image, v_texCoord + u_resolution * xy23) * u_kernel[5] +\ntexture2D(u_image, v_texCoord + u_resolution * xy31) * u_kernel[6] +\ntexture2D(u_image, v_texCoord + u_resolution * xy32) * u_kernel[7] +\ntexture2D(u_image, v_texCoord + u_resolution * xy33) * u_kernel[8];\nreturn vec4(convolResult.rgb, texture2D(u_image, v_texCoord).a);\n}\nvec4 convolve55(){\nvec4 vp11, vp12, vp13, vp21, vp22, vp23, vp31, vp32, vp33;\nfloat xdif[5];//https://www.opengl.org/wiki/Data_Type_(GLSL) array constructor ES3.0\nfloat ydif[5];\nfloat a \x3d -2.0;\nfor (int i\x3d0; i\x3c5; i++){\nxdif[i] \x3d a;\nydif[i] \x3d a;\na++;\n}\nif (v_texCoord.s \x3c u_resolution.s *2.0) { //2 pixel\nxdif[0] \x3d 2.0;\nif (v_texCoord.s \x3c u_resolution.s) { //1 pixel\nxdif[1] \x3d 1.0;\n}\n}\nelse if (v_texCoord.s \x3e 1.0 - u_resolution.s *2.0) {\nxdif[0] \x3d -2.0;\nif (v_texCoord.s \x3e 1.0 - u_resolution.s) {\nxdif[1] \x3d -1.0;\n}\n}\nif (v_texCoord.t \x3c u_resolution.t *2.0) {\nydif[0] \x3d 2.0;\nif (v_texCoord.t \x3c u_resolution.t) {\nydif[1] \x3d 1.0;\n}\n}\nelse if (v_texCoord.t \x3e 1.0 - u_resolution.t*2.0) {\nydif[0] \x3d -2.0;\nif (v_texCoord.t \x3e 1.0 - u_resolution.t) {\nydif[1] \x3d -1.0;\n}\n}\nvec4 convolResult \x3d\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[0], ydif[0])) * u_kernel[0] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[1], ydif[0])) * u_kernel[1] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[2], ydif[0])) * u_kernel[2] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[3], ydif[0])) * u_kernel[3] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[4], ydif[0])) * u_kernel[4] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[0], ydif[1])) * u_kernel[5] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[1], ydif[1])) * u_kernel[6] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[2], ydif[1])) * u_kernel[7] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[3], ydif[1])) * u_kernel[8] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[4], ydif[1])) * u_kernel[9] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[0], ydif[2])) * u_kernel[10] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[1], ydif[2])) * u_kernel[11] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[2], ydif[2])) * u_kernel[12] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[3], ydif[2])) * u_kernel[13] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[4], ydif[2])) * u_kernel[14] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[0], ydif[3])) * u_kernel[15] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[1], ydif[3])) * u_kernel[16] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[2], ydif[3])) * u_kernel[17] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[3], ydif[3])) * u_kernel[18] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[4], ydif[3])) * u_kernel[19] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[0], ydif[4])) * u_kernel[20] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[1], ydif[4])) * u_kernel[21] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[2], ydif[4])) * u_kernel[22] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[3], ydif[4])) * u_kernel[23] +\ntexture2D(u_image, v_texCoord + u_resolution * vec2(xdif[4], ydif[4])) * u_kernel[24];\nreturn vec4(convolResult.rgb, texture2D(u_image, v_texCoord).a);\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\nif (u_kernelSize \x3d\x3d 9){\ngl_FragColor \x3d convolve33();\n}\nelse {\ngl_FragColor \x3d convolve55();\n}\n}",
extractBand:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform int u_bandIDs[3];\nuniform bool u_alterBand;\nvec4 extractBand() {\nvec4 p \x3d texture2D(u_image, v_texCoord);\nif (!u_alterBand){\nreturn p;\n}\nfloat r, g, b;\nif (u_bandIDs[0] \x3d\x3d0){\nr \x3d p.r;\n}\nelse if (u_bandIDs[0] \x3d\x3d1){\nr \x3d p.g;\n}\nelse if (u_bandIDs[0] \x3d\x3d2){\nr \x3d p.b;\n}\nif (u_bandIDs[1] \x3d\x3d0){\ng \x3d p.r;\n}\nelse if (u_bandIDs[1] \x3d\x3d1){\ng \x3d p.g;\n}\nelse if (u_bandIDs[1] \x3d\x3d2){\ng \x3d p.b;\n}\nif (u_bandIDs[2] \x3d\x3d0){\nb \x3d p.r;\n}\nelse if (u_bandIDs[2] \x3d\x3d1){\nb \x3d p.g;\n}\nelse if (u_bandIDs[2] \x3d\x3d2){\nb \x3d p.b;\n}\nreturn vec4(r, g, b, p.a);\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d extractBand();\n}",
hillshade:"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nuniform int u_slopeType;\nuniform int u_hillshadeType;\nuniform int u_lightSourceCount;\nuniform float u_sinZcosA;\nuniform float u_sinZsinA;\nuniform float u_cosZ;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform float u_xFactor;\nuniform float u_yFactor;\nuniform bool u_scaled;\nuniform float u_minValue;\nuniform float u_maxValue;\nuniform bool u_applyColorramp;\nuniform float u_indexedColormapOffset;\nuniform float u_indexedColormapMaxIndex;\nuniform vec2 u_rawResolution;\nuniform int u_resampling;\nvec4 getPixelValue(vec2 coords) {\nif (u_resampling \x3d\x3d 0) {\nreturn texture2D(u_image, coords);\n}\nvec2 pos_ul \x3d floor(coords / u_rawResolution) * u_rawResolution;\nvec2 pos_ur \x3d pos_ul + vec2(1.0, 0.0) * u_rawResolution;\nvec2 pos_ll \x3d pos_ul + vec2(0.0, 1.0) * u_rawResolution;\nvec2 pos_lr \x3d pos_ul + vec2(1.0, 1.0) * u_rawResolution;\nvec2 weight \x3d fract(coords / u_rawResolution);\nvec4 vp_ul \x3d texture2D(u_image, pos_ul);\nvec4 vp_ur \x3d texture2D(u_image, pos_ur);\nvec4 vp_ll \x3d texture2D(u_image, pos_ll);\nvec4 vp_lr \x3d texture2D(u_image, pos_lr);\nvec4 vp \x3d mix(mix(vp_ul, vp_ur, weight.x), mix(vp_ll, vp_lr, weight.x), weight.y);\nreturn vp;\n}\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade, float alpha) {\nfloat clrIndex \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d texture2D(u_image1, vec2(clrIndex, 0.0));\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv) * alpha, alpha);\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\nvec4 va, vb, vc, vd, ve, vf, vg, vh, vi;\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nif (v_texCoord.s \x3c u_resolution.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (v_texCoord.t \x3c u_resolution.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (v_texCoord.s \x3e 1.0 - u_resolution.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (v_texCoord.t \x3e 1.0 - u_resolution.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nva \x3d texture2D(u_image, v_texCoord + u_resolution * axy);\nvb \x3d texture2D(u_image, v_texCoord + u_resolution * bxy);\nvc \x3d texture2D(u_image, v_texCoord + u_resolution * cxy);\nvd \x3d texture2D(u_image, v_texCoord + u_resolution * dxy);\nve \x3d texture2D(u_image, v_texCoord + u_resolution * vec2(0, 0));\nvf \x3d texture2D(u_image, v_texCoord + u_resolution * fxy);\nvg \x3d texture2D(u_image, v_texCoord + u_resolution * gxy);\nvh \x3d texture2D(u_image, v_texCoord + u_resolution * hxy);\nvi \x3d texture2D(u_image, v_texCoord + u_resolution * ixy);\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_xFactor;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_yFactor; //flip\nfloat s2 \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinA * dzy - u_sinZcosA * dzx;\nfloat z \x3d (u_cosZ + cosDelta) / s2;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n}\nelse if (u_hillshadeType \x3d\x3d 1){\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / s2;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d u_lightSourceCount-1) break;\n}\n}\nif (u_applyColorramp) {\nvec4 result \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade, alpha);\nif (u_scaled) {\nresult \x3d vec4(result.rgb * 255.0, result.a);\n}\ngl_FragColor \x3d result;\n} else {\nif (u_scaled) {\nhillshade \x3d hillshade * 255.0;\nif (hillshade\x3e 255.0) {\nhillshade \x3d 255.0;\n}\n}\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, alpha);\n}\n}",
identity:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform int u_bandCount;\nfloat shift_right(float v, float amt) {\nv \x3d floor(v) + 0.5;\nreturn floor(v / exp2(amt));\n}\nfloat shift_left(float v, float amt) {\nreturn floor(v * exp2(amt) + 0.5);\n}\nfloat mask_last(float v, float bits) {\nreturn mod(v, shift_left(1.0, bits));\n}\nfloat extract_bits(float num, float from, float to) {\nfrom \x3d floor(from + 0.5);\nto \x3d floor(to + 0.5);\nreturn mask_last(shift_right(num, from), to - from);\n}\nvec4 encode_float(float val) {\nif (val \x3d\x3d 0.0)\nreturn vec4(0, 0, 0, 0);\nfloat sign \x3d val \x3e 0.0 ? 0.0 : 1.0;\nval \x3d abs(val);\nfloat exponent \x3d floor(log2(val));\nfloat biased_exponent \x3d exponent + 127.0;\nfloat fraction \x3d ((val / exp2(exponent)) - 1.0) * 8388608.0;\nfloat t \x3d biased_exponent / 2.0;\nfloat last_bit_of_biased_exponent \x3d fract(t) * 2.0;\nfloat remaining_bits_of_biased_exponent \x3d floor(t);\nfloat byte4 \x3d extract_bits(fraction, 0.0, 8.0) / 255.0;\nfloat byte3 \x3d extract_bits(fraction, 8.0, 16.0) / 255.0;\nfloat byte2 \x3d (last_bit_of_biased_exponent * 128.0 + extract_bits(fraction, 16.0, 23.0)) / 255.0;\nfloat byte1 \x3d (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\nreturn vec4(byte4, byte3, byte2, byte1);\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\nvec4 currentPixel \x3d  texture2D(u_image, v_texCoord);\ngl_FragColor \x3d vec4( currentPixel.rgb, currentPixel.a); //encode_float(currentPixel.r);\n}",
local:"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nvarying vec2 v_texCoord;\nuniform int u_rasterCount;\nvec4 polyfill;\nvec4 localOp1() {\nvec4 a \x3d texture2D(u_image, v_texCoord);\nvec4 result;\nvec4 replaceme1;\nreturn result;\n}\nvec4 localOp2() {\nvec4 a \x3d texture2D(u_image, v_texCoord);\nvec4 b \x3d texture2D(u_image1, v_texCoord);\nvec4 result;\nvec4 replaceme2;\nreturn result;\n}\nvec4 localOp3() {\nvec4 a \x3d texture2D(u_image, v_texCoord);\nvec4 b \x3d texture2D(u_image1, v_texCoord);\nvec4 c \x3d texture2D(u_image2, v_texCoord);\nvec4 result;\nvec4 replaceme3;\nreturn result;\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d localOp1();\n}",
local0:"precision mediump float;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_texCoord;\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput[3];\nuniform float u_maxOutput[3];\nuniform float u_factor[3];\nuniform int u_operation;\nuniform int u_constant[3];\nuniform vec4 gamma;\nfloat localOperate1(float a, float b, float c){\nfloat result;\nif (u_operation \x3d\x3d 1){\nresult \x3d a + b;\n}\nelse if (u_operation \x3d\x3d 2){\nresult \x3d a - b;\n}\nelse if (u_operation \x3d\x3d3){\nresult \x3d a * b;\n}\nelse if (u_operation \x3d\x3d4){\nresult \x3d sqrt(a);\n}\nelse if (u_operation \x3d\x3d5){\nresult \x3d pow(a, b);\n}\nelse if (u_operation \x3d\x3d6){\nresult \x3d acos(a);\n}\nelse if (u_operation \x3d\x3d7){\nresult \x3d asin(a);\n}\nelse if (u_operation \x3d\x3d8){\nresult \x3d atan(a);\n}\nelse if (u_operation \x3d\x3d9){\nresult \x3d 999.0; //atanh not available\n}\nelse if (u_operation \x3d\x3d10){\nresult \x3d abs(a);\n}\nelse if (u_operation \x3d\x3d13){\nresult \x3d 999.0; //bitwise not available\n}\nelse if (u_operation \x3d\x3d17){\nresult \x3d a !\x3d 0.0 \x26\x26 b !\x3d0.0;\n}\nelse if (u_operation \x3d\x3d18){\nresult \x3d a \x3d\x3d0.0? 1.0:0.0;\n}\nelse if (u_operation \x3d\x3d19){\nresult \x3d a !\x3d 0.0 || b !\x3d0.0;\n}\nelse if (u_operation \x3d\x3d20){\nresult \x3d a !\x3d 0.0 ^^ b !\x3d0.0; //exclusive or\n}\nelse if (u_operation \x3d\x3d21){\nresult \x3d cos(a);\n}\nelse if (u_operation \x3d\x3d23){\nresult \x3d a / b;\n}\nelse if (u_operation \x3d\x3d24){\nresult \x3d a \x3d\x3d b ? 1.0:0.0;\n}\nelse if (u_operation \x3d\x3d25){\nresult \x3d exp(a);\n}\nelse if (u_operation \x3d\x3d26){\nresult \x3d pow(10.0, a);\n}\nelse if (u_operation \x3d\x3d27){\nresult \x3d exp2(a);\n}\nelse if (u_operation \x3d\x3d28){\nresult \x3d a \x3e b? 1.0 : 0.0;\n}\nelse if (u_operation \x3d\x3d29){\nresult \x3d  a \x3e\x3d b? 1.0 : 0.0;\n}\nelse if (u_operation \x3d\x3d30){\nresult \x3d floor(a); //int\n}\nelse if (u_operation \x3d\x3d31){\nresult \x3d a \x3d\x3d0? 1.0:0.0; //null pass mask\n}\nelse if (u_operation \x3d\x3d32){\nresult \x3d a; //float\n}\nelse if (u_operation \x3d\x3d33){\nresult \x3d a \x3c b? 1.0 : 0.0;\n}\nelse if (u_operation \x3d\x3d34){\nresult \x3d a \x3c\x3d b? 1.0 : 0.0;\n}\nelse if (u_operation \x3d\x3d35){\nresult \x3d log(a);\n}\nelse if (u_operation \x3d\x3d36){\nresult \x3d log2(a) / log2(10.0);\n}\nelse if (u_operation \x3d\x3d37){\nresult \x3d log2(a);\n}\nelse if (u_operation \x3d\x3d44){\nresult \x3d mod(a, b);\n}\nelse if (u_operation \x3d\x3d45){\nresult \x3d -a;\n}\nelse if (u_operation \x3d\x3d46){\nresult \x3d a !\x3d b? 1.0 : 0.0;\n}\nelse if (u_operation \x3d\x3d48){\nresult \x3d ceil(a);\n}\nelse if (u_operation \x3d\x3d49){\nresult \x3d floor(a);\n}\nelse if (u_operation \x3d\x3d51){\nresult \x3d sin(a);\n}\nelse if (u_operation \x3d\x3d53){\nresult \x3d a * a;\n}\nelse if (u_operation \x3d\x3d56){\nresult \x3d tan(a);\n}\nelse if (u_operation \x3d\x3d57){\nresult \x3d 999.0; //tanh not available\n}\nelse if (u_operation \x3d\x3d59){\nresult \x3d 999.0; //acosh not available\n}\nelse if (u_operation \x3d\x3d60){\nresult \x3d 999.0; //asinh not available\n}\nelse if (u_operation \x3d\x3d61){\nresult \x3d atan(a, b);\n}\nelse if (u_operation \x3d\x3d64){\nresult \x3d a / b;\n}\nelse if (u_operation \x3d\x3d65){\nresult \x3d floor(a/b);\n}\nelse if (u_operation \x3d\x3d76){\nresult \x3d a !\x3d0? b:c;\n}\n}\nvoid main() {\nvec4 currentPixel0 \x3d  texture2D(u_image0, v_texCoord);\nfloat graya, reda, greena, bluea;\nif (u_bandCount \x3d\x3d 1) {\ngraya \x3d stretchOneaue(float(currentPixel.r), u_minCutOff[0], u_maxCutOff[0], u_minOutput[0], u_maxOutput[0], u_factor[0]);\ngl_FragColor \x3d vec4(graya, graya, graya, currentPixel.a);\n}\nelse if (u_bandCount \x3d\x3d 3) {\nreda \x3d stretchOneaue(float(currentPixel.r), u_minCutOff[0], u_maxCutOff[0], u_minOutput[0], u_maxOutput[0], u_factor[0]);\ngreena \x3d stretchOneaue(float(currentPixel.g), u_minCutOff[1], u_maxCutOff[1], u_minOutput[1], u_maxOutput[1], u_factor[1]);\nbluea \x3d stretchOneaue(float(currentPixel.b), u_minCutOff[2], u_maxCutOff[2], u_minOutput[2], u_maxOutput[2], u_factor[2]);\ngl_FragColor \x3d vec4(reda, greena, bluea, currentPixel.a);\n}\n}",
mask:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform float u_includedRanges[6];\nuniform bool u_includedRanges_specified;\nuniform float u_noDataValues[6];\nuniform bool u_noDataValues_specified;\nuniform int u_noDataInterpretation;\nuniform int u_bandCount;\nvec4 mask() {\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nvec4 processedPixel \x3d currentPixel;\nif (u_includedRanges_specified) {\nif (u_bandCount \x3d\x3d 1) {\nif (currentPixel.r \x3e u_includedRanges[0] \x26\x26 currentPixel.r \x3c u_includedRanges[1])\nprocessedPixel \x3d vec4(currentPixel.rgb, currentPixel.a);\nelse\nprocessedPixel \x3d vec4(currentPixel.rgb, 0);\n} else if (u_bandCount \x3d\x3d 3) {\nif (currentPixel.r \x3e u_includedRanges[0] \x26\x26 currentPixel.r \x3c u_includedRanges[1] \x26\x26 currentPixel.g \x3e u_includedRanges[2] \x26\x26 currentPixel.g \x3c u_includedRanges[3] \x26\x26 currentPixel.b \x3e u_includedRanges[4] \x26\x26 currentPixel.b \x3c u_includedRanges[5])\nprocessedPixel \x3d vec4(currentPixel.rgb, currentPixel.a);\nelse\nprocessedPixel \x3d vec4(currentPixel.rgb, 0);\n}\n}\nif (u_noDataValues_specified) {\nif (u_bandCount \x3d\x3d 1) {\nif (processedPixel.r \x3d\x3d u_noDataValues[0])\nprocessedPixel \x3d vec4(processedPixel.rgb, 0);\nelse\nprocessedPixel \x3d vec4(processedPixel.rgb, processedPixel.a);\n} else if (u_bandCount \x3d\x3d 3) {\nif (u_noDataInterpretation \x3d\x3d1 \x26\x26 processedPixel.r \x3d\x3d u_noDataValues[0] \x26\x26 processedPixel.g \x3d\x3d u_noDataValues[1] \x26\x26 processedPixel.b \x3d\x3d u_noDataValues[2])\nprocessedPixel \x3d vec4(processedPixel.rgb, 0);\nelse if (processedPixel.r \x3d\x3d u_noDataValues[0] || processedPixel.g \x3d\x3d u_noDataValues[1] || processedPixel.b \x3d\x3d u_noDataValues[2])\nprocessedPixel \x3d vec4(processedPixel.rgb, 0);\nelse\nprocessedPixel \x3d vec4(processedPixel.rgb, processedPixel.a);\n}\n}\nreturn processedPixel;\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d mask();\n}",
ndvi:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform int u_bandId_red;\nuniform int u_bandId_nir;\nuniform bool u_scaled;\nuniform int u_bandCount;\nvec4 calculateNDVI(){\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nfloat red \x3d float(u_bandId_red \x3d\x3d 0 ? currentPixel.r : (u_bandId_red \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat nir \x3d float(u_bandId_nir \x3d\x3d 0 ? currentPixel.r : (u_bandId_nir \x3d\x3d 1 ? currentPixel.g : currentPixel.b));\nfloat ndvi_denom \x3d nir + red;\nfloat ndvi;\nif (ndvi_denom \x3d\x3d 0.0) {\nndvi \x3d 0.0;\n}\nelse {\nndvi \x3d (nir - red) / ndvi_denom;\nif (u_scaled) {\nndvi \x3d float(floor(ndvi * 100.0 + 100.5));\n}\n}\nreturn vec4(ndvi, ndvi, ndvi, currentPixel.a);\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d calculateNDVI();\n}",
remap:"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nvarying vec2 v_texCoord;\nuniform float u_indexedColormapOffset;\nuniform float u_indexedColormapMaxIndex;\nuniform float u_breaks[16];\nuniform vec2 u_rawResolution;\nuniform int u_resampling;\nvec4 getPixelValue(vec2 coords) {\nif (u_resampling \x3d\x3d 0) {\nreturn texture2D(u_image, coords);\n}\nvec2 pos_ul \x3d floor(coords / u_rawResolution) * u_rawResolution;\nvec2 pos_ur \x3d pos_ul + vec2(1.0, 0.0) * u_rawResolution;\nvec2 pos_ll \x3d pos_ul + vec2(0.0, 1.0) * u_rawResolution;\nvec2 pos_lr \x3d pos_ul + vec2(1.0, 1.0) * u_rawResolution;\nvec2 weight \x3d fract(coords / u_rawResolution);\nvec4 vp_ul \x3d texture2D(u_image, pos_ul);\nvec4 vp_ur \x3d texture2D(u_image, pos_ur);\nvec4 vp_ll \x3d texture2D(u_image, pos_ll);\nvec4 vp_lr \x3d texture2D(u_image, pos_lr);\nvec4 vp \x3d mix(mix(vp_ul, vp_ur, weight.x), mix(vp_ll, vp_lr, weight.x), weight.y);\nreturn vp;\n}\nfloat getRemapIndex(float pixelValue) {\nif (pixelValue \x3c u_breaks[0] || pixelValue \x3e u_breaks[15]) {\nreturn -1.0;\n}\nfor (int i \x3d 0; i \x3c 16; i++) {\nif (pixelValue \x3c u_breaks[i]) {\nreturn float(i - 1);\n}\n}\nif (pixelValue \x3d\x3d u_breaks[15]) {\nreturn 15.0;\n}\nreturn 0.0;\n}\nvec4 colorize(float pv) {\nfloat clrIndex \x3d pv - u_indexedColormapOffset;\nvec4 result;\nif (clrIndex \x3e u_indexedColormapMaxIndex) {\nresult \x3d vec4(0.0, 0.0, 0.0, 0.0);\n}\nelse {\nvec2 clrPosition \x3d vec2(clrIndex / u_indexedColormapMaxIndex, 0.0);\nvec4 color \x3d texture2D(u_image1, clrPosition);\nresult \x3d vec4(color.r, color.g, color.b, color.a);\n}\nreturn result;\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\nvec4 currentPixel \x3d texture2D(u_image, v_texCoord);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nfloat remappedIndex \x3d getRemapIndex(currentPixel.r);\nif (remappedIndex \x3c 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\ngl_FragColor \x3d colorize(remappedIndex);\n}",
resample:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec2 u_resamplingRatio;\nuniform int u_resamplingType;\nuniform vec2 u_anchor;\nuniform vec2 u_resolution;\nvec4 resample(){\nvec2 pos_nn, pos_ul, pos_ur, pos_ll, pos_lr, pos_offset;\nfloat weight,weight_total, weight_ul, weight_ur, weight_ll, weight_lr;\nvec4 vp;  //v_texCoord is canvas space 0-1\nvec2 originalResolution \x3d vec2(u_resolution.s*u_resamplingRatio.s, u_resolution.t*u_resamplingRatio.t);\nvec2 pos \x3d vec2(u_anchor.s+(v_texCoord.s-u_anchor.s),(u_anchor.t+(v_texCoord.t-u_anchor.t)));\nif (u_resamplingType \x3d\x3d 0)\n{//shift and scaling, y \x3d ax+b so x \x3d (y-b)/a\npos_nn \x3d vec2(floor(pos.s/originalResolution.s+0.5)*originalResolution.s,floor(pos.t/originalResolution.t+0.5)*originalResolution.t);\nif (pos_nn.s \x3c0.0 || pos_nn.s \x3e 1.0 || pos_nn.t \x3c0.0 || pos_nn.t \x3e 1.0){\nvp \x3d vec4(1.0, 0.0, 0.0, 1.0);//vec4(0.0, 1.0, 0.0, vp.a);\n}\nelse {\nvp \x3d texture2D(u_image, vec2(pos_nn.s, pos_nn.t));\n}\n}\nelse if (u_resamplingType \x3d\x3d 1)\n{//shift and scaling, 4 neighbors y \x3d ax+b so x \x3d (y-b)/a\npos_ul \x3d vec2(floor(pos.s/originalResolution.s)*originalResolution.s,floor(pos.t/originalResolution.t)*originalResolution.t);\npos_ur \x3d vec2(pos_ul.s+originalResolution.s, pos_ul.t);\npos_ll \x3d vec2(pos_ul.s, pos_ul.t+originalResolution.t);\npos_lr \x3d vec2(pos_ul.s+originalResolution.s, pos_ul.t+originalResolution.t);\npos_offset \x3d vec2(pos.s - floor(pos_ul.s),pos.t - floor(pos_ul.t));\nweight_lr \x3d sqrt(pow(pos_offset.s,2.0) + pow(pos_offset.t,2.0));\nweight_ul \x3d sqrt(pow( originalResolution.s- pos_offset.s,2.0)+ pow(originalResolution.t- pos_offset.t,2.0));\nweight_ur \x3d sqrt(pow( pos_offset.s,2.0)+ 1.0- pow(originalResolution.t - pos_offset.t,2.0));\nweight_ll \x3d sqrt(pow( originalResolution.s- pos_offset.s,2.0)+ pow(pos_offset.t,2.0));\nvp \x3d (texture2D(u_image, pos_ul) * weight_ul + texture2D(u_image, pos_ur) * weight_ur + texture2D(u_image, pos_ll) * weight_ll + texture2D(u_image, pos_lr) * weight_lr)/(weight_ul+weight_ur+weight_ll+weight_lr);\n}\nelse if (u_resamplingType \x3d\x3d 2)\n{//shift and scaling, 16 neighbors\nweight_total \x3d 0.0;\nvp \x3d vec4(0.0,0.0,0.0,0.0);\npos_ul \x3d vec2(floor(pos.s/originalResolution.s)*originalResolution.s-originalResolution.s,floor(pos.t/originalResolution.t)*originalResolution.t-originalResolution.t);\npos_offset \x3d vec2(pos.s - floor(pos_ul.s),pos.t - floor(pos_ul.t));\nfor (int i\x3d0; i\x3c4; i++){//row\nfor (int j\x3d0; j\x3c4; j++){//col\nweight \x3d sqrt(pow(pos_offset.s-float(j),2.0)+ pow(pos_offset.t-float(i),2.0));\nvp +\x3dtexture2D(u_image, vec2(pos_ul.s+float(i)*originalResolution.s,pos_ul.t+float(j)*originalResolution.t)) * weight;\nweight_total +\x3d weight;\n}\n}\nvp \x3d vp/weight_total;\n}\nreturn vp;\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d resample();\n}",
slope:"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nuniform vec2 u_cellSize;\nuniform float u_zfactor;\nuniform float u_altitude;\nuniform float u_azimuth;\nfloat shift_right(float v, float amt) {\nv \x3d floor(v) + 0.5;\nreturn floor(v / exp2(amt));\n}\nfloat shift_left(float v, float amt) {\nreturn floor(v * exp2(amt) + 0.5);\n}\nfloat mask_last(float v, float bits) {\nreturn mod(v, shift_left(1.0, bits));\n}\nfloat extract_bits(float num, float from, float to) {\nfrom \x3d floor(from + 0.5);\nto \x3d floor(to + 0.5);\nreturn mask_last(shift_right(num, from), to - from);\n}\nvec4 encode_float(float val) {\nif (val \x3d\x3d 0.0)\nreturn vec4(0, 0, 0, 0);\nfloat sign \x3d val \x3e 0.0 ? 0.0 : 1.0;\nval \x3d abs(val);\nfloat exponent \x3d floor(log2(val));\nfloat biased_exponent \x3d exponent + 127.0;\nfloat fraction \x3d ((val / exp2(exponent)) - 1.0) * 8388608.0;\nfloat t \x3d biased_exponent / 2.0;\nfloat last_bit_of_biased_exponent \x3d fract(t) * 2.0;\nfloat remaining_bits_of_biased_exponent \x3d floor(t);\nfloat byte4 \x3d extract_bits(fraction, 0.0, 8.0) / 255.0;\nfloat byte3 \x3d extract_bits(fraction, 8.0, 16.0) / 255.0;\nfloat byte2 \x3d (last_bit_of_biased_exponent * 128.0 + extract_bits(fraction, 16.0, 23.0)) / 255.0;\nfloat byte1 \x3d (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\nreturn vec4(byte4, byte3, byte2, byte1);\n}\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec4 calculateSlope() {\nfloat pi \x3d 3.141592653589793238;\nfloat dzx \x3d 0.0;\nfloat dzy \x3d 0.0;\nvec4 va,  vb,  vc,  vd,  ve,  vf,  vg,  vh,  vi;\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nif (v_texCoord.s \x3c u_resolution.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (v_texCoord.t \x3c u_resolution.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (v_texCoord.s \x3e 1.0 - u_resolution.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (v_texCoord.t \x3e 1.0 - u_resolution.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nif (v_texCoord.s \x3e\x3d u_resolution.s \x26\x26 (1.0 - u_resolution.s) \x3e\x3d v_texCoord.s \x26\x26 v_texCoord.t \x3e\x3d u_resolution.t \x26\x26 (1.0 - u_resolution.t) \x3e\x3d v_texCoord.t) {\nva \x3d texture2D(u_image, v_texCoord + u_resolution * axy);\nvb \x3d texture2D(u_image, v_texCoord + u_resolution * bxy);\nvc \x3d texture2D(u_image, v_texCoord + u_resolution * cxy);\nvd \x3d texture2D(u_image, v_texCoord + u_resolution * dxy);\nve \x3d texture2D(u_image, v_texCoord + u_resolution * vec2(0, 0));\nvf \x3d texture2D(u_image, v_texCoord + u_resolution * fxy);\nvg \x3d texture2D(u_image, v_texCoord + u_resolution * gxy);\nvh \x3d texture2D(u_image, v_texCoord + u_resolution * hxy);\nvi \x3d texture2D(u_image, v_texCoord + u_resolution * ixy);\n}\ndzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r / (8.0 * u_cellSize[0]);\ndzy \x3d -(vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r / (8.0 * u_cellSize[1]);\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\nfloat slope \x3d atan(u_zfactor * sqrt(dzx * dzx + dzy * dzy)) * 57.2957795;\nreturn vec4(slope, slope, slope, alpha);\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\ngl_FragColor \x3d calculateSlope();\n}",
stretch:"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nvarying vec2 v_texCoord;\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput[3];\nuniform float u_maxOutput[3];\nuniform float u_factor[3];\nuniform int u_bandCount;\nuniform vec2 u_sourceDim;\nuniform vec2 u_targetDim;\nuniform int u_state;\nuniform bool u_minMaxTexture;\nuniform bool u_useGamma;\nuniform float u_gamma[4];\nuniform float u_gammaCorrection[4];\nuniform bool u_scaled;\nuniform vec2 u_rawResolution;\nuniform int u_resampling;\nvec4 getPixelValue(vec2 coords) {\nif (u_resampling \x3d\x3d 0) {\nreturn texture2D(u_image, coords);\n}\nvec2 pos_ul \x3d floor(coords / u_rawResolution) * u_rawResolution;\nvec2 pos_ur \x3d pos_ul + vec2(1.0, 0.0) * u_rawResolution;\nvec2 pos_ll \x3d pos_ul + vec2(0.0, 1.0) * u_rawResolution;\nvec2 pos_lr \x3d pos_ul + vec2(1.0, 1.0) * u_rawResolution;\nvec2 weight \x3d fract(coords / u_rawResolution);\nvec4 vp_ul \x3d texture2D(u_image, pos_ul);\nvec4 vp_ur \x3d texture2D(u_image, pos_ur);\nvec4 vp_ll \x3d texture2D(u_image, pos_ll);\nvec4 vp_lr \x3d texture2D(u_image, pos_lr);\nvec4 vp \x3d mix(mix(vp_ul, vp_ur, weight.x), mix(vp_ll, vp_lr, weight.x), weight.y);\nif (u_bandCount \x3d\x3d 1) {\nfloat alpha \x3d vp_ul.a * vp_ur.a * vp_ll.a * vp_lr.a;\nvec4 vp_nn \x3d texture2D(u_image, coords);\nreturn alpha \x3d\x3d 0.0 ? vp_nn : vec4(vp.rgb, alpha);\n}\nreturn vp;\n}\nvec4 findMin(vec4 p1, vec4 p2) {\nif (p1.a \x3d\x3d 0.0) {\nreturn p2;\n} else if (p2.a \x3d\x3d 0.0) {\nreturn p1;\n} else {\nreturn vec4(min(p1.r, p2.r),min(p1.g, p2.g),min(p1.b, p2.b),p1.a);\n}\n}\nvec4 findMax(vec4 p1, vec4 p2) {\nif (p1.a \x3d\x3d 0.0) {\nreturn p2;\n} else if (p2.a \x3d\x3d 0.0) {\nreturn p1;\n} else {\nreturn vec4(max(p1.r, p2.r),max(p1.g, p2.g),max(p1.b, p2.b),p1.a);\n}\n}\nvec4 findMinMax(vec4 p1, vec4 p2) {\nif (p1.a \x3d\x3d 0.0) {\nreturn p2;\n} else if (p2.a \x3d\x3d 0.0) {\nreturn p1;\n} else {\nreturn vec4(min(p1.r, p2.r), max(p1.g, p2.g), 0.0, p1.a);\n}\n}\nvec4 minMax(int state) {\nvec2 pixelFract \x3d fract(v_texCoord * u_sourceDim);\nfloat xshift \x3d ((pixelFract.s \x3e\x3d 0.5 || pixelFract.s \x3d\x3d 0.0) ? -1.0 : 1.0) / u_sourceDim.s; //take left pixel if \x3e 0.5\nfloat yshift \x3d ((pixelFract.s \x3e\x3d 0.5 || pixelFract.s \x3d\x3d 0.0) ? -1.0 : 1.0) / u_sourceDim.t; //take bottom pixel if \x3e 0.5\nif (u_sourceDim.s \x3d\x3d 1.0) {\nxshift \x3d 0.0;\n}\nif (u_sourceDim.t \x3d\x3d 1.0) {\nyshift \x3d 0.0;\n}\nvec4 p1 \x3d texture2D(u_image, v_texCoord);\nvec4 p2 \x3d texture2D(u_image, v_texCoord + vec2(xshift, 0.0));\nvec4 p3 \x3d texture2D(u_image, v_texCoord + vec2(0.0, yshift));\nvec4 p4 \x3d texture2D(u_image, v_texCoord + vec2(xshift, yshift));\nvec4 pval;\nif (state \x3d\x3d 2) {\npval \x3d findMinMax(findMinMax(p1, p2), findMinMax(p3, p4));\n} else if (state \x3d\x3d 1) {\npval \x3d findMax(findMax(p1, p2), findMax(p3, p4));\n} else if (state \x3d\x3d 0) {\npval \x3d findMin(findMin(p1, p2), findMin(p3, p4));\n}\nreturn pval;\n}\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool scaled) {\nfloat stretchedVal;\nif (val \x3e minCutOff \x26\x26 val \x3c maxCutOff) {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n} else if (val \x3e\x3d maxCutOff) {\nstretchedVal \x3d maxOutput;\n} else {\nstretchedVal \x3d minOutput;\n}\nif (scaled) {\nreturn stretchedVal;\n}\nelse {\nreturn stretchedVal / maxOutput; //0-1\n}\n}\nfloat stretchOneValueGamma(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, float gamma, float gammaCorrection, bool scaled) {\nfloat stretchedVal;\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (val \x3e minCutOff \x26\x26 val \x3c maxCutOff) {\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d floor(tempf * outRange * pow(relativeVal, 1.0 / gamma)) + minOutput;\n}\nelse if (val \x3e\x3d maxCutOff) {\nstretchedVal \x3d maxOutput;\n} else {\nstretchedVal \x3d minOutput;\n}\nif (scaled) {\nreturn stretchedVal;\n}\nelse {\nreturn stretchedVal / maxOutput; //0-1\n}\n}\nbool isOutside(){\nif (v_texCoord.t\x3e1.00001 ||v_texCoord.t\x3c-0.00001 || v_texCoord.s\x3e1.00001 ||v_texCoord.s\x3c-0.00001) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn true;\n}\nelse {\nreturn false;\n}\n}\nvoid main() {\nif (isOutside()) {\nreturn;\n}\nif (u_state \x3d\x3d 100) {\nvec4 currentPixel \x3d getPixelValue(v_texCoord);\nfloat grayVal,\nredVal,\ngreenVal,\nblueVal;\nfloat min0,\nmax0,\nmin1,\nmax1,\nmin2,\nmax2,\nfactor0,\nfactor1,\nfactor2;\nvec4 minV, maxV;\nif (u_minMaxTexture) {\nif (u_bandCount \x3d\x3d 1) {\nminV \x3d texture2D(u_image1, v_texCoord);\nmin0 \x3d minV.r;\nmax0 \x3d minV.g;\nfactor0 \x3d (u_maxOutput[0] - u_minOutput[0]) / (max0 - min0);\n} else {\nminV \x3d texture2D(u_image1, v_texCoord);\nmaxV \x3d texture2D(u_image2, v_texCoord);\nmin0 \x3d minV.r;\nmax0 \x3d maxV.r;\nmin1 \x3d minV.g;\nmax1 \x3d maxV.g;\nmin2 \x3d minV.b;\nmax2 \x3d maxV.b;\nfactor0 \x3d (u_maxOutput[0] - u_minOutput[0]) / (max0 - min0);\nfactor1 \x3d (u_maxOutput[1] - u_minOutput[1]) / (max1 - min1);\nfactor2 \x3d (u_maxOutput[2] - u_minOutput[2]) / (max2 - min2);\n}\n} else {\nmin0 \x3d u_minCutOff[0];\nmax0 \x3d u_maxCutOff[0];\nmin1 \x3d u_minCutOff[1];\nmax1 \x3d u_maxCutOff[1];\nmin2 \x3d u_minCutOff[2];\nmax2 \x3d u_maxCutOff[2];\nfactor0 \x3d u_factor[0];\nfactor1 \x3d u_factor[1];\nfactor2 \x3d u_factor[2];\n}\nif (u_useGamma){\nif (u_bandCount \x3d\x3d 1) {\ngrayVal \x3d stretchOneValueGamma(float(currentPixel.r), min0, max0, u_minOutput[0], u_maxOutput[0], factor0, u_gamma[0], u_gammaCorrection[0], u_scaled);\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n} else {\nredVal \x3d stretchOneValueGamma(float(currentPixel.r), min0, max0, u_minOutput[0], u_maxOutput[0], factor0, u_gamma[0], u_gammaCorrection[0], u_scaled);\ngreenVal \x3d stretchOneValueGamma(float(currentPixel.g), min1, max1, u_minOutput[1], u_maxOutput[1], factor1, u_gamma[1], u_gammaCorrection[1], u_scaled);\nblueVal \x3d stretchOneValueGamma(float(currentPixel.b), min2, max2, u_minOutput[2], u_maxOutput[2], factor2, u_gamma[1], u_gammaCorrection[2], u_scaled);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n}\n}\nelse {\nif (u_bandCount \x3d\x3d 1) {\ngrayVal \x3d stretchOneValue(float(currentPixel.r), min0, max0, u_minOutput[0], u_maxOutput[0], factor0, u_scaled);\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n} else {\nredVal \x3d stretchOneValue(float(currentPixel.r), min0, max0, u_minOutput[0], u_maxOutput[0], factor0, u_scaled);\ngreenVal \x3d stretchOneValue(float(currentPixel.g), min1, max1, u_minOutput[1], u_maxOutput[1], factor1, u_scaled);\nblueVal \x3d stretchOneValue(float(currentPixel.b), min2, max2, u_minOutput[2], u_maxOutput[2], factor2, u_scaled);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n}\n}\n} else {\nvec4 currentPixel \x3d minMax(u_state);\ngl_FragColor \x3d currentPixel;\n}\n}"}})},
"esri/layers/rasterLib/function/RasterFunctionWebGLMixin":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ./pixelShaders ./vertexShaders ./webglHelper ./convolutionKernel".split(" "),function(H,m,n,r,l,k,b){return H(null,{gl:null,rgbaFloatData:null,originalTexture:null,lastTexture:null,renderTexture:!1,constructor:function(a){this._isProgramInitialized=!1;this.gl=a&&a.gl;a&&a.renderTexture&&(this.renderTexture=a.renderTexture);this._xformSetting=a&&a._xformSetting||{requireProjection:!1,
meshSize:[20,20]}},bindFrameBuffer:function(){var a=this.gl;this._setupPingPongTextures();this._setupBranchingTextures();var d=this._glSetting;this.isBranch?(d.branchIndex=(d.branchIndex+1)%d.branchCount,d=d.branches[d.branchIndex]):(d.pingpongIndex=(d.pingpongIndex+1)%d.pingpong.length,d=d.pingpong[d.pingpongIndex]);a.bindFramebuffer(a.FRAMEBUFFER,d.frameBuffer);a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight);return d},_initializeProgram:function(a){if(this.gl)try{var d=this.gl;d.viewport(0,
0,d.drawingBufferWidth,d.drawingBufferHeight);var f=this._glSetting.programUniforms,e="local"===this.functionName?"local"+this.functionArguments.operation:this.functionName,h=f[e];if(h)this._uniforms=h.uniforms,this.rasterProgram=h.program;else{var c=(this._useMesh=this._tileMode&&this._xformSetting.requireProjection)?l.mesh:l.basic,g=l.getShader(d,a.vertex||c),p=r.getShader(d,a.fragment),q=this._loadProgram(g,p),u={rasterProgram:k.getUniforms(d,q)};f[e]={uniforms:u,program:q};this.rasterProgram=
q;this._uniforms=u}d.useProgram(this.rasterProgram);var v=d.getAttribLocation(this.rasterProgram,"a_texCoord"),t=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,t);var y=k.createMesh(this._xformSetting.meshSize);d.bufferData(d.ARRAY_BUFFER,y,d.STATIC_DRAW);d.enableVertexAttribArray(v);d.vertexAttribPointer(v,2,d.FLOAT,!1,0,0);d.disable(d.DEPTH_TEST);d.blendFunc(d.SRC_ALPHA,d.ZERO);d.disable(d.BLEND);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1);this._shaderInfo=
{fragment:a.fragmentName}}catch(C){console.error("webgl exception: "+C.message)}else console.error("WebGL is required.")},_setUniform:function(a,d,f){null!=d&&(f&&!this._uniforms[f]&&(this._uniforms[f]=k.getUniforms(this.gl,this[f])),f=f?this._uniforms[f]:this._uniforms.rasterProgram,(a=f[a]||f[a+"[0]"])&&k.setUniform(this.gl,a,d))},_setUniforms:function(a,d){var f=Object.keys(a),e,h=f.length;for(e=0;e<h;e++)this._setUniform(f[e],a[f[e]],d);this.rawInput?this._setUniform("u_flipY",!0,d):this._setUniform("u_flipY",
!1,d);this._tileMode?(this.rawInput?(a=this._xformSetting.offset,f=this._xformSetting.scale):(a=[0,0],f=[1,1]),this._setUniform("u_xformOffset",a,d),this._setUniform("u_xformScale",f,d),this._xformSetting.requireProjection&&(this.rawInput?(this._setupXformTexture(),this._setUniform("u_projection",!0,d),this._setUniform("u_transformGridSize",this._xformSetting.gridConfig.size,d),this._setUniform("u_transformSpacing",this._xformSetting.gridConfig.spacing,d),this._setUniform("u_targetImageSize",new Float32Array([this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight]),d)):this._setUniform("u_projection",!1,d))):(a=[0,0],f=[1,1],this._setUniform("u_xformOffset",a,d),this._setUniform("u_xformScale",f,d));this.rawInput&&this._rawResolution&&("RSP_BilinearInterpolation"===this.interpolation||"RSP_CubicConvolution"===this.interpolation)?(this._setUniform("u_resampling",1),this._setUniform("u_rawResolution",this._rawResolution)):this._setUniform("u_resampling",0)},_setupTextureData:function(a,d){if(a.texture)return a;a.raster&&a.raster.pixelBlock&&
(a=a.raster);this.rawInput=!0;var f=d&&d.notOriginal,e=d&&d.bandIDs;d&&d.reCreate?d=!1:(d=this._tileMode?!this._xformSetting.hasNewTexture:!this._glSetting.hasNewTexture)&&this._originalBandIDs&&(d=e?this._originalBandIDs.join("")===e.join(""):!1);0<this._glSetting.branchCount&&(d=!1);if(d&&this.originalTexture)return{extent:a.extent,texture:this.originalTexture};d=this._createTexture();f||(this.originalTexture=d,this._originalBandIDs=e);f=this.gl;var h=a.pixelBlock;this._rawResolution=h?[1/a.pixelBlock.width,
1/a.pixelBlock.height]:[1/this.gl.drawingBufferWidth,1/this.gl.drawingBufferHeight];var c=0;e&&0<e.length&&h&&(c=Math.max.apply(null,e),h.pixels.length>c&&e&&(h.pixels=e.map(function(p){return h.pixels[p]}),h.statistics&&(h.statistics=e.map(function(p){return h.statistics[p]}))));e=h.width;c=h.height;f.getExtension("OES_texture_float");var g=h.getAsRGBAFloat();f.texImage2D(f.TEXTURE_2D,0,f.RGBA,e,c,0,f.RGBA,f.FLOAT,g);return{extent:a.extent,texture:d}},_setupPingPongTextures:function(){var a=this._glSetting;
if(!a||!a.pingpong){a.pingpong=[];var d=k.createBufferTexture(this.gl,!1);a.pingpong.push(d);d=k.createBufferTexture(this.gl,!1);a.pingpong.push(d);a.pingpongIndex=1}},_setupBranchingTextures:function(){var a=this._glSetting;if(!a||!a.branches){a.branches=[];var d=0,f=a.branchCount;if(0<f){for(d=0;d<f;d++){var e=k.createBufferTexture(this.gl,!1);a.branches.push(e)}a.branchIndex=f-1}}},_setupXformTexture:function(a){for(var d=this._createTexture(),f=this.gl,e=4*this._xformSetting.gridConfig.size[0],
h=this._xformSetting.gridConfig.size[1],c=new Float32Array(e*h*4),g=0,p=0;p<this._xformSetting.gridConfig.coefficients.length;p++)c[g++]=this._xformSetting.gridConfig.coefficients[p],2===p%3&&(c[g++]=1);f.getExtension("OES_texture_float");f.texImage2D(f.TEXTURE_2D,0,f.RGBA,e,h,0,f.RGBA,f.FLOAT,c);this._bindTexture(d,"u_transformGrid",a)},_createTexture:function(a){return k.createTexture(this.gl,a)},_bindTexture:function(a,d,f){d=d||"u_image";f=this._uniforms[f||"rasterProgram"];var e=this._getTextureIndex(d);
if(-1!==e){var h=this.gl;h.uniform1i(f[d].location,e);h.activeTexture(h.TEXTURE0+e);h.bindTexture(h.TEXTURE_2D,a)}},_getTextureIndex:function(a,d){d=this._uniforms[d||"rasterProgram"];if(!d||!d[a]||d[a].info.type!==this.gl.SAMPLER_2D)return-1;if("u_transformGrid"===a)return 0;a="u_image"===a?0:parseInt(a.replace("u_image",""));return this._xformSetting.requireProjection?a+1:a},_drawGL:function(a){var d=this.gl;this.renderTexture?(d.enable(d.BLEND),d.bindFramebuffer(d.FRAMEBUFFER,null)):d.disable(d.BLEND);
a||d.viewport(0,0,d.drawingBufferWidth,d.drawingBufferHeight);a=this._xformSetting.meshSize||[1,1];d.drawArrays(d.TRIANGLES,0,a[0]*a[1]*6);this._drawMesh()},_drawMesh:function(){if(this.renderTexture&&this._glSetting.drawMesh){this.meshProgram=this.meshProgram||this._setupMeshProgram();var a=this.gl;a.useProgram(this.meshProgram);a.bindFramebuffer(a.FRAMEBUFFER,null);var d=a.getAttribLocation(this.meshProgram,"a_texCoord"),f=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,f);f=this._xformSetting.meshSize||
[1,1];var e=k.createMesh(f,!0);a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW);a.enableVertexAttribArray(d);a.vertexAttribPointer(d,2,a.FLOAT,!1,0,0);a.disable(a.DEPTH_TEST);a.blendFunc(a.ONE,a.ZERO);this._setUniforms({u_color:[0,0,1,1],u_drawMeshLines:!0},"meshProgram");a.drawArrays(a.LINES,0,f[0]*f[1]*10)}},_setupMeshProgram:function(){var a=l.getShader(this.gl,l.mesh),d=r.getShader(this.gl,r.constant);return this._loadProgram(a,d)},_loadProgram:function(a,d){return k.loadProgram(this.gl,a,d)},_getShaderScript:function(a,
d){d=document.getElementById(d);if(!d)return null;a="";for(d=d.firstChild;d;)3==d.nodeType&&(a+=d.textContent),d=d.nextSibling;return a}})})},"esri/layers/rasterLib/function/webglHelper":function(){define([],function(){var H={getUniforms:function(m,n){var r=m.getProgramParameter(n,m.ACTIVE_UNIFORMS),l,k,b={};for(l=0;l<r;l++)(k=m.getActiveUniform(n,l))&&(b[k.name]={location:m.getUniformLocation(n,k.name),info:k});return b},setUniform:function(m,n,r){var l=n.info,k=n.location,b=l.type;if(null==r)console.log("uniform "+
n.info.name+" has null or undefined value");else switch(b){case m.FLOAT:1<l.size?0===r.length?console.log("uniform "+n.info.name+" has length 0"):m.uniform1fv(k,r):m.uniform1f(k,r);break;case m.FLOAT_VEC2:if(0===r.length){console.log("uniform "+n.info.name+" has length 0");break}m.uniform2fv(k,r);break;case m.FLOAT_VEC3:if(0===r.length){console.log("uniform "+n.info.name+" has length 0");break}m.uniform3fv(k,r);break;case m.FLOAT_VEC4:if(0===r.length){console.log("uniform "+n.info.name+" has length 0");
break}m.uniform4fv(k,r);break;case m.INT:case m.BOOL:1<l.size?0===r.length?console.log("uniform "+n.info.name+" has length 0"):m.uniform1iv(k,r):m.uniform1i(k,r);break;case m.INT_VEC2:case m.BOOL_VEC2:if(0===r.length){console.log("uniform "+n.info.name+" has length 0");break}m.uniform2iv(k,r);break;case m.INT_VEC3:case m.BOOL_VEC3:if(0===r.length){console.log("uniform "+n.info.name+" has length 0");break}m.uniform3iv(k,r);break;case m.INT_VEC4:case m.BOOL_VEC4:0===r.length?console.log("uniform "+
n.info.name+" has length 0"):m.uniform4iv(k,r)}},createTexture:function(m,n){var r=m.createTexture();m.bindTexture(m.TEXTURE_2D,r);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,n?m.LINEAR:m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,n?m.LINEAR:m.NEAREST);return r},createBufferTexture:function(m,n,r){n=H.createTexture(m,n);m.getExtension("OES_texture_float");
r=r||[m.drawingBufferWidth,m.drawingBufferHeight];m.texImage2D(m.TEXTURE_2D,0,m.RGBA,r[0],r[1],0,m.RGBA,m.FLOAT,null);r=m.createFramebuffer();m.bindFramebuffer(m.FRAMEBUFFER,r);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,n,0);return{texture:n,frameBuffer:r}},getShader:function(m,n,r){r=r?m.createShader(m.VERTEX_SHADER):m.createShader(m.FRAGMENT_SHADER);m.shaderSource(r,n);m.compileShader(r);m.getShaderParameter(r,m.COMPILE_STATUS)||(console.log(m.getShaderInfoLog(r)),r=null);
return r},loadProgram:function(m,n,r){var l=m.createProgram();m.attachShader(l,n);m.attachShader(l,r);m.linkProgram(l);m.getProgramParameter(l,m.LINK_STATUS)||(console.warn("failed to load webgl program: "+m.getProgramInfoLog(l)),m.deleteProgram(l),l=null);return l},createMesh:function(m,n){if(!m||1===m[0]&&1===m[1])return new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);var r=m&&n?new Float32Array(m[0]*m[1]*20):new Float32Array(m[0]*m[1]*12);var l=.9998/m[1],k=.9998/m[0],b,a,d=0;for(b=0;b<m[1];b++)for(a=
0;a<m[0];a++){var f=1E-4+l*b;var e=1E-4+k*a;m&&!n?(r[d++]=f,r[d++]=e,r[d++]=f+l,r[d++]=e,r[d++]=f,r[d++]=e+k,r[d++]=f,r[d++]=e+k,r[d++]=f+l,r[d++]=e,r[d++]=f+l,r[d++]=e+k):(r[d++]=f,r[d++]=e,r[d++]=f,r[d++]=e+k,r[d++]=f,r[d++]=e+k,r[d++]=f+l,r[d++]=e+k,r[d++]=f+l,r[d++]=e+k,r[d++]=f+l,r[d++]=e,r[d++]=f,r[d++]=e,r[d++]=f+l,r[d++]=e,r[d++]=f,r[d++]=e+k,r[d++]=f+l,r[d++]=e)}return r}};return H})},"esri/layers/rasterLib/function/convolutionKernel":function(){define([],function(){var H={Default:[0,0,0,
0,1,0,0,0,0],LineDetectionHorizontal:[-1,-1,-1,2,2,2,-1,-1,-1],LineDetectionVertical:[-1,2,-1,-1,2,-1,-1,2,-1],LineDetectionLeftDiagonal:[2,-1,-1,-1,2,-1,-1,-1,2],LineDetectionRightDiagonal:[-1,-1,2,-1,2,-1,2,-1,-1],GradientNorth:[-1,-2,-1,0,0,0,1,2,1],GradientWest:[-1,0,1,-2,0,2,-1,0,1],GradientEast:[1,0,-1,2,0,-2,1,0,-1],GradientSouth:[1,2,1,0,0,0,-1,-2,-1],GradientNorthEast:[0,-1,-2,1,0,-1,2,1,0],GradientNorthWest:[-2,-1,0,-1,0,1,0,1,2],SmoothArithmeticMean:[.111111111111,.111111111111,.111111111111,
.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111],Smoothing3x3:[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625],Smoothing5x5:[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1],Sharpening3x3:[-1,-1,-1,-1,9,-1,-1,-1,-1],Sharpening5x5:[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1],Laplacian3x3:[0,-1,0,-1,4,-1,0,-1,0],Laplacian5x5:[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0],SobelHorizontal:[-1,-2,-1,0,0,0,1,2,1],SobelVertical:[-1,
0,1,-2,0,2,-1,0,1],Sharpen:[0,-.25,0,-.25,2,-.25,0,-.25,0],Sharpen2:[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25],PointSpread:[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627],getKernel:function(m){switch(m){case 0:return H.LineDetectionHorizontal;case 1:return H.LineDetectionVertical;case 2:return H.LineDetectionLeftDiagonal;case 3:return H.LineDetectionRightDiagonal;case 4:return H.GradientNorth;case 5:return H.GradientWest;case 6:return H.GradientEast;case 7:return H.GradientSouth;case 8:return H.GradientNorthEast;
case 9:return H.GradientNorthWest;case 10:return H.SmoothArithmeticMean;case 11:return H.Smoothing3x3;case 12:return H.Smoothing5x5;case 13:return H.Sharpening3x3;case 14:return H.Sharpening5x5;case 15:return H.Laplacian3x3;case 16:return H.Laplacian5x5;case 17:return H.SobelHorizontal;case 18:return H.SobelVertical;case 19:return H.Sharpen;case 20:return H.Sharpen2;case 21:return H.PointSpread;default:return H.Default}}};return H})},"esri/layers/rasterLib/raster/rasterFactory":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/sniff dojo/when ../../../kernel ../../../Evented ../../../request ../../../deferredUtils ../../../urlUtils ./ImageServiceRaster ./TileServiceRaster ./TileRaster ./FunctionRaster".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u){H={customDrivers:[],create:function(v){if(v){if(v.url){var t=c.urlToObject(v.url);var y=t.path;var C=t.query}t=v.serviceInfo;var B=v.rasterFxArgs||{},F=new r,x=n.hitch(this,function(G){console.error(G);this._trycustomDrivers(n.mixin({url:y},v),0,F)});if(y)if(-1===y.toLowerCase().indexOf("imageserver")&&-1===y.toLowerCase().indexOf("mapserver")){var w=new q(n.mixin({},v,{url:y}));v.rasterFx&&(w=new u({rasterFx:v.rasterFx,rasterFxArgs:n.mixin({},B,{raster:w})}));
var A=w}else{A=new r;t=t||this._getServiceInfo(y,C);var z=n.hitch(this,function(G){G.bandCount?w=new g(n.mixin({},{serviceInfo:G},C,v,{url:y})):G.tileInfo&&(w=new p(n.mixin({},{serviceInfo:G},C,this._options,{url:y})));v.rasterFx&&(w=new u({rasterFx:v.rasterFx,rasterFxArgs:n.mixin({},B,{raster:w})}));A.resolve(w)});a(t,z,x)}else A=w=new u({rasterFx:v.rasterFx,rasterFxArgs:n.mixin({},B,{raster:w})});a(A,n.hitch(this,function(G){G?G.open().then(n.hitch(this,function(J){F.resolve(G)}),x):x(Error("There is no raster to open"))}),
x);return F.promise}},register:function(v){this.customDrivers=this.customDrivers||[];0<this.customDrivers.filter(function(t){return t.sourceType===v.prototype.sourceType}).length||this.customDrivers.push(v)},_trycustomDrivers:function(v,t,y){y=y||new r;var C=this.customDrivers[t];if(C){var B=new C(v);B.open().then(n.hitch(this,function(F){y.resolve(B)}),n.hitch(this,function(F){this._trycustomDrivers(v,t+1,y)}))}else y.reject("cannot load layer "+(v&&v.url||""));return y.promise},_getServiceInfo:function(v,
t){t=t||{};var y=t.bandIds;t=t.renderingRule;var C=new r(h._dfdCanceller),B={f:"json"};y&&(B.bandIds=y);t&&(B.renderingRule=t.toJson?JSON.stringify(t.toJson()):JSON.stringify(t));C._pendingDfd=e({url:v,content:B,handleAs:"json",callbackParamName:"callback"});C._pendingDfd.then(function(F){C.callback(F)},function(F){C.errback(F)});return C.promise}};b("extend-esri")&&n.setObject("layers.rasterLib.raster.rasterFactory",H,d);return H})},"esri/layers/rasterLib/raster/ImageServiceRaster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/_base/json dojo/sniff dojo/DeferredList dojo/when ../../../kernel ../../../Evented ../../../request ../../../geometry/Extent ../../../geometry/Point ../../../SpatialReference ../../../WKIDUnitConversion ../../../deferredUtils ../../../urlUtils ../../MosaicRule ../../ImageServiceParameters ../../PixelBlock ./RasterInfo ./BasicRaster ../../rasterFormats/rasterCodec ../tile/RasterTileInfo".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A){H=m([x],{declaredClass:"esri.layers.rasterLib.raster.ImageServiceRaster",sourceType:"ImageService",constructor:function(z){z&&(this._imageServiceParams=z.imageServiceParameters,this._commonReqParams=z._commonReqParams,this._imageServiceParams||(this._imageServiceParams={interpolation:z.interpolation,pixelType:z.pixelType,format:z.format||"lerc",compressionQuality:z.compressionQuality,bandIds:z.bandIds,noDataInterpretation:z.noDataInterpretation,
adjustAspectRatio:z.adjustAspectRatio,mosaicRule:z.mosaicRule,renderingRule:z.interpolation}))},open:function(){var z=new r;if(this.serviceInfo&&this.rasterInfo)return this.loaded=!0,this._findCredential(),this.setFetchParameters(this._imageServiceParams),z.resolve(this),z.promise;var G=this.serviceInfo||this._generateServiceInfo(this._imageServiceParams&&this._imageServiceParams.renderingRule),J=n.hitch(this,function(R){this._fixServiceInfo(R);this.serviceInfo=R;this._findCredential();var T=this._parseRasterInfo(R),
aa={};R.defaultMosaicMethod?(aa.method=R.defaultMosaicMethod,aa.operation=R.mosaicOperator,aa.sortField=R.sortField,aa.sortValue=R.sortValue):aa.method=y.METHOD_NONE;this.serviceInfo.defaultMosaicRule=new y(aa);this.serviceInfo.defaultMosaicRule.ascending=!0;R=this._getColormap(this);aa=this._getHistograms(this);var ca=this._getRasterAttributeTable(this),ba=this._getKeyProperties(this),la=this._getMultidimensionalInfo(),oa=this._getSlices();(new d([R,aa,ca,ba,la,oa])).then(n.hitch(this,function(fa){fa[0][0]&&
(T.colormap=fa[0][1]);fa[1][0]&&(T.histograms=fa[1][1]);fa[2][0]&&(T.vat=fa[2][1]);fa[3][0]&&(T.keyProperties=fa[3][1]);fa[4][0]&&(T.multidimensionalInfo=fa[4][1],T.multidimensionalInfo&&T.multidimensionalInfo.variables&&T.multidimensionalInfo.variables.forEach(function(M){M.statistics&&(M.statistics.forEach(function(X){X.stddev=X.standardDeviation}),T.statistics||M.statistics.length!==T.bandCount||(T.statistics=M.statistics));!T.histograms&&M.histograms&&M.histograms.length===T.bandCount&&(T.histograms=
M.histograms)}));T.keyProperties=T.keyProperties||{};this._slices=fa[5][0]?fa[5][1]:null;T.keyProperties&&T.keyProperties.DataType&&(this.dataType=T.keyProperties.DataType);T.keyProperties&&T.keyProperties.DefaultVariable&&(this.defaultVariable=T.keyProperties.DefaultVariable);this.loaded=!0;this.rasterInfo=T;this.setFetchParameters(this._imageServiceParams);z.resolve(this)}))}),L=n.hitch(this,function(R){this.loaded=!0;z.reject(R)});f(G,J,L);return z.promise},setFetchParameters:function(z,G){if(G)this.imageServiceParams=
z;else{var J=this.imageServiceParams;J&&z?Object.keys(z).forEach(function(L){J[L]=z[L]}):this.imageServiceParams=z}this._constructGetImageParams();this._getRasterIdentifier(!0)},read:function(z){if(z.pixelBlock||z.texture){var G=new r;G.resolve(z);return G.promise}if(!1===z.virtual&&this.tileInfo&&!this.tileInfo.virtual)return this.readTile(z);if(this._slices){var J=this._getSliceId();if(null==J)return G=new r,G.resolve(z),G.promise}var L=z.extent,R=L.spatialReference.wkid||b.toJson(L.spatialReference.toJson(!1)),
T=z.timeExtent?z.timeExtent.toJson().join(","):null;G=this.url+"/exportImage";var aa={};this._slices&&(aa.sliceid=J);this.disableClientCaching&&(aa._ts=(new Date).getTime());J=n.mixin({},this._commonReqParams,{bbox:L.xmin+","+L.ymin+","+L.xmax+","+L.ymax,imageSR:R,bboxSR:R,size:z.width+","+z.height,time:T},aa);return this._requestPixels({url:G,payload:J,decodeParams:{width:z.width,height:z.height,planes:null,pixelType:null,format:null,decodeFunc:null,isPoint:!1},tileOptions:z})},readTile:function(z){var G=
this.tileBoundary&&this.tileBoundary[z.level];if(G&&(G.minRow>z.row||G.maxRow<z.row||G.minCol>z.col||G.maxCol<z.col)){var J=new r;J.resolve(z);return J.promise}if(this._slices&&(J=this._getSliceId(),null==J))return J=new r,J.resolve(z),J.promise;G=this.url+"/tile/"+z.level+"/"+z.row+"/"+z.col;var L={width:this.tileInfo.cols,height:this.tileInfo.rows,planes:null,pixelType:null,format:null,decodeFunc:null,useWasm:!0,isPoint:"elevation"===z.tileType.toLowerCase()?!0:!1};J=this._slices?"sliceid\x3d"+
J+"\x26":"";J=this.disableClientCaching?"_ts\x3d "+(new Date).getTime():J.replace(/&$/,"");return this._requestPixels({url:G+(0<J.length?"?"+J:""),payload:{},decodeParams:L,tileOptions:z})},toJson:function(){return{url:this.url,tileInfo:this.tileInfo,rasterInfo:this.rasterInfo,serviceInfo:this.serviceInfo,sourceType:this.sourceType,_commonReqParams:this._commonReqParams,_rasterId:this._rasterId}},_getSliceId:function(){var z=n.clone(this._imageServiceParams.multidimensionalDefinition),G=n.clone(this._imageServiceParams.time);
if(null==this._slices||null==G&&(null==z||0===z.length))return 0;var J=z||this.defaultMultidimensionalDefinition,L=J[0].variableName;J=this._getAllDimensionDefinition(J,L).definition;z=null;if(null==J||0===J.length)return null;if(G&&this.serviceInfo.timeInfo){if(null==G[1]||G[1]===G[0])var R=G[0];else{var T=this.serviceInfo.timeInfo.startTimeField;R=this.rasterInfo.multidimensionalInfo.variables.find(function(ba){return ba.name===L}).dimensions.find(function(ba){return ba.name===T}).values.filter(function(ba){return Array.isArray(ba)?
Math.max(ba[0],G[0])<Math.min(ba[1],G[1]):ba>=G[0]&&ba<=G[1]}).sort(function(ba,la){ba=Array.isArray(ba)?ba[1]:ba;la=Array.isArray(la)?ba[1]:la;return Math.abs(G[1]-ba)-Math.abs(G[1]-la)})[0]||[G[1]]}J.some(function(ba){if(ba.dimensionName===T)return ba.values[0]=R,!0;if(!ba.dimensionName)return ba.dimensionName=T,ba.isSlice=!0,ba.values=[R],!0})||J.push({variableName:L,dimensionName:T,isSlice:!0,values:[R]})}for(var aa=0;aa<this._slices.length;aa++){var ca=this._slices[aa].multidimensionalDefinition;
if(ca.length===J.length&&!ca.some(function(ba){var la=J.filter(function(fa){return ba.variableName===fa.variableName&&fa.dimensionName===ba.dimensionName})[0];if(!la)return!0;var oa=Array.isArray(ba.values[0])?ba.values[0][0]:ba.values[0];la=Array.isArray(la.values[0])?la.values[0][0]:la.values[0];return oa!==la})){z=aa;break}}return z},_getAllDimensionDefinition:function(z,G){var J=z.map(function(R){return R.dimensionName}),L=!1;this.rasterInfo.multidimensionalInfo.variables.forEach(function(R){R.name!==
G||R.dimensions.length===z.length&&J[0]||(R.dimensions.forEach(function(T){0>J.indexOf(T.name)&&(J[0]?z.push({variableName:G,dimensionName:T.name,values:[T.values[0]]}):(z[0].dimensionName=T.name,z[0].values=[T.values[0]],T[0]=T.name))}),L=!0)},this);return{defChanged:L,definition:z}},_generateServiceInfo:function(z){var G=this.url,J=new r(v._dfdCanceller);J._pendingDfd=c({url:G,content:{f:"json",renderingRule:z?b.toJson(z.toJson()):null},handleAs:"json",callbackParamName:"callback"});J._pendingDfd.then(function(L){J.callback(L)},
function(L){J.errback(L)});return J},_fixServiceInfo:function(z){var G=z.spatialReference.wkid;z.tileInfo&&0===z.extent.xmin&&360===z.extent.xmax&&G&&null==u[G]&&(z.tileInfo.applyGCS360Transform=!0)},_parseRasterInfo:function(z){var G=new F;G.bandCount=z.bandCount;G.extent=new g(z.fullExtent);G.spatialReference=z.spatialReference;G.pixelType=z.pixelType;G.width=Math.floor((z.fullExtent.xmax-z.fullExtent.xmin)/z.pixelSizeX+.5);G.height=Math.floor((z.fullExtent.ymax-z.fullExtent.ymin)/z.pixelSizeY+
.5);G.cellSize=new p({x:z.pixelSizeX,y:z.pixelSizeY,spatialReference:z.spatialReference});var J;if(z.minValues&&0<z.minValues.length&&z.maxValues&&z.stdvValues&&z.meanValues){var L=[];for(J=0;J<z.minValues.length;J++)L.push({min:z.minValues[J],max:z.maxValues[J],mean:z.meanValues[J],stddev:z.stdvValues[J]});z.bandCount!==L.length&&(L=null)}this.dataType=z.serviceDataType?z.serviceDataType.replace("esriImageServiceDataType",""):"Generic";G.statistics=L;z.objectIdField&&z.fields&&(G.catalogInfo={objectIdField:z.objectIdField,
fields:z.fields});G.timeInfo=z.timeInfo;if(z.tileInfo){this.tileInfo=new A(z.tileInfo);this.tileInfo.tileType=z.cacheType||"Map";G.tileInfo=this.tileInfo;var R=G.extent,T=this.tileInfo.origin,aa=this.tileInfo.cols,ca=this.tileInfo.rows;this.tileBoundary=this.tileInfo.lods.map(function(ba){return{minCol:Math.floor((R.xmin-T.x+.1*ba.resolution)/aa/ba.resolution),maxCol:Math.floor((R.xmax-T.x-.1*ba.resolution)/aa/ba.resolution),minRow:Math.floor((T.y-R.ymax+.1*ba.resolution)/ca/ba.resolution),maxRow:Math.floor((T.y-
R.ymin-.1*ba.resolution)/ca/ba.resolution)}})}return G},_getColormap:function(z){z=this.url+"/colormap";var G=new r(v._dfdCanceller),J={f:"json"},L=this.serviceInfo.hasColormap||this.rasterInfo&&this.rasterInfo.hasColormap;10<this.serviceInfo.currentVersion&&L?(G._pendingDfd=c({url:z,content:J,handleAs:"json",callbackParamName:"callback"}),G._pendingDfd.then(function(R){G.callback(R.colormap)},function(R){G.errback(R)})):G.callback(null);return G},_getHistograms:function(z){var G=this.url+"/histograms",
J=new r(v._dfdCanceller),L={f:"json"},R=this.serviceInfo.hasHistograms||this.rasterInfo&&this.rasterInfo.hasHistograms;z&&z.renderingRule&&(L.renderingRule=b.toJson(z.renderingRule.toJson()),R=!0);10<this.serviceInfo.currentVersion&&R?(J._pendingDfd=c({url:G,content:L,handleAs:"json",callbackParamName:"callback"}),J._pendingDfd.then(function(T){J.callback(T.histograms)},function(T){J.errback(T)})):J.callback(null);return J},_getRasterAttributeTable:function(z){var G=this.url+"/rasterAttributeTable",
J=new r(v._dfdCanceller),L={f:"json"},R=this.serviceInfo.hasRasterAttributeTable;z&&z.renderingRule&&(L.renderingRule=b.toJson(z.renderingRule.toJson()),R=!0);10<this.serviceInfo.currentVersion&&R?(J._pendingDfd=c({url:G,content:L,handleAs:"json",callbackParamName:"callback"}),J._pendingDfd.then(function(T){J.callback(T)},function(T){J.errback(T)})):J.callback(null);return J},_getKeyProperties:function(z){var G=this.url+"/keyProperties",J=new r(v._dfdCanceller),L={f:"json"};z&&z.renderingRule&&(L.renderingRule=
b.toJson(z.renderingRule.toJson()));10<this.serviceInfo.currentVersion?(J._pendingDfd=c({url:G,content:L,handleAs:"json",callbackParamName:"callback"}),J._pendingDfd.then(function(R){J.callback(R)},function(R){J.errback(R)})):J.callback(null);return J},_getMultidimensionalInfo:function(){var z=this.url+"/multidimensionalInfo",G=new r(v._dfdCanceller);10.3<=this.serviceInfo.currentVersion&&this.serviceInfo.hasMultidimensions?(G._pendingDfd=c({url:z,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),
G._pendingDfd.then(n.hitch(this,function(J){G.callback(J.multidimensionalInfo)}),function(J){G.errback(J)})):G.callback(null);return G},_getSlices:function(){var z=this.url+"/slices",G=new r(v._dfdCanceller);this.serviceInfo.hasMultidimensions?(G._pendingDfd=c({url:z,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),G._pendingDfd.then(n.hitch(this,function(J){G.callback(J.slices)}),function(J){G.errback(J)})):G.callback(null);return G},_initializationFailed:function(){},_constructGetImageParams:function(){var z=
this.imageServiceParams||{},G=n.mixin({},this._query,{f:"image",interpolation:z.interpolation,pixelType:z.pixelType,format:z.format||"lerc",compressionQuality:z.compressionQuality,bandIds:z.bandIds?z.bandIds.join(","):null,noData:null!=z.noData?z.noData.join(","):null,noDataInterpretation:z.noDataInterpretation,adjustAspectRatio:null==z.adjustAspectRatio?null:z.adjustAspectRatio,mosaicRule:z.mosaicRule?b.toJson(z.mosaicRule.toJson()):null,renderingRule:z.renderingRule?b.toJson(z.renderingRule.toJson()):
null,token:this.credential&&this.credential.token||null});"lerc"===G.format.toLowerCase()?(G.compressionTolerance=z.compressionTolerance,10.5<=this.serviceInfo.currentVersion&&(G.lercVersion=z.lercVersion||2)):"tiff"===G.format.toLowerCase()?G.compression=z.compression:-1<["jpg","jpeg","jpg","jpgpng"].indexOf(G.format.toLowerCase())&&(G.compression=z.compression);this._commonReqParams=G},_getRasterIdentifier:function(z){if(this._rasterId)return this._rasterId;z=this.url.replace("http:","").replace("https:",
"");var G=[],J=this.imageServiceParams||{};G.push(z);G.push(J.interpolation);G.push(J.pixelType);G.push(J.compressionQuality);G.push(J.bandIds?J.bandIds.join(","):"");G.push(J.mosaicRule?b.toJson(J.mosaicRule.toJson()):"");G.push(J.renderingRule?b.toJson(J.renderingRule.toJson()):"");z=G.join("|");return this._rasterId=this._computeSignature(z)},_wrapExtent:function(z){var G=z.spatialReference._getInfo();if(G){var J=G.valid[0];G=G.valid[1];if(z.xmin<J-this.resolution.x||z.xmax>G+this.resolution.y){var L=
new g((z.xmin-J)%(G-J),z.ymin,(z.xmax-G)%(G-J),z.ymax,z.spatialReference);L.xmax<L.xmin&&(L=null)}}return L||z}});a("extend-esri")&&n.setObject("layers.rasterLib.raster.ImageServiceRaster",H,e);return H})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(H,m,n,r,l,k){H=H(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,
interpolation:null,compressionQuality:null,bandIds:null,timeExtent:null,mosaicRule:null,renderingRule:null,renderer:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(b){var a=this.bbox||this.extent;b=(a=a&&b&&a._normalize(!0))?a.spatialReference.wkid||n.toJson(a.spatialReference.toJson()):null;var d=this.imageSpatialReference;a={bbox:a?a.xmin+","+a.ymin+","+a.xmax+","+a.ymax:null,bboxSR:b,size:null!==this.width&&null!==this.height?this.width+","+this.height:
null,imageSR:d?d.wkid||n.toJson(d.toJson()):b,format:this.format,interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?n.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?n.toJson(this.renderingRule.toJson()):null,renderer:this.renderer?n.toJson(this.renderer.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,
adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};b=this.timeExtent;a.time=b?b.toJson().join(","):null;return k.filter(a,function(f){if(null!==f&&void 0!==f)return!0})}});m.mixin(H,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"});r("extend-esri")&&m.setObject("layers.ImageServiceParameters",
H,l);return H})},"esri/layers/rasterLib/raster/BasicRaster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/_base/json dojo/sniff dojo/DeferredList dojo/when ../../../kernel ../../../Evented ../../../request ../../../geometry/Extent ../../../geometry/Point ../../../SpatialReference ../../../deferredUtils ../../../urlUtils ../../MosaicRule ../../ImageServiceParameters ../../PixelBlock ../../rasterFormats/rasterCodec ../tile/RasterHandler ./rasterProjectionHelper ./RasterInfo".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w){return m([h],{url:null,dataType:null,rasterInfo:null,tileInfo:null,serviceInfo:null,loaded:null,constructor:function(A){if(A){var z=A.url;z&&(z=v.urlToObject(z),this.url=z.path,this._query=z.query);this.dataType=A.dataType;this.serviceInfo=A.serviceInfo;this.rasterInfo=A.rasterInfo;this.tileInfo=A.tileInfo;this.serviceInfo=A.serviceInfo}},open:function(){},read:function(A){},identify:function(A){var z=new r,G=this.rasterInfo.extent;if(x.requirePE(G.spatialReference,
A.spatialReference))x.load().then(n.hitch(this,function(){J=x.project(A,G.spatialReference);z.resolve(J)}),function(){z.reject(Error("cannot project into this spatial reference"))});else{var J=x.project(A,G.spatialReference);z.resolve(J)}return z.then(n.hitch(this,function(L){var R=this.tileInfo,T=R.origin,aa=R.lods[R.lods.length-1],ca=(L.x-T.x)/R.cols/aa.resolution;L=(T.y-L.y)/R.rows/aa.resolution;var ba=Math.round((L-Math.floor(L))*R.rows)*R.cols+Math.round((ca-Math.floor(ca))*R.cols);T=new g(T.x+
aa.resolution*R.cols*ca,T.y-aa.resolution*R.rows*(L+1),T.x+aa.resolution*R.cols*(ca+1),T.y-aa.resolution*R.rows*L,G.spatialReference);var la=this.getMemberRasters?this.getMemberRasters()[0]:this;return la.read({level:aa.level,row:Math.floor(L),col:Math.floor(ca),extent:T,width:R.cols,height:R.rows,virtual:la.tileInfo.virtual,tileType:la.tileInfo.tileType}).then(function(oa){return(oa=oa&&oa.pixelBlock)&&oa.pixels&&0<oa.pixels.length&&(!oa.mask||oa.mask[ba])?{pixelValue:oa.pixels.map(function(fa){return fa[ba]})}:
{pixelValue:null}})}))},getProjectedFullExtent:function(A,z){var G=new r;if(this.projectedFullExtent&&!z)return G.resolve(this.projectedFullExtent),G.promise;var J=this.rasterInfo.extent;if(x.requirePE(this.rasterInfo.extent.spatialReference,A))x.load().then(n.hitch(this,function(){L=x.project(J,A);this.projectedFullExtent=L=new g(L.toJson());G.resolve(L)}),function(){G.reject(Error("cannot project into this spatial reference"))});else{var L=x.project(J,A);this.projectedFullExtent=L=new g(L.toJson());
G.resolve(L)}return G.promise},setFetchParameters:function(A,z){},_setRasterHandler:function(A){this._rasterHandler=A;this.getMemberRasters&&this.getMemberRasters().forEach(n.hitch(this,function(z){z._rasterHandler=A}))},_findCredential:function(){this.url&&((this._credential=e.id&&e.id.findCredential(this.url))&&this._credential.ssl||this.serviceInfo&&this.serviceInfo._ssl)&&(this.url=this.url.replace(/^http:/i,"https:"))},_initWorker:function(){this._rasterHandler=new F;this._rasterHandler.start().then(function(){this._rasterHandlerInitialized=
!0}.bind(this))},_requestPixels:function(A){var z=A.url,G=A.payload,J=A.decodeParams,L=A.tileOptions,R=new r(u._dfdCanceller);this._rasterHandler||this._initWorker();var T=this._rasterHandler,aa={};z={url:z,handleAs:"arraybuffer",content:G};A.headers&&(z.headers=A.headers);R._pendingDfd=c(z).then(n.hitch(this,function(ca){(T&&this._rasterHandlerInitialized?T.decode({encodedData:ca,decodeParams:J}):B.decode(ca,J)).then(function(ba){aa.pixelBlock=new C(ba);aa.extent=L.extent;aa.level=L.level;aa.row=
L.row;aa.col=L.col;aa.width=L.width;aa.height=L.height;u._resDfd(R,[aa])},function(ba){u._resDfd(R,[ba],!0)})}),function(ca){u._resDfd(R,[ca],!0)});return R},_computeSignature:function(A){if("string"===typeof A){for(var z=new Uint8Array(A.length),G=0;G<A.length;G++)z[G]=A.charCodeAt(G);A=z}G=z=65535;for(var J=A.length,L=Math.floor(J/2),R=0;L;){var T=359<=L?359:L;L-=T;do z+=A[R++]<<8,G+=z+=A[R++];while(--T);z=(z&65535)+(z>>>16);G=(G&65535)+(G>>>16)}J&1&&(G+=z+=A[R]<<8);return((G&65535)+(G>>>16)<<16|
(z&65535)+(z>>>16))>>>0}})})},"esri/layers/rasterFormats/rasterCodec":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred ../PixelBlock ./LercCodec ./Lerc2Codec ./Lerc ./JpgPlus ./Png ./Raw ./TiffDecoder".split(" "),function(H,m,n,r,l,k,b,a,d,f,e,h){return{validPixelTypes:"U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "),supportedFormats:"lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "),_isPlatformLittleEndian:function(){var c=new ArrayBuffer(4),g=new Uint8Array(c);
(new Uint32Array(c))[0]=1;return 1===g[0]}(),decode:function(c,g){if(void 0===g||null===g)throw"missing decode options";var p;g.format&&(p=g.format.toUpperCase());"BSQ"!==p&&"BIP"!==p&&(p=this._getFormat(c));var q=g.decodeFunc;if(void 0===q||null===q)q=this._getFormatDecoderDfd(p,g.useWasm);return q(c,g)},_getFormatDecoderDfd:function(c,g){if(g&&("LERC"===c||"LERC2"===c))return this._decodeLercWasm.bind(this);var p=null;switch(c){case "LERC":p=this._decodeLerc;break;case "LERC2":p=this._decodeLerc2;
break;case "JPEG":p=this._decodeJpeg;break;case "PNG":p=this._decodePng;break;case "BSQ":p=this._decodeBsq;break;case "BIP":p=this._decodeBip;break;case "TIFF":p=this._decodeTiff;break;default:p=function(q,u){throw"The raster format is not supported";}}p=n.hitch(this,p);return function(q,u){var v=new r;u.isPoint&&u.width&&(u.width++,u.height++);q=p(q,u);u.isPoint&&u.width&&(this._interpolatePointGrid(q),u.width--,u.height--);v.resolve(q);return v}.bind(this)},_getFormat:function(c){c=new Uint8Array(c,
0,10);var g="";if(255===c[0]&&216===c[1])g="JPEG";else if(137===c[0]&&80===c[1]&&78===c[2]&&71===c[3])g="PNG";else if(67===c[0]&&110===c[1]&&116===c[2]&&90===c[3]&&73===c[4]&&109===c[5]&&97===c[6]&&103===c[7]&&101===c[8]&&32===c[9])g="LERC";else if(76===c[0]&&101===c[1]&&114===c[2]&&99===c[3]&&50===c[4]&&32===c[5])g="LERC2";else if(-1<String.fromCharCode.apply(null,c).toLowerCase().indexOf("error"))g="ERROR";else if(73===c[0]&&73===c[1]&&42===c[2]&&0===c[3]||77===c[0]&&77===c[1]&&0===c[2]&&42===c[3])g=
"TIFF";return g},_validateDecodeParams:function(c){if(!c.height||Math.floor(c.height)!==c.height)throw"Height not provided.";if(!c.width||Math.floor(c.width)!==c.width)throw"Width not provided.";},_decodeJpeg:function(c,g){if(!d)throw"The jpeg decoder module is not loaded.";this._validateDecodeParams(g);c=(new d).decode(c);if(!this._verifyResult(c,g))throw"The decoded image dimensions are incorrect.";g=new l({width:c.width,height:c.height,pixels:c.pixels,pixelType:"U8",mask:c.mask,statistics:null});
g.calculateStatistics();return g},_decodePng:function(c,g){if(!f)throw"The png decoder module is not loaded.";this._validateDecodeParams(g);c=new Uint8Array(c);var p=new f(c);c=new Uint8Array(g.width*g.height*4);p.copyToImageData(c,p.decodePixels());var q=p=0;q=new Uint8Array(g.width*g.height);for(p=0;p<g.width*g.height;p++)q[p]=c[4*p+3];var u=new l({width:g.width,height:g.height,pixels:[],pixelType:"U8",mask:q,statistics:[]});for(p=0;3>p;p++){var v=new Uint8Array(g.width*g.height);for(q=0;q<g.width*
g.height;q++)v[q]=c[4*q+p];u.addData({pixels:v})}u.calculateStatistics();return u},_decodeBsq:function(c,g){if(!e)throw"The bsq decoder module is not loaded.";this._validateDecodeParams(g);var p=g.noDataValue;g.pixelType=this._getpixelTypeAndNoData(g.pixelType);c=e.decodeBSQ(c,{bandCount:g.planes,width:g.width,height:g.height,pixelType:g.pixelType,noDataValue:p});g=new l({width:g.width,height:g.height,pixels:c.pixels,pixelType:g.pixelType,mask:c.maskData,statistics:null});g.calculateStatistics();
return g},_decodeBip:function(c,g){this._validateDecodeParams(g);var p=g.noDataValue;g.pixelType=this._getpixelTypeAndNoData(g.pixelType);c=e.decodeBIP(c,{bandCount:g.planes,width:g.width,height:g.height,pixelType:g.pixelType,noDataValue:p});g=new l({width:g.width,height:g.height,pixels:c.pixels,pixelType:g.pixelType,mask:c.maskData,statistics:null});g.calculateStatistics();return g},_decodeTiff:function(c,g){this._validateDecodeParams(g);g.pixelType=this._getpixelTypeAndNoData(g.pixelType);c=h.decode(c);
c=new l({width:c.width,height:c.height,pixels:c.pixels,pixelType:c.pixelType,mask:c.maskData,statistics:null});c.calculateStatistics();return c},_decodeLerc:function(c,g){if(!this._isPlatformLittleEndian)throw"lerc decoder is not supported on big endian platform";this._validateDecodeParams(g);var p=g.noDataValue;g.pixelType=this._getpixelTypeAndNoData(g.pixelType);for(var q=0,u,v=0,t,y=c.byteLength-10;v<y;){var C=k.decode(c,{inputOffset:v,encodedMaskData:u,returnMask:0===q?!0:!1,returnEncodedMask:0===
q?!0:!1,returnFileInfo:!0,pixelType:g.pixelType,noDataValue:p});v=C.fileInfo.eofOffset;0===q&&(u=C.encodedMaskData,t=new l({width:g.width,height:g.height,pixels:[],pixelType:g.pixelType,mask:C.maskData,statistics:[]}));q++;if(!this._verifyResult(C,g))throw"The decoded image dimensions are incorrect";t.addData({pixels:C.pixelData,statistics:{minValue:C.minValue,maxValue:C.maxValue,noDataValue:C.noDataValue}})}return t},_decodeLerc2:function(c,g){if(!this._isPlatformLittleEndian)throw"lerc2 decoder is not supported on big endian platform";
this._validateDecodeParams(g);g.pixelType=this._getpixelTypeAndNoData(g.pixelType);for(var p=0,q,u,v,t=0,y,C=c.byteLength-10,B=[],F,x=0;t<C;){u=b.decode(c,{inputOffset:t,maskData:q,returnFileInfo:!0});t=u.fileInfo.eofOffset;q=u.maskData;0===p&&(v=u.fileInfo.numValidPixel,y=new l({width:g.width,height:g.height,pixels:[],dimCount:u.dimCount||1,pixelType:u.fileInfo.pixelType,mask:q,statistics:[]}));u.fileInfo.mask&&0<u.fileInfo.mask.numBytes&&x++;q&&B.push(q);p++;if(!this._verifyResult(u,g))throw"The decoded image dimensions are incorrect";
y.addData({pixels:u.pixelData,statistics:{minValue:u.minValue,maxValue:u.maxValue,noDataValue:u.noDataValue,dimStats:u.dimStats}})}if(1<x){g=y.width*y.height;y.bandMasks=B;q=new Uint8Array(g);q.set(B[0]);for(v=1;v<B.length;v++)for(F=B[v],c=0;c<g;c++)q[c]&=F[c];for(c=v=0;c<g;c++)v+=F[c];y.mask=q}y.validPixelCount=v;return y},_decodeLercWasm:function(c,g){if(!this._isPlatformLittleEndian)throw"lerc decoder is not supported on big endian platform";this._validateDecodeParams(g);var p=new r;a.load().then(function(){var q=
a.decode(c,{inputOffset:0,noDataValue:g.noDataValue,pixelType:g.pixelType&&g.pixelType.toUpperCase()});q=new l({width:q.width,height:q.height,pixelType:q.pixelType.toUpperCase(),pixels:q.pixels,mask:q.mask,statistics:q.statistics,validPixelCount:q.validPixelCount});g.isPoint&&g.width&&(this._interpolatePointGrid(q),g.width--,g.height--);p.resolve(q)}.bind(this),function(){p.reject("Cannot load lerc wasm decoder")});return p},_interpolatePointGrid:function(c,g){var p=c.pixels;if(p&&0!==p.length){var q=
p.length,u=c.width,v=c.mask,t=u-1,y=c.height-1,C=[],B,F;if(0===(null==g?1:g)){for(g=0;g<q;g++){var x=p[g];var w=new x.constructor(t*y);for(B=0;B<y;B++){var A=B*u;for(F=0;F<t;F++)w[B*t+F]=x[A+F]}C.push(w)}if(v){var z=new Uint8Array(t*y);for(B=0;B<y;B++)for(A=B*u,F=0;F<t;F++)z[B*t+F]=v[A+F]}}else{for(g=0;g<q;g++){x=p[g];w=new x.constructor(t*y);for(B=0;B<y;B++)for(A=B*u,F=0;F<t;F++)w[B*t+F]=(x[A+F]+x[A+F+1]+x[A+u+F]+x[A+u+F+1])/4;C.push(w)}if(v)for(z=new Uint8Array(t*y),B=0;B<y;B++)for(A=B*u,F=0;F<
t;F++)z[B*t+F]=Math.min.apply(null,[v[A+F],v[A+F+1],v[A+u+F],v[A+u+F+1]])}c.width=t;c.height=y;c.mask=z;c.pixels=C;return c}},_getpixelTypeAndNoData:function(c){return"U1"===c||"U2"===c||"U4"===c||"U8"===c?"U8":c},_verifyResult:function(c,g){return c.height!==g.height||c.width!==g.width?!1:!0}}})},"esri/layers/rasterFormats/Lerc":function(){var H=this&&this.__createBinding||(Object.create?function(l,k,b,a){void 0===a&&(a=b);Object.defineProperty(l,a,{enumerable:!0,get:function(){return k[b]}})}:function(l,
k,b,a){void 0===a&&(a=b);l[a]=k[b]}),m=this&&this.__setModuleDefault||(Object.create?function(l,k){Object.defineProperty(l,"default",{enumerable:!0,value:k})}:function(l,k){l["default"]=k}),n=this&&this.__importStar||function(l){if(l&&l.__esModule)return l;var k={};if(null!=l)for(var b in l)"default"!==b&&Object.prototype.hasOwnProperty.call(l,b)&&H(k,l,b);m(k,l);return k},r=this&&this.__read||function(l,k){var b="function"===typeof Symbol&&l[Symbol.iterator];if(!b)return l;l=b.call(l);var a,d=[];
try{for(;(void 0===k||0<k--)&&!(a=l.next()).done;)d.push(a.value)}catch(e){var f={error:e}}finally{try{a&&!a.done&&(b=l["return"])&&b.call(l)}finally{if(f)throw f.error;}}return d};define(["require","exports"],function(l,k){function b(h){var c=h._malloc,g=h._free,p=h._lerc_getBlobInfo,q=h._lerc_getDataRanges,u=h._lerc_decode_4D,v,t=Object.values(h.asm).find(function(C){return C&&"buffer"in C&&C.buffer===h.HEAPU8.buffer}),y=function(C){C=C.map(function(w){return(w>>3<<3)+16});var B=C.reduce(function(w,
A){return w+A}),F=c(B);v=new Uint8Array(t.buffer);B=C[0];C[0]=F;for(F=1;F<C.length;F++){var x=C[F];C[F]=C[F-1]+B;B=x}return C};e.getBlobInfo=function(C){var B,F=new Uint8Array(48),x=new Uint8Array(24),w=r(y([C.length,F.length,x.length]),3),A=w[0],z=w[1];w=w[2];v.set(C,A);v.set(F,z);v.set(x,w);if(B=p(A,C.length,z,w,12,3))throw g(A),"lerc-getBlobInfo: error code is ".concat(B);v=new Uint8Array(t.buffer);F.set(v.slice(z,z+F.length));x.set(v.slice(w,w+x.length));F=new Uint32Array(F.buffer);w=new Float64Array(x.buffer);
z=r(F,11);x=z[2];F=z[5];var G=z[10];z={version:z[0],dimCount:x,width:z[3],height:z[4],validPixelCount:z[6],bandCount:F,blobSize:z[7],maskCount:z[8],dataType:z[1],minValue:w[0],maxValue:w[1],maxZerror:w[2],statistics:[],bandCountWithNoData:G};if(G)return z;if(1===x&&1===F)return g(A),z.statistics.push({minValue:w[0],maxValue:w[1]}),z;var J=x*F*8,L=new Uint8Array(J),R=new Uint8Array(J);w=A;G=0;var T=!1;if(v.byteLength<A+2*J){g(A);T=!0;B=r(y([C.length,J,J]),3);w=B[0];G=B[1];var aa=B[2];v.set(C,w)}else B=
r(y([J,J]),2),G=B[0],aa=B[1];v.set(L,G);v.set(R,aa);if(B=q(A,C.length,x,F,G,aa))throw g(w),T||g(G),"lerc-getDataRanges: error code is ".concat(B);v=new Uint8Array(t.buffer);L.set(v.slice(G,G+J));R.set(v.slice(aa,aa+J));C=new Float64Array(L.buffer);A=new Float64Array(R.buffer);B=z.statistics;for(R=0;R<F;R++)if(1<x){J=C.slice(R*x,(R+1)*x);L=A.slice(R*x,(R+1)*x);aa=Math.min.apply(null,J);var ca=Math.max.apply(null,L);B.push({minValue:aa,maxValue:ca,dimStats:{minValues:J,maxValues:L}})}else B.push({minValue:C[R],
maxValue:A[R]});g(w);T||g(G);return z};e.decode=function(C,B){var F=B.maskCount,x=B.dimCount,w=B.bandCount,A=B.width,z=B.height,G=B.dataType,J=B.bandCountWithNoData,L=a[G],R=A*z;B=new Uint8Array(R*w);var T=R*x*w*L.size;L=new Uint8Array(T);R=new Uint8Array(w);var aa=8*w,ca=new Uint8Array(aa),ba=r(y([C.length,B.length,L.length,R.length,ca.length]),5),la=ba[0],oa=ba[1],fa=ba[2],M=ba[3];ba=ba[4];v.set(C,la);v.set(B,oa);v.set(L,fa);v.set(R,M);v.set(ca,ba);if(C=u(la,C.length,F,oa,x,A,z,w,G,fa,M,ba))throw g(la),
"lerc-decode: error code is ".concat(C);v=new Uint8Array(t.buffer);L.set(v.slice(fa,fa+T));B.set(v.slice(oa,oa+B.length));C=null;if(J)for(R.set(v.slice(M,M+w)),ca.set(v.slice(ba,ba+aa)),C=[],w=0;w<R.length;w++)C.push(R[w]?ca[w]:null);g(la);return{data:L,maskData:B,noDataValues:C}}}Object.defineProperty(k,"__esModule",{value:!0});k.getBlobInfo=k.decode=k.isLoaded=k.load=void 0;var a=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,128]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",
size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}],d=null,f=!1;k.load=function(){return d?d:d=(new Promise(function(h,c){l(["./lerc-wasm"],
h,c)})).then(n).then(function(h){h=h.default;return h({locateFile:function(c){return l.toUrl("./"+c)}})}).then(function(h){b(h);f=!0})};k.isLoaded=function(){return f};var e={getBlobInfo:null,decode:null};k.decode=function(h,c){var g;void 0===c&&(c={});var p=null!==(g=c.inputOffset)&&void 0!==g?g:0;g=h instanceof Uint8Array?h.subarray(p):new Uint8Array(h,p);h=e.getBlobInfo(g);var q=e.decode(g,h),u=q.maskData;g=h.width;p=h.height;var v=h.bandCount,t=h.dimCount,y=h.maskCount,C=h.statistics,B=a[h.dataType],
F=new B.ctor(q.data.buffer);q=[];for(var x=[],w=g*p,A=w*t,z=0;z<v;z++){var G=F.subarray(z*A,(z+1)*A);if(c.returnPixelInterleavedDims)q.push(G);else{var J=w,L=t;if(!(2>L)){for(var R=new B.ctor(J*L),T=0,aa=0;T<J;T++)for(var ca=0,ba=T;ca<L;ca++,ba+=J)R[ba]=G[aa++];G=R}q.push(G)}x.push(u.subarray(z*A,(z+1)*A))}u=0===y?null:1===y?x[0]:new Uint8Array(w);if(1<y)for(u.set(x[0]),z=1;z<x.length;z++)for(F=x[z],A=0;A<w;A++)u[A]&=F[A];z=c.noDataValue;z=null!=z&&B.range[0]<=z&&B.range[1]>=z;if(0<y&&z)for(J=c.noDataValue,
z=0;z<v;z++)for(G=q[z],F=x[z]||u,A=0;A<w;A++)0===F[A]&&(G[A]=J);return{width:g,height:p,bandCount:v,pixelType:c.pixelType&&0===h.version?c.pixelType:B.pixelType,dimCount:t,statistics:C,pixels:q,mask:u,bandMasks:y===v&&1<v?x:null}};k.getBlobInfo=function(h,c){var g,p;void 0===c&&(c={});var q=h instanceof Uint8Array?h.subarray(null!==(g=c.inputOffset)&&void 0!==g?g:0):new Uint8Array(h,null!==(p=c.inputOffset)&&void 0!==p?p:0);return e.getBlobInfo(q)}})},"esri/layers/rasterFormats/JpgPlus":function(){define(["dojo/_base/declare",
"./Zlib","./Jpg"],function(H,m,n){return H(null,{constructor:function(){},decode:function(r){var l=new Uint8Array(r);r=new n;r.parse(l);var k=r.numComponents,b=r.getData(r.width,r.height,!0),a=r.width*r.height,d=r.eof,f=0,e=0,h=0;if(d<l.length-1){e=(new m(l.subarray(d))).getBytes();var c=new Uint8Array(a);for(f=l=0;f<e.length;f++)for(h=7;0<=h;h--)c[l++]=e[f]>>h&1}l=[];if(1===k&&b.length===a)l=[b,b,b];else{for(f=0;3>f;f++)k=new Uint8Array(a),l.push(k);for(e=h=0;e<a;e++)for(f=0;3>f;f++)l[f][e]=b[h++]}return{width:r.width,
height:r.height,pixels:l,mask:c}}})})},"esri/layers/rasterFormats/Zlib":function(){define([],function(){var H=function(){function m(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}m.prototype={ensureBuffer:function(n){var r=this.buffer,l=r?r.byteLength:0;if(n<l)return r;for(var k=512;k<n;)k<<=1;n=new Uint8Array(k);for(k=0;k<l;++k)n[k]=r[k];return this.buffer=n},getByte:function(){for(var n=this.pos;this.bufferLength<=n;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},
getBytes:function(n){var r=this.pos;if(n){this.ensureBuffer(r+n);for(n=r+n;!this.eof&&this.bufferLength<n;)this.readBlock();var l=this.bufferLength;n>l&&(n=l)}else{for(;!this.eof;)this.readBlock();n=this.bufferLength}this.pos=n;return this.buffer.subarray(r,n)},lookChar:function(){for(var n=this.pos;this.bufferLength<=n;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var n=this.pos;this.bufferLength<=n;){if(this.eof)return null;
this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(n,r,l){for(var k=n+r;this.bufferLength<=k&&!this.eof;)this.readBlock();return new Stream(this.buffer,n,r,l)},skip:function(n){n||(n=1);this.pos+=n},reset:function(){this.pos=0}};return m}();return function(){function m(d){throw Error(d);}function n(d){var f=0,e=d[f++],h=d[f++];-1!=e&&-1!=h||m("Invalid header in flate stream");8!=(e&15)&&m("Unknown compression method in flate stream");0!=((e<<8)+h)%31&&m("Bad FCHECK in flate stream");
h&32&&m("FDICT bit set in flate stream");this.bytes=d;this.bytesPos=f;this.codeBuf=this.codeSize=0;H.call(this)}if(!self||!self.Uint32Array)return null;var r=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),k=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,
393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),b=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,
524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,
524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,
524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,
524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,
524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,
524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,
524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],a=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];n.prototype=Object.create(H.prototype);n.prototype.getBits=function(d){for(var f=
this.codeSize,e=this.codeBuf,h=this.bytes,c=this.bytesPos,g;f<d;)"undefined"==typeof(g=h[c++])&&m("Bad encoding in flate stream"),e|=g<<f,f+=8;this.codeBuf=e>>d;this.codeSize=f-=d;this.bytesPos=c;return e&(1<<d)-1};n.prototype.getCode=function(d){var f=d[0],e=d[1];d=this.codeSize;for(var h=this.codeBuf,c=this.bytes,g=this.bytesPos;d<e;){var p;"undefined"==typeof(p=c[g++])&&m("Bad encoding in flate stream");h|=p<<d;d+=8}e=f[h&(1<<e)-1];f=e>>16;e&=65535;(0==d||d<f||0==f)&&m("Bad encoding in flate stream");
this.codeBuf=h>>f;this.codeSize=d-f;this.bytesPos=g;return e};n.prototype.generateHuffmanTable=function(d){for(var f=d.length,e=0,h=0;h<f;++h)d[h]>e&&(e=d[h]);for(var c=1<<e,g=new Uint32Array(c),p=1,q=0,u=2;p<=e;++p,q<<=1,u<<=1)for(var v=0;v<f;++v)if(d[v]==p){var t=0,y=q;for(h=0;h<p;++h)t=t<<1|y&1,y>>=1;for(h=t;h<c;h+=u)g[h]=p<<16|v;++q}return[g,e]};n.prototype.readBlock=function(){function d(t,y,C,B,F){for(t=t.getBits(C)+B;0<t--;)y[q++]=F}var f=this.getBits(3);f&1&&(this.eof=!0);f>>=1;if(0==f){var e=
this.bytes,h=this.bytesPos,c;"undefined"==typeof(c=e[h++])&&m("Bad block header in flate stream");var g=c;"undefined"==typeof(c=e[h++])&&m("Bad block header in flate stream");g|=c<<8;"undefined"==typeof(c=e[h++])&&m("Bad block header in flate stream");f=c;"undefined"==typeof(c=e[h++])&&m("Bad block header in flate stream");(f|c<<8)!=(~g&65535)&&m("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;c=this.bufferLength;f=this.ensureBuffer(c+g);this.bufferLength=g=c+g;for(var p=
c;p<g;++p){if("undefined"==typeof(c=e[h++])){this.eof=!0;break}f[p]=c}this.bytesPos=h}else{if(1==f)h=b,c=a;else if(2==f){f=this.getBits(5)+257;c=this.getBits(5)+1;e=this.getBits(4)+4;h=Array(r.length);for(var q=0;q<e;)h[r[q++]]=this.getBits(3);h=this.generateHuffmanTable(h);q=e=0;c=f+c;for(g=Array(c);q<c;)p=this.getCode(h),16==p?d(this,g,2,3,e):17==p?d(this,g,3,3,e=0):18==p?d(this,g,7,11,e=0):g[q++]=e=p;h=this.generateHuffmanTable(g.slice(0,f));c=this.generateHuffmanTable(g.slice(f,c))}else m("Unknown block type in flate stream");
g=(f=this.buffer)?f.length:0;for(p=this.bufferLength;;){var u=this.getCode(h);if(256>u)p+1>=g&&(f=this.ensureBuffer(p+1),g=f.length),f[p++]=u;else{if(256==u){this.bufferLength=p;break}u-=257;u=l[u];var v=u>>16;0<v&&(v=this.getBits(v));e=(u&65535)+v;u=this.getCode(c);u=k[u];v=u>>16;0<v&&(v=this.getBits(v));u=(u&65535)+v;p+e>=g&&(f=this.ensureBuffer(p+e),g=f.length);for(v=0;v<e;++v,++p)f[p]=f[p-u]}}}};return n}()})},"esri/layers/rasterFormats/Jpg":function(){define([],function(){var H=function(){function m(n){this.message=
"JPEG error: "+n}m.prototype=Error();m.prototype.name="JpegError";return m.constructor=m}();return function(){function m(){this.decodeTransform=null;this.colorTransform=-1}function n(a,d){for(var f=0,e=[],h,c,g=16;0<g&&!a[g-1];)g--;e.push({children:[],index:0});var p=e[0],q;for(h=0;h<g;h++){for(c=0;c<a[h];c++){p=e.pop();for(p.children[p.index]=d[f];0<p.index;)p=e.pop();p.index++;for(e.push(p);e.length<=h;)e.push(q={children:[],index:0}),p.children[p.index]=q.children,p=q;f++}h+1<g&&(e.push(q={children:[],
index:0}),p.children[p.index]=q.children,p=q)}return e[0].children}function r(a,d,f,e,h,c,g,p,q){function u(){if(0<J)return J--,G>>J&1;G=a[d++];if(255===G){var K=a[d++];if(K)throw new H("unexpected marker "+(G<<8|K).toString(16));}J=7;return G>>>7}function v(K){for(;;){K=K[u()];if("number"===typeof K)return K;if("object"!==typeof K)throw new H("invalid huffman sequence");}}function t(K){for(var E=0;0<K;)E=E<<1|u(),K--;return E}function y(K){if(1===K)return 1===u()?1:-1;var E=t(K);return E>=1<<K-1?
E:E+(-1<<K)+1}function C(K,E){var N=v(K.huffmanTableDC);N=0===N?0:y(N);K.blockData[E]=K.pred+=N;for(N=1;64>N;){var I=v(K.huffmanTableAC),O=I&15;I>>=4;if(0===O){if(15>I)break;N+=16}else N+=I,K.blockData[E+b[N]]=y(O),N++}}function B(K,E){var N=v(K.huffmanTableDC);N=0===N?0:y(N)<<q;K.blockData[E]=K.pred+=N}function F(K,E){K.blockData[E]|=u()<<q}function x(K,E){if(0<L)L--;else for(var N=c;N<=g;){var I=v(K.huffmanTableAC),O=I&15;I>>=4;if(0===O){if(15>I){L=t(I)+(1<<I)-1;break}N+=16}else N+=I,K.blockData[E+
b[N]]=y(O)*(1<<q),N++}}function w(K,E){for(var N=c,I=0,O;N<=g;){O=b[N];switch(R){case 0:I=v(K.huffmanTableAC);O=I&15;I>>=4;if(0===O)15>I?(L=t(I)+(1<<I),R=4):(I=16,R=1);else{if(1!==O)throw new H("invalid ACn encoding");T=y(O);R=I?2:3}continue;case 1:case 2:K.blockData[E+O]?K.blockData[E+O]+=u()<<q:(I--,0===I&&(R=2===R?3:0));break;case 3:K.blockData[E+O]?K.blockData[E+O]+=u()<<q:(K.blockData[E+O]=T<<q,R=0);break;case 4:K.blockData[E+O]&&(K.blockData[E+O]+=u()<<q)}N++}4===R&&(L--,0===L&&(R=0))}var A=
f.mcusPerLine,z=d,G=0,J=0,L=0,R=0,T,aa=e.length,ca,ba,la,oa;p=f.progressive?0===c?0===p?B:F:0===p?x:w:C;var fa=0;f=1===aa?e[0].blocksPerLine*e[0].blocksPerColumn:A*f.mcusPerColumn;for(var M,X;fa<f;){var da=h?Math.min(f-fa,h):f;for(ca=0;ca<aa;ca++)e[ca].pred=0;L=0;if(1===aa){var Q=e[0];for(oa=0;oa<da;oa++)p(Q,64*((Q.blocksPerLine+1)*(fa/Q.blocksPerLine|0)+fa%Q.blocksPerLine)),fa++}else for(oa=0;oa<da;oa++){for(ca=0;ca<aa;ca++)for(Q=e[ca],M=Q.h,X=Q.v,ba=0;ba<X;ba++)for(la=0;la<M;la++)p(Q,64*((Q.blocksPerLine+
1)*((fa/A|0)*Q.v+ba)+(fa%A*Q.h+la)));fa++}J=0;(Q=k(a,d))&&Q.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+Q.invalid),d=Q.offset);Q=Q&&Q.marker;if(!Q||65280>=Q)throw new H("marker was not found");if(65488<=Q&&65495>=Q)d+=2;else break}(Q=k(a,d))&&Q.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+Q.invalid),d=Q.offset);return d-z}function l(a,d){a=d.blocksPerLine;for(var f=d.blocksPerColumn,e=new Int16Array(64),h=0;h<f;h++)for(var c=0;c<a;c++){var g=
void 0,p=void 0,q=void 0,u=void 0,v=void 0,t=void 0,y=void 0,C=void 0,B=v=t=u=p=g=void 0,F=void 0,x=void 0,w=void 0,A=64*((d.blocksPerLine+1)*h+c),z=e,G=d.quantizationTable,J=d.blockData;if(!G)throw new H("missing required Quantization Table.");for(var L=0;64>L;L+=8)g=J[A+L],C=J[A+L+1],y=J[A+L+2],t=J[A+L+3],v=J[A+L+4],u=J[A+L+5],q=J[A+L+6],p=J[A+L+7],g*=G[L],0===(C|y|t|v|u|q|p)?(g=5793*g+512>>10,z[L]=g,z[L+1]=g,z[L+2]=g,z[L+3]=g,z[L+4]=g,z[L+5]=g,z[L+6]=g,z[L+7]=g):(C*=G[L+1],y*=G[L+2],t*=G[L+3],
v*=G[L+4],u*=G[L+5],q*=G[L+6],p*=G[L+7],w=5793*g+128>>8,x=5793*v+128>>8,F=y,B=q,v=2896*(C-p)+128>>8,p=2896*(C+p)+128>>8,t<<=4,u<<=4,w=w+x+1>>1,x=w-x,g=3784*F+1567*B+128>>8,F=1567*F-3784*B+128>>8,B=g,v=v+u+1>>1,u=v-u,p=p+t+1>>1,t=p-t,w=w+B+1>>1,B=w-B,x=x+F+1>>1,F=x-F,g=2276*v+3406*p+2048>>12,v=3406*v-2276*p+2048>>12,p=g,g=799*t+4017*u+2048>>12,t=4017*t-799*u+2048>>12,u=g,z[L]=w+p,z[L+7]=w-p,z[L+1]=x+u,z[L+6]=x-u,z[L+2]=F+t,z[L+5]=F-t,z[L+3]=B+v,z[L+4]=B-v);for(G=0;8>G;++G)g=z[G],C=z[G+8],y=z[G+16],
t=z[G+24],v=z[G+32],u=z[G+40],q=z[G+48],p=z[G+56],0===(C|y|t|v|u|q|p)?(g=5793*g+8192>>14,g=-2040>g?0:2024<=g?255:g+2056>>4,J[A+G]=g,J[A+G+8]=g,J[A+G+16]=g,J[A+G+24]=g,J[A+G+32]=g,J[A+G+40]=g,J[A+G+48]=g,J[A+G+56]=g):(w=5793*g+2048>>12,x=5793*v+2048>>12,F=y,B=q,v=2896*(C-p)+2048>>12,p=2896*(C+p)+2048>>12,w=(w+x+1>>1)+4112,x=w-x,g=3784*F+1567*B+2048>>12,F=1567*F-3784*B+2048>>12,B=g,v=v+u+1>>1,u=v-u,p=p+t+1>>1,t=p-t,w=w+B+1>>1,B=w-B,x=x+F+1>>1,F=x-F,g=2276*v+3406*p+2048>>12,v=3406*v-2276*p+2048>>12,
p=g,g=799*t+4017*u+2048>>12,t=4017*t-799*u+2048>>12,u=g,g=w+p,p=w-p,C=x+u,q=x-u,y=F+t,u=F-t,t=B+v,v=B-v,g=16>g?0:4080<=g?255:g>>4,C=16>C?0:4080<=C?255:C>>4,y=16>y?0:4080<=y?255:y>>4,t=16>t?0:4080<=t?255:t>>4,v=16>v?0:4080<=v?255:v>>4,u=16>u?0:4080<=u?255:u>>4,q=16>q?0:4080<=q?255:q>>4,p=16>p?0:4080<=p?255:p>>4,J[A+G]=g,J[A+G+8]=C,J[A+G+16]=y,J[A+G+24]=t,J[A+G+32]=v,J[A+G+40]=u,J[A+G+48]=q,J[A+G+56]=p)}return d.blockData}function k(a,d,f){var e=a.length-1;f=f<d?f:d;if(d>=e)return null;var h=a[d]<<
8|a[d+1];if(65472<=h&&65534>=h)return{invalid:null,marker:h,offset:d};for(d=a[f]<<8|a[f+1];!(65472<=d&&65534>=d);){if(++f>=e)return null;d=a[f]<<8|a[f+1]}return{invalid:h.toString(16),marker:d,offset:f}}if(!self||!self.Uint8ClampedArray)return null;var b=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);m.prototype={parse:function(a){function d(){var G=
a[h]<<8|a[h+1];h+=2;return G}function f(){var G=d();G=h+G-2;var J=k(a,G,h);J&&J.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+J.invalid),G=J.offset);G=a.subarray(h,G);h+=G.length;return G}function e(G){for(var J=Math.ceil(G.samplesPerLine/8/G.maxH),L=Math.ceil(G.scanLines/8/G.maxV),R=0;R<G.components.length;R++){z=G.components[R];var T=Math.ceil(Math.ceil(G.samplesPerLine/8)*z.h/G.maxH),aa=Math.ceil(Math.ceil(G.scanLines/8)*z.v/G.maxV);z.blockData=new Int16Array(64*L*
z.v*(J*z.h+1));z.blocksPerLine=T;z.blocksPerColumn=aa}G.mcusPerLine=J;G.mcusPerColumn=L}var h=0,c=null,g=null,p=[],q=[],u=[],v=d();if(65496!==v)throw new H("SOI not found");for(v=d();65497!==v;){switch(v){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var t=f();65504===v&&74===t[0]&&70===t[1]&&73===t[2]&&70===t[3]&&0===t[4]&&(c={version:{major:t[5],minor:t[6]},
densityUnits:t[7],xDensity:t[8]<<8|t[9],yDensity:t[10]<<8|t[11],thumbWidth:t[12],thumbHeight:t[13],thumbData:t.subarray(14,14+3*t[12]*t[13])});65518===v&&65===t[0]&&100===t[1]&&111===t[2]&&98===t[3]&&101===t[4]&&(g={version:t[5]<<8|t[6],flags0:t[7]<<8|t[8],flags1:t[9]<<8|t[10],transformCode:t[11]});break;case 65499:v=d()+h-2;for(var y;h<v;){var C=a[h++],B=new Uint16Array(64);if(0===C>>4)for(t=0;64>t;t++)y=b[t],B[y]=a[h++];else if(1===C>>4)for(t=0;64>t;t++)y=b[t],B[y]=d();else throw new H("DQT - invalid table spec");
p[C&15]=B}break;case 65472:case 65473:case 65474:if(F)throw new H("Only single frame JPEGs supported");d();var F={};F.extended=65473===v;F.progressive=65474===v;F.precision=a[h++];F.scanLines=d();F.samplesPerLine=d();F.components=[];F.componentIds={};t=a[h++];for(v=B=C=0;v<t;v++){y=a[h];var x=a[h+1]>>4;var w=a[h+1]&15;C<x&&(C=x);B<w&&(B=w);x=F.components.push({h:x,v:w,quantizationId:a[h+2],quantizationTable:null});F.componentIds[y]=x-1;h+=3}F.maxH=C;F.maxV=B;e(F);break;case 65476:y=d();for(v=2;v<
y;){C=a[h++];B=new Uint8Array(16);for(t=x=0;16>t;t++,h++)x+=B[t]=a[h];w=new Uint8Array(x);for(t=0;t<x;t++,h++)w[t]=a[h];v+=17+x;(0===C>>4?u:q)[C&15]=n(B,w)}break;case 65501:d();var A=d();break;case 65498:d();y=a[h++];t=[];for(v=0;v<y;v++){C=F.componentIds[a[h++]];var z=F.components[C];C=a[h++];z.huffmanTableDC=u[C>>4];z.huffmanTableAC=q[C&15];t.push(z)}v=a[h++];y=a[h++];C=a[h++];v=r(a,h,F,t,A,v,y,C>>4,C&15);h+=v;break;case 65535:255!==a[h]&&h--;break;default:if(255===a[h-3]&&192<=a[h-2]&&254>=a[h-
2])h-=3;else throw new H("unknown marker "+v.toString(16));}v=d()}this.width=F.samplesPerLine;this.height=F.scanLines;this.jfif=c;this.eof=h;this.adobe=g;this.components=[];for(v=0;v<F.components.length;v++){z=F.components[v];if(c=p[z.quantizationId])z.quantizationTable=c;this.components.push({output:l(F,z),scaleX:z.h/F.maxH,scaleY:z.v/F.maxV,blocksPerLine:z.blocksPerLine,blocksPerColumn:z.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(a,d){var f=this.width/
a,e=this.height/d,h,c,g=0,p=this.components.length,q=a*d*p,u=new Uint8ClampedArray(q),v=new Uint32Array(a);for(c=0;c<p;c++){var t=this.components[c];var y=t.scaleX*f;var C=t.scaleY*e;g=c;var B=t.output;var F=t.blocksPerLine+1<<3;for(h=0;h<a;h++)t=0|h*y,v[h]=(t&4294967288)<<3|t&7;for(y=0;y<d;y++)for(t=0|y*C,t=F*(t&4294967288)|(t&7)<<3,h=0;h<a;h++)u[g]=B[t+v[h]],g+=p}if(d=this.decodeTransform)for(c=0;c<q;)for(a=t=0;t<p;t++,c++,a+=2)u[c]=(u[c]*d[a]>>8)+d[a+1];return u},_isColorConversionNeeded:function(){return this.adobe?
!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(a){for(var d,f,e,h=0,c=a.length;h<c;h+=3)d=a[h],f=a[h+1],e=a[h+2],a[h]=d-179.456+1.402*e,a[h+1]=d+135.459-.344*f-.714*e,a[h+2]=d-226.816+1.772*f;return a},_convertYcckToRgb:function(a){for(var d,f,e,h,c=0,g=0,p=a.length;g<p;g+=4)d=a[g],f=a[g+1],e=a[g+2],h=a[g+3],a[c++]=-122.67195406894+f*(-6.60635669420364E-5*f+4.37130475926232E-4*e-5.4080610064599E-5*d+4.8449797120281E-4*
h-.154362151871126)+e*(-9.57964378445773E-4*e+8.17076911346625E-4*d-.00477271405408747*h+1.53380253221734)+d*(9.61250184130688E-4*d-.00266257332283933*h+.48357088451265)+h*(-3.36197177618394E-4*h+.484791561490776),a[c++]=107.268039397724+f*(2.19927104525741E-5*f-6.40992018297945E-4*e+6.59397001245577E-4*d+4.26105652938837E-4*h-.176491792462875)+e*(-7.78269941513683E-4*e+.00130872261408275*d+7.70482631801132E-4*h-.151051492775562)+d*(.00126935368114843*d-.00265090189010898*h+.25802910206845)+h*(-3.18913117588328E-4*
h-.213742400323665),a[c++]=-20.810012546947+f*(-5.70115196973677E-4*f-2.63409051004589E-5*e+.0020741088115012*d-.00288260236853442*h+.814272968359295)+e*(-1.53496057440975E-5*e-1.32689043961446E-4*d+5.60833691242812E-4*h-.195152027534049)+d*(.00174418132927582*d-.00255243321439347*h+.116935020465145)+h*(-3.43531996510555E-4*h+.24165260232407);return a},_convertYcckToCmyk:function(a){for(var d,f,e,h=0,c=a.length;h<c;h+=4)d=a[h],f=a[h+1],e=a[h+2],a[h]=434.456-d-1.402*e,a[h+1]=119.541-d+.344*f+.714*
e,a[h+2]=481.816-d-1.772*f;return a},_convertCmykToRgb:function(a){for(var d,f,e,h,c=0,g=1/255,p=0,q=a.length;p<q;p+=4)d=a[p]*g,f=a[p+1]*g,e=a[p+2]*g,h=a[p+3]*g,a[c++]=255+d*(-4.387332384609988*d+54.48615194189176*f+18.82290502165302*e+212.25662451639585*h-285.2331026137004)+f*(1.7149763477362134*f-5.6096736904047315*e-17.873870861415444*h-5.497006427196366)+e*(-2.5217340131683033*e-21.248923337353073*h+17.5119270841813)-h*(21.86122147463605*h+189.48180835922747),a[c++]=255+d*(8.841041422036149*d+
60.118027045597366*f+6.871425592049007*e+31.159100130055922*h-79.2970844816548)+f*(-15.310361306967817*f+17.575251261109482*e+131.35250912493976*h-190.9453302588951)+e*(4.444339102852739*e+9.8632861493405*h-24.86741582555878)-h*(20.737325471181034*h+187.80453709719578),a[c++]=255+d*(.8842522430003296*d+8.078677503112928*f+30.89978309703729*e-.23883238689178934*h-14.183576799673286)+f*(10.49593273432072*f+63.02378494754052*e+50.606957656360734*h-112.23884253719248)+e*(.03296041114873217*e+115.60384449646641*
h-193.58209356861505)-h*(22.33816807309886*h+180.12613974708367);return a},getData:function(a,d,f){if(4<this.numComponents)throw new H("Unsupported color mode");a=this._getLinearizedBlockData(a,d);if(1===this.numComponents&&f){f=a.length;d=new Uint8ClampedArray(3*f);for(var e=0,h=0;h<f;h++){var c=a[h];d[e++]=c;d[e++]=c;d[e++]=c}return d}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(a);if(4===this.numComponents){if(this._isColorConversionNeeded())return f?
this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(f)return this._convertCmykToRgb(a)}return a}};return m}()})},"esri/layers/rasterFormats/Png":function(){define(["./Zlib"],function(H){return function(){function m(r){var l,k;this.data=r;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(k=null;;){var b=this.readUInt32();var a=r=void 0;r=[];for(a=0;4>a;++a)r.push(String.fromCharCode(this.data[this.pos++]));r=r.join("");switch(r){case "IHDR":this.width=
this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(b);break;case "fcTL":k&&this.animation.frames.push(k);this.pos+=4;k={width:this.readUInt32(),height:this.readUInt32(),
xOffset:this.readUInt32(),yOffset:this.readUInt32()};r=this.readUInt16();b=this.readUInt16()||100;k.delay=1E3*r/b;k.disposeOp=this.data[this.pos++];k.blendOp=this.data[this.pos++];k.data=[];break;case "IDAT":case "fdAT":"fdAT"===r&&(this.pos+=4,b-=4);r=(null!=k?k.data:void 0)||this.imgData;for(a=0;0<=b?a<b:a>b;0<=b?++a:--a)r.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(b);b=255-this.transparency.indexed.length;
if(0<b)for(r=0;0<=b?r<b:r>b;0<=b?++r:--r)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(b)[0];break;case 2:this.transparency.rgb=this.read(b)}break;case "tEXt":a=this.read(b);b=a.indexOf(0);r=String.fromCharCode.apply(String,a.slice(0,b));this.text[r]=String.fromCharCode.apply(String,a.slice(b+1));break;case "IEND":k&&this.animation.frames.push(k);a:{switch(this.colorType){case 0:case 3:case 4:k=1;break a;case 2:case 6:k=3;break a}k=void 0}this.colors=k;this.hasAlphaChannel=
4===(l=this.colorType)||6===l;l=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*l;a:{switch(this.colors){case 1:l="DeviceGray";break a;case 3:l="DeviceRGB";break a}l=void 0}this.colorSpace=l;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=b}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}m.load=function(r,l,k){"function"===typeof l&&(k=l);var b=new XMLHttpRequest;b.open("GET",r,!0);b.responseType="arraybuffer";b.onload=
function(){var a=new Uint8Array(b.response||b.mozResponseArrayBuffer);a=new m(a);"function"===typeof(null!=l?l.getContext:void 0)&&a.render(l);return"function"===typeof k?k(a):void 0};return b.send(null)};m.prototype.read=function(r){var l;var k=[];for(l=0;0<=r?l<r:l>r;0<=r?++l:--l)k.push(this.data[this.pos++]);return k};m.prototype.readUInt32=function(){var r=this.data[this.pos++]<<24;var l=this.data[this.pos++]<<16;var k=this.data[this.pos++]<<8;var b=this.data[this.pos++];return r|l|k|b};m.prototype.readUInt16=
function(){var r=this.data[this.pos++]<<8;var l=this.data[this.pos++];return r|l};m.prototype.decodePixels=function(r){var l,k,b,a,d,f,e,h;null==r&&(r=this.imgData);if(0===r.length)return new Uint8Array(0);r=new H(r);r=r.getBytes();var c=this.pixelBitlength/8;var g=c*this.width;var p=new Uint8Array(g*this.height);var q=r.length;for(k=a=d=0;a<q;){switch(r[a++]){case 0:for(b=l=0;l<g;b=l+=1)p[k++]=r[a++];break;case 1:for(b=f=0;f<g;b=f+=1){l=r[a++];var u=b<c?0:p[k-c];p[k++]=(l+u)%256}break;case 2:for(b=
u=0;u<g;b=u+=1){l=r[a++];var v=(b-b%c)/c;f=d&&p[(d-1)*g+v*c+b%c];p[k++]=(f+l)%256}break;case 3:for(b=h=0;h<g;b=h+=1)l=r[a++],v=(b-b%c)/c,u=b<c?0:p[k-c],f=d&&p[(d-1)*g+v*c+b%c],p[k++]=(l+Math.floor((u+f)/2))%256;break;case 4:for(b=h=0;h<g;b=h+=1){l=r[a++];v=(b-b%c)/c;u=b<c?0:p[k-c];0===d?f=e=0:(f=p[(d-1)*g+v*c+b%c],e=v&&p[(d-1)*g+(v-1)*c+b%c]);var t=u+f-e;b=Math.abs(t-u);v=Math.abs(t-f);t=Math.abs(t-e);u=b<=v&&b<=t?u:v<=t?f:e;p[k++]=(l+u)%256}break;default:throw Error("Invalid filter algorithm: "+
r[a-1]);}d++}return p};m.prototype.decodePalette=function(){var r,l,k,b,a;var d=this.palette;var f=this.transparency.indexed||[];var e=new Uint8Array((f.length||0)+d.length);var h=k=r=l=0;for(b=d.length;k<b;h=k+=3)e[l++]=d[h],e[l++]=d[h+1],e[l++]=d[h+2],e[l++]=null!=(a=f[r++])?a:255;return e};m.prototype.copyToImageData=function(r,l){var k,b;var a=this.colors;var d=null;var f=this.hasAlphaChannel;this.palette.length&&(d=null!=(k=this._decodedPalette)?k:this._decodedPalette=this.decodePalette(),a=
4,f=!0);r=r.data||r;var e=r.length;var h=d||l;k=b=0;if(1===a)for(;k<e;)a=d?4*l[k/4]:b,b=h[a++],r[k++]=b,r[k++]=b,r[k++]=b,r[k++]=f?h[a++]:this.transparency.grayscale&&this.transparency.grayscale===b?0:255,b=a;else for(;k<e;)a=d?4*l[k/4]:b,r[k++]=h[a++],r[k++]=h[a++],r[k++]=h[a++],r[k++]=f?h[a++]:this.transparency.rgb&&this.transparency.rgb[1]===h[a-3]&&this.transparency.rgb[3]===h[a-2]&&this.transparency.rgb[5]===h[a-1]?0:255,b=a};m.prototype.decode=function(){var r=new Uint8Array(this.width*this.height*
4);this.copyToImageData(r,this.decodePixels());return r};var n=function(r){(void 0).clearRect(0,0,r.width,r.height);(void 0).putImageData(r,0,0);r=new Image;r.src=(void 0).toDataURL();return r};m.prototype.decodeFrames=function(r){var l,k;if(this.animation){var b=this.animation.frames;var a=[];var d=l=0;for(k=b.length;l<k;d=++l){d=b[d];var f=r.createImageData(d.width,d.height);var e=this.decodePixels(new Uint8Array(d.data));this.copyToImageData(f,e);d.imageData=f;a.push(d.image=n(f))}return a}};m.prototype.renderFrame=
function(r,l){var k=this.animation.frames;var b=k[l];k=k[l-1];0===l&&r.clearRect(0,0,this.width,this.height);1===(null!=k?k.disposeOp:void 0)?r.clearRect(k.xOffset,k.yOffset,k.width,k.height):2===(null!=k?k.disposeOp:void 0)&&r.putImageData(k.imageData,k.xOffset,k.yOffset);0===b.blendOp&&r.clearRect(b.xOffset,b.yOffset,b.width,b.height);return r.drawImage(b.image,b.xOffset,b.yOffset)};m.prototype.animate=function(r){var l,k=this;var b=0;var a=this.animation;var d=a.numFrames;var f=a.frames;var e=
a.numPlays;return(l=function(){var h=b++%d;var c=f[h];k.renderFrame(r,h);if(1<d&&b/d<e)return k.animation._timeout=setTimeout(l,c.delay)})()};m.prototype.stopAnimation=function(){var r;return clearTimeout(null!=(r=this.animation)?r._timeout:void 0)};m.prototype.render=function(r){r._png&&r._png.stopAnimation();r._png=this;r.width=this.width;r.height=this.height;r=r.getContext("2d");if(this.animation)return this.decodeFrames(r),this.animate(r);var l=r.createImageData(this.width,this.height);this.copyToImageData(l,
this.decodePixels());return r.putImageData(l,0,0)};return m}()})},"esri/layers/rasterFormats/Raw":function(){define([],function(){return{decodeBIP:function(H,m){var n=m.pixelType,r=m.bandCount,l=[],k=m.width*m.height,b=this.getBandCount(H,m);r=r||b;var a=H.byteLength-H.byteLength%(k*this._getPixelLength(n)),d=new n(H,0,k*b),f,e,h;for(f=0;f<r;f++){var c=new n(k);for(e=0;e<k;e++)c[e]=d[e*b+f];l.push(c)}a<H.byteLength-1&&(h=this._decodeMask(H.slice(a),m));return{pixels:l,maskData:h}},decodeBSQ:function(H,
m){var n=m.pixelType,r=m.bandCount;if(void 0===r||null===r)r=this.getBandCount(H,m);var l=[],k=m.width*m.height,b=k*r,a=H.byteLength-H.byteLength%(k*this._getPixelLength(n));n=new n(H,0,b);var d;for(b=0;b<r;b++)l.push(n.subarray(b*k,(b+1)*k));a<H.byteLength-1&&(d=this._decodeMask(H.slice(a),m));return{pixels:l,maskData:d}},getBandCount:function(H,m){return Math.floor(H.byteLength/(m.width*m.height*this._getPixelLength(m.pixelType)))},_getPixelLength:function(H){var m=1;switch(H){case Uint8Array:case Int8Array:case Uint8ClampedArray:m=
1;break;case Uint16Array:case Int16Array:m=2;break;case Uint32Array:case Int32Array:case Float32Array:m=4;break;case Float64Array:m=8}return m},_decodeMask:function(H,m){var n=m.width*m.height;if(8*H.byteLength<n)return null;H=new Uint8Array(H,0,Math.ceil(n/8));m=new Uint8Array(m.width*m.height);var r=0,l=0,k=0,b=0;for(k=0;k<H.length-1;k++)for(l=H[k],b=7;0<=b;b--)m[r++]=l>>b&1;for(b=7;r<n-1;)l=H[H.length-1],m[r++]=l>>b&1,b--;return m}}})},"esri/layers/rasterFormats/TiffDecoder":function(){define(["./Jpg",
"./Zlib"],function(H,m){var n=function(){var b=new ArrayBuffer(4),a=new Uint8Array(b);b=new Uint32Array(b);a[0]=1;a[1]=2;a[2]=3;a[3]=4;return 67305985===b[0]},r=function(){var b=[];b[254]="NEWSUBFILETYPE";b[255]="SUBFILETYPE";b[256]="IMAGEWIDTH";b[257]="IMAGELENGTH";b[258]="BITSPERSAMPLE";b[259]="COMPRESSION";b[262]="PHOTOMETRICINTERPRETATION";b[263]="THRESHHOLDING";b[264]="CELLWIDTH";b[265]="CELLLENGTH";b[266]="FILLORDER";b[269]="DOCUMENTNAME";b[270]="IMAGEDESCRIPTION";b[271]="MAKE";b[272]="MODEL";
b[273]="STRIPOFFSETS";b[274]="ORIENTATION";b[277]="SAMPLESPERPIXEL";b[278]="ROWSPERSTRIP";b[279]="STRIPBYTECOUNTS";b[280]="MINSAMPLEVALUE";b[281]="MAXSAMPLEVALUE";b[282]="XRESOLUTION";b[283]="YRESOLUTION";b[284]="PLANARCONFIGURATION";b[285]="PAGENAME";b[286]="XPOSITION";b[287]="YPOSITION";b[288]="FREEOFFSETS";b[289]="FREEBYTECOUNTS";b[290]="GRAYRESPONSEUNIT";b[291]="GRAYRESPONSECURVE";b[292]="T4OPTIONS";b[293]="T6OPTIONS";b[296]="RESOLUTIONUNIT";b[297]="PAGENUMBER";b[300]="COLORRESPONSEUNIT";b[301]=
"TRANSFERFUNCTION";b[305]="SOFTWARE";b[306]="DATETIME";b[315]="ARTIST";b[316]="HOSTCOMPUTER";b[317]="PREDICTOR";b[318]="WHITEPOINT";b[319]="PRIMARYCHROMATICITIES";b[320]="COLORMAP";b[321]="HALFTONEHINTS";b[322]="TILEWIDTH";b[323]="TILELENGTH";b[324]="TILEOFFSETS";b[325]="TILEBYTECOUNTS";b[326]="BADFAXLINES";b[327]="CLEANFAXDATA";b[328]="CONSECUTIVEBADFAXLINES";b[330]="SUBIFD";b[332]="INKSET";b[333]="INKNAMES";b[334]="NUMBEROFINKS";b[336]="DOTRANGE";b[337]="TARGETPRINTER";b[338]="EXTRASAMPLES";b[339]=
"SAMPLEFORMAT";b[340]="SMINSAMPLEVALUE";b[341]="SMAXSAMPLEVALUE";b[342]="TRANSFERRANGE";b[347]="JPEGTABLES";b[512]="JPEGPROC";b[513]="JPEGIFOFFSET";b[514]="JPEGIFBYTECOUNT";b[515]="JPEGRESTARTINTERVAL";b[517]="JPEGLOSSLESSPREDICTORS";b[518]="JPEGPOINTTRANSFORM";b[519]="JPEGQTABLES";b[520]="JPEGDCTABLES";b[521]="JPEGACTABLES";b[529]="YCBCRCOEFFICIENTS";b[530]="YCBCRSUBSAMPLING";b[531]="YCBCRPOSITIONING";b[532]="REFERENCEBLACKWHITE";b[33550]="GEOPIXELSCALE";b[33922]="GEOTIEPOINTS";b[33432]="COPYRIGHT";
b[42112]="GDAL_METADATA";b[42113]="GDAL_NODATA";b[50844]="RPCCOEFFICIENT";b[34735]="GEOKEYDIRECTORY";b[34736]="GEODOUBLEPARAMS";b[34737]="GEOASCIIPARAMS";return b}(),l=[0,1,1,2,4,8,1,1,2,4,8,4,8],k=function(b,a){var d="UNKNOWN";3===b?d="F32":1===b?8>=a?d="U8":16>=a?d="U16":32>=a&&(d="U32"):2===b&&(8>=a?d="S8":16>=a?d="S16":32>=a&&(d="S32"));return d};return{decode:function(b){var a=new DataView(b,0,8),d=a.getUint16(0,!1);if(18761===d)var f=!0;else if(19789===d)f=!1;else throw"unexpected endianess byte";
if(42!==a.getUint16(2,f))throw"unexpected tiff identifier";var e=a.getUint32(4,f);var h=f;var c,g;var p=e;for(var q=[];p;){var u=(new DataView(b,p,2)).getUint16(0,h);var v=p+2;p=(new DataView(b,v+12*u,4)).getUint32(0,h);var t={};for(c=0;c<u;c++){var y=new DataView(b,v,12);var C=y.getUint16(0,h);var B=y.getUint16(2,h);var F=y.getUint32(4,h);var x=y.getUint32(8,h);v+=12;if(!(7===B||12<B)){var w=g={fieldTag:C,fieldType:B,fieldValueCount:F,fieldValueOffset:x},A=void 0,z=void 0,G=b,J=h,L=[],R=g.fieldType,
T=g.fieldValueCount,aa=g.fieldValueOffset,ca=aa,ba=l[R],la=8*ba,oa=T*ba,fa=T*l[R]*8;if(32>=fa)if(J||(aa>>>=32-fa),1===T)L=[aa];else for(A=0;A<T;A++)L.push(aa<<la*A>>>32-la);else for(ca=aa;ca<aa+oa;ca+=ba){switch(R){case 1:z=(new DataView(G,ca,1)).getUint8(0);break;case 2:z=(new DataView(G,ca,1)).getUint8(0);break;case 3:z=(new DataView(G,ca,2)).getUint16(0,J);break;case 4:z=(new DataView(G,ca,4)).getUint32(0,J);break;case 5:z=(new DataView(G,ca,4)).getUint32(0,J)/(new DataView(G,ca+4,4)).getUint32(0,
J);break;case 6:z=(new DataView(G,ca,1)).getInt8(0);break;case 8:z=(new DataView(G,ca,2)).getInt16(0,J);break;case 9:z=(new DataView(G,ca,4)).getInt32(0,J);break;case 10:z=(new DataView(G,ca,4)).getInt32(0,J)/(new DataView(G,ca+4,4)).getInt32(0,J);break;case 11:z=(new DataView(G,ca,4)).getFloat32(0,J);break;case 12:z=(new DataView(G,ca,8)).getFloat64(0,J);break;case 7:z=null;break;default:z=null}L.push(z)}if(2===R){var M="",X=L;L=[];for(A=0;A<X.length;A++)0===X[A]&&""!==M?(L.push(M),M=""):M+=String.fromCharCode(X[A]);
""===M&&0!==L.length||L.push(M)}w.fieldValues=L;var da=t,Q=r[C];void 0===Q&&(Q="unknown"+C);da[Q]={type:B,values:g.fieldValues}}}q.push(t)}if(0===q.length)throw"no valid image file directory";var K,E=q[0],N=void 0===E.GDAL_NODATA||null===E.GDAL_NODATA?null:parseFloat(E.GDAL_NODATA.values[0]);if(E.TILEOFFSETS){var I=n()===h,O=E.TILEOFFSETS?E.TILEOFFSETS.values:void 0;if(void 0===O)var U=void 0;else{var ha=E.TILEBYTECOUNTS.values,ia=E.TILEWIDTH.values[0],S=E.TILELENGTH.values[0],W=E.IMAGEWIDTH.values[0],
ka=E.IMAGELENGTH.values[0],ja=W*ka,ma=E.BITSPERSAMPLE.values[0],ta=E.SAMPLESPERPIXEL.values[0],D=E.SAMPLEFORMAT?E.SAMPLEFORMAT.values[0]:1,P=k(D,ma);if(1!==(E.PLANARCONFIGURATION?E.PLANARCONFIGURATION.values[0]:1))throw console.log("can only handle PLANARCONFIGURATION\x3d1"),"can only handle PLANARCONFIGURATION\x3d1";var Y=E.COMPRESSION?E.COMPRESSION.values[0]:1;if(1!==Y&&6!==Y&&8!==Y&&32946!==Y)throw console.log("this compression is not supported at this moment"),"this compression is not supported at this moment";
if(3<D)U=void 0;else{if(3===D){var Z=new Float32Array(ja*ta);var V=Float32Array}else 1===D?8>=ma?(Z=new Uint8Array(ja*ta),V=Uint8Array):16>=ma?(Z=new Uint16Array(ja*ta),V=Uint16Array):32>=ma&&(Z=new Uint32Array(ja*ta),V=Uint32Array):2===D&&(8>=ma?(Z=new Int8Array(ja*ta),V=Int8Array):16>=ma?(Z=new Int16Array(ja*ta),V=Int16Array):32>=ma&&(Z=new Int32Array(ja*ta),V=Int32Array));var ea,na,pa,sa,ua,Aa=Math.ceil(W/ia);if(0===ma%8)for(ea=0;ea<O.length;ea++){var wa=Math.floor(ea/Aa)*S;var va=ea%Aa*ia;var ra=
(wa*W+va)*ta;if("U8"===P||"S8"===P||I)if(8===Y||32946===Y){var qa=new Uint8Array(b,O[ea],ha[ea]);var ya=new m(qa);var Ba=ya.getBytes();var Fa=new ArrayBuffer(Ba.length);qa=new Uint8Array(Fa);qa.set(Ba);qa.length!==ia*S*ta*ma/8&&console.log("tile byte counts is different than expected")}else if(6===Y){qa=new Uint8Array(b,O[ea],ha[ea]);var La=new H;La.parse(qa);var Ca=La.getData(La.width,La.height);Fa=new ArrayBuffer(Ca.length);qa=new Uint8Array(Fa);qa.set(Ca)}else 1===Y&&(ha[ea]!==ia*S*ta*ma/8&&console.log("tile byte counts is different than expected"),
Fa=b.slice(O[ea],O[ea]+ha[ea]));else{if(8===Y||32946===Y){qa=new Uint8Array(b,O[ea],ha[ea]);ya=new m(qa);qa=ya.getBytes();Fa=new ArrayBuffer(qa.length);var Ia=new Uint8Array(Fa);qa.length!==ia*S*ta*ma/8&&console.log("tile byte counts is different than expected")}else 1===Y&&(ha[ea]!==ia*S*ta*ma/8&&console.log("tile byte counts is different than expected"),Fa=new ArrayBuffer(ha[ea]),qa=new Uint8Array(b,O[ea],ha[ea]),Ia=new Uint8Array(Fa));switch(P){case "U16":case "S16":for(pa=0;pa<qa.length;pa+=2)Ia[pa]=
qa[pa+1],Ia[pa+1]=qa[pa];break;case "U32":case "S32":case "F32":for(pa=0;pa<qa.length;pa+=4)Ia[pa]=qa[pa+3],Ia[pa+1]=qa[pa+2],Ia[pa+2]=qa[pa+1],Ia[pa+3]=qa[pa]}}var hb=new V(Fa);var ab=0;var bb=ra;var ib=Math.min(ia,W-va);var jb=Math.min(S,ka-wa);for(sa=0;sa<jb;sa++)for(bb=ra+sa*W*ta,ab=sa*ia*ta,ua=0;ua<ib*ta;ua++,bb++,ab++)Z[bb]=hb[ab]}var Xa={width:W,height:ka,pixelType:P};if(1===ta)Xa.pixels=[Z];else for(Xa.pixels=[],ea=0;ea<ta;ea++){var db=new V(ja);for(na=0;na<ja;na++)db[na]=Z[na*ta+ea];Xa.pixels.push(db)}U=
Xa}}}else if(E.STRIPOFFSETS){var kb=n()===h,Ma=E.STRIPOFFSETS?E.STRIPOFFSETS.values:void 0;if(void 0===Ma)U=void 0;else{var Na=E.STRIPBYTECOUNTS.values,Sa=E.ROWSPERSTRIP.values,Oa=E.IMAGEWIDTH.values[0],Ta=E.IMAGELENGTH.values[0],Pa=Oa*Ta,Ga=E.BITSPERSAMPLE.values[0],Ea=E.SAMPLESPERPIXEL.values[0],Ua=E.SAMPLEFORMAT?E.SAMPLEFORMAT.values[0]:1,Ya=k(Ua,Ga);if(1!==(E.PLANARCONFIGURATION?E.PLANARCONFIGURATION.values[0]:1))throw console.log("can only handle PLANARCONFIGURATION\x3d1"),"can only handle PLANARCONFIGURATION\x3d1";
var Ha=E.COMPRESSION?E.COMPRESSION.values[0]:1;if(1!==Ha&&6!==Ha&&8!==Ha&&32946!==Ha)throw console.log("compressed tiff is not supported at this moment"),"compressed tiff is not supported at this moment";if(3<Ua)U=void 0;else{if(3===Ua){var Ja=new Float32Array(Pa*Ea);var Qa=Float32Array}else 1===Ua?8>=Ga?(Ja=new Uint8Array(Pa*Ea),Qa=Uint8Array):16>=Ga?(Ja=new Uint16Array(Pa*Ea),Qa=Uint16Array):32>=Ga&&(Ja=new Uint32Array(Pa*Ea),Qa=Uint32Array):2===Ua&&(8>=Ga?(Ja=new Int8Array(Pa*Ea),Qa=Int8Array):
16>=Ga?(Ja=new Int16Array(Pa*Ea),Qa=Int16Array):32>=Ga&&(Ja=new Int32Array(Oa*Ta*Ea),Qa=Int32Array));var xa,Va,Da,Wa=Sa;if(0===Ga%8)for(xa=0;xa<Ma.length;xa++){var lb=xa*Sa*Oa*Ea;Wa=(xa+1)*Sa>Ta?Ta-xa*Sa:Sa;if("U8"===Ya||"S8"===Ya||kb)if(8===Ha||32946===Ha){var za=new Uint8Array(b,Ma[xa],Na[xa]);var cb=new m(za);var eb=cb.getBytes();var Ka=new ArrayBuffer(eb.length);za=new Uint8Array(Ka);za.set(eb);za.length!==Wa*Oa*Ea*Ga/8&&console.log("strip byte counts is different than expected")}else if(6===
Ha){za=new Uint8Array(b,Ma[xa],Na[xa]);var Za=new H;Za.parse(za);var fb=Za.getData(Za.width,Za.height);Ka=new ArrayBuffer(fb.length);za=new Uint8Array(Ka);za.set(fb)}else 1===Ha&&(Na[xa]!==Wa*Oa*Ea*Ga/8&&console.log("strip byte counts is different than expected"),Ka=b.slice(Ma[xa],Ma[xa]+Na[xa]));else{if(6===Ha||8===Ha||32946===Ha){za=new Uint8Array(b,Ma[xa],Na[xa]);cb=new m(za);za=cb.getBytes();Ka=new ArrayBuffer(za.length);var Ra=new Uint8Array(Ka);za.length!==Wa*Oa*Ea*Ga/8&&console.log("strip byte counts is different than expected")}else 1===
Ha&&(Na[xa]!==Wa*Oa*Ea*Ga/8&&console.log("strip byte counts is different than expected"),Ka=new ArrayBuffer(Na[xa]),za=new Uint8Array(b,Ma[xa],Na[xa]),Ra=new Uint8Array(Ka));switch(Ya){case "U16":case "S16":for(Da=0;Da<za.length;Da+=2)Ra[Da]=za[Da+1],Ra[Da+1]=za[Da];break;case "U32":case "S32":case "F32":for(Da=0;Da<za.length;Da+=4)Ra[Da]=za[Da+3],Ra[Da+1]=za[Da+2],Ra[Da+2]=za[Da+1],Ra[Da+3]=za[Da]}}var mb=new Qa(Ka);Ja.set(mb,lb)}var $a={width:Oa,height:Ta,pixelType:Ya};if(1===Ea)$a.pixels=[Ja];
else for($a.pixels=[],xa=0;xa<Ea;xa++){var gb=new Qa(Pa);for(Va=0;Va<Pa;Va++)gb[Va]=Ja[Va*Ea+xa];$a.pixels.push(gb)}U=$a}}}if(null!==N){U.maskData=new Uint8Array(U.width*U.height);if(1E24<Math.abs(N))for(K=0;K<U.width*U.height;K++)U.maskData[K]=1E-6>Math.abs((U.pixels[0][K]-N)/N)?0:1;else for(K=0;K<U.width*U.height;K++)U.maskData[K]=U.pixels[0][K]===N?0:1;U.noDataValue=N}return U}}})},"esri/layers/rasterLib/tile/RasterHandler":function(){define("require exports module dojo/Deferred dojo/promise/all ../../PixelBlock ../../vectorTiles/core/workers ../../vectorTiles/core/promiseUtils ../../vectorTiles/core/requireUtils ../../vectorTiles/request ../../rasterLib/function/rasterFunctionHelper ../../rasterLib/renderer/rasterRendererHelper".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h){function c(g){var p=new r;l(g).then(function(q){p.resolve()});return p.promise}return function(){function g(p){this.customModules=p&&p.customModules}g.prototype.destroy=function(){this.stop();this.customModules=this.rasterLayer=null};g.prototype.start=function(){this.stop();var p=new r,q=0,u=this.customModules?this.customModules.length+1:1,v=d.getAbsMid("esri/layers/rasterLib/tile/RasterWorker",H,n),t=b.open(v,{client:this}).then(function(y){this._connection=y;q++;
q===u&&(this._connected=!0,p.resolve())}.bind(this));this._openDL=[t];this.customModules&&this.customModules.forEach(function(y){t=b.open(y,{client:this}).then(function(C){q++;q===u&&(this._connected=!0,p.resolve())});this._openDL.push(t);console.log(y)}.bind(this));return this._connectionPromise=p.promise};g.prototype.stop=function(){this._openDL?this._openDL.forEach(function(p){p.isFulfilled()||p.cancel()}.bind(this)):this._connectionPromise&&!this._connectionPromise.isFulfilled()&&this._connectionPromise.cancel();
this._connection&&(this._connection.close(),this._connection=null)};g.prototype.decode=function(p){if(!this._connectionPromise.isFulfilled()||!this._connection)return a.reject(Error("no connection"));var q={id:null};return this._connection.invoke("decode",p,[],q).then(function(u){u.targetWorker=q;return u})};g.prototype.process=function(p){if(!this._connectionPromise.isFulfilled()||!this._connection)return a.reject(Error("no connection"));var q={id:null};p.layerId=this.rasterLayer.layerId;var u=new r;
this._connection.invoke("process",p,[],q).then(function(v){v.targetWorker=q;v.src?Object.keys(v.src).forEach(function(t){v.src[t].pixelBlock=new k(v.src[t].pixelBlock)}):v.src=null;v.pixelBlock&&(v.pixelBlock=new k(v.pixelBlock));u.resolve(v)});return u.promise};g.prototype.render=function(p){if(!this._connectionPromise.isFulfilled()||!this._connection)return a.reject(Error("no connection"));var q={id:null};p.layerId=this.rasterLayer.layerId;return this._connection.invoke("render",p,[],q).then(function(u){u.targetWorker=
q;u.pixelBlock=u.pixelBlock?new k(u.pixelBlock):null;return u})};g.prototype.setLayer=function(p){if(!this._connectionPromise.isFulfilled()||!this._connection)return a.reject(Error("no connection"));this.rasterLayer=p;p=this._connection.broadcast("setLayer",p,[],{id:null});return c(p)};g.prototype.setRasterFunction=function(p){if(!this._connectionPromise.isFulfilled()||!this._connection)return a.reject(Error("no connection"));p=this._connection.broadcast("setRasterFunction",p,[],{id:null});return c(p)};
g.prototype.setRasterRenderer=function(p){if(!this._connectionPromise.isFulfilled()||!this._connection)return a.reject(Error("no connection"));p=this._connection.broadcast("setRasterRenderer",p,[],{id:null});return c(p)};return g}()})},"esri/layers/vectorTiles/core/workers":function(){define(["require","exports","./workers/workers"],function(H,m,n){Object.defineProperty(m,"__esModule",{value:!0});for(var r in n)m.hasOwnProperty(r)||(m[r]=n[r])})},"esri/layers/vectorTiles/core/workers/workers":function(){define("require exports dojo/sniff dojo/promise/all ../Logger ../promiseUtils ./Connection ./RemoteClient ./WorkerOwner".split(" "),
function(H,m,n,r,l,k,b,a,d){function f(){if(q)return q;for(var u=e+h,v=[],t=function(C){var B=d.create(C).then(function(F){return p[C]=F});v.push(B)},y=0;y<u;y++)t(y);return q=r(v).then(function(){})}Object.defineProperty(m,"__esModule",{value:!0});m.Connection=b;m.RemoteClient=a;(b=navigator.hardwareConcurrency)||(b=n("safari")&&n("mac")||n("trident")?8:2);var e=n("esri-workers-debug")?1:Math.max(1,Math.ceil(b/2)),h=n("esri-workers-debug")?1:Math.max(1,Math.floor(b/2)),c=l.getLogger("esri.core.workers"),
g=0,p=[];m.initialize=function(){f()};m.open=function(u,v,t){void 0===v&&(v={});if(Array.isArray(u))return new m.Connection(u.map(function(B){return new m.RemoteClient(B,v.client)}));if("string"!==typeof u){c.warn("workers-open:signature-deprecated","DEPRECATED: workers.open() changed signature.");var y=u;u=v;v={client:y,strategy:t?"dedicated":"distributed"}}var C=v.strategy||"distributed";return"local"===C?k.create(function(B){H([u],function(F){B(m.RemoteClient.connect(F))})}).then(function(B){return new m.Connection([new m.RemoteClient(B,
v.client)])}):f().then(function(){if("dedicated"===C){var B=e+g++;g%=h;return p[B].open(u).then(function(F){return new m.Connection([new m.RemoteClient(F,v.client)])})}return k.all(p.map(function(F){return F.open(u)})).then(function(F){return new m.Connection(F.map(function(x){return new m.RemoteClient(x,v.client)}))})})};m.terminate=function(){for(var u=0;u<p.length;u++)p[u]&&p[u].terminate();p.length=0};var q})},"esri/layers/vectorTiles/core/Logger":function(){define(["require","exports","dojo/has"],
function(H,m,n){var r={info:0,warn:1,error:2};H=function(){function l(k){void 0===k&&(k={});this.module=k.module||"";this.writer=k.writer||null;this.level=k.level||null;null!=k.enabled&&(this.enabled=!!k.enabled);l._loggers[this.module]=this;k=this.module.lastIndexOf(".");-1!==k&&(this.parent=l.getLogger(this.module.slice(0,k)))}l.prototype.log=function(k){for(var b=[],a=1;a<arguments.length;a++)b[a-1]=arguments[a];this._isEnabled()&&this._matchLevel(k)&&(a=this._inheritedWriter())&&a.apply(void 0,
[k,this.module].concat(b))};l.prototype.error=function(){for(var k=[],b=0;b<arguments.length;b++)k[b]=arguments[b];this.log.apply(this,["error"].concat(k))};l.prototype.warn=function(){for(var k=[],b=0;b<arguments.length;b++)k[b]=arguments[b];this.log.apply(this,["warn"].concat(k))};l.prototype.info=function(){for(var k=[],b=0;b<arguments.length;b++)k[b]=arguments[b];this.log.apply(this,["info"].concat(k))};l.prototype.getLogger=function(k){return l.getLogger(this.module+"."+k)};l.getLogger=function(k){var b=
l._loggers[k];b||(b=new l({module:k}));return b};l.prototype._parentWithMember=function(k,b){for(var a=this;a&&null==a[k];)a=a.parent;return a?a[k]:b};l.prototype._inheritedWriter=function(){return this._parentWithMember("writer",this._consoleWriter)};l.prototype._consoleWriter=function(k,b){for(var a=[],d=2;d<arguments.length;d++)a[d-2]=arguments[d];console[k].apply(console,["["+b+"]"].concat(a))};l.prototype._matchLevel=function(k){return r[this._parentWithMember("level","error")]<=r[k]};l.prototype._isEnabled=
function(){return this._parentWithMember("enabled",!0)};l._loggers={};return l}();m=H.getLogger("esri");n("dojo-debug-messages")?m.level="info":m.level="warn";return H})},"esri/layers/vectorTiles/core/promiseUtils":function(){define("require exports dojo/Deferred dojo/when dojo/promise/all ./Error".split(" "),function(H,m,n,r,l,k){function b(a){if(a){if("function"!==typeof a.forEach){var d=Object.keys(a),f=d.map(function(g){return a[g]});return b(f).then(function(g){var p={};d.forEach(function(q,
u){return p[q]=g[u]});return p})}var e=new n,h=[],c=a.length;0===c&&e.resolve(h);a.forEach(function(g){var p={promise:g};h.push(p);g.then(function(q){p.value=q}).catch(function(q){p.error=q}).then(function(){--c;0===c&&e.resolve(h)})});return e.promise}}Object.defineProperty(m,"__esModule",{value:!0});m.all=function(a){return l(a)};m.filter=function(a,d){var f=a.slice();return l(a.map(function(e,h){return d(e,h)})).then(function(e){return f.filter(function(h,c){return e[c]})})};m.eachAlways=b;m.create=
function(a,d){var f=new n(d);a(function(e){void 0===e&&(e=null);return r(e).then(f.resolve)},f.reject);return f.promise};m.reject=function(a){var d=new n;d.reject(a);return d.promise};m.resolve=function(a){void 0===a&&(a=null);var d=new n;d.resolve(a);return d.promise};m.after=function(a,d){void 0===d&&(d=null);var f=0,e=new n(function(){f&&(clearTimeout(f),f=0)});f=setTimeout(function(){e.resolve(d)},a);return e.promise};m.timeout=function(a,d,f){var e=0,h=new n(a.cancel);a.then(function(c){h.isFulfilled()||
(h.resolve(c),e&&(clearTimeout(e),e=0))});a.catch(function(c){h.isFulfilled()||(h.reject(c),e&&(clearTimeout(e),e=0))});e=setTimeout(function(){var c=f||new k("promiseUtils:timeout","The wrapped promise did not resolve within "+d+" ms");h.reject(c)},d);return h.promise};m.wrapCallback=function(a){var d=!1,f=new n(function(){return d=!0});a(function(e){d||f.resolve(e)});return f.promise};m.isThenable=function(a){return a&&"function"===typeof a.then};m.when=function(a){return r(a)}})},"esri/layers/vectorTiles/core/Error":function(){define(["require",
"exports","./tsSupport/extendsHelper","./lang","./Message"],function(H,m,n,r,l){H=function(k){function b(a,d,f){var e=k.call(this,a,d,f)||this;return e instanceof b?e:new b(a,d,f)}n(b,k);b.prototype.toJSON=function(){return{name:this.name,message:this.message,details:r.clone(this.details),dojoType:this.dojoType}};b.fromJSON=function(a){var d=new b(a.name,a.message,a.details);null!=a.dojoType&&(d.dojoType=a.dojoType);return d};return b}(l);H.prototype.type="error";return H})},"esri/layers/vectorTiles/core/tsSupport/extendsHelper":function(){define([],
function(){return function(){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,n){m.__proto__=n}||function(m,n){for(var r in n)n.hasOwnProperty(r)&&(m[r]=n[r])};return function(m,n){function r(){this.constructor=m}H(m,n);m.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()})},"esri/layers/vectorTiles/core/lang":function(){define("dojo/_base/kernel dojo/_base/lang dojo/date dojo/number dojo/date/locale dojo/i18n!../nls/common".split(" "),function(H,m,n,r,
l,k){function b(g){return void 0!==g&&null!==g}function a(g){return b(g)?g:""}function d(g,p,q){var u=q.match(/([^\(]+)(\([^\)]+\))?/i),v=m.trim(u[1]);q=p[g];u=JSON.parse((u[2]?m.trim(u[2]):"{}").replace(/^\(/,"{").replace(/\)$/,"}").replace(/([{,])\s*([0-9a-zA-Z_]+)\s*:/gi,'$1"$2":').replace(/"\s*:\s*'/gi,'":"').replace(/'\s*(,|\})/gi,'"$1'));var t=u.utcOffset;if(-1===h.indexOf(v))v=m.getObject(v),m.isFunction(v)&&(q=v(q,g,p,u));else if("number"===typeof q||"string"===typeof q&&q&&!isNaN(Number(q)))switch(q=
Number(q),v){case "NumberFormat":g=m.mixin({},u);p=parseFloat(g.places);if(isNaN(p)||0>p)g.places=Infinity;return r.format(q,g);case "DateString":q=new Date(q);if(u.local||u.systemLocale)return u.systemLocale?q.toLocaleDateString()+(u.hideTime?"":" "+q.toLocaleTimeString()):q.toDateString()+(u.hideTime?"":" "+q.toTimeString());q=q.toUTCString();u.hideTime&&(q=q.replace(/\s+\d\d:\d\d:\d\d\s+(utc|gmt)/i,""));return q;case "DateFormat":return q=new Date(q),b(t)&&(q=n.add(q,"minute",q.getTimezoneOffset()-
t)),l.format(q,u)}return a(q)}function f(g,p){var q;if(p)for(q in g)g.hasOwnProperty(q)&&(void 0===g[q]?delete g[q]:g[q]instanceof Object&&f(g[q],!0));else for(q in g)g.hasOwnProperty(q)&&void 0===g[q]&&delete g[q];return g}function e(g){if(!g||"object"!=typeof g||m.isFunction(g))return g;if(g instanceof Int8Array||g instanceof Uint8Array||g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Int32Array||g instanceof Uint16Array||g instanceof Uint32Array||g instanceof Float32Array||
g instanceof Float64Array||g instanceof Date)return new g.constructor(g);if(g instanceof ArrayBuffer)return g.slice(0,g.byteLength);if("function"===typeof g.clone)g=g.clone();else if("function"===typeof g.map&&"function"===typeof g.forEach)g=g.map(e);else if("function"===typeof g.notifyChange&&"function"===typeof g.watch)g=g.clone();else{var p={},q,u={};for(q in g){var v=g[q];var t=!(q in u)||u[q]!==v;if(!(q in p)||p[q]!==v&&t)p[q]=e?e(v):v}g=p}return g}var h=["NumberFormat","DateString","DateFormat"],
c=/<\/?[^>]+>/g;return{equals:function(g,p){return g===p||"number"===typeof g&&isNaN(g)&&"number"===typeof p&&isNaN(p)||m.isFunction((g||{}).getTime)&&m.isFunction((p||{}).getTime)&&g.getTime()==p.getTime()||m.isFunction((g||{}).equals)&&g.equals(p)||m.isFunction((p||{}).equals)&&p.equals(g)||!1},mixin:m.mixin,valueOf:function(g,p){for(var q in g)if(g[q]==p)return q;return null},stripTags:function(g){if(g){var p=typeof g;if("string"===p)g=g.replace(c,"");else if("object"===p)for(var q in g)(p=g[q])&&
"string"===typeof p&&(p=p.replace(c,"")),g[q]=p}return g},substitute:function(g,p,q){if(b(q))if(m.isObject(q)){var u=q.first;var v=q.dateFormat;var t=q.numberFormat}else u=q;if(p&&"{*}"!==p)return m.replace(p,m.hitch({obj:g},function(C,B){C=B.split(":");return 1<C.length?(B=C[0],C.shift(),d(B,this.obj,C.join(":"))):v&&-1!==(v.properties||[]).indexOf(B)?d(B,this.obj,v.formatter||"DateString"):t&&-1!==(t.properties||[]).indexOf(B)?d(B,this.obj,t.formatter||"NumberFormat"):a(this.obj[B])}));p=[];var y;
p.push('\x3ctable class\x3d"esri-widget__table" summary\x3d"'+k.fieldsSummary+'"\x3e\x3ctbody\x3e');for(y in g)if(q=g[y],v&&-1!==(v.properties||[]).indexOf(y)?q=d(y,g,v.formatter||"DateString"):t&&-1!==(t.properties||[]).indexOf(y)&&(q=d(y,g,t.formatter||"NumberFormat")),p.push("\x3ctr\x3e\x3cth\x3e"+y+"\x3c/th\x3e\x3ctd\x3e"+a(q)+"\x3c/td\x3e\x3c/tr\x3e"),u)break;p.push("\x3c/tbody\x3e\x3c/table\x3e");return p.join("")},filter:function(g,p,q){p=[m.isString(g)?g.split(""):g,q||H.global,m.isString(p)?
new Function("item","index","array",p):p];q={};var u;g=p[0];for(u in g)p[2].call(p[u],g[u],u,g)&&(q[u]=g[u]);return q},startsWith:function(g,p,q){q=q||0;return g.indexOf(p,q)===q},endsWith:function(g,p,q){if("number"!==typeof q||!isFinite(q)||Math.floor(q)!==q||q>g.length)q=g.length;q-=p.length;g=g.indexOf(p,q);return-1!==g&&g===q},isDefined:b,fixJson:f,clone:e}})},"esri/layers/vectorTiles/core/Message":function(){define(["require","exports","dojo/string"],function(H,m,n){return function(){function r(l,
k,b){this instanceof r&&(this.name=l,this.message=k&&n.substitute(k,b,function(a){return null==a?"":a})||"",this.details=b)}r.prototype.toString=function(){return"["+this.name+"]: "+this.message};return r}()})},"esri/layers/vectorTiles/core/workers/Connection":function(){define(["require","exports","../promiseUtils"],function(H,m,n){return function(){function r(l){this._clientIdx=0;this._clients=l}r.prototype.broadcast=function(l,k,b){for(var a=[],d=0,f=this._clients;d<f.length;d++)a.push(f[d].invoke(l,
k,b));return a};r.prototype.close=function(){for(var l=0,k=this._clients;l<k.length;l++)k[l].close();this._clients=[]};r.prototype.invoke=function(l,k,b,a){var d=a&&a.client;if(!this._clients||!this._clients.length)return n.reject(Error("Connection closed"));null!=d&&-1!==this._clients.indexOf(d)||this._clients.some(function(f){return f.isBusy()?!1:(d=f,!0)})||(this._clientIdx=(this._clientIdx+1)%this._clients.length,d=this._clients[this._clientIdx]);l=d.invoke(l,k,b);a&&(a.client=d);return l};r.prototype.openPorts=
function(){return n.all(this._clients.map(function(l){return l.openPort()}))};return r}()})},"esri/layers/vectorTiles/core/workers/RemoteClient":function(){define("require exports dojo/Deferred ../Error ../promiseUtils ./utils".split(" "),function(H,m,n,r,l,k){function b(g,p){g["delete"](p)}var a=k.MessageType.CLOSE,d=k.MessageType.CANCEL,f=k.MessageType.INVOKE,e=k.MessageType.RESPONSE,h=k.MessageType.OPEN_PORT,c=function(){function g(p){this._timer=null;this._cancelledJobIds=new Set;this._invokeMessages=
[];this._invoke=p;this._timer=null;this._process=this._process.bind(this)}g.prototype.push=function(p){p.type===k.MessageType.CANCEL?this._cancelledJobIds.add(p.jobId):(this._invokeMessages.push(p),null===this._timer&&(this._timer=setTimeout(this._process,0)))};g.prototype.clear=function(){this._invokeMessages.length=0;this._cancelledJobIds.clear();this._timer=null};g.prototype._process=function(){this._timer=null;for(var p=0,q=this._invokeMessages;p<q.length;p++){var u=q[p];this._cancelledJobIds.has(u.jobId)||
this._invoke(u)}this._cancelledJobIds.clear();this._invokeMessages.length=0};return g}();return function(){function g(p,q,u){this._outJobs=new Map;this._inJobs=new Map;this._queue=new c(this._onInvoke.bind(this));this._onMessage=this._onMessage.bind(this);this._client=q;this._port=p;this._port.addEventListener("message",this._onMessage);this._port.start();this._channel=u}g.connect=function(p){var q=new MessageChannel;p="function"===typeof p?new p:"default"in p&&"function"===typeof p.default?new p.default:
p;p.remoteClient=new g(q.port1,p,q);return q.port2};g.prototype.close=function(){this._post({type:a});this._close()};g.prototype.isBusy=function(){return 0<this._outJobs.size};g.prototype.invoke=function(p,q,u){var v=this;if(!this._port)return l.reject(new r("remote-client:port-closed","Can't invoke(), port is closed"));var t=k.newJobId(),y=new n(function(){b(v._outJobs,t);v._post({type:d,jobId:t})});this._outJobs.set(t,y);this._post({type:f,jobId:t,methodName:p},q,u);return y.promise};g.prototype.openPort=
function(){var p=this,q=k.newJobId(),u=new n(function(){b(p._outJobs,q);p._post({type:d,jobId:q})});this._outJobs.set(q,u);this._post({type:h,jobId:q});return u.promise};g.prototype._close=function(){this._channel&&(this._channel=null);this._port.removeEventListener("message",this._onMessage);this._port.close();this._outJobs.forEach(function(p){p.cancel()});this._inJobs.clear();this._outJobs.clear();this._queue.clear();this._port=this._client=null};g.prototype._onMessage=function(p){if(p=k.receiveMessage(p))switch(p.type){case e:this._onResponse(p);
break;case f:this._queue.push(p);break;case d:this._onCancel(p);break;case a:this._close();break;case h:this._onOpenPort(p)}};g.prototype._onCancel=function(p){var q=this._inJobs,u=p.jobId,v=q.get(u);this._queue.push(p);v&&(b(q,u),v.cancel())};g.prototype._onInvoke=function(p){var q=this,u=p.methodName,v=p.jobId;p=p.data;var t=this._inJobs,y=this._client,C=y[u];try{if(!C&&u&&-1!==u.indexOf("."))for(var B=u.split("."),F=0;F<B.length-1;F++)y=y[B[F]],C=y[B[F+1]];if("function"!==typeof C)throw new TypeError(u+
" is not a function");var x=C.call(y,p,this)}catch(w){this._post({type:e,jobId:v,error:k.toInvokeError(w)});return}l.isThenable(x)?(t.set(v,x),x.then(function(w){t.has(v)&&(b(t,v),q._post({type:e,jobId:v},w))}).catch(function(w){t.has(v)&&(b(t,v),w&&"cancel"===w.dojoType||q._post({type:e,jobId:v,error:k.toInvokeError(w||{message:"Error encountered at method "+u})}))})):this._post({type:e,jobId:v},x)};g.prototype._onOpenPort=function(p){var q=new MessageChannel;new g(q.port1,this._client);this._post({type:e,
jobId:p.jobId},q.port2,[q.port2])};g.prototype._onResponse=function(p){var q=p.jobId,u=p.error;p=p.data;var v=this._outJobs;if(v.has(q)){var t=v.get(q);b(v,q);u?t.reject(r.fromJSON(JSON.parse(u))):t.resolve(p)}};g.prototype._post=function(p,q,u){return k.postMessage(this._port,p,q,u)};return g}()})},"esri/layers/vectorTiles/core/workers/utils":function(){define(["require","exports","dojo/has"],function(H,m,n){function r(k){return k&&"object"===typeof k&&("result"in k||"transferList"in k)}Object.defineProperty(m,
"__esModule",{value:!0});(function(k){k[k.HANDSHAKE=0]="HANDSHAKE";k[k.CONFIGURE=1]="CONFIGURE";k[k.CONFIGURED=2]="CONFIGURED";k[k.OPEN=3]="OPEN";k[k.OPENED=4]="OPENED";k[k.RESPONSE=5]="RESPONSE";k[k.INVOKE=6]="INVOKE";k[k.CANCEL=7]="CANCEL";k[k.CLOSE=8]="CLOSE";k[k.OPEN_PORT=9]="OPEN_PORT"})(m.MessageType||(m.MessageType={}));var l=0;m.newJobId=function(){return l++};m.isTranferableResult=r;m.toInvokeError=function(k){return k?k.toJSON?JSON.stringify(k):JSON.stringify({name:k.name,message:k.message,
details:k.details,stack:k.stack}):null};m.postMessage=function(k,b,a,d){2===arguments.length||void 0===a&&void 0===d?k.postMessage(b):(n("esri-workers-supports-transfer-arraybuffer")||(d?(d=d.filter(function(f){return!(f instanceof ArrayBuffer)}),d.length||(d=null)):r(a)&&a.transferList&&(a.transferList=a.transferList.filter(function(f){return!(f instanceof ArrayBuffer)}),a.transferList.length||(a.transferList=null))),d?(b.data=a,k.postMessage(b,d)):r(a)?(b.data=a.result,a.transferList?k.postMessage(b,
a.transferList):k.postMessage(b)):(b.data=a,k.postMessage(b)))};m.receiveMessage=function(k){return k?(k=k.data)?"string"===typeof k?JSON.parse(k):k:null:null}})},"esri/layers/vectorTiles/core/workers/WorkerOwner":function(){define("require exports dojo/Deferred ../../kernel ../Error ../Logger ../promiseUtils ./utils ./workerFactory".split(" "),function(H,m,n,r,l,k,b,a,d){var f=k.getLogger("esri.core.workers"),e=a.MessageType.CANCEL,h=a.MessageType.INVOKE,c=a.MessageType.OPEN,g=a.MessageType.OPENED,
p=a.MessageType.RESPONSE;return function(){function q(u,v){this._outJobs=new Map;this._inJobs=new Map;this.worker=u;this.id=v;u.addEventListener("message",this._onMessage.bind(this));u.addEventListener("error",function(t){t.preventDefault();f.error(t)})}q.create=function(u){return d.createWorker().then(function(v){return new q(v,u)})};q.prototype.terminate=function(){this.worker.terminate()};q.prototype.open=function(u){var v=this,t=a.newJobId(),y=new n(function(C){v._outJobs["delete"](t);v._post({type:e,
jobId:t})});this._outJobs.set(t,y);this._post({type:c,jobId:t,modulePath:u});return y.promise};q.prototype._onMessage=function(u){if(u=a.receiveMessage(u))switch(u.type){case g:case p:this._onResponse(u);break;case e:this._onCancel(u);break;case h:this._onInvoke(u)}};q.prototype._onCancel=function(u){(u=this._inJobs.get(u.jobId))&&u.cancel()};q.prototype._onInvoke=function(u){var v=this,t=u.methodName,y=u.jobId;u=u.data;var C=this._inJobs,B=r.workerMessages[t];try{if("function"!==typeof B)throw new TypeError(t+
" is not a function");var F=B.call(null,u)}catch(x){this._post({type:p,jobId:y,error:a.toInvokeError(x)});return}b.isThenable(F)?(C.set(y,F),F.then(function(x){C["delete"](y);v._post({type:p,jobId:y},x)}).catch(function(x){C["delete"](y);x||(x={message:"Error encountered at method"+t});x.dojoType&&"cancel"===x.dojoType||v._post({type:p,jobId:y,error:a.toInvokeError(x)})})):this._post({type:p,jobId:y},F)};q.prototype._onResponse=function(u){var v=u.jobId,t=u.error;u=u.data;var y=this._outJobs.get(v);
y&&(this._outJobs["delete"](v),t?y.reject(l.fromJSON(JSON.parse(t))):y.resolve(u))};q.prototype._post=function(u,v,t){return a.postMessage(this.worker,u,v,t)};return q}()})},"esri/layers/vectorTiles/core/workers/workerFactory":function(){define("require exports ../tsSupport/assignHelper dojo/_base/kernel ../../config ../../request ../Logger ../promiseUtils ../sniff ../urlUtils ./loaderConfig ./utils ./WorkerFallback".split(" "),function(H,m,n,r,l,k,b,a,d,f,e,h,c){function g(B){return a.create(function(F){function x(A){if(A=
h.receiveMessage(A))switch(A.type){case C:A=B;var z=l.workers.loaderUrl||e.DEFAULT_LOADER_URL;if(null!=l["default"]){var G=n({},l);delete G["default"];G=JSON.parse(JSON.stringify(G))}else G=JSON.parse(JSON.stringify(l));var J=l.workers.loaderConfig;J=e.default({baseUrl:J.baseUrl,locale:r.locale,has:n({"config-deferredInstrumentation":0,"dojo-test-sniff":0,"esri-cors":1,"esri-secure-context":d("esri-secure-context"),"esri-workers-supports-transfer-arraybuffer":d("esri-workers-supports-transfer-arraybuffer"),
"events-keypress-typed":0,"host-webworker":1},J.has),map:n({},J.map),paths:n({},J.paths),packages:J.packages||[]});A.postMessage({type:y,configure:{esriConfig:G,loaderUrl:z,loaderConfig:J}});break;case t:B.removeEventListener("message",x),B.removeEventListener("error",w),F(B)}}function w(A){A.preventDefault();B.removeEventListener("message",x);B.removeEventListener("error",w);u.warn("Failed to create Worker. Fallback to execute module in main thread",A);B=new c;B.addEventListener("message",x);B.addEventListener("error",
w)}B.addEventListener("message",x);B.addEventListener("error",w)})}Object.defineProperty(m,"__esModule",{value:!0});var p=f.normalize(H.toUrl("./worker.js")),q=!f.hasSameOrigin(p,location.href),u=b.getLogger("esri.core.workers"),v=null,t=h.MessageType.CONFIGURED,y=h.MessageType.CONFIGURE,C=h.MessageType.HANDSHAKE;m.createWorker=function(){if(!d("esri-workers"))return g(new c);if(!q){var B=void 0;try{B=new Worker(p)}catch(F){u.warn("Failed to create Worker. Fallback to execute module in main thread",
event),B=new c}return g(B)}v||(v=k(p,{responseType:"text"}));return v.then(function(F){return new Worker(URL.createObjectURL(new Blob([F.data],{type:"text/javascript"})))}).catch(function(F){u.warn("Failed to create Worker. Fallback to execute module in main thread",F);return new c}).then(function(F){return g(F)})}})},"esri/layers/vectorTiles/core/tsSupport/assignHelper":function(){define([],function(){return Object.assign||function(H){for(var m,n=1,r=arguments.length;n<r;n++){m=arguments[n];for(var l in m)Object.prototype.hasOwnProperty.call(m,
l)&&(H[l]=m[l])}return H}})},"esri/layers/vectorTiles/config":function(){define(["require","exports","esri/config"],function(H,m,n){Object.defineProperty(n,"workers",{get:function(){return n.defaults.workers},set:function(r){return n.defaults.workers=r}});return n})},"esri/layers/vectorTiles/request":function(){define(["require","exports","esri/request","dojo/_base/lang","dojo/Deferred"],function(H,m,n,r,l){return function(k,b){k=r.mixin({},{url:k,failOk:!0},b);"array-buffer"===b.responseType?(k.handleAs=
"arraybuffer",delete k.responseType):b.responseType&&(k.handleAs=b.responseType,delete k.responseType);null!==b.query&&(k.content=k.query,delete k.query);if(b.hasOwnProperty("allowImageDataAccess")){var a={allowImageDataAccess:b.allowImageDataAccess};delete k.allowImageDataAccess}var d=new l(function(){f.isFulfilled()||f.cancel()});var f=n(k,a).then(function(e){d.resolve({data:e})}).catch(function(e){e&&null!=e.httpCode&&(e.details=e.details||{},e.details.httpStatus=e.httpCode);d.reject(e)});return d.promise}})},
"esri/layers/vectorTiles/core/sniff":function(){define(["require","exports","dojo/sniff","./global","../views/webgl/context-util"],function(H,m,n,r,l){function k(){var f={available:!1,version:0,majorPerformanceCaveat:!1,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1},e=document.createElement("canvas");if(!e)return f;var h=l.createContext(e,{failIfMajorPerformanceCaveat:!0},"webgl");!h&&(h=l.createContext(e,{},"webgl"))&&
(f.majorPerformanceCaveat=!0);if(!h)return f;e=h.getParameter(h.VERSION);if(!e)return f;if(e=e.match(/^WebGL\s+([\d.]*)/))f.version=parseFloat(e[1]),f.available=.94<=f.version,e=h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_FLOAT),f.supportsHighPrecisionFragment=e&&0<e.precision,f.supportsVertexShaderSamplers=0<h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f.supportsElementIndexUint=null!==h.getExtension("OES_element_index_uint"),f.supportsStandardDerivatives=null!==h.getExtension("OES_standard_derivatives");
return f}function b(){var f={available:!1,version:0},e=document.createElement("canvas");if(!e)return f;e=l.createContext(e,{},"webgl2");if(!e)return f;f.available=!0;e=e.getParameter(e.VERSION);if(!e)return f;if(e=e.match(/^WebGL\s+([\d.]*)/))f.version=parseFloat(e[1]);return f}(function(){var f=navigator.userAgent,e=f.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i);f=f.match(/iPhone/i);e&&n.add("esri-mobile",e);f&&n.add("esri-iPhone",f);n.add("esri-phonegap",!!r.cordova);
n.add("esri-cors",n("esri-phonegap")||"XMLHttpRequest"in r&&"withCredentials"in new XMLHttpRequest);n.add("esri-geolocation",function(){return!!navigator.geolocation});n.add("esri-canvas-svg-support",function(){return!(n("trident")||n("ie"))});n.add("esri-secure-context",function(){if("isSecureContext"in r)return r.isSecureContext;if(r.location&&r.location.origin)return 0===r.location.origin.indexOf("https:")});n.add("esri-wasm","WebAssembly"in r);n("host-webworker")||(n.add("esri-workers","Worker"in
r),n.add("esri-script-sandbox",function(){return"MessageChannel"in r&&"HTMLIFrameElement"in r&&"sandbox"in HTMLIFrameElement.prototype}),n.add("esri-url-encodes-apostrophe",function(){var h=r.document.createElement("a");h.href="?'";return-1<h.href.indexOf("?%27")}),a||(a=k()),n.add("esri-webgl",a.available),n.add("esri-webgl-high-precision-fragment",a.supportsHighPrecisionFragment),n.add("esri-webgl-vertex-shader-samplers",a.supportsVertexShaderSamplers),n.add("esri-webgl-element-index-uint",a.supportsElementIndexUint),
n.add("esri-webgl-standard-derivatives",a.supportsStandardDerivatives),n.add("esri-webgl-major-performance-caveat",a.majorPerformanceCaveat),n.add("esri-featurelayer-webgl-labeling",!0),d||(d=b()),n.add("esri-webgl2",d.available))})();var a=null,d=null;return n})},"esri/layers/vectorTiles/core/global":function(){define(["require","exports"],function(H,m){return function(){if("undefined"!==typeof global)return global;if("undefined"!==typeof window)return window;if("undefined"!==typeof self)return self}()})},
"esri/layers/vectorTiles/views/webgl/context-util":function(){define(["require","exports"],function(H,m){function n(b,a,d){void 0===a&&(a={});switch(d){case "webgl":var f=["webgl","experimental-webgl","webkit-3d","moz-webgl"];break;case "webgl2":f=["webgl2"];break;default:f=["webgl","experimental-webgl","webkit-3d","moz-webgl"]}d=null;for(var e=0;e<f.length;e++){var h=f[e];try{d=b.getContext(h,a)}catch(c){}if(d)break}return d}function r(b,a){(b=b.parentNode)&&(b.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
a+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}Object.defineProperty(m,"__esModule",{value:!0});m.createContextOrErrorHTML=function(b,a,d){void 0===a&&(a={});if(!window.WebGLRenderingContext)return r(b,l),null;a=n(b,a,d);return a?a:(r(b,k),null)};m.createContext=n;var l='This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e',k='It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'})},
"esri/layers/vectorTiles/core/urlUtils":function(){define(["require","exports","esri/urlUtils","dojo/_base/url"],function(H,m,n,r){function l(y){return n.normalize(y)}function k(y){return"data:"===y.slice(0,5)}function b(y){return a(y)||v.test(y)}function a(y){return y&&"/"===y[0]&&"/"===y[1]}function d(y){return n.urlToObject(y)}function f(y){if("string"===typeof y)return new r(h(y));y.scheme||(y.scheme=m.appUrl.scheme);return y}function e(y){if(k(y))return null;var C=y.indexOf("://");if(-1===C&&
a(y))C=2;else if(-1!==C)C+=3;else return null;C=y.indexOf("/",C);return-1===C?y:y.slice(0,C)}function h(y,C,B){void 0===C&&(C=m.appBaseUrl);if(a(y))return B&&B.preserveProtocolRelative?y:"http"===m.appUrl.scheme&&m.appUrl.authority===e(y).slice(2)?"http:"+y:"https:"+y;if(v.test(y))return y;B=g;if("/"===y[0]){var F=C.indexOf("//");F=C.indexOf("/",F+2);C=-1===F?C:C.slice(0,F)}return B(C,y)}function c(y,C,B){void 0===B&&(B=!1);y=f(y);C=f(C);return B||y.scheme===C.scheme?y.host.toLowerCase()===C.host.toLowerCase()&&
y.port===C.port:!1}function g(){for(var y=[],C=0;C<arguments.length;C++)y[C]=arguments[C];if(y&&y.length){C=[];if(b(y[0])){var B=y[0],F=B.indexOf("//");C.push(B.slice(0,F+1));u.test(y[0])&&(C[0]+="/");y[0]=B.slice(F+2)}else"/"===y[0][0]&&C.push("");y=y.reduce(function(x,w){return w?x.concat(w.split("/")):x},[]);for(B=0;B<y.length;B++)F=y[B],".."===F&&0<C.length?C.pop():!F||"."===F&&0!==C.length||C.push(F);return C.join("/")}}function p(y,C,B){if(!(C&&B&&y&&b(y)))return y;var F=y.indexOf("//"),x=y.indexOf("/",
F+2),w=y.indexOf(":",F+2);x=Math.min(0>x?y.length:x,0>w?y.length:w);if(y.slice(F+2,x).toLowerCase()!==C.toLowerCase())return y;C=y.slice(0,F+2);y=y.slice(x);return""+C+B+y}function q(y,C,B){void 0===C&&(C=m.appBaseUrl);if(!b(y))return y;var F=l(y),x=F.toLowerCase();C=l(C).toLowerCase().replace(/\/+$/,"");if((B=B?l(B).toLowerCase().replace(/\/+$/,""):null)&&0!==C.indexOf(B))return y;for(var w=function(G,J,L){L=G.indexOf(J,L);return-1===L?G.length:L},A=w(x,"/",x.indexOf("//")+2),z=-1;x.slice(0,A+1)===
C.slice(0,A)+"/";){z=A+1;if(A===x.length)break;A=w(x,"/",A+1)}if(-1===z||B&&z<B.length)return y;y=F.slice(z);F=C.slice(z-1).replace(/[^/]+/g,"").length;if(0<F)for(x=0;x<F;x++)y="../"+y;else y="./"+y;return y}Object.defineProperty(m,"__esModule",{value:!0});m.normalize=l;m.canUseXhr=function(y){return n.canUseXhr(y)};m.removeTrailingSlash=function(y){return y.replace(/\/+$/,"")};H=Function("return this")();m.appUrl=new r(H.location);m.appBaseUrl=function(){var y=m.appUrl.path;y=y.substring(0,y.lastIndexOf(y.split("/")[y.split("/").length-
1]));return m.appUrl.scheme+"://"+m.appUrl.host+(null!=m.appUrl.port?":"+m.appUrl.port:"")+y}();var u=/^\s*file:/i,v=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;m.isDataProtocol=k;m.isAbsolute=b;m.isProtocolRelative=a;m.urlToObject=d;m.getOrigin=e;m.makeAbsolute=h;m.hasSameOrigin=c;m.join=g;m.removeFile=function(y){var C=0;if(b(y)){var B=y.indexOf("//");-1!==B&&(C=B+2)}B=y.lastIndexOf("/");return B<C?y:y.slice(0,B+1)};m.addProxy=function(y){return n.addProxy(y)};m.makeData=function(y){return y.isBase64?"data:"+
y.mediaType+";base64,"+y.data:"data:"+y.mediaType+","+y.data};var t=/^data:(.*?)(;base64)?,(.*)$/;m.dataComponents=function(y){return(y=y.match(t))?{mediaType:y[1],isBase64:!!y[2],data:y[3]}:null};m.changeDomain=p;m.read=function(y,C){var B=C&&C.url&&C.url.path;y&&B&&(y=h(y,B,{preserveProtocolRelative:!0}));(C=C&&C.portal)&&!C.isPortal&&C.urlKey&&C.customBaseUrl?(B=C.urlKey+"."+C.customBaseUrl,C=c(m.appUrl,m.appUrl.scheme+"://"+B)?p(y,C.portalHostname,B):p(y,B,C.portalHostname)):C=y;return C};m.write=
function(y,C){if(!y)return y;!b(y)&&C&&C.blockedRelativeUrls&&C.blockedRelativeUrls.push(y);var B=h(y);if(C){var F=C.verifyItemRelativeUrls&&C.verifyItemRelativeUrls.rootPath||C.url&&C.url.path;F&&(B=q(B,F,F),B!==y&&C.verifyItemRelativeUrls&&C.verifyItemRelativeUrls.writtenUrls.push(B))}y=B;B=(C=C&&C.portal)&&!C.isPortal&&C.urlKey&&C.customBaseUrl?p(y,C.urlKey+"."+C.customBaseUrl,C.portalHostname):y;return B};m.makeRelative=q;m.removeQueryParameters=function(y){y=d(y);Object.keys(y.query||{});return y.path}})},
"esri/layers/vectorTiles/core/workers/loaderConfig":function(){define(["require","exports","../tsSupport/assignHelper","dojo/has","../urlUtils"],function(H,m,n,r,l){Object.defineProperty(m,"__esModule",{value:!0});m.DEFAULT_LOADER_URL=l.makeAbsolute(l.removeQueryParameters(H.toUrl("./worker-init.js")));m.DEFAULT_CONFIG={baseUrl:function(){var k=l.removeQueryParameters(H.toUrl("dojo/x.js"));return l.makeAbsolute(k.slice(0,k.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},
{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",main:"dist/cldr"},{name:"globalize",main:"dist/globalize"},{name:"maquette",main:"dist/maquette.umd"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental","cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}};m.default=
function(k){var b={async:k.async,isDebug:k.isDebug,locale:k.locale,baseUrl:k.baseUrl,has:n({},k.has),map:n({},k.map),packages:k.packages&&k.packages.concat()||[],paths:n({},k.paths)};k.hasOwnProperty("async")||(b.async=!0);k.hasOwnProperty("isDebug")||(b.isDebug=!1);k.baseUrl||(b.baseUrl=m.DEFAULT_CONFIG.baseUrl);m.DEFAULT_CONFIG.packages.forEach(function(e){a:{for(var h=b.packages,c=0;c<h.length;c++)if(h[c].name===e.name)break a;e=n({},e);c=l.removeQueryParameters(H.toUrl(e.name+"/x.js"));c=c.slice(0,
c.length-5);e.location=l.makeAbsolute(c);h.push(e)}});k=b.map=b.map||{};for(var a=0,d=Object.keys(m.DEFAULT_CONFIG.map);a<d.length;a++){var f=d[a];k[f]||(k[f]=m.DEFAULT_CONFIG.map[f])}return b}})},"esri/layers/vectorTiles/core/workers/WorkerFallback":function(){define(["require","exports","dojo/has","../global","./utils"],function(H,m,n,r,l){var k=function(){return function(){var d=this,f=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(e){d[e]=
function(){for(var h=[],c=0;c<arguments.length;c++)h[c]=arguments[c];return f[e].apply(f,h)}})}}(),b=r.MutationObserver||r.WebKitMutationObserver,a=function(){if(r.process&&r.process.nextTick)var d=function(h){r.process.nextTick(h)};else if(r.Promise)d=function(h){r.Promise.resolve().then(h)};else if(b){var f=[],e=document.createElement("div");(new b(function(){for(;0<f.length;)f.shift()()})).observe(e,{attributes:!0});d=function(h){f.push(h);e.setAttribute("queueStatus","1")}}return d}();return function(){function d(){this._dispatcher=
new k;this._isInitialized=!1;this._workerPostMessage({type:l.MessageType.HANDSHAKE})}d.prototype.terminate=function(){};Object.defineProperty(d.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(f){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=f)&&this.addEventListener("message",f)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(f){this._onerrorHandler&&
this.removeEventListener("error",this._onerrorHandler);(this._onerrorHandler=f)&&this.addEventListener("error",f)},enumerable:!0,configurable:!0});d.prototype.postMessage=function(f,e){var h=this;a(function(){h._workerMessageHandler(new MessageEvent("message",{data:f}))})};d.prototype.dispatchEvent=function(f){return this._dispatcher.dispatchEvent(f)};d.prototype.addEventListener=function(f,e,h){this._dispatcher.addEventListener(f,e,h)};d.prototype.removeEventListener=function(f,e,h){this._dispatcher.removeEventListener(f,
e,h)};d.prototype._workerPostMessage=function(f,e){var h=this;a(function(){h.dispatchEvent(new MessageEvent("message",{data:f}))})};d.prototype._workerMessageHandler=function(f){var e=this;if(f=l.receiveMessage(f)){var h=f.jobId;switch(f.type){case l.MessageType.CONFIGURE:this._isInitialized||this._workerPostMessage({type:l.MessageType.CONFIGURED});break;case l.MessageType.OPEN:f=f.modulePath,n("esri-webpack")?H(["esri/core/workers/RemoteClient","esri/views/vectorTiles/WorkerTileHandler","esri/views/2d/layers/features/Pipeline",
"esri/views/3d/layers/PointCloudWorker","esri/views/3d/layers/SceneLayerWorker","esri/layers/graphics/sources/support/CSVSourceWorker","esri/views/3d/webgl-engine/lib/edgeRendering/EdgeProcessingWorker",f],function(c,g,p,q,u,v,t,y){switch(y){case "esri/views/vectorTiles/WorkerTileHandler":break;case "esri/views/2d/layers/features/Pipeline":g=p;break;case "esri/views/3d/layers/PointCloudWorker":g=q;break;case "esri/views/3d/layers/SceneLayerWorker":g=u;break;case "esri/layers/graphics/sources/support/CSVSourceWorker":g=
v;break;case "esri/views/3d/webgl-engine/lib/edgeRendering/EdgeProcessingWorker":g=t;break;default:g=y}c=c.connect(g);e._workerPostMessage({type:l.MessageType.OPENED,jobId:h,data:c})}):H(["./RemoteClient",f],function(c,g){c=c.connect(g);e._workerPostMessage({type:l.MessageType.OPENED,jobId:h,data:c})})}}};return d}()})},"esri/layers/vectorTiles/core/requireUtils":function(){define(["require","exports","dojo/Deferred"],function(H,m,n){function r(l,k){if(Array.isArray(k)){var b=new n;l(k,function(){for(var a=
[],d=0;d<arguments.length;d++)a[d]=arguments[d];b.resolve(a)});return b.promise}return r(l,[k]).then(function(a){return a[0]})}Object.defineProperty(m,"__esModule",{value:!0});m.when=r;m.getAbsMid=function(l,k,b){return k.toAbsMid?k.toAbsMid(l):b.id.replace(/\/[^\/]*$/gi,"/")+l}})},"esri/layers/rasterLib/function/rasterFunctionHelper":function(){define(["dojo/_base/declare","dojo/_base/lang","./rasterFunctionRegistry"],function(H,m,n){return{create:function(r,l){if(r){var k=r.renderTexture,b=Object.keys(r);
if(r.read&&!l)return r;r.read&&l&&(r=r.toJson());-1<b.indexOf("name")&&b.indexOf(!1)?(r=m.mixin({},r),l=this._parseV2(r,l)):(r="esri.layers.RasterFunction"===r.declaredClass?r.toJson():m.mixin({},r),l=this._parseV1(r,l));l.branchCount=l.updateBranchStructure();l.renderTexture||(l.renderTexture=!!k);return l}},_parseV1:function(r,l){var k=r.rasterFunction,b=r.rasterFunctionArguments,a=r.renderTexture||r.rasterFunctionArguments.renderTexture||!1,d,f,e,h,c,g,p;(h=b.raster||b.Raster)&&h.rasterFunction&&
(d=this._parseV1(h,l));(h=b.raster2||b.Raster2)&&h.rasterFunction&&(f=this._parseV1(h,l));(h=b.rasters||b.Rasters)&&0<h.length&&(e=h.map(m.hitch(this,function(q){return q&&q.rasterFunction?this._parseV1(q,l):q})));(h=b.dem||b.DEM)&&(h.functionName||h.rasterFunction)&&(c=this._parseV1(h,l));(h=b.fillRaster||b.FillRaster)&&(h.functionName||h.rasterFunction)&&(g=this._parseV1(h,l));h=n.functions[k];if(!h)return console.error("Function is not currently supported: "+k),null;k=new h(b);k.variableName&&
(h=b[k.variableName])&&(h.functionName||h.rasterFunction)&&(p=this._parseV1(h,l));r.outputPixelType&&(k.pixelType=r.outputPixelType);"$$"===d?k.functionArguments.raster=l&&l.raster:null!=d?k.functionArguments.raster=d:k.functionArguments.raster||(k.functionArguments.raster=l&&l.raster);null!=f&&(k.functionArguments.raster2=f);null!=e&&(k.functionArguments.rasters=e.map(function(q){"$$"===q&&(q=l&&l.raster);return q}));null!=c&&(k.functionArguments.dem=c);null!=g&&(k.functionArguments.fillRaster=g);
null!=p&&(k.functionArguments[k.variableName]=p);k.renderTexture=a;return k},_parseV2:function(r,l){if(!r)return null;r=m.clone(r);this._bindV2Args(r,l);var k={};this._convertTov1(r,k);return this._parseV1(k,l)},_bindV2Args:function(r,l){(r||l)&&Object.keys(r).forEach(function(k){r[k]["function"]&&r[k].arguments?this._bindV2Args(r[k].arguments,l):null!=l[r[k].name]&&(r[k].value=l[r[k].name])}.bind(this))},_convertV2Types:function(r){if(!r)return null;"ArgumentArray"===r.type?r.elements&&"RasterStatistics"===
r.elements[0].type&&(r=r.elements):r instanceof Array&&0===r.length&&(r=null);return r},_convertTov1:function(r,l){if((r||l)&&r["function"]){var k=r["function"],b=r.arguments;l.rasterFunction=k.type.replace("Function","");l.outputPixelType="UNKNOWN"===k.pixelType?"Unknown":k.pixelType;l.rasterFunctionArguments={};var a;Object.keys(b).forEach(function(d){b[d]["function"]&&b[d].arguments?(l.rasterFunctionArguments[d]={},this._convertTov1(b[d],l.rasterFunctionArguments[d])):(a=b[d].value,l.rasterFunctionArguments[d]=
"object"!==typeof a||a.functionArguments?a:this._convertV2Types(a))}.bind(this))}}}})},"esri/layers/rasterLib/function/rasterFunctionRegistry":function(){define("dojo/_base/declare dojo/_base/lang ../../rasterLib/function/AspectFunction ../../rasterLib/function/BandArithmeticFunction ../../rasterLib/function/ColormapFunction ../../rasterLib/function/CompositeBandFunction ../../rasterLib/function/ContrastBrightnessFunction ../../rasterLib/function/ConvolutionFunction ../../rasterLib/function/ExtractBandFunction ../../rasterLib/function/HillshadeFunction ../../rasterLib/function/LocalFunction ../../rasterLib/function/MaskFunction ../../rasterLib/function/NDVIFunction ../../rasterLib/function/SlopeFunction ../../rasterLib/function/StretchFunction ../../rasterLib/function/RemapFunction ../../rasterLib/function/IdentityFunction ../../rasterLib/function/ResampleFunction".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v){return function(){function t(F){F.prototype.supportWebGL&&(C[F.prototype.functionName]=F);F.prototype.support2D&&(y[F.prototype.functionName]=F);B[F.prototype.functionName]=F}var y={},C={},B={};t(n);t(r);t(l);t(k);t(b);t(a);t(d);t(f);t(e);t(h);t(c);t(g);t(p);t(q);t(u);t(v);return{cpu:y,gpu:C,functions:B,register:t,getFunction:function(F){return B[F]},support:function(F,x){return!!("gpu"===x?C:"cpu"===x?y:B)[F]}}}()})},"esri/layers/rasterLib/function/AspectFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../../WKIDUnitConversion ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./surfaceUtils".split(" "),
function(H,m,n,r,l,k,b,a){return H([n,b],{declaredClass:"esri.layers.rasterLib.function.AspectFunction",functionName:"Aspect",supportWebGL:!0,support2D:!0,constructor:function(d){this.functionArguments=this.mixinIgnoreCase({raster:null},d)},bind:function(){var d=this.getSourceRasterInfo();if(!d.raster)return Error("The raster input to aspect function is invalid.");this.rasterInfo=m.mixin(d.raster,{bandCount:1,pixelType:this._calculatePixelType(this.pixelType,"F32"),statistics:[{min:0,max:360}],histograms:null});
this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(d){this._performance.start();d=a.aspect(d.raster);this._addPerformanceMetric(this._performance.elapsed());return d},readGL:function(d){this._performance.start();this._initializeProgram({fragment:k.aspect,fragmentName:"Aspect"});var f=this._setupTextureData(d.raster),e=this.bindFrameBuffer(),h=this.gl,c=h.drawingBufferWidth;h=h.drawingBufferHeight;var g=f.extent;
this._setUniforms({u_resolution:d&&d.raster&&d.raster.pixelBlock?[1/d.raster.pixelBlock.width,1/d.raster.pixelBlock.height]:[1/c,1/h],u_cellSize:[(g.xmax-g.xmin)/c,(g.ymax-g.ymin)/h]});this._bindTexture(f.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:f.extent,texture:e.texture}}})})},"esri/layers/rasterLib/function/surfaceUtils":function(){define(["dojo/_base/lang"],function(H){return{hillshade:function(m,n){if(null!==m&&null!==m.pixelBlock&&
null!==m.pixelBlock.pixels){var r=this._clonePixelBlock(m.pixelBlock),l=n.altitude,k=n.azimuth,b=n.zFactor,a=n.psPower,d=n.psFactor,f=n.hillshadeType,e=n.slopeType,h=n.isGCS;1===f&&(b*=2);n=r.width;var c=r.height,g=r.pixels[0],p=r.mask,q=new Uint8Array(n*c);p&&q.set(p);var u=new Uint8Array(n*c),v=(m.extent.xmax-m.extent.xmin)/n,t=(m.extent.ymax-m.extent.ymin)/c,y=b/(8*v),C=b/(8*t);.001<b&&h&&(y/=111E3,C/=111E3);3===e&&(h?(y=111E3*v,C=111E3*t,y=(b+Math.pow(y,a)*d)/(8*y),C=(b+Math.pow(C,a)*d)/(8*C)):
(y=(b+Math.pow(v,a)*d)/(8*v),C=(b+Math.pow(t,a)*d)/(8*t)));h=(90-l)*Math.PI/180;l=Math.cos(h);var B=(360-k+90)*Math.PI/180;k=Math.sin(h)*Math.cos(B);h=Math.sin(h)*Math.sin(B);b=[];a=[];d=[];v=[315,270,225,360,180,0];var F=[60,60,60,60,60,90];e=[3,5,3,2,1,4];var x=e.reduce(function(aa,ca){return aa+ca});t=e.map(function(aa){return aa/x});if(1===f){var w=v.length;for(e=0;e<w;e++)l=F[e],k=v[e],h=(90-l)*Math.PI/180,l=Math.cos(h),B=(360-k+90)*Math.PI/180,k=Math.sin(h)*Math.cos(B),h=Math.sin(h)*Math.sin(B),
b.push(l),a.push(k),d.push(h)}var A=0;for(e=1;e<c-1;e++)for(F=e*n,v=1;v<n-1;v++)if(p&&!p[F+v])u[F+v]=0;else{B=0;if(p&&(B=p[F-n+v-1]+p[F-n+v]+p[F-n+v+1]+p[F+v-1]+p[F+v+1]+p[F+n+v-1]+p[F+n+v]+p[F+n+v+1],7>B)){u[F+v]=0;q[F+v]=0;continue}if(7===B){var z=p[F-n+v-1]?g[F-n+v-1]:g[F+v];var G=p[F-n+v]?g[F-n+v]:g[F+v];var J=p[F-n+v+1]?g[F-n+v+1]:g[F+v];B=p[F+v-1]?g[F+v-1]:g[F+v];var L=p[F+v+1]?g[F+v+1]:g[F+v];A=p[F+n+v-1]?g[F+n+v-1]:g[F+v];var R=p[F+n+v]?g[F+n+v]:g[F+v];var T=p[F+n+v+1]?g[F+n+v+1]:g[F+v]}else z=
g[F-n+v-1],G=g[F-n+v],J=g[F-n+v+1],B=g[F+v-1],L=g[F+v+1],A=g[F+n+v-1],R=g[F+n+v],T=g[F+n+v+1];B=(J+L+L+T-(z+B+B+A))*y;G=(A+R+R+T-(z+G+G+J))*C;J=Math.sqrt(1+B*B+G*G);A=0;if(0===f)R=h*G-k*B,R=255*(l+R)/J,0>R&&(R=0),A=R;else if(1===f)for(z=0;z<w;z++)R=d[z]*G-a[z]*B,R=255*(b[z]+R)/J,0>R&&(R=0),A+=R*t[z];u[F+v]=A}for(e=0;e<c;e++)u[e*n]=u[e*n+1],u[(e+1)*n-1]=u[(e+1)*n-2];for(e=1;e<n-1;e++)u[e]=u[e+n],u[e+(c-1)*n]=u[e+(c-2)*n];r.pixelType="U8";r.pixels=[u];r.statistics=[{minValue:0,maxValue:255}];p&&(r.mask=
q);return{extent:m.extent,pixelBlock:r}}},slope:function(m,n){if(null!==m&&null!==m.pixelBlock&&null!==m.pixelBlock.pixels){var r=this._clonePixelBlock(m.pixelBlock),l=n.zFactor,k=n.psPower,b=n.psFactor,a=n.slopeType,d=n.isGCS;n=r.width;var f=r.height,e=r.pixels[0],h=r.mask,c=new Uint8Array(n*f);h&&c.set(h);var g=new Float32Array(n*f),p=(m.extent.xmax-m.extent.xmin)/n,q=(m.extent.ymax-m.extent.ymin)/f,u=l/(8*p),v=l/(8*q);1E-4>Math.abs(l-1)&&d&&(u/=111E3,v/=111E3);3===a&&(d?(u=111E3*p,v=111E3*q,u=
(l+Math.pow(u,k)*b)/(8*u),v=(l+Math.pow(v,k)*b)/(8*v)):(u=(l+Math.pow(p,k)*b)/(8*p),v=(l+Math.pow(q,k)*b)/(8*q)));for(l=1;l<f-1;l++)for(b=l*n,k=1;k<n-1;k++)if(h&&!h[b+k])g[b+k]=0;else{q=0;if(h&&(q=h[b-n+k-1]+h[b-n+k]+h[b-n+k+1]+h[b+k-1]+h[b+k+1]+h[b+n+k-1]+h[b+n+k]+h[b+n+k+1],7>q)){g[b+k]=0;c[b+k]=0;continue}if(7===q){q=h[b-n+k-1]?e[b-n+k-1]:e[b+k];d=h[b-n+k]?e[b-n+k]:e[b+k];p=h[b-n+k+1]?e[b-n+k+1]:e[b+k];var t=h[b+k-1]?e[b+k-1]:e[b+k];var y=h[b+k+1]?e[b+k+1]:e[b+k];var C=h[b+n+k-1]?e[b+n+k-1]:e[b+
k];var B=h[b+n+k]?e[b+n+k]:e[b+k];var F=h[b+n+k+1]?e[b+n+k+1]:e[b+k]}else q=e[b-n+k-1],d=e[b-n+k],p=e[b-n+k+1],t=e[b+k-1],y=e[b+k+1],C=e[b+n+k-1],B=e[b+n+k],F=e[b+n+k+1];t=(p+y+y+F-(q+t+t+C))*u;q=(C+B+B+F-(q+d+d+p))*v;q=Math.sqrt(t*t+q*q);g[b+k]=1===a||3===a?57.2957795*Math.atan(q):100*q}for(l=0;l<f;l++)g[l*n]=g[l*n+1],g[(l+1)*n-1]=g[(l+1)*n-2];for(l=1;l<n-1;l++)g[l]=g[l+n],g[l+(f-1)*n]=g[l+(f-2)*n];r.pixelType="F32";r.pixels=[g];r.statistics=[{minValue:0,maxValue:255}];h&&(r.mask=c);return{extent:m.extent,
pixelBlock:r}}},aspect:function(m){if(null!==m&&null!==m.pixelBlock&&null!==m.pixelBlock.pixels){var n=this._clonePixelBlock(m.pixelBlock),r=n.width,l=n.height,k=n.pixels[0],b=n.mask,a=new Uint8Array(r*l);b&&a.set(b);var d=new Float32Array(r*l),f=1/((m.extent.xmax-m.extent.xmin)/r),e=1/((m.extent.ymax-m.extent.ymin)/l),h,c;for(h=1;h<l-1;h++){var g=h*r;for(c=1;c<r-1;c++)if(b&&!b[g+c])d[g+c]=0;else{var p=0;if(b&&(p=b[g-r+c-1]+b[g-r+c]+b[g-r+c+1]+b[g+c-1]+b[g+c+1]+b[g+r+c-1]+b[g+r+c]+b[g+r+c+1],7>p)){d[g+
c]=0;a[g+c]=0;continue}if(7===p){p=b[g-r+c-1]?k[g-r+c-1]:k[g+c];var q=b[g-r+c]?k[g-r+c]:k[g+c];var u=b[g-r+c+1]?k[g-r+c+1]:k[g+c];var v=b[g+c-1]?k[g+c-1]:k[g+c];var t=b[g+c+1]?k[g+c+1]:k[g+c];var y=b[g+r+c-1]?k[g+r+c-1]:k[g+c];var C=b[g+r+c]?k[g+r+c]:k[g+c];var B=b[g+r+c+1]?k[g+r+c+1]:k[g+c]}else p=k[g-r+c-1],q=k[g-r+c],u=k[g-r+c+1],v=k[g+c-1],t=k[g+c+1],y=k[g+r+c-1],C=k[g+r+c],B=k[g+r+c+1];v=(u+t+t+B-(p+v+v+y))*f;p=(y+C+C+B-(p+q+q+u))*e;0===v&&0===p?p=-1:(p=90-57.29578*Math.atan2(p,-v),0>p&&(p+=
360),360===p?p=0:360<p&&(p%=360));d[g+c]=p}}for(h=0;h<l;h++)d[h*r]=d[h*r+1],d[(h+1)*r-1]=d[(h+1)*r-2];for(h=1;h<r-1;h++)d[h]=d[h+r],d[h+(l-1)*r]=d[h+(l-2)*r];n.pixelType="F32";n.pixels=[d];n.statistics={minValue:0,maxValue:360};b&&(n.mask=a);return{extent:m.extent,pixelBlock:n}}},_clonePixelBlock:function(m){return m.clone?m.clone():H.clone(m)}}})},"esri/layers/rasterLib/function/BandArithmeticFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./rasterIndex".split(" "),
function(H,m,n,r,l,k,b){return H([n,k],{declaredClass:"esri.layers.rasterLib.function.BandArithmeticFunction",functionName:"BandArithmetic",supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({method:1,bandIndexes:"",raster:null},a)},bind:function(a){a=this.getSourceRasterInfo(a);if(!a.raster)return Error("The raster input to band arithmetic function is invalid.");this.rasterInfo=m.mixin(a.raster,{bandCount:8===this.functionArguments.method?a.raster.bandCount:
1,pixelType:this._calculatePixelType(this.pixelType,"F32"),statistics:null,histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(a){this._performance.start();a=a.raster;var d=b.calculate(a.pixelBlock,{bandIndexes:this.functionArguments.bandIndexes,method:this.functionArguments.method});this._addPerformanceMetric(this._performance.elapsed());"Unknown"!==this.pixelType&&(d.pixelType=this.pixelType);
return{extent:a.extent,pixelBlock:d}},readGL:function(a){this._performance.start();this._initializeProgram({fragment:l.bandArithmetic,fragmentName:"bandArithmetic"});var d=this.functionArguments.bandIndexes.trim().split(" ").map(function(c){return parseInt(c,10)});this._infraredBandID=d[0]-1;this._visibleBandID=d[1]-1;this._alterBand=2<Math.max(this._infraredBandID,this._visibleBandID)?!0:!1;a=this._setupTextureData(a.raster,this._alterBand&&2==d.length?{bandIDs:[this._infraredBandID,this._visibleBandID,
this._infraredBandID]}:{bandIDs:[d[0]-1,d[1]-1,d[2]-1]});var f=this.bindFrameBuffer(),e=this.functionArguments.method,h=2<d.length?d.slice(2):null;this._alterBand?this._setUniforms({u_method:e,u_bandId_nir:0,u_bandId_red:1,u_constants:h}):this._setUniforms({u_method:e,u_bandId_nir:d[0]-1,u_bandId_red:d[1]-1,u_constants:h});this._bindTexture(a.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:a.extent,texture:f.texture}}})})},"esri/layers/rasterLib/function/rasterIndex":function(){define(["dojo/_base/lang"],
function(H){return{calculate:function(m,n){if(m&&m.pixels&&m.pixels.length){var r=n&&n.bandIndexes;n=n&&n.method;var l=r.trim().split(" ").map(function(a){return parseInt(a,10)}).filter(function(a){return null!=a});m=this._clonePixelBlock(m);var k=m.pixels,b=m.mask;switch(n){case 1:k=this._calculateNDVI(b,k[l[0]-1],k[l[1]-1]);break;case 2:k=this._calculateSAVI(b,k[l[0]-1],k[l[1]-1],l[2]);break;case 3:k=this._calculateTSAVI(b,k[l[0]-1],k[l[1]-1],l[2],l[3],l[4]);break;case 4:k=this._calculateMSAVI(b,
k[l[0]-1],k[l[1]-1]);break;case 5:k=this._calculateGEMI(b,k[l[0]-1],k[l[1]-1]);break;case 6:k=this._calculatePVI(b,k[l[0]-1],k[l[1]-1],l[2],l[3]);break;case 7:k=this._calculateGVITM(b,k[l[0]-1],k[l[1]-1],k[l[2]-1],k[l[3]-1],k[l[4]-1],k[l[5]-1]);break;case 8:k=this._calculateSultan(b,k[l[0]-1],k[l[1]-1],k[l[2]-1],k[l[3]-1],k[l[4]-1],k[l[5]-1]);break;case 9:k=this._calculateVARI(b,k[l[0]-1],k[l[1]-1],k[l[2]-1]);break;case 0:k=this._calculateUserDefined(b,k,r)}m.pixels=k;m.pixelType="F32";m.calculateStatistics();
return m}},_clonePixelBlock:function(m){return m.clone?m.clone():H.clone(m)},_parseUserDefined:function(m,n){m=m.replace(" ","");0===m.indexOf("-")&&(m="0"+m);0===m.indexOf("+")&&(m=m.slice(1,m.length));m=m.split("");var r=[],l=[],k="+-*/()".split(""),b,a="";for(b=0;b<m.length;b++){var d=m[b];k.some(function(f){return f===d})?(""!==a&&l.push(parseFloat(a)),r.push(d),a=""):"b"===d.toLowerCase()?(b++,a=d.concat(m[b]),l.push(n[parseInt(a[1],10)-1]),a=""):(a=a.concat(d),b===m.length-1&&l.push(parseFloat(a)))}return{ops:r,
nums:l}},_op:function(m,n,r,l){if(r.constructor===Number&&l.constructor===Number)return r+l;var k;if(r.constructor===Number){var b=l.length;var a=r;r=new Float32Array(b);for(k=0;k<b;k++)r[k]=a}else if(b=r.length,l.constructor===Number)for(a=l,l=new Float32Array(b),k=0;k<b;k++)l[k]=a;a=new Float32Array(b);if(null==m)if("+"===n)for(k=0;k<b;k++)a[k]=r[k]+l[k];else if("-"===n)for(k=0;k<b;k++)a[k]=r[k]-l[k];else if("*"===n)for(k=0;k<b;k++)a[k]=r[k]*l[k];else{if("/"===n)for(k=0;k<b;k++)a[k]=r[k]/l[k]}else if("+"===
n)for(k=0;k<b;k++)m[k]&&(a[k]=r[k]+l[k]);else if("-"===n)for(k=0;k<b;k++)m[k]&&(a[k]=r[k]-l[k]);else if("*"===n)for(k=0;k<b;k++)m[k]&&(a[k]=r[k]*l[k]);else if("/"===n)for(k=0;k<b;k++)m[k]&&(a[k]=r[k]/l[k]);return a},_shrinkOp:function(m,n){m.splice(n,1);var r=n=0,l=0;do{for(n=l=r=0;n<m.length;n++)if("("===m[n])r=n;else if(")"===m[n]){l=n;break}l===r+1&&m.splice(r,2)}while(l===r+1);return m},_getPriorityOpIndex:function(m,n){if(1===m.length)return{opIndex:0,numIndex:0};var r=n=0,l=0,k=-1,b=0;for(n=
0;n<m.length;n++)if("("===m[n])r=n;else if(")"===m[n]){l=n;break}var a=0===l?m:m.slice(r+1,l);for(n=0;n<a.length;n++)if("*"===a[n]||"/"===a[n]){k=n;break}if(!(-1<k))for(n=0;n<a.length;n++)if("+"===a[n]||"-"===a[n]){k=n;break}0<l&&(k+=r+1);for(n=0;n<k;n++)"("===m[n]&&b++;return{opIndex:k,numIndex:k-b}},_calculateUserDefined:function(m,n,r){n=this._parseUserDefined(r,n);r=n.ops;for(var l=n.nums,k,b,a;0<r.length&&(n=this._getPriorityOpIndex(r,l),k=r[n.opIndex],b=l[n.numIndex],a=l[n.numIndex+1],k=this._op(m,
k,b,a),1!==r.length);)r=this._shrinkOp(r,n.opIndex),l.splice(n.numIndex,2,k);return[k]},_calculateNDVI:function(m,n,r){var l=r.length,k=new Float32Array(l),b;if(null==m)for(b=0;b<l;b++){var a=r[b];var d=n[b];k[b]=(d-a)/(d+a)}else for(b=0;b<l;b++)m[b]&&(a=r[b],d=n[b],k[b]=(d-a)/(d+a));return[k]},_calculateSAVI:function(m,n,r,l){var k=r.length,b=new Float32Array(k),a;if(null==m)for(a=0;a<k;a++){var d=r[a];var f=n[a];b[a]=(f-d)/(f+d+l)*(1+l)}else for(a=0;a<k;a++)m[a]&&(d=r[a],f=n[a],b[a]=(f-d)/(f+d+
l)*(1+l));return[b]},_calculateTSAVI:function(m,n,r,l,k,b){var a=r.length,d=new Float32Array(a),f=-k*l+b*(1+l*l);if(null==m)for(b=0;b<a;b++){var e=r[b];var h=n[b];d[b]=l*(h-l*e-k)/(k*h+e+f)}else for(b=0;b<a;b++)m[b]&&(e=r[b],h=n[b],d[b]=l*(h-l*e-k)/(k*h+e+f));return[d]},_calculateMSAVI:function(m,n,r){var l=r.length,k=new Float32Array(l),b;if(null==m)for(b=0;b<l;b++){var a=r[b];var d=n[b];k[b]=.5*(2*(d+1)-Math.sqrt(Math.pow(2*d+1,2)-8*(d-a)))}else for(b=0;b<l;b++)m[b]&&(k[b]=.5*(2*(d+1)-Math.sqrt(Math.pow(2*
d+1,2)-8*(d-a))));return[k]},_calculateGEMI:function(m,n,r){var l=r.length,k=new Float32Array(l),b;if(null==m)for(b=0;b<l;b++){var a=r[b];var d=n[b];d=(2*(d*d-a*a)+1.5*d+.5*a)/(d+a+.5);k[b]=d*(1-.25*d)-(a-.125)/(1-a)}else for(b=0;b<l;b++)m[b]&&(a=r[b],d=n[b],d=(2*(d*d-a*a)+1.5*d+.5*a)/(d+a+.5),k[b]=d*(1-.25*d)-(a-.125)/(1-a));return[k]},_calculatePVI:function(m,n,r,l,k){var b=r.length,a=new Float32Array(b),d,f=Math.sqrt(1+l*l);if(null==m)for(d=0;d<b;d++){var e=r[d];var h=n[d];a[d]=(h-l*e-k)/f}else for(d=
0;d<b;d++)m[d]&&(e=r[d],h=n[d],a[d]=(h-l*e-k)/f);return[a]},_calculateGVITM:function(m,n,r,l,k,b,a){var d=n.length,f=new Float32Array(d),e;if(null==m)for(e=0;e<d;e++)f[e]=-.2848*n[e]-.2435*r[e]-.5436*l[e]+.7243*k[e]+.084*b[e]-1.18*a[e];else for(e=0;e<d;e++)m[e]&&(f[e]=-.2848*n[e]-.2435*r[e]-.5436*l[e]+.7243*k[e]+.084*b[e]-1.18*a[e]);return[f]},_calculateSultan:function(m,n,r,l,k,b,a){r=n.length;var d=new Float32Array(r),f=new Float32Array(r),e=new Float32Array(r),h;if(null==m)for(h=0;h<r;h++)d[h]=
b[h]/a[h]*100,f[h]=b[h]/n[h]*100,e[h]=l[h]/k[h]*(b[h]/k[h])*100;else for(h=0;h<r;h++)m[h]&&(d[h]=b[h]/a[h]*100,f[h]=b[h]/n[h]*100,e[h]=l[h]/k[h]*(b[h]/k[h])*100);return[d,f,e]},_calculateVARI:function(m,n,r,l){var k=n.length,b=new Float32Array(k),a;if(null==m)for(a=0;a<k;a++){var d=n[a];var f=r[a];var e=l[a];b[a]=(f-d)/(f+d-e)}else for(a=0;a<k;a++)if(m[a])for(a=0;a<k;a++)d=n[a],f=r[a],e=l[a],b[a]=(f-d)/(f+d-e);return[b]}}})},"esri/layers/rasterLib/function/ColormapFunction":function(){define("dojo/_base/declare dojo/_base/lang ../../../renderers/colorRampGenerator ./RasterFunctionX ./pixelShaders ./RasterFunctionWebGLMixin ./rasterUtils".split(" "),
function(H,m,n,r,l,k,b){return H([r,k],{declaredClass:"esri.layers.rasterLib.function.ColormapFunction",functionName:"Colormap",pixelType:"U8",renderTexture:!1,supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({colormap:null,colorRampName:null,colorRamp:null,colorMapName:null,raster:null},a);this.invert=a&&a.invert;a=a.colormap||a.Colormap;if(a){if(a.features||a[0].attributes){a=a.features||a;var d=Object.keys(a[0].attributes);var f=d.filter(function(q){return"alpha"===
q.toLowerCase()})[0];var e=d.filter(function(q){return"value"===q.toLowerCase()})[0];var h=d.filter(function(q){return"red"===q.toLowerCase()})[0];var c=d.filter(function(q){return"green"===q.toLowerCase()})[0];var g=d.filter(function(q){return"blue"===q.toLowerCase()})[0];if(!(e&&h&&c&&g))throw"invalid colormap";a=a.map(function(q){return f?[q.attributes[e],q.attributes[h],q.attributes[c],q.attributes[g],q.attributes[f]]:[q.attributes[e],q.attributes[h],q.attributes[c],q.attributes[g]]});var p=1.1>
Math.max.apply(null,a.map(function(q){return q[1]}));d=f&&1.1>Math.max.apply(null,a.map(function(q){return q[4]}));if(p)for(p=0;p<a.length;p++)a[p][1]=Math.round(255*a[p][1]),a[p][2]=Math.round(255*a[p][2]),a[p][3]=Math.round(255*a[p][3]),d&&(a[p][4]=Math.round(255*a[p][4]))}this.functionArguments.colormap=this._sortClr(a)}this._initialize()},bind:function(a){this._initialize();a=this.getSourceRasterInfo(a);if(!a.raster||"F32"===a.raster.pixelType)return Error("The raster input to colormap function is invalid. It must be integer type.");
this.rasterInfo=m.mixin(a.raster,{bandCount:3,pixelType:this._calculatePixelType(this.pixelType,"U8"),statistics:null,histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Processed";return!0},read2D:function(a){return this._colorize(a.raster)},readGL:function(a){return this._colorizeGL(a.raster)},_colorize:function(a){this._performance.start();var d=b.colorize(a.pixelBlock,{indexedColormap:this._indexedColormap,indexedColormapOffset:this._indexedColormapOffset,
indexed2DColormap:this._indexed2DColormap,alphaSpecified:this._alphaSpecified});this._addPerformanceMetric(this._performance.elapsed());return{extent:a.extent,pixelBlock:d}},_binarySearchClr:function(a,d){for(var f=0,e=a.length-1,h=0,c=0;f<e;)if(h=Math.floor((f+e)/2),c=a[h],c[0]<d)f=h;else if(c[0]>d)e=h;else return c.slice(1);return null},_sortClr:function(a,d){var f,e=[];for(f=0;f<a.length;f++)e.push(a[f]);for(f=0;f<e.length-1;f++){var h=e[f];for(a=f+1;a<e.length;a++)h[0]>e[a][0]&&(h=e[a],e[a]=e[f],
e[f]=h)}if(d)for(f=0;f<e.length/2;f++)h=e[f],e[e.length-1-f]=e[f],e[f]=h;return e},_invertColorRamp:function(a){if(!a)return a;var d={type:a.type};"random"===a.type?d=a:"multipart"===a.type?d.colorRamps=a.colorRamps.map(function(f){return{fromColor:f.toColor,toColor:f.fromColor}}).reverse():(d.fromColor=a.toColor,d.toColor=a.fromColor);return d},_initialize:function(){this._indexedColormapOffset=0;if(this.functionArguments.colormap){var a=b.buildIndexedColormap(this.functionArguments.colormap);this._alphaSpecified=
a&&a.alphaSpecified;this._indexedColormap=a&&a.indexedColormap;this._indexedColormapOffset=a&&a.offset;this._indexedColormap||(this._indexed2DColormap=this._getIndexed2DColormap())}else this.functionArguments.colorRamp?this._indexedColormap="multipart"===this.functionArguments.colorRamp.type?this.invert?n.createMultiPartColorRamp(this._invertColorRamp(this.functionArguments.colorRamp)):n.createMultiPartColorRamp(this.functionArguments.colorRamp):this.invert?n.createAlgorithmicColorRamp(this._invertColorRamp(this.functionArguments.colorRamp)):
n.createAlgorithmicColorRamp(this.functionArguments.colorRamp):this.functionArguments.colormapName&&"random"===this.functionArguments.colormapName.toLowerCase()&&(this._indexedColormap=n.createRandomColorRamp())},_getIndexed2DColormap:function(){var a=this.functionArguments.colormap;if(!a)return null;var d=0;0>a[0][0]&&(d=a[0][0]);var f=[],e=5===a[0].length,h;for(h=0;h<a.length;h++)f[a[h][0]-d]=e?a[h].slice(1):a[h].slice(1).concat([255]);return f},_colorizeGL:function(a){this._performance.start();
this._initializeProgram({fragment:l.colormap,fragmentName:"Colormap"});var d=this._indexedColormap,f=this._indexedColormapOffset;this._clrTexture||(this._clrTexture=this._setupColormapTexture(d));var e=this._clrTexture,h=this.bindFrameBuffer();a=this._setupTextureData(a);this._setUniforms({u_indexedColormapOffset:f,u_indexedColormapMaxIndex:d.length/4-1});this._bindTexture(e,"u_image1");this._bindTexture(a.texture,"u_image");this._drawGL();return{extent:a.extent,texture:h.texture}},_setupColormapTexture:function(a){var d=
this._createTexture(),f=this.gl,e=a.length/4,h=new Float32Array(a.length),c,g=this.renderTexture?255:1;for(c=0;c<a.length;c++)h[c]=a[c]/g;f.getExtension("OES_texture_float");f.texImage2D(f.TEXTURE_2D,0,f.RGBA,e,1,0,f.RGBA,f.FLOAT,h);return d}})})},"esri/renderers/colorRampGenerator":function(){define(["dojo/_base/declare","dojo/_base/lang","../renderers/colorUtils"],function(H,m,n){return{createAlgorithmicColorRamp:function(r,l){if(!r)return null;var k=r.fromColor,b=r.toColor;if(!k||!b)return null;
void 0===k.r&&3<=k.length&&(k={r:k[0],g:k[1],b:k[2]});void 0===b.r&&3<=b.length&&(b={r:b[0],g:b[1],b:b[2]});var a=r.size||256;r=r.algorithm||"cie-lab";if(1===a)var d=[k.r,k.g,k.b,255];else if(2===a)d=[k.r,k.g,k.b,255,b.r,b.g,k.b,255];else if(-1<r.toLowerCase().indexOf("hsv")){d=n.toHSV(k);b=n.toHSV(b);a=a||256;var f=0===d.s,e=0===b.s;k=d.h;r=b.h;f&&!e?k=d.h=r:e&&!f&&(r=b.h=k);f=Math.abs(r-k);180>f?r=(r-k)/(a-1):(f=360-f,r=k>r?f/(a-1):-f/(a-1));f=(b.s-d.s)/(a-1);e=(b.v-d.v)/(a-1);var h=d.s;d=d.v;var c,
g=new Uint8Array(4*a);for(c=0;c<a-1;c++){var p=n.toRGB({h:k,s:h,v:d});g[4*c]=p.r;g[4*c+1]=p.g;g[4*c+2]=p.b;g[4*c+3]=255;k+=r;h+=f;d+=e;360<k?k-=360:0>k&&(k+=360)}p=n.toRGB(b);g[4*(a-1)]=p.r;g[4*(a-1)+1]=p.g;g[4*(a-1)+2]=p.b;g[4*(a-1)+3]=255;d=g}else if(-1<r.toLowerCase().indexOf("lch")){h=n.toLCH(k);b=n.toLCH(b);a=a||256;d=(b.l-h.l)/(a-1);k=(b.c-h.c)/(a-1);r=(b.h-h.h)/(a-1);f=h.l;e=h.c;h=h.h;g=new Uint8Array(4*a);for(c=0;c<a-1;c++)p=n.toRGB({l:f,c:e,h:h}),g[4*c]=p.r,g[4*c+1]=p.g,g[4*c+2]=p.b,g[4*
c+3]=255,f+=d,e+=k,h+=r;p=n.toRGB(b);g[4*(a-1)]=p.r;g[4*(a-1)+1]=p.g;g[4*(a-1)+2]=p.b;g[4*(a-1)+3]=255;d=g}else if(-1<r.toLowerCase().indexOf("lab")){h=n.toLAB(k);b=n.toLAB(b);a=a||256;d=(b.l-h.l)/(a-1);k=(b.a-h.a)/(a-1);r=(b.b-h.b)/(a-1);f=h.l;e=h.a;h=h.b;g=new Uint8Array(4*a);for(c=0;c<a-1;c++)p=n.toRGB({l:f,a:e,b:h}),g[4*c]=p.r,g[4*c+1]=p.g,g[4*c+2]=p.b,g[4*c+3]=255,f+=d,e+=k,h+=r;p=n.toRGB(b);g[4*(a-1)]=p.r;g[4*(a-1)+1]=p.g;g[4*(a-1)+2]=p.b;g[4*(a-1)+3]=255;d=g}if(l&&!1===l.flattened)for(l=d,
d=[],b=0;b<d/4;b++)d[b]=l.slice(4*b,4*b+4);return d},createMultiPartColorRamp:function(r,l){if(!r)return null;l=l&&m.clone(l)||{flattened:!0};var k=r.colorRamps;if(!k||0===k.length)return null;var b=r.size||256;r=Math.max(Math.floor(b/k.length),1);var a=Math.max(r,b-(k.length-1)*r),d=!1!==l.flattened;l.flattened=!0;b=(k.length-1)*r+a;var f=new Uint8Array(4*b);for(b=0;b<k.length;b++){var e={fromColor:k[b].fromColor,toColor:k[b].toColor,size:b===k.length-1?a:r};f instanceof Array?f.concat(this.createAlgorithmicColorRamp(e,
l)):f.set(this.createAlgorithmicColorRamp(e,l),r*b*4)}if(!d)for(l=f,f=[],b=0;b<f/4;b++)f[b]=l.slice(4*b,4*b+4);return f},createRandomColorRamp:function(r){r=r||{};var l=r.size||256,k=!1===r.flattened;var b=k?new Uint8Array(4*l):[];for(r=0;r<l;r++)k?(b[4*r]=Math.round(255*Math.random()),b[4*r+1]=Math.round(255*Math.random()),b[4*r+2]=Math.round(255*Math.random()),b[4*r+3]=255):b[r]=[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()),255];return b}}})},"esri/layers/rasterLib/function/rasterUtils":function(){define(["dojo/_base/lang"],
function(H){return{mask:function(m,n){if(m&&m.pixels&&m.pixels.length){m=this._clonePixelBlock(m);var r=n.includedRanges,l=n.noDataInterpretation;n=n.noDataValues;if(null===r&&null===n)return m;var k=m.pixels,b=m.mask,a=m.width*m.height,d=k.length,f;if(null!==n&&n.length!==d)throw"expect "+d+" elements in noDataValues";if(null!==r&&r.length!==2*d)throw"expect "+2*d+" elements in IncludeRanges";if(null==b){b=new Uint8Array(a);for(f=0;f<a;f++)b[f]=1;m.mask=b}if(0===l)for(l=0;l<d;l++){var e=k[l];var h=
null===r?null:r[2*l];var c=null===r?null:r[2*l+1];var g=null===n?null:parseFloat(n[l]);if(null===h||null===c)for(f=0;f<a;f++){if(b[f]){var p=e[f];p===g&&(b[f]=0)}}else if(null===g)for(f=0;f<a;f++)b[f]&&(p=e[f],p<h||p>c)&&(b[f]=0);else for(f=0;f<a;f++)b[f]&&(p=e[f],p<h||p>c||p===g)&&(b[f]=0)}else{var q=new Uint8Array(a);for(f=0;f<a;f++)q[f]=b[f];for(l=0;l<d;l++)if(e=k[l],h=null===r?null:r[2*l],c=null===r?null:r[2*l+1],g=null===n?null:parseFloat(n[l]),null===h||null===c)for(f=0;f<a;f++)q[f]&&(p=e[f],
p!==g&&(q=0));else if(null===g)for(f=0;f<a;f++)q[f]&&(p=e[f],p<=h&&p<=c&&(q=0));else for(f=0;f<a;f++)q[f]&&(p=e[f],p<=h&&p<=c&&p!==g&&(q=0));for(f=0;f<a;f++)b[f]&&q[f]&&(b[f]=0)}return m}},calculateStatisticsHistograms:function(m,n){m=this._clonePixelBlock(m);n=m.pixelType;var r=m.pixels,l=m.mask,k=r.length,b,a,d=[],f;for(b=0;b<k;b++){var e={min:-.5,max:255.5,size:256,counts:new Uint32Array(256)};var h=e.counts;var c=r[b];if("U8"===n)if(l)for(a=0;a<m.width*m.height;a++)l[a]&&h[c[a]]++;else for(a=
0;a<m.width*m.height;a++)h[c[a]]++;else{var g=m.statistics[b].minValue;var p=m.statistics[b].maxValue;e.min=g;e.max=p;p=(p-g)/256;var q=new Uint32Array(257);if(l)for(a=0;a<m.width*m.height;a++)l[a]&&q[Math.floor((c[a]-g)/p)]++;else for(a=0;a<m.width*m.height;a++)q[Math.floor((c[a]-g)/p)]++;for(a=0;255>a;a++)h[a]=q[a];h[255]=q[255]+q[256]}d.push(e);g=m.statistics[b].minValue;p=m.statistics[b].maxValue;for(a=q=f=c=0;a<e.size;a++)c+=h[a],f+=a*h[a];f/=c;for(a=0;a<e.size;a++)q+=h[a]*Math.pow(a-f,2);h=
Math.sqrt(q/(c-1));a=(f+.5)*(e.max-e.min)/e.size+e.min;e=h*(e.max-e.min)/e.size;m.statistics[b]={min:g,minValue:g,max:p,maxValue:p,mean:a,stddev:e}}m.histograms=d;return m},buildIndexedColormap:function(m,n){if(!m)return null;var r=0;0>m[0][0]&&(r=m[0][0]);var l=Math.max(256,m[m.length-1][0]-r);if(65536<l)return null;var k=new Uint8Array(4*l),b=[],a=0,d=5===m[0].length;if(n)for(b=m[a],n=b[0]-r;n<l;n++)k[4*n]=b[1],k[4*n+1]=b[2],k[4*n+2]=b[3],k[4*n+3]=d?b[4]:255,n===b[0]-r&&(b=a===m.length-1?b:m[++a]);
else for(n=0;n<m.length;n++)b=m[n],a=4*(b[0]-r),k[a]=b[1],k[a+1]=b[2],k[a+2]=b[3],k[a+3]=d?b[4]:255;return{indexedColormap:k,offset:r,alphaSpecified:d}},colorize:function(m,n){if(null!==m&&null!==m.pixels){m=this._clonePixelBlock(m);var r=m.pixels,l=m.width*m.height,k=m.mask,b=n.indexedColormap,a=n.indexedColormapOffset,d=b&&b.length-1,f=n.indexed2DColormap;n=n.alphaSpecified;if(3<=r.length)throw"colormap only works on single band image";var e=r[0],h=new Uint8Array(e.length),c=new Uint8Array(e.length),
g=new Uint8Array(e.length),p=0;if(b)if(k)for(r=0;r<l;r++)k[r]&&(p=4*(e[r]-a),p<a||p>d?k[r]=0:(h[r]=b[p],c[r]=b[p+1],g[r]=b[p+2],k[r]=b[p+3]));else{k=new Uint8Array(l);for(r=0;r<l;r++)p=4*(e[r]-a),p<a||p>d?k[r]=0:(h[r]=b[p],c[r]=b[p+1],g[r]=b[p+2],k[r]=b[p+3]);m.mask=k}else if(k)for(r=0;r<l;r++)k[r]&&(b=f[e[r]],h[r]=b[0],c[r]=b[1],g[r]=b[2],k[r]=b[3]);else{k=new Uint8Array(l);for(r=0;r<l;r++)b=f[e[r]],h[r]=b[0],c[r]=b[1],g[r]=b[2],k[r]=b[3];m.mask=k}m.pixels=[h,c,g];m.statistics=null;m.pixelType="U8";
m.maskIsAlpha=n;return m}},convolute:function(m,n){m=this._clonePixelBlock(m);var r=m.pixels,l=m.width,k=m.height,b=l*k,a=r.length,d,f,e,h,c=[],g=[],p=n.normalizedKernel,q=n.kernelRows,u=n.kernelCols;for(n=0;n<a;n++){var v=r[n];var t=new Float32Array(b);t.set(v);for(e=1;e<k-1;e++){var y=e*l;for(h=1;h<l-1;h++){for(d=g=0;d<q;d++)for(f=0;f<u;f++)g+=v[y+h+(d-1)*l+f-1]*p[d*u+f];t[y+h]=g}}c.push(t)}m.pixels=c;return m},contrastBrightnessStretch:function(m,n){if(null!==m&&null!==m.pixels){m=this._clonePixelBlock(m);
var r=m.pixels,l=m.mask,k=m.width*m.height,b=r.length;var a=n&&n.contrastOffset;n=n&&n.brightnessOffset;if("U8"!==m.pixelType)throw"the contrast and brightness function only supports 8 bit unsigned integer data";var d=this._createContrastBrightnessLUT(a,n);if(null==l)for(a=0;a<k;a++)for(n=0;n<b;n++)r[n][a]=d[r[n][a]];else for(a=0;a<k;a++)if(l[a])for(n=0;n<b;n++)r[n][a]=d[r[n][a]];m.pixelType="U8";return m}},isNull:function(m,n){if(null!==m&&null!==m.pixels){m=this._clonePixelBlock(m);n=m.mask;var r=
m.pixels[0],l=r.length,k;if(n){for(k=0;k<l;k++)r[k]=n[k]?0:1;m.mask=null}else if(r.fill)r.fill(0);else for(k=0;k<l;k++)r[k]=0;return m}},setNull:function(m){if(null!==n&&null!==n.pixels){var n=this._clonePixelBlock(m);m=n.mask;var r=n.pixels[0],l=r.length,k;m=m||new Uint8Array(l);for(k=0;k<l;k++)m[k]=r[k]?0:1;n.mask=m;return n}},local:function(m,n){if(!n)return m[0];var r=n.rasterCountNeeded;n=n.functor;var l=this._clonePixelBlock(m[0]);if(null!==l&&null!==l.pixels){var k=l.width*l.height,b;m=(b=
m[1])&&b.pixels[0];var a=b&&b.mask,d=l.mask,f=l.pixels[0];if(2===r)if(!d&&a)d=a;else if(d&&a)for(b=0;b<k;b++)d[b]=d[b]&&a[b]?1:0;l.mask=d;if(1===r)if(null==d)for(b=0;b<k;b++)f[b]=n(f[b]);else for(b=0;b<k;b++)d[b]&&(f[b]=n(f[b]));else if(2===r)if(null==d)for(b=0;b<k;b++)f[b]=n(f[b],m[b]);else for(b=0;b<k;b++)d[b]&&(f[b]=n(f[b],m[b]));l.mask=d;l.calculateStatistics();return l}},remapColor:function(m,n){m=this._clonePixelBlock(m);var r=m.width*m.height,l=n.length,k=Math.floor(l/2),b=n[Math.floor(k)],
a=n[0].value,d=n[n.length-1].value,f=m.pixels[0],e,h,c=!1,g=new Uint8Array(r),p=new Uint8Array(r),q=new Uint8Array(r),u=m.mask,v=4===n[0].mappedColor.length;u&&0!==u.length||(u=new Uint8Array(r),u.fill(v?255:1),m.mask=u);for(h=0;h<r;h++)if(u[h]){var t=f[h];if(t<a||t>d)g[h]=p[h]=q[h]=u[h]=0;else{c=!1;var y=k;var C=b;var B=0;for(e=l-1;1<e-B;){if(t===C.value){c=!0;break}t>C.value?B=y:e=y;y=Math.floor((B+e)/2);C=n[Math.floor(y)]}c||(C=t===n[e].value?n[e]:n[B]);g[h]=C.mappedColor[0];p[h]=C.mappedColor[1];
q[h]=C.mappedColor[2];u[h]=C.mappedColor[3]}}m.pixels=[g,p,q];m.mask=u;m.pixelType="u8";m.maskIsAlpha=v;return m},_clonePixelBlock:function(m){if(m.clone)return m.clone();var n=H.clone(m),r;if(m.pixels&&m.pixels[0]&&0<m.pixels[0].length&&!(n.pixels&&n.pixels[0]&&0<n.pixels[0].length)){n.pixels=[];var l=m.pixels.length;for(r=0;r<l;r++)n.pixels[r]=new m.pixels[r].constructor(m.pixels[r])}if(m.statistics)for(n.statistics=[],l=m.statistics.length,r=0;r<l;r++)n.statistics[r]=H.clone(m.statistics[r]);m.mask&&
(n.mask=new Uint8Array(m.mask));return n},_createContrastBrightnessLUT:function(m,n){if(this._contrastCache&&this._contrastCache.contrastOffset===m&&this._contrastCache.brightnessOffset===n)return this._contrastCache.lut;var r=Math.min(Math.max(m,-100),100),l=Math.min(Math.max(n,-100),100),k,b=new Uint8Array(256);for(k=0;256>k;k++){if(0<r&&100>r)var a=(200*k-25500+510*l)/(2*(100-r))+128;else 0>=r&&-100<r?a=(200*k-25500+510*l)*(100+r)/2E4+128:100===r?(a=200*k-25500+256*(100-r)+510*l,a=0<a?255:0):-100===
r&&(a=128);b[k]=255<a?255:0>a?0:a}this._contrastCache={contrastOffset:m,brightnessOffset:n,lut:b};return b}}})},"esri/layers/rasterLib/function/CompositeBandFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin".split(" "),function(H,m,n,r,l,k){return H([n,k],{declaredClass:"esri.layers.rasterLib.function.CompositeBandFunction",functionName:"CompositeBand",supportWebGL:!0,support2D:!0,constructor:function(b){this.functionArguments=
this.mixinIgnoreCase({rasters:null},b)},bind:function(b){b=this.getSourceRasterInfo(b);if(!b.rasters)return Error("The rasters input to composite band function is invalid.");var a=[],d=[],f=b.rasters.length,e;if(b.rasters[0].statistics)for(e=0;e<f;e++)a.push(b.rasters[e].statistics[0]);if(b.rasters[0].histograms)for(e=0;e<f;e++)d.push(b.rasters[e].histograms[0]);this.rasterInfo=m.mixin(b.rasters[0],{bandCount:f,pixelType:this._calculatePixelType(this.pixelType,b.rasters[0].pixelType),statistics:a,
histograms:d});return!0},read2D:function(b){b=b.rasters;if(null!=b&&0!==b.length){var a=this._clonePixelData(b[0]),d=a.pixelBlock,f=[],e=[];for(h=0;h<b.length;h++)f.push(b[h].pixelBlock.pixels[0]),e.push(b[h].pixelBlock.statistics[0]);d.pixels=f;d.stackedStatistics=e;d.planes=b.length;var h;e=d.width*d.height;for(h=0;h<b.length;h++)if(d=b[h].pixelBlock.mask,c&&d)for(f=0;f<e;f++)c[f]&=d[f];else var c=c||d;a.maks=c;return a}},readGL:function(b){this._performance.start();this._initializeProgram({fragment:l.compositeBand,
fragmentName:"CompositeBand"});var a=b.rasters;if(null!=a&&0!==a.length){a=a.length;var d,f=this.bindFrameBuffer();for(d=0;d<a;d++){var e=this._setupTextureData(b.rasters[d],{notOriginal:0<d});var h=0<d?d.toString():"";this._bindTexture(e.texture,"u_image"+h)}this._setUniforms({u_rasterCount:a});this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:e.extent,texture:f.texture}}}})})},"esri/layers/rasterLib/function/ContrastBrightnessFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./rasterUtils".split(" "),
function(H,m,n,r,l,k,b){return H([n,k],{declaredClass:"esri.layers.rasterLib.function.ContrastBrightnessFunction",renderTexture:!0,functionName:"ContrastBrightness",supportWebGL:!0,support2D:!0,pixelType:"U8",constructor:function(a){this.functionArguments=this.mixinIgnoreCase({contrastOffset:0,brightnessOffset:0,raster:null},a)},bind:function(a){a=this.getSourceRasterInfo(a);if(!a.raster)return Error("The raster input to contrast and brightness function is invalid.");this.rasterInfo=m.mixin(a.raster,
{bandCount:a.raster.bandCount,pixelType:this._calculatePixelType(this.pixelType,"U8"),statistics:null,histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Processed";return!0},read2D:function(a){a=a.raster;if(null!==a&&null!==a.pixelBlock&&null!==a.pixelBlock.pixels){var d=b.contrastBrightnessStretch(a.pixelBlock,{contrastOffset:this.functionArguments.contrastOffset,brightnessOffset:this.functionArguments.brightnessOffset});"Unknown"!==
this.pixelType&&(d.pixelType=this.pixelType,d.pixels=d.pixels.map(m.hitch(this,function(f){return this._clampBand(f,d.pixelType)})));return{extent:a.extent,pixelBlock:d}}},readGL:function(a){return this._cbGL(a.raster)},_cbGL:function(a){this._performance.start();this._initializeProgram({fragment:l.contrastBrightness,fragmentName:"ContrastBrightness"});a=this._setupTextureData(a);this._setUniforms({u_contrastOffset:Math.min(Math.max(this.functionArguments.contrastOffset,-100),100),u_brightnessOffset:Math.min(Math.max(this.functionArguments.brightnessOffset,
-100),100),u_scaleFactor:this.renderTexture?255:1});this._bindTexture(a.texture,"u_image");var d=this.bindFrameBuffer();this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:a.extent,texture:d.texture}}})})},"esri/layers/rasterLib/function/ConvolutionFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./convolutionKernel ./pixelShaders ./RasterFunctionWebGLMixin ./rasterUtils".split(" "),function(H,m,n,r,l,k,b,a){return H([n,
b],{declaredClass:"esri.layers.rasterLib.function.ConvolutionFunction",functionName:"Convolution",supportWebGL:!0,support2D:!0,constructor:function(d){this.functionArguments=this.mixinIgnoreCase({columns:3,rows:3,type:0,kernel:null,raster:null},d)},bind:function(d){d=this.getSourceRasterInfo(d);if(!d.raster)return Error("The raster input to convolution function is invalid.");this.rasterInfo=m.mixin(d.raster,{bandCount:d.raster.bandCount,pixelType:this._calculatePixelType(this.pixelType,d.raster.pixelType),
statistics:d.raster.statistics,histograms:d.raster.histograms});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(d){this._performance.start();d=d.raster;var f=this._analyzeKernel(),e=a.convolute(d.pixelBlock,{normalizedKernel:f.normalizedKernel,kernelCols:this.functionArguments.columns,kernelRows:this.functionArguments.rows});this._addPerformanceMetric(this._performance.elapsed());"Unknown"!==this.pixelType&&
(e.pixelType=this.pixelType);e.pixels=e.pixels.map(m.hitch(this,function(h){return this._clampBand(h,e.pixelType)}));return{extent:d.extent,pixelBlock:e}},readGL:function(d){this._performance.start();this._initializeProgram({fragment:k.convolution,fragmentName:"Convolution"});var f=this._setupTextureData(d.raster),e=this.bindFrameBuffer(),h=this.gl,c=h.drawingBufferWidth;h=h.drawingBufferHeight;var g=this.functionArguments.kernel;this._setUniforms({u_resolution:d&&d.raster&&d.raster.pixelBlock?[1/
d.raster.pixelBlock.width,1/d.raster.pixelBlock.height]:[1/c,1/h],u_kernel:g,u_kernelSize:g.length});this._bindTexture(f.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:f.extent,texture:e.texture}},_analyzeKernel:function(){var d=this.functionArguments.kernel,f=d.reduce(function(c,g){return c+g});0!==f&&1!==f&&(d=d.map(function(c){return c/f}));var e,h=[];for(e=0;e<d.length;e++)h.some(function(c){return c===d[e]})||h.push(d[e]);return{normalizedKernel:d,
distinctValues:h}},_analyzeKernelPattern:function(){var d=this.functionArguments.rows,f=this.functionArguments.columns,e=this.functionArguments.kernel,h=[],c,g;for(c=0;c<d;c++)h.push({weights:e.slice(c*f,(c+1)*f)});var p;for(c=1;c<d;c++){var q=h[c].weights;for(e=0;e<c;e++)if(p=h[e].weights){var u=q[0]/p[0];for(g=1;g<f;g++)q[g]/p[g]!==u&&(u=null);null!==u&&(h[c]={row:e,factor:u})}}return h}})})},"esri/layers/rasterLib/function/ExtractBandFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin".split(" "),
function(H,m,n,r,l,k){return H([n,k],{declaredClass:"esri.layers.rasterLib.function.ExtractBandFunction",functionName:"ExtractBand",supportWebGL:!0,support2D:!0,constructor:function(b){this.functionArguments=this.mixinIgnoreCase({bandIDs:[],missingBandAction:0,raster:null},b)},bind:function(b){b=this.getSourceRasterInfo(b);if(!b.raster)return Error("The raster input to extract band function is invalid.");var a=[],d=b.raster.statistics,f=[],e=b.raster.histograms,h=this.functionArguments.bandIDs.length||
b.raster.bandCount;this.functionArguments.bandIDs.forEach(m.hitch(this,function(c){if(c>=h-1){if(1===this.functionArguments.missingBandAction)return Error("missing band "+c);c=h-1}if(0>c)return Error("missing band "+c);void 0!==d&&null!==d&&0<d.length&&a.push(d[c]);void 0!==e&&null!==e&&0<e.length&&f.push(e[c])}));this.rasterInfo=m.mixin(b.raster,{bandCount:h,pixelType:this._calculatePixelType(this.pixelType,b.raster.pixelType),statistics:a,histograms:f});return!0},read2D:function(b){b=this._clonePixelData(b.raster);
if(null!==b&&null!==b.pixelBlock&&null!==b.pixelBlock.pixels){this._performance.start();var a=b.pixelBlock,d=a.statistics,f=a.pixels,e=f.length;if(null==this.functionArguments.bandIDs)throw"missing bandIDs parameter";if(0===this.functionArguments.bandIDs.length)return b;var h=[],c=[];this.functionArguments.bandIDs.forEach(function(g){if(g>=e-1){if(1===this.functionArguments.missingBandAction)throw"missing band "+g;g=e-1}if(0>g)throw"missing band "+g;h.push(f[g]);void 0!==d&&null!==d&&0<d.length&&
c.push(d[g])});a.pixels=h;a.statistics=c;a.planes=this.functionArguments.bandIDs.length;return b}},readGL:function(b){this._performance.start();if(null==this.functionArguments.bandIDs)throw"missing bandIDs parameter";if(3<this.functionArguments.bandIDs.length)throw"this version does not support more than 3 bands yet";this._initializeProgram({fragment:l.extractBand,fragmentName:"ExtractBand"});var a=this.functionArguments.bandIDs;1===a.length&&(a=[a[0],a[0],a[0]]);this._bandIDs=a;this._alterBand=!(0===
this.functionArguments.bandIDs.length||0===a[0]&&1===a[1]&&2===a[2]);var d=!!(this._alterBand&&b.raster&&b.raster.texture);b=this._setupTextureData(b.raster,{bandIDs:a});var f=this.bindFrameBuffer();d?this._setUniforms({u_bandIDs:a,u_alterBand:this._alterBand}):this._setUniforms({u_bandIDs:a,u_alterBand:!1});this._bindTexture(b.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:b.extent,texture:f.texture}}})})},"esri/layers/rasterLib/function/HillshadeFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../../renderers/colorRampGenerator ../../../WKIDUnitConversion ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./surfaceUtils ./rasterUtils".split(" "),
function(H,m,n,r,l,k,b,a,d,f){return H([n,a],{declaredClass:"esri.layers.rasterLib.function.HillshadeFunction",functionName:"Hillshade",supportWebGL:!0,support2D:!0,renderTexture:!0,constructor:function(e){this.functionArguments=this.mixinIgnoreCase({hillshadeType:0,altitude:45,azimuth:315,zFactor:1,slopeType:1,psPower:.664,psFactor:.024,colorRamp:null,raster:null},e);this._azimuths=[315,270,225,360,180,0];this._altitudes=[60,60,60,60,60,90];this._weights=[3,5,3,2,1,4];var h=this._weights.reduce(function(c,
g){return c+g});this._weights=this._weights.map(function(c){return c/h})},bind:function(e){e=this.getSourceRasterInfo(e);if(!e.raster)return Error("The raster input to hillshade function is invalid.");e.raster.statistics&&(this.srcStatistics=e.raster.statistics);this.rasterInfo=m.mixin(e.raster,{bandCount:1,pixelType:this._calculatePixelType(this.pixelType,"U8"),statistics:[{min:0,max:255}],histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType=
"Generic";this._initializeColormap();return!0},read2D:function(e){this._performance.start();e=e.raster;e=d.hillshade(e,{altitude:this.functionArguments.altitude,azimuth:this.functionArguments.azimuth,zFactor:this.functionArguments.zFactor,psPower:this.functionArguments.psPower,psFactor:this.functionArguments.psFactor,hillshadeType:this.functionArguments.hillshadeType,slopeType:this.functionArguments.slopeType,isGCS:e.extent.spatialReference.wkid&&null==l[e.extent.spatialReference.wkid]});this._addPerformanceMetric(this._performance.elapsed());
return e},readGL:function(e){this._performance.start();this._initializeProgram({fragment:b.hillshade,fragmentName:"Hillshade"});this.functionArguments.colorRamp&&this._indexedColormap&&!this._clrTexture&&(this._clrTexture=this._setupColormapTexture(this._indexedColormap));var h=this._setupTextureData(e.raster),c=this.bindFrameBuffer(),g=this.gl,p=g.drawingBufferWidth;g=g.drawingBufferHeight;var q=h.extent,u=(q.xmax-q.xmin)/p,v=(q.ymax-q.ymin)/g,t=this.functionArguments.altitude,y=this.functionArguments.azimuth,
C=this.functionArguments.zFactor;1===this.functionArguments.hillshadeType&&(C*=2);var B=C/(8*u),F=C/(8*v);.001<C&&q.spatialReference.wkid&&null==l[q.spatialReference.wkid]&&(B/=111E3,F/=111E3);var x=this.functionArguments.psPower,w=this.functionArguments.psFactor;3===this.functionArguments.slopeType&&((B=q.spatialReference.wkid&&null==l[q.spatialReference.wkid])?(B=111E3*u,F=111E3*v,B=(C+Math.pow(B,x)*w)/(8*B),F=(C+Math.pow(F,x)*w)/(8*F)):(B=(C+Math.pow(u,x)*w)/(8*u),F=(C+Math.pow(v,x)*w)/(8*v)));
var A=(90-t)*Math.PI/180;t=Math.cos(A);var z=(360-y+90)*Math.PI/180;y=Math.sin(A)*Math.cos(z);A=Math.sin(A)*Math.sin(z);x=Array(6);w=Array(6);q=Array(6);var G=this._weights,J;if(1===this.functionArguments.hillshadeType){var L=this._azimuths.length;for(J=0;J<L;J++)t=this._altitudes[J],y=this._azimuths[J],A=(90-t)*Math.PI/180,t=Math.cos(A),z=(360-y+90)*Math.PI/180,y=Math.sin(A)*Math.cos(z),A=Math.sin(A)*Math.sin(z),x[J]=t,w[J]=y,q[J]=A}else x[0]=t,w[0]=y,q[0]=A;x=x.map(function(R){return parseFloat(R)});
w=w.map(function(R){return parseFloat(R)});q=q.map(function(R){return parseFloat(R)});this._setUniforms({u_cellSize:[u,v],u_zfactor:C,u_xFactor:B,u_yFactor:F,u_sinZcosA:y,u_sinZsinA:A,u_cosZ:t,u_sinZcosAs:w,u_sinZsinAs:q,u_cosZs:x,u_weights:G,u_hillshadeType:this.functionArguments.hillshadeType,u_resolution:e&&e.raster&&e.raster.pixelBlock?[1/e.raster.pixelBlock.width,1/e.raster.pixelBlock.height]:[1/p,1/g],u_scaled:!this.renderTexture,u_applyColorramp:this._clrTexture?!0:!1,u_minValue:this.srcStatistics[0].min,
u_maxValue:this.srcStatistics[0].max,u_indexedColormapOffset:this._indexedColormapOffset||0,u_indexedColormapMaxIndex:this._indexedColormap?this._indexedColormap.length/4-1:0});this._clrTexture&&this._bindTexture(this._clrTexture,"u_image1");this._bindTexture(h.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:h.extent,texture:c.texture}},_initializeColormap:function(){this._indexedColormapOffset=0;var e=this._indexedColormap,h=this.functionArguments.colorRamp;
this.functionArguments.colormap?(this._alphaSpecified=(h=f.buildIndexedColormap(this.functionArguments.colormap))&&h.alphaSpecified,this._indexedColormap=h&&h.indexedColormap,this._indexedColormapOffset=h&&h.offset):h?(this._indexedColormap="multipart"===h.type?this.invert?r.createMultiPartColorRamp(this._invertColorRamp(h)):r.createMultiPartColorRamp(h):this.invert?r.createAlgorithmicColorRamp(this._invertColorRamp(h)):r.createAlgorithmicColorRamp(h),h.fromColor&&h.toColor&&"000"===h.fromColor.slice(0,
3).join("")&&"255255255"===h.toColor.slice(0,3).join("")&&(this._clrTexture=this._indexedColormap=null)):this.functionArguments.colormapName?"random"===this.functionArguments.colormapName.toLowerCase()&&(this._indexedColormap=r.createRandomColorRamp()):this._clrTexture=this._indexedColormap=null;if(e&&this._indexedColormap){h=!0;for(var c=0;c<e.length;c++)if(e[c]!==this._indexedColormap[c]){h=!1;break}h||(this._clrTexture=null)}},_setupColormapTexture:function(e){var h=this._createTexture(),c=this.gl,
g=e.length/4,p=new Float32Array(e.length),q;for(q=0;q<e.length;q++)p[q]=e[q]/255;c.getExtension("OES_texture_float");c.texImage2D(c.TEXTURE_2D,0,c.RGBA,g,1,0,c.RGBA,c.FLOAT,p);return h}})})},"esri/layers/rasterLib/function/LocalFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./rasterUtils".split(" "),function(H,m,n,r,l,k,b){return H([n,k],{declaredClass:"esri.layers.rasterLib.function.LocalFunction",functionName:"Local",
supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({operation:null,rasters:null},a)},bind:function(a){a=this.getSourceRasterInfo(a);var d=0;a.raster?d=a.raster.bandCount:a.rasters&&(d=Math.max.apply(null,a.rasters.map(function(f){return f.bandCount})));if(0===d)return Error("The raster input to local function is invalid. It only takes single band input.");a=a.raster||a.rasters.filter(function(f){return!!f.extent})[0];this.rasterInfo=m.mixin(a,{bandCount:1,
pixelType:this._calculatePixelType(this.pixelType,"F32"),statistics:null,histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(a){var d=[];d=a.raster?a.raster2?[a.raster,a.raster2]:[a.raster]:a.rasters;a=d.map(function(g){return g.pixelBlock});var f=this.functionArguments.operation;if(null===f)return d[0];this._performance.start();var e=this._getOperations(),h=e.operators[f-1];e=e.functors[f-1];
if(!this.functionArguments.rasters){if(1!==h)throw"no sufficient rasters, require "+h;}else if(999!==h&&this.functionArguments.rasters.length!==h)throw"number of rasters does not meet (short or exceed) the operation requirment, require "+h;var c=31===f?b.isNull(a[0]):50===f?b.setNull(a[0]):b.local(a,{rasterCountNeeded:h,functor:e});"Unknown"!==this.pixelType&&(c.pixelType=this.pixelType,c.pixels=c.pixels.map(m.hitch(this,function(g){return this._clampBand(g,c.pixelType)})));c.statistics||c.calculateStatistics();
return{extent:d[0].extent,pixelBlock:c}},readGL:function(a){this._performance.start();var d=this.functionArguments.operation,f=this._getWebGLOperations(),e=f.operators[d-1],h=l.local;f="result\x3d"+f.functors[d-1]+";";31!==d&&50!==d&&(f+="result \x3d vec4(result.rgb, a.a);");h=h.replace("vec4 replaceme"+e+";",f);f=this.gl.getParameter(this.gl.VERSION);var c="";if(-1<f.toLowerCase().indexOf("webgl 1.0")||-1<f.toLowerCase().indexOf("webgl 0."))c=this._getPolyfill(d);h=h.replace("vec4 polyfill;",c);
1<e&&(h=h.replace("gl_FragColor \x3d localOp1();","gl_FragColor \x3d localOp1();".replace("1",e.toString())));this._initializeProgram({fragment:h,fragmentName:"Local"});d=a.rasters;if(null!=d&&0!==d.length){d=d.length;f=this.bindFrameBuffer();for(e=0;e<d;e++){h=0<e?e.toString():"";var g=this._setupTextureData(a.rasters[e],{reCreate:!0});this._bindTexture(g.texture,"u_image"+h)}this._setUniforms({});this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:g.extent,texture:f.texture}}},
_getOperations:function(){return{operators:[2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,1,1,1,1,999,999,1,1,999,1,1,2,2,2,999,999,999,999,999,999,999,999,999,999,3],functors:[function(a,d){return a+d},function(a,d){return a-d},function(a,d){return a*d},function(a){return Math.sqrt(a)},function(a,d){return Math.pow(a,d)},function(a){return Math.acos(a)},function(a){return Math.asin(a)},function(a){return Math.atan(a)},function(a){return Math.atanh(a)},
function(a){return Math.abs(a)},function(a,d){return a&d},function(a,d){return a<<d},function(a){return~a},function(a,d){return a|d},function(a,d){return a>>d},function(a,d){return a^d},function(a,d){return a&&d},function(a){return!a},function(a,d){return a||d},function(a,d){return a!=d},function(a){return Math.cos(a)},function(a,d){return Math.cosh(a)},function(a,d){return a/d},function(a,d){return a==d},function(a){return Math.exp(a)},function(a){return Math.pow(10,a)},function(a){return Math.pow(2,
a)},function(a,d){return a>d?1:0},function(a,d){return a>=d?1:0},function(a,d){return Math.floor(a)},function(a){return!a},function(a){return a},function(a,d){return a<d?1:0},function(a,d){return a<=d?1:0},function(a){return Math.log(a)},function(a,d){return Math.log10(a)},function(a,d){return Math.log2(a)},999,999,999,999,999,999,function(a,d){return a%d},function(a){return-a},function(a,d){return a!=d?1:0},999,function(a,d){return Math.floor(a)},function(a,d){return Math.ceil(a)},function(a,d){return d?
0:a},function(a,d){return Math.sin(a)},function(a,d){return Math.sinh(a)},function(a,d){return a*a},999,999,function(a){return Math.tan(a)},function(a){return Math.tanh(a)},999,function(a){return Math.acosh(a)},function(a){return Math.asinh(a)},function(a,d){return Math.atan2(a,d)},function(a,d){return a/d},function(a,d){return Math.floor(a/d)},999,999,999,999,999,999,999,999,999,999,function(a,d,f){return a?d:f}]}},_polyfill:{sinh:"vec4 sinh(vec4 x) {\nvec4 halfexp \x3d exp(x)/2.0;\nreturn halfexp - 1.0/halfexp;\n}",
asinh:"vec4 asinh(vec4 x) {\nvec4 halfexp \x3d exp(x)/2.0;\nreturn 1.0/(halfexp - 1.0/halfexp);\n}",cosh:"vec4 cosh(vec4 x) {\nvec4 halfexp \x3d exp(x)/2.0;\nreturn halfexp + 1.0/halfexp;\n}",acosh:"vec4 acosh(vec4 x) {\nvec4 halfexp \x3d exp(x)/2.0;\nreturn 1.0/(halfexp + 1.0/halfexp);\n}",tanh:"vec4 tanh(vec4 x) {\nvec4 expx \x3d exp(x);\nreturn (expx - 1.0/expx)/(expx + 1.0/expx);\n}",atanh:"vec4 atanh(vec4 x) {\nvec4 expx \x3d exp(x);\nreturn (expx + 1.0/expx)/(expx - 1.0/expx);\n}"},_getPolyfill:function(a){var d=
"";switch(a){case 9:d=this._polyfill.atanh;break;case 22:d=this._polyfill.cosh;break;case 52:d=this._polyfill.sinh;break;case 57:d=this._polyfill.tanh;break;case 59:d=this._polyfill.acosh;break;case 60:d=this._polyfill.asinh}return d},_getWebGLOperations:function(){return{operators:[2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,1,1,1,1,999,999,1,1,999,1,1,2,2,2,999,999,999,999,999,999,999,999,999,999,3],functors:["(a + b)","(a - b)",
"(a * b)","sqrt(a)","pow(a, b)","acos(a)","asin(a)","atan(a)","atanh(a)","abs(a)","a","a","a","a","a","a","(a.r\x3d\x3d0.0 || b.r\x3d\x3d0.0) ? vec4(0.0,0.0,0.0,a.a) : vec4(1.0,1.0,1.0,a.a)","a.r\x3d\x3d0.0?vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)","(a.r\x3d\x3d0.0 \x26\x26 b.r\x3d\x3d0.0) ? vec4(0.0,0.0,0.0,a.a) : vec4(1.0,1.0,1.0,a.a)","(a.r\x3d\x3d0.0 ^^ b.r\x3d\x3d0.0) ? vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)","cos(a)","cosh(a)","a / b","a.r \x3d\x3d b.r? vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)",
"exp(a)","pow(10.0, a)","pow(2.0, a)","a.r \x3e b.r ? vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)","a.r \x3e\x3d b.r ? vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)","floor(a)","a.a \x3d\x3d 0.0? vec4(1.0,1.0,1.0,1.0) : vec4(0.0,0.0,0.0,1.0)","a","a.r \x3c b.r ? vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)","a.r \x3c\x3d b.r ? vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)","log(a)","log2(a) / log2(10.0)","log2(a)",999,999,999,999,999,999,"mod(a, b)","-a","a.r !\x3d b.r ? vec4(1.0,1.0,1.0,a.a) : vec4(0.0,0.0,0.0,a.a)",
999,"floor(a)","ceil(a)","a.r !\x3d 0.0 ? vec4(0.0,0.0,0.0,0.0) : a","sin(a)","sinh(a)","a * a",999,999,"tan(a)","tanh(a)",999,"acosh(a)","asinh(a)","atan(a, b)","a / b","floor(a / b)",999,999,999,999,999,999,999,999,999,999,"a.r!\x3d0 ? b : c"]}}})})},"esri/layers/rasterLib/function/MaskFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./rasterUtils".split(" "),function(H,m,n,r,l,k,b){return H([n,k],{declaredClass:"esri.layers.rasterLib.function.MaskFunction",
functionName:"Mask",supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({includedRanges:null,noDataInterpretation:0,noDataValues:null,raster:null},a)},bind:function(a){a=this.getSourceRasterInfo(a);if(!a.raster)return Error("The raster input to mask function is invalid.");this.rasterInfo=m.mixin(a.raster,{bandCount:a.raster.bandCount,pixelType:this._calculatePixelType(this.pixelType,a.raster.pixelType),statistics:a.raster.statistics,histograms:a.raster.histograms});
return!0},read2D:function(a){this._performance.start();a=a.raster;var d=b.mask(a.pixelBlock,{includedRanges:this.functionArguments.includedRanges,noDataInterpretation:this.functionArguments.noDataInterpretation,noDataValues:this.functionArguments.noDataValues});this._addPerformanceMetric(this._performance.elapsed());"Unknown"!==this.pixelType&&(d.pixelType=this.pixelType);return{extent:a.extent,pixelBlock:d}},readGL:function(a){this._performance.start();this._initializeProgram({fragment:l.mask,fragmentName:"Mask"});
a=this._setupTextureData(a.raster);var d=this.bindFrameBuffer(),f=this.functionArguments.includedRanges,e=this.functionArguments.noDataValues?this.functionArguments.noDataValues.map(function(h){return parseFloat(h,10)}):null;this._setUniforms({u_includedRanges:f,u_includedRanges_specified:f?!0:!1,u_noDataValues:e,u_noDataValues_specified:e?!0:!1,u_noDataInterpretation:this.functionArguments.noDataInterpretation,u_bandCount:Math.min(this.sourceRasterInfo.raster.bandCount,3)});this._bindTexture(a.texture,
"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:a.extent,texture:d.texture}}})})},"esri/layers/rasterLib/function/NDVIFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./rasterIndex".split(" "),function(H,m,n,r,l,k,b){return H([n,k],{declaredClass:"esri.layers.rasterLib.function.NDVIFunction",functionName:"NDVI",supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=
this.mixinIgnoreCase({visibleBandID:1,infraredBandID:2,scaled:!0,raster:null},a)},bind:function(a){a=this.getSourceRasterInfo(a);if(!(a.raster&&1<a.raster.bandCount))return Error("The raster input to ndvi function is invalid. It requires more than 1 band.");this.rasterInfo=m.mixin(a.raster,{bandCount:1,pixelType:this._calculatePixelType(this.pixelType,this.scaled?"U8":"F32"),statistics:this.scaled?[{min:0,max:200}]:[{min:-1,max:1}],histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||
{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(a){this._performance.start();a=a.raster;var d=b.calculate(a.pixelBlock,{bandIndexes:[this.functionArguments.infraredBandID+1,this.functionArguments.visibleBandID+1].join(" "),method:1}),f;if(this.functionArguments.scaled){var e=d.pixels[0];var h=d.mask;var c=e.length;var g=new Uint8Array(c);if(null==h)for(f=0;f<c;f++)g[f]=100*e[f]+100&255;else for(f=0;f<c;f++)h[f]&&(g[f]=100*e[f]+100&255);d.pixels[0]=g;d.pixelType="U8"}this._addPerformanceMetric(this._performance.elapsed());
"Unknown"!==this.pixelType&&(d.pixelType=this.pixelType);return{extent:a.extent,pixelBlock:d}},readGL:function(a){this._performance.start();this._initializeProgram({fragment:l.ndvi,fragmentName:"NDVI"});var d=this.functionArguments.visibleBandID,f=this.functionArguments.infraredBandID,e=this.functionArguments.scaled||!1;this._alterBand=2<Math.max(f,d)?!0:!1;a=this._setupTextureData(a.raster,{bandIDs:this._alterBand?{bandIDs:[f,d,f]}:null});var h=this.bindFrameBuffer();this._alterBand?this._setUniforms({u_bandId_nir:0,
u_bandId_red:1,u_scaled:e}):this._setUniforms({u_bandId_nir:f,u_bandId_red:d,u_scaled:e});this._bindTexture(a.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:a.extent,texture:h.texture}}})})},"esri/layers/rasterLib/function/SlopeFunction":function(){define("dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../../WKIDUnitConversion ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./surfaceUtils".split(" "),function(H,m,n,r,l,k,
b,a){return H([n,b],{declaredClass:"esri.layers.rasterLib.function.SlopeFunction",functionName:"Slope",supportWebGL:!0,support2D:!0,constructor:function(d){this.functionArguments=this.mixinIgnoreCase({zFactor:1,slopeType:1,psPower:.664,psFactor:.024,raster:null},d)},bind:function(d){d=this.getSourceRasterInfo(d);if(!d.raster)return Error("The raster input to slope function is invalid.");this.rasterInfo=m.mixin(d.raster,{bandCount:1,pixelType:this._calculatePixelType(this.outputPixelType,"F32"),statistics:1===
this.slopeType||3===this.slopeType?[{min:0,max:90}]:null,histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(d){this._performance.start();d=d.raster;d=a.slope(d,{zFactor:this.functionArguments.zFactor,psPower:this.functionArguments.psPower,psFactor:this.functionArguments.psFactor,slopeType:this.functionArguments.slopeType,isGCS:d.extent.spatialReference.wkid&&null==r[d.extent.spatialReference.wkid]});
this._addPerformanceMetric(this._performance.elapsed());return d},readGL:function(d){this._performance.start();this._initializeProgram({fragment:k.slope,fragmentName:"Slope"});var f=this._setupTextureData(d.raster),e=this.bindFrameBuffer(),h=this.gl,c=h.drawingBufferWidth;h=h.drawingBufferHeight;var g=f.extent;this._setUniforms({u_resolution:d&&d.raster&&d.raster.pixelBlock?[1/d.raster.pixelBlock.width,1/d.raster.pixelBlock.height]:[1/c,1/h],u_cellSize:[(g.xmax-g.xmin)/c,(g.ymax-g.ymin)/h],u_zfactor:this.functionArguments.zFactor});
this._bindTexture(f.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:f.extent,texture:e.texture}}})})},"esri/layers/rasterLib/function/RemapFunction":function(){define("dojo/_base/declare dojo/_base/lang ../../../renderers/colorRampGenerator ./RasterFunctionX ./pixelShaders ./RasterFunctionWebGLMixin ./rasterUtils".split(" "),function(H,m,n,r,l,k,b){return H([r,k],{declaredClass:"esri.layers.rasterLib.function.RemapFunction",functionName:"Remap",
pixelType:"U8",renderTexture:!1,supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({inputRanges:null,outputValues:null,outputColors:null,colorBreaks:null,raster:null},a)},bind:function(a){a=this.getSourceRasterInfo(a);if(!a.raster)return Error("The raster input is not available.");var d=!(!this.functionArguments.outputColors&&!this.functionArguments.colorBreaks);this.rasterInfo=m.mixin(a.raster,{bandCount:d?3:1,pixelType:this._calculatePixelType(this.pixelType,
"U8"),statistics:null,histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType=d?"Processed":"Thematic";return!0},read2D:function(a){return this._remap(a.raster)},readGL:function(a){return this._remapGL(a.raster)},_remap:function(a){this._performance.start();var d=b.remapColor(a.pixelBlock,this.functionArguments.colorBreaks);this._addPerformanceMetric(this._performance.elapsed());return{extent:a.extent,pixelBlock:d}},_remapGL:function(a){this._performance.start();
this._initializeProgram({fragment:l.remap,fragmentName:"Remap"});var d=new Uint8Array(64),f=this.functionArguments.colorBreaks;f.forEach(function(g,p){d[4*p]=g.mappedColor[0];d[4*p+1]=g.mappedColor[1];d[4*p+2]=g.mappedColor[2];d[4*p+3]=1>=g.mappedColor[3]?255*g.mappedColor[3]:g.mappedColor[3]});var e=f[f.length-1],h=e.mappedColor;d[60]=h[0];d[61]=h[1];d[62]=h[2];d[63]=1>=h[3]?255*h[3]:h[3];var c=new Float32Array(16);f.forEach(function(g,p){c[p]=g.value});c[15]=e.value;this._clrTexture||(this._clrTexture=
this._setupColormapTexture(d));f=this._clrTexture;e=this.bindFrameBuffer();a=this._setupTextureData(a);this._setUniforms({u_indexedColormapOffset:0,u_indexedColormapMaxIndex:d.length/4-1,u_breaks:c});this._bindTexture(f,"u_image1");this._bindTexture(a.texture,"u_image");this._drawGL();return{extent:a.extent,texture:e.texture}},_setupColormapTexture:function(a){var d=this._createTexture(),f=a.length/4,e=new Float32Array(a.length),h=this.renderTexture?255:1,c,g=this.gl;for(c=0;c<a.length;c++)e[c]=a[c]/
h;g.getExtension("OES_texture_float");g.texImage2D(g.TEXTURE_2D,0,g.RGBA,f,1,0,g.RGBA,g.FLOAT,e);return d}})})},"esri/layers/rasterLib/function/IdentityFunction":function(){define(["dojo/_base/declare","dojo/_base/lang","./pixelShaders","./RasterFunctionX","./RasterFunctionWebGLMixin"],function(H,m,n,r,l){return H([r,l],{declaredClass:"esri.layers.rasterLib.function.IdentityFunction",functionName:"Identity",supportWebGL:!0,support2D:!0,constructor:function(k){this.functionArguments={raster:null}},
bind:function(k){k=this.getSourceRasterInfo(k);if(!k.raster)return Error("The raster input to identity function is invalid.");this.rasterInfo=m.mixin(k.raster,{});return!0},read2D:function(k){return k.raster},readGL:function(k){this._initializeProgram({fragment:n.identity,fragmentName:"identity"});k=this._setupTextureData(k.raster);var b=this.bindFrameBuffer();this._bindTexture(k.texture,"u_image");this._drawGL();return{extent:k.extent,texture:b.texture}}})})},"esri/layers/rasterLib/function/ResampleFunction":function(){define(["dojo/_base/declare",
"dojo/_base/lang","./pixelShaders","./RasterFunctionX","./RasterFunctionWebGLMixin"],function(H,m,n,r,l){return H([r,l],{declaredClass:"esri.layers.rasterLib.function.ResampleFunction",renderTexture:!0,resamplingOrigin:null,resamplingRatio:null,zFactor:1,functionName:"Resample",supportWebGL:!0,support2D:!1,constructor:function(k){this.functionArguments=this.mixinIgnoreCase({resamplingType:0},k)},bind:function(k){k=this.getSourceRasterInfo(k);if(!k.raster)return Error("The raster input to convolution function is invalid.");
this.rasterInfo=m.mixin(k.raster,{bandCount:k.raster.bandCount,pixelType:this._calculatePixelType(this.pixelType,k.raster.pixelType),statistics:k.raster.statistics,histograms:k.raster.histograms});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};return!0},readGL:function(k){this._performance.start();this._initializeProgram({fragment:n.resample,fragmentName:"Resample"});var b=this._setupTextureData(k.raster),a=this.bindFrameBuffer(),d=this.gl,f=d.drawingBufferWidth;d=d.drawingBufferHeight;
var e=k.raster;void 0!==e.pixelBlock?(b=b||this._setupTextureData(e),k=e.pixelBlock.width,e=e.pixelBlock.height):(b=b||e,k=f,e=d);this._setUniforms({u_resamplingRatio:this.resamplingRatio||[k/f,e/d],u_anchor:this.resamplingOrigin||[0,1],u_resamplingType:this.functionArguments.resamplingType,u_resolution:[1/f,1/d]});this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:b.extent,texture:a.texture}}})})},"esri/layers/rasterLib/renderer/rasterRendererHelper":function(){define("dojo/_base/declare dojo/_base/lang ../../PixelBlock ./RasterColormapRenderer ./RasterUniqueValueRenderer ./RasterRGBRenderer ./RasterStretchColorRampRenderer ./RasterClassBreaksRenderer ./RasterShadedReliefRenderer".split(" "),
function(H,m,n,r,l,k,b,a,d){var f=function(){function e(c){h[c.prototype.rendererName]=c}var h={};e(r);e(k);e(b);e(l);e(a);e(d);return h}();return{wellKnownRenderers:f,isSupported:function(e){if(!e)return!1;var h=!0;f[e.rendererName]||(h=!1);return h},create:function(e){if(!e)return null;if(e.rendererName){var h=e.rendererName;e=e.rendererArguments}else h="uniqueValue rasterStretch rasterShadedRelief rgb rasterColormap classBreaks".split(" ").indexOf(e.type),h="UniqueValue Stretch ShadedRelief RGB Colormap ClassBreaks".split(" ")[h],
"rasterStretch"===e.type&&e.bandIndex&&1<e.bandIndex.length&&(h="RGB");return(h=f[h])?new h(e):null},createDefaultRenderer:function(e){if(e&&e.raster){var h=e.raster.rasterInfo,c=e.raster.dataType;if(h){var g=e.raster.rasterFunction,p=["Stretch","Colormap","ContrastAndBrightness"];if(g&&"U8"===h.pixelType&&-1<p.indexOf(g.functionName))g.renderTexture=!0;else if("Processed"!==c||!(e.useWebGL&&g&&g.renderTexture||!e.useWebGL&&"U8"===h.pixelType)){g&&(h=g.rasterInfo);g=h.bandCount;var q=h.colormap,u=
h.vat;p=h.histograms;p&&0===p.length&&(p=null);var v=h.statistics&&h.statistics.map(function(C){return[C.min,C.max,C.mean,C.stddev]});if(1===g&&q&&0<q.length)var t=this._getDefaultColormapRenderer(u,q);else if(1===g&&u&&u.features&&0<u.features.length)t=new l({});else{q=0;u=!1;c||!e.raster||!e.raster.tileInfo||void 0!==e.raster.tileInfo.tileType&&"Map"!==e.raster.tileInfo.tileType?"U8"===h.pixelType&&"Processed"===c?(q=5,v=v||[[0,255,0,0],[0,255,0,0],[0,255,0,0]],u=!1):"U8"===h.pixelType||"Elevation"===
c?(q=5,u=v?!1:!0):"Scientific"===c||"StdTime"===c?(q=5,u=v?!1:!0,t=this._getDefaultScientificColorRamp()):p&&0<p.length?(q=6,u=!1):v?(q=5,u=!1):(q=6,u=!0):(v=[[0,255,0,0],[0,255,0,0],[0,255,0,0]],q=5,u=!1);v||(q=5,u=!0);e=e.bandIds||e.raster&&e.raster.imageServiceParams&&e.raster.imageServiceParams.bandIds;var y;3<=g&&(y=e&&3===e.length?e.slice():this.getDefaultBandCombination(h));y&&v&&(v=y.map(function(C){return v[C]}));h={stretchType:q,min:0,max:255,dra:u,minPercent:.25,maxPercent:.25,useGamma:!1,
computeGamma:!1,statistics:v,histograms:p,numberOfStandardDeviations:2.5,bandIndex:y};1===g||y&&1===y.length?(t&&(h.colorRamp=t,h.invert=!1),t=new b(h)):t=new k(h)}return t}}}},getDefaultBandCombination:function(e){var h=e.bandCount;if(1===h)return null;if(2===h)return[0];var c=(e=e.keyProperties)&&e.ChangeAnalysisParameters&&e.ChangeAnalysisParameters.AnalysisType;if(c&&("ccdc"===c.toLowerCase()||"landtrendr"===c.toLowerCase()))return[0];e=e&&e.BandProperties;var g;if(e&&e.length===h){var p=this.getWellKnownBandIndexes(e);
e=p.red;c=p.green;var q=p.blue;p=p.nir;null!=e&&null!=c&&null!=q?g=[e,c,q]:null!=p&&null!=e&&null!=c&&(g=[p,e,c])}!g&&3<=h&&(g=[0,1,2]);return g},getWellKnownBandIndexes:function(e){for(var h={},c=0;c<e.length;c++){var g=e[c],p=g.BandName&&g.BandName.toLowerCase();"red"===p?h.red=c:"green"===p?h.green=c:"blue"===p?h.blue=c:"nearinfrared"===p||"nearinfrared_1"===p||"nir"===p?h.nir=c:g.WavelengthMax&&g.WavelengthMin&&(p=g.WavelengthMin,g=g.WavelengthMax,null==h.blue&&410<=p&&480>=p&&480<=g&&540>=g?
h.blue=c:null==h.green&&490<=p&&560>=p&&560<=g&&610>=g?h.green=c:null==h.red&&595<=p&&670>=p&&660<=g&&730>=g?h.red=c:null==h.nir&&700<=p&&860>=p&&800<=g&&950>=g&&(h.nir=c))}return h},_getDefaultColormapRenderer:function(e,h){if(h||h.length){var c=[],g=this._ratContainsColormap(e);if(g)var p=this._getRATValueClassNameMap(e);h.forEach(function(q){var u=p?p[q[0]]:q[0];c.push({color:[q[1],q[2],q[3]],value:q[0],label:g?null!=u?u:"":q[0]})});return new r({colormapInfos:c})}},_ratContainsColormap:function(e){if(!e||
!e.fields)return!1;var h,c,g;return e.fields.some(function(p){p&&p.name&&(p=p.name.toLowerCase(),"red"===p&&(h=!0),"green"===p&&(c=!0),"blue"===p&&(g=!0));return h&&c&&g})},_getRATValueClassNameMap:function(e){if(!e||!e.fields)return null;var h={},c,g;e.fields.forEach(function(p){if("classname"===p.name.toLowerCase()||"class_name"===p.name.toLowerCase())c=p.name;"value"===p.name.toLowerCase()&&(g=p.name)});e.features.forEach(function(p){p=p.attributes;h[p[g]]=c?p[c]:p[g]});return h},_getDefaultScientificColorRamp:function(){return{type:"multipart",
colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}].map(function(e){return{fromColor:e.toColor,toColor:e.fromColor}}).reverse()}}}})},"esri/layers/rasterLib/renderer/RasterColormapRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","./RasterRenderer","../function/ColormapFunction"],function(H,m,n,r){return H([n],{declaredClass:"esri.layers.rasterLib.renderer.RasterColormapRenderer",rendererName:"Colormap",
renderTexture:!0,constructor:function(l){l&&l.colormapInfos&&(l.colormap=l.colormapInfos.map(function(k){return[k.value].concat(k.color)}));this._function=new r(l);this._function.outputPixelType="U8";this._function.renderTexture=!0},draw2D:function(l){this._updateColormapParameters();l=this._clonePixelData(l);return l=this._function._colorize(l)},drawGL:function(l){this._updateColormapParameters();this._function._colorizeGL(l)},toJson:function(){var l=this._function.toJson().rasterFunctionArguments;
return{rendererName:this.rendererName,rendererArguments:l}},toCommonRendererJson:function(){return{type:"rasterColormap",colormapInfos:this.colormapInfos||this.colormap.map(function(l){return{value:l[0],color:l.slice(1),label:l[0]}})}},_updateColormapParameters:function(){var l=this._function.functionArguments;l.colormap=this.colormap;l.colormapName=this.colormapName;l.colorRamp=this.colorRamp;l.colorRampName=this.colorRampName}})})},"esri/layers/rasterLib/renderer/RasterRenderer":function(){define(["dojo/_base/declare",
"dojo/_base/lang","../../../geometry/Extent","../../PixelBlock"],function(H,m,n,r){return H(null,{declaredClass:"esri.layers.rasterLib.renderer.RasterRenderer",raster:null,constructor:function(l){l=l||{};this.raster=l.raster||l.Raster||this.raster;this.draw=m.hitch(this,this.draw);this.bind=m.hitch(this,this.bind);l=m.clone(l);Object.keys(l).forEach(function(k){null==l[k]&&delete l[k]});m.mixin(this,l)},bind:function(l){if(!l)throw"failed to bind without options";var k=l;l.layer&&(l=l.layer,k={id:l.id,
rawRasterInfo:l.raster.rasterInfo,glSetting:l._glSetting,xformSetting:l.tileManager&&l.tileManager.xformSetting,useWebGL:l.useWebGL,resampling:l.tileMode&&l.tileManager&&l.tileManager.xformSetting.requireProjection&&!l._hasTilingEffects&&"Thematic"!==l.raster.dataType?1:0,tileMode:l.tileMode});this._rawRasterInfo=k.rawRasterInfo;this.useWebGL=k.useWebGL;this._function&&this._function.setProcessingContext(m.mixin({useProcessedData:!0},k));this._processingContext=k},hasTilingEffects:function(){},draw:function(l){return this.useWebGL?
this.drawGL(l):this.draw2D(l)},toJson:function(){},_clonePixelData:function(l){if(null==l)return l;var k={};l.extent&&(k.extent=new n(l.extent.xmin,l.extent.ymin,l.extent.xmax,l.extent.ymax,l.extent.spatialReference));l=l.processedPixelBlock||l.pixelBlock;if(null==l)return k;k.pixelBlock=l.clone?l.clone():r.prototype.clone(l);return k}})})},"esri/layers/rasterLib/renderer/RasterUniqueValueRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","./RasterRenderer","../function/ColormapFunction",
"../../../renderers/colorRampGenerator"],function(H,m,n,r,l){return H([n],{declaredClass:"esri.layers.rasterLib.renderer.RasterUniqueValueRenderer",rendererName:"UniqueValue",field:"",alias:"",uniqueValueInfos:null,constructor:function(k){k&&k.colormap&&(this.colormap=k.colormap,this._function=new r(k),this._function.outputPixelType="U8",this._function.renderTexture=!0)},bind:function(k){this.inherited(arguments);if(!this._function){var b=(this.raster&&this.raster.rasterInfo||this._rawRasterInfo).vat;
if(!b)throw"uv renderer requires data source to have raster attribute table";var a=this.attributeField||this.field1||this.field,d=this.infos||this.uniqueValueInfos;this.defaultColor=this.defaultColor||this.defaultSymbol&&this.defaultSymbol.color;var f=b.fields.filter(function(t){return"value"===t.name.toLowerCase()})[0];if(f)var e=f.name;a||((a=b.fields.filter(function(t){return-1<["classname","category"].indexOf(t.name.toLowerCase())})[0])||(a=b.fields.filter(function(t){return"esriFieldTypeString"===
t.type})[0]),this.alias=(this.field=a=a&&a.name||e)&&a.alias||e);var h=[],c;if(!d){d=[];var g=b.fields.filter(function(t){return"alpha"===t.name.toLowerCase()})[0];var p=b.fields.filter(function(t){return"red"===t.name.toLowerCase()})[0];var q=b.fields.filter(function(t){return"green"===t.name.toLowerCase()})[0];var u=b.fields.filter(function(t){return"blue"===t.name.toLowerCase()})[0];for(f=0;f<b.features.length;f++){var v=b.features[f].attributes;(c=d.some(function(t){t.value===v[a]}))||(g&&p&&
q&&u?d.push({value:v[a],alias:v[a],color:[v[p.name],v[q.name],v[u.name],v[g.name]]}):p&&q&&u?d.push({value:v[a],alias:v[a],color:[v[p.name],v[q.name],v[u.name]]}):d.push({value:v[a],alias:v[a]}))}if(!(p&&q&&u))for(c=l.createRandomColorRamp({size:d.length}),f=0;f<d.length;f++)d[f].color=c[f];this.uniqueValueInfos=d}if(d)d.forEach(function(t){h=h.concat(b.features.filter(function(y){return t.value==y.attributes[a]}).map(function(y){return[y.attributes[e]].concat(t.color||t.symbol&&t.symbol.color)}))}),
this.defaultColor&&b.features.filter(function(t){h.some(function(y){return y[0]===t.attributes[e]})||h.push([t.attributes[e]].concat(this.defaultColor))});else throw"missing uniqueValueInfos property";this._function=new r({colormap:h});this.colormap=h;this._function.outputPixelType="U8";this._function.renderTexture=!0;this._function.setProcessingContext(this._processingContext)}},draw2D:function(k){k=this._clonePixelData(k);return k=this._function._colorize(k)},drawGL:function(k){this._function._colorizeGL(k)},
toJson:function(k){var b={field:this.field,uniqueValueInfos:this.uniqueValueInfos,defaultColor:this.defaultColor};k&&(b.colormap=this.colormap);return{rendererName:this.rendererName,rendererArguments:b}},toCommonRendererJson:function(){var k=this.attributeField||this.field1||this.field,b=(this.infos||this.uniqueValueInfos).map(function(a){return{value:a.value,label:a.alias+"",symbol:{color:3===a.color.length?a.color.concat([255]):a.color,type:"esriSFS",style:"esriSFSSolid"}}});return{type:"uniqueValue",
field1:k,uniqueValueInfos:b}}})})},"esri/layers/rasterLib/renderer/RasterRGBRenderer":function(){define("dojo/_base/declare dojo/_base/lang ./RasterRenderer ../function/StretchFunction ../function/ContrastBrightnessFunction ../function/rasterUtils".split(" "),function(H,m,n,r,l,k){return H([n],{declaredClass:"esri.layers.rasterLib.renderer.RasterRGBRenderer",rendererName:"RGB",bandIndex:null,stretchType:0,min:0,max:255,numberOfStandardDeviations:2,statistics:null,histograms:null,dra:!1,minPercent:.25,
maxPercent:.5,useGamma:!1,gamma:null,computeGamma:!1,sigmoidStrengthLevel:1,constructor:function(b){this.stretchType="number"===typeof this.stretchType?this.stretchType:"none   standardDeviation histogramEqualization minMax percentClip   sigmoid".split(" ").indexOf(this.stretchType);b=m.mixin({},b,{stretchType:this.stretchType});this._stretchFunction=new r(b);this._stretchFunction.outputPixelType="U8";this._stretchFunction.renderTexture=!1;this.bandIndex=b.bandIndex||b.BandIndex;this._function=new l(b);
this._function.functionArguments.raster=this._stretchFunction;this._function.renderTexture=!0},hasTilingEffects:function(){return this._stretchFunction.hasTilingEffects()},draw2D:function(b){this._updateStretchParameters();b=this._clonePixelData(b);if("U8"===b.pixelBlock.pixelType&&!this.contrastOffset&&!this.brightnessOffset)return b;this._stretchFunction._stretch(b);var a=b.pixelBlock,d=this.bandIndex,f=Math.max.apply(null,d);a&&a.pixels.length>f&&d&&(a.pixels=d.map(function(e){return a.pixels[e]}),
a.statistics&&(a.statistics=d.map(function(e){return a.statistics[e]})));if(this.contrastOffset||this.brightnessOffset)b.pixelBlock=k.contrastBrightnessStretch(b.pixelBlock,{contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset});return b},drawGL:function(b){this._updateStretchParameters();b.pixelBlock&&(b=this._clonePixelData(b));var a=b.pixelBlock,d=this.bandIndex,f=Math.max.apply(null,d),e=this.statistics&&0<this.statistics.length?this.statistics:this._stretchFunction&&this._stretchFunction.srcStatistics,
h=this.histograms&&0<this.histograms.length?this.histograms:this._stretchFunction&&this._stretchFunction.srcHistograms,c,g;a&&a.pixels.length>f&&d&&(a.pixels=d.map(function(p){return a.pixels[p]}),a.statistics&&(a.statistics=d.map(function(p){return a.statistics[p]})),e&&0<e.length&&e.length!==d.length&&(c=d.map(function(p){return e[p]})),h&&0<h.length&&h.length!==d.length&&(g=d.map(function(p){return h[p]})));this._stretchFunction.functionArguments.statistics=c||e;this._stretchFunction.functionArguments.histograms=
g||h;this.contrastOffset||this.brightnessOffset?(this._stretchFunction.renderTexture=!1,this._function.renderTexture=!0,b=this._stretchFunction._stretchGL(b),this._function._cbGL(b)):(this._stretchFunction.renderTexture=!0,this._stretchFunction._stretchGL(b))},toJson:function(){var b=this._stretchFunction.toJson().rasterFunctionArguments;b.bandIndex=this.bandIndex;b.contrastOffset=this.contrastOffset;b.brightnessOffset=this.brightnessOffset;return{rendererName:this.rendererName,rendererArguments:b}},
toCommonRendererJson:function(){return{type:"rasterStretch",stretchType:"none   standardDeviation histogramEqualization minMax percentClip   sigmoid".split(" ")[this.stretchType]||"minMax",min:this.min,max:this.max,numberOfStandardDeviations:this.numberOfStandardDeviations,statistics:m.clone(this.statistics),dra:this.dra,minPercent:this.minPercent,maxPercent:this.maxPercent,useGamma:this.useGamma,gamma:m.clone(this.gamma),computeGamma:this.computeGamma,sigmoidStrengthLevel:this.sigmoidStrengthLevel}},
_updateStretchParameters:function(){var b=this._stretchFunction.functionArguments;b.stretchType=this.stretchType;b.min=this.min;b.max=this.max;b.numberOfStandardDeviations=this.numberOfStandardDeviations;b.statistics=this.statistics;b.histograms=this.histograms;b.dra=this.dra;b.minPercent=this.minPercent;b.maxPercent=this.maxPercent;b.useGamma=this.useGamma;b.gamma=this.gamma;b.computeGamma=this.computeGamma;this._stretchFunction.interpolation=this.interpolation}})})},"esri/layers/rasterLib/renderer/RasterStretchColorRampRenderer":function(){define("dojo/_base/declare dojo/_base/lang ./RasterRenderer ../function/ResampleFunction ../function/StretchFunction ../function/ContrastBrightnessFunction ../function/ColormapFunction ../function/rasterUtils".split(" "),
function(H,m,n,r,l,k,b,a){return H([n],{declaredClass:"esri.layers.rasterLib.renderer.RasterStretchColorRampRenderer",rendererName:"Stretch",bandIndex:[0],colorRamp:null,invert:!1,stretchType:0,min:0,max:255,numberOfStandardDeviations:2,statistics:null,histograms:null,dra:!1,minPercent:.25,maxPercent:.5,useGamma:!1,gamma:null,computeGamma:!1,sigmoidStrengthLevel:1,constructor:function(d){this.stretchType="number"===typeof this.stretchType?this.stretchType:"none   standardDeviation histogramEqualization minMax percentClip   sigmoid".split(" ").indexOf(this.stretchType);
d=m.mixin({},d,{stretchType:this.stretchType});Object.keys(d).forEach(function(f){null==d[f]&&delete d[f]});this._function=new k(d);this._stretchFunction=new l(d);this._stretchFunction.outputPixelType="U8";this._stretchFunction.renderTexture=!1;this._clrFunction=new b(d);this._clrFunction.functionArguments.raster=this._stretchFunction;this._clrFunction.renderTexture=!1;this._function.functionArguments.raster=this._clrFunction},hasTilingEffects:function(){return this._stretchFunction.hasTilingEffects()},
draw2D:function(d){this._updateStretchParameters();d=this._clonePixelData(d);if("U8"===d.pixelBlock.pixelType&&!(this.contrastOffset||this.brightnessOffset||this.colorRamp))return d;this._stretchFunction._stretch(d);var f=d.pixelBlock,e=this.bandIndex?this.bandIndex[0]:0;f&&1<f.pixels.length&&f.pixels.length>e&&(f.pixels=[f.pixels[e]],f.statistics&&(f.statistics=[f.statistics[e]]));this.colorRamp&&(d=this._clrFunction._colorize(d));if(this.contrastOffset||this.brightnessOffset)d.pixelBlock=a.contrastBrightnessStretch(d.pixelBlock,
{contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset});return d},drawGL:function(d){this._updateStretchParameters();d.pixelBlock&&(d=this._clonePixelData(d));var f=d.pixelBlock,e=this.bandIndex?this.bandIndex[0]||0:0,h=this.statistics&&0<this.statistics.length?this.statistics:this._stretchFunction&&this._stretchFunction.srcStatistics,c=this.histograms&&0<this.histograms.length?this.histograms:this._stretchFunction&&this._stretchFunction.srcHistograms,g,p;f&&1<f.pixels.length&&
f.pixels.length>e&&(f.pixels=[f.pixels[e]],f.statistics&&(f.statistics=[f.statistics[e]]),h&&h.length>e&&(g=[h[e]]),c&&c.length>e&&(p=[c[e]]));this._stretchFunction.functionArguments.statistics=g||h;this._stretchFunction.functionArguments.histograms=p||c;f=!!this.colorRamp;this.contrastOffset||this.brightnessOffset?(this._stretchFunction.renderTexture=!1,this._clrFunction.renderTexture=!1,this._function.renderTexture=!0,d=this._stretchFunction._stretchGL(d),f&&(d=this._clrFunction._colorizeGL(d)),
this._function._cbGL(d)):f?(this._stretchFunction.renderTexture=!1,this._clrFunction.renderTexture=!0,d=this._stretchFunction._stretchGL(d),this._clrFunction._colorizeGL(d)):(this._stretchFunction.renderTexture=!0,this._stretchFunction._stretchGL(d))},toJson:function(){var d=this._stretchFunction.toJson().rasterFunctionArguments;d.colorRamp=this.colorRamp||"";this.invert&&(d.invert=!0);d.contrastOffset=this.contrastOffset;d.brightnessOffset=this.brightnessOffset;return{rendererName:this.rendererName,
rendererArguments:d}},toCommonRendererJson:function(){return{type:"rasterStretch",stretchType:"none   standardDeviation histogramEqualization minMax percentClip   sigmoid".split(" ")[this.stretchType]||"minMax",colorRamp:this.colorRamp&&this.colorRamp.toJson?this.colorRamp.toJson():this.colorRamp,min:this.min,max:this.max,numberOfStandardDeviations:this.numberOfStandardDeviations,statistics:m.clone(this.statistics),dra:this.dra,minPercent:this.minPercent,maxPercent:this.maxPercent,useGamma:this.useGamma,
gamma:m.clone(this.gamma),computeGamma:this.computeGamma,sigmoidStrengthLevel:this.sigmoidStrengthLevel}},_updateStretchParameters:function(){var d=this._stretchFunction.functionArguments;d.stretchType=this.stretchType;d.min=this.min;d.max=this.max;d.numberOfStandardDeviations=this.numberOfStandardDeviations;d.statistics=this.statistics;d.histograms=this.histograms;d.dra=this.dra;d.minPercent=this.minPercent;d.maxPercent=this.maxPercent;d.useGamma=this.useGamma;d.gamma=this.gamma;d.computeGamma=this.computeGamma;
this._stretchFunction.interpolation=this.interpolation}})})},"esri/layers/rasterLib/renderer/RasterClassBreaksRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","./RasterRenderer","../function/ColormapFunction","../function/RemapFunction"],function(H,m,n,r,l){return H([n],{declaredClass:"esri.layers.rasterLib.renderer.RasterClassBreaksRenderer",rendererName:"ClassBreaks",renderTexture:!0,constructor:function(k){k=k||{};this._function=new l(k);this._function.outputPixelType="U8";var b=
k.classBreakInfos;k=k.minValue;null!=k&&b&&(this._function.functionArguments.colorBreaks=this._getSortedColorBreaks(k,b))},bind:function(k){this.inherited(arguments);this.isColormapFunction=!1;var b=this.raster&&this.raster.rasterInfo||this._rawRasterInfo,a=b&&b.vat;if(a&&"u8"===b.pixelType.toLowerCase()&&this.classBreakInfos){var d=this.field;if(b=a.fields.filter(function(p){return"value"===p.name.toLowerCase()})[0])var f=b.name;var e=a.features.sort(function(p,q){return parseFloat(p.attributes[d])-
parseFloat(q.attributes[d])})[0].attributes[d];this.isColormapFunction=!0;var h=[],c=this.field,g=this.classBreakInfos;g.forEach(function(p,q){a.features.forEach(function(u){var v=g[q-1]&&g[q-1].classMaxValue||e;u.attributes[c]<=p.classMaxValue&&(u.attributes[c]>v||u.attributes[c]===e)&&(v=p.symbol.color,h.some(function(t){return t[0]===u.attributes[f]})||h.push([u.attributes[f]].concat(v)))})});this._function=new r({colormap:h});this.colormap=h;this._function.outputPixelType="U8";this._function.renderTexture=
!0}this._function&&this._function.setProcessingContext(m.mixin({useProcessedData:!0},this._processingContext))},draw2D:function(k){if(this.isColormapFunction)return this._updateColormapParameters(),k=this._clonePixelData(k),k=this._function._colorize(k);this._updateRemapParameters();return this._function._remap(k)},drawGL:function(k){this.isColormapFunction?(this._updateColormapParameters(),this._function._colorizeGL(k)):(this._function.renderTexture=!0,this._updateRemapParameters(),this._function._remapGL(k))},
toJson:function(){var k=this._function.toJson().rasterFunctionArguments;return{rendererName:this.rendererName,rendererArguments:k}},toCommonRendererJson:function(){var k,b=this.classBreakInfos,a=this.colorBreaks;if(null==b&&a)for(b=[],k=0;k<a.length-1;k++)b.push({classMaxValue:a[k+1].value,symbol:{color:a[k].mappedColor,type:"esriSFS",style:"esriSFSSolid"},label:a[k].value+" - "+a[k+1].value});return{type:"classBreaks",field:"Value",minValue:null!=this.minValue?this.minValue:a[0].value,classBreakInfos:b}},
_updateRemapParameters:function(){var k=this.classBreakInfos,b=this.minValue;null!=b&&k&&(this._function.functionArguments.colorBreaks=this._getSortedColorBreaks(b,k))},_getSortedColorBreaks:function(k,b){b=b.map(function(d){return{maxValue:d.classMaxValue,color:d.symbol.color}}).sort(function(d,f){return d.maxValue-f.maxValue});var a=[{value:k,mappedColor:b[0].color}];for(k=0;k<b.length;k++)a.push({value:b[k].maxValue,mappedColor:k===b.length-1?b[k].color:b[k+1].color});return a},_updateColormapParameters:function(){this._function.functionArguments.colormap=
this.colormap;this._function.interpolation=this.interpolation}})})},"esri/layers/rasterLib/renderer/RasterShadedReliefRenderer":function(){define("dojo/_base/declare dojo/_base/lang ./RasterRenderer ../function/HillshadeFunction ../function/ContrastBrightnessFunction ../function/ColormapFunction ../function/rasterUtils".split(" "),function(H,m,n,r,l,k,b){return H([n],{declaredClass:"esri.layers.rasterLib.renderer.RasterShadedReliefRenderer",rendererName:"ShadedRelief",hillshadeType:null,azimuth:315,
altitude:45,zFactor:1,slopeType:null,psPower:.664,psFactor:.024,raster:null,constructor:function(a){this.hillshadeType="number"===typeof this.hillshadeType?this.hillshadeType:["traditional","multi-directional"].indexOf(this.hillshadeType);a&&a.scalingType&&(this.slopeType="adjusted"===a.scalingType?3:1);a&&a.pixelSizePower&&(this.psPower=a.pixelSizePower);a&&a.pixelSizeFactor&&(this.psFactor=a.pixelSizeFactor);a=m.mixin({},a,{hillshadeType:this.hillshadeType,psPower:this.psPower,psFactor:this.psFactor,
slopeType:this.slopeType});Object.keys(a).forEach(function(d){null==a[d]&&delete a[d]});this._function=new l(a);this._hillshadeFunction=new r(a);this._hillshadeFunction.outputPixelType="U8";this._hillshadeFunction.renderTexture=!1;this._function.functionArguments.raster=this._hillshadeFunction},hasTilingEffects:function(){return this._hillshadeFunction.hasTilingEffects()},draw2D:function(a){this._updateHillshadeParameters();a=this._clonePixelData(a);a=this._hillshadeFunction.read2D({raster:a});if(this.contrastOffset||
this.brightnessOffset)a.pixelBlock=b.contrastBrightnessStretch(a.pixelBlock,{contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset});return a},drawGL:function(a){this._updateHillshadeParameters();this.contrastOffset||this.brightnessOffset?(this._hillshadeFunction.renderTexture=!1,this._function.renderTexture=!0,a=this._hillshadeFunction.readGL({raster:a}),this._function._cbGL(a)):(this._hillshadeFunction.renderTexture=!0,this._hillshadeFunction.readGL({raster:a}))},toJson:function(){var a=
this._hillshadeFunction.toJson().rasterFunctionArguments;a.colorRamp=this.colorRamp||"";this.invert&&(a.invert=!0);a.contrastOffset=this.contrastOffset;a.brightnessOffset=this.brightnessOffset;return{rendererName:this.rendererName,rendererArguments:a}},toCommonRendererJson:function(){return{type:"rasterShadedRelief",hillshadeType:["traditional","multi-directional"][this.hillshadeType]||"traditional",azimuth:this.azimuth,altitude:this.altitude,zFactor:this.zFactor,scalingType:3===this.slopeType?"adjusted":
"none",pixelSizePower:this.psPower,pixelSizeFactor:this.psFactor,colorRamp:this.colorRamp&&this.colorRamp.toJson?this.colorRamp.toJson():this.colorRamp}},_updateHillshadeParameters:function(){var a=this._hillshadeFunction.functionArguments;a.hillshadeType=this.hillshadeType;a.azimuth=this.azimuth;a.altitude=this.altitude;a.zFactor=this.zFactor;a.slopeType=this.slopeType;a.psPower=this.psPower;a.psFactor=this.psFactor}})})},"esri/layers/rasterLib/raster/rasterProjectionHelper":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/sniff ../../../kernel ../../../WKIDUnitConversion ../../../geometry/Extent ../../../geometry/projection ../../../geometry/webMercatorUtils ../../../SpatialReference ../../../geometry/Point".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e){H={requirePE:function(c,g){return!(c.equals(g)||c._canProject(g))},load:function(){var c=new n;if(!this._loadPromise)if(a.isSupported())this._loadPromise=a.load();else{var g=new n;g.reject("projection engine is not supported on this version of the browser, please try with a modern browser");this._loadPromise=g.promise}this._loadPromise.isFulfilled()?this._loadPromise.isResolved()?c.resolve():this._loadPromise.isRejected()&&c.resolve():(this._pendingdfds=this._pendingdfds||
[],this._pendingdfds.push(c),this._loadPromise.then(m.hitch(this,function(){this._pendingdfds.forEach(function(p){p.isFulfilled()||p.resolve()})}),m.hitch(this,function(){this._pendingdfds.forEach(function(p){p.isFulfilled()||p.reject()})})));return c.promise},computeError:function(c,g){return[Math.abs((c[0]+c[4]+c[4*g.rows]+c[4*g.rows+4])/4-c[2*g.rows+2]),Math.abs((c[1]+c[5]+c[4*g.rows+1]+c[4*g.rows+5])/4-c[2*g.rows+3])]},getDefaultDatumTransformationForDataset:function(c,g,p){if(!(g&&c.spatialReference&&
this.requirePE(c.spatialReference,g)&&a.isLoaded()))return null;c=new b(c.toJson());g=new f(g.toJson());return p?a.getTransformation(g,c.spatialReference,c):a.getTransformation(c.spatialReference,g,c)},project:function(c,g,p){if(!g||c.spatialReference.equals(g))return c;var q=a.isLoaded()?a:d;"esri.geometry.Extent"===c.declaredClass?c=new b(c.toJson()):"esri.geometry.Point"===c.declaredClass&&(c=new e(c.toJson()));g=new f(g.toJson());(c=q.project(c,g))&&"esri.geometry.Extent"===c.declaredClass?(c=
new b(c.toJson()),p&&(1E-5>Math.abs(c.xmin+180)&&1E-5>Math.abs(c.xmax-180)?(c.xmin=0,c.xmax=360):(0>c.xmin&&(c.xmin+=360,c.xmax+=360),0>c.xmax&&(c.xmax+=360)))):c&&"esri.geometry.Point"===c.declaredClass&&(c=new e(c.toJson()),p&&0>c.x&&(c.x+=360));return c},projectResolution:function(c,g,p){var q=p.xmin+(p.xmax-p.xmin)/2;p=p.ymin+(p.ymax-p.ymin)/2;c=new b(q,p,q+c.x,p+c.y,c.spatialReference);c=this.project(c,g);return new e(c.xmax-c.xmin,c.ymax-c.ymin,g)},getProjectionOffsetGrid:function(c,g,p,q,u,
v,t){null==t&&(t=[32,32]);var y=c.xmin,C=c.ymin,B=c.xmax,F=c.ymax,x=c.spatialReference,w=g.spatialReference,A=a.isLoaded()?a:d,z=u?-u:null,G=t[0]*p.x,J=t[1]*p.y;B={cols:Math.ceil((B-y)/G)+1,rows:Math.ceil((F-C)/J)+1};c=[];for(F=0;F<B.cols;F++){var L=R;var R=[];for(p=0;p<B.rows;p++){var T=new e({x:y+G*F,y:C+J*p,spatialReference:x});T=A.project(T,w,v);if(!T)return null;q&&0>T.x&&(T.x+=360);R.push(T);0<F&&null!=z&&T.x<L[p].x&&(T.x+=u-z,T.x<L[p].x&&(T.x+=u-z));c.push((T.x-g.xmin)/(g.xmax-g.xmin));c.push((T.y-
g.ymin)/(g.ymax-g.ymin))}}g=this.computeError(c,B);q=new Float32Array((B.cols-1)*(B.rows-1)*12);u=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]);v=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(F=0;F<B.cols-1;F++)for(p=0;p<B.rows-1;p++){G=F*B.rows*2+2*p;y=c[G];C=c[G+1];R=c[G+2];x=c[G+3];G+=2*B.rows;w=c[G];A=c[G+1];z=c[G+2];J=c[G+3];L=0;T=12*(p*(B.cols-1)+F);for(G=0;3>G;G++)q[T++]=u[L++]*y+u[L++]*R+u[L++]*z;for(G=L=0;3>G;G++)q[T++]=u[L++]*C+u[L++]*x+u[L++]*J;for(G=L=0;3>G;G++)q[T++]=v[L++]*y+v[L++]*w+v[L++]*
z;for(G=L=0;3>G;G++)q[T++]=v[L++]*C+v[L++]*A+v[L++]*J}return{offsets:c,error:g,coefficients:q,spacing:t,size:[B.cols-1,B.rows-1]}},getHalfWorldWidth:function(c){var g=c&&c.wkid;if(null!=g)return c.isWebMercator()&&(g=3857),null==k[g]?180:h[g]}};r("extend-esri")&&m.setObject("layers.rasterLib.raster.rasterProjectionHelper",H,l);var h={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,
32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,
54100:2.0037508342789244E7,54101:2.0037508342789244E7};return H})},"esri/geometry/projection":function(){define("require exports dojo/Deferred ./pe ../SpatialReference ./GeographicTransformation".split(" "),function(H,m,n,r,l,k){function b(h,c,g,p,q){void 0===p&&(p=null);void 0===q&&(q=!1);if(null===p){var u=k.cacheKey(c,g);void 0!==e[u]?p=e[u]:(p=a(c,g,null),null===p&&(p=new k),e[u]=p)}return d._project(h,c,g instanceof l||!1===q?g:new l(g),p,q)}function a(h,c,g){void 0===g&&(g=null);h=d._getTransformation(h,
c,g);return null!==h?k.fromGE(h):null}Object.defineProperty(m,"__esModule",{value:!0});var d=null;m.isLoaded=function(){return!!d&&r.isLoaded()};m.isSupported=function(){return r.isSupported()};var f=null;m.load=function(){if(f)return f.promise;f=new n;var h=r.load();H(["./geometryEngine"],function(c){d=c;h.then(function(){d._enableProjection(r);f.resolve()},function(g){f.reject(g)})});return f.promise};m.project=function(h,c,g){void 0===g&&(g=null);return h instanceof Array?0===h.length?[]:b(h,h[0].spatialReference,
c,g):b([h],h.spatialReference,c,g)[0]};var e={};m.projectMany=b;m.getTransformation=a;m.getTransformations=function(h,c,g){void 0===g&&(g=null);h=d._getTransformationBySuitability(h,c,g);if(null!==h){c=[];for(g=0;g<h.length;g++)c.push(k.fromGE(h[g]));return c}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","dojo/Deferred","../core/sniff"],function(H,m,n,r,l){function k(u){function v(B,F,x){B[F]=x(B[F])}m._pe=u;h.init();c.init();g.init();p.init();
q.init();m.PeGCSExtent=function(B){function F(){return null!==B&&B.apply(this,arguments)||this}n(F,B);F.prototype.destroy=function(){m._pe.destroy(this)};return F}(m._pe.PeGCSExtent);for(var t=0,y=[m._pe.PeDatum,m._pe.PeGeogcs,m._pe.PeGeogtran,m._pe.PeObject,m._pe.PeParameter,m._pe.PePrimem,m._pe.PeProjcs,m._pe.PeSpheroid,m._pe.PeUnit];t<y.length;t++)u=y[t],v(u.prototype,"getName",function(B){return function(){return B.call(this,Array(h.PE_NAME_MAX))}});t=0;for(y=[m._pe.PeGeogtran,m._pe.PeProjcs];t<
y.length;t++)u=y[t],v(u.prototype,"getParameters",function(B){return function(){for(var F=Array(h.PE_PARM_MAX),x=B.call(this),w=0;w<F.length;w++){var A=m._pe.getValue(x,"*");F[w]=A?m._pe.wrapPointer(A,m._pe.PeParameter):null;x+=Int32Array.BYTES_PER_ELEMENT}return F}});v(m._pe.PeHorizon.prototype,"getCoord",function(B){return function(){var F=this.getSize();if(!F)return null;var x=[],w=B.call(this);f(x,F,w);return x}});v(m._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(B){var F=m._pe._pe_getPeGTlistExtendedGTsSize();
return function(){var x=null,w=B.call(this);if(!m._pe.compare(w,m._pe.NULL)){x=[w];var A=this.getSteps();if(1<A){w=m._pe.getPointer(w);for(var z=1;z<A;z++)x.push(m._pe.wrapPointer(w+F*z,m._pe.PeGTlistExtendedGTs))}}return x}});var C=m._pe._pe_getPeHorizonSize();u=function(B){return function(){var F=this._cache;F||(this._cache=F=new Map);if(F.has(B))return F.get(B);var x=null,w=B.call(this);if(!m._pe.compare(w,m._pe.NULL)){x=[w];var A=w.getNump();if(1<A){w=m._pe.getPointer(w);for(var z=1;z<A;z++)x.push(m._pe.wrapPointer(w+
C*z,m._pe.PeHorizon))}}F.set(B,x);return x}};v(m._pe.PeProjcs.prototype,"horizonGcsGenerate",u);v(m._pe.PeProjcs.prototype,"horizonPcsGenerate",u);m._pe.PeObject.prototype.toString=function(B){void 0===B&&(B=h.PE_STR_OPTS_NONE);m._pe.ensureCache.prepare();var F=m._pe.getPointer(this),x=m._pe.ensureInt8(Array(h.PE_BUFFER_MAX));return m._pe.UTF8ToString(m._pe._pe_object_to_string_ext(F,B,x))}}function b(u){if(u){var v=m._pe.getClass(u);v&&(v=m._pe.getCache(v))&&(u=m._pe.getPointer(u))&&delete v[u]}}
function a(u,v){var t=[];v=Array(v);for(var y=0;y<u;y++)t.push(m._pe.ensureInt8(v));return t}function d(u){if(Array.isArray(u[0])){var v=[];u.forEach(function(t){v.push(t[0],t[1])})}else v=u;return v}function f(u,v,t,y){void 0===y&&(y=!1);if(y)for(y=0;y<2*v;y++)u[y]=m._pe.getValue(t+y*Float64Array.BYTES_PER_ELEMENT,"double");else{var C=0===u.length;for(y=0;y<v;y++)C&&(u[y]=Array(2)),u[y][0]=m._pe.getValue(t,"double"),u[y][1]=m._pe.getValue(t+Float64Array.BYTES_PER_ELEMENT,"double"),t+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(m,"__esModule",{value:!0});var e;m._pe=null;m.isLoaded=function(){return!!m._pe};m.isSupported=function(){return!!l("esri-wasm")};m.load=function(){if(e)return e.promise;e=new r;H(["./support/pe-wasm"],function(u){u({locateFile:function(v){return H.toUrl("./support/"+v)},onAbort:function(v){e.reject(Error(v))}}).then(function(v){k(v);e.resolve()})});return e.promise};(function(u){function v(C,B,F){m._pe.ensureCache.prepare();var x=d(F),w=F===x;x=m._pe.ensureFloat64(x);(C=m._pe._pe_geog_to_proj(m._pe.getPointer(C),
B,x))&&f(F,B,x,w);return C}function t(C,B,F){return y(C,B,F,0)}function y(C,B,F,x){m._pe.ensureCache.prepare();var w=d(F),A=F===w;w=m._pe.ensureFloat64(w);(C=m._pe._pe_proj_to_geog_center(m._pe.getPointer(C),B,w,x))&&f(F,B,w,A);return C}u.geogToProj=v;u.projGeog=function(C,B,F,x){switch(x){case h.PE_TRANSFORM_P_TO_G:return t(C,B,F);case h.PE_TRANSFORM_G_TO_P:return v(C,B,F)}return 0};u.projToGeog=t;u.projToGeogCenter=y})(m.PeCSTransformations||(m.PeCSTransformations={}));var h;(function(u){u.init=
function(){u.PE_BUFFER_MAX=m._pe.PeDefs.prototype.PE_BUFFER_MAX;u.PE_NAME_MAX=m._pe.PeDefs.prototype.PE_NAME_MAX;u.PE_MGRS_MAX=m._pe.PeDefs.prototype.PE_MGRS_MAX;u.PE_USNG_MAX=m._pe.PeDefs.prototype.PE_USNG_MAX;u.PE_DD_MAX=m._pe.PeDefs.prototype.PE_DD_MAX;u.PE_DDM_MAX=m._pe.PeDefs.prototype.PE_DDM_MAX;u.PE_DMS_MAX=m._pe.PeDefs.prototype.PE_DMS_MAX;u.PE_UTM_MAX=m._pe.PeDefs.prototype.PE_UTM_MAX;u.PE_PARM_MAX=m._pe.PeDefs.prototype.PE_PARM_MAX;u.PE_TYPE_NONE=m._pe.PeDefs.prototype.PE_TYPE_NONE;u.PE_TYPE_GEOGCS=
m._pe.PeDefs.prototype.PE_TYPE_GEOGCS;u.PE_TYPE_PROJCS=m._pe.PeDefs.prototype.PE_TYPE_PROJCS;u.PE_TYPE_GEOGTRAN=m._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;u.PE_TYPE_COORDSYS=m._pe.PeDefs.prototype.PE_TYPE_COORDSYS;u.PE_TYPE_UNIT=m._pe.PeDefs.prototype.PE_TYPE_UNIT;u.PE_STR_OPTS_NONE=m._pe.PeDefs.prototype.PE_STR_OPTS_NONE;u.PE_STR_AUTH_NONE=m._pe.PeDefs.prototype.PE_STR_AUTH_NONE;u.PE_STR_AUTH_TOP=m._pe.PeDefs.prototype.PE_STR_AUTH_TOP;u.PE_STR_NAME_CANON=m._pe.PeDefs.prototype.PE_STR_NAME_CANON;u.PE_PARM_X0=
m._pe.PeDefs.prototype.PE_PARM_X0;u.PE_PARM_ND=m._pe.PeDefs.prototype.PE_PARM_ND;u.PE_TRANSFORM_1_TO_2=m._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;u.PE_TRANSFORM_2_TO_1=m._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;u.PE_TRANSFORM_P_TO_G=m._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;u.PE_TRANSFORM_G_TO_P=m._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;u.PE_HORIZON_RECT=m._pe.PeDefs.prototype.PE_HORIZON_RECT;u.PE_HORIZON_POLY=m._pe.PeDefs.prototype.PE_HORIZON_POLY;u.PE_HORIZON_LINE=m._pe.PeDefs.prototype.PE_HORIZON_LINE;
u.PE_HORIZON_DELTA=m._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(h=m.PeDefs||(m.PeDefs={}));(function(u){function v(B,F){var x=null,w=y[B];w||(w={},y[B]=w);w.hasOwnProperty(String(F))?x=w[F]:(B=m._pe.PeFactory.prototype.factoryByType(B,F),m._pe.compare(B,m._pe.NULL)||(x=B,w[F]=x));return x=t(x)}function t(B){if(B){var F=B.getType();switch(F){case h.PE_TYPE_GEOGCS:B=m._pe.castObject(B,m._pe.PeGeogcs);break;case h.PE_TYPE_PROJCS:B=m._pe.castObject(B,m._pe.PeProjcs);break;case h.PE_TYPE_GEOGTRAN:B=m._pe.castObject(B,
m._pe.PeGeogtran);break;default:F&h.PE_TYPE_UNIT&&(B=m._pe.castObject(B,m._pe.PeUnit))}}return B}var y={},C={};u.initialize=function(){m._pe.PeFactory.prototype.initialize(null)};u.coordsys=function(B){return v(h.PE_TYPE_COORDSYS,B)};u.factoryByType=v;u.fromString=function(B,F){var x=null,w=C[B];w||(w={},C[B]=w);w.hasOwnProperty(F)?x=w[F]:(B=m._pe.PeFactory.prototype.fromString(B,F),m._pe.compare(B,m._pe.NULL)||(x=B,w[F]=x));return x=t(x)};u.geogcs=function(B){return v(h.PE_TYPE_GEOGCS,B)};u.geogtran=
function(B){return v(h.PE_TYPE_GEOGTRAN,B)};u.getCode=function(B){return m._pe.PeFactory.prototype.getCode(B)};u.projcs=function(B){return v(h.PE_TYPE_PROJCS,B)};u.unit=function(B){return v(h.PE_TYPE_UNIT,B)}})(m.PeFactory||(m.PeFactory={}));m.PeGCSExtent=null;var c;(function(u){var v;u.init=function(){u.PE_GTLIST_OPTS_COMMON=m._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;v=m._pe._pe_getPeGTlistExtendedEntrySize()};u.getGTlist=function(t,y,C,B,F,x){var w=null,A=new m._pe.PeInteger(x);try{var z=
m._pe.PeGTlistExtended.prototype.getGTlist(t,y,C,B,F,A);if(x=A.val)if(w=[z],1<x){var G=m._pe.getPointer(z);for(t=1;t<x;t++)w.push(m._pe.wrapPointer(G+v*t,m._pe.PeGTlistExtendedEntry))}}finally{m._pe.destroy(A)}return w}})(c=m.PeGTlistExtended||(m.PeGTlistExtended={}));(function(u){u.destroy=function(v){if(v&&v.length){for(var t=0;t<v.length;t++){var y=v[t];b(y);y.getEntries().forEach(function(C){b(C);C=C.getGeogtran();b(C);C.getParameters().forEach(b);[C.getGeogcs1(),C.getGeogcs2()].forEach(function(B){b(B);
var F=B.getDatum();b(F);b(F.getSpheroid());b(B.getPrimem());b(B.getUnit())})})}m._pe.PeGTlistExtendedEntry.prototype.Delete(v[0])}}})(m.PeGTlistExtendedEntry||(m.PeGTlistExtendedEntry={}));(function(u){u.geogToGeog=function(v,t,y,C,B){m._pe.ensureCache.prepare();var F=d(y),x=y===F;F=m._pe.ensureFloat64(F);var w=0;C&&(w=m._pe.ensureFloat64(C));(v=m._pe._pe_geog_to_geog(m._pe.getPointer(v),t,F,w,B))&&f(y,t,F,x);return v}})(m.PeGTTransformations||(m.PeGTTransformations={}));(function(u){function v(y,
C,B,F,x,w){m._pe.ensureCache.prepare();switch(y){case "dd":var A=m._pe._pe_geog_to_dd;var z=h.PE_DD_MAX;break;case "ddm":A=m._pe._pe_geog_to_ddm;z=h.PE_DDM_MAX;break;case "dms":A=m._pe._pe_geog_to_dms,z=h.PE_DMS_MAX}y=0;C&&(y=m._pe.getPointer(C));C=d(F);C=m._pe.ensureFloat64(C);z=a(B,z);F=m._pe.ensureInt32(z);if(x=A(y,B,C,x,F))for(A=0;A<B;A++)w[A]=m._pe.UTF8ToString(z[A]);return x}function t(y,C,B,F,x){m._pe.ensureCache.prepare();switch(y){case "dd":var w=m._pe._pe_dd_to_geog;break;case "ddm":w=m._pe._pe_ddm_to_geog;
break;case "dms":w=m._pe._pe_dms_to_geog}y=0;C&&(y=m._pe.getPointer(C));C=F.map(function(A){return m._pe.ensureString(A)});F=m._pe.ensureInt32(C);C=m._pe.ensureFloat64(Array(2*B));(w=w(y,B,F,C))&&f(x,B,C);return w}u.geog_to_dms=function(y,C,B,F,x){return v("dms",y,C,B,F,x)};u.dms_to_geog=function(y,C,B,F){return t("dms",y,C,B,F)};u.geog_to_ddm=function(y,C,B,F,x){return v("ddm",y,C,B,F,x)};u.ddm_to_geog=function(y,C,B,F){return t("ddm",y,C,B,F)};u.geog_to_dd=function(y,C,B,F,x){return v("dd",y,C,
B,F,x)};u.dd_to_geog=function(y,C,B,F){return t("dd",y,C,B,F)}})(m.PeNotationDms||(m.PeNotationDms={}));var g;(function(u){u.init=function(){u.PE_MGRS_STYLE_NEW=m._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;u.PE_MGRS_STYLE_OLD=m._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;u.PE_MGRS_STYLE_AUTO=m._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;u.PE_MGRS_180_ZONE_1_PLUS=m._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;u.PE_MGRS_ADD_SPACES=m._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};
u.geog_to_mgrs_extended=function(v,t,y,C,B,F,x){m._pe.ensureCache.prepare();var w=0;v&&(w=m._pe.getPointer(v));v=d(y);y=m._pe.ensureFloat64(v);v=a(t,h.PE_MGRS_MAX);var A=m._pe.ensureInt32(v);if(C=m._pe._pe_geog_to_mgrs_extended(w,t,y,C,B,F,A))for(B=0;B<t;B++)x[B]=m._pe.UTF8ToString(v[B]);return C};u.mgrs_to_geog_extended=function(v,t,y,C,B){m._pe.ensureCache.prepare();var F=0;v&&(F=m._pe.getPointer(v));v=y.map(function(x){return m._pe.ensureString(x)});y=m._pe.ensureInt32(v);v=m._pe.ensureFloat64(Array(2*
t));(C=m._pe._pe_mgrs_to_geog_extended(F,t,y,C,v))&&f(B,t,v);return C}})(g=m.PeNotationMgrs||(m.PeNotationMgrs={}));(function(u){u.geog_to_usng=function(v,t,y,C,B,F,x){m._pe.ensureCache.prepare();var w=0;v&&(w=m._pe.getPointer(v));v=d(y);y=m._pe.ensureFloat64(v);v=a(t,h.PE_MGRS_MAX);var A=m._pe.ensureInt32(v);if(C=m._pe._pe_geog_to_usng(w,t,y,C,B,F,A))for(B=0;B<t;B++)x[B]=m._pe.UTF8ToString(v[B]);return C};u.usng_to_geog=function(v,t,y,C){m._pe.ensureCache.prepare();var B=0;v&&(B=m._pe.getPointer(v));
v=y.map(function(F){return m._pe.ensureString(F)});y=m._pe.ensureInt32(v);v=m._pe.ensureFloat64(Array(2*t));(B=m._pe._pe_usng_to_geog(B,t,y,v))&&f(C,t,v);return B}})(m.PeNotationUsng||(m.PeNotationUsng={}));var p;(function(u){u.init=function(){u.PE_UTM_OPTS_NONE=m._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;u.PE_UTM_OPTS_ADD_SPACES=m._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;u.PE_UTM_OPTS_NS=m._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};u.geog_to_utm=function(v,t,y,C,B){m._pe.ensureCache.prepare();
var F=0;v&&(F=m._pe.getPointer(v));v=d(y);y=m._pe.ensureFloat64(v);v=a(t,h.PE_UTM_MAX);var x=m._pe.ensureInt32(v);if(C=m._pe._pe_geog_to_utm(F,t,y,C,x))for(F=0;F<t;F++)B[F]=m._pe.UTF8ToString(v[F]);return C};u.utm_to_geog=function(v,t,y,C,B){m._pe.ensureCache.prepare();var F=0;v&&(F=m._pe.getPointer(v));v=y.map(function(x){return m._pe.ensureString(x)});y=m._pe.ensureInt32(v);v=m._pe.ensureFloat64(Array(2*t));(C=m._pe._pe_utm_to_geog(F,t,y,C,v))&&f(B,t,v);return C}})(p=m.PeNotationUtm||(m.PeNotationUtm=
{}));var q;(function(u){var v=new Map;u.init=function(){u.PE_PCSINFO_OPTION_NONE=m._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;u.PE_PCSINFO_OPTION_DOMAIN=m._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;u.PE_POLE_OUTSIDE_BOUNDARY=m._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;u.PE_POLE_POINT=m._pe.PePCSInfo.prototype.PE_POLE_POINT};u.generate=function(t,y){void 0===y&&(y=u.PE_PCSINFO_OPTION_DOMAIN);var C;if(v.has(t)){var B=v.get(t);B[y]&&(C=B[y])}C||(C=m._pe.PePCSInfo.prototype.generate(t,
y),B||(B=[],v.set(t,B)),B[y]=C);return C}})(q=m.PePCSInfo||(m.PePCSInfo={}));(function(u){u.version_string=function(){return m._pe.PeVersion.prototype.version_string()}})(m.PeVersion||(m.PeVersion={}));m._init=k})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,n){m.__proto__=n}||function(m,n){for(var r in n)n.hasOwnProperty(r)&&(m[r]=n[r])};return function(m,n){function r(){this.constructor=
m}H(m,n);m.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()})},"esri/geometry/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(H,m,n){return function(){function r(l){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(l&&l.steps){var k=0;for(l=l.steps;k<l.length;k++){var b=l[k];b instanceof n?this.steps.push(b):this.steps.push(new n({wkid:b.wkid,wkt:b.wkt,isInverse:b.isInverse}))}}}r.cacheKey=
function(l,k){return[void 0!==l.wkid&&null!==l.wkid?l.wkid.toString():"-1",void 0!==l.wkt&&null!==l.wkt?l.wkt.toString():"",void 0!==k.wkid&&null!==k.wkid?k.wkid.toString():"-1",void 0!==k.wkt&&null!==k.wkt?k.wkt.toString():""].join()};r.fromGE=function(l){var k=new r,b="",a=0;for(l=l.steps;a<l.length;a++){var d=n.fromGE(l[a]);k.steps.push(d);b+=d.uid.toString()+","}k._cached_projection={};k._gtlistentry=null;k._chain=b;return k};r.prototype.getInverse=function(){var l=new r;l.steps=[];for(var k=
this.steps.length-1;0<=k;k--)l.steps.push(this.steps[k].getInverse());return l};r.prototype.getGTListEntry=function(){for(var l="",k=0,b=this.steps;k<b.length;k++)l+=b[k].uid.toString()+",";l!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=l);return this._gtlistentry};r.prototype.assignCachedGe=function(l,k,b){this._cached_projection[r.cacheKey(l,k)]=b};r.prototype.getCachedGeTransformation=function(l,k){for(var b="",a=0,d=this.steps;a<d.length;a++)b+=d[a].uid.toString()+
",";b!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=b);l=this._cached_projection[r.cacheKey(l,k)];return void 0===l?null:l};return r}()})},"esri/geometry/GeographicTransformationStep":function(){define(["require","exports"],function(H,m){var n=0;return function(){function r(l){void 0===l&&(l=null);this.uid=n++;l?(this._wkt=void 0!==l.wkt?l.wkt:null,this._wkid=void 0!==l.wkid?l.wkid:-1,this._isInverse=void 0!==l.isInverse?!0===l.isInverse:!1):(this._wkt=null,this._wkid=
-1,this._isInverse=!1)}r.fromGE=function(l){var k=new r;k._wkt=l.wkt;k._wkid=l.wkid;k._isInverse=l.isInverse;return k};Object.defineProperty(r.prototype,"wkt",{get:function(){return this._wkt},set:function(l){this._wkt=l;this.uid=n++},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"wkid",{get:function(){return this._wkid},set:function(l){this._wkid=l;this.uid=n++},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"isInverse",{get:function(){return this._isInverse},
set:function(l){this._isInverse=l;this.uid=n++},enumerable:!0,configurable:!0});r.prototype.getInverse=function(){var l=new r;l._wkt=this.wkt;l._wkid=this._wkid;l._isInverse=!this.isInverse;return l};return r}()})},"esri/layers/rasterLib/raster/TileServiceRaster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/_base/json dojo/sniff dojo/DeferredList dojo/when ../../../kernel ../../../Evented ../../../request ../../../geometry/Extent ../../../geometry/Point ../../../SpatialReference ../../../deferredUtils ../../../urlUtils ../../PixelBlock ../../rasterFormats/rasterCodec ../tile/RasterTileInfo ./RasterInfo ./BasicRaster".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F){H=m([F],{declaredClass:"esri.layers.rasterLib.raster.TileServiceRaster",constructor:function(x){},open:function(){var x=new r,w=this.serviceInfo||this._getServiceInfo(null),A=n.hitch(this,function(G){this.serviceInfo=G;this.version=G.currentVersion;this.rasterInfo=this._parseRasterInfo(G);this.loaded=!0;this._getRasterIdentifier();x.resolve(this)}),z=n.hitch(this,function(G){this.loaded=!0;this._getRasterIdentifier();x.reject(G)});f(w,A,z);return x.promise},
read:function(x){var w=this.url+"/tile/"+x.level+"/"+x.row+"/"+x.col,A={width:this.tileInfo.cols,height:this.tileInfo.rows,planes:null,pixelType:null,format:null,decodeFunc:null,isPoint:"elevation"===this.tileType.toLowerCase()?!0:!1};return this._requestPixels({url:w+(this.disableClientCaching?"?_ts\x3d "+(new Date).getTime():""),payload:{},decodeParams:A,tileOptions:x})},identify:function(x,w){null==w&&(w=this.tileInfo.lods[this.tileInfo.lods.length-1].level);var A=(x.x-this.tileInfo.origin.x)/
this.tileInfo.lods[w].resolution/this.tileInfo.cols;x=(this.tileInfo.origin.y-x.y)/this.tileInfo.lods[w].resolution/this.tileInfo.rows;var z=Math.floor(A),G=Math.floor(x),J=Math.floor((A-z)*this.tileInfo.cols);J=Math.min(J,this.tileInfo.cols-1);var L=Math.floor((x-G)*this.tileInfo.rows);L=Math.min(L,this.tileInfo.rows-1);var R=new r;this.read({level:w,row:G,col:z}).then(function(T){var aa=L*T.width+J;T&&T.pixels&&0<T.pixels.length?(T=T.mask?T.mask[aa]?T.pixels.map(function(ca){return ca[aa]}):null:
T.pixels.map(function(ca){return ca[aa]}),R.resolve(T)):R.reject("no valid data")},function(T){R.reject(T)});return R.promise},setFetchParameters:function(x,w){},_getRasterIdentifier:function(){this._rasterId||(this._rasterId=this.url.replace("http:","").replace("https:",""));return this._rasterId},_getServiceInfo:function(){var x=this.url,w=new r(u._dfdCanceller);w._pendingDfd=c({url:x,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});w._pendingDfd.then(function(A){w.callback(A)},
function(A){w.errback(A)});return w},_parseRasterInfo:function(x){var w=new B;w.extent=new g(x.fullExtent);w.spatialReference=new q(x.spatialReference);this.tileType=x.cacheType||"Map";switch(this.tileType){case "Map":w.bandCount=3;w.pixelType="U8";this.dataType="Processed";break;case "Elevation":w.bandCount=1;w.pixelType=x.pixelType||"F32";this.dataType="Elevation";break;case "Raster":w.bandCount=null,w.pixelType=null,this.dataType=x.serviceDataType&&x.serviceDataType.replace("esriImageServiceDataType",
"")||"Generic"}var A=x.tileInfo;w.width=Math.floor((x.fullExtent.xmax-x.fullExtent.xmin)/A.lods[A.lods.length-1].resolution+.5);w.height=Math.floor((x.fullExtent.ymax-x.fullExtent.ymin)/A.lods[A.lods.length-1].resolution+.5);w.cellSize=new p({x:A.lods[A.lods.length-1].resolution,y:A.lods[A.lods.length-1].resolution,spatialReference:x.spatialReference});this.tileInfo=new C(A);this.tileInfo.tileType=this.tileType;return w}});a("extend-esri")&&n.setObject("layers.rasterLib.raster.TileServiceRaster",
H,e);return H})},"esri/layers/rasterLib/raster/TileRaster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/_base/json dojo/sniff dojo/DeferredList dojo/when ../../../kernel ../../../Evented ../../../request ../../../geometry/Extent ../../../geometry/Point ../../../SpatialReference ../../../deferredUtils ../../../urlUtils ../../PixelBlock ../../rasterFormats/rasterCodec ../tile/RasterTileInfo ./RasterInfo ./BasicRaster".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F){H=m([F],{declaredClass:"esri.layers.rasterLib.raster.TileRaster",sourceType:"TileCache",_RECORD_SIZE:8,constructor:function(x){this._cloudBlobStorage=x&&x._cloudBlobStorage},open:function(){var x=new r,w=this.datasetInfo||this._getDatasetInfo(null),A=n.hitch(this,function(G){this.datasetInfo=G;this.rasterInfo=G=this._parseRasterInfo(G);this.tileType="Cache/LERC"===G.format?"Elevation":"Cache/MIXED"===G.format||"Cache/JPEG"===G.format||"Cache/PNG"===
G.format?"Map":"Raster";this.tileInfo=G.tileInfo;this.dataType=["Generic","Elevation","Processed"][["Raster","Elevation","Map"].indexOf(this.tileType)];this._HEADER_SIZE=G.packetSize*G.packetSize*this._RECORD_SIZE+64;this.loaded=!0;this._cloudBlobStorage=this._cloudBlobStorage||-1<this.url.toLowerCase().indexOf("s3.amazonaws.com")||-1<this.url.toLowerCase().indexOf("windows.net")||-1<this.url.toLowerCase().indexOf("googleapis.com");this._getRasterIdentifier();x.resolve(this)}),z=n.hitch(this,function(G){this.loaded=
!0;this._getRasterIdentifier();x.reject(G)});f(w,A,z);return x.promise},read:function(x){var w=new r,A=x.level,z=x.row,G=x.col,J=this._buildCacheFilePath(this.url,A,z,G),L=this._getIndexRecordFromBundle(A,z,G);c({url:J,content:{},headers:{Range:"bytes\x3d0-"+(this._HEADER_SIZE-1).toString()},handleAs:"arraybuffer"}).then(n.hitch(this,function(R,T){if(!w.isCanceled()){console.log("time in ms request "+(new Date-aa));var aa=new Date;R=new Uint8Array(R);R=this._getTileEndAndContentType(R,L);T={width:this.tileInfo.cols,
height:this.tileInfo.rows,planes:null,pixelType:null,format:null,decodeFunc:null,isPoint:"elevation"===this.tileType.toLowerCase()?!0:!1};this._requestPixels({url:J+(this.disableClientCaching?"?_ts\x3d "+(new Date).getTime():""),payload:{},headers:{Range:"bytes\x3d"+R.position.toString()+"-"+(R.position+R.recordSize).toString()},decodeParams:T,tileOptions:x}).then(function(ca){w.isCanceled()||w.resolve(ca)},function(ca){w.isCanceled()||w.reject(ca)})}}));return w.promise},identify:function(){return null},
setFetchParameters:function(x,w){},toJson:function(){return{url:this.url,tileInfo:this.tileInfo.toJson(),rasterInfo:this.rasterInfo.toJson(),datasetInfo:this.datasetInfo,sourceType:this.sourceType,tileType:this.tileType,_rasterId:this._rasterId}},_getDatasetInfo:function(){return c({url:this.url+"/conf.json",handleAs:"json",content:{}})},_parseRasterInfo:function(x){var w=new B;switch(x.pixelType){case 1:var A="U1";break;case 1:A="U2";break;case 2:A="U4";break;case 3:A="U8";break;case 4:A="S8";break;
case 5:A="U16";break;case 6:A="S16";break;case 7:A="U32";break;case 8:A="S32";break;case 9:A="F32";break;default:A="F32"}var z,G=[],J=x.LODInfos;for(z=0;z<J.levels.length;z++)G.push({level:J.levels[z],resolution:J.resolutions[z],scale:96/.0254*J.resolutions[z]});z=new q(x.extent.spatialReference||x.geodataXform.spatialReference);G=new C({rows:x.blockHeight,cols:x.blockWidth,dpi:96,format:x.format,compressionQuality:0,origin:x.origin,spatialReference:z,lods:G});w.pixelType=A;w.bandCount=x.bandCount;
w.spatialReference=z;w.extent=new g({xmin:x.extent.xmin,ymin:x.extent.ymin,xmax:x.extent.xmax,ymax:x.extent.ymax,spatialReference:z});w.cellSize=new p({x:x.pixelSizeX,y:x.pixelSizeY,spatialReference:z});w.width=Math.floor((w.extent.xmax-w.extent.xmin)/w.cellSize.x+.5);w.height=Math.floor((w.extent.ymax-w.extent.ymin)/w.cellSize.y+.5);w.statistics=x.statistics.map(function(L){Object.keys(L).forEach(function(R){isNaN(L[R])&&(L[R]=null)});return L});w.histograms=x.histograms;w.geodataXform=x.geodataXform;
w.packetSize=x.packetSize;w.format=x.format;w.compressionQuality=x.compressionQuality;w.tileInfo=G;return w},_getRasterIdentifier:function(){this._rasterId||(this._rasterId=this.url.replace("http:","").replace("https:",""));return this._rasterId},_buildCacheFilePath:function(x,w,A,z){var G=this.rasterInfo.packetSize;z=Math.floor(z/G)*G;A="R"+this._toHexString4(Math.floor(A/G)*G)+"C"+this._toHexString4(z);G="L";G=10<=w?G+w.toString():G+("0"+w.toString());return this._cloudBlobStorage?x+"/_alllayers/"+
G+"/"+A+".bundle":x+"/"+G+"_"+A+"/bundle"},_getIndexRecordFromBundle:function(x,w,A){x=this.rasterInfo.packetSize;w=w%x*x+A%x;if(0>w)throw"Invalid level / row / col";return w*this._RECORD_SIZE+64},_getTileEndAndContentType:function(x,w){x=x.subarray(w,w+8);w=0;var A;for(A=0;5>A;A++)w|=(x[A]&255)<<8*A;var z=w&0xffffffffff;w=0;for(A=5;8>A;A++)w|=(x[A]&255)<<8*(A-5);return{position:z,recordSize:w&0xffffffffff}},_toHexString4:function(x){x=x.toString(16);if(4!=x.length)for(var w=4-x.length;0<w--;)x="0"+
x;return x}});a("extend-esri")&&n.setObject("layers.rasterLib.raster.TileRaster",H,e);return H})},"esri/layers/rasterLib/raster/FunctionRaster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/_base/json dojo/sniff ../DeferredList2 dojo/when ../../../kernel ../../../Evented ../../../request ../../../deferredUtils ../../../geometry/Extent ../../../geometry/Point ../../../SpatialReference ../../../deferredUtils ../../../urlUtils ../../rasterFormats/rasterCodec ./RasterInfo ./BasicRaster ../../rasterLib/function/rasterFunctionHelper".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F){H=m([B],{declaredClass:"esri.layers.rasterLib.raster.FunctionRaster",rasterFunction:null,sourceType:"Function",constructor:function(x){x&&x.rasterFx&&this._init(x.rasterFx,x.rasterFxArgs)},open:function(){var x=this.getMemberRasters().map(function(A){return A.open()});this.identifiers=this.getMemberRasters().map(function(A){return A._rasterId});var w=new r;(new d(x,null,null,!0)).then(function(A){A.some(function(z){return!z[0]})?w.reject(A):
(this.rasterFunction.bind(),this.rasterInfo=this.rasterFunction.rasterInfo,this.dataType=this.rasterInfo.keyProperties&&this.rasterInfo.keyProperties.DataType||"Generic",this.tileInfo=A[0][1].tileInfo,w.resolve(this))}.bind(this));return w.promise},getProjectedFullExtent:function(x){var w=new r;this.getMemberRasters()[0].getProjectedFullExtent(x).then(n.hitch(this,function(A){this.projectedFullExtent=A;w.resolve(A)}));return w.promise},setProcessingContext:function(x){var w=x;x.layer&&(x=x.layer,
w={id:x.id,rawRasterInfo:x.raster.rasterInfo,glSetting:x._glSetting,xformSetting:x.tileManager&&x.tileManager.xformSetting,useWebGL:x.useWebGL,resampling:x.tileMode&&x.tileManager&&x.tileManager.xformSetting.requireProjection&&!x._hasTilingEffects&&"Thematic"!==x.raster.dataType?1:0,tileMode:x.tileMode});this.rasterFunction.setProcessingContext(w);this._layerOptions=w},alterDefinition:function(x){if(x=x||this.rasterFunction)1===this.memberRasters.length&&!x._bindComplete&&(this.rasterFunction=F.create(x,
{raster:this.memberRasters[0]}))&&(this.rasterFunction.bind(),this.rasterInfo=this.rasterFunction.rasterInfo,this.dataType=this.rasterInfo.keyProperties&&this.rasterInfo.keyProperties.DataType||"Generic",this.rasterFunction.setProcessingContext(this._layerOptions)),this._rasterHandler&&this._rasterHandler._connected&&this.rasterFunction&&this._rasterHandler.setRasterFunction({layerId:this._layerOptions.id,data:this.rasterFunction.toJson(!0)})},setFetchParameters:function(x,w){var A=this.getMemberRasters();
A&&1===A.length&&A[0].setFetchParameters(x,w)},getMemberRasters:function(){this.memberRasters||(this.memberRasters=[],this._getMemberRasters(this.rasterFunction.functionArguments,this.memberRasters));return this.memberRasters},read:function(x){var w=new r(g._dfdCanceller);if(x.src){var A=this.rasterFunction.read(x);w.resolve(A);return w.promise}var z=this.getMemberRasters().map(function(R){return R.read(x)});z=new d(z);var G,J,L=this.identifiers;w._pendingDfd=z;z.then(n.hitch(this,function(R){if(G=
R.some(function(T){return T[0]}))J={},R.forEach(function(T,aa){J[L[aa]]=T[0]?T[1]:null});A=J?this.rasterFunction.read({extent:x.extent,src:J}):null;A.srcData=J;w.resolve(A)}));return w},_init:function(x,w){if(this.rasterFunction=F.create(x,w))this.rasterFunction._bindComplete=!0;else throw"Cannot initialize a function raster without a raster function";},_getMemberRasters:function(x,w){var A=Object.keys(x),z,G,J;for(z=0;z<A.length;z++)if(J=x[A[z]]){var L=J instanceof Array?J:[J];for(G=0;G<L.length;G++)(J=
L[G])&&("function"===typeof J||"object"===typeof J)&&J.read&&(J.functionArguments?this._getMemberRasters(J.functionArguments,w):J.sourceType&&"Function"!==J.sourceType&&(J._identifier=J._getRasterIdentifier(),w.some(function(R){return R._identifier===J._identifier})||w.push(J)))}return w}});a("extend-esri")&&n.setObject("layers.rasterLib.raster.FunctionRaster",H,e);return H})},"esri/layers/rasterLib/DeferredList2":function(){define(["dojo/DeferredList"],function(H){return function(m,n,r,l,k){this.list=
m;n=new H(m,n,r,l,k);var b=n.resolve.bind(n),a=n.cancel.bind(n);n.cancel=function(){m&&m.forEach(function(d){d.cancel&&d.cancel()});a.apply(this,arguments)}.bind(n);n.resolve=function(){this.isFulfilled()||b.apply(this,arguments)}.bind(n);return n}})},"esri/layers/rasterLib/tile/RasterTileManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/when ../DeferredList2 ../../../geometry/Extent ../../../SpatialReference ../../../geometry/Point ../../PixelBlock ./RasterTileInfo ../raster/rasterProjectionHelper".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e){var h=function(c,g){var p;for(p=0;p<c.length;p++)if(g(c[p]))return p;return-1};return H(null,{declaredClass:"esri.layers.rasterLib.tile.RasterTileManager",count:null,fullBoundary:null,tileBoundary:null,tiles:null,resolution:null,virtual:!0,prefetchBufferSize:0,_progressiveGlobal:!1,_MAX_TILES:128,_defaultMatrixResolution:20,constructor:function(c){this.tiles=[];this.xformSetting={};this.mapSpatialReference=c&&c.mapSR;this.layer=c&&c.layer;this.identifiers=this.layer.raster.rasterFunction?
this.layer.raster.getMemberRasters().map(function(g){return g._rasterId}):[this.layer.raster._rasterId];(c=c&&c.tileInfo)&&this.setTileInfo(c)},setTileInfo:function(c){this.tileInfo=c;this.virtual=c.virtual;this.mapResolution=null;this.tiles.length=0;this.xformSetting.requireProjection=!this.virtual&&!this.mapSpatialReference.equals(this.tileInfo.spatialReference);this.xformSetting.requirePE=e.requirePE(this.mapSpatialReference,this.tileInfo.spatialReference);this.xformSetting.meshSize=this.xformSetting.requireProjection?
[this._defaultMatrixResolution,this._defaultMatrixResolution]:[1,1];this.halfWorldWidth=e.getHalfWorldWidth(c.spatialReference)},updateResolution:function(c,g){if(!(this.mapResolution&&c&&this._resolutionEqual(this.mapResolution.x,c.x)&&this._resolutionEqual(this.mapResolution.y,c.y))){this.resetTiles();var p=this.xformSetting.requireProjection;this.mapResolution=this.resolution=c;p&&(this.resolution=e.projectResolution(c,this.tileInfo.spatialReference,this.layer.projectedFullExtent||g));this._resolution=
this.resolution;c=this.resolution;if(!this.tileInfo.virtual){p=.75*Math.min(c.x,c.y)+.25*Math.max(c.x,c.y);if(p>=this.tileInfo.lods[0].resolution){var q=this.tileInfo.lods[0];this.ooe=!0}else{if(p<=this.tileInfo.lods[this.tileInfo.lods.length-1].resolution)q=this.tileInfo.lods[this.tileInfo.lods.length-1];else for(c=0;c<this.tileInfo.lods.length-1;c++)if(q=this.tileInfo.lods[c],g=this.tileInfo.lods[c+1],q.resolution>=p&&g.resolution<=p){q.resolution-p>p-g.resolution&&(q=g);break}this.ooe=!1}this.level=
q&&q.level;c=this.resolution=new a({x:q.resolution,y:q.resolution,spatialReference:this.tileInfo.spatialReference})}p=this.layer.raster.rasterInfo.extent;q=this.tileInfo.origin;g=this.tileInfo.cols;var u=this.tileInfo.rows;this.fullBoundary={rowStart:Math.floor((q.y-p.ymax)/c.y/u),rowEnd:Math.floor((q.y-p.ymin-c.y)/c.y/u),colStart:Math.floor((p.xmin-q.x)/c.x/g),colEnd:Math.floor((p.xmax-q.x-c.x)/c.x/g)};if(p=this.halfWorldWidth){u=Math.ceil(p/c.x/(g/2));var v=this.tileInfo.applyGCS360Transform?360:
p,t=Math.round(g-(v-q.x)/c.x%g);t===g&&(t=0);this.fullBoundary.colRange=u;this.fullBoundary.paddingRight=t;this.fullBoundary.paddingLeft=Math.round((u*g*c.x+q.x-v-(this.tileInfo.applyGCS360Transform?0:q.x+p))/c.x)}this.hasNewData=!0}},getXformGrid:function(){var c=this.mapExtent,g=this.layer._hasTilingEffects?this.extent:this.fullExtent,p=this.layer.getCurrentResolution(),q=JSON.stringify(c.toJson())+JSON.stringify(g.toJson());this._datumTransformationInitialized||(this._datumTransformationInitialized=
!0,this._datumTransformation=e.getDefaultDatumTransformationForDataset(this.layer.raster.rasterInfo.extent,c.spatialReference,!0));this._cachedExtentString&&this._cachedExtentString===q||(this._cachedExtentString=q,this._xformGrid=c=e.getProjectionOffsetGrid(c,g,p,this.tileInfo.applyGCS360Transform,this.halfWorldWidth,this._datumTransformation));c=this._xformGrid;this.xformSetting.meshSize=c&&c.size;return c},getWrapTimes:function(c){var g=e.getHalfWorldWidth(c.spatialReference);if(!g)return 0;var p=
2*g;g=this.tileInfo.applyGCS360Transform?0:-g;return Math.floor((c.xmax-g)/p)-Math.floor((c.xmin-g)/p)},normalizeCoordinate:function(c,g){if(!g)return 0;var p=2*g;if(0<c){for(;c>g;)c-=p;return c}for(;c<-g;)c+=p;return c},resetTiles:function(){this.tiles.forEach(m.hitch(this,function(c){c.fetch&&!c.fetch.isCanceled()&&c.fetch.cancel();c.update&&!c.update.isCanceled()&&c.update.cancel()}));this.tiles.length=0},updateExtent:function(c,g){this.mapExtent=this.extent=c;var p=this.xformSetting.requireProjection;
if(p){this.extent=e.project(c,this.tileInfo.spatialReference,this.tileInfo.applyGCS360Transform);if(!this.extent)return;this.extent.spatialReference=new b(this.extent.spatialReference.toJson())}else if(c.spatialReference.isWebMercator()||4326===c.spatialReference.wkid){var q=4326===c.spatialReference.wkid?180:this.halfWorldWidth,u=c.xmin;if(u<-q||u>q){for(var v=c.xmax,t=2*q;u<-q;)u+=t,v+=t;for(;u>q;)u-=t,v-=t;this.mapExtent=this.extent=c=new k(u,c.ymin,v,c.ymax,c.spatialReference)}}this.updateResolution(g,
c);q=this.extent;u=this.tileInfo;v=u.cols;t=u.rows;g=this.resolution;var y=q;p=p?this.layer.raster.rasterInfo.extent:this.layer.raster.projectedFullExtent;this.ooe&&(y=this._getIntersect(q,p));var C=Math.floor((y.xmin-u.origin.x)/g.x/v)-this.prefetchBufferSize,B=Math.floor((y.xmax-u.origin.x)/g.x/v)+this.prefetchBufferSize,F=null,x=this.getWrapTimes(c),w=this.fullBoundary&&this.fullBoundary.colRange;x&&this.halfWorldWidth&&(B===C&&(F=C),B+=x*w);if(c=this.halfWorldWidth&&this.tiles.length&&(x!==this.wrapTimes||
F!==this._circlularColId))this._wrapSwitchCount=this._wrapSwitchCount?this._wrapSwitchCount+1:1;this.wrapTimes=x;this._circlularColId=F;var A=Math.floor((u.origin.y-y.ymax)/g.y/t)-this.prefetchBufferSize;F=Math.floor((u.origin.y-y.ymin)/g.y/t)+this.prefetchBufferSize;this.tileBoundary={rowStart:A,rowEnd:F,colStart:C,colEnd:B};var z,G;((y=(F-A+1)*(B-C+1)>this._MAX_TILES||!this.virtual&&this._resolution.x>8*this.tileInfo.lods[0].resolution)||2<x||c)&&this.resetTiles();if(!(y||2<x)){y=this.tiles;c=!1;
for(z=y.length-1;0<=z;z--){var J=y[z].row;var L=y[z].wrapCol;if(J<A||J>F||L<C||L>B)y[z].fetch&&!y[z].fetch.isCanceled()&&y[z].fetch.cancel(),y[z].update&&!y[z].update.isCanceled()&&y[z].update.cancel(),y.splice(z,1),c=!0}for(z=A;z<=F;z++)for(G=C;G<=B;G++){A=new k(u.origin.x+g.x*v*G,u.origin.y-g.y*t*(z+1),u.origin.x+g.x*v*(G+1),u.origin.y-g.y*t*z,q.spatialReference);var R=x&&w?0<=G?G%w:w- -G%w:G;J=h(y,function(T){return T.row===z&&T.col===R&&T.wrapCol===G});L=p.xmax>=A.xmax?v:Math.round((p.xmax-A.xmin)/
g.x);-1===J&&(y.push({row:z,col:R,wrapCol:G,cellsizeX:g.x,cellsizeY:g.y,width:v,height:t,actualWidth:L,extent:A,normalizedExtent:this._wrapExtent(A,R),pixelBlock:null,virtual:this.virtual,level:this.level,tileType:this.tileInfo.tileType||"Raster"}),c=!0)}c&&this._sortTiles();g=this.tileInfo.rows*(this.tileBoundary.rowEnd-this.tileBoundary.rowStart+1);this.width=this.tileInfo.cols*(this.tileBoundary.colEnd-this.tileBoundary.colStart+1);this.height=g;this.count=y.length;g=Math.min.apply(null,y.map(function(T){return T.extent.xmin}));
u=Math.max.apply(null,y.map(function(T){return T.extent.xmax}));v=Math.min.apply(null,y.map(function(T){return T.extent.ymin}));t=Math.max.apply(null,y.map(function(T){return T.extent.ymax}));g=this.fullExtent=new k(g,v,u,t,q.spatialReference);if(this.layer.roaming||this.layer.useWebGL)this.layer._hasTilingEffects?(this.xformSetting.offset=[0,0],this.xformSetting.scale=[1,1]):(c&&(this._tilesChanged=!0),this.xformSetting.offset=[(q.xmin-g.xmin)/(g.xmax-g.xmin),-(g.ymin-q.ymin)/(g.ymax-g.ymin)],this.xformSetting.scale=
[(q.xmax-q.xmin)/(g.xmax-g.xmin),(q.ymax-q.ymin)/(g.ymax-g.ymin)])}},fetchTiles:function(c){(this._tilesChanged||c)&&this._fetchTiles(c)},_fetchTiles:function(c){this._fetchCounter=0;var g=this.extent;this.fetchAllCompleted=c?new n:null;(this._tilesChanged||c&&this.layer._hasTilingEffects)&&this.tiles.forEach(m.hitch(this,function(q){q.updateCompleted=!1}));var p={};!this.layer.roaming&&this.layer._hasTilingEffects&&c?(this.identifiers.forEach(function(q,u){p[q]={extent:this.extent,pixelBlock:new d({width:this.layer._map.width,
height:this.layer._map.height,pixels:[],pixelType:"",mask:null,statistics:[]})}}.bind(this)),this.originalPixelData={extent:this.extent,src:p,isEmpty:!0}):this._tilesChanged&&(this.identifiers.forEach(function(q,u){p[q]={extent:this.fullExtent,pixelBlock:new d({width:128,height:128,pixels:[],pixelType:"",mask:null,statistics:[]})}}.bind(this)),this.originalPixelData={extent:this.fullExtent,src:p,isEmpty:!0});this.tiles.forEach(m.hitch(this,function(q){if(q.fetch)q.update||(q.update=this.updateTile(q));
else{if(this._isTileOutSide(q,g)){q.updateCompleted=!0;return}this._requestTile(q)}this.layer.roaming&&this.layer.useWebGL?this._fillPixelData(q):q.src&&c&&(this.layer._hasTilingEffects||this.layer.useWebGL)&&(this._fillPixelData(q),this.layer._hasTilingEffects&&(q.updateCompleted=!0),q.processedPixelBlock=null,q.renderedPixelBlock=null)}));0===this._fetchCounter&&(this._fetched=!0);this._tilesChanged=!1;c&&this._updateFetchStatus()},updateTile:function(c,g){var p=new n;if(!c.src&&!c.fetch)return p.resolve(c),
p.promise;r(c.src||c._fetched||c.fetch,m.hitch(this,function(){var q=this.layer.tileMode&&this.layer._rasterHandler&&!(this.layer._hasTilingEffects||this.layer.useWebGL),u=this.layer._drawTile,v=this._validateRawPixelBlocks(c);this.layer._hasTilingEffects&&!this.layer.useWebGL&&(u=u&&(this._progressiveGlobal||g));if((g||!g&&v)&&(q||u||this.layer.roaming)){if(this.xformSetting.requireProjection&&this.layer.useWebGL&&(this.xformSetting.gridConfig=this.getXformGrid(),null==this.xformSetting.gridConfig))return p.cancel(),
p.promise;this._processTile(c,g).then(m.hitch(this,function(t){p.isCanceled()||this._renderTile(t,g).then(m.hitch(this,function(y){this.hasNewData=!1;p.isCanceled()||p.resolve(y)}))}))}else g||v||(c.updateCompleted=!0),this.layer.useWebGL||this.layer._hasTilingEffects?p.resolve(this.originalPixelData):p.resolve()}));return p.promise},setLayer:function(c){this.layer=c},fillupTiles:function(){this.tiles.forEach(m.hitch(this,function(c){c.update&&c.updateCompleted&&!c.filled&&(c.updateCompleted=!1,this._fillPixelData(c),
c.updateCompleted=!0)}))},_validateRawPixelBlocks:function(c){return c&&c.src&&!this.identifiers.some(function(g){return!(c.src[g].pixelBlock&&0!==c.src[g].pixelBlock.validPixelCount&&c.src[g].pixelBlock.pixels&&0<c.src[g].pixelBlock.pixels.length)})},_wrapExtent:function(c,g){if(c){if(this.tileInfo.applyGCS360Transform){var p=this.normalizeCoordinate(c.xmin,180);0>p&&(p+=360);return new k({xmin:p,ymin:c.ymin,xmax:c.xmax-c.xmin+p,ymax:c.ymax,spatialReference:c.spatialReference})}if(this.halfWorldWidth){p=
null!=g?new k({xmin:this.tileInfo.origin.x+this.tileInfo.cols*g*this.resolution.x,ymin:c.ymin,xmax:this.tileInfo.origin.x+this.tileInfo.cols*(g+1)*this.resolution.x,ymax:c.ymax,spatialReference:c.spatialReference}):new k({xmin:c.xmin,ymin:c.ymin,xmax:c.xmax,ymax:c.ymax,spatialReference:c.spatialReference});g=this.normalizeCoordinate(p.xmin,this.halfWorldWidth);var q=g-p.xmin;.01<Math.abs(q)&&(p.xmin=g,p.xmax+=q)}return p||c}},_getIntersect:function(c,g){return new k(Math.max(c.xmin,g.xmin),Math.max(c.ymin,
g.ymin),Math.min(c.xmax,g.xmax),Math.min(c.ymax,g.ymax),c.spatialReference)},_isTileOutSide:function(c,g){var p=!1;if(c.virtual){var q=c.normalizedExtent;if(g=g||(this.xformSetting.requireProjection?this.layer.raster.rasterInfo.extent:this.layer.raster.projectedFullExtent)){c=q.xmin-this.prefetchBufferSize*this.tileInfo.cols*this.resolution.x;p=q.ymin-this.prefetchBufferSize*this.tileInfo.rows*this.resolution.y;var u=q.xmax+this.prefetchBufferSize*this.tileInfo.cols*this.resolution.x;q=q.ymax+this.prefetchBufferSize*
this.tileInfo.rows*this.resolution.y;p=u<=g.xmin||c>=g.xmax||q<=g.ymin||p>=g.ymax}else p=!1}else p=0>c.level||c.row<this.fullBoundary.rowStart||c.row>this.fullBoundary.rowEnd||c.col<this.fullBoundary.colStart||c.col>this.fullBoundary.colEnd;return p},_resolutionEqual:function(c,g){return c===g||c&&g&&Math.abs(c-g)<Math.abs(g/1E4)?!0:!1},_requestTile:function(c){var g=this.identifiers,p;if(this._isTileOutSide(c)){var q=new n;c.updateCompleted=!0;q.resolve(null);q=q.promise}else q=this.layer.raster.rasterFunction?
new l(this.layer.raster.getMemberRasters().map(function(u){return u.read(c)})):new l([this.layer.raster.read(c)]);c.fetch=q;this._fetchCounter++;r(c.src||c._fetched||q,m.hitch(this,function(u){if(p=u&&u.some(function(t){return t[0]})){var v={};u.forEach(function(t,y){v[g[y]]=t[0]&&t[1]?{extent:t[1].extent,pixelBlock:t[1].pixelBlock,width:t[1].width,height:t[1].height}:null});c.src=v}else c.src=null;this._fetchCounter--;0===this._fetchCounter&&(this._fetched=!0);c._fetched=!0;this._updateFetchStatus()}),
m.hitch(this,function(){this._fetchCounter--;0===this._fetchCounter&&(this._fetched=!0);c._fetched=!0;this._updateFetchStatus()}));c.update=this.updateTile(c)},_updateFetchStatus:function(){this.layer._drawTile&&this.fetchAllCompleted&&!this.fetchAllCompleted.isResolved()&&!this.tiles.some(function(c){return!c._fetched})&&(this.tiles.forEach(m.hitch(this,function(c){this._fillPixelData(c)})),this.fetchAllCompleted.resolve())},_fillPixelData:function(c,g){if(c&&!c.updateCompleted)if(Math.abs(c.cellsizeX-
this.resolution.x)>c.cellsizeX/10)c.updateCompleted=!0;else if(!1===this._validateRawPixelBlocks(c))c.updateCompleted=!0;else{var p=c.extent;if(this.layer.roaming||this.layer.useWebGL&&!this.layer._hasTilingEffects){var q=this.fullExtent;var u=this.tileInfo.cols*(this.tileBoundary.colEnd-this.tileBoundary.colStart+1);var v=this.tileInfo.rows*(this.tileBoundary.rowEnd-this.tileBoundary.rowStart+1);g?this.originalPixelData.renderedPixelBlock||(this.originalPixelData.renderedPixelBlock=new d({width:u,
height:v,pixels:[],pixelType:"",mask:null,statistics:[]})):this.identifiers.forEach(m.hitch(this,function(y){this.originalPixelData.src[y].pixelBlock.width=u;this.originalPixelData.src[y].pixelBlock.height=v}))}else q=this.extent,u=this.layer._map.width,v=this.layer._map.height,g?this.originalPixelData.renderedPixelBlock||(this.originalPixelData.renderedPixelBlock=new d({width:u,height:v,pixels:[],pixelType:"",mask:null,statistics:[]})):this.identifiers.forEach(m.hitch(this,function(y){this.originalPixelData.src[y].pixelBlock.width=
u;this.originalPixelData.src[y].pixelBlock.height=v}));if(q.xmax<=p.xmin||q.xmin>=p.xmax||q.ymax<=p.ymin||q.ymin>=p.ymax)return null;var t=this.originalPixelData.isEmpty=!1;this.identifiers.forEach(m.hitch(this,function(y){c.src&&(this._fillPixelBlock(c.src[y],this.originalPixelData.src[y],{extent:q,width:u,height:v,normalizedExtent:c.normalizedExtent},!1),t=!0)}));c.filled=t;this.hasNewData=!0}},_fillPixelBlock:function(c,g,p,q){var u=c.extent,v=p.extent;q=p.width;var t=p.height;if(c.pixelBlock&&
c.pixelBlock.pixels&&c.pixelBlock.pixels[0]){var y=(u.xmax-u.xmin)/c.width,C=Math.max(u.xmin,v.xmin),B=Math.min(u.ymax,v.ymax),F=Math.round((C-u.xmin)/y),x=c.width-Math.round(Math.abs(u.xmax-Math.min(u.xmax,v.xmax))/y),w=Math.round(Math.abs(u.ymax-B)/y),A=c.height-Math.round((Math.max(u.ymin,v.ymin)-u.ymin)/y),z=this.halfWorldWidth;C=Math.round((C-v.xmin)/y);p=p.normalizedExtent;if(!(this.wrapTimes&&z&&u.xmin<-z)){if(this.wrapTimes&&z){if(this.tileInfo.applyGCS360Transform)360<u.xmin&&(C-=this.fullBoundary.paddingLeft);
else if(u.xmin>z){C-=this.fullBoundary.paddingLeft;var G=this.normalizeCoordinate(u.xmin,z);var J=this.normalizeCoordinate(u.xmax,z)}else G=u.xmin,J=u.xmax;this.tileInfo.applyGCS360Transform?p&&360>p.xmin&&360<p.xmax&&(x-=this.fullBoundary.paddingRight):p&&p.xmin<z&&p.xmax>z?x-=this.fullBoundary.paddingRight:G<z&&J>z&&(x-=this.fullBoundary.paddingRight)}G=Math.round(Math.abs(v.ymax-B)/y);J=c.pixelBlock.pixels.length;g=g.pixelBlock;p=c.width;u=g.mask||new Uint8Array(q*t);var L=c.pixelBlock,R=L.mask,
T=0;for(y=0;y<J;y++){B=L.pixels[y];z=g.pixels[y]||new B.constructor(q*t);for(c=w;c<A;c++)for(T=(G+c-w)*q+C,v=F;v<x;v++)z[T+v-F]=B[c*p+v];g.pixels[y]=z}if(R)for(c=w;c<A;c++)for(T=(G+c-w)*q+C,v=F;v<x;v++)u[T+v-F]=R[c*p+v];else for(c=w;c<A;c++)for(T=(G+c-w)*q+C,v=F;v<x;v++)u[T+v-F]=1;g.pixelType=g.pixelType||L.pixelType;g.mask=u;if(!(g.statistics&&0<g.statistics.length))for(g.statistics=[],c=0;c<L.statistics.length;c++)g.statistics[c]={minValue:L.statistics[c].minValue,maxValue:L.statistics[c].maxValue};
else if(L.statistics&&g.statistics)for(c=0;c<g.statistics.length;c++)g.statistics[c].minValue=Math.min(L.statistics[c].minValue,g.statistics[c].minValue),g.statistics[c].maxValue=Math.max(L.statistics[c].maxValue,g.statistics[c].maxValue)}}},_processTile:function(c,g){var p=new n,q=this.layer._hasTilingEffects,u=this.layer.useWebGL,v=q||u,t=this.layer.raster.rasterFunction&&c&&(q||u||!c.processedPixelBlock);if(g)var y=c;else this._fillPixelData(c),y=v?this.originalPixelData:c;this.xformSetting.hasNewTexture=
this.hasNewData;var C;t?(this.identifiers.forEach(function(B){if(0===y.src[B].pixelBlock.pixels.length||0===y.src[B].pixelBlock.pixels[0].length)C=!0}),C?p.resolve({extent:y.extent,processedPixelBlock:y.src[this.identifiers[0]],pixelBlock:y.src[this.identifiers[0]]}):u?(this.processedPixelData=this.layer.raster.rasterFunction.read(y),p.resolve(this.processedPixelData)):this.layer._rasterHandler?this.layer._rasterHandler.process({extent:y.extent,src:y.src}).then(function(B){q?(this.processedPixelData=
B,p.resolve(this.processedPixelData)):(c.processedPixelBlock=B.pixelBlock,p.resolve(c))}):(g=this.layer.raster.rasterFunction.read(c),c.processedPixelBlock=g.pixelBlock,p.resolve(c))):v?p.resolve(y.src[this.identifiers[0]]):(c.pixelBlock=y.src[this.identifiers[0]]&&y.src[this.identifiers[0]].pixelBlock,p.resolve(c));return p.promise},_renderTile:function(c){var g=new n,p=this.layer._hasTilingEffects,q=this.layer.useWebGL,u=Math.abs((c.extent.xmax-c.extent.xmin)/c.width-this.layer.getCurrentResolution().x)>
this.resolution.x/10;u=this.layer.useWebGL&&(u||this._isTileOutSide(c,this.layer._map.extent));this.xformSetting.hasNewTexture=this.hasNewData;this.layer._rasterRenderer&&c&&(c.texture||c.src||c.pixelBlock||c.processedPixelBlock)?(this.layer._rasterRenderer.interpolation=this.layer.interpolation,q&&!u?(this.layer.raster.rasterFunction&&this.layer.raster.rasterFunction.renderTexture||this.layer._rasterRenderer.draw(c),g.resolve(c)):this.layer._rasterHandler?this.layer._rasterHandler.render({extent:c.extent,
pixelBlock:c.processedPixelBlock||c.pixelBlock}).then(function(v){p?(v.renderedPixelBlock=v.pixelBlock,g.resolve(v)):(c.renderedPixelBlock=v.pixelBlock,g.resolve(c))}.bind(this)):(c.renderedPixelBlock=this.layer._rasterRenderer.draw(c).pixelBlock,g.resolve(c))):(c.renderedPixelBlock=c.processedPixelBlock||c.pixelBlock,g.resolve(c));return g.promise},_sortTiles:function(){this.tiles.sort(function(c,g){return c.row<g.row||c.row==g.row&&c.col<g.col?-1:1})}})})},"esri/dijit/RasterFunctionEditor/utils":function(){define("dojo/_base/lang dojo/_base/url dojo/has dojo/on dojo/Deferred dojo/_base/array dojo/i18n!../../nls/jsapi dojo/text!../../layers/support/rasterFunctionSchema.json ../../kernel ../../request ../../lang ../../config ../../layers/ArcGISImageServiceLayer ../../layers/ImageServiceParameters ../../layers/MosaicRule ../../layers/RasterFunction ../../tasks/Geoprocessor ../../tasks/JobInfo ../../renderers/colorUtils ../../renderers/colorRampUtils ../../layers/ArcGISRenderingImageServiceLayer esri/layers/FeatureLayer".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B){function F(I){if(!I)return null;var O=I.url;O&&0<O.indexOf("?token\x3d")&&(O=O.slice(0,O.indexOf("?token\x3d")));var U=I.credential||O&&d.id.findCredential(O);e.isDefined(U)&&(O=O+"?token\x3d"+U.token,U.referer&&(O+=U.referer));O={url:O,name:I.name};I.renderingRule&&(O.renderingRule=I.renderingRule.toJson?I.renderingRule.toJson():I.renderingRule);if(I.serviceSourceType?"esriImageServiceSourceTypeMosaicDataset"===I.serviceSourceType:I.objectIdField&&
I.fields&&I.fields.length)I.mosaicRule?O.mosaicRule=I.mosaicRule.toJson?I.mosaicRule.toJson():I.mosaicRule:I.defaultMosaicRule&&(O.mosaicRule=I.defaultMosaicRule.toJson?I.defaultMosaicRule.toJson():I.defaultMosaicRule);return O}function x(I){if(I){var O=k.map([I.FromColor,I.ToColor],function(U){U=t.toRGB({h:U.Hue,s:U.Saturation,v:U.Value});return[U.r,U.g,U.b]});return{fromColor:O[0],toColor:O[1],type:"algorithmic",algorithm:I.Algorithm}}}function w(I){if(I)return I=t.toHSV(t.getDojoColor(I)),{type:"HsvColor",
Hue:I.h,Saturation:I.s,Value:I.v,AlphaValue:255}}function A(I){if(I){var O=I.toJson?I.toJson():void 0;return{Algorithm:O&&O.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:w(I.fromColor),ToColor:w(I.toColor)}}}function z(I,O,U){function ha(W,ka){return I+" ("+S[W]+" - "+S[ka]+")"}var ia=b.rasterFunctions.enumLabels,S={1:ia.esriMonthJanuary,2:ia.esriMonthFebruary,3:ia.esriMonthMarch,4:ia.esriMonthApril,5:ia.esriMonthMay,6:ia.esriMonthJune,7:ia.esriMonthJuly,8:ia.esriMonthAugust,
9:ia.esriMonthSeptember,10:ia.esriMonthOctober,11:ia.esriMonthNovember,12:ia.esriMonthDecember};if(U&&""===U)return I.toString();ia="Months"===U;U="Quarters"===U;if(!ia&&!U)return I.toString();if(1==O&&ia)return I+" ("+S[+I]+")";switch(+I){case 1:return ha(1,3);case 2:return ha(4,6);case 3:case 7:return ha(7,9);case 4:return U?ha(10,12):ha(4,6);case 10:return ha(10,12)}return I.toString()}function G(I){return(new Date(Number(I))).toISOString().replace("Z","")}function J(I){return(new Date(I+"Z")).getTime()}
function L(I,O){return I.some(function(U){return U.label===O.label}.bind(this))}function R(){var I=esri.isDefined(esriGeowConfig.isMultiTenant)&&!1===esriGeowConfig.isMultiTenant,O=esriGeowConfig.self.helperServices.analysis&&esriGeowConfig.self.helperServices.analysis.url?esriGeowConfig.self.helperServices.analysis.url:"",U=esriGeowConfig.self.helperServices.rasterAnalytics&&esriGeowConfig.self.helperServices.rasterAnalytics.url?esriGeowConfig.self.helperServices.rasterAnalytics.url:"";return I?
O.replace("SpatialAnalysisTools/GPServer","RasterRendering/ImageServer"):U.replace("rasteranalysis","rasterutils").replace("RasterAnalysisTools/GPServer","RasterRendering/ImageServer")}function T(I){if(I&&I.type){var O,U=functionTypes,ha=I.type.replace("Arguments","");if(ha.toLowerCase()===U.local.toLowerCase()){var ia=I.Operation;0<=E.indexOf(ia&&ia.value)&&(O="CellStatisticsFunction")}ha.toLowerCase()===U.gpAdapter.toLowerCase()&&(O=(O=I.ToolName)&&O.value&&O.value.replace("_sa",""));ha.toLowerCase()===
U.pythonAdapter.toLowerCase()&&(I=I.ClassName,O="object"===typeof I?I.value:I);return O||ha}}function aa(I,O){Array.isArray(I)?I.forEach(function(U,ha){O(I,ha)}.bind(this)):ca(I)&&Object.keys(I).forEach(function(U){O(I,U)}.bind(this))}function ca(I){return null!==I&&"object"===typeof I}function ba(I,O){O=O?O:rasterFunctions;if(I&&I["function"]&&I["function"].type){var U=I["function"].type;(I=T(I&&I.arguments&&I.arguments))&&"RasterFunctionVariable"!==I||(I=U);return oa(I,O)}}function la(I,O){var U=
ba(I),ha=U&&U.rasterFunctionArguments;return Object.keys(I.arguments).filter(function(ia,S){ia=oa(ia,ha);return!ia||ia.hidden?!1:ia.dataType===O}.bind(this))}function oa(I,O){if(I&&O)return k.some(Object.keys(O),function(U){if(U.toLowerCase()===I.toLowerCase())return I=U,!0}),O[I]}function fa(I,O){var U={};if("object"===typeof I&&null!==I&&!Array.isArray(I)){for(var ha in I)I.hasOwnProperty(ha)&&0>k.indexOf(O,ha)&&(U[ha]=fa(I[ha],O));return U}return Array.isArray(I)?I.map(H.hitch(this,function(ia){return fa(ia,
O)})):H.clone(I)}var M={},X,da,Q;functionTypes={local:"LocalFunction",gpAdapter:"GPAdapterFunction",pythonAdapter:"PythonAdapterFunction"};defaultRasterNodeProps={name:"Raster",isDataset:!0,isPublic:!1,type:"RasterFunctionVariable"};rasterFunctions=JSON.parse(a);var K=new Map,E=[38,39,40,41,42,43,47,54,55,58,66,67,68,69,70,71,72,73,74,75,93,94],N=this&&this.__spreadArrays||function(){for(var I=0,O=0,U=arguments.length;O<U;O++)I+=arguments[O].length;I=Array(I);var ha=0;for(O=0;O<U;O++)for(var ia=arguments[O],
S=0,W=ia.length;S<W;S++,ha++)I[ha]=ia[S];return I};H.mixin(M,{fetchRFT:function(I,O,U,ha,ia){var S=new l;var W=(W=(W=I.name)&&W.slice(-8))&&".rft.xml"===W.toLowerCase();return I&&I.itemDataUrl?W?ia?this.convertRFT({url:ia+"/ConvertRasterFunctionTemplate",rft:{itemId:I.id},format:"json"},O,ha,U):(U("errorUtilitiesServiceNotAvailable"),S.reject(Error("errorUtilitiesServiceNotAvailable")),S.promise):f({url:I.itemDataUrl,callbackParamName:"callback",content:{f:"json"},handleAs:"json",load:O,error:U}).then(ha):
(U("errorRetrievingRFTItem"),S.reject(Error("errorRetrievingRFTItem")),S.promise)},convertRFT:function(I,O,U,ha){var ia=I.url,S=function(){Q&&(Q.remove(),Q=null);da&&(da.remove(),da=null)};X||(X=new u(ia),r(X,"error",S));da=r(X,"job-complete",function(W){da&&(da.remove(),da=null);W.jobInfo.jobStatus!==v.STATUS_SUCCEEDED?(S(),ha(W)):X.getResultData(W.jobInfo.jobId,"outputRasterFunction")});Q=r(X,"get-result-data-complete",function(W){Q&&(Q.remove(),Q=null);var ka=W&&W.result&&W.result.value;ka&&ka.url&&
(W={url:ka.url,handleAs:"json",load:U,error:ha},ka=(new m(ka.url)).authority,-1===h.defaults.io.corsEnabledServers.indexOf(ka)&&h.defaults.io.corsEnabledServers.push(ka),f(W))});I={inputRasterFunction:JSON.stringify(I.rft),format:I.format};return X.submitJob(I,O,null,ha)},getRasterJsonFromLayer:F,getLayerIdfromRasterValue:function(I,O){if(I&&O){var U;k.some(O,function(ha){if(ha&&ha.url===I.url&&ha.name===I.name&&I.name)return U=ha.id,!0});return U}},getColorRampFromArg:function(I){if(I){var O;if(I.type&&
-1<I.type.toLowerCase().indexOf("colorramp"))var U=I;else I.value&&-1<I.value.type.toLowerCase().indexOf("colorramp")&&(U=I.value);if(U)return I=U.type.toLowerCase(),"multipartcolorramp"===I?O=y.fromJson({type:"multipart",colorRamps:k.map(U.ArrayOfColorRamp,function(ha){return x(ha)})}):"algorithmiccolorramp"===I&&(O=y.fromJson(x(U))),O.id=O.name=U.Name,O}},getRFxArgColorRampValue:function(I){if(I){if(I.fromColor&&I.toColor)return H.mixin(A(I),{Name:I.name});if(I.colorRamps){var O=k.map(I.colorRamps,
A);return{type:"MultiPartColorRamp",NumColorRamps:O.length,ArrayOfColorRamp:O,Name:I.name}}}},RFX_VARIABLE_TYPE:"RasterFunctionVariable",RFX_TEMPLATE_TYPE:"RasterFunctionTemplate",ARGUMENT_ARRAY_TYPE:"ArgumentArray",getArgRFT:function(I){if(I){if("RasterFunctionTemplate"===I.type)return I;if(I.value&&"RasterFunctionTemplate"===I.value.type)return I.value}},getEnumData:function(I,O,U){if(Array.isArray(I))return I.forEach(function(ha){ha.key=ha.key.toString()}),I},getImageServiceTitle:function(I){I=
I.split("/");return I[I.length-2]},isReferencedObject:function(I){if(I&&e.isDefined(I._object_ref_id))return!0},functionTypes:functionTypes,defaultRasterNodeProps:defaultRasterNodeProps,getArcGISImageServiceLayerItem:function(I){if(I){I=H.clone(I);I.name||(I.name=this.getImageServiceTitle(I.url));var O=new g;I.mosaicRule&&(O.mosaicRule=new p(I.mosaicRule));I.renderingRule&&(O.renderingRule=new q(I.renderingRule));O=new c(I.url,{id:I.name+(new Date).toString(),imageServiceParameters:O});O.name=I.name;
return O}},getArcGISFeatureLayerItem:function(I){if(I){var O=new B(I.url,{outFields:["*"]});O.name=I.name;f({url:I.url,callbackParamName:"callback",content:{f:"json"},handleAs:"json"}).then(H.hitch(this,function(U){H.mixin(O,U);O.emit("load",O)}));return O}},filterMDInfoIfMosiacRuleIsSet:function(I){var O=H.clone(I.multidimensionalInfo),U=[],ha=I.mosaicRule&&I.mosaicRule.multidimensionalDefinition;if(ha&&0<ha.length){var ia=O.variables.filter(function(S){return ha[0].variableName===S.name}.bind(this));
if(!ia||0===ia.length)return O;ia=ia[0];U=H.clone(ia);U.dimensions=[];ha.forEach(function(S){var W=ia.dimensions.filter(function(D){return S.dimensionName===D.name}.bind(this));if(W&&0!==W.length){var ka=(W=W[0])&&W.values,ja=0,ma=1,ta=S.values&&S.values.length;switch(S.values&&S.values[0].length||ta){case 1:ja=ka.indexOf(S.values[0]);ma=ja+1;break;case 2:ja=ka.indexOf(S.values[0][0]),ma=ka.indexOf(S.values[0][1])+1}ka=ka.slice(ja,ma);W.values=ka;U.dimensions.push(W)}else U.dimensions=H.clone(ia.dimensions)}.bind(this));
O.variables=[U]}return O},getRecurrentIntervalName:z,getCorrespondingDimensionRange:function(I,O){var U="StdTime"===I.name,ha=U&&"string"===typeof O?J(O):O;I=I.values.filter(function(ia){return ia[0]===ha})[0];return"object"===typeof I&&U?I.map(function(ia){return G(ia)}):I},getFormattedDateString:G,parseFormattedDateString:J,getVariables:function(I){var O=I.selectedVariables,U=void 0===O?[]:O;return I.multiDimensionalData.variables.filter(function(ha){var ia=U.some(function(S){return"string"===typeof S?
S===ha.name:S.value===ha.name}.bind(this));return U.length?ia:!0}.bind(this))},getDimensions:function(I){var O=I.variables;I=I.selectedDimension;var U=void 0===I?"":I;return(void 0===O?[]:O).reduce(function(ha,ia){ia=ia.dimensions.filter(function(S){return U?S.name===U:!0}.bind(this));return ia.length?N(ha,ia):ha}.bind(this),[])},getFormattedDimensionValues:function(I){var O=[];I.forEach(function(U){var ha=U.hasRanges,ia=U.recurring,S;U.values.forEach(function(W){var ka=H.clone(W);ha||(ka=[ka]);"StdTime"===
U.name&&(ka=ka.map(function(ja){return ia?z(ja,U.interval,U.intervalUnit):G(Number(ja))}.bind(this)));ka=ha?ka.join(" \u2014 "):ka.join("");S={label:ka,value:ia?ha?W.join(" \u2014 "):W.toString():ka,selected:!1,disabled:!1};L(O,S)||O.push(S)}.bind(this))}.bind(this));return O},dimensionHasRanges:function(I){var O=!1;0<I.length&&(O=I[0].hasRanges);return O},getFormattedDimensionRanges:function(I){var O=[],U=[];I.forEach(function(ha){ha=ha.label.split(" \u2014 ");O.push({label:ha[0],value:ha[0],selected:!1,
disabled:!1});U.push({label:ha[1],value:ha[1],selected:!1,disabled:!1})});return{min:O,max:U}},applyMultidimensionalDefinitionFilter:function(I,O){var U=O&&O.dimensions&&0<O.dimensions.length;O&&"BY_RANGES"===O.definitionType?U=U&&O.minValues&&0<O.minValues.length&&O.maxValues&&0<O.maxValues.length:O&&"BY_VALUES"===O.definitionType&&(U=U&&O.values&&0<O.values.length);if(!U)return I;I=H.clone(I);I.forEach(function(ha){var ia=ha.hasRanges,S=[],W=0<=O.dimensions.indexOf(ha.name);W||(S=ha.values);W&&
O.dimensions.forEach(function(ka,ja){if(ka===ha.name)switch(O.definitionType){case "BY_RANGES":ka=O.minValues[ja];ja=O.maxValues[ja];"StdTime"===ha.name&&(ka=J(ka),ja=J(ja));"boolean"===typeof ka||isNaN(ka)||(ka=Number(ka));"boolean"===typeof ja||isNaN(ja)||(ja=Number(ja));var ma=-1,ta=-1;if(ia)for(var D=0;D<ha.values.length&&!(ha.values[D][0]===ka&&(ma=D),ha.values[D][1]===ja&&(ta=D+1),0<=ma&&1<=ta);D++);else ma=ha.values.indexOf(ka),ta=ha.values.indexOf(ja)+1;S=N(S,ha.values.slice(ma,ta));break;
case "BY_VALUES":var P=ia?O.values[ja].split(" \u2014 "):[O.values[ja]];"StdTime"===ha.name&&(P=P.map(function(Y){return J(Y)}.bind(this)));ka=ha.values.filter(function(Y){"boolean"===typeof Y||isNaN(Y)||(Y=Number(Y));return ia?Y.includes(P[0])&&Y.includes(P[1]):P[0]==Y}.bind(this));S=N(S,ka)}}.bind(this));ha.values=H.clone(S)}.bind(this));return I},mapObjectByProperty:function(I,O){return I.map(function(U){return U[O]}.bind(this))},removeDuplicatesFromArray:function(I){return I.filter(function(O,
U,ha){return ha.indexOf(O)===U}.bind(this))},UIModifier:{show:function(I){I.classList.remove("hidden")},hide:function(I){I.classList.add("hidden")}},isArrayEqual:function(I,O){return I&&O?I.length===O.length&&I.every(function(U){return 0<=O.indexOf(U)}.bind(this)):!1},makeComboboxSelection:function(I,O){var U=!1;I.forEach(function(ha){ha.value[0]===O?U=ha.selected=!0:ha.selected=!1});U||I.unshift({label:O,value:O,selected:!0,disabled:!0})},processRFTAsLayerInput:function(I){var O=R(),U=function(ia,
S){if("arguments"===S){var W=ia[S];ca(W)&&(la(ia,"raster").forEach(function(ka){ka=W[ka];var ja=ka.value;ja&&ja.url&&(ka.value=F(ja))}.bind(this)),aa(W,U))}},ha=fa(I,["input","uxBlocks","overrideWidget","_object_id"]);aa(I,U);return new C(O,{raster:JSON.stringify(ha),type:"rft"})},getFunctionName:T,coerceEnumDataForCurrentEnv:function(I,O,U){if(!U)return O;U={};U={};var ha=T(I),ia;for(ia in U)if(ia===ha){var S=U[ia],W;for(W in S){var ka=S[W];I[W]&&(O=O.filter(function(ja){return!(0<=ka.indexOf(ja.key))}.bind(this)))}}return O},
createObjectMap:function(I){var O=function(U,ha){U=U[ha];ca(U)&&(void 0!==U._object_id&&K.set(U._object_id,U),aa(U,O))};aa(I,O)},processAllComponents:aa,isDefinedObject:ca,getReferencedObject:function(I){return K.has(I)?K.get(I):null},projectGeometrySpatialReference:function(I,O){return(new GeometryService(h.defaults.geometryService.url)).project(I,O)},getRasterInfoExtent:function(I){return(I=I&&(I.extent||I.fullExtent))&&{xmax:I.xmax,xmin:I.xmin,ymax:I.ymax,ymin:I.ymin,spatialReference:{latestWkid:I.spatialReference.latestWkid,
wkid:I.spatialReference.wkid}}||void 0},computeGamma:function(I){var O=I.bands;I=I.pixelType;if(O&&0!==O.length&&I){for(var U=[],ha=0;ha<O.length;ha++){var ia=0,S=0,W=0;"min"in O[ha]?(ia=O[ha].min,S=O[ha].max,avg=O[ha].avg):(ia=O[ha][0],S=O[ha][1],avg=O[ha][2]);"u8"!==I&&(W=255*(W-ia)/(S-ia));ia=U;S=ia.push;if(0>=W||255<=W)W=1;else{var ka=0;150!==W&&(ka=150>=W?45*Math.cos(.01047*W):17*Math.sin(.021*W));ka=Math.log((W+ka)/255);0===ka?W=1:(W=Math.log(W/255)/ka,W=isNaN(W)?1:Math.min(9.9,Math.max(.01,
W)))}S.call(ia,W)}return U}},getFunctionSchema:ba,getCaseInsensitiveArg:oa,cloneRFT:fa,defaultColorRamp:{colorRamps:[{fromColor:{r:190,g:190,b:190,a:1},toColor:{r:255,g:45,b:8,a:1},algorithm:"hsv"},{fromColor:{r:255,g:45,b:8,a:1},toColor:{r:255,g:181,b:61,a:1},algorithm:"hsv"},{fromColor:{r:255,g:181,b:61,a:1},toColor:{r:255,g:254,b:52,a:1},algorithm:"hsv"},{fromColor:{r:255,g:254,b:52,a:1},toColor:{r:0,g:251,b:50,a:1},algorithm:"hsv"},{fromColor:{r:0,g:251,b:50,a:1},toColor:{r:255,g:254,b:52,a:1},
algorithm:"hsv"},{fromColor:{r:0,g:253,b:255,a:1},toColor:{r:0,g:181,b:255,a:1},algorithm:"hsv"},{fromColor:{r:0,g:181,b:255,a:1},toColor:{r:26,g:35,b:253,a:1},algorithm:"hsv"},{fromColor:{r:26,g:35,b:253,a:1},toColor:{r:255,g:57,b:251,a:1},algorithm:"hsv"},{fromColor:{r:255,g:57,b:251,a:1},toColor:{r:255,g:45,b:8,a:1},algorithm:"hsv"}],name:"Aspect",id:"aspect_predefined"}});n("extend-esri")&&H.setObject("dijit.RasterFunctionEditor.utils",M,d);return M})},"esri/layers/ArcGISRenderingImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/config dojo/has dojox/encoding/digests/_base ../kernel ../config ../request ../deferredUtils ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h){H=H([e,h],{declaredClass:"esri.layers.ArcGISRenderingImageServiceLayer",rasterType:{rft:"rft",rasterObject:"rasterObj",url:"url"},constructor:function(c,g){this.type=g.type;var p=this._processRasterParam(g.raster);p&&(c=c+"?raster\x3d"+p,this._initialize(c,g),this.useMapImage=g&&g.useMapImage||!1)},_processRasterParam:function(c){if(c)return this.type===this.rasterType.rft||this.type===this.rasterType.rasterObject?("object"===typeof c&&(c=JSON.stringify(c)),c=k.stringToWord(c),
k.wordToBase64(c)):c},refresh:function(c){if(!0===c)this.inherited(arguments);else{var g=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=g}},setRaster:function(c){c=this._processRasterParam(c);this._url.query.raster=c;this._params.raster=c;this.refresh(!0)},setRenderer:function(c,g){this.renderer=c;this.onRendererChange();g||this.refresh(!0)},exportMapImage:function(c,g){var p=a.defaults.map;c=m.mixin({size:p.width+","+p.height},this._params,
c?c.toJson(this.normalization):{},{f:"json"});delete c._ts;this._exportMapImage(this._url.path+"/exportImage",c,g)},getMultidimensionalInfo:function(){var c=this._url.path+"/multiDimensionalInfo",g=new n(f._dfdCanceller);if(this._multidimensionalInfo)return g.resolve(this._multidimensionalInfo),g;!this.loaded||10.3<=this.version&&this.hasMultidimensions?(g._pendingDfd=d({url:c,content:m.mixin(this._params,{f:"json",token:this._getToken()}),handleAs:"json",callbackParamName:"callback"}),g._pendingDfd.then(m.hitch(this,
function(p){this._multidimensionalInfo=p.multidimensionalInfo;g.callback(p.multidimensionalInfo)}),function(p){g.errback(p)})):(c=Error("Layer does not support multidimensional info"),c.log=!!r.isDebug,g.errback(c));return g}});l("extend-esri")&&m.setObject("layers.ArcGISRenderingImageServiceLayer",H,b);return H})},"esri/dijit/analysis/storageUtils":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/promise/all dojo/has dojo/json ../../request ../../kernel".split(" "),
function(H,m,n,r,l,k,b,a,d){m={MAX_RESOURCES:10,checkResourceLimit:!0,_getItemUrl:function(f){var e=f.folderId||f.ownerFolder;return this._portalUrl+"/sharing/rest/content/users/"+f.owner+"/"+(e?e+"/":"")+"/items/"+f.id},addToItemResource:function(f,e){this._portalUrl=e.portalUrl;delete e.portalUrl;f=this._getItemUrl(f);f+="/addResources";e={filename:e.jobInfo.jobId+".json",text:b.stringify(e),resourcesPrefix:"jobs",f:"json"};return a({url:f,content:e},{usePost:!0})},getItemResource:function(f,e){e&&
e.portalUrl&&(this._portalUrl=e.portalUrl);f=this._getItemUrl(f);f+="/resources/"+e.resource;return a({url:f,content:{f:"json"}})},removeItemResource:function(f,e){e&&e.portalUrl&&(this._portalUrl=e.portalUrl);f=this._getItemUrl(f);return a({url:f+"/removeResources",content:{resource:e.resource,deleteAll:e.deleteAll,f:"json"}},{usePost:!0})},addToStorage:function(f){if(window.sessionStorage){var e=window.sessionStorage.getItem("esri_analysis_jobhistory");e=e?b.parse(e):[];e.push(f);window.sessionStorage.setItem("esri_analysis_jobhistory",
b.stringify(e))}},addAllToStorage:function(f){window.sessionStorage&&window.sessionStorage.setItem("esri_analysis_jobhistory",b.stringify(f))},removeFromStorage:function(f){if(window.sessionStorage){var e=window.sessionStorage.getItem("esri_analysis_jobhistory");e&&(e=b.parse(e));e=H.filter(e,function(h){return h.jobInfo&&h.jobInfo.jobId!==f.jobInfo.jobId});window.sessionStorage.setItem("esri_analysis_jobhistory",b.stringify(e))}},removeAllFromStorage:function(){window.sessionStorage&&window.sessionStorage.removeItem("esri_analysis_jobhistory")},
getJobsInfoList:function(){var f;window.sessionStorage&&(f=window.sessionStorage.getItem("esri_analysis_jobhistory"))&&(f=b.parse(f));return f},addItemResources:function(f,e){var h=this.getJobsInfoList(),c=[];H.forEach(h,function(g){g.portalUrl=e.portalUrl;var p=new r;c.push(p);this.addToItemResource(f,g).then(n.hitch(this,function(q){q&&!0===q.success&&(this.removeFromStorage(g),p.resolve(q))}))},this);return l(c)},saveJobsQueue:function(f,e){var h=this.getJobsInfoList(),c=new r;h&&0<h.length&&this.removeResourceQueue(f,
e).then(n.hitch(this,function(){if(h.length>this.MAX_RESOURCES){for(this.sortJobsInfoList(h,{asc:!1});h.length>this.MAX_RESOURCES;)h.pop();this.addAllToStorage(h)}this.addItemResources(f,e).then(n.hitch(this,function(g){c.resolve(g)}),n.hitch(this,function(g){c.reject(g)}))}),n.hitch(this,function(g){c.reject(g)}));return c.promise},saveJobsInfoList:function(f,e){return this.checkResourceLimit?this.saveJobsQueue(f,e):this.addItemResources(f,e)},getResources:function(f,e){e&&e.portalUrl&&(this._portalUrl=
e.portalUrl);f=this._getItemUrl(f);return a({url:f+"/resources",content:{f:"json"}})},getResourcesInfo:function(f,e){var h=[],c=new r;this.sortResources(f,e).then(n.hitch(this,function(g){H.forEach(g.resources,function(p){e.resource=p.resource;h.push(this.getItemResource(f,e))},this);l(h).then(n.hitch(this,function(p){c.resolve(p)}),n.hitch(this,function(p){c.reject(p)}))}),n.hitch(this,function(g){c.reject(g)}));return c.promise},sortJobsInfoList:function(f,e){f.sort(n.hitch(this,function(h,c){return e.asc?
h.timestamp-c.timestamp:c.timestamp-h.timestamp}))},sortResources:function(f,e){var h=new r;this.getResources(f,e).then(n.hitch(this,function(c){c.resources&&0<c.resources.length&&c.resources.sort(n.hitch(this,function(g,p){return e.asc?g.created-p.created:p.created-g.created}));h.resolve(c)}),n.hitch(this,function(c){h.reject(c)}));return h.promise},removeResourceQueue:function(f,e){var h=new r,c=[];var g=this.getJobsInfoList().length;var p=this.MAX_RESOURCES-g;p=0<p?p:0;e.asc=!0;this.sortResources(f,
e).then(n.hitch(this,function(q){if(q&&q.resources&&0<q.resources.length)if(0===p){var u=q.resources.shift();e.resource=u.resource;e.deleteAll=!0;c.push(this.removeItemResource(f,e));q.resources=[]}else for(;q.resources.length>p;)u=q.resources.shift(),e.resource=u.resource,c.push(this.removeItemResource(f,e));l(c).always(n.hitch(this,function(){h.resolve(q)}))}),n.hitch(this,function(q){h.reject(q)}));return h.promise}};k("extend-esri")&&n.setObject("dijit.analysis.storageUtils",m,d);return m})},
"esri/dijit/analysis/_AnalysisOptions":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-attr dojo/_base/json dojo/dom-class dojo/dom-construct dojo/dom-style dojo/aspect dojo/has dojo/_base/array dojo/_base/window dojo/on dojo/query dojo/number ./Settings ./SettingsViewModel ./utils ./mixins/browselayers/BrowseLayerMixin ./mixins/FilterAndSelection dijit/Dialog dijit/form/NumberTextBox dojo/i18n!../../nls/jsapi ../../lang ../../kernel".split(" "),function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,
p,q,u,v,t,y,C,B,F,x){H=H([v,t],{declaredClass:"esri.dijit.analysis._AnalysisOptions",showSelectFolder:!1,showChooseExtent:!0,showHelp:!0,showCredits:!0,returnFeatureCollection:!1,showCloseIcon:!0,showSelectAnalysisLayer:!0,map:null,showReadyToUseLayers:!0,showAnalysisBusyIndicator:!0,showGeoAnalyticsParams:!1,showBrowseLayers:!1,showAnalysisModeLabel:!1,distanceDefaultUnits:"Miles",showSettings:!1,showOutputType:!1,context:{},includeRouteLayers:!1,doSaveJobInfo:!1,doSaveInStorage:!1,showCreditCalcBusyIndicator:!0,
useArcGISComponents:!1,isServerAdvanceLicensed:!0,constructor:function(w){w.rerun&&this._initRerunProps(w)},isAdmin:function(w){return F.isDefined(w.role)&&("org_admin"===w.role||"account_admin"===w.role)},isOwner:function(w,A){return w.owner?w.owner===A.id:w.userId?w.userId===A.username:w.credential?w.credential.userId===A.username:!0},_initRerunProps:function(w){w.OutputName&&w.OutputName.serviceProperties?w.outputLayerName=w.OutputName.serviceProperties.name:w.resultName&&(w.outputLayerName=w.resultName);
w.timeStepReference&&(w.timeReference=w.timeStepReference);this.set("extentCheck",w.extentCheck);this._numberFormatHandle=a.before(C,"_setValueAttr",function(A,z,G){A=g.format(A);return[A,z,G]});this.on("close",m.hitch(this,function(){this._numberFormatHandle&&(this._numberFormatHandle.remove(),this._numberFormatHandle=null)}))},_setShowSelectFolderAttr:function(w){!0===w&&w===this.get("returnFeatureCollection")&&(w=!w);this.showSelectFolder=w;this._webMapFolderSelect&&this._webMapFolderSelect.set("required",
w);this._chooseFolderRow&&b.set(this._chooseFolderRow,"display",!0===this.showSelectFolder?"block":"none");w&&this._webMapFolderSelect&&this.getFolderStore().then(m.hitch(this,function(A){this.folderStore=A;u.setupFoldersUI({folderStore:this.folderStore,folderId:this.folderId,folderName:this.folderName,folderSelect:this._webMapFolderSelect,username:this.portalUser?this.portalUser.username:""})}))},_getShowSelectFolderAttr:function(){return this.showSelectFolder},_setShowChooseExtentAttr:function(w){this.showChooseExtent=
w},_getShowChooseExtentAttr:function(){return this.showChooseExtent},_setExtentCheckAttr:function(w){this.extentCheck=w;F.isDefined(this._useExtentCheck)&&F.isDefined(w)&&this._useExtentCheck.set("checked",w)},_setMapAttr:function(w){this.map=w},_getMapAttr:function(){return this.map},_setShowHelpAttr:function(w){this.showHelp=w},_getShowHelpAttr:function(){return this.showHelp},_setReturnFeatureCollectionAttr:function(w){this.returnFeatureCollection=w;this.set("showSelectFolder",!w)},_getReturnFeatureCollectionAttr:function(){return this.returnFeatureCollection},
_setShowCreditsAttr:function(w){(this.showCredits=w)&&this._showCreditsLink&&this._usageForm&&(this._onCreditsClickHandle=h.pausable(this._showCreditsLink,"click",m.hitch(this,this._handleShowCreditsClick)))},_getShowCreditsAttr:function(){return this.showCredits},_setShowCloseIconAttr:function(w){this.showCloseIcon=w},_getShowCloseIconAttr:function(){return this.showCloseIcon},_setShowSelectAnalysisLayerAttr:function(w){this.showSelectAnalysisLayer=w;this._analysisSelect&&this._analysisSelect.set("required",
w)},_getShowSelectAnalysisLayerAttr:function(){return this.showSelectAnalysisLayer},_setIsSingleTenantAttr:function(w){this.isSingleTenant=w},_getIsSingleTenantAttr:function(){return this.isSingleTenant},_setAllowChooseLabelAttr:function(w){this.allowChooseLabel=w},_getAllowChooseLabelAttr:function(){return this.allowChooseLabel},_setTitleAttr:function(w){this.title=w;this._toolTitle&&n.set(this._toolTitle,"innerHTML",w)},_getTitleAttr:function(){return this.title=n.get(this._toolTitle,"innerHTML")},
_setShowReadyToUseLayersAttr:function(w){this.showReadyToUseLayers=w},_getShowReadyToUseLayersAttr:function(w){return this.showReadyToUseLayers},_setFolderIdAttr:function(w){this.folderId=w},_getFolderIdAttr:function(){this._webMapFolderSelect&&this.folderStore&&(this.folderId=this._webMapFolderSelect.item?this.folderStore.getValue(this._webMapFolderSelect.item,"id"):"");return this.folderId},_setFolderNameAttr:function(w){this.folderName=w},_getFolderNameAttr:function(){this._webMapFolderSelect&&
this.folderStore&&this._webMapFolderSelect.item&&(this.folderName=this.folderStore.getValue(this._webMapFolderSelect.item,"name"));return this.folderName},_setHelperServicesAttr:function(w){this.helperServices=w},_getHelperServicesAttr:function(w){return this.helperServices},_getPortalSelfAttr:function(){return this.portalSelf},_setPortalSelfAttr:function(w){this.portalSelf=w},_setShowAnalysisBusyIndicatorAttr:function(w){w&&this.own(this.on("start",m.hitch(this,function(){this.showLoadingIndicator()})),
this.on("job-fail, job-result, job-cancel",m.hitch(this,function(){this.hideLoadingIndicator()})),this.on("job-status",m.hitch(this,function(A){"esriJobFailed"===A.jobStatus&&this.hideLoadingIndicator()})))},_setShowGeoAnalyticsParamsAttr:function(w){this.showGeoAnalyticsParams=w},_getShowGeoAnalyticsParamsAttr:function(){return this.showGeoAnalyticsParams},_setShowBrowseLayersAttr:function(w){this.showBrowseLayers=w},_getShowBrowseLayersAttr:function(){return this.showBrowseLayers},showLoadingIndicator:function(){this.get("showAnalysisBusyIndicator")&&
(this._saveBtn.set("iconClass","esriLoading"),this.set("disableRunAnalysis",!0))},hideLoadingIndicator:function(){this.get("showAnalysisBusyIndicator")&&(this._saveBtn.set("iconClass",""),this.set("disableRunAnalysis",!1))},_setDistanceDefaultUnitsAttr:function(w){this.distanceDefaultUnits=w},_getDistanceDefaultUnitsAttr:function(){return this.distanceDefaultUnits},_setAnalysisModeAttr:function(w){this.analysisMode=w},_setShowAnalysisModeLabelAttr:function(w){this.showAnalysisModeLabel=w;this._titleLbl&&
this._analysisModeLblNode&&(b.set(this._titleLbl,"display",this.showAnalysisModeLabel?"none":"block"),b.set(this._analysisModeLblNode,"display",this.showAnalysisModeLabel?"flex":"none"),this.showAnalysisModeLabel&&("standard"===this.analysisMode?this.analysisModeLabel=this.i18n.standard:"bigdata"===this.analysisMode||this.showGeoAnalyticsParams?this.analysisModeLabel=this.i18n.bigData:"raster"===this.analysisMode&&(this.analysisModeLabel=this.i18n.raster),n.set(this._analysisModeCrumb,"innerHTML",
this.analysisModeLabel)))},_getTimeReferenceAttr:function(){if(this._timeRefDay){var w="",A="",z="";var G=this._timeRefDay.get("value");var J=this._timeRefTime.get("value");G&&(w=G.toDateString(),z="Date");J&&(A=J.toTimeString(),z="DateTime");this.set("timeReferenceType",z);G=A&&-1!==A.indexOf("GMT")?w+" "+A.substring(0,A.indexOf("GMT")+3):A?w+" "+A.split(" ")[0]+" GMT":w+" GMT";this.timeReference=(new Date(G)).getTime()}return this.timeReference},_setTimeReferenceAttr:function(w){w=new Date(w+6E4*
(new Date(w)).getTimezoneOffset());this._timeRefDay&&this._timeRefDay.set("value",w);this._timeRefTime&&"DateTime"===this.timeReferenceType&&this._timeRefTime.set("value",w)},_setTimeReferenceTypeAttr:function(w){this.timeReferenceType=w},_setSLayersAttr:function(w){this.sLayers=w},_setContextAttr:function(w){this.context=w},_setIncludeRouteLayersAttr:function(w){this.includeRouteLayers=w},_getIncludeRouteLayersAttr:function(){return this.includeRouteLayers},_setShowSettingsAttr:function(w){this.showSettings=
w;var A=this.analysisMode&&("raster"===this.analysisMode||"bigdata"===this.analysisMode),z="ClassifyPixelsUsingDeepLearning DetectObjectsUsingDeepLearning ClassifyObjectsUsingDeepLearning CalculateSlope DeriveAspect MonitorVegetation ApplyRFxTemplate RemapValues ExtractRaster AggregateMultidimensionalRaster GenerateMultidimensionalAnomaly GenerateTrendRaster PredictUsingTrendRaster FindArgumentStatistics Sample ConvertFeatureToRaster".split(" "),G=["ClassifyPixelsUsingDeepLearning","DetectObjectsUsingDeepLearning",
"ClassifyObjectsUsingDeepLearning"],J="ZonalStatisticsAsTable CalculateDensityRaster InterpolatePointsEBK DistanceAccumulation DistanceAllocation CreateViewshedRaster Watershed OptimalRegionConnections SummarizeRasterWithin".split(" "),L=this.analysisMode&&"raster"===this.analysisMode;z=L&&-1!==z.concat(J).indexOf(this.toolName)&&this.isSingleTenant;var R=L&&-1!==G.indexOf(this.toolName);G=R&&this.isSingleTenant;var T=L&&"Sample"===this.toolName;J=-1!==["DetectObjectsUsingDeepLearning","ClassifyObjectsUsingDeepLearning"].indexOf(this.toolName);
var aa=-1!=="SummarizeRasterWithin ZonalStatisticsAsTable CalculateDensityRaster InterpolatePointsEBK CreateViewshedRaster Watershed ConvertRasterToFeature Sample".split(" ").indexOf(this.toolName),ca=-1!=="CalculateDistance DetermineOptimumTravelCostNetwork DetermineTravelCostPathAsPolyline OptimalPathAsLine OptimalPathAsRaster DistanceAllocation DistanceAccumulation OptimalRegionConnections".split(" ").indexOf(this.toolName),ba=-1!=="DetectObjectsUsingDeepLearning Sample SummarizeRasterWithin ZonalStatisticsAsTable CalculateDensityRaster InterpolatePointsEBK CreateViewshedRaster Watershed CalculateDistance DetermineOptimumTravelCostNetwork DetermineTravelCostPathAsPolyline DistanceAllocation DistanceAccumulation OptimalRegionConnections".split(" ").indexOf(this.toolName),
la=L&&!J&&!T,oa=L&&!J;ba=L&&ba;T=L&&!T;R=L&&!aa&&!R&&!ca;aa=L&&!this.isSingleTenant;w&&(u.settingsDlg||(w=e.doc.createDocumentFragment(),w=k.create("div",{style:"width:200px;height:200px;"},w),ca=f.filter(this.sLayers,function(fa){return fa.type?"Table"!==fa.type:!0}),u.settingsVM=new q({showHelp:!0,showCloseIcon:!1,showOverwriteResultOption:!1,showCloseAnalysisOption:!0,showStoreAnalysisOption:!0,showCoordinateSystems:this.analysisMode&&("raster"===this.analysisMode&&!J||"bigdata"===this.analysisMode),
showProcessSR:this.analysisMode&&"bigdata"===this.analysisMode,showOutSR:oa,showExtent:!0,showRasterSettings:L,showGeoAnalyticsSettings:this.analysisMode&&"bigdata"===this.analysisMode,showRasterPPFSettings:z,showRasterPTSettings:G,showRasterSnapSettings:la,showRasterMaskSettings:ba,showCellsizeSettings:T,showResamplingSettings:R,showCreditWarningSettings:aa,showHeader:!1,layers:ca,showJobsHistory:!1,jobsHistoryItem:null}),this.signInPromise.then(m.hitch(this,function(){u.settingsVM.set("portalUrl",
this.portalUrl)})),u.settings=new p({viewModel:u.settingsVM},w),this.i18n||(this.i18n={},m.mixin(this.i18n,B.common),m.mixin(this.i18n,B.analysisTools),m.mixin(this.i18n,B.analysisMsgCodes),m.mixin(this.i18n,B.analysisSettings)),u.settingsDlg=new y({title:this.i18n.analysisEnv,content:u.settings,style:"width:400px;"}),u.settingsDlg.own(u.settings.on("ok-settings",m.hitch(this,function(){u.settingsDlg.hide()})),u.settings.on("cancel-settings",m.hitch(this,function(){u.settingsDlg.hide()})))),u.settingsDlg&&
(u.settingsVM.set("showRasterSettings",L),u.settingsVM.set("showGeoAnalyticsSettings",this.analysisMode&&"bigdata"===this.analysisMode),u.settingsVM.set("showCoordinateSystems",this.analysisMode&&("raster"===this.analysisMode&&!J||"bigdata"===this.analysisMode)),u.settingsVM.set("showProcessSR",this.analysisMode&&"bigdata"===this.analysisMode),u.settingsVM.set("showOutSR",oa),u.settingsVM.set("showRasterPPFSettings",z),u.settingsVM.set("showRasterPTSettings",G),u.settingsVM.set("showRasterSnapSettings",
la),u.settingsVM.set("showCellsizeSettings",T),u.settingsVM.set("showResamplingSettings",R),u.settingsVM.set("showCreditWarningSettings",aa),u.settingsVM.set("showRasterMaskSettings",ba),this.domNode&&c("[esriHelpTopic\x3d'toolDescription']",this.domNode).forEach(m.hitch(this,function(fa){fa&&(this._settingsLink=k.create("a",{href:"#","class":"esriAnalysisSettingsIcon"},fa,"before"),h(this._settingsLink,"click",m.hitch(this,this._handleSettingsLinkClick)))})),this._settingWatchers||(this._settingWatchers=
!0,L=this.get("context"),u.settingsVM.extent&&(L.extent=u.settingsVM.extent,this._useExtentCheck&&this._useExtentCheck.set("checked",!1)),u.settingsVM.outSR&&(L.outSR=u.settingsVM.outSR),u.settingsVM.processSR&&(L.processSR=u.settingsVM.processSR),u.settingsVM.extent&&(L.extent=u.settingsVM.extent,this._useExtentCheck&&this._useExtentCheck.set("checked",!1)),u.settingsVM.cellSize&&(L.cellSize=u.settingsVM.cellSize),u.settingsVM.mask&&(L.mask=u.settingsVM.mask),u.settingsVM.snapRaster&&(L.snapRaster=
u.settingsVM.snapRaster),u.settingsVM.processorType&&(L.processorType=u.settingsVM.processorType),u.settingsVM.parallelProcessingFactor&&(L.parallelProcessingFactor=u.settingsVM.parallelProcessingFactor),u.settingsVM.resamplingMethod&&(L.resamplingMethod=u.settingsVM.resamplingMethod),this.set("returnFeatureCollection",!A&&u.settingsVM.returnFeatureCollection),this._updateContextDatastore(L,u.settingsVM.datastore),this.set("context",L),u.settingsVM.watch("outSR",m.hitch(this,function(fa,M,X){if(fa=
this.get("context"))fa.outSR=X,this.set("context",fa)})),u.settingsVM.watch("processSR",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.processSR=X,this.set("context",fa)})),u.settingsVM.watch("extent",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.extent=X,this.set("context",fa);this._useExtentCheck&&this._useExtentCheck.set("checked",!F.isDefined(X))})),u.settingsVM.watch("cellSize",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.cellSize=X,this.set("context",fa)})),
u.settingsVM.watch("mask",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.mask=X,this.set("context",fa)})),u.settingsVM.watch("snapRaster",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.snapRaster=X,this.set("context",fa)})),u.settingsVM.watch("returnFeatureCollection",m.hitch(this,function(fa,M,X){this.set("returnFeatureCollection",!(this.analysisMode&&("raster"===this.analysisMode||"bigdata"===this.analysisMode))&&X)})),u.settingsVM.watch("datastore",m.hitch(this,function(fa,
M,X){if(fa=this.get("context"))this._updateContextDatastore(fa,X),this.set("context",fa)})),u.settingsVM.watch("processorType",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.processorType=X,this.set("context",fa)})),u.settingsVM.watch("parallelProcessingFactor",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.parallelProcessingFactor=X,this.set("context",fa)})),u.settingsVM.watch("recycleProcessingWorkers",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.recycleProcessingWorkers=
X,this.set("context",fa)})),u.settingsVM.watch("retryOnFailures",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.retryOnFailures=X,this.set("context",fa)})),u.settingsVM.watch("resamplingMethod",m.hitch(this,function(fa,M,X){if(fa=this.get("context"))fa.resamplingMethod=X,this.set("context",fa)})))))},_updateContextDatastore:function(w,A){w&&A&&(A&&-1===["BDS","GDB"].indexOf(A)?w.dataStore=A:w.dataStore=null,setTimeout(m.hitch(this,function(){this.set("showSelectFolder",this.showGeoAnalyticsParams?
!w.dataStore:this.showSelectFolder)}),0))},_setShowOutputTypeAttr:function(w){this.showOutputType=w},_setDoSaveJobInfoAttr:function(w){this.doSaveJobInfo=w},_setDoSaveInStorageAttr:function(w){this.doSaveInStorage=w},_getResultNameAttr:function(w){this.resultName="";this.outputLayerInput?this.resultName=this.outputLayerInput.get("value"):this._outputLayerInput&&(this.resultName=this._outputLayerInput.get("value"));return this.resultName},_setArcadeEditorAttr:function(w){this.arcadeEditor=w},_setShowCreditCalcBusyIndicatorAttr:function(w){var A=
[];this.showCredits&&this._showCreditsLink&&this._usageForm&&(w?(A.push(a.before(this,"_handleShowCreditsClick",m.hitch(this,function(){var z=this._form&&this._form.validate();"DeriveNewLocations"===this.toolName||"FindExistingLocations"===this.toolName?z=z&&this.expressionGrid.validate():"EnrichLayer"==this.toolName&&(z=z&&this.validateSelectedGrid());z?this._pauseCreditLinkClick(this._onCreditsClickHandle,!0):this._pauseCreditLinkClick(this._onCreditsClickHandle,!1)}))),A.push(a.after(this._usageForm,
"_setContentAttr",m.hitch(this,function(){this._pauseCreditLinkClick(this._onCreditsClickHandle,!1)}))),A.push(a.after(this._usageForm,"_setErrorContentAttr",m.hitch(this,function(){this._pauseCreditLinkClick(this._onCreditsClickHandle,!1)})))):A.forEach(function(z){z.remove();z=null}))},_setuseArcGISComponentsAttr:function(w){this.useArcGISComponents=w},_getuseArcGISComponentsAttr:function(w){return this.useArcGISComponents},_setIsServerAdvanceLicensedAttr:function(w){this.isServerAdvanceLicensed=
w},_getIsServerAdvanceLicensedAttr:function(){return this.isServerAdvanceLicensed},_handleSettingsLinkClick:function(){this.showSettingsDlg()},showSettingsDlg:function(w){w&&w.preventDefault();this._hasPCSWarnShown&&this.showGeoAnalyticsParams&&this._errorMessagePane&&u.hideMessages(this._errorMessagePane);u.settingsDlg.show()},_handleModeCrumbClick:function(w){w.preventDefault();this._onClose(!1)},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();
this.emit("focus");this.inherited(arguments)},_onBlur:function(){this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.emit("blur");this.inherited(arguments)},_handleAtrrValueUpdate:function(w,A,z){"0"!==z&&(w=this.get("statisticSelect"),(z=this.getOptions(z))&&z.type&&u.addStatisticsOptions({selectWidget:w,type:z.type,showGeoAnalyticsParams:this.showGeoAnalyticsParams}))},_pauseCreditLinkClick:function(w,A){A?(w.pause(),b.set(this._showCreditsLink,
{color:"grey",cursor:"none"}),l.add(this._showCreditsLink,"esriAnalysisTextDisabled esriLoadingBar2")):(w.resume(),b.set(this._showCreditsLink,{color:"#21759B",cursor:"pointer"}),l.remove(this._showCreditsLink,"esriAnalysisTextDisabled esriLoadingBar2"))},constructAnalysisInputLyrObj:function(w,A){A=F.isDefined(A)?A:this.isSingleTenant;return u.constructAnalysisInputLyrObj(w,A,!this.showGeoAnalyticsParams)},_addBarrierstoJobParams:function(w,A){w instanceof Object&&(A.pointBarrierLayer&&(w.pointBarrierLayer=
r.toJson(this.constructAnalysisInputLyrObj(A.pointBarrierLayer))),A.lineBarrierLayer&&(w.lineBarrierLayer=r.toJson(this.constructAnalysisInputLyrObj(A.lineBarrierLayer))),A.polygonBarrierLayer&&(w.polygonBarrierLayer=r.toJson(this.constructAnalysisInputLyrObj(A.polygonBarrierLayer))));return w}});d("extend-esri")&&m.setObject("dijit.analysis._AnalysisOptions",H,x);return H})},"esri/dijit/analysis/Settings":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/json dojo/has dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/NodeList dojo/NodeList-dom dojo/_base/fx dojo/fx/easing dojo/promise/all dojo/Evented dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/Button dijit/form/CheckBox dijit/form/Form dijit/form/Select dijit/form/TextBox dijit/form/NumberTextBox dijit/form/ToggleButton dijit/form/ValidationTextBox dijit/layout/ContentPane dijit/form/FilteringSelect dijit/Dialog dijit/ConfirmDialog dojox/mvc/at dgrid1/OnDemandGrid dgrid1/Tree dgrid1/Editor dgrid1/Keyboard dgrid1/Selection dgrid1/Selector dgrid1/extensions/ColumnResizer dgrid1/extensions/DijitRegistry ../../kernel ../../lang ../../geometry/Extent ../../SpatialReference ../../layers/ArcGISImageServiceLayer ./_Widget ./utils ./SettingsViewModel ./JobsList ./components/DataStoreSelect dojo/i18n!../../nls/jsapi dojo/text!./templates/Settings.html".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da,Q,K,E,N,I,O,U,ha,ia,S,W,ka,ja,ma,ta,D,P,Y){var Z=m([X,K,E,N,Q,da,I,O]);H=ka.createSubclass([B,F,x,w],{declaredClass:"esri.dijit.analysis.Settings",templateString:Y,widgetsInTemplate:!0,i18n:null,toolName:"Settings",helpFileName:"AnalysisEnvironments",viewModelType:ma,cssClass:{primaryButton:"btn calcite blue",button:"btn calcite"},constructor:function(V,ea){this._pbConnects=[];V.containerNode&&(this.container=
V.containerNode);this.cssClass=n.mixin({},this.cssClass)},destroy:function(){this.inherited(arguments);r.forEach(this._pbConnects,l.disconnect);delete this._pbConnects},postMixInProperties:function(){this.inherited(arguments);this.i18n={};n.mixin(this.i18n,P.common);n.mixin(this.i18n,P.analysisSettings);this._initModelWatchers()},postCreate:function(){this.inherited(arguments);this.viewModel.showOkCancel&&(this._state={});this.initUI()},startup:function(){this._spatialRefGrid.startup()},initUI:function(){this._rasterUX=
[this._snapLblRow,this._snapSelRow,this._rasterLblRow,this._cellLblRow,this._cellSelectRow,this._cellSelectNumRow,this._maskLblRow,this._maskSelRow];this._extentUX=[this._processExtLblRow,this._extentLblRow,this._extentRow];this._coordSysUX=[this._processSRRow,this._processSRLblRow,this._outSRLblRow,this._outSRRow,this._coordinateLblRow];this._geoanalyticsUX=[this._geoanalyticsLblRow,this._datastoreLabelRow,this._selectDataStore];this._rasterPPFUX=[this._parallelProcessingLblRow,this._parallelProcessingFactorLblRow,
this._parallelProcessingFactorNumRow];this._rasterPTUX=[this._processorLblRow,this._processorTypeLblRow,this._processorTypeSelRow];this._rasterStorageUX=[this._storageLblRow,this._resamplingMethodLblRow,this._resamplingMethodSelRow];ja.initHelpLinks(this.domNode,this.viewModel.showHelp);ja.updateDisplay(this._rasterUX,this.viewModel.showRasterSettings,"table-row");ja.updateDisplay([this._overwriteRow],this.viewModel.showOverwriteResultOption,"table-row");ja.updateDisplay([this._closeAnalysisRow],
this.viewModel.showCloseAnalysisOption,"table-row");ja.updateDisplay([this._storeAnalysisRow],this.viewModel.showStoreAnalysisOption,"table-row");ja.updateDisplay(this._coordSysUX,this.viewModel.showCoordinateSystems,"table-row");ja.updateDisplay([this._processSRRow,this._processSRLblRow],this.viewModel.showProcessSR,"table-row");ja.updateDisplay([this._outSRLblRow,this._outSRRow],this.viewModel.showOutSR,"table-row");ja.updateDisplay([this._coordinateLblRow],this.viewModel.showProcessSR||this.viewModel.showProcessSR,
"table-row");ja.updateDisplay(this._extentUX,this.viewModel.showExtent,"table-row");ja.updateDisplay([this._closeDiv],this.viewModel.showCloseIcon,"block");ja.updateDisplay([this._settingsHeader],this.viewModel.showHeader,"block");ja.updateDisplay([this._actionbuttonCtr],this.viewModel.showOkCancel,"block");ja.updateDisplay(this._geoanalyticsUX,this.viewModel.showGeoAnalyticsSettings,"table-row");ja.updateDisplay(this._rasterPPFUX,this.viewModel.showRasterPPFSettings,"table-row");ja.updateDisplay(this._rasterPTUX,
this.viewModel.showRasterPTSettings,"table-row");ja.updateDisplay([this._maskLblRow,this._maskSelRow],this.viewModel.showRasterMaskSettings,"table-row");ja.updateDisplay([this._snapLblRow,this._snapSelRow],this.viewModel.showRasterSnapSettings,"table-row");ja.updateDisplay([this._cellLblRow,this._cellSelectRow,this._cellSelectNumRow],this.viewModel.showCellsizeSettings,"table-row");ja.updateDisplay(this._rasterStorageUX,this.viewModel.showResamplingSettings,"table-row");ja.updateDisplay([this._creditWarningRow],
this.viewModel.showCreditWarningSettings,"table-row");this._spatialRefGrid||(this._spatialRefGrid=new Z({collection:this.viewModel.spatialRefStore,id:this.id+"_settingsgrid",showHeader:!1,columns:[{renderExpando:!0,label:"Name",field:"name",sortable:!1,resizable:!0}],"class":"esriAnalysisSpatialRefTree"},this._spatialRefGridNode),g(".dijitButton",this._coordDialog.domNode).forEach(function(V,ea){0===ea?p.add(V,this.cssClass.primaryButton):p.add(V,this.cssClass.button)},this));this.viewModel.outSR&&
this._outSRInput.set("value",this.viewModel.outSR.wkid);this.viewModel.processSR&&this._processSRInput.set("value",this.viewModel.processSR.wkid);this.viewModel.layers&&this._updateLayerOptions(this.viewModel.layers);this._updateProcessSRSelectValue();this._handleProcessSRSelectChange(this._processSRSelect.get("value"));this._updateOutSRSelectValue();this._handleSRSelectChange(this._outSRSelect.get("value"));this._updateExtentSelectValue();this._handleExtentOptionChange(this._extentSelect.get("value"));
this._updateCellSizeSelectValue();this._handleCellSizeSelectChange(this._cellSizeSelect.get("value"));this._updateSnapRasterSelectValue();this._handleSnapRasterSelectChange(this._snapRasterSelect.get("value"));this._updateMaskSelectValue();this._handleMaskSelectChange(this._maskSelect.get("value"));this._updateProcessorTypeSelectValue();this._handleProcessorTypeSelectChange(this._processorTypeSelect.get("value"));this._updateparallelProcessingFactorInputValue();this._handleparallelProcessingFactorInputChange(this._parallelProcessingFactorInput.get("value"));
this._updaterecycleProcessingWorkersInputValue();this._handlerecycleProcessingWorkersInputChange(this._recycleProcessingWorkersInput.get("value"));this._updateretryOnFailuresInputValue();this._handleretryOnFailuresInputChange(this._retryOnFailuresInput.get("value"));this._updateResamplingMethodSelectValue();this._handleResamplingMethodSelectChange(this._resamplingMethodSelect.get("value"));this._closeAnalysisCheck.set("checked",this.viewModel.closeAnalysisWidget);this._storeAnalysisCheck.set("checked",
!this.viewModel.returnFeatureCollection);this._creditWarningCheck.set("checked",this.viewModel.creditWarning);this.viewModel.showJobsHistory&&this.buildJobsUI();this.viewModel.showGeoAnalyticsSettings&&this.buildDataStoreUI();this._handleCloseMsg()},_initModelWatchers:function(){this.own(this.viewModel.watch("showCloseIcon",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._closeDiv],na,"block")})),this.viewModel.watch("showHelp",n.hitch(this,function(V,ea,na){ja.initHelpLinks(this.domNode,na)})),
this.viewModel.watch("showOverwriteResultOption",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._overwriteRow],na,"table-row")})),this.viewModel.watch("showCloseAnalysisOption",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._closeAnalysisRow],na,"table-row")})),this.viewModel.watch("showStoreAnalysisOption",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._storeAnalysisRow],na,"table-row")})),this.viewModel.watch("showCoordinateSystems",n.hitch(this,function(V,ea,na){ja.updateDisplay(this._coordSysUX,
na,"table-row")})),this.viewModel.watch("showProcessSR",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._processSRRow,this._processSRLblRow],na,"table-row");ja.updateDisplay([this._coordinateLblRow],na||this.viewModel.showOutSR,"table-row");this._updateProcessSRSelectValue();this._handleProcessSRSelectChange(this._processSRSelect.get("value"))})),this.viewModel.watch("showOutSR",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._outSRLblRow,this._outSRRow],na,"table-row");ja.updateDisplay([this._coordinateLblRow],
na||this.viewModel.showProcessSR,"table-row");this._updateOutSRSelectValue();this._handleSRSelectChange(this._outSRSelect.get("value"))})),this.viewModel.watch("showExtent",n.hitch(this,function(V,ea,na){ja.updateDisplay(this._extentUX,na,"table-row");this._updateExtentSelectValue();na&&this._handleExtentOptionChange(this._extentSelect.get("value"))})),this.viewModel.watch("showRasterSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay(this._rasterUX,na,"table-row");this._updateCellSizeSelectValue();
this._handleCellSizeSelectChange(this._cellSizeSelect.get("value"));this._updateSnapRasterSelectValue();this._handleSnapRasterSelectChange(this._snapRasterSelect.get("value"));this._updateMaskSelectValue();this._handleMaskSelectChange(this._maskSelect.get("value"));this._updateResamplingMethodSelectValue();this._handleResamplingMethodSelectChange(this._resamplingMethodSelect.get("value"))})),this.viewModel.watch("showRasterPPFSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay(this._rasterPPFUX,
na,"table-row");this._updateparallelProcessingFactorInputValue();this._handleparallelProcessingFactorInputChange(this._parallelProcessingFactorInput.get("value"))})),this.viewModel.watch("showRasterPTSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay(this._rasterPTUX,na,"table-row");ja.updateDisplay([this._maskLblRow,this._maskSelRow],!na&&this.viewModel.showRasterSettings,"table-row");this._updateProcessorTypeSelectValue();this._handleProcessorTypeSelectChange(this._processorTypeSelect.get("value"))})),
this.viewModel.watch("showRasterSnapSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._snapLblRow,this._snapSelRow],na,"table-row");this._updateparallelProcessingFactorInputValue();this._handleSnapRasterSelectChange(this._snapRasterSelect.get("value"))})),this.viewModel.watch("showRasterMaskSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._maskLblRow,this._maskSelRow],na,"table-row");this._handleMaskSelectChange(this._maskSelect.get("value"))})),this.viewModel.watch("showCellsizeSettings",
n.hitch(this,function(V,ea,na){ja.updateDisplay([this._cellLblRow,this._cellSelectRow,this._cellSelectNumRow],na,"table-row");this._updateCellSizeSelectValue();this._handleCellSizeSelectChange(this._cellSizeSelect.get("value"))})),this.viewModel.watch("layers",n.hitch(this,function(V,ea,na){this._updateLayerOptions(this.viewModel.layers)})),this.viewModel.watch("showHeader",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._settingsHeader],na,"block")})),this.viewModel.watch("showOkCancel",n.hitch(this,
function(V,ea,na){ja.updateDisplay([this._actionbuttonCtr],na,"block")})),this.viewModel.watch("showGeoAnalyticsSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay(this._geoanalyticsUX,na,"table-row");na&&this.buildDataStoreUI()})),this.viewModel.watch("isCustomProcessSR",n.hitch(this,function(){this._updateProcessSRSelectValue();this._handleProcessSRSelectChange(this._processSRSelect.get("value"))})),this.viewModel.watch("isCustomExtent",n.hitch(this,function(){this._updateExtentSelectValue();
this._handleExtentOptionChange(this._extentSelect.get("value"))})),this.viewModel.watch("isCustomOutSR",n.hitch(this,function(){this._updateOutSRSelectValue();this._handleSRSelectChange(this._outSRSelect.get("value"))})),this.viewModel.watch("closeAnalysisWidget",n.hitch(this,function(V,ea,na){this._handleCloseAnalysisCheck(na)})),this.viewModel.watch("returnFeatureCollection",n.hitch(this,function(V,ea,na){this._handleReturnFeatureCollectionCheck(na)})),this.viewModel.watch("showJobsHistory",n.hitch(this,
this.buildJobsUI)),this.viewModel.watch("jobsViewModel",n.hitch(this,this.buildJobsUI)),this.viewModel.watch("showResamplingSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay(this._rasterStorageUX,na,"table-row")})),this.viewModel.watch("showCreditWarningSettings",n.hitch(this,function(V,ea,na){ja.updateDisplay([this._creditWarningRow],na,"table-row")})))},buildJobsUI:function(){ja.updateDisplay([this._settingsNavCtrl],this.viewModel.showJobsHistory,"block");p.toggle(this._form.domNode,"tab-contents tab-section is-active",
this.viewModel.showJobsHistory);p.toggle(this._jobHistoryCtr,"tab-contents tab-section",this.viewModel.showJobsHistory);p.toggle(this.domNode,"esri-analysis-category",this.viewModel.showJobsHistory);this.viewModel.showJobsHistory&&(this._addTabHandlers||(g(".tab-nav a",this.domNode).on("click",n.hitch(this,function(V){V.stopPropagation();g(".tab-title",this.domNode).removeClass("is-active");p.add(V.target,"is-active");V=p.contains(V.target,"general-tab");ja.updateDisplay([this._form.domNode],V,"block");
ja.updateDisplay([this._jobHistoryCtr],!V,"block")})),this._addTabHandlers=!0),this.buildJobsList())},buildJobsList:function(){this.viewModel.jobsViewModel&&!this._jobsListWidget&&(this._jobsListWidget=new ta({viewModel:this.viewModel.jobsViewModel},this._jobsListDiv))},buildDataStoreUI:function(){this._dataStoreSelect||(this._dataStoreSelect=new D({geoAnalyticsServer:this.viewModel.geoAnalyticsServer,value:this.viewModel.get("datastore")},c.create("div",null,this._dataStoreTd)),this._dataStoreSelect.startup(),
this._dataStoreSelect.on("change",n.hitch(this,this._handleDSSelectChange)))},_updateExtentSelectValue:function(){if(this.viewModel.get("isCustomExtent"))this._extentSelect.set("value","SPECIFIED");else if(this.viewModel.viewProps&&this.viewModel.viewProps.extentLayer&&this._layerNames){var V=r.indexOf(this._layerNames,this.viewModel.viewProps.extentLayer.name);this._extentSelect.set("value","LAYER_"+V)}else this._extentSelect.set("value","DEFAULT");this.viewModel.get("isCustomExtent")&&this.viewModel.extent&&
(this._xMinInput.set("value",this.viewModel.extent.xmin),this._xMaxInput.set("value",this.viewModel.extent.xmax),this._yMinInput.set("value",this.viewModel.extent.ymin),this._yMaxInput.set("value",this.viewModel.extent.ymax))},_updateProcessSRSelectValue:function(){this.viewModel.processSR&&this.viewModel.get("isCustomProcessSR")&&this._processSRInput.set("value",this.viewModel.processSR.wkid);if(this.viewModel.get("isCustomProcessSR"))this._processSRSelect.set("value","SPECIFIED");else if(this.viewModel.viewProps&&
this.viewModel.viewProps.pSRLayer&&this._layerNames){var V=r.indexOf(this._layerNames,this.viewModel.viewProps.pSRLayer.name);this._processSRSelect.set("value","LAYER_"+V)}else this._processSRSelect.set("value","DEFAULT")},_updateOutSRSelectValue:function(){this.viewModel.outSR&&this.viewModel.get("isCustomOutSR")&&this._outSRInput.set("value",this.viewModel.outSR.wkid);if(this.viewModel.get("isCustomOutSR"))this._outSRSelect.set("value","SPECIFIED");else if(this.viewModel.viewProps&&this.viewModel.viewProps.outSRLayer&&
this._layerNames){var V=r.indexOf(this._layerNames,this.viewModel.viewProps.outSRLayer.name);this._outSRSelect.set("value","LAYER_"+V)}else this._outSRSelect.set("value","DEFAULT")},_updateCellSizeSelectValue:function(){if(this.viewModel.get("isCustomCellSize"))this._cellSizeSelect.set("value","SPECIFIED");else if(this.viewModel.viewProps&&this.viewModel.viewProps.cellSizeLayer&&this._layerNames){var V=r.indexOf(this._layerNames,this.viewModel.viewProps.cellSizeLayer.name);this._cellSizeSelect.set("value",
"LAYER_"+V)}else this.viewModel.cellSize?this._cellSizeSelect.set("value",this.viewModel.cellSize):this._cellSizeSelect.set("value",this._cellSizeSelect.get("value"));this.viewModel.get("isCustomCellSize")&&this.viewModel.cellSize&&this._cellSizeInput.set("value",this.viewModel.cellSize)},_updateSnapRasterSelectValue:function(){if(this.viewModel.viewProps&&this.viewModel.viewProps.snapRasterLayer&&this._layerNames){var V=r.indexOf(this._layerNames,this.viewModel.viewProps.snapRasterLayer.name);this._snapRasterSelect.set("value",
"LAYER_"+this._layerNames[V])}else this._snapRasterSelect.set("value",this._snapRasterSelect.get("value"))},_updateMaskSelectValue:function(){if(this.viewModel.viewProps&&this.viewModel.viewProps.maskLayer&&this._layerNames){var V=r.indexOf(this._layerNames,this.viewModel.viewProps.maskLayer.name);this._maskSelect.set("value","LAYER_"+V)}else this._maskSelect.set("value",this._maskSelect.get("value"))},_updateProcessorTypeSelectValue:function(){this.viewModel.processorType?this._processorTypeSelect.set("value",
this.viewModel.processorType):this._processorTypeSelect.set("value",this._processorTypeSelect.get("value"))},_updateparallelProcessingFactorInputValue:function(){this.viewModel.parallelProcessingFactor?this._parallelProcessingFactorInput.set("value",this.viewModel.parallelProcessingFactor):this._parallelProcessingFactorInput.set("value",this._parallelProcessingFactorInput.get("value"))},_updaterecycleProcessingWorkersInputValue:function(){this.viewModel.recycleProcessingWorkers?this._recycleProcessingWorkersInput.set("value",
this.viewModel.recycleProcessingWorkers):this._recycleProcessingWorkersInput.set("value",this._recycleProcessingWorkersInput.get("value"))},_updateretryOnFailuresInputValue:function(){this.viewModel.retryOnFailures?this._retryOnFailuresInput.set("value",this.viewModel.retryOnFailures):this._retryOnFailuresInput.set("value",this._retryOnFailuresInput.get("value"))},_updateResamplingMethodSelectValue:function(){this.viewModel.resamplingMethod?this._resamplingMethodSelect.set("value",this.viewModel.resamplingMethod):
this._resamplingMethodSelect.set("value",this._resamplingMethodSelect.get("value"))},_handleSRSelectChange:function(V){this._coordDialog.hide();this._outSRBtn.set("disabled","SPECIFIED"!==V);ja.updateDisplay(this._outSRCustomRow,"SPECIFIED"===V&&this.viewModel.showOutSR,"table-row");ja.updateDisplay(this._outSRCustomInputRow,"SPECIFIED"===V&&this.viewModel.showOutSR,"table-row");this._outSRInput.set("required","SPECIFIED"===V);-1!==V.indexOf("LAYER_")&&(V=V.split("_")[1],V=this.viewModel.layers[V],
this.viewModel.showOkCancel?(this._outSR={wkid:parseInt(V.fullExtent.spatialReference.wkid,10)},this._state.outSRLayer={name:V.name,url:V.url,fullExtent:V.fullExtent}):this.viewModel.set("outSR",{wkid:parseInt(V.fullExtent.spatialReference.wkid,10)}))},_handleProcessSRSelectChange:function(V){this._coordDialog.hide();this._processSRBtn.set("disabled","SPECIFIED"!==V);ja.updateDisplay(this._processSRCustomRow,"SPECIFIED"===V&&this.viewModel.showProcessSR,"table-row");ja.updateDisplay(this._processSRCustomInputRow,
"SPECIFIED"===V&&this.viewModel.showProcessSR,"table-row");this._processSRInput.set("required","SPECIFIED"===V);-1!==V.indexOf("LAYER_")&&(V=V.split("_")[1],V=this.viewModel.layers[V],this.viewModel.showOkCancel?(this._processSR={wkid:parseInt(V.fullExtent.spatialReference.wkid,10)},this._state.pSRLayer={name:V.name,url:V.url,fullExtent:V.fullExtent}):this.viewModel.set("processSR",{wkid:parseInt(V.fullExtent.spatialReference.wkid,10)}))},_handleOutSRBtnClick:function(){this._outSRClick=!0;this._coordDialog.show()},
_handleProcessSRBtnClick:function(){this._outSRClick=!1;this._coordDialog.show()},_handleExtentOptionChange:function(V){var ea="SPECIFIED"===V;ja.updateDisplay([this._extentLbl,this._customExtentRow],this.viewModel.showExtent&&ea,"table-row");this._xMinInput.set("required",ea);this._xMaxInput.set("required",ea);this._yMinInput.set("required",ea);this._yMaxInput.set("required",ea);-1!==V.indexOf("LAYER_")?(V=V.split("_")[1],V=this.viewModel.layers[V],ea=new ia(V.fullExtent),this.viewModel.showOkCancel?
(this._extent=ea.shiftCentralMeridian(),this._state.extentLayer={name:V.name,url:V.url,fullExtent:V.fullExtent}):this.viewModel.set("extent",ea.shiftCentralMeridian())):"SPECIFIED"===V?(ea=new ia(this._xMinInput.get("value"),this._yMinInput.get("value"),this._xMaxInput.get("value"),this._yMaxInput.get("value"),new S({wkid:102100})),this.viewModel.showOkCancel?(this._extent=ea,this._state.extentLayer=null):this.viewModel.set("extent",ea)):"DEFAULT"===V&&(this._extent=null,this._state.extentLayer=null)},
_validateExtent:function(){var V=!0,ea="";this._handleCloseMsg();this._xMinInput.get("value")>this._xMaxInput.get("value")&&(V=!1,ea+=this.i18n.xMinMaxExtent);this._yMinInput.get("value")>this._yMaxInput.get("value")&&(V=!1,ea+="\x3cbr/\x3e"+this.i18n.yMinMaxExtent);V||this._showMessages(ea);return V},_handleSRDlgOk:function(){var V;for(ea in this._spatialRefGrid.get("selection"))this._spatialRefGrid.get("selection").hasOwnProperty(ea)&&(V=ea);V=this._spatialRefGrid.collection.getSync(V);var ea=V.sRef.wkid;
this.viewModel.showOkCancel?this._outSRClick?this._outSR={wkid:parseInt(ea,10)}:this._processSR={wkid:parseInt(ea,10)}:this.viewModel.set(this._outSRClick?"outSR":"processSR",{wkid:parseInt(ea,10)});this._outSRClick?this._outSRInput.textbox.value=ea:this._processSRInput.textbox.value=ea;this._outSRClick?h.set(this._outSRLabel,"innerHTML",V.name):h.set(this._processSRLabel,"innerHTML",V.name)},_handleSRDlgCancel:function(){},_handleOutSRInputChange:function(V){V&&(h.set(this._outSRLabel,"innerHTML",
""),ja.updateDisplay([this._outSRLabel],!1,"inline"),this.viewModel.showOkCancel?(this._outSR={wkid:parseInt(V,10)},this._state.outSRLayer=null):this.viewModel.set("outSR",{wkid:parseInt(V,10)}))},_handleProcessSRInputChange:function(V){V&&(h.set(this._processSRLabel,"innerHTML",""),ja.updateDisplay([this._processSRLabel],!1,"inline"),this.viewModel.showOkCancel?(this._processSR={wkid:parseInt(V,10)},this._state.pSRLayer=null):this.viewModel.set("processSR",{wkid:parseInt(V,10)}))},_handleCellSizeSelectChange:function(V){ja.updateDisplay([this._cellSelectNumRow],
"SPECIFIED"===V&&this.viewModel.showRasterSettings,"table-row");-1!==V.indexOf("LAYER_")?(V=this._cellSizeSelect.getOptions(V),this.viewModel.showOkCancel?(this._cellSize={url:V.url},this._state.cellSizeLayer={name:V.label.substring(6),url:V.url,fullExtent:V.fullExtent}):this.viewModel.set("cellSize",{url:V.url})):"SPECIFIED"===V?this.viewModel.showOkCancel?(this._cellSize=this._cellSizeInput.get("value"),this._state.cellSizeLayer=null):this.viewModel.set("cellSize",this._cellSizeInput.get("value")):
this.viewModel.showOkCancel?(this._cellSize=V,this._state.cellSizeLayer=null):this.viewModel.set("cellSize",V)},_handleSnapRasterSelectChange:function(V){-1!==V.indexOf("LAYER_")?(V=this._snapRasterSelect.getOptions(V),this.viewModel.showOkCancel?(this._snapRaster={url:V.url},this._state.snapRasterLayer={name:V.label.substring(6),url:V.url,fullExtent:V.fullExtent}):this.viewModel.set("snapRaster",{url:V.url})):this.viewModel.showOkCancel?(this._snapRaster="NONE"===V?void 0:V,this._state.snapRasterLayer=
null):this.viewModel.set("snapRaster","NONE"===V?void 0:V)},_handleMaskSelectChange:function(V){-1!==V.indexOf("LAYER_")?(V=this._maskSelect.getOptions(V),this.viewModel.showOkCancel?(this._mask={url:V.url},this._state.maskLayer={name:V.label.substring(6),url:V.url,fullExtent:V.fullExtent}):this.viewModel.set("mask",{url:V.url})):this.viewModel.showOkCancel?(this._mask="NONE"===V?void 0:V,this._state.maskLayer=null):this.viewModel.set("mask","NONE"===V?void 0:V)},_handleCellSizeInputChange:function(V){V&&
"SPECIFIED"===this._cellSizeSelect.get("value")&&(this.viewModel.showOkCancel?this._cellSize=V:this.viewModel.set("cellSize",V))},_handleDSSelectChange:function(V){this.viewModel.showOkCancel||this.viewModel.set("datastore",V.value)},_handleProcessorTypeSelectChange:function(V){this.viewModel.showOkCancel?this._processorType="NONE"===V?void 0:V:this.viewModel.set("processorType",V)},_handleparallelProcessingFactorInputChange:function(V){this.viewModel.showOkCancel?this._parallelProcessingFactor=V:
this.viewModel.set("parallelProcessingFactor",V)},_handlerecycleProcessingWorkersInputChange:function(V){this.viewModel.showOkCancel?this._recycleProcessingWorkers=V:this.viewModel.set("recycleProcessingWorkers",V)},_handleretryOnFailuresInputChange:function(V){this.viewModel.showOkCancel?this._retryOnFailures=V:this.viewModel.set("retryOnFailures",V)},_handleResamplingMethodSelectChange:function(V){this.viewModel.showOkCancel?this._resamplingMethod=V:this.viewModel.set("resamplingMethod",V)},_updateLayerOptions:function(V){var ea=
r.map(V,function(ra,qa){return{value:"LAYER_"+qa,label:"Layer "+ra.name,url:ra.url,fullExtent:ra.fullExtent}}),na=[{value:"minof",label:this.i18n.minInputs},{value:"maxof",label:this.i18n.maxInputs,selected:!0},{value:"SPECIFIED",label:this.i18n.extentSpecfiedBelow}],pa=[{value:"DEFAULT",label:this.i18n.defaultLabel},{value:"SPECIFIED",label:this.i18n.extentSpecfiedBelow}],sa=[{value:"GPU",label:this.i18n.gpu},{value:"CPU",label:this.i18n.cpu}],ua=[{value:"NEAREST",label:this.i18n.nearest},{value:"BILINEAR",
label:this.i18n.bilinear},{value:"CUBIC",label:this.i18n.cubic}];var Aa=[].concat([{value:"DEFAULT",label:this.i18n.defaultExtentLabel},{value:"SPECIFIED",label:this.i18n.extentSpecfiedBelow}]).concat(ea);pa=[].concat(pa).concat(ea);var wa=r.filter(V,function(ra){return ra instanceof W||"esri.layers.RasterXLayer"===ra.declaredClass||ra.url&&"imageserver"===ra.url.split("/").pop().toLowerCase()});ea=[].concat(r.map(wa,function(ra,qa){return{value:"LAYER_"+ra.name,label:"Layer "+ra.name,url:ra.url,
fullExtent:ra.fullExtent}},this));var va=r.map(V,function(ra,qa){return-1<wa.indexOf(ra)?{value:"LAYER_"+ra.name,label:"Layer "+ra.name,url:ja.constructAnalysisInputLyrObj(ra).url,fullExtent:ra.fullExtent}:{value:"LAYER_"+qa,label:"Layer "+ra.name,url:ra.url,fullExtent:ra.fullExtent}});this._layerNames=r.map(V,function(ra,qa){return ra.name});this._outSRSelect.removeOption(this._outSRSelect.getOptions());this._processSRSelect.removeOption(this._processSRSelect.getOptions());this._extentSelect.removeOption(this._extentSelect.getOptions());
this._maskSelect.removeOption(this._maskSelect.getOptions());this._cellSizeSelect.removeOption(this._cellSizeSelect.getOptions());this._snapRasterSelect.removeOption(this._snapRasterSelect.getOptions());this._processorTypeSelect.removeOption(this._processorTypeSelect.getOptions());this._resamplingMethodSelect.removeOption(this._resamplingMethodSelect.getOptions());this._outSRSelect.addOption(Aa);this._processSRSelect.addOption(Aa);this._extentSelect.addOption(pa);this._maskSelect.addOption([{value:"NONE",
label:""}].concat(va));this._cellSizeSelect.addOption([].concat(na).concat(ea));this._snapRasterSelect.addOption([{value:"NONE",label:""}].concat(ea));this._processorTypeSelect.addOption([{value:"NONE",label:""}].concat(sa));this._resamplingMethodSelect.addOption(ua);this._updateExtentSelectValue();this._updateOutSRSelectValue();this._updateProcessSRSelectValue();this._updateCellSizeSelectValue();this._updateSnapRasterSelectValue();this._updateMaskSelectValue();this._updateProcessorTypeSelectValue();
this._updateparallelProcessingFactorInputValue();this._updaterecycleProcessingWorkersInputValue();this._updateretryOnFailuresInputValue();this._updateResamplingMethodSelectValue()},_handleCloseAnalysisCheck:function(V){this.viewModel.showOkCancel||this.viewModel.set("closeAnalysisWidget",V)},_handleReturnFeatureCollectionCheck:function(V){this.viewModel.showOkCancel||this.viewModel.set("returnFeatureCollection",!V)},_handleOkButtonClick:function(V){V&&V.preventDefault();this._form.validate()&&("SPECIFIED"!==
this._extentSelect.get("value")||this._validateExtent())&&(this.viewModel.set("viewProps",this._state),"DEFAULT"!==this._outSRSelect.get("value")?this.viewModel.set("outSR",this._outSR):"DEFAULT"===this._outSRSelect.get("value")&&this.viewModel.set("outSR",null),"DEFAULT"!==this._processSRSelect.get("value")?this.viewModel.set("processSR",this._processSR):"DEFAULT"===this._processSRSelect.get("value")&&this.viewModel.set("processSR",null),"SPECIFIED"===this._extentSelect.get("value")&&this._validateExtent()&&
(this._extent=new ia(this._xMinInput.get("value"),this._yMinInput.get("value"),this._xMaxInput.get("value"),this._yMaxInput.get("value"),new S({wkid:102100}))),this.viewModel.set("extent",this._extent),this.viewModel.set("mask",this._mask),this.viewModel.set("snapRaster",this._snapRaster),this.viewModel.set("cellSize",this._cellSize),this.viewModel.set("resamplingMethod",this._resamplingMethod),this.viewModel.set("creditWarningChecked",this._creditWarning),this._dataStoreSelect&&this.viewModel.set("datastore",
this._dataStoreSelect.get("value")),this.viewModel.set("closeAnalysisWidget",this._closeAnalysisCheck.get("checked")),this.viewModel.set("returnFeatureCollection",!this._storeAnalysisCheck.get("checked")),this.viewModel.set("isCustomExtent","SPECIFIED"===this._extentSelect.get("value")),this.viewModel.set("isCustomOutSR","SPECIFIED"===this._outSRSelect.get("value")),this.viewModel.set("isCustomProcessSR","SPECIFIED"===this._processSRSelect.get("value")),this.viewModel.set("isCustomCellSize","SPECIFIED"===
this._cellSizeSelect.get("value")),this.viewModel.set("processorType",this._processorType),this.viewModel.set("parallelProcessingFactor",this._parallelProcessingFactor),this.viewModel.set("recycleProcessingWorkers",this._recycleProcessingWorkers),this.viewModel.set("retryOnFailures",this._retryOnFailures),this.viewModel.save(),this.emit("ok-settings",{viewMode:this.viewModel}))},_handleCancelButtonClick:function(){this.viewModel.reset();this.reset();this.emit("cancel-settings",{viewMode:this.viewModel})},
_handleCreditWarningCheck:function(V){this.viewModel.set("creditWarning",V)},reset:function(){"SPECIFIED"!==this._extentSelect.get("value")||this._validateExtent()||this.viewModel.get("isCustomExtent")||(this._xMinInput.reset(),this._xMaxInput.reset(),this._yMinInput.reset(),this._yMaxInput.reset());this.initUI()},_showMessages:function(V){h.set(this._bodyNode,"innerHTML",V);v.fadeIn({node:this._errorMessagePane,easing:t.quadIn,onEnd:n.hitch(this,function(){e.set(this._errorMessagePane,{display:""})})}).play()},
_handleCloseMsg:function(V){V&&V.preventDefault();v.fadeOut({node:this._errorMessagePane,easing:t.quadOut,onEnd:n.hitch(this,function(){e.set(this._errorMessagePane,{display:"none"})})}).play()}});a("extend-esri")&&n.setObject("dijit.analysis.Settings",H,U);return H})},"dojo/NodeList":function(){define(["./query"],function(H){return H.NodeList})},"dijit/ConfirmDialog":function(){define(["dojo/_base/declare","./Dialog","./_ConfirmDialogMixin"],function(H,m,n){return H("dijit.ConfirmDialog",[m,n],{})})},
"dijit/_ConfirmDialogMixin":function(){define(["dojo/_base/declare","./_WidgetsInTemplateMixin","dojo/i18n!./nls/common","dojo/text!./templates/actionBar.html","./form/Button"],function(H,m,n,r){return H("dijit._ConfirmDialogMixin",m,{actionBarTemplate:r,buttonOk:n.buttonOk,_setButtonOkAttr:{node:"okButton",attribute:"label"},buttonCancel:n.buttonCancel,_setButtonCancelAttr:{node:"cancelButton",attribute:"label"}})})},"dojox/mvc/at":function(){define(["dojo/_base/kernel","dojo/_base/lang","./sync",
"./_atBindingExtension"],function(H,m,n){H.experimental("dojox.mvc");H=function(r,l){return{atsignature:"dojox.mvc.at",target:r,targetProp:l,bindDirection:n.both,direction:function(k){this.bindDirection=k;return this},transform:function(k){this.converter=k;return this},equals:function(k){this.equalsCallback=k;return this}}};H.from=n.from;H.to=n.to;H.both=n.both;return m.setObject("dojox.mvc.at",H)})},"dojox/mvc/sync":function(){define(["dojo/_base/lang","dojo/_base/config","dojo/_base/array","dojo/has"],
function(H,m,n,r){function l(d,f,e,h,c,g,p,q,u,v){if(!(e(u,q)||"*"==c&&0>n.indexOf(h.get("properties")||[p],p)||"*"==c&&p in(v||{}))){e="*"==c?p:c;if(r("mvc-bindings-log-api"))var t=b(h,e,g,p);try{u=d?d(u,f):u}catch(y){r("mvc-bindings-log-api")&&console.log("Copy from"+t.join(" to ")+" was not done as an error is thrown in the converter.");return}r("mvc-bindings-log-api")&&console.log(t.reverse().join(" is being copied from: ")+" (Value: "+u+" from "+q+")");H.isFunction(h.set)?h.set(e,u):h[e]=u}}
var k=H.getObject("dojox.mvc",!0);r.add("mvc-bindings-log-api",(m.mvc||{}).debugBindings);var b=r("mvc-bindings-log-api")?function(d,f,e,h){return[[e.canConvertToLoggable||!e.declaredClass?e:e.declaredClass,h].join(":"),[d.canConvertToLoggable||!d.declaredClass?d:d.declaredClass,f].join(":")]}:"";m={from:1,to:2,both:3};var a=function(d,f,e,h,c){var g=(c||{}).converter;if(g){var p={source:d,target:e};var q=g.format&&H.hitch(p,g.format);var u=g.parse&&H.hitch(p,g.parse)}var v=[],t=[],y=H.mixin({},d.constraints,
e.constraints);g=(c||{}).bindDirection||k.both;var C=(c||{}).equals||a.equals;if(r("mvc-bindings-log-api"))var B=b(d,f,e,h);if("*"==h){if("*"!=f)throw Error("Unmatched wildcard is specified between source and target.");c=e.get("properties");if(!c){c=[];for(var F in e)e.hasOwnProperty(F)&&"_watchCallbacks"!=F&&c.push(F)}t=e.get("excludes")}else c=[f];g&k.from&&(H.isFunction(d.set)&&H.isFunction(d.watch)?v.push(d.watch.apply(d,("*"!=f?[f]:[]).concat([function(x,w,A){l(q,y,C,e,h,d,x,w,A,t)}]))):r("mvc-bindings-log-api")&&
console.log(B.reverse().join(" is not a stateful property. Its change is not reflected to ")+"."),n.forEach(c,function(x){if("*"!=h||!(x in(t||{}))){var w=H.isFunction(d.get)?d.get(x):d[x];l(q,y,C,e,"*"==h?x:h,d,x,void 0,w)}}));g&k.to&&(g&k.from||n.forEach(c,function(x){if("*"!=h||!(x in(t||{}))){var w=H.isFunction(e.get)?e.get(h):e[h];l(u,y,C,d,x,e,"*"==h?x:h,void 0,w)}}),H.isFunction(e.set)&&H.isFunction(e.watch)?v.push(e.watch.apply(e,("*"!=h?[h]:[]).concat([function(x,w,A){l(u,y,C,d,f,e,x,w,A,
t)}]))):r("mvc-bindings-log-api")&&console.log(B.join(" is not a stateful property. Its change is not reflected to ")+"."));r("mvc-bindings-log-api")&&console.log(B.join(" is bound to: "));F={};F.unwatch=F.remove=function(){for(var x=null;x=v.pop();)x.unwatch();r("mvc-bindings-log-api")&&console.log(B.join(" is unbound from: "))};return F};H.mixin(k,m);return H.setObject("dojox.mvc.sync",H.mixin(a,{equals:function(d,f){return d===f||"number"==typeof d&&isNaN(d)&&"number"==typeof f&&isNaN(f)||H.isFunction((d||
{}).getTime)&&H.isFunction((f||{}).getTime)&&d.getTime()==f.getTime()||(H.isFunction((d||{}).equals)?d.equals(f):H.isFunction((f||{}).equals)?f.equals(d):!1)}},m))})},"dojox/mvc/_atBindingExtension":function(){define(["dojo/_base/config","dojo/has","dijit/_WidgetBase","./atBindingExtension"],function(H,m,n,r){m.add("mvc-extension-per-widget",(H.mvc||{}).extensionPerWidget);m("mvc-extension-per-widget")||r(n.prototype)})},"dojox/mvc/atBindingExtension":function(){define("dojo/aspect dojo/_base/array dojo/_base/lang dijit/_WidgetBase ./_atBindingMixin dijit/registry".split(" "),
function(H,m,n,r,l){return function(k){m.forEach(arguments,function(b){b.dataBindAttr?console.warn("Detected a widget or a widget class that has already been applied data binding extension. Skipping..."):(n._mixin(b,l.mixin),H.before(b,"postscript",function(a,d){this._dbpostscript(a,d)}),H.before(b,"startup",function(){this._started||this._startAtWatchHandles()}),H.before(b,"destroy",function(){this._stopAtWatchHandles()}),H.around(b,"set",function(a){return function(d,f){return d==l.prototype.dataBindAttr?
this._setBind(f):"dojox.mvc.at"==(f||{}).atsignature?this._setAtWatchHandle(d,f):a.apply(this,n._toArray(arguments))}}))});return arguments}})},"dojox/mvc/_atBindingMixin":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/has dojo/Stateful ./resolve ./sync".split(" "),function(H,m,n,r,l,k,b){function a(c){try{var g=require("dijit/registry")}catch(q){return}for(c=c.domNode&&c.domNode.parentNode;c;){if(c=g.getEnclosingWidget(c)){var p=c._relTargetProp||"target";if((m.isFunction(c.get)?
c.get(p):c[p])||p in c.constructor.prototype)return c}c=c&&c.domNode.parentNode}}function d(c,g,p,q,u){function v(){t.Two&&t.Two.unwatch();delete t.Two;var F=y&&(m.isFunction(y.get)?y.get(C):y[C]),x=k(c,F);F=k(p,F);r("mvc-bindings-log-api")&&(!x||/^rel:/.test(c)&&!y)&&e(c,g);r("mvc-bindings-log-api")&&(!F||/^rel:/.test(p)&&!y)&&e(p,q);x&&F&&(!/^rel:/.test(c)&&!/^rel:/.test(p)||y)&&(x.set&&x.watch||"*"!=g?null==g?(m.isFunction(F.set)?F.set(q,x):F[q]=x,r("mvc-bindings-log-api")&&console.log("dojox/mvc/_atBindingMixin set "+
x+" to: "+f(F,q))):t.Two=b(x,g,F,q,u):r("mvc-bindings-log-api")&&e(c,g))}var t={},y=a(p),C=y&&y._relTargetProp||"target";v();if(y&&/^rel:/.test(c)||/^rel:/.test(p)&&m.isFunction(y.set)&&m.isFunction(y.watch))t.rel=y.watch(C,function(F,x,w){x!==w&&(r("mvc-bindings-log-api")&&console.log("Change in relative data binding target: "+y),v())});var B={};B.unwatch=B.remove=function(){for(var F in t)t[F]&&t[F].unwatch(),delete t[F]};return B}var f=r("mvc-bindings-log-api")?function(c,g){return[c._setIdAttr||
!c.declaredClass?c:c.declaredClass,g].join(":")}:"",e=r("mvc-bindings-log-api")?function(c,g){console.warn(g+" could not be resolved"+("string"==typeof c?" with "+c:"")+".")}:"",h={dataBindAttr:"data-mvc-bindings",_dbpostscript:function(c,g){g=this._refs=(c||{}).refs||{};for(var p in c)if("dojox.mvc.at"==(c[p]||{}).atsignature){var q=c[p];delete c[p];g[p]=q}q=new l;var u=this;q.toString=function(){return"[Mixin value of widget "+u.declaredClass+", "+(u.id||"NO ID")+"]"};q.canConvertToLoggable=!0;
this._startAtWatchHandles(q);for(p in g)void 0!==q[p]&&((c=c||{})[p]=q[p]);this._stopAtWatchHandles()},_startAtWatchHandles:function(c){this.canConvertToLoggable=!0;var g=this._refs;if(g){var p=this._atWatchHandles=this._atWatchHandles||{};this._excludes=null;for(var q in g)g[q]&&"*"!=q&&(p[q]=d(g[q].target,g[q].targetProp,c||this,q,{bindDirection:g[q].bindDirection,converter:g[q].converter,equals:g[q].equalsCallback}));"dojox.mvc.at"==(g["*"]||{}).atsignature&&(p["*"]=d(g["*"].target,g["*"].targetProp,
c||this,"*",{bindDirection:g["*"].bindDirection,converter:g["*"].converter,equals:g["*"].equalsCallback}))}},_stopAtWatchHandles:function(){for(var c in this._atWatchHandles)this._atWatchHandles[c].unwatch(),delete this._atWatchHandles[c]},_setAtWatchHandle:function(c,g){if("ref"==c)throw Error(this+": 1.7 ref syntax used in conjunction with 1.8 dojox/mvc/at syntax, which is not supported.");var p=this._atWatchHandles=this._atWatchHandles||{};p[c]&&(p[c].unwatch(),delete p[c]);this._excludes=this[c]=
null;this._started?p[c]=d(g.target,g.targetProp,this,c,{bindDirection:g.bindDirection,converter:g.converter,equals:g.equalsCallback}):this._refs[c]=g},_setBind:function(c){c=eval("({"+c+"})");for(var g in c){var p=c[g];"dojox.mvc.at"!=(p||{}).atsignature?console.warn(g+" in "+dataBindAttr+" is not a data binding handle."):this._setAtWatchHandle(g,p)}},_getExcludesAttr:function(){if(this._excludes)return this._excludes;var c=[],g;for(g in this._atWatchHandles)"*"!=g&&c.push(g);return c},_getPropertiesAttr:function(){if(this.constructor._attribs)return this.constructor._attribs;
var c=["onClick"].concat(this.constructor._setterAttrs);H.forEach(["id","excludes","properties","ref","binding"],function(g){g=H.indexOf(c,g);0<=g&&c.splice(g,1)});return this.constructor._attribs=c}};h[h.dataBindAttr]="";n=n("dojox/mvc/_atBindingMixin",null,h);n.mixin=h;return n})},"dojox/mvc/resolve":function(){define(["dojo/_base/lang","dijit/registry","dojo/Stateful"],function(H,m){return H.setObject("dojox.mvc.resolve",function(n,r){if("string"==typeof n){var l=n.match(/^(expr|rel|widget):(.*)$/)||
[];try{n="rel"==l[1]?H.getObject(l[2]||"",!1,r):"widget"==l[1]?m.byId(l[2]):H.getObject(l[2]||n,!1,r)}catch(k){}}return n})})},"dgrid1/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(H,m,n){return H([m,n],{})})},"dgrid1/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/has ./List ./util/misc dojo/_base/sniff".split(" "),function(H,m,n,r,l,k,b,a){function d(f,e){e&&e.nodeType&&f.appendChild(e)}H=H(b,
{columns:null,hasNeutralSort:!1,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(f){return"object"!==typeof f?this.columns[f]:this.cell(f).column},listType:"grid",cell:function(f,e){if(f.column&&f.element)return f;f.target&&f.target.nodeType&&(f=f.target);if(f.nodeType){do{if(this._rowIdToObject[f.id])break;var h=f.columnId;if(h){e=h;var c=f;break}f=f.parentNode}while(f&&f!==this.domNode)}if(!c&&"undefined"!==typeof e){var g=this.row(f);if(h=g&&g.element){h=h.getElementsByTagName("td");
for(var p=0;p<h.length;p++)if(h[p].columnId===e){c=h[p];break}}}if(null!=f)return{row:g||this.row(f),column:e&&this.column(e),element:c}},createRowCells:function(f,e,h,c,g){var p=n.create("table",{className:"dgrid-row-table",role:"presentation"}),q=9>k("ie")?n.create("tbody",null,p):p,u,v,t;h=h||this.subRows;var y=0;for(u=h.length;y<u;y++){var C=h[y];var B=n.create("tr",null,q);C.className&&(B.className=C.className);var F=0;for(v=C.length;F<v;F++){var x=C[F];var w=x.id;var A=x.field?" field-"+a.escapeCssIdentifier(x.field,
"-"):"";(t="function"===typeof x.className?x.className(c):x.className)&&(A+=" "+t);A=n.create(f,{className:"dgrid-cell"+(w?" dgrid-column-"+a.escapeCssIdentifier(w,"-"):"")+A,role:"th"===f?"columnheader":"gridcell"});A.columnId=w;if(w=x.colSpan)A.colSpan=w;if(w=x.rowSpan)A.rowSpan=w;e(A,x,c,g);B.appendChild(A)}}return p},_createBodyRowCell:function(f,e,h,c){var g=h;e.get?g=e.get(h):"field"in e&&"_item"!==e.field&&(g=h[e.field]);e.renderCell?d(f,e.renderCell(h,g,f,c)):this._defaultRenderCell.call(e,
h,g,f,c)},_createHeaderRowCell:function(f,e){var h=e.headerNode=f,c=e.field;c&&(f.field=c);e.renderHeaderCell?d(h,e.renderHeaderCell(h)):("label"in e||e.field)&&h.appendChild(document.createTextNode("label"in e?e.label:e.field));!1!==e.sortable&&c&&"_item"!==c&&(f.sortable=!0,f.className+=" dgrid-sortable")},left:function(f,e){f.element||(f=this.cell(f));return this.cell(this._move(f,-(e||1),"dgrid-cell"))},right:function(f,e){f.element||(f=this.cell(f));return this.cell(this._move(f,e||1,"dgrid-cell"))},
_defaultRenderCell:function(f,e,h){if(this.formatter){var c=this.formatter,g=this.grid.formatterScope;f="string"===typeof c&&g?g[c](e,f):this.formatter(e,f);null!=f&&f.hasOwnProperty("html")?h.innerHTML=f.html:null!=f&&h.appendChild(document.createTextNode(f))}else null!=e&&h.appendChild(document.createTextNode(e))},renderRow:function(f,e){f=this.createRowCells("td",m.hitch(this,"_createBodyRowCell"),e&&e.subRows,f,e);e=n.create("div",{role:"row"});e.appendChild(f);return e},renderHeader:function(){var f=
this,e=this.headerNode;e.setAttribute("role","row");n.empty(e);var h=this.createRowCells("th",m.hitch(this,"_createHeaderRowCell"),this.subRows&&this.subRows.headerRows);this._rowIdToObject[h.id=this.id+"-header"]=this.columns;e.appendChild(h);this._sortListener&&this._sortListener.remove();this._sortListener=l(h,"click,keydown",function(c){if("click"===c.type||32===c.keyCode||!k("opera")&&13===c.keyCode){var g=c.target;do if(g.sortable){var p=g.field||g.columnId;var q=f.sort[0];p=f.hasNeutralSort&&
q&&q.property===p&&q.descending?[]:[{property:p,descending:q&&q.property===p&&!q.descending}];q={bubbles:!0,cancelable:!0,grid:f,parentType:c.type,sort:p};l.emit(c.target,"dgrid-sort",q)&&(f._sortNode=g,f.set("sort",p));break}while((g=g.parentNode)&&g!==e)}})},resize:function(){var f=this.headerNode.firstChild,e=this.contentNode,h;this.inherited(arguments);e.style.width="";e&&f&&(h=f.offsetWidth)>e.offsetWidth&&(e.style.width=h+"px")},destroy:function(){this._destroyColumns();this._sortListener&&
this._sortListener.remove();this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(f){var e=this.columns,h;for(h in e){var c=e[h];if(c.field===f)return c.headerNode}},updateSortArrow:function(f,e){this._lastSortedArrow&&(this._lastSortedArrow.parentNode&&r.remove(this._lastSortedArrow.parentNode,"dgrid-sort-up dgrid-sort-down"),n.destroy(this._lastSortedArrow),delete this._lastSortedArrow);e&&(this.sort=f);f[0]&&(e=f[0].property,
f=f[0].descending,e=this._sortNode||this._findSortArrowParent(e),delete this._sortNode,e&&(e=e.contents||e,this._lastSortedArrow=n.create("div",{className:"dgrid-sort-arrow ui-icon",innerHTML:"\x26nbsp;",role:"presentation"},e,"first"),r.add(e,"dgrid-sort-"+(f?"down":"up")),this.resize()))},styleColumn:function(f,e){return this.addCssRule("#"+a.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+a.escapeCssIdentifier(f,"-"),e)},_configColumns:function(f,e){var h=[],c=e instanceof Array;a.each(e,
function(g,p){"string"===typeof g&&(e[p]=g={label:g});c||g.field||(g.field=p);p=g.id=g.id||(isNaN(p)?p:f+p);this._configColumn&&(this._configColumn(g,e,f),p=g.id);c&&(this.columns[p]=g);g.grid?g.grid!==this&&console.warn("Sharing column definition objects with multiple grids is not supported.",g.grid,this):g.grid=this;h.push(g)},this);return c?e:h},_destroyColumns:function(){this.cleanup()},configStructure:function(){var f=this.subRows,e=this._columns=this.columns;this.columns=!e||e instanceof Array?
{}:e;if(f)for(e=0;e<f.length;e++)f[e]=this._configColumns(e+"-",f[e]);else this.subRows=[this._configColumns("",e)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(f){this._destroyColumns();this.subRows=null;this.columns=f;this._updateColumns()},_setSubRows:function(f){this._destroyColumns();this.subRows=f;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);
this._started&&(this.sort.length?(this._lastSortedArrow=null,this.updateSortArrow(this.sort)):this.resize())}});H.appendIfNode=d;return H})},"dgrid1/List":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/sniff ./util/misc".split(" "),function(H,m,n,r,l,k,b,a){function d(t,y){return k("#"+a.escapeCssIdentifier(t),y)[0]}function f(t,y){t.className="dgrid-scrollbar-measure";document.body.appendChild(t);y=t["offset"+y]-t["client"+y];t.className=
"";t.parentNode&&document.body.removeChild(t);return y}function e(t){n.replace(this.domNode,t,this._class||"");this._class=t}function h(){return this._class}var c=[];b("mozilla")&&c.push("has-mozilla");b("touch")&&c.push("has-touch");n.add(document.documentElement,c);b.add("pointer",function(t){return"PointerEvent"in t?"pointer":"MSPointerEvent"in t?"MSPointer":!1});var g,p;b.add("dom-scrollbar-width",function(t,y,C){return f(C,"Width")});b.add("dom-scrollbar-height",function(t,y,C){return f(C,"Height")});
b.add("dom-rtl-scrollbar-left",function(t,y,C){t=document.createElement("div");C.className="dgrid-scrollbar-measure";C.setAttribute("dir","rtl");C.appendChild(t);document.body.appendChild(C);y=!!b("ie")||!!b("trident")||/\bEdge\//.test(navigator.userAgent)||t.offsetLeft>=b("dom-scrollbar-width");C.className="";C.parentNode&&document.body.removeChild(C);r.destroy(t);C.removeAttribute("dir");return y});var q=0,u=function(){this._started&&this.resize()},v=H(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,
maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!0,highlightDuration:250,resizeThrottleDelay:a.defaultDelay,resizeThrottleMethod:"throttleDelayed",postscript:function(t,y){var C=this;(this._Row=function(B,F,x){this.id=B;this.data=F;this.element=x}).prototype.remove=function(){C.removeRow(this.element)};y&&(this.srcNodeRef=y=y.nodeType?y:d(y));this.create(t,y)},listType:"list",create:function(t,y){y=this.domNode=y||document.createElement("div");if(t){this.params=t;H.safeMixin(this,t);var C=t["class"]||
t.className||y.className}this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=y.id=y.id||this.id||v.autoIdPrefix+q++;this.buildRendering();C&&e.call(this,C);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},buildRendering:function(){var t=this.domNode,y=this.addUiClasses,C=this;var B=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();
t.className="";t.setAttribute("role","grid");n.add(t,"dgrid dgrid-"+this.listType+(y?" ui-widget":""));var F=this.headerNode=r.create("div",{className:"dgrid-header dgrid-header-row"+(y?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},t);var x=this.bodyNode=r.create("div",{className:"dgrid-scroller"},t);b("ff")&&(x.tabIndex=-1);this.headerScrollNode=r.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(y?" ui-widget-header":"")},t);this.footerNode=
r.create("div",{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},t);B&&(t.className+=" dgrid-rtl"+(b("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));l(x,"scroll",function(w){C.showHeader&&(F.scrollLeft=w.scrollLeft||x.scrollLeft);w.stopPropagation();l.emit(t,"scroll",{scrollTarget:x})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=r.create("div",{className:"dgrid-content"+(y?" ui-widget-content":"")},this.bodyNode);"string"===typeof this.resizeThrottleMethod&&
a[this.resizeThrottleMethod]?y=a[this.resizeThrottleMethod](u,this,this.resizeThrottleDelay):"function"===typeof this.resizeThrottleMethod?y=this.resizeThrottleMethod(m.hitch(this,u),this.resizeThrottleDelay):(console.warn("Invalid value specified for resizeThrottleMethod:  "+this.resizeThrottleMethod),y=a.throttleDelayed(u,this,this.resizeThrottleDelay));this._resizeHandle=l(window,"resize",y);this._listeners.push(this._resizeHandle)},postCreate:function(){},startup:function(){this._started||(this.inherited(arguments),
this._started=!0,this.resize(),this.set("sort",this.sort))},configStructure:function(){},resize:function(){var t=this.bodyNode,y=this.footerNode;y=this.showFooter?y.offsetHeight:0;this.headerScrollNode.style.height=t.style.marginTop=this.headerNode.offsetHeight+"px";t.style.marginBottom=y+"px";g||(g=b("dom-scrollbar-width"),p=b("dom-scrollbar-height"),b("ie")&&(g++,p++),a.addCssRule(".dgrid-scrollbar-width","width: "+g+"px"),a.addCssRule(".dgrid-scrollbar-height","height: "+p+"px"),17!==g&&(a.addCssRule(".dgrid-header-row",
"right: "+g+"px"),a.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+g+"px")))},addCssRule:function(t,y){t=a.addCssRule(t,y);this.cleanAddedRules&&this._listeners.push(t);return t},on:function(t,y){t=l(this.domNode,t,y);b("dom-addeventlistener")||this._listeners.push(t);return t},cleanup:function(){for(var t in this._rowIdToObject)if(this._rowIdToObject[t]!==this.columns){var y=d(t,this.domNode);y&&this.removeRow(y,!0)}},destroy:function(){if(this._listeners){for(var t=this._listeners.length;t--;)this._listeners[t].remove();
this._listeners=null}this._started=!1;this.cleanup();r.destroy(this.domNode)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoRowId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},highlightRow:function(t,y){var C="dgrid-highlight"+(this.addUiClasses?" ui-state-highlight":"");t=t.element||t;n.add(t,C);setTimeout(function(){n.remove(t,C)},y||this.highlightDuration)},adjustRowIndices:function(t){var y=t.rowIndex;if(-1<y){do-1<t.rowIndex&&this.setRowIndex(t,y++,t.rowIndex);
while((t=t.nextSibling)&&t.rowIndex!==y)}},renderArray:function(t,y,C){C=C||{};var B=C.start||0,F=document.createDocumentFragment(),x=[],w=0,A=t.length;y||(this._lastCollection=t);for(;w<A;)x[w]=this.insertRow(t[w],F,null,B++,C),w++;(t=y?y.parentNode:this.contentNode)&&t.parentNode&&(t!==this.contentNode||A)&&(t.insertBefore(F,y||null),A&&this.adjustRowIndices(x[A-1]));return x},renderHeader:function(){},setRowIndex:function(t,y,C){t.rowIndex=y;this.maintainOddEven&&(y=1===y%2?"dgrid-row-odd":"dgrid-row-even",
void 0!==C?(C=1===C%2?"dgrid-row-odd":"dgrid-row-even",C!==y&&n.replace(t,C,y)):n.add(t,y))},_autoRowId:0,insertRow:function(t,y,C,B,F){var x=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(t):this._autoRowId++),w=d(x,this.domNode),A=w&&w.previousSibling;w&&(w===C&&(C=(C.connected||C).nextSibling),this.removeRow(w,!1,F));w=this.renderRow(t,F);w.className=(w.className||"")+" dgrid-row "+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[w.id=x]=
t;y.insertBefore(w,C||null);this.setRowIndex(w,B);A&&A.rowIndex!==w.rowIndex-1&&this.adjustRowIndices(A);return w},renderRow:function(t){var y=document.createElement("div");y.appendChild(document.createTextNode(t));return y},removeRow:function(t,y){t=t.element||t;delete this._rowIdToObject[t.id];y||r.destroy(t)},row:function(t){var y;if(t instanceof this._Row)return t;t.target&&t.target.nodeType&&(t=t.target);if(t.nodeType){do{var C=t.id;if(y=this._rowIdToObject[C])return new this._Row(C.substring(this.id.length+
5),y,t);t=t.parentNode}while(t&&t!==this.domNode)}else return"object"===typeof t?y=this.collection.getIdentity(t):(y=t,t=this._rowIdToObject[this.id+"-row-"+y]),new this._Row(y,t,d(this.id+"-row-"+y,this.domNode))},cell:function(t){return{row:this.row(t)}},_move:function(t,y,C,B){var F;var x=F=t.element;y=y||1;do if(t=F[0>y?"previousSibling":"nextSibling"]){do if((F=t)&&-1<(F.className+" ").indexOf(C+" ")){x=F;y+=0>y?1:-1;break}while(t=(!B||!F.hidden)&&F[0>y?"lastChild":"firstChild"])}else if(F=F.parentNode,
!F||F===this.bodyNode||F===this.headerNode)break;while(y);return x},up:function(t,y,C){t.element||(t=this.row(t));return this.row(this._move(t,-(y||1),"dgrid-row",C))},down:function(t,y,C){t.element||(t=this.row(t));return this.row(this._move(t,y||1,"dgrid-row",C))},scrollTo:function(t){"undefined"!==typeof t.x&&(this.bodyNode.scrollLeft=t.x);"undefined"!==typeof t.y&&(this.bodyNode.scrollTop=t.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(t){var y=
"_get"+t.charAt(0).toUpperCase()+t.slice(1);return"function"===typeof this[y]?this[y].apply(this,[].slice.call(arguments,1)):this[t]},set:function(t,y){if("object"===typeof t)for(var C in t)this.set(C,t[C]);else C="_set"+t.charAt(0).toUpperCase()+t.slice(1),"function"===typeof this[C]?this[C].apply(this,[].slice.call(arguments,1)):this[t]=y;return this},_getClass:h,_setClass:e,_getClassName:h,_setClassName:e,_setSort:function(t,y){this.sort="string"!==typeof t?t:[{property:t,descending:y}];this._applySort()},
_applySort:function(){this.refresh();if(this._lastCollection){var t=this.sort;if(t&&0<t.length){var y=t[0].property,C=!!t[0].descending;this._lastCollection.sort(function(B,F){B=B[y];F=F[y];void 0===B&&(B="");void 0===F&&(F="");return B===F?0:B>F!==C?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(t){var y=this.headerNode;this.showHeader=t;n.toggle(y,"dgrid-header-hidden",!t);this.renderHeader();this.resize();t&&(y.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(t){this.showFooter=
t;n.toggle(this.footerNode,"dgrid-footer-hidden",!t);this.resize()}});v.autoIdPrefix="dgrid_";return v})},"dgrid1/util/misc":function(){define(["dojo/has"],function(H){var m=[],n,r,l,k=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,b=setTimeout,a=clearTimeout;H.add("requestidlecallback",function(f){return"function"===typeof f.requestIdleCallback});var d={defaultDelay:15,throttle:function(f,e,h){var c=!1;h=h||d.defaultDelay;return function(){c||(c=!0,f.apply(e,arguments),b(function(){c=!1},h))}},throttleDelayed:function(f,
e,h){var c=!1;h=h||d.defaultDelay;return function(){if(!c){c=!0;var g=arguments;b(function(){c=!1;f.apply(e,g)},h)}}},debounce:function(f,e,h){var c;h=h||d.defaultDelay;return function(){c&&(a(c),c=null);var g=arguments;c=b(function(){c=null;f.apply(e,g)},h)}},each:function(f,e,h){var c;if(f)if("number"===typeof f.length){var g=0;for(c=f.length;g<c;g++)e.call(h,f[g],g,f)}else for(g in f)e.call(h,f[g],g,f)},addCssRule:function(f,e){n||(n=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(n),
n=n.sheet||n.styleSheet,r=n.deleteRule?"deleteRule":"removeRule",l=n.cssRules?"cssRules":"rules");var h=m.length;m[h]=(n.cssRules||n.rules).length;n.addRule?n.addRule(f,e):n.insertRule(f+"{"+e+"}",m[h]);return{get:function(c){return n[l][m[h]].style[c]},set:function(c,g){"undefined"!==typeof m[h]&&(n[l][m[h]].style[c]=g)},remove:function(){var c=m[h],g;if(void 0!==c){n[r](c);m[h]=void 0;var p=h+1;for(g=m.length;p<g;p++)m[p]>c&&m[p]--}}}},escapeCssIdentifier:function(f,e){return"string"===typeof f?
f.replace(k,e||"\\$1"):f}};return d})},"dgrid1/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/when dojo/query ./util/misc".split(" "),function(H,m,n,r,l,k,b,a,d){function f(c){return c&&(0<=c.className.indexOf("dgrid-row")||0<=c.className.indexOf("dgrid-loading"))}function e(c){return c&&0<=c.className.indexOf("dgrid-preload")}var h=0;return n([H,m],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,
farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:d.defaultDelay,keepScrollPosition:!1,rowHeight:0,_deleteQueue:[],postCreate:function(){this.inherited(arguments);var c=this;k(this.bodyNode,"scroll",d[this.pagingMethod](function(g){c._processScroll(g)},null,this.pagingDelay))},renderQuery:function(c,g){var p=this,q=g&&g.container||this.contentNode,u,v=0,t=g&&g.start||0;"level"in c&&(v=u=c.level);var y={query:c,count:0,level:v,top:!1};var C={node:l.create("div",{className:"dgrid-preload",
style:{height:"0"}},q),count:0,query:c,next:y,level:v,top:!0};var B=C.node;B.rowIndex=0;y.previous=C;var F=y.node=l.create("div",{className:"dgrid-preload",style:{height:"0"}},q);C.id=h++;B.setAttribute("data-preloadid",C.id);y.id=h++;F.setAttribute("data-preloadid",y.id);F.rowIndex=this.minRowsPerPage;p._insertPreload(C);var x=l.create("div",{className:"dgrid-loading"},F,"before");l.create("div",{className:"dgrid-below"},x).innerHTML=this.loadingMessage;g=r.mixin({start:0,count:this.minRowsPerPage},
g);null!=u&&(g.queryLevel=u);return this._trackError(function(){var w=c(g);return p.renderQueryResults(w,F,g).then(function(A){return w.totalLength.then(function(z){var G=A.length,J=F.parentNode;!p._rows||"queryLevel"in g||(p._rows.min=0,p._rows.max=G===z?Infinity:G-1);l.destroy(x);"queryLevel"in g||(p._total=z);0===z&&J&&(p.noDataNode&&l.destroy(p.noDataNode),p._insertNoDataNode(J));C.count=t;y.count=z-G-t;F.rowIndex=t+G;z?p._updatePreloadRowHeights(C):(F.style.display="none",B.style.display="none");
p._previousScrollPosition&&J&&J.offsetHeight&&(p.scrollTo(p._previousScrollPosition),delete p._previousScrollPosition);return b(p._processScroll()).then(function(){return A})})}).otherwise(function(A){l.destroy(x);throw A;})})},_insertPreload:function(c){var g=this.preload;if(g){for(;g.node.compareDocumentPosition(c.node)&Node.DOCUMENT_POSITION_PRECEDING;)if(g=g.previous,null==g)return;for(;g.node.compareDocumentPosition(c.node)&Node.DOCUMENT_POSITION_FOLLOWING&&g.next;)g=g.next;g.previous.next=c;
c.previous=g.previous;c=c.next;c.next=g;g.previous=c}else this.preload=c},refresh:function(c){var g=this,p=c&&c.keepScrollPosition,q;"undefined"===typeof p&&(p=this.keepScrollPosition);p&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(u){u=g._renderedCollection.fetchRange({start:u.start,end:u.start+u.count});u.then(function(v){q=v});return u}).then(function(){g._emitRefreshComplete();return q})},resize:function(){this.inherited(arguments);
this._processScroll()},cleanup:function(){this.inherited(arguments);this.preload=null},renderQueryResults:function(c){var g=this.inherited(arguments),p=this._getRenderedCollection(this.preload);p&&p.releaseRange&&g.then(function(q){q[0]&&!q[0].parentNode.tagName&&c.totalLength.then(function(){p.releaseRange(q[0].rowIndex,q[q.length-1].rowIndex+1)})});return g},_getFirstRowSibling:function(c){return c.lastChild},_calcRowHeight:function(c){var g=c.nextSibling;return g&&!/\bdgrid-preload\b/.test(g.className)?
g.offsetTop-c.offsetTop:c.offsetHeight},_calcAverageRowHeight:function(c){for(var g=c.length,p=0,q=0;q<g;q++)p+=this._calcRowHeight(c[q]);return g&&p?p/g:0},_updatePreloadRowHeights:function(){var c=this.preload,g=0;if(c){for(;c.previous;)c=c.previous;for(;c;)c.rowHeight||(c.rowHeight=this._calcAverageRowHeight(c.node.parentNode.querySelectorAll(".dgrid-row")),this._adjustPreloadHeight(c)),g=c?c.rowHeight:g,c=c.next;this.rowHeight=g}},lastScrollTop:0,_processScroll:function(c){function g(ba,la){la=
la?"next":"previous";for(var oa;oa=ba[la];)ba=oa;return ba}function p(ba,la){function oa(){a:{var S=!la;for(var W=ba;W=W[la?"previous":"next"];)if(S===W.top){S=W;break a}S=void 0}if(S&&X!==S&&!e(S.top?S.node.nextSibling:S.node.previousSibling))return M(),ba=S,K=ba.node,da=la?ba.node.offsetTop-B:C-(ba.node.offsetTop+ba.node.offsetHeight),ha=(S=fa(K))&&S.rowIndex,O=void 0,S}function fa(S){var W=e(S);(S=S[E])&&!f(S)&&(S=W&&e(S)?null:(W=oa())?W:fa(S));return S}function M(){ba.count+=N;la&&(K.rowIndex-=
N);t._adjustPreloadHeight(ba);N=0;t._releaseRange(ba,la,ha,O)}var X=ba;ba=g(ba,la);var da=la?ba.node.offsetTop-B:C-(ba.node.offsetTop+ba.node.offsetHeight),Q=t.farOffRemoval,K=ba.node,E=la?"previousSibling":"nextSibling",N=0,I=0,O;if(da>2*Q){var U;var ha=(U=fa(K))&&U.rowIndex;for(O=void 0;U&&X!==ba;){var ia=t._calcRowHeight(U);I+ia+Q>da||!f(U)?U=oa():(I+=ia,N+=U.count||1,t._pruneRow(U,la),"rowIndex"in U&&(O=U.rowIndex),U=fa(U))}M();t._deleteNodeQueue()}}function q(ba,la){do ba=la?ba.next:ba.previous;
while(ba&&!ba.node.offsetWidth);return ba}var u=this.preload,v;this._updatePreloadRowHeights();if(v=u&&u.rowHeight){var t=this,y=t.bodyNode,C=c&&c.scrollTop||this.getScrollPosition().y,B=y.offsetHeight+C;c=t.lastScrollTop;y=t.bufferRows*v;var F=y-v,x,w=!0;for(t.lastScrollTop=C;u&&!u.node.offsetWidth;)u=u.previous;for(;u&&u!==A;){var A=t.preload;t.preload=u;v=u.node;var z=v.offsetTop;if(B+1+F<z)u=q(u,w=!1);else if(C-1-F>z+v.offsetHeight)u=q(u,w=!0);else{z=((v.top?C-y:B)-z)/u.rowHeight;var G=(B-C+2*
y)/u.rowHeight;G+=Math.min(Math.abs(Math.max(Math.min((C-c)*u.rowHeight,t.maxRowsPerPage/2),t.maxRowsPerPage/-2)),10);v.top&&(z-=G);z=Math.max(z,0);10>z&&0<z&&G+z<t.maxRowsPerPage&&(G+=Math.max(0,z),z=0);G=Math.min(Math.max(G,t.minRowsPerPage),t.maxRowsPerPage,u.count);if(0===G)u=q(u,w);else{G=Math.ceil(G);z=Math.min(Math.floor(z),u.count-G);var J={};u.count-=G;var L=v,R=t.queryRowsOverlap,T=!u.top&&u;if(T)u.previous&&(p(u),0<z&&e(v.previousSibling)?(z=Math.min(u.count,z),u.previous.count+=z,t._adjustPreloadHeight(u.previous,
!0),v.rowIndex+=z,R=0):G+=z,u.count-=z),J.start=v.rowIndex-R,J.count=Math.min(G+R,t.maxRowsPerPage),v.rowIndex=J.start+J.count;else{if(u.next)if(L=v.nextSibling,p(u,!0),e(v.nextSibling))u.next.count+=u.count-z,u.next.node.rowIndex=z+G,t._adjustPreloadHeight(u.next),u.count=z,R=0,L=u.next.node;else var aa=!0;J.start=u.count;J.count=Math.min(G+R,t.maxRowsPerPage);J.scrollingUp=!0}aa&&L&&L.offsetWidth&&(aa=L.offsetTop);t._adjustPreloadHeight(u);"level"in u.query&&(J.queryLevel=u.query.level);if("queryLevel"in
J||!(J.start>t._total||0>J.count)){var ca=l.create("div",{className:"dgrid-loading",style:{height:G*u.rowHeight+"px"}},L,"before");l.create("div",{className:"dgrid-"+(T?"below":"above"),innerHTML:t.loadingMessage},ca);ca.count=G;t._trackError(function(){(function(ba,la,oa){var fa=u.query(J);x=t.renderQueryResults(fa,ba,J).then(function(M){var X=t._rows;!X||"queryLevel"in J||!M.length||(la?(X.max<=X.min&&(X.min=M[0].rowIndex),X.max=M[M.length-1].rowIndex):(X.max<=X.min&&(X.max=M[M.length-1].rowIndex),
X.min=M[0].rowIndex));L=ba.nextSibling;l.destroy(ba);oa&&L&&L.offsetWidth&&t.scrollTo({y:t.bodyNode.scrollTop+L.offsetTop-oa});fa.totalLength.then(function(da){"queryLevel"in J||(t._total=da,t._rows&&t._rows.max>=t._total-1&&(t._rows.max=Infinity));la&&(la.count=da-la.node.rowIndex,t._adjustPreloadHeight(la))});t._processScroll();return M},function(M){l.destroy(ba);throw M;})})(ca,T,aa)});u=u.previous}}}}return x}},_adjustPreloadHeight:function(c,g){c.node.style.height=this._calculatePreloadHeight(c,
g)+"px"},_calculatePreloadHeight:function(c,g){return Math.min(c.count*c.rowHeight,g?Infinity:this.maxEmptySpace)},_pruneRow:function(c,g,p){this.removeRow(c,!0,p);this._queueNodeForDeletion(c)},_queueNodeForDeletion:function(c){this._deleteQueue.push(c)},_deleteNodeQueue:function(){for(var c=document.createElement("div"),g=this._deleteQueue,p=g.length;p--;)c.appendChild(g[p]);this._deleteQueue=[];setTimeout(function(){l.destroy(c)},1)},_removePreloads:function(c){if(c&&c.length){var g=this,p=this._getHeadPreload();
c.forEach(function(q){if(q=g._findPreload(q,p))q.previous&&(q.previous.next=q.next),q.next&&(q.next.previous=q.previous)})}},_getHeadPreload:function(){var c=this.preload;if(c)for(;c.previous;)c=c.previous;return c},_findPreload:function(c,g){for(g||(g=this._getHeadPreload());g;){if(g.node===c)return g;g=g.next}},_getRenderedCollection:function(){return this._renderedCollection},_releaseRange:function(c,g,p,q){if(c){var u=c.level;c=this._getRenderedCollection(c);null!=q&&c.releaseRange&&"number"===
typeof p&&"number"===typeof q&&(g?c.releaseRange(q,p+1):c.releaseRange(p,q+1),this._rows&&!u&&(this._rows[g?"max":"min"]=q,this._rows.max>=this._total-1&&(this._rows.max=Infinity)))}}})})},"dgrid1/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/dom-construct dojo/has dojo/on dojo/when".split(" "),function(H,m,n,r,l,k,b,a){function d(f){if("object"!==typeof f)f=Error(f);else if("cancel"===f.dojoType)return;b.emit(this.domNode,"dgrid-error",{grid:this,
error:f,cancelable:!0,bubbles:!0})&&console.error(f)}return H(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,_structureHandle:null,shouldTrackCollection:!0,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};this._structureHandle=r.before(this,"configStructure",m.hitch(this,function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._structureHandle&&
this._structureHandle.remove();this._renderedCollection&&this._cleanupCollection();this._refreshTimeout&&clearTimeout(this._refreshTimeout)},_configColumn:function(f){f.set&&(this._columnsWithSet[f.field]=f);this.inherited(arguments)},_setCollection:function(f){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!f||f.storage!==this._renderedCollection.storage}));this.collection=f;if(this._started){if(f){var e=f;this.sort&&0<this.sort.length&&(e=f.sort(this.sort));e.track&&
this.shouldTrackCollection&&(e=e.track(),this._rows=[],this._observerHandle=this._observeCollection(e,this.contentNode,{rows:this._rows}));this._renderedCollection=e}this.refresh()}},_setStore:function(){this.collection||console.debug("set('store') call detected, but you probably meant set('collection')")},_getTotal:function(){return this._total},_cleanupCollection:function(f){f=f||{};this._observerHandle&&(this._observerHandle.remove(),this._observerHandle=this._rows=null);!1!==f.shouldRevert&&(this.dirty=
{});this._renderedCollection=this.collection=null},_applySort:function(){this.collection?this.set("collection",this.collection):this.store&&console.debug("_StoreMixin found store property but not collection; this is often the sign of a mistake during migration from 0.3 to 0.4")},_emitRefreshComplete:function(){var f=this;this._refreshTimeout=setTimeout(function(){b.emit(f.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:f});f._refreshTimeout=null},0)},_insertNoDataNode:function(f){this._removeNoDataNode();
f=f||this.contentNode;var e=this.noDataNode=l.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage});f.insertBefore(e,this._getFirstRowSibling?this._getFirstRowSibling(f):null);return e},_removeNoDataNode:function(){return this.noDataNode?(l.destroy(this.noDataNode),delete this.noDataNode,!0):!1},row:function(){var f=this.inherited(arguments);f&&f.data&&"undefined"!==typeof f.id&&(f.id=this.collection.getIdentity(f.data));return f},refresh:function(){var f=this.inherited(arguments);
this.collection||this._insertNoDataNode();return f},refreshCell:function(f){if(!this.collection||!this._createBodyRowCell)throw Error("refreshCell requires a Grid with a collection.");this.inherited(arguments);return this.collection.get(f.row.id).then(m.hitch(this,"_refreshCellFromItem",f))},_refreshCellFromItem:function(f,e,h){var c=f.element;l.empty(c);var g=this.dirty&&this.dirty[f.row.id];g&&(e=m.delegate(e,g));this._createBodyRowCell(c,f.column,e,h)},renderArray:function(){var f=this.inherited(arguments);
this.collection||f.length&&this.noDataNode&&l.destroy(this.noDataNode);return f},insertRow:function(f,e,h,c,g){var p=this.collection,q=this.dirty;p=p&&p.getIdentity(f);var u;p in q&&!(p in this._updating)&&(u=q[p]);u&&(f=m.delegate(f,u));q=this.inherited(arguments);g&&g.rows&&(g.rows[c]=q);this.noDataNode&&(l.destroy(this.noDataNode),this.noDataNode=null);return q},updateDirty:function(f,e,h){var c=this.dirty,g=c[f];g||(g=c[f]={});g[e]=h},save:function(){function f(y,C){return function(B){var F=e._columnsWithSet,
x=e._updating,w;if("function"===typeof B.set)B.set(C);else for(w in C)B[w]=C[w];for(w in F){var A=F[w].set(B);void 0!==A&&(B[w]=A)}x[y]=!0;return h.put(B).then(function(z){delete c[y];delete x[y];p[y]=z;return p})}}var e=this,h=this.collection,c=this.dirty,g=new n,p={},q=function(y){var C;return e.getBeforePut||!(C=e.row(y).data)?function(){return h.get(y)}:function(){return C}},u=g.then(function(){return p}),v;for(v in c){var t=f(v,c[v]);u=u.then(q(v)).then(t)}g.resolve();return u},revert:function(){this.dirty=
{};this.refresh()},_trackError:function(f){"string"===typeof f&&(f=m.hitch(this,f));var e=this;try{var h=a(f())}catch(c){f=new n,f.reject(c),h=f.promise}h.otherwise(function(c){d.call(e,c)});return h},removeRow:function(f,e,h){var c={element:f};e||this.up(c).element!==f||this.down(c).element!==f||this._insertNoDataNode();(c=h&&h.rows||this._rows)&&delete c[f.rowIndex];return this.inherited(arguments)},renderQueryResults:function(f,e,h){h=m.mixin({rows:this._rows},h);var c=this;return f.then(function(g){g=
c.renderArray(g,e,h);delete c._lastCollection;return g})},_observeCollection:function(f,e,h){var c=this,g=h.rows,p,q=[f.on("delete, update",function(u){var v=u.previousIndex,t=u.index;void 0!==v&&g[v]&&("max"in g&&(void 0===t||t<g.min||t>g.max)&&g.max--,0>g.max&&(g.max=0),p=g[v],p.parentNode===e&&c.removeRow(p,!1,h),g.splice(v,1),("delete"===u.type||"update"===u.type&&(v<t||void 0===t))&&g[v]&&g[v].rowIndex--);"delete"===u.type&&(p=null)}),f.on("add, update",function(u){var v=u.previousIndex,t=u.index;
if(void 0!==t&&(!("max"in g)||t>=g.min&&t<=g.max)){"max"in g&&(void 0===v||v<g.min||v>g.max)&&g.max++;if(g.length){if(v=g[t],!v&&(v=g[t-1]))v=(v.connected||v).nextSibling}else v=c._getFirstRowSibling&&c._getFirstRowSibling(e);p&&v&&p.id===v.id&&(v=(v.connected||v).nextSibling);v&&!v.parentNode&&(v=document.getElementById(v.id));g.splice(t,0,void 0);p=c.insertRow(u.target,e,v,t,h);c.highlightRow(p)}p=null}),f.on("add, delete, update",function(u){var v="undefined"!==typeof u.previousIndex?u.previousIndex:
Infinity,t="undefined"!==typeof u.index?u.index:Infinity,y=Math.min(v,t);v!==t&&g[y]&&c.adjustRowIndices(g[y]);Infinity!==v&&c._processScroll&&(g[v]||g[v-1])&&c._processScroll();c._onNotification(g,u,f);f===c._renderedCollection&&"totalLength"in u&&(c._total=u.totalLength)})];return{remove:function(){for(;0<q.length;)q.pop().remove()}}},_onNotification:function(){}})})},"dgrid1/Tree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/promise/all dojo/query dojo/when ./util/has-css3 ./Grid dojo/has!touch?./util/touch".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g){return H(null,{collapseOnRefresh:!1,enableTreeTransitions:!0,treeIndentWidth:9,constructor:function(){this._treeColumnListeners=[]},shouldExpand:function(p,q,u){return u},expand:function(p,q,u,v){function t(){x||y._processScroll&&y._processScroll()}if(!this._treeColumn)return e();var y=this,C=p.element?p:this.row(p),B=!!this._expanded[C.id],F=h("transitionend");p=C.element;p=-1<p.className.indexOf("dgrid-expando-icon")?p:f(".dgrid-expando-icon",p)[0];u=u||!this.enableTreeTransitions;
if(p&&p.mayHaveChildren&&(u||q!==B)){var x=void 0===q?!this._expanded[C.id]:q,w=this.getScrollPosition();this._resetExpanded(C.id,x);b.replace(p,"ui-icon-triangle-1-"+(x?"se":"e"),"ui-icon-triangle-1-"+(x?"e":"se"));b.toggle(C.element,"dgrid-row-expanded",x);q=C.element;var A=q.connected,z={};if(!A){A=z.container=q.connected=k.create("div",{className:"dgrid-tree-container"},q,"after");var G=function(aa){var ca=y._renderedCollection.getChildren(C.data);y.sort&&0<y.sort.length&&(ca=ca.sort(y.sort));
ca.track&&y.shouldTrackCollection&&(A._rows=aa.rows=[],ca=ca.track(),A._handles=[ca.tracking,y._observeCollection(ca,A,aa)]);G.collection=ca;return"start"in aa?ca.fetchRange({start:aa.start,end:aa.start+aa.count}):ca.fetch()};"level"in p&&(A.level=G.level=p.level+1);if(this.renderQuery)var J=v?y._renderedCollection.getChildren(C.data).fetchRange({start:0,end:1}).totalLength.then(function(aa){z.start=aa-y.minRowsPerPage;z.end=aa-1;z.count=y.minRowsPerPage;y._previousScrollPosition=w;return y.renderQuery(G,
z)}):this.renderQuery(G,z);else{var L=k.create("div",null,A);J=this._trackError(function(){return y.renderQueryResults(G(z),L,m.mixin({rows:z.rows},"level"in G?{queryLevel:G.level}:null)).then(function(aa){k.destroy(L);return aa})})}F&&a(A,F,this._onTreeTransitionEnd)}A.hidden=!x;var R=A.style;if(!F||u)R.display=x?"block":"none",R.height="",t();else{a.once(A,F,t);if(x){R.display="block";var T=A.scrollHeight;R.height="0px"}else b.add(A,"dgrid-tree-resetting"),R.height=A.scrollHeight+"px";setTimeout(function(){b.remove(A,
"dgrid-tree-resetting");R.height=x?T?T+"px":"auto":"0px"},0)}}return e(J)},_configColumns:function(){var p=this.inherited(arguments);this._resetExpanded();for(var q=0,u=p.length;q<u;q++)if(p[q].renderExpando){this._configureTreeColumn(p[q]);break}return p},insertRow:function(p,q,u,v,t){t=t||{};var y=t.queryLevel="queryLevel"in t?t.queryLevel:"level"in q?q.level:0,C=this.inherited(arguments),B=this.row(C);(y=this.shouldExpand(B,y,this._expanded[B.id]))&&this._expandWhenInDom(C,t);(y||!this.collection.mayHaveChildren||
this.collection.mayHaveChildren(p))&&b.add(C,"dgrid-row-expandable");return C},_expandWhenInDom:function(p,q,u){p.offsetHeight?(p=this.expand(p,!0,!0,q.scrollingUp),u&&p.then(function(){u.resolve()})):p.parentNode&&this.domNode.offsetHeight&&(this._expandPromises&&!u&&(u=new l,this._expandPromises.push(u.promise)),setTimeout(this._expandWhenInDom.bind(this,p,q,u),0))},_queueNodeForDeletion:function(p){this.inherited(arguments);var q=p.connected;q&&this._deleteQueue.push(q)},_pruneRow:function(p,q){var u=
p.connected,v;if(u){var t=this.row(p).id;this._expanded[t]&&(v=f("\x3e.dgrid-preload",u)[q?1:0])&&(v=this._findPreload(v),v=q?v.next:v.previous,v.expandedContent||(v.expandedContent={}),v.expandedContent[t]=u.offsetHeight)}this.inherited(arguments,[p,q,{treePrune:!0,removeBelow:q}])},refresh:function(p){this._expandPromises=[];var q=(this.keepScrollPosition||p&&p.keepScrollPosition)&&Object.keys(this._expanded).length?this.inherited(arguments,m.mixin(p||{},{keepScrollPosition:!1})):this.inherited(arguments);
return e(q).then(function(){var u=this._expandPromises;delete this._expandPromises;return d(u)}.bind(this))},removeRow:function(p,q,u){var v=p.connected,t={};if(v){v._handles&&(n.forEach(v._handles,function(x){x.remove()}),delete v._handles);v._rows&&(t.rows=v._rows);var y=f("\x3e.dgrid-row",v);var C=f("\x3e.dgrid-preload",v);if(y&&y.length){if(this._releaseRange){var B=y[0].rowIndex;var F=y[y.length-1].rowIndex;this._releaseRange(this._findPreload(C[0]),!1,B,F)}y.forEach(function(x){u&&u.treePrune?
this._pruneRow(x,u.removeBelow):this.removeRow(x,!0,t)},this)}this._removePreloads&&this._removePreloads(C);v._rows&&(v._rows.length=0,delete v._rows);q?this._queueNodeForDeletion(v):k.destroy(v)}this.inherited(arguments)},_refreshCellFromItem:function(p,q){if(!p.column.renderExpando)return this.inherited(arguments);this.inherited(arguments,[p,q,{queryLevel:f(".dgrid-expando-icon",p.element)[0].level}])},cleanup:function(){this.inherited(arguments);this.collapseOnRefresh&&this._resetExpanded()},_destroyColumns:function(){this.inherited(arguments);
for(var p=this._treeColumnListeners,q=p.length;q--;)p[q].remove();this._treeColumnListeners=[];this._treeColumn=null},_calcRowHeight:function(p){var q=p.connected;return this.inherited(arguments)+(q?q.offsetHeight:0)},_configureTreeColumn:function(p){var q=this,u=".dgrid-content .dgrid-column-"+p.id,v;this._treeColumn=p;if(!p._isConfiguredTreeColumn){var t=p.renderCell||this._defaultRenderCell;p._isConfiguredTreeColumn=!0;p.renderCell=function(C,B,F,x){var w=x&&"queryLevel"in x?x.queryLevel:0,A=!q.collection.mayHaveChildren||
q.collection.mayHaveChildren(C);var z=p.renderExpando(w,A,q._expanded[q.collection.getIdentity(C)],C);z.level=w;z.mayHaveChildren=A;(C=t.call(p,C,B,F,x))&&C.nodeType?(F.appendChild(z),F.appendChild(C)):F.insertBefore(z,F.firstChild)};"function"!==typeof p.renderExpando&&(p.renderExpando=this._defaultRenderExpando)}var y=this._treeColumnListeners;0===y.length&&(y.push(this.on(p.expandOn||".dgrid-expando-icon:click,"+u+":dblclick,"+u+":keydown",function(C){var B=q.row(C);q.collection.mayHaveChildren&&
!q.collection.mayHaveChildren(B.data)||"keydown"===C.type&&32!==C.keyCode||"dblclick"===C.type&&v&&1<v.count&&B.id===v.id&&-1<C.target.className.indexOf("dgrid-expando-icon")||q.expand(B);-1<C.target.className.indexOf("dgrid-expando-icon")&&(v&&v.id===q.row(C).id?v.count++:v={id:q.row(C).id,count:1})})),h("touch")&&y.push(this.on(g.selector(u,g.dbltap),function(){q.expand(this)})))},_defaultRenderExpando:function(p,q,u){var v=this.grid.isRTL?"right":"left",t="dgrid-expando-icon";q&&(t+=" ui-icon ui-icon-triangle-1-"+
(u?"se":"e"));return k.create("div",{className:t,innerHTML:"\x26nbsp;",style:"margin-"+v+": "+p*this.grid.treeIndentWidth+"px; float: "+v+";"})},_onNotification:function(p,q){"delete"===q.type&&this._resetExpanded(q.id);this.inherited(arguments)},_onTreeTransitionEnd:function(p){var q=this,u=this.style.height;u&&(this.style.display="0px"===u?"none":"block");p&&(b.add(this,"dgrid-tree-resetting"),setTimeout(function(){b.remove(q,"dgrid-tree-resetting")},0));this.style.height=""},_resetPlaceHolder:function(p){var q=
this._getHeadPreload&&this._getHeadPreload();if(q)if(null!=p)a:for(;q;){var u=q.expandedContent;if(u&&u[p]){delete u[p];this._adjustPreloadHeight(q);break a}q=q.next}else for(p=q;p;)p.expandedContent&&(delete p.expandedContent,this._adjustPreloadHeight(p)),p=p.next},_resetExpanded:function(p,q){this._resetPlaceHolder(p);null==p?this._expanded={}:q?this._expanded[p]=!0:delete this._expanded[p]},_calculatePreloadHeight:function(p){var q=this.inherited(arguments),u=p.expandedContent;u&&Object.keys(u).forEach(function(v){q+=
u[v]});return q},_getRenderedCollection:function(p){return p.level?p.query.collection:this.inherited(arguments)}})})},"dgrid1/util/has-css3":function(){define(["dojo/has"],function(H){function m(r,l){r=r.style;var k;if(l in r)return!0;l=l.slice(0,1).toUpperCase()+l.slice(1);for(k=n.length;k--;)if(n[k]+l in r)return n[k];return!1}var n=["ms","O","Moz","Webkit"];H.add("css-transitions",function(r,l,k){return m(k,"transitionProperty")});H.add("css-transforms",function(r,l,k){return m(k,"transform")});
H.add("css-transforms3d",function(r,l,k){return m(k,"perspective")});H.add("transitionend",function(){var r=H("css-transitions");return r?!0===r?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[r]:!1});return H})},"dgrid1/Editor":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/sniff ./Grid".split(" "),function(H,m,n,r,l,k,b,a,d,f){return m(null,{editorFocusWrapperClassName:"dgrid-editor-focus-wrapper",
constructor:function(){this._editorInstances={};this._editorColumnListeners=[];this._editorCellListeners={};this._editorsPendingStartup=[]},postCreate:function(){var e=this;this.inherited(arguments);this.on(".dgrid-input:focusin",function(){e._focusedEditorCell=e.cell(this)});this._editorFocusoutHandle=b.pausable(this.domNode,".dgrid-input:focusout",function(h){e._focusedEditorCell&&e._focusedEditorCell.element.contains(h.target)||(e._focusedEditorCell=null)});this._listeners.push(this._editorFocusoutHandle)},
insertRow:function(){this._editorRowListeners={};var e=this.inherited(arguments),h=this.row(e),c=this._editorCellListeners[e.id]=this._editorCellListeners[e.id]||{},g;for(g in this._editorRowListeners)c[g]=this._editorRowListeners[g];this._editorRowListeners=null;(c=this._previouslyFocusedEditorCell)&&c.row.id===h.id&&(this.edit(this.cell(h,c.column.id)),this._previouslyFocusedEditorCell=null);return e},refresh:function(){for(var e in this._editorInstances){var h=this._getEditorRootNode(this._editorInstances[e].domNode);
h&&h.parentNode&&(this._removeEditorBlurHandles(),h.parentNode.removeChild(h))}return this.inherited(arguments)},removeRow:function(e){var h=this,c=this._focusedEditorCell,g=this.row(e);c&&g&&c.row.id===g.id&&(this._previouslyFocusedEditorCell=c,this._editorFocusoutHandle.pause(),setTimeout(function(){h._editorFocusoutHandle.resume();h._previouslyFocusedEditorCell=null},0));if(this._editorCellListeners[e.id]){for(var p in this._editorCellListeners[e.id])this._editorCellListeners[e.id][p].remove();
delete this._editorCellListeners[e.id]}for(c=this._alwaysOnWidgetColumns.length;c--;)if(g=(g=this.cell(e,this._alwaysOnWidgetColumns[c].id).element)&&(g.contents||g).widget)this._editorFocusoutHandle.pause(),g.destroyRecursive(),this._editorFocusoutHandle.resume();return this.inherited(arguments)},renderArray:function(){var e=this.inherited(arguments);e.length?this._startupPendingEditors():this._editorsPendingStartup=[];return e},_onNotification:function(){this.inherited(arguments);this._startupPendingEditors()},
_destroyColumns:function(){this._editorStructureCleanup();this.inherited(arguments)},_editorStructureCleanup:function(){var e=this._editorInstances,h=this._editorColumnListeners;this._editTimer&&clearTimeout(this._editTimer);for(var c in e){var g=e[c];g.domNode&&g.destroyRecursive()}this._editorInstances={};for(e=h.length;e--;)h[e].remove();for(var p in this._editorCellListeners)for(c in this._editorCellListeners[p])this._editorCellListeners[p][c].remove();for(e=0;e<this._editorColumnListeners.length;e++)this._editorColumnListeners[e].remove();
this._editorCellListeners={};this._editorColumnListeners=[];this._editorsPendingStartup=[]},configStructure:function(){this._alwaysOnWidgetColumns=[];this.inherited(arguments)},_configColumns:function(){for(var e=this.inherited(arguments),h=0,c=e.length;h<c;h++)e[h].editor&&this._configureEditorColumn(e[h]);return e},_configureEditorColumn:function(e){var h=this,c=e.renderCell||this._defaultRenderCell,g=e.editOn,p="string"!==typeof e.editor;g?this._editorInstances[e.id]=this._createSharedEditor(e,
c):p&&this._alwaysOnWidgetColumns.push(e);e.renderCell=g?function(q,u,v,t){if(!t||!t.alreadyHooked){var y=b(v,g,function(){h._activeOptions=t;h.edit(this)});if(h._editorRowListeners)h._editorRowListeners[e.id]=y;else{var C=h.row(q);h._editorCellListeners[C.element.id][e.id]=y}}return c.call(e,q,u,v,t)}:function(q,u,v,t){if(!e.canEdit||e.canEdit(q,u))q=h._createEditor(e,q),h._showEditor(q,e,v,u),v[p?"widget":"input"]=q;else return c.call(e,q,u,v,t)}},edit:function(e){function h(B){c._activeCell=v;
c._showEditor(p,q,v,y);c._editTimer=setTimeout(function(){var F=c._getEditorFocusNode(p);F.focus&&F.focus();q._editorBlurHandle&&q._editorBlurHandle.resume();c._editTimer=null;B.resolve(p)},0)}var c=this,g,p;e.column||(e=this.cell(e));if(!e||!e.element)return null;this._previouslyFocusedEditorCell=e;var q=e.column;var u=q.field;var v=e.element.contents||e.element;if(p=this._editorInstances[q.id]){if(this._activeCell!==v){var t=e.row;var y=(g=this.dirty&&this.dirty[t.id])&&u in g?g[u]:q.get?q.get(t.data):
t.data[u];if(!q.canEdit||q.canEdit(e.row.data,y)){var C=new r;e=this._getEditorFocusNode(p);e.offsetWidth?(e.blur(),setTimeout(function(){h(C)},0)):h(C);return C.promise}}}else if(q.editor&&(p=v.widget||v.input))return C=new r,p.focus&&p.focus(),C.resolve(p),C.promise;return null},refreshCell:function(e){var h=e.column,c=h.get?h.get(e.row.data):e.row.data[h.field],g;h.editor&&(e.column.editOn&&this._activeCell===e.element?g=this._editorInstances[e.column.id]:e.column.editOn||(g=e.element.widget||
e.element.input));if(g)return g.domNode?g.set("value",c):this._updateInputValue(g,c),(new r).resolve();h._editorBlurHandle&&h._editorBlurHandle.remove();return this.inherited(arguments)},_showEditor:function(e,h,c,g){var p=e.domNode;p||this._updateInputValue(e,g);c.innerHTML="";k.add(c,"dgrid-cell-editing");p&&h.editOn&&e.validate&&e.reset&&e.reset();c.appendChild(this._getEditorRootNode(e));p&&!h.editOn?this._editorsPendingStartup.push([e,h,c,g]):this._startupEditor(e,h,c,g)},_startupEditor:function(e,
h,c,g){e.domNode&&(e._started||e.startup(),e._dgridIgnoreChange=!0,e.set("value",g),setTimeout(function(){e._dgridIgnoreChange=!1},0));e._dgridLastValue=g;this._activeCell&&(this._activeValue=g,b.emit(c,"dgrid-editor-show",{grid:this,cell:this.cell(c),column:h,editor:e,bubbles:!0,cancelable:!1}))},_startupPendingEditors:function(){for(var e=this._editorsPendingStartup,h=e.length;h--;)this._startupEditor.apply(this,e[h]);this._editorsPendingStartup=[]},_handleEditorChange:function(e,h){var c=e.target;
"_dgridLastValue"in c&&-1<c.className.indexOf("dgrid-input")&&this._updatePropertyFromEditor(h||this.cell(c).column,c,e)},_getEditorFocusNode:function(e){var h=e.parentNode||e.domNode&&e.domNode.parentNode;h&&k.contains(h,this.editorFocusWrapperClassName)||(h=e.focusNode||e.domNode||e);return h},_getEditorRootNode:function(e){if(e){var h=e.parentNode||e.domNode&&e.domNode.parentNode;h&&k.contains(h,this.editorFocusWrapperClassName)||(h=e.domNode||e);return h}},_createEditorFocusWrapper:function(e,
h){isNaN(h)&&(h=isNaN(e.tabIndex)?-1:e.tabIndex);h=l.create("div",{className:this.editorFocusWrapperClassName,tabIndex:h});h.appendChild(e);return h},_createEditor:function(e,h){var c=e.editor,g=e.editOn,p=this,q="string"!==typeof c&&c,u={};var v=e.editorArgs||{};"function"===typeof v&&(v=v.call(this,e,h));if(q){var t=new q(v);v=t.focusNode||t.domNode;v.className+=" dgrid-input";if(d("mac")&&e.editOn&&/checkbox|radio/i.test(v.type))v=this._createEditorFocusWrapper(t.domNode,e.tabIndex),this._listeners.push(b(v,
"blur",function(){t._dgridIgnoreChange||p._updatePropertyFromEditor(e,t,{type:"widget"})}));else if(!g)t.on("change",function(){t._dgridIgnoreChange||p._updatePropertyFromEditor(e,t,{type:"widget"})})}else this._hasInputListener||(this._hasInputListener=!0,this.on("change",function(C){p._handleEditorChange(C)})),"textarea"===c?q="textarea":(q="input",u.type=c),t=v=l.create(q,n.mixin(u,{className:"dgrid-input",name:e.field,tabIndex:isNaN(e.tabIndex)?-1:e.tabIndex},v)),d("mac")&&e.editOn&&/checkbox|radio/i.test(c)&&
(v=this._createEditorFocusWrapper(t),t.tabIndex=0,t.removeAttribute("tabindex")),9>d("ie")&&(c="radio"===c||"checkbox"===c?b(t,"click",function(C){p._handleEditorChange(C,e)}):b(t,"change",function(C){p._handleEditorChange(C,e)}),g?this._editorColumnListeners.push(c):this._editorRowListeners?this._editorRowListeners[e.id]=c:this._editorCellListeners[this.row(h).element.id][e.id]=c);if(e.autoSelect){var y=t.focusNode||t;y.select&&b(y,"focus",function(){setTimeout(function(){y.select()},0)})}return t},
_createSharedEditor:function(e){function h(){var t=g._activeCell;u.blur();"function"===typeof g.focus&&setTimeout(function(){g.focus(t)},p&&9>d("ie")?15:0)}var c=this._createEditor(e),g=this,p=c.domNode,q=this._getEditorRootNode(c),u=this._getEditorFocusNode(c),v=p?function(){c.set("value",c._dgridLastValue)}:function(){g._updateInputValue(c,c._dgridLastValue);g._updatePropertyFromEditor(e,c)};this._editorColumnListeners.push(b(u,"keydown",function(t){t=t.keyCode||t.which;27===t?(v(),g._activeValue=
c._dgridLastValue,h()):13===t&&!1!==e.dismissOnEnter&&h()}));(e._editorBlurHandle=b.pausable(this._getEditorFocusNode(c),"blur",function(t){if(!c.dropDown||!c.dropDown.domNode.contains(t.relatedTarget||document.activeElement)){if(t&&t.target){var y=t.target;if((y=k.contains(y,g.editorFocusWrapperClassName)&&y)&&t.relatedTarget===(c.focusNode||c)){y.focus();return}}g._updatePropertyFromEditor(e,c,{type:"widget"});t=q.parentNode;y={alreadyHooked:!0};var C=g.cell(q);b.emit(C.element,"dgrid-editor-hide",
{grid:g,cell:C,column:e,editor:c,bubbles:!0,cancelable:!1});e._editorBlurHandle.pause();t.removeChild(q);C.row&&(k.remove(C.element,"dgrid-cell-editing"),l.empty(t),f.appendIfNode(t,e.renderCell(C.row.data,g._activeValue,t,g._activeOptions?n.delegate(y,g._activeOptions):y)));g._focusedEditorCell=g._activeCell=g._activeValue=g._activeOptions=null}})).pause();this._editorColumnListeners.push(e._editorBlurHandle);return c},_updatePropertyFromEditor:function(e,h,c){var g;if(!h.isValid||h.isValid())if(c=
this._updateProperty((h.domNode||h).parentNode,this._activeCell?this._activeValue:h._dgridLastValue,this._retrieveEditorValue(e,h),c),this._activeCell?this._activeValue=c:h._dgridLastValue=c,"radio"===h.type&&h.name&&!e.editOn&&e.field)for(g in c=this.row(h),a("input[type\x3dradio][name\x3d"+h.name+"]",this.contentNode).forEach(function(p){var q=this.row(p);p!==h&&p._dgridLastValue&&(p._dgridLastValue=!1,this.updateDirty?this.updateDirty(q.id,e.field,!1):q.data[e.field]=!1)},this),this.dirty)c.id.toString()!==
g&&this.dirty[g][e.field]&&this.updateDirty(g,e.field,!1)},_updateProperty:function(e,h,c,g){var p=this;if((h&&h.valueOf())!==(c&&c.valueOf())){var q=this.cell(e),u=q.row,v=q.column;e=q.element;if(v.field&&u)if(q={grid:this,cell:q,oldValue:h,value:c,bubbles:!0,cancelable:!0},g&&g.type&&(q.parentType=g.type),b.emit(e,"dgrid-datachange",q))this.updateDirty?(this.updateDirty(u.id,v.field,c),v.autoSave&&setTimeout(function(){p._trackError("save")},0)):u.data[v.field]=c;else{var t;(t=e.widget)?(t._dgridIgnoreChange=
!0,t.set("value",h),setTimeout(function(){t._dgridIgnoreChange=!1},0)):(t=e.input)&&this._updateInputValue(t,h);return h}}return c},_updateInputValue:function(e,h){e.value=h;if("radio"===e.type||"checkbox"===e.type)e.checked=e.defaultChecked=!!h},_retrieveEditorValue:function(e,h){return"function"===typeof h.get?this._convertEditorValue(h.get("value")):this._convertEditorValue(h["checkbox"===h.type||"radio"===h.type?"checked":"value"])},_convertEditorValue:function(e,h){"number"===typeof h?e=isNaN(e)?
e:parseFloat(e):"boolean"===typeof h?e="true"===e?!0:"false"===e?!1:e:h instanceof Date&&(h=new Date(e),e=isNaN(h.getTime())?e:h);return e},_removeEditorBlurHandles:function(){H.forEach(this.subRows,function(e){e instanceof Array?H.forEach(e,function(h){h._editorBlurHandle&&h._editorBlurHandle.remove()}):e._editorBlurHandle&&e._editorBlurHandle.remove()})}})})},"dgrid1/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/dom-class dojo/on dojo/_base/lang dojo/has ./util/misc dojo/_base/sniff".split(" "),
function(H,m,n,r,l,k,b){function a(x){x.preventDefault()}var d={checkbox:1,radio:1,button:1},f=/\bdgrid-cell\b/,e=/\bdgrid-row\b/,h=H(null,{pageSkip:10,tabIndex:0,keyMap:null,headerKeyMap:null,mouseDownEventType:"mousedown",postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=l.mixin({},h.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=l.mixin({},h.defaultHeaderKeyMap))},postCreate:function(){function x(z){var G=z.target;return G.type&&(!d[G.type]||32===z.keyCode)}
function w(z){function G(){A._focusedHeaderNode&&(A._focusedHeaderNode.tabIndex=-1);if(A.showHeader){if(L)for(var ca=A.headerNode.getElementsByTagName("th"),ba=0,la;la=ca[ba];++ba){if(R.test(la.className)){A._focusedHeaderNode=aa=la;break}}else A._focusedHeaderNode=aa=A.headerNode;aa&&(aa.tabIndex=A.tabIndex)}}function J(){var ca=A._focusedNode||aa;if(!R.test(ca.className)||!z.contains(ca)){for(var ba=z.getElementsByTagName("*"),la=0,oa;oa=ba[la];++la)if(R.test(oa.className)){ca=A._focusedNode=oa;
break}aa.tabIndex=-1;ca.tabIndex=A.tabIndex}}var L=A.cellNavigation,R=L?f:e,T=z===A.headerNode,aa=z;T?(G(),A._listeners.push(m.after(A,"renderHeader",G,!0))):A._listeners.push(m.after(A,"renderArray",J,!0),m.after(A,"_onNotification",function(ca,ba){0===ba.totalLength?z.tabIndex=0:1===ba.totalLength&&"add"===ba.type&&J()},!0));A._listeners.push(r(z,A.mouseDownEventType,function(ca){x(ca)||A._focusOnNode(ca.target,T,ca)}));A._listeners.push(r(z,"keydown",function(ca){if(!ca.metaKey&&!ca.altKey){var ba=
A[T?"headerKeyMap":"keyMap"][ca.keyCode];ba&&!x(ca)&&ba.call(A,ca)}}))}this.inherited(arguments);var A=this;this.tabableHeader&&(w(this.headerNode),r(this.headerNode,"dgrid-cellfocusin",function(){A.scrollTo({x:this.scrollLeft})}));w(this.contentNode);this._debouncedEnsureScroll=b.debounce(this._ensureScroll,this)},_pruneRow:function(){var x=this._focusedNode;this._focusedNode=null;this.inherited(arguments);this._focusedNode=x},removeRow:function(x){if(!this._focusedNode)return this.inherited(arguments);
var w=this,A=document.activeElement===this._focusedNode,z=this[this.cellNavigation?"cell":"row"](this._focusedNode),G=z.row||z,J;x=x.element||x;x===G.element&&((J=this.down(G,1,!0))&&J.element!==x||(J=this.up(G,1,!0)),this._removedFocus={active:A,rowId:G.id,columnId:z.column&&z.column.id,siblingId:J&&J.element!==x?J.id:void 0},setTimeout(function(){w._removedFocus&&w._restoreFocus(G.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(){var x=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(x);return x},_restoreFocus:function(x){var w=this._removedFocus,A;if((x=(x=x&&this.row(x))&&x.element&&x.id===w.rowId?x:"undefined"!==typeof w.siblingId&&this.row(w.siblingId))&&x.element){if(!x.element.parentNode.parentNode){w.wait=!0;return}"undefined"!==typeof w.columnId&&(A=this.cell(x,w.columnId))&&A.element&&(x=A);w.active&&0!==x.element.offsetHeight?this._focusOnNode(x,!1,null):(n.add(x.element,"dgrid-focus"),x.element.tabIndex=this.tabIndex,this._focusedNode=
x.element)}delete this._removedFocus},addKeyHandler:function(x,w,A){x=m.after(this[A?"headerKeyMap":"keyMap"],x,w,!0);this._listeners.push(x);return x},_ensureRowScroll:function(x){var w=this.getScrollPosition().y;w>x.offsetTop?this.scrollTo({y:x.offsetTop}):w+this.contentNode.offsetHeight<x.offsetTop+x.offsetHeight&&this.scrollTo({y:x.offsetTop-this.contentNode.offsetHeight+x.offsetHeight})},_ensureColumnScroll:function(x){var w=this.getScrollPosition().x,A=x.offsetLeft;if(w>A)this.scrollTo({x:A});
else{var z=this.bodyNode.clientWidth;x=x.offsetWidth;var G=A+x;w+z<G&&this.scrollTo({x:z>x?G-z:A})}},_ensureScroll:function(x,w){!x.column&&!x.row&&x.data&&x.element?this._ensureRowScroll(x.element):(this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!w&&this._ensureRowScroll(x.row.element),this.bodyNode.clientWidth<this.contentNode.offsetWidth&&this._ensureColumnScroll(x.element))},_focusOnNode:function(x,w,A){var z="_focused"+(w?"Header":"")+"Node",G=this[z],J=this.cellNavigation?"cell":
"row",L=this[J](x),R;if(x=L&&L.element){if(this.cellNavigation){var T=x.getElementsByTagName("input");var aa=0;for(R=T.length;aa<R;aa++){var ca=T[aa];if((-1!==ca.tabIndex||"_dgridLastValue"in ca)&&!ca.disabled){ca.focus();var ba=!0;break}}}null!==A&&(A=l.mixin({grid:this},A),A.type&&(A.parentType=A.type),A.bubbles||(A.bubbles=!0));G&&(n.remove(G,"dgrid-focus"),G.removeAttribute("tabindex"),A&&(A[J]=this[J](G),r.emit(G,"dgrid-cellfocusout",A)));G=this[z]=x;A&&(A[J]=L);z=this.cellNavigation?f:e;!ba&&
z.test(x.className)&&(x.tabIndex=this.tabIndex,x.focus());n.add(x,"dgrid-focus");A&&r.emit(G,"dgrid-cellfocusin",A);this._debouncedEnsureScroll(L,w)}},focusHeader:function(x){this._focusOnNode(x||this._focusedHeaderNode,!0)},focus:function(x){(x=x||this._focusedNode)?this._focusOnNode(x,!1):(this._removedFocus&&(this._removedFocus.active=!0),this.contentNode.focus())}}),c=h.moveFocusVertical=function(x,w){if(this._focusedNode&&x.target!==this.contentNode){var A=this.cellNavigation,z=this[A?"cell":
"row"](x);z=A&&z.column.id;w=this.down(this._focusedNode,w,!0);A&&(w=this.cell(w,z));this._focusOnNode(w,!1,x);x.preventDefault()}};H=h.moveFocusUp=function(x){c.call(this,x,-1)};var g=h.moveFocusDown=function(x){c.call(this,x,1)},p=h.moveFocusPageUp=function(x){c.call(this,x,-this.pageSkip)},q=h.moveFocusPageDown=function(x){c.call(this,x,this.pageSkip)},u=h.moveFocusHorizontal=function(x,w){if(this.cellNavigation&&x.target!==this.contentNode){var A=!this.row(x);this._focusOnNode(this.right(this["_focused"+
(A?"Header":"")+"Node"],w),A,x);x.preventDefault()}},v=h.moveFocusLeft=function(x){u.call(this,x,-1)},t=h.moveFocusRight=function(x){u.call(this,x,1)},y=h.moveHeaderFocusEnd=function(x,w){if(this.cellNavigation){var A=this.headerNode.getElementsByTagName("th");this._focusOnNode(A[w?0:A.length-1],!0,x)}x.preventDefault()},C=h.moveHeaderFocusHome=function(x){y.call(this,x,!0)},B=h.moveFocusEnd=function(x,w){var A=this.cellNavigation,z=this.contentNode,G=z.scrollTop+(w?0:z.scrollHeight);z=z[w?"firstChild":
"lastChild"];var J=-1<z.className.indexOf("dgrid-preload"),L=J?z[(w?"next":"previous")+"Sibling"]:z;x.preventDefault();this.scrollTo({y:G});if(J){for(;L&&0>L.className.indexOf("dgrid-row");)L=L[(w?"next":"previous")+"Sibling"];if(!L)return}if(!J||1>z.offsetHeight)A&&(L=this.cell(L,this.cell(x).column.id)),this._focusOnNode(L,!1,x);else{k("dom-addeventlistener")||(x=l.mixin({},x));var R=m.after(this,"renderArray",function(T){var aa=T[w?0:T.length-1];A&&(aa=this.cell(aa,this.cell(x).column.id));this._focusOnNode(aa,
!1,x);R.remove();return T});this._listeners.push(R)}},F=h.moveFocusHome=function(x){B.call(this,x,!0)};h.defaultKeyMap={32:a,33:p,34:q,35:B,36:F,37:v,38:H,39:t,40:g};h.defaultHeaderKeyMap={32:a,35:y,36:C,37:v,39:t};return h})},"dgrid1/Selection":function(){define("dojo/_base/declare dojo/aspect dojo/dom-class dojo/mouse dojo/on dojo/sniff dojo/has!touch?./util/touch dojo/query dojo/dom".split(" "),function(H,m,n,r,l,k,b){function a(q,u){u=q.unselectable=u?"on":"";q=q.getElementsByTagName("*");for(var v=
q.length;--v;)"INPUT"!==q[v].tagName&&"TEXTAREA"!==q[v].tagName&&(q[v].unselectable=u)}function d(q,u){var v=q.bodyNode,t=u?"text":21>k("ff")?"-moz-none":"none";e&&"msUserSelect"!==e?v.style[e]=t:k("dom-selectstart")?u||q._selectstartHandle?u&&q._selectstartHandle&&(q._selectstartHandle.remove(),delete q._selectstartHandle):q._selectstartHandle=l(v,"selectstart",function(y){var C=y.target&&y.target.tagName;"INPUT"!==C&&"TEXTAREA"!==C&&y.preventDefault()}):(a(v,!u),u||q._unselectableHandle)?u&&q._unselectableHandle&&
(q._unselectableHandle.remove(),delete q._unselectableHandle):q._unselectableHandle=m.after(q,"renderRow",function(y){a(y,!0);return y})}k.add("dom-comparedocumentposition",function(q,u,v){return!!v.compareDocumentPosition});k.add("dom-selectstart","undefined"!==typeof document.onselectstart);var f=k("mac")?"metaKey":"ctrlKey",e=k("css-user-select"),h=k("pointer"),c=h&&"MS"===h.slice(0,2),g=h?h+(c?"Down":"down"):"mousedown",p=h?h+(c?"Up":"up"):"mouseup";"WebkitUserSelect"===e&&"undefined"!==typeof document.documentElement.style.msUserSelect&&
(e=!1);return H(null,{selectionDelegate:".dgrid-row",selectionEvents:g+","+p+",dgrid-cellfocusin",selectionTouchEvents:k("touch")?b.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var q=this.selectionMode;this.selectionMode="";this._setSelectionMode(q)},destroy:function(){this.inherited(arguments);
this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(q){q!==this.selectionMode&&(this.clearSelection(),this.selectionMode=q,this._selectionHandlerName="_"+q+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},_setAllowTextSelection:function(q){"undefined"!==typeof q?d(this,q):d(this,"none"===this.selectionMode);this.allowTextSelection=
q},_handleSelect:function(q,u){if(!r.isRight(q)&&this[this._selectionHandlerName]&&this.allowSelect(this.row(u))&&("dgrid-cellfocusin"!==q.type||"mousedown"!==q.parentType)&&(q.type!==p||u===this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=q;if(!q.keyCode||!q.ctrlKey||32===q.keyCode)if(!q.shiftKey&&q.type===g&&this.isSelected(u))this._waitForMouseUp=u;else this[this._selectionHandlerName](q,u);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(q,u){q=q.keyCode?
q.ctrlKey:q[f];this._lastSelected===u?this.select(u,null,!q||!this.isSelected(u)):(this.clearSelection(),this.select(u),this._lastSelected=u)},_multipleSelectionHandler:function(q,u){var v=this._lastSelected,t=q.keyCode?q.ctrlKey:q[f];if(!q.shiftKey){var y=t?null:!0;v=null}this.select(u,v,y);v||(this._lastSelected=u)},_extendedSelectionHandler:function(q,u){if(q[f]||!this.isSelected(u)||1!==this.getSelectedCount())(2===q.button?this.isSelected(u):q.keyCode?q.ctrlKey:q[f])||this.clearSelection(null,
!0),this._multipleSelectionHandler(q,u)},_toggleSelectionHandler:function(q,u){this.select(u,null,null)},_initSelectionEvents:function(){var q=this,u=this.contentNode,v=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};k("touch")&&!k("pointer")&&this.selectionTouchEvents?(l(u,b.selector(v,this.selectionTouchEvents),function(t){q._handleSelect(t,this);q._ignoreMouseSelect=this}),l(u,l.selector(v,this.selectionEvents),function(t){q._ignoreMouseSelect!==this?q._handleSelect(t,
this):t.type===p&&(q._ignoreMouseSelect=null)})):l(u,l.selector(v,this.selectionEvents),function(t){q._handleSelect(t,this)});this.addKeyHandler&&this.addKeyHandler(32,function(t){q._handleSelect(t,t.target)});if(this.allowSelectAll)this.on("keydown",function(t){t[f]&&65===t.keyCode&&!/\bdgrid-input\b/.test(t.target.className)&&(t.preventDefault(),q[q.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&this._listeners.push(m.before(this,"_setCollection",function(t){q._updateDeselectionAspect(t)}));
this._updateDeselectionAspect()},_updateDeselectionAspect:function(q){function u(y,C){if((y=v.row(y))&&v.selection[y.id])v[C](y)}var v=this;this._removeDeselectSignals&&this._removeDeselectSignals();var t=q&&q.track&&this._observeCollection?[m.before(this,"_observeCollection",function(y){t.push(y.on("delete",function(C){"undefined"===typeof C.index&&u(C.id,"deselect")}))}),m.after(this,"_observeCollection",function(y){t.push(y.on("update",function(C){"undefined"!==typeof C.index&&u(y.getIdentity(C.target),
"select")}))},!0)]:[m.before(this,"removeRow",function(y,C){C||(y=this.row(y))&&y.id in this.selection&&this.deselect(y)})];this._removeDeselectSignals=function(){for(var y=t.length;y--;)t[y].remove();t=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(q){var u=this._selectionEventQueues[q],v=this._selectionTriggerEvent;var t={bubbles:!0,grid:this};v&&(t.parentType=v.type);t[this._selectionTargetType]=u;this._selectionEventQueues[q]=[];l.emit(this.contentNode,"dgrid-"+q,t)},_fireSelectionEvents:function(){var q=
this._selectionEventQueues,u;for(u in q)q[u].length&&this._fireSelectionEvent(u)},_select:function(q,u,v){"undefined"===typeof v&&(v=!0);q.element||(q=this.row(q));if(!1===v||this.allowSelect(q)){var t=this.selection;var y=!!t[q.id];null===v&&(v=!y);var C=q.element;v||this.allSelected?t[q.id]=v:delete this.selection[q.id];C&&(v?n.add(C,"dgrid-selected"+(this.addUiClasses?" ui-state-active":"")):n.remove(C,"dgrid-selected ui-state-active"));v!==y&&C&&this._selectionEventQueues[(v?"":"de")+"select"].push(q);
if(u)if(u.element||(u=this.row(u)),u){if(u=u.element)for(t=this._determineSelectionDirection(C,u),t||(u=document.getElementById(u.id),t=this._determineSelectionDirection(C,u));q.element!==u&&(q=this[t](q));)this._select(q,null,v)}else this._lastSelected=C,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")}},
_determineSelectionDirection:k("dom-comparedocumentposition")?function(q,u){q=u.compareDocumentPosition(q);return q&1?!1:2===q?"down":"up"}:function(q,u){return 1>u.sourceIndex?!1:u.sourceIndex>q.sourceIndex?"down":"up"},select:function(q,u,v){this._select(q,u,v);this._fireSelectionEvents()},deselect:function(q,u){this.select(q,u,!1)},clearSelection:function(q,u){this.allSelected=!1;for(var v in this.selection)q!==v&&this._select(v,null,!1);u||(this._lastSelected=null);this._fireSelectionEvents()},
selectAll:function(){this.allSelected=!0;this.selection={};for(var q in this._rowIdToObject){var u=this.row(this._rowIdToObject[q]);this._select(u.id,null,!0)}this._fireSelectionEvents()},getSelectedCount:function(){var q=0,u;for(u in this.selection)u&&(q+=1);return q},isSelected:function(q){if("undefined"===typeof q||null===q)return!1;q.element||(q=this.row(q));return q.id in this.selection?!!this.selection[q.id]:this.allSelected&&(!q.data||this.allowSelect(q))},refresh:function(){this.deselectOnRefresh&&
this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var q=this.inherited(arguments),u=this.selection,v,t;for(v=0;v<q.length;v++){var y=this.row(q[v]);(t=y.id in u?u[y.id]:this.allSelected)&&this.select(y,null,t)}this._fireSelectionEvents();return q}})})},"dgrid1/Selector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/sniff dojo/dom-construct dojo/dom-class ./Selection".split(" "),function(H,m,n,r,l,k){return H(k,{postCreate:function(){this.inherited(arguments);
this.on(".dgrid-selector:click,.dgrid-selector:keydown",m.hitch(this,"_handleSelectorClick"));this.on("dgrid-select",m.hitch(this,"_changeSelectorInput",!0));this.on("dgrid-deselect",m.hitch(this,"_changeSelectorInput",!1))},_defaultRenderSelectorInput:function(b,a,d,f){var e=b.grid;l.add(d,"dgrid-selector");return d.input=r.create("input",{"aria-checked":a,checked:a,disabled:!e.allowSelect(e.row(f)),tabIndex:isNaN(b.tabIndex)?-1:b.tabIndex,type:b.selector},d)},_configureSelectorColumn:function(b){var a=
this,d=b.selector;this._selectorColumns.push(b);this._selectorSingleRow=this._selectorSingleRow||"radio"===b.selector;var f="function"===typeof d?d:this._defaultRenderSelectorInput;b.sortable=!1;b.renderCell=function(e,h,c){h=(h=e&&a.row(e))&&a.selection[h.id];f(b,!!h,c,e)};b.renderHeaderCell=function(e){var h="label"in b?b.label:b.field||"";"radio"!==b.selector&&a.allowSelectAll?(b._selectorHeaderCheckbox=f(b,!1,e,{}),a._hasSelectorHeaderCheckbox=!0):e.appendChild(document.createTextNode(h))}},_handleSelectorClick:function(b){if("INPUT"!==
b.target.nodeName||"keydown"!==b.type||32!==b.keyCode){var a=this.cell(b).row;if("click"===b.type||32===b.keyCode||!n("opera")&&13===b.keyCode||0===b.keyCode){this._selectionTriggerEvent=b;if(a){if(this.allowSelect(a)){var d=this._lastSelected&&this.row(this._lastSelected);this._selectorSingleRow?d&&d.id===a.id||(this.clearSelection(),this.select(a,null,!0),this._lastSelected=a.element):a&&(b.shiftKey?this._changeSelectorInput(!0,{rows:[a]}):d=null,d=b.shiftKey?d:null,this.select(d||a,a,d?void 0:
null),this._lastSelected=a.element)}}else this[this.allSelected?"clearSelection":"selectAll"]();this._selectionTriggerEvent=null}}},_changeSelectorInput:function(b,a){this._selectorColumns.length&&this._updateRowSelectors(b,a);this._hasSelectorHeaderCheckbox&&this._updateHeaderCheckboxes()},_updateRowSelectors:function(b,a){a=a.rows;for(var d=a.length,f=this._selectorColumns.length,e=0;e<d;e++)for(var h=0;h<f;h++){var c=this.cell(a[e],this._selectorColumns[h].id).element;c&&(c=(c.contents||c).input)&&
!c.disabled&&(c.checked=b,c.setAttribute("aria-checked",b))}},_updateHeaderCheckboxes:function(){for(var b=this._selectorColumns.length,a=0;a<b;a++){var d="false",f=this._selectorColumns[a]._selectorHeaderCheckbox;if(f){var e=this.selection;var h=!1;for(var c in e)if(e[c]!=this.allSelected){h=!0;break}f.indeterminate=h;f.checked=this.allSelected;h?d="mixed":this.allSelected&&(d="true");f.setAttribute("aria-checked",d)}}},configStructure:function(){this.inherited(arguments);var b=this.columns;this._selectorColumns=
[];this._hasSelectorHeaderCheckbox=this._selectorSingleRow=!1;for(var a in b)b[a].selector&&this._configureSelectorColumn(b[a])},_handleSelect:function(b){var a=this.cell(b).column;a&&a.selector||this.inherited(arguments)}})})},"dgrid1/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-geometry dojo/has ../util/misc dojo/_base/html".split(" "),function(H,m,n,r,l,k,b,a,d,f){function e(v,t,y,C,B){for(var F=
1;F<t;F++)v[y+F][C]=B}function h(v){for(var t=v.length,y=t,C=m.filter(v[0],function(L){return!L.hidden}).length,B=Array(t);t--;)B[t]=Array(C);var F={};for(t=0;t<y;t++)for(var x=B[t],w=v[t],A=0,z=0;A<C;A++){var G=w[z],J;if("undefined"===typeof x[A]){x[A]=G.id;G.rowSpan&&1<G.rowSpan&&e(B,G.rowSpan,t,A,G.id);if(0<t&&G.colSpan&&1<G.colSpan)for(J=1;J<G.colSpan;J++)x[++A]=G.id,G.rowSpan&&1<G.rowSpan&&e(B,G.rowSpan,t,A,G.id);F[G.id]=v[0][A].id;z++}}return F}function c(v,t,y,C,B){if(!(0>=y)){var F=v.columns[t];
if(F){var x={grid:v,columnId:t,width:y,bubbles:!0,cancelable:!0};C&&(x.parentType=C);if(!v._resizedColumns||n.emit(v.headerNode,"dgrid-columnresize",x))return"auto"===y?delete F.width:(F.width=y,y+="px"),(C=v._columnSizes[t])?C.set("width",y):C=f.addCssRule("#"+f.escapeCssIdentifier(v.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(t,"-"),"width: "+y+";"),v._columnSizes[t]=C,!1!==B&&v.resize(),!0}}}var g,p,q=0,u={create:function(){g=b.create("div",{className:"dgrid-column-resizer"});p=b.create("div",
{className:"dgrid-resize-guard"})},destroy:function(){b.destroy(g);b.destroy(p);g=p=null},show:function(v){var t=a.position(v.domNode,!0);g.style.top=t.y+"px";g.style.height=t.h+"px";document.body.appendChild(g);v.domNode.appendChild(p)},move:function(v){g.style.left=v+"px"},hide:function(){g.parentNode.removeChild(g);p.parentNode.removeChild(p)}};return H(null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);q||u.create();q++},
destroy:function(){this.inherited(arguments);for(var v in this._columnSizes)this._columnSizes[v].remove();--q||u.destroy()},resizeColumnWidth:function(v,t){return c(this,v,t)},configStructure:function(){var v=this._oldColumnSizes=l.mixin({},this._columnSizes),t;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(t in v)t in this._columnSizes||v[t].remove();delete this._oldColumnSizes},_configColumn:function(v){this.inherited(arguments);var t=v.id,y;"width"in v&&((y=this._oldColumnSizes[t])?
y.set("width",v.width+"px"):y=f.addCssRule("#"+f.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(t,"-"),"width: "+v.width+"px;"),this._columnSizes[t]=y)},renderHeader:function(){this.inherited(arguments);var v=this;if(this.columnSets&&this.columnSets.length)for(var t=this.columnSets.length;t--;)var y=l.mixin(y||{},h(this.columnSets[t]));else this.subRows&&1<this.subRows.length&&(y=h(this.subRows));t=r(".dgrid-cell",v.headerNode);for(var C=t.length;C--;){var B=t[C],F=B.columnId,
x=v.columns[F],w=B.childNodes;if(x&&!1!==x.resizable){x=b.create("div",{className:"dgrid-resize-header-container"});for(B.contents=x;0<w.length;)x.appendChild(w[0]);w=b.create("div",{className:"dgrid-resize-handle resizeNode-"+f.escapeCssIdentifier(F,"-")},x);B.appendChild(x);w.columnId=y&&y[F]||F}}v.mouseMoveListen||(n(v.headerNode,".dgrid-resize-handle:mousedown"+(d("touch")?",.dgrid-resize-handle:touchstart":""),function(A){v._resizeMouseDown(A,this);v.mouseMoveListen.resume();v.mouseUpListen.resume()}),
v._listeners.push(v.mouseMoveListen=n.pausable(document,"mousemove"+(d("touch")?",touchmove":""),f.throttleDelayed(function(A){v._updateResizerPosition(A)}))),v._listeners.push(v.mouseUpListen=n.pausable(document,"mouseup"+(d("touch")?",touchend":""),function(A){v._resizeMouseUp(A);v.mouseMoveListen.pause();v.mouseUpListen.pause()})),v.mouseMoveListen.pause(),v.mouseUpListen.pause())},_resizeMouseDown:function(v,t){v.preventDefault();k.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(v);
this._targetCell=r(".dgrid-column-"+f.escapeCssIdentifier(t.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(v);u.show(this)},_resizeMouseUp:function(v){var t=this._columnSizes,y;this.adjustLastColumn&&(y=this.headerNode.clientWidth-1);if(!this._resizedColumns){var C=r(".dgrid-cell",this.headerNode);this.columnSets&&this.columnSets.length?C=C.filter(function(G){return"0"===G.columnId.split("-")[0]&&!(G.columnId in t)}):this.subRows&&1<this.subRows.length&&(C=C.filter(function(G){return"0"===
G.columnId.charAt(0)&&!(G.columnId in t)}));var B=C.map(function(G){return G.offsetWidth});C.forEach(function(G,J){c(this,G.columnId,B[J],null,!1)},this);this._resizedColumns=!0}k.setSelectable(this.domNode,!0);C=this._targetCell;var F=this._getResizeMouseLocation(v)-this._startX,x=C.offsetWidth+F,w=this._getResizedColumnWidths(),A=w.totalWidth;w=w.lastColId;var z=r(".dgrid-column-"+f.escapeCssIdentifier(w,"-"),this.headerNode)[0].offsetWidth;x<this.minWidth&&(x=this.minWidth);c(this,C.columnId,x,
v.type)&&C.columnId!==w&&this.adjustLastColumn&&(A+F<y?c(this,w,"auto",v.type):z-F<=this.minWidth&&c(this,w,this.minWidth,v.type));u.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(v){if(this._targetCell){v=this._getResizeMouseLocation(v);var t=this._targetCell.offsetWidth,y=v;t+(v-this._startX)<this.minWidth&&(y=this._startX-(t-this.minWidth));u.move(y)}},_getResizeMouseLocation:function(v){var t=0;v.pageX?t=v.pageX:v.clientX&&(t=v.clientX+document.body.scrollLeft+
document.documentElement.scrollLeft);return t},_getResizedColumnWidths:function(){var v=0,t=r((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),y=t.length;if(!y)return{};for(var C=t[y-1].columnId;y--;)v+=t[y].offsetWidth;return{totalWidth:v,lastColId:C}}})})},"dgrid1/extensions/DijitRegistry":function(){define(["dojo/_base/declare","dojo/dom-geometry","dijit/_WidgetBase","dijit/registry"],function(H,m,n,r){var l=n.prototype;return H(null,{minSize:0,maxSize:Infinity,
layoutPriority:0,showTitle:!0,buildRendering:function(){r.add(this);this.inherited(arguments);this.domNode.setAttribute("widgetId",this.id)},startup:function(){if(!this._started){this.inherited(arguments);var k=this.getParent();k&&k.isLayoutContainer&&this._resizeHandle.remove()}},destroyRecursive:function(){this.destroy()},destroy:function(){this.inherited(arguments);r.remove(this.id)},getChildren:function(){return[]},getParent:function(){return r.getEnclosingWidget(this.domNode.parentNode)},isLeftToRight:function(){return!this.isRTL},
placeAt:function(k,b){return l.placeAt.call(this,k,b)},resize:function(k){k&&m.setMarginBox(this.domNode,k);this.inherited(arguments)},_set:function(k,b){this[k]=b},watch:function(){}})})},"esri/dijit/analysis/_Widget":function(){define(["dijit/_WidgetBase","dojo/_base/lang","dojo/dom-class"],function(H,m,n){return H.createSubclass({declaredClass:"esri.dijit.analysis.Widget",create:function(r,l){r=m.mixin({viewModel:{}},r);r.viewModel=this._ensureViewModelInstance(r.viewModel);this.inherited(arguments,
[r,l])},destroy:function(){this.inherited(arguments);this.viewModel.destroy&&this.viewModel.destroy();this.viewModel=null},viewModel:null,_setViewModelAttr:function(r){this._set("viewModel",this._ensureViewModelInstance(r))},viewModelType:null,visible:!0,_setVisibleAttr:function(r){this._set("visible",r);n.toggle(this.domNode,"esri-hidden",!r)},_ensureViewModelInstance:function(r){return r&&!r.declaredClass&&this.viewModelType?new this.viewModelType(r):r}})})},"esri/dijit/analysis/SettingsViewModel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/has dojo/json dojo/Stateful ./storeUtils ./SpatialReferences ./JobsViewModel ../../kernel ../../lang".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h){H=H([b],{declaredClass:"esri.dijit.analysis.SettingsViewModel",showHelp:!0,showOverwriteResultOption:!0,showCloseAnalysisOption:!0,showStoreAnalysisOption:!0,showCoordinateSystems:!0,showOutSR:!0,showProcessSR:!0,showExtent:!0,showRasterSettings:!0,showGeoAnalyticsSettings:!0,showRasterPPFSettings:!1,showRasterPTSettings:!1,showRasterSnapSettings:!0,showRasterMaskSettings:!1,showCreditWarningSettings:!0,showResamplingSettings:!1,showCloseIcon:!0,showHeader:!0,showOkCancel:!0,
showJobsHistory:!1,isCustomExtent:!1,layers:null,viewProps:null,closeAnalysisWidget:!0,returnFeaturCollection:!1,jobsViewModel:null,geoAnalyticsServer:null,creditWarning:!0,spatialRefStore:a.createHierarchicalStore({data:d}),spatialRefData:d,constructor:function(c){var g=this.get("saveModel");g&&g.layers&&c.layers&&(this._arrayUnique(c.layers.concat(g.layers),"name"),delete g.layers);m.mixin(c,g);this.watch("showJobsHistory",m.hitch(this,this.updateJobsVM));this.watch("portalUrl",m.hitch(this,this.updateJobsVM));
this.watch("jobsHistoryItem",m.hitch(this,this.updateJobsVM))},_showCloseIconSetter:function(c){this.showCloseIcon=c},_showHelpSetter:function(c){this.showHelp=c},_showOverwriteResultOptionSetter:function(c){this.showOverwriteResultOption=c},_showCloseAnalysisOptionSetter:function(c){this.showCloseAnalysisOption=c},_showStoreAnalysisOptionSetter:function(c){this.showStoreAnalysisOption=c},_showCoordinateSystemsSetter:function(c){this.showCoordinateSystems=c},_showExtentSetter:function(c){this.showExtent=
c},_showRasterSettingsSetter:function(c){this.showRasterSettings=c},_showRasterPPFSettingsSetter:function(c){this.showRasterPPFSettings=c},_showRasterPTSettingsSetter:function(c){this.showRasterPTSettings=c},_showRasterSnapSettingsSetter:function(c){this.showRasterSnapSettings=c},_showRasterMaskSettingsSetter:function(c){this.showRasterMaskSettings=c},_returnFeatureCollectionSetter:function(c){this.returnFeatureCollection=c},_closeAnalysisWidgetSetter:function(c){this.closeAnalysisWidget=c},_overwriteResultSetter:function(c){this.overwriteResult=
c},_outSRSetter:function(c){this.outSR=c},_processSRSetter:function(c){this.processSR=c},_extentSetter:function(c){this.extent=c},_snapRasterSetter:function(c){this.snapRaster=c},_cellSizeSetter:function(c){this.cellSize=c},_maskSetter:function(c){this.mask=c},_layersSetter:function(c){this.layers=c},_showHeaderSetter:function(c){this.showHeader=c},_showOutSRSetter:function(c){this.showOutSR=c;this.set("outSR",c?this.outSR:void 0)},_showProcessSRSetter:function(c){this.showProcessSR=c;this.set("processSR",
c?this.processSR:void 0)},_showOkCancelSetter:function(c){this.showOkCancel=!0},_isCustomExtentSetter:function(c){this.isCustomExtent=c},_isCustomOutSRSetter:function(c){this.isCustomOutSR=c},_isCustomProcessSRSetter:function(c){this.isCustomProcessSR=c},_isCustomCellSizeSetter:function(c){this.isCustomCellSize=c},_showGeoAnalyticsSettingsSetter:function(c){this.showGeoAnalyticsSettings=c},_datastoreSetter:function(c){this.datastore=c},_portalUrlSetter:function(c){this.portalUrl=c},_jobsHistoryItemSetter:function(c){this.jobsHistoryItem=
c},_viewPropsSetter:function(c){this.viewProps=c},_saveModelGetter:function(){var c;window.localStorage&&(c=window.localStorage.getItem("esri_analysis_settings"))&&(c=k.parse(c));return c},_saveModelSetter:function(c){c||(c={isCustomExtent:this.isCustomExtent,isCustomOutSR:this.isCustomOutSR,isCustomProcessSR:this.isCustomProcessSR,isCustomCellSize:this.isCustomCellSize,outSR:this.outSR,processSR:this.processSR,extent:this.extent,cellSize:this.cellSize,snapRaster:this.snapRaster,mask:this.mask,datastore:this.datastore,
viewProps:this.viewProps,closeAnalysisWidget:this.closeAnalysisWidget,returnFeatureCollection:this.returnFeatureCollection,processorType:this.processorType,parallelProcessingFactor:this.parallelProcessingFactor,recycleProcessingWorkers:this.recycleProcessingWorkers,retryOnFailures:this.retryOnFailures,resamplingMethod:this.resamplingMethod,creditWarning:this.creditWarning},this.layers&&0<this.layers.length&&(c.layers=n.map(this.layers,function(g){return{name:g.name,url:g.url,fullExtent:g.fullExtent,
type:g.type,format:g.format}})));window.localStorage&&c&&window.localStorage.setItem("esri_analysis_settings",k.stringify(c))},_geoAnalyticsServerSetter:function(c){this.geoAnalyticsServer=c},_processorTypeSetter:function(c){this.processorType=c},_parallelProcessingFactorSetter:function(c){this.parallelProcessingFactor=c},_recycleIntervalOfProecssingWorkersSetter:function(c){this.recycleIntervalOfProecssingWorkers=c},_numberOfRetriesOnRandomFailureSetter:function(c){this.numberOfRetriesOnRandomFailure=
c},_resamplingMethodSetter:function(c){this.resamplingMethod=c},_creditWarningSetter:function(c){this.creditWarning=c},save:function(){this.set("saveModel")},reset:function(){m.mixin(this,this.get("saveModel"))},updateJobsVM:function(){this.showJobsHistory&&this.portalUrl&&this.jobsHistoryItem&&!this.jobsViewModel&&(this.jobsViewModel=new f({portalUrl:this.portalUrl,item:this.jobsHistoryItem}),this.watch("jobsHistoryItem",m.hitch(this,function(){this.jobsViewModel.set("item",this.jobsHistoryItem)})),
this.watch("portalUrl",m.hitch(this,function(){this.jobsViewModel.set("portalUrl",this.portalUrl)})))},_arrayUnique:function(c,g){c=c.concat();for(var p=0;p<c.length;++p)for(var q=p+1;q<c.length;++q)(!g&&c[p]===c[q]||g&&c[p][g]===c[q][g])&&c.splice(q--,1);return c}});l("extend-esri")&&m.setObject("dijit.analysis.SettingsViewModel",H,e);return H})},"esri/dijit/analysis/storeUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dstore/Memory dstore/Trackable dstore/Tree ../../kernel".split(" "),
function(H,m,n,r,l,k,b){var a=H([r,l]);r={createHierarchicalStore:function(d){d=this.createSyncStore(d,k);d.getRootCollection=function(){return this.root.filter({parent:void 0})};return d.getRootCollection()},createSyncStore:function(d,f){d=d||{};d.data&&(d=m.mixin({},d,{data:m.clone(d.data)}));return new (f?H([a,f]):a)(d)},createStore:function(d){for(var f={identifier:"id",label:"id",items:[]},e=0,h=d.length;e<h;e++)f.items.push(m.mixin({id:e},d[e%h]));return this.createSyncStore({data:f})}};n("extend-esri")&&
m.setObject("dijit.analysis.storeUtils",r,b);return r})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),function(H,m,n,r,l,k,b){return H([r,l,k],{constructor:function(){this.storage.version=0},postscript:function(){this.inherited(arguments);this.setData(this.data||[])},data:null,autoEmitEvents:!1,getSync:function(a){return this.storage.fullData[this.storage.index[a]]},putSync:function(a,d){d=d||{};
var f=this.storage,e=f.index,h=f.fullData,c=this.Model;!c||a instanceof c||(a=this._restore(a));var g=this.getIdentity(a);null==g&&(this._setIdentity(a,"id"in d?d.id:Math.random()),g=this.getIdentity(a));f.version++;f=g in e?"update":"add";c={target:a};var p;if("update"===f){if(!1===d.overwrite)throw Error("Object already exists");g=p=e[g]}else g=this.defaultNewToStart?0:h.length;if("beforeId"in d){var q=d.beforeId;null===q?(d=h.length,"update"===f&&--d):(d=e[q],p<d&&--d);void 0!==d?c.beforeId=q:
(console.error("options.beforeId was specified but no corresponding index was found"),d=g)}else d=g;if(d===p)h[d]=a;else for(void 0!==p&&h.splice(p,1),h.splice(d,0,a),p=void 0===p?d:Math.min(p,d),d=h.length;p<d;++p)e[this.getIdentity(h[p])]=p;this.emit(f,c);return a},addSync:function(a,d){(d=d||{}).overwrite=!1;return this.putSync(a,d)},removeSync:function(a){var d=this.storage,f=d.index;d=d.fullData;if(a in f)return f=d.splice(f[a],1)[0],this._reindex(),this.emit("delete",{id:a,target:f}),!0},setData:function(a){this.parse&&
(a=this.parse(a));a.items&&(this.idProperty=a.identifier||this.idProperty,a=a.items);this.storage.fullData=this.data=a;this._reindex()},_reindex:function(){for(var a=this.storage,d=a.index={},f=a.fullData,e=this.Model,h=Object.prototype,c=0,g=f.length;c<g;c++){var p=f[c];if(e&&!(p instanceof e)){var q=this._restore(p,p.__proto__===h);p!==q&&(f[c]=p=q)}d[this.getIdentity(p)]=c}a.version++},fetchSync:function(){var a=this.data;if(!a||a._version!==this.storage.version){a=this.storage.fullData;for(var d=
this.queryLog,f=0,e=d.length;f<e;f++)a=d[f].querier(a);a._version=this.storage.version;this.data=a}return new b(a)},fetchRangeSync:function(a){var d=this.fetchSync();return new b(d.slice(a.start,a.end),{totalLength:d.length})},_includePropertyInSubCollection:function(a){return"data"!==a&&this.inherited(arguments)}})})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/_base/declare ./QueryMethod ./Filter dojo/Evented".split(" "),function(H,m,n,
r,l,k,b,a,d){function f(h){return function(c,g){var p=this;l(c,function(q){q={target:q};var u=g[1]||{};"beforeId"in u&&(q.beforeId=u.beforeId);p.emit(h,q)});return c}}r.add("object-proto",!!{}.__proto__&&!{}.watch);var e=r("object-proto");return k(d,{constructor:function(h){h&&k.safeMixin(this,h);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([]).extend({_store:this}));this.storage=new d;var c=this;this.autoEmitEvents&&(n.after(this,"add",f("add")),n.after(this,"put",
f("update")),n.after(this,"remove",function(g,p){l(g,function(){c.emit("delete",{id:p[0]})});return g}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(h){return h.get?h.get(this.idProperty):h[this.idProperty]},_setIdentity:function(h,c){h.set?h.set(this.idProperty,c):h[this.idProperty]=c},forEach:function(h,c){var g=this;return l(this.fetch(),function(p){for(var q=0,u;void 0!==(u=p[q]);q++)h.call(c,u,q,g);return p})},matchesFilter:function(h){var c=this.queryLog;if(c&&
h){h=[h];for(var g=0,p=c.length;g<p;g++)h=c[g].querier(h);return 0<h.length}return!0},on:function(h,c,g){var p=this;return this.storage.on(h,function(q){c&&(!g||p.matchesFilter(q&&q.target))&&c&&c(q)})},emit:function(h,c){c=c||{};c.type=h;try{return this.storage.emit(h,c)}catch(g){console.error(g)}finally{return c.cancelable}},parse:null,stringify:null,Model:null,_restore:function(h,c){var g=this.Model;if(g&&h){var p=g.prototype,q=p._restore;q?h=q.call(h,g,c):e&&c?h.__proto__=p:h=H.delegate(p,h)}return h},
create:function(h){return new this.Model(h)},_createSubCollection:function(h){var c=H.delegate(this.constructor.prototype),g;for(g in this)this._includePropertyInSubCollection(g,c)&&(c[g]=this[g]);return k.safeMixin(c,h)},_includePropertyInSubCollection:function(h,c){return!(h in c)||c[h]!==this[h]},queryLog:[],filter:new b({type:"filter",normalizeArguments:function(h){var c=this.Filter;return h instanceof c?[h]:[new c(h)]}}),Filter:a,sort:new b({type:"sort",normalizeArguments:function(h,c){if("function"===
typeof h)var g=[h];else g=h instanceof Array?h.slice():"object"===typeof h?[].slice.call(arguments):[{property:h,descending:c}],g=m.map(g,function(p){p=H.mixin({},p);p.descending=!!p.descending;return p}),g=[g];return g}}),select:new b({type:"select"}),_getQuerierFactory:function(h){return this["_create"+(h[0].toUpperCase()+h.substr(1))+"Querier"]}})})},"dstore/QueryMethod":function(){define([],function(){return function(H){var m=H.type,n=H.normalizeArguments,r=H.applyQuery,l=H.querierFactory;return function(){var k=
Array.prototype.slice.call(arguments),b=n?n.apply(this,k):k;k={type:m,arguments:k,normalizedArguments:b};var a=this._getQuerierFactory(m)||l;a&&(k.querier=a.apply(this,b));b=this._createSubCollection({queryLog:this.queryLog.concat(k)});return r?r.call(this,b,k):b}}})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(H){function m(r){return function(){var l=this.constructor,k=new l;k.type=r;k.args=Array.prototype.slice.call(arguments);return this.type?m("and").call(l.prototype,this,
k):k}}function n(r){return function(){for(var l=this.constructor,k=[],b=0;b<arguments.length;b++){var a=arguments[b];k.push(a instanceof l?a:new l(a))}l=new l;l.type=r;l.args=k;this.type===r?l.args=this.args.concat(k):this.type?k.unshift(this):1===k.length&&k[0].type&&(l.type=k[0].type,l.args=k[0].args.slice());return l}}H=H(null,{constructor:function(r){var l=typeof r;switch(l){case "object":l=this;for(var k in r){var b=r[k];l=b instanceof this.constructor?l[b.type](k,b.args[0]):b&&b.test?l.match(k,
b):l.eq(k,b)}this.type=l.type;this.args=l.args;break;case "function":case "string":this.type=l,this.args=[r]}},and:n("and"),or:n("or"),eq:m("eq"),ne:m("ne"),lt:m("lt"),lte:m("lte"),gt:m("gt"),gte:m("gte"),contains:m("contains"),"in":m("in"),match:m("match")});H.filterCreator=m;H.logicalOperatorCreator=n;return H})},"dstore/Promised":function(){define(["dojo/_base/declare","dojo/Deferred","./QueryResults","dojo/when"],function(H,m,n,r){function l(k,b){return function(){var a=new m;try{a.resolve(this[k].apply(this,
arguments))}catch(d){a.reject(d)}return b?(a=new n(a.promise),a.totalLength=r(a.totalLength),a):a.promise}}return H(null,{get:l("getSync"),put:l("putSync"),add:l("addSync"),remove:l("removeSync"),fetch:l("fetchSync",!0),fetchRange:l("fetchRangeSync",!0)})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(H,m){function n(r,l){return m(this,function(k){for(var b=0,a=k.length;b<a;b++)r.call(l,k[b],b,k)})}return function(r,l){var k=l&&"totalLength"in l;if(r.then){r=H.delegate(r);
var b=r.then(function(a){var d=k?l.totalLength:a.totalLength||a.length;a.totalLength=d;return!k&&d});r.totalLength=k?l.totalLength:b;r.response=l&&l.response}else r.totalLength=k?l.totalLength:r.length;r.forEach=n;return r}})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(H,m){function n(l,k){if(-1<l.indexOf(".")){var b=l.split("."),a=b.length;return function(d){for(var f=0;f<a;f++)d=d&&(k&&d.get?d.get(b[f]):d[b[f]]);return d}}return function(d){return d.get?
d.get(l):d[l]}}var r={eq:function(l,k){return l===k},"in":function(l,k){return-1<m.indexOf(k.data||k,l)},ne:function(l,k){return l!==k},lt:function(l,k){return l<k},lte:function(l,k){return l<=k},gt:function(l,k){return l>k},gte:function(l,k){return l>=k},match:function(l,k,b){return k.test(l,b)},contains:function(l,k,b,a){var d=this;k=k.data?k.data:Array.isArray(k)?k:[k];return m.every(k,function(f){if("object"===typeof f&&f.type){var e=d._getFilterComparator(f.type);return m.some(l,function(h){return e.call(d,
h,f.args[1],b,a)})}return-1<m.indexOf(l,f)})}};return H(null,{_createFilterQuerier:function(l){function k(f){var e=f.type;f=f.args;var h=a._getFilterComparator(e);if(h){var c=f[0],g=n(c,b),p=f[1];p&&p.fetchSync&&(p=p.fetchSync());return function(y){return h.call(a,g(y),p,y,c)}}switch(e){case "and":case "or":for(var q=0,u=f.length;q<u;q++){var v=k(f[q]);var t=t?function(y,C){return"and"===e?function(B){return y(B)&&C(B)}:function(B){return y(B)||C(B)}}(t,v):v}return t;case "function":return f[0];case "string":t=
a[f[0]];if(!t)throw Error("No filter function "+f[0]+" was found in the collection");return t;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+e+'"');}}var b=this.queryAccessors,a=this,d=k(l);return function(f){return m.filter(f,d)}},_getFilterComparator:function(l){return r[l]||this.inherited(arguments)},_createSelectQuerier:function(l){return function(k){var b=l.length;return m.map(k,l instanceof Array?function(a){for(var d={},f=0;f<b;f++){var e=l[f];d[e]=
a[e]}return d}:function(a){return a[l]})}},_createSortQuerier:function(l){var k=this.queryAccessors;return function(b){b=b.slice();"function"===typeof l?b.sort(l):l&&l.length&&b.sort(function(a,d){for(var f=0;f<l.length;f++){var e=l[f];if("function"==typeof e)var h=e(a,d);else{h=e.get||(e.get=n(e.property,k));e=e.descending;var c=h(a);h=h(d);null!=c&&(c=c.valueOf());null!=h&&(h=h.valueOf());h=c===h?0:!!e===("undefined"===typeof h||null===h&&"undefined"!==typeof c||null!=c&&c<h)?1:-1}if(0!==h)return h}return 0});
return b}}})})},"dstore/Trackable":function(){define("dojo/_base/lang dojo/_base/declare dojo/aspect dojo/when dojo/promise/all dojo/_base/array dojo/on".split(" "),function(H,m,n,r,l,k,b){function a(e,h,c){for(var g=e.length-1;0<=g;--g){var p=e[g],q=p.start;p=q+p.count;if(h>p){e.splice(g+1,0,{start:h,count:c-h});return}c>=q&&(h=Math.min(h,q),c=Math.max(c,p),e.splice(g,1))}e.unshift({start:h,count:c-h})}var d=0,f={track:function(){function e(){return function(){var B=this,F=this.inherited(arguments);
r(F,function(x){x=B._results=x.slice();B._partialResults&&(B._partialResults=null);B._ranges=[];a(B._ranges,0,x.length)});return F}}function h(){return function(B){var F=this,x=B.start,w=B.end,A=this.inherited(arguments);this._results||r(A,function(z){return r(z.totalLength,function(G){var J=F._partialResults||(F._partialResults=[]);w=Math.min(w,x+z.length);J.length=G;G=[x,w-x].concat(z);J.splice.apply(J,G);a(F._ranges,x,w);return z})});return A}}function c(B,F){d++;var x=F.target;F=H.delegate(F,
y[B]);var w=F.beforeId;r(v._results||v._partialResults,function(A){if(A){var z,G,J=v._ranges,L="id"in F?F.id:g.getIdentity(x),R=-1,T=-1,aa=-1,ca=-1;if("delete"===B||"update"===B)for(z=0;-1===R&&z<J.length;++z){var ba=J[z];var la=ba.start;for(G=la+ba.count;la<G;++la)if(g.getIdentity(A[la])==L){R=F.previousIndex=la;T=z;var oa=w==L;A.splice(R,1);ba.count--;for(la=z+1;la<J.length;++la)J[la].start--;break}}if("add"===B||"update"===B){if(t){if(t([x]).length){var fa=0;G=J.length-1;for(oa=-1;fa<=G&&-1===
aa;)z=fa+Math.round((G-fa)/2),ba=J[z],T=A.slice(ba.start,ba.start+ba.count),void 0!==w&&(oa=null===w?T.length:C(T,w)),-1===oa&&(oa=R>=Math.max(0,ba.start-1)&&R<=ba.start+ba.count?R:g.defaultNewToStart?0:T.length),T.splice(oa,0,x),la=k.indexOf(t(T),x),L=ba.start+la,0===la&&0!==ba.start?G=z-1:la>=T.length-1&&L<A.length?fa=z+1:(aa=L,ca=z);if(-1===aa&&0<fa&&fa<J.length)var M=!0}}else{la=-1;if(void 0===w||oa)"update"===B?(aa=R,ca=T):g.defaultNewToStart?la=aa=0:(aa=A.length,la=J.length-1);else if(null===
w)aa=A.length,la=J.length-1;else for(z=0,G=J.length;-1===ca&&z<G;++z)ba=J[z],aa=C(A,w,ba.start,ba.start+ba.count),-1!==aa&&(ca=z);-1!==la&&-1===ca&&(ba=J[la])&&ba.start<=aa&&aa<=ba.start+ba.count&&(ca=la)}if(-1<aa&&-1<ca)for(F.index=aa,A.splice(aa,0,x),J[ca].count++,z=ca+1;z<J.length;++z)J[z].start++;else if(M)for(F.beforeIndex=J[fa].start,z=fa;z<J.length;++z)J[z].start++}F.totalLength=A.length}(A=v["on_tracked"+B])&&A.call(v,F)})}var g=this.store||this,p=[],q={add:1,update:1,"delete":1},u;for(u in q)p.push(this.on(u,
function(B){return function(F){c(B,F)}}(u)));var v=m.safeMixin(H.delegate(this),{_ranges:[],fetch:e(),fetchRange:h(),releaseRange:function(B,F){if(this._partialResults){a:for(var x=this._ranges,w=0,A;A=x[w];++w){var z=A.start,G=z+A.count;if(B<=z)if(F>=G)x.splice(w,1);else{A.start=F;A.count=G-A.start;break a}else if(B<G)if(F>z){x.splice(w,1,{start:z,count:B-z},{start:F,count:G-F});break a}else A.count=B-A.start}for(;B<F;++B)delete this._partialResults[B]}},on:function(B,F){var x=this,w=this.getInherited(arguments);
return b.parse(v,B,F,function(A,z){return z in q?n.after(v,"on_tracked"+z,F,!0):w.call(x,z,F)})},tracking:{remove:function(){for(;0<p.length;)p.pop().remove();this.remove=function(){}}},track:null});this.fetchSync&&(m.safeMixin(v,{fetchSync:e(),fetchRangeSync:h()}),v.fetchSync());var t;k.forEach(this.queryLog,function(B){var F=t,x=B.querier;x&&(t=F?function(w){return x(F(w))}:x)});var y={add:{index:void 0},update:{previousIndex:void 0,index:void 0},"delete":{previousIndex:void 0}},C=function(B,F,
x,w){w=void 0!==w?w:B.length;for(x=void 0!==x?x:0;x<w;++x)if(g.getIdentity(B[x])===F)return x;return-1};return v}};l=m(null,f);l.create=function(e,h){e=m.safeMixin(H.delegate(e),f);m.safeMixin(e,h);return e};return l})},"dstore/Tree":function(){define(["dojo/_base/declare"],function(H){return H(null,{constructor:function(){this.root=this},mayHaveChildren:function(m){return"hasChildren"in m?m.hasChildren:!0},getRootCollection:function(){return this.root.filter({parent:null})},getChildren:function(m){return this.root.filter({parent:this.getIdentity(m)})}})})},
"esri/dijit/analysis/SpatialReferences":function(){define(["dojo/_base/lang","dojo/has","../../kernel"],function(H,m,n){for(var r=[{name:"Spatial References"},{name:"PCS",parent:"Spatial References"},{name:"UTM",parent:"PCS"},{name:"World",parent:"PCS"},{name:"Continental",parent:"World"},{name:"Sinusoidal",type:"PCS",sRef:{wkid:54008},parent:"World"},{name:"Winkel Tripel (NGS version)",type:"PCS",sRef:{wkid:54042},parent:"World"},{name:"NAD 1983 Contiguous USA Albers",type:"PCS",sRef:{wkid:5070},
parent:"Continental"},{name:"GDA 1994 Australia Albers",type:"PCS",sRef:{wkid:3577},parent:"Continental"},{name:"ETRS 1989 Lambert Azimuthal Equal Area Coord Ref Sys",type:"PCS",sRef:{wkid:3035},parent:"Continental"},{name:"ETRS 1989 Lambert Conformal Conic Coord Ref Sys",type:"PCS",sRef:{wkid:3034},parent:"Continental"},{name:"NAD 1983 Albers Canada",type:"PCS",sRef:{wkid:102001},parent:"Continental"},{name:"NAD 1983 Lambert Canada",type:"PCS",sRef:{wkid:102002},parent:"Continental"},{name:"NAD 1983 Lambert contiguous USA",
type:"PCS",sRef:{wkid:102004},parent:"Continental"},{name:"NAD 1983 Albers Alaska",type:"PCS",sRef:{wkid:3338},parent:"Continental"},{name:"NAD 1983 Albers Hawaii",type:"PCS",sRef:{wkid:102007},parent:"Continental"},{name:"NAD 1983 Albers North America",type:"PCS",sRef:{wkid:102008},parent:"Continental"},{name:"NAD 1983 Lambert North America",type:"PCS",sRef:{wkid:102009},parent:"Continental"},{name:"WGS 1984 Sinusoidal Africa",type:"PCS",sRef:{wkid:102011},parent:"Continental"},{name:"WGS 1984 Lambert Asia",
type:"PCS",sRef:{wkid:102012},parent:"Continental"},{name:"SAD 1969 Lambert South America",type:"PCS",sRef:{wkid:102015},parent:"Continental"},{name:"WGS 1984 Lambert Azimuthal EqArea North Pole",type:"PCS",sRef:{wkid:102017},parent:"Continental"},{name:"WGS 1984 Stereographic North Pole",type:"PCS",sRef:{wkid:102018},parent:"Continental"},{name:"WGS 1984 Lambert Azimuthal EqArea South Pole",type:"PCS",sRef:{wkid:102020},parent:"Continental"},{name:"WGS 1984 Stereographic South Pole",type:"PCS",sRef:{wkid:102021},
parent:"Continental"},{name:"WGS 1984 Lambert for Africa",type:"PCS",sRef:{wkid:102024},parent:"Continental"},{name:"WGS 1984 Albers for Northern Asia",type:"PCS",sRef:{wkid:102025},parent:"Continental"},{name:"WGS 1984 Lambert for Northern Asia",type:"PCS",sRef:{wkid:102027},parent:"Continental"},{name:"WGS 1984 Albers for Southern Asia",type:"PCS",sRef:{wkid:102028},parent:"Continental"},{name:"WGS 1984 Lambert for Southern Asia",type:"PCS",sRef:{wkid:102030},parent:"Continental"},{name:"SAD 1969 Albers South America",
type:"PCS",sRef:{wkid:102033},parent:"Continental"},{name:"NAD 1983 USGS Contiguous USA Albers",type:"PCS",sRef:{wkid:102039},parent:"Continental"},{name:"WGS 1984 UTM Zone 1N",type:"PCS",sRef:{wkid:32601},parent:"UTM"},{name:"WGS 1984 UTM Zone 2N",type:"PCS",sRef:{wkid:32602},parent:"UTM"},{name:"WGS 1984 UTM Zone 3N",type:"PCS",sRef:{wkid:32603},parent:"UTM"},{name:"WGS 1984 UTM Zone 4N",type:"PCS",sRef:{wkid:32604},parent:"UTM"},{name:"WGS 1984 UTM Zone 5N",type:"PCS",sRef:{wkid:32605},parent:"UTM"},
{name:"WGS 1984 UTM Zone 6N",type:"PCS",sRef:{wkid:32606},parent:"UTM"},{name:"WGS 1984 UTM Zone 7N",type:"PCS",sRef:{wkid:32607},parent:"UTM"},{name:"WGS 1984 UTM Zone 8N",type:"PCS",sRef:{wkid:32608},parent:"UTM"},{name:"WGS 1984 UTM Zone 9N",type:"PCS",sRef:{wkid:32609},parent:"UTM"},{name:"WGS 1984 UTM Zone 10N",type:"PCS",sRef:{wkid:32610},parent:"UTM"},{name:"WGS 1984 UTM Zone 11N",type:"PCS",sRef:{wkid:32611},parent:"UTM"},{name:"WGS 1984 UTM Zone 12N",type:"PCS",sRef:{wkid:32612},parent:"UTM"},
{name:"WGS 1984 UTM Zone 13N",type:"PCS",sRef:{wkid:32613},parent:"UTM"},{name:"WGS 1984 UTM Zone 14N",type:"PCS",sRef:{wkid:32614},parent:"UTM"},{name:"WGS 1984 UTM Zone 15N",type:"PCS",sRef:{wkid:32615},parent:"UTM"},{name:"WGS 1984 UTM Zone 16N",type:"PCS",sRef:{wkid:32616},parent:"UTM"},{name:"WGS 1984 UTM Zone 17N",type:"PCS",sRef:{wkid:32617},parent:"UTM"},{name:"WGS 1984 UTM Zone 18N",type:"PCS",sRef:{wkid:32618},parent:"UTM"},{name:"WGS 1984 UTM Zone 19N",type:"PCS",sRef:{wkid:32619},parent:"UTM"},
{name:"WGS 1984 UTM Zone 20N",type:"PCS",sRef:{wkid:32620},parent:"UTM"},{name:"WGS 1984 UTM Zone 21N",type:"PCS",sRef:{wkid:32621},parent:"UTM"},{name:"WGS 1984 UTM Zone 22N",type:"PCS",sRef:{wkid:32622},parent:"UTM"},{name:"WGS 1984 UTM Zone 23N",type:"PCS",sRef:{wkid:32623},parent:"UTM"},{name:"WGS 1984 UTM Zone 24N",type:"PCS",sRef:{wkid:32624},parent:"UTM"},{name:"WGS 1984 UTM Zone 25N",type:"PCS",sRef:{wkid:32625},parent:"UTM"},{name:"WGS 1984 UTM Zone 26N",type:"PCS",sRef:{wkid:32626},parent:"UTM"},
{name:"WGS 1984 UTM Zone 27N",type:"PCS",sRef:{wkid:32627},parent:"UTM"},{name:"WGS 1984 UTM Zone 28N",type:"PCS",sRef:{wkid:32628},parent:"UTM"},{name:"WGS 1984 UTM Zone 29N",type:"PCS",sRef:{wkid:32629},parent:"UTM"},{name:"WGS 1984 UTM Zone 30N",type:"PCS",sRef:{wkid:32630},parent:"UTM"},{name:"WGS 1984 UTM Zone 31N",type:"PCS",sRef:{wkid:32631},parent:"UTM"},{name:"WGS 1984 UTM Zone 32N",type:"PCS",sRef:{wkid:32632},parent:"UTM"},{name:"WGS 1984 UTM Zone 33N",type:"PCS",sRef:{wkid:32633},parent:"UTM"},
{name:"WGS 1984 UTM Zone 34N",type:"PCS",sRef:{wkid:32634},parent:"UTM"},{name:"WGS 1984 UTM Zone 35N",type:"PCS",sRef:{wkid:32635},parent:"UTM"},{name:"WGS 1984 UTM Zone 36N",type:"PCS",sRef:{wkid:32636},parent:"UTM"},{name:"WGS 1984 UTM Zone 37N",type:"PCS",sRef:{wkid:32637},parent:"UTM"},{name:"WGS 1984 UTM Zone 38N",type:"PCS",sRef:{wkid:32638},parent:"UTM"},{name:"WGS 1984 UTM Zone 39N",type:"PCS",sRef:{wkid:32639},parent:"UTM"},{name:"WGS 1984 UTM Zone 40N",type:"PCS",sRef:{wkid:32640},parent:"UTM"},
{name:"WGS 1984 UTM Zone 41N",type:"PCS",sRef:{wkid:32641},parent:"UTM"},{name:"WGS 1984 UTM Zone 42N",type:"PCS",sRef:{wkid:32642},parent:"UTM"},{name:"WGS 1984 UTM Zone 43N",type:"PCS",sRef:{wkid:32643},parent:"UTM"},{name:"WGS 1984 UTM Zone 44N",type:"PCS",sRef:{wkid:32644},parent:"UTM"},{name:"WGS 1984 UTM Zone 45N",type:"PCS",sRef:{wkid:32645},parent:"UTM"},{name:"WGS 1984 UTM Zone 46N",type:"PCS",sRef:{wkid:32646},parent:"UTM"},{name:"WGS 1984 UTM Zone 47N",type:"PCS",sRef:{wkid:32647},parent:"UTM"},
{name:"WGS 1984 UTM Zone 48N",type:"PCS",sRef:{wkid:32648},parent:"UTM"},{name:"WGS 1984 UTM Zone 49N",type:"PCS",sRef:{wkid:32649},parent:"UTM"},{name:"WGS 1984 UTM Zone 50N",type:"PCS",sRef:{wkid:32650},parent:"UTM"},{name:"WGS 1984 UTM Zone 51N",type:"PCS",sRef:{wkid:32651},parent:"UTM"},{name:"WGS 1984 UTM Zone 52N",type:"PCS",sRef:{wkid:32652},parent:"UTM"},{name:"WGS 1984 UTM Zone 53N",type:"PCS",sRef:{wkid:32653},parent:"UTM"},{name:"WGS 1984 UTM Zone 54N",type:"PCS",sRef:{wkid:32654},parent:"UTM"},
{name:"WGS 1984 UTM Zone 55N",type:"PCS",sRef:{wkid:32655},parent:"UTM"},{name:"WGS 1984 UTM Zone 56N",type:"PCS",sRef:{wkid:32656},parent:"UTM"},{name:"WGS 1984 UTM Zone 57N",type:"PCS",sRef:{wkid:32657},parent:"UTM"},{name:"WGS 1984 UTM Zone 58N",type:"PCS",sRef:{wkid:32658},parent:"UTM"},{name:"WGS 1984 UTM Zone 59N",type:"PCS",sRef:{wkid:32659},parent:"UTM"},{name:"WGS 1984 UTM Zone 60N",type:"PCS",sRef:{wkid:32660},parent:"UTM"}],l=0;l<r.length;++l)r[l].hasChildren=void 0===r[l].type;r={identifier:"name",
items:r};m("extend-esri")&&H.setObject("dijit.analysis.SpatialReferences",r,n);return r})},"esri/dijit/analysis/JobsViewModel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/json dojo/Stateful dojo/topic ./utils ./storageUtils ../../kernel ../../lang".split(" "),function(H,m,n,r,l,k,b,a,d,f,e){H=H([k],{declaredClass:"esri.dijit.analysis.JobsViewModel",constructor:function(h){this.watch("item",m.hitch(this,this.fetchJobs))},_portalUrlSetter:function(h){this.portalUrl=
h},_itemSetter:function(h){this.item=h},_jobsSetter:function(h){this.jobs=h},_currentJobSetter:function(h){h&&h.jobParams&&a.jobParamsToWidgetProps(h).then(m.hitch(this,function(c){this.currentJob=c;b.publish("analysis/jobs/selectedjob",this.currentJob,this.item)}))},fetchJobs:function(){this.portalUrl&&this.item&&d.getResourcesInfo(this.item,{portalUrl:this.portalUrl}).then(m.hitch(this,function(h){h=n.filter(h,function(c){return e.isDefined(c.toolName)&&e.isDefined(c.jobInfo)&&e.isDefined(c.jobParams)});
this.set("jobs",h)}),m.hitch(this,function(h){console.log("Error fetching jobs",h)}))}});r("extend-esri")&&m.setObject("dijit.analysis.JobsViewModel",H,f);return H})},"esri/dijit/analysis/JobsList":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/json dojo/date/locale dojo/has dojo/json dojo/on dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/NodeList dojo/NodeList-dom dojo/_base/fx dojo/fx/easing dojo/Evented dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/Button dijit/form/CheckBox dijit/form/Form dijit/form/Select dijit/form/TextBox dijit/form/ToggleButton dijit/form/ValidationTextBox dijit/layout/ContentPane dijit/form/FilteringSelect dijit/Dialog dijit/ConfirmDialog dojox/mvc/at dgrid1/OnDemandGrid dgrid1/Tree dgrid1/Editor dgrid1/Keyboard dgrid1/Selection dgrid1/Selector dgrid1/extensions/ColumnResizer dgrid1/extensions/DijitRegistry ../../kernel ../../lang ./_Widget ./utils ./JobsViewModel dojo/i18n!../../nls/jsapi dojo/text!./templates/JobsList.html".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da,Q,K,E,N,I,O,U,ha,ia,S,W,ka,ja){H=ia.createSubclass([F,x,w,A],{declaredClass:"esri.dijit.analysis.JobsList",templateString:ja,widgetsInTemplate:!0,i18n:null,toolName:"JobsList",helpFileName:"AnalysisEnvironments",viewModelType:W,cssClass:{primaryButton:"btn calcite blue",button:"btn calcite",tableRow:"esriHelpPopup"},constructor:function(ma,ta){this._pbConnects=[];ma.containerNode&&(this.container=ma.containerNode);
this.cssClass=n.mixin({},this.cssClass)},destroy:function(){this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);this.i18n={};n.mixin(this.i18n,ka.common);this._initModelWatchers()},postCreate:function(){this.inherited(arguments);this.buildJobsList()},startup:function(){},buildJobsList:function(){r.forEach(this.viewModel.jobs,function(ma){var ta=p.create("tr",{"class":this.cssClass.tableRow},this._analysisJobTBody),D=p.create("td",{innerHTML:"\x3ca href\x3d'#'\x3e"+
ma.toolName+"\x3c/a\x3e"},ta);p.create("td",{innerHTML:this._formatTimeStamp(ma.timestamp)},ta);e(D,"click",n.hitch(this,this._openTool,ma))},this)},_initModelWatchers:function(){this.own(this.viewModel.watch("jobs",n.hitch(this,this.buildJobsList)))},_openTool:function(ma){this.viewModel.set("currentJob",ma)},_formatTimeStamp:function(ma){return a.format(new Date(ma),{formatLength:"medium"})}});d("extend-esri")&&n.setObject("dijit.analysis.JobsList",H,U);return H})},"esri/dijit/analysis/components/DataStoreSelect":function(){define("../../../kernel ../../../lang ../../../request dijit/_WidgetBase dojox/lang/functional/object dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/has dojo/promise/all dojo/Evented dojo/i18n!../nls/DataStoreSelect".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h){m=k([r,e],{declaredClass:"esri.dijit.analysis.components.DataStoreSelect",geoAnalyticsServer:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n={};b.mixin(this.i18n,h)},buildRendering:function(){this.createElements()},postCreate:function(){this.inherited(arguments);this.buildDataStoreUI()},createElements:function(){this.domNode=a.create("div",{style:"width:100%;height:100%"});this._dsSelect=a.create("select",{"class":"dijit dijitReset dijitInline dijitLeft dijitDownArrowButton esriLeadingMargin1 longInput esriLongLabel dijitSelect dijitValidationTextBox",
onchange:b.hitch(this,this._handleDSSelectChange)},this.domNode)},_handleDSSelectChange:function(c){this.emit("change",{value:this._dsSelect.value})},buildDataStoreUI:function(){if(this.geoAnalyticsServer&&!this.bdfsTemplateOptions){var c=this.geoAnalyticsServer.replace("/System/GeoAnalyticsTools/GPServer","");n({url:c+"/DataStoreCatalogs",content:{f:"json"}}).then(b.hitch(this,function(g){var p=g.services.map(function(q){return q.name});g=p.map(function(q){return n({url:c+"/"+q+"/BigDataCatalogServer",
content:{f:"json"}})});f(g).then(b.hitch(this,function(q){var u=[];q.filter(function(t,y){t.name=p[y];return void 0!==t.outputTemplates}).forEach(function(t){t.outputTemplates.forEach(function(y){u.push({label:t.name.replace("DataStoreCatalogs/bigDataFileShares_","")+"-"+y.title,innerHTML:t.name.replace("DataStoreCatalogs/bigDataFileShares_","")+"-"+y.title,value:t.name.replace("DataStoreCatalogs/bigDataFileShares_","/bigDataFileShares/")+":"+y.name})})});this.bdfsTemplateOptions=u;q=a.create("optGroup",
{label:this.i18n.agsDataStore});var v=a.create("optGroup",{label:this.i18n.bdfsTemplates});q.appendChild(a.create("option",{label:this.i18n.relationalDS,value:"GDB",innerHTML:this.i18n.relationalDS}));q.appendChild(a.create("option",{label:this.i18n.spatialDS,value:"BDS",innerHTML:this.i18n.spatialDS}));u.forEach(b.hitch(this,function(t){v.appendChild(a.create("option",t))}));this._dsSelect.appendChild(q);this._dsSelect.appendChild(v);l.keys(this._dsSelect.options).some(function(t){return t.label===
this.value},this);this._setCurValue()}))}),b.hitch(this,function(){this._dsSelect.add(a.create("option",{label:this.i18n.relationalDS,value:"GDB",innerHTML:this.i18n.relationalDS}));this._dsSelect.add(a.create("option",{label:this.i18n.spatialDS,value:"BDS",innerHTML:this.i18n.spatialDS}));this._setCurValue()}))}},_setCurValue:function(){l.keys(this._dsSelect.options).some(function(c){return c.label===this.value},this)?this._dsSelect.value=this.value:this._dsSelect.value="BDS"},reset:function(){this._dsSelect.reset()},
_setGeoAnalyticsServerAttr:function(c){this.geoAnalyticsServer=c},_setValueAttr:function(c){this.value=c||"BDS"},_getValueAttr:function(){return this._dsSelect?this._dsSelect.value:null}});d("extend-esri")&&b.setObject("dijit.analysis.components.DataStoreSelect",m,H);return m})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(H,m,n){var r={};m.mixin(n,{keys:function(l){var k=[],b;for(b in l)b in r||k.push(b);return k},values:function(l){var k=
[],b;for(b in l)b in r||k.push(l[b]);return k},filterIn:function(l,k,b){b=b||H.global;k=n.lambda(k);var a={},d;for(d in l)if(!(d in r)){var f=l[d];k.call(b,f,d,l)&&(a[d]=f)}return a},forIn:function(l,k,b){b=b||H.global;k=n.lambda(k);for(var a in l)a in r||k.call(b,l[a],a,l);return b},mapIn:function(l,k,b){b=b||H.global;k=n.lambda(k);var a={},d;for(d in l)d in r||(a[d]=k.call(b,l[d],d,l));return a}});return n})},"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],
function(H,m,n){var r=m.getObject("lang.functional",!0,H),l={},k=1<"ab".split(/a*/).length?String.prototype.split:function(d){var f=this.split.call(this,d);(d=d.exec(this))&&0==d.index&&f.unshift("");return f},b=function(d){var f=[],e=k.call(d,/\s*->\s*/m);if(1<e.length)for(;e.length;)d=e.pop(),f=e.pop().split(/\s*,\s*|\s+/m),e.length&&e.push("(function("+f.join(", ")+"){ return ("+d+"); })");else if(d.match(/\b_\b/))f=["_"];else{e=d.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m);var h=d.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);
if(e||h)e&&(f.push("$1"),d="$1"+d),h&&(f.push("$2"),d+="$2");else{e=d.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[];var c={};n.forEach(e,function(g){c.hasOwnProperty(g)||(f.push(g),
c[g]=1)})}}return{args:f,body:d}},a=function(d){return d.length?function(){var f=d.length-1,e=r.lambda(d[f]).apply(this,arguments);for(--f;0<=f;--f)e=r.lambda(d[f]).call(this,e);return e}:function(f){return f}};m.mixin(r,{rawLambda:function(d){return b(d)},buildLambda:function(d){d=b(d);return"function("+d.args.join(",")+"){return ("+d.body+");}"},lambda:function(d){if("function"==typeof d)return d;if(d instanceof Array)return a(d);if(l.hasOwnProperty(d))return l[d];var f=b(d);return l[d]=new Function(f.args,
"return ("+f.body+");")},clearLambdaCache:function(){l={}}});return r})},"esri/dijit/analysis/mixins/browselayers/BrowseLayerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/query ../../../../kernel ../../../../request ../../../../lang ../../../../layers/CSVLayer ../../../../arcgis/Portal ../../../../SpatialReference ../../ProjectExtent dojo/Deferred ../../ItemTypes ../../utils ./configs/AGOLBrowseItem ./configs/EnterpriseBrowseItem dojo/i18n!../../nls/BrowseLayerMixin".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v){H=H([],{tableSupportedTools:"JoinFeatures SummarizeAttributes ExtractData GeocodeLocationsfromTable CopyToDataStore AppendData CalculateField MergeLayers DescribeDataset DetectIncidents".split(" "),allowedItemTypes:[],defaultItemTypes:[g.MS,g.FS],availableItemTypeFilters:["layers","featureLayers"],_createBrowseItems:function(t,y,C){t=t||{};var B=t.browseValue||{};y=y||{};var F=this.defaultItemTypes.concat(this.get("allowedItemTypes"));if(this.useArcGISComponents)this.setUpItemBrowser(t,
y,C).then(function(){this.map&&this._chopExtentAtDateLine(this.map.extent).then(this._projectExtentAndDispatch.bind(this))}.bind(this));else{var x=[];F.forEach(function(w){x.push('type:"'+w+'"')});"browse"===B?(C=this._browsedlg.browseItems.get("query"),C.custom=this._queryTagsForLivingAtlasBrowseItems(y),this._browsedlg.browseItems.set("extent",this.get("map").extent),this._browsedlg.browseItems.set("query",C),this._browsedlg.show()):(this.showGeoAnalyticsParams&&x.push('type:"'+g.BIGDATA+'"'),C=
this._browseLyrsdlg.browseItems.get("query"),C.types=x,this._browseLyrsdlg.browseItems.set("query",C),y.geometryTypes?(this._browseLyrsdlg.browseItems.plugIn.checkGeometryType=!0,0<y.geometryTypes.length&&(this._browseLyrsdlg.browseItems.plugIn.geometryTypes=y.geometryTypes)):this._browseLyrsdlg.browseItems.plugIn.checkGeometryType=!1,y.layerTypes?(this._browseLyrsdlg.browseItems.plugIn.checkLayerType=!0,0<y.layerTypes.length&&(this._browseLyrsdlg.browseItems.plugIn.layerTypes=y.layerTypes)):this._browseLyrsdlg.browseItems.plugIn.checkLayerType=
!1,y.customCheck?(this._browseLyrsdlg.browseItems.plugIn.customCheckHandler=y.customCheck.customCheckHandler,this._browseLyrsdlg.browseItems.plugIn.customCheckFailureMessage=y.customCheck.customCheckFailureMessage):this._browseLyrsdlg.browseItems.plugIn.customCheckHandler=void 0,this._browseLyrsdlg.show())}},setUpItemBrowser:function(t,y,C){var B=new c;window.require(["arcgis-components/wrappers/ItemBrowser","esri/arcgis/Portal"],function(F,x){if(!this.ib){var w=document.createElement("div");!t.isDialog&&
document.body.appendChild(w);var A=new x.Portal(this.portalSelf&&this.portalSelf.urlKey&&this.portalSelf.customBaseUrl?location.protocol+"//"+this.portalSelf.urlKey+"."+this.portalSelf.customBaseUrl+"/sharing/rest":(this.portalSelf&&this.portalSelf.portalHostname?location.protocol+"//"+this.portalSelf.portalHostname:this.portalUrl)+"/sharing/rest");"ArcGISEnterpriseOnKubernetes"===(this.portalSelf||{}).portalDeploymentType&&(t.disableBoundary=!0,t.disableLAAL=!0);var z=this.defaultItemTypes.concat(this.get("allowedItemTypes")),
G=function(){this._closeFullScreenBrowser();t.isDialog&&this._closeDialog();this._resetSelectBox(C);!t.isDialog&&this._removeDOMfromBody(w)},J=function(ca){this._closeFullScreenBrowser();t.isDialog&&this._closeDialog();ca[0]&&ca[0].type===g.RFT?this.onSelectRFTTool.bind(this)(ca[0],A):ca[0]&&ca[0].type===g.DLPK?this.onSelectDLPKTool.bind(this)(ca[0],A):this.onBrowseItemSelect.bind(this)(ca[0],A,C);!t.isDialog&&this._removeDOMfromBody(w)},L=function(ca){this._closeFullScreenBrowser();t.isDialog&&this._closeDialog();
this.onSelectGPTool.bind(this)(ca);!t.isDialog&&this._removeDOMfromBody(w)},R=function(ca){this._closeFullScreenBrowser();t.isDialog&&this._closeDialog();this.onEditRFTTool.bind(this)(ca,A);!t.isDialog&&this._removeDOMfromBody(w)},T=function(ca){this._closeFullScreenBrowser();t.isDialog&&this._closeDialog();this.onBrowseItemSelect.bind(this)(ca,A,C);!t.isDialog&&this._removeDOMfromBody(w)},aa=function(ca){t.isDialog&&this._closeDialog();ca&&ca.type===g.RFT?this.onEditRFTTool.bind(this)(ca,A):this.onBrowseItemSelect.bind(this)(ca,
A,C,!0);!t.isDialog&&this._removeDOMfromBody(w)};-1<this.tableSupportedTools.indexOf(this.helpFileName)&&(z=z.concat([this.showGeoAnalyticsParams?g.TABLE:g.BTABLE]));A.signIn().then(function(){this._fetchGroupForRFT(A).then(function(ca){-1<z.indexOf(g.IS)?this.availableItemTypeFilters=["layers","featureLayers","mapImageLayers","imageryLayers"]:-1===z.indexOf(g.GPSERVICE)&&-1===z.indexOf(g.RFT)&&-1===z.indexOf(g.FILE)&&(this.availableItemTypeFilters=this.availableItemTypeFilters.concat(["layers","featureLayers"]));
-1<this.tableSupportedTools.indexOf(this.helpFileName)&&(this.availableItemTypeFilters=this.availableItemTypeFilters.concat(["tables"]));ca={allowedItemTypes:this.showGeoAnalyticsParams?[g.BIGDATA].concat(z):z,availableItemTypeFilters:this.showGeoAnalyticsParams?this.availableItemTypeFilters.concat(["bigDataFileShares"]):this.availableItemTypeFilters,customQueryTags:y,addQueryParameters:t.addQueryParameters,portal:A,isPortal:this.isSingleTenant,onSelectSubLayer:T.bind(this),onActionSubLayer:aa.bind(this),
onSelectGPTool:L.bind(this),onEditRFT:R.bind(this),rftGroupId:ca,disableLAAL:t.disableLAAL,disableBoundary:t.disableBoundary,title:t.title,disabledSubResources:this._getDisableResources(t.disabledSubResources),showRFTSystemSection:null!=t.showRFTSystemSection?t.showRFTSystemSection:"raster"===t.analysisMode?!0:!1,showRFTEditCustomAction:null!=t.showRFTEditCustomAction?t.showRFTEditCustomAction:!0,enableMapAreaFilter:null!=t.enableMapAreaFilter?t.enableMapAreaFilter:!0};var ba=m.mixin(F.initialState.settings.config,
this.isSingleTenant?u.getConfig(ca):q.getConfig(ca)),la=m.mixin(F.initialState.parameters,{section:"myContent",filter:m.mixin(F.initialState.parameters.filter,{searchMapArea:!1})});-1<ca.allowedItemTypes.indexOf(g.RFT)&&!this.isSingleTenant&&(ba.addQueryParameters=function(M){return"all"===M.parameters.section?"-owner: (esri_*)":""});if(-1<ca.allowedItemTypes.indexOf(g.RFT)&&ca.showRFTSystemSection){var oa=this.isSingleTenant;la.section="System";la.sort={field:"title",order:"asc"};ba.enableMapAreaFilter=
!1;ba.addQueryParameters=function(M){var X;return!oa&&M.parameters&&"all"===M.parameters.section?"-owner: (esri_*)":M.parameters&&M.parameters.searchString&&M.parameters.searchString.current&&"System"===M.parameters.section?(M=M.parameters.searchString.current,-1===M.indexOf(":")&&(X="tags: ("+M+")"),X?X:""):""};var fa;n.some(ba.customSections,function(M){if("System"===M.name)return fa=M.baseQuery,!0});require(["arcgis-raster-function-editor/RFxRegistry"],function(M){M.initialize({sysRFxBaseQuery:fa,
asRFxEditorBuddy:!1,isMultiTenant:!1===this.isSingleTenant});M=M.createRequestProxy(b);this._originalRequestModule=b;b=M}.bind(this))}this.ib=new F.ItemBrowserWrapper(w,{apiVersion:3,portal:A,request:b,initialState:m.mixin(F.initialState,{settings:m.mixin(F.initialState.settings,{config:m.mixin(ba,{onBack:G.bind(this),onSelect:J.bind(this)})}),ui:m.mixin(F.initialState.ui,{expanded:m.mixin(F.initialState.ui.expanded,{filters:!0})})}),parameters:la});t.isDialog&&this._createDialog(w,A);B.resolve()}.bind(this))}.bind(this))}}.bind(this));
return B},_queryTagsForLivingAtlasBrowseItems:function(t){if((t=t&&t.tags)&&0!==t.length){if(1===t.length)return['tags:"'+t[0]+'"'];l=[];t.forEach(function(y){l.push('tags:"'+y+'"')});return l}},onBrowseItemSelect:function(t,y,C,B){y=this._getPortalItem(t,y);var F={selection:y,dialog:this._browseLyrsdlg||this._browsedlg};!t.url||p.isHostedService(t.url)||this.isSingleTenant||y.selectedLayer instanceof d?this._handleBrowseItemsSelect(F,B):this._getProxyServiceInfo(t).then(function(){a.isDefined(t.analysisProxyCheck)&&
"failure"===t.analysisProxyCheck?this._resetSelectBox(C):this._handleBrowseItemsSelect(F,B)}.bind(this),function(){this._resetSelectBox(C)}.bind(this))},onSelectGPTool:function(t){t.resource.url=t.url;this._handleSelectGpTool(t.resource)},onSelectRFTTool:function(t,y){this._handleSelectRFTTool(this._getPortalItem(t,y))},onSelectDLPKTool:function(t,y){this._handleSelectDLPKTool(this._getPortalItem(t,y))},onEditRFTTool:function(t,y){this._handleEditRFTTool(this._getPortalItem(t,y))},_getPortalItem:function(t,
y){t.resource&&t.item?(y=new f.PortalItem(m.mixin(t.item,{portal:y})),y.selectedLayer=t.resource,y.selectedLayer.url=t.url):(y=new f.PortalItem(m.mixin(t,{portal:y})),t.type&&-1<[g.CSV,g.XLS].indexOf(t.type)&&(y.selectedLayer=y));return y},_createDialog:function(t,y){window.require(["dijit/Dialog","esri/dijit/analysis/mixins/browselayers/configs/Common"],function(C,B){this.itemBrowserDialog||(this.itemBrowserDialog=new C({style:"width: 900px; height:900px; overflow: auto",id:"itemBrowserDialog",closable:!1,
title:v.customAnalysisLayerTitle}));this.itemBrowserDialog.set("content",t);this.itemBrowserDialog.show()}.bind(this))},_closeDialog:function(){this.itemBrowserDialog.hide();this.itemBrowserDialog.destroy();delete this.itemBrowserDialog;delete this.ib},_closeFullScreenBrowser:function(){this._originalRequestModule&&(b=this._originalRequestModule);this.ib.dispatch({type:"CLOSE_FULLSCREEN_BROWSER"})},_setAllowedItemTypesAttr:function(t){this.allowedItemTypes=t},_setAvailableItemTypeFiltersAttr:function(t){this.availableItemTypeFilters=
t},_getDisableResources:function(t){var y={};t&&t.length&&t.forEach(function(C){C&&C.url&&(y[C.url]=!0)},this);return y},_projectExtentAndDispatch:function(t){this.sr||(this.sr=new e(4326));h(t,this.sr,function(y){this._dispatchExtentToItemBrowser(y[0])}.bind(this),function(y){console.error(y)}.bind(this))},_chopExtentAtDateLine:function(t){var y=new c;window.esri.geometry.normalizeCentralMeridian([t],null,function(C){if(C[0].rings){var B=(new window.esri.geometry.Polygon(t.spatialReference)).addRing(C[0].rings[0]).getExtent();
C=(new window.esri.geometry.Polygon(t.spatialReference)).addRing(C[0].rings[1]).getExtent();y.resolve(B.getWidth()>C.getWidth()?B:C)}else y.resolve(C[0])},function(C){y.reject(C)});return y},_dispatchExtentToItemBrowser:function(t){window.require(["arcgis-components/wrappers/ItemBrowser"],function(y){this.ib.dispatch(y.updateExtent({minx:t.xmin,miny:t.ymin,maxx:t.xmax,maxy:t.ymax}))}.bind(this))},_fetchGroupForRFT:function(t){var y=new c;-1===this.allowedItemTypes.indexOf(g.RFT)&&y.resolve();this._systemRFTsGroup&&
y.resolve(this._systemRFTsGroup);p.fetchGroupForRFT(t).then(function(C){this._systemRFTsGroup=C;y.resolve(C)}.bind(this));return y},_removeDOMfromBody:function(t){setTimeout(function(){document.body.removeChild(t)},300);delete this.ib},_resetSelectBox:function(t){t&&t.reset()},_getProxyServiceInfo:function(t){var y=new c,C;a.isDefined(t)&&a.isDefined(t.url)||y.reject({error:"mapLayer is not defined"});var B=t.url+(-1<t.url.indexOf("?")?"\x26":"?")+"f\x3djson";var F=k.id.findCredential(t.url);var x=
t.url;this.proxyCheckedServers||(this.proxyCheckedServers=[]);n.some(this.proxyCheckedServers,function(w){C=x.substring(0,x.indexOf("/",9));if(w.server===C)return t.analysisProxyCheck=w.check,!0},this)?y.resolve({}):(F&&F.token&&(B+="\x26token\x3d"+F.token),y=b({url:B,content:null},{useProxy:!0}),y.then(function(){t.analysisProxyCheck="success";this.proxyCheckedServers.push({server:x.substring(0,x.indexOf("/",9)),check:"success"})}.bind(this),function(){t.analysisProxyCheck="failure";this.proxyCheckedServers.push({server:x.substring(0,
x.indexOf("/",9)),check:"failure"})}.bind(this)));return y.promise}});r("extend-esri")&&m.setObject("dijit.analysis.mixins.browselayers.BrowseLayerMixin",H,k);return H})},"esri/layers/CSVLayer":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../arcgis/csv ./FeatureLayer ../geometry/Extent ../tasks/FeatureSet".split(" "),function(H,m,n,r,l,k,b,a,d){m=m(b,{declaredClass:"esri.layers.CSVLayer",_preventInit:!0,_fieldTypeMap:{Date:"esriFieldTypeDate",Number:"esriFieldTypeDouble",
String:"esriFieldTypeString"},constructor:function(f,e){this.url=f;e=n.mixin({},e);this.columnDelimiter=e.columnDelimiter;this.latitudeFieldName=e.latitudeFieldName;this.longitudeFieldName=e.longitudeFieldName;f=e.layerDefinition;f||(f={fields:e.fields||[],geometryType:"esriGeometryPoint",copyrightText:e.copyright},e.fields&&H.forEach(e.fields,function(h){h.type=this._fieldTypeMap[h.type||"String"];h.alias||(h.alias=h.name)},this));this._buildCsvFcParam={url:this.url,columnDelimiter:this.columnDelimiter,
layerDefinition:f,outFields:e.outFields};this.latitudeFieldName&&this.longitudeFieldName&&(this._buildCsvFcParam.locationInfo={locationType:"coordinates",latitudeFieldName:this.latitudeFieldName,longitudeFieldName:this.longitudeFieldName});this._projectFeatures=n.hitch(this,this._projectFeatures);this._addFeatures=n.hitch(this,this._addFeatures);this._initCSVLayer(e)},refresh:function(){this._fireUpdateStart();this.applyEdits(null,null,this.graphics);this._loadFeatures()},_isWebGLCompatible:function(){return!1},
_setMap:function(f){var e=this.inherited(arguments);this._fireUpdateStart();this._projectFeatures(this._csvFC).then(this._addFeatures).otherwise(this._errorHandler);this._csvFC=null;return e},_initCSVLayer:function(f){var e=this;k.buildCSVFeatureCollection(this._buildCsvFcParam).then(function(h){!e._buildCsvFcParam.locationInfo||e.latitudeFieldName&&e.longitudeFieldName||(e.latitudeFieldName=e._buildCsvFcParam.locationInfo.latitudeFieldName,e.longitudeFieldName=e._buildCsvFcParam.locationInfo.longitudeFieldName);
e._csvFC=h;var c=h.layerDefinition;c.extent=e._getFCExtent(h);f.outFields||(f.outFields=["*"]);f.timeInfo&&(c.timeInfo=f.timeInfo);e._initFeatureLayer({layerDefinition:c},f)}).otherwise(this._errorHandler)},_loadFeatures:function(){k.buildCSVFeatureCollection(this._buildCsvFcParam).then(this._projectFeatures).then(this._addFeatures).otherwise(this._errorHandler)},_projectFeatures:function(f){return k.projectFeatureCollection(f,this._map.spatialReference)},_addFeatures:function(f){f=new d(f.featureSet);
this.applyEdits(f.features,null,null);this._fireUpdateEnd()},_getFCExtent:function(f){if(f&&f.featureSet&&f.featureSet.features){f=f.featureSet.features;var e=f.length;if(1<e){var h=f[0].geometry;var c=new a(h.x,h.y,h.x,h.y);for(--e;0<e;e--)h=f[e].geometry,c.xmin=Math.min(c.xmin,h.x),c.ymin=Math.min(c.ymin,h.y),c.xmax=Math.max(c.xmax,h.x),c.ymax=Math.max(c.ymax,h.y);0>=c.getWidth()&&0>=c.getHeight()&&(c=null)}}return c}});r("extend-esri")&&n.setObject("layers.CSVLayer",m,l);return m})},"esri/arcgis/csv":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/sniff dojo/number dojox/data/CsvStore ../kernel ../config ../request ../SpatialReference ../geometry/jsonUtils ../geometry/webMercatorUtils".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h){function c(B){var F=0,x="";m.forEach([","," ",";","|","\t"],function(w){var A=B.split(w).length;A>F&&(F=A,x=w)});return x}function g(B,F){if(!B||"[object Date]"!==Object.prototype.toString.call(B)||isNaN(B.getTime()))return!1;B=!0;if(r("chrome")&&/\d+\W*$/.test(F)){if(F.match(/[^0-9a-zA-Z\s]/))return!1;if(F=F.match(/[a-zA-Z]{2,}/)){B=!1;for(var x=0,w=F.length,A=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i;!B&&
x<=w&&!(B=!A.test(F[x]));)x++;B=!B}}return B}function p(B,F,x){var w=B.indexOf("\n");w=H.trim(B.substr(0,w));var A=F.columnDelimiter;A||(A=c(w));var z=new k({data:B,separator:A});z.fetch({onComplete:function(G,J){J=0;var L={layerDefinition:F.layerDefinition,featureSet:{features:[],geometryType:"esriGeometryPoint"}},R=L.layerDefinition.objectIdField,T=L.layerDefinition.fields;R||m.some(T,function(E){return"esriFieldTypeOID"===E.type?(R=E.name,!0):!1})||(T.push({name:"__OBJECTID",alias:"__OBJECTID",
type:"esriFieldTypeOID",editable:!1}),R="__OBJECTID");var aa=z._attributes,ca=[],ba=[];m.forEach(T,function(E){"esriFieldTypeDate"===E.type?ca.push(E.name):("esriFieldTypeDouble"===E.type||"esriFieldTypeInteger"===E.type)&&ba.push(E.name)});if(F.locationInfo&&"coordinates"===F.locationInfo.locationType){var la=F.locationInfo.latitudeFieldName;var oa=F.locationInfo.longitudeFieldName}else m.forEach(aa,function(E){var N=m.indexOf(t,E.toLowerCase());-1!==N&&(la=E);N=m.indexOf(y,E.toLowerCase());-1!==
N&&(oa=E)}),la&&oa&&(F.locationInfo={locationType:"coordinates",latitudeFieldName:la,longitudeFieldName:oa});if(la&&oa){-1===m.indexOf(ba,la)&&ba.push(la);-1===m.indexOf(ba,oa)&&ba.push(oa);if(H.isArray(F.outFields)&&-1===m.indexOf(F.outFields,"*"))var fa=F.outFields;m.forEach(aa,function(E){m.some(T,function(N){return E===N.name})||T.push({name:E,alias:E,type:E===la||E===oa?"esriFieldTypeDouble":"esriFieldTypeString"})});aa=0;var M=G.length;for(aa;aa<M;aa++){var X=G[aa],da=z.getAttributes(X),Q={};
m.forEach(da,function(E){if(E&&(E===la||E===oa||!fa||-1<m.indexOf(fa,E))){var N=E;0===E.length&&m.forEach(T,function(O,U){O.name==="attribute_"+(U-1)&&(E="attribute_"+(U-1))});if(-1<m.indexOf(ca,E)){N=z.getValue(X,N);var I=new Date(N);Q[E]=g(I,N)?I.getTime():null}else-1<m.indexOf(ba,E)?(I=l.parse(z.getValue(X,N)),E!==la&&E!==oa||!(isNaN(I)||181<Math.abs(I))||(I=parseFloat(z.getValue(X,N))),isNaN(I)?Q[E]=null:Q[E]=I):Q[E]=z.getValue(X,N)}});Q[R]=J;J++;da=Q[la];var K=Q[oa];null==K||null==da||isNaN(da)||
isNaN(K)||(fa&&-1===m.indexOf(fa,la)&&delete Q[la],fa&&-1===m.indexOf(fa,oa)&&delete Q[oa],L.featureSet.features.push({geometry:{x:K,y:da,spatialReference:{wkid:4326}},attributes:Q}))}L.layerDefinition.name="csv";x&&x(L)}else setTimeout(function(){console.error("File does not seem to contain fields with point coordinates.")},1),x&&x(null,Error("File does not seem to contain fields with point coordinates."))},onError:function(G){console.error("Error fetching items from CSV store: ",G);x&&x(null,G)}});
return!0}function q(B,F,x,w,A,z){0===B.length&&A(null);var G=e.getGeometryType(F),J=[];m.forEach(B,function(L){L=new G(L);L.spatialReference=x;J.push(L)},this);F=[102113,102100,3857];x.wkid&&4326===x.wkid&&w.wkid&&-1<m.indexOf(F,w.wkid)?(m.forEach(J,function(L){L.xmin?(L.xmin=Math.max(L.xmin,-180),L.xmax=Math.min(L.xmax,180),L.ymin=Math.max(L.ymin,-89.99),L.ymax=Math.min(L.ymax,89.99)):L.rings?m.forEach(L.rings,function(R){m.forEach(R,function(T){T[0]=Math.min(Math.max(T[0],-180),180);T[1]=Math.min(Math.max(T[1],
-89.99),89.99)},this)},this):L.paths?m.forEach(L.paths,function(R){m.forEach(R,function(T){T[0]=Math.min(Math.max(T[0],-180),180);T[1]=Math.min(Math.max(T[1],-89.99),89.99)},this)},this):L.x&&(L.x=Math.min(Math.max(L.x,-180),180),L.y=Math.min(Math.max(L.y,-89.99),89.99))},this),B=[],m.forEach(J,function(L){L=h.geographicToWebMercator(L);102100!==w.wkid&&(L.spatialReference=w);B.push(L.toJson())},this),A(B)):null!==x.wkid&&-1<m.indexOf(F,x.wkid)&&null!==w.wkid&&4326===w.wkid?(B=[],m.forEach(J,function(L){B.push(h.webMercatorToGeographic(L).toJson())},
this),A(B)):(F=function(L,R){L&&L.length===B.length?(B=[],m.forEach(L,function(T){T&&(T.rings&&0<T.rings.length&&0<T.rings[0].length&&0<T.rings[0][0].length&&!isNaN(T.rings[0][0][0])&&!isNaN(T.rings[0][0][1])||T.paths&&0<T.paths.length&&0<T.paths[0].length&&0<T.paths[0][0].length&&!isNaN(T.paths[0][0][0])&&!isNaN(T.paths[0][0][1])||T.xmin&&!isNaN(T.xmin)&&T.ymin&&!isNaN(T.ymin)||T.x&&!isNaN(T.x)&&T.y&&!isNaN(T.y))?B.push(T.toJson()):B.push(null)},this),A(B)):z(L,R)},a.defaults.geometryService?a.defaults.geometryService.project(J,
w,H.hitch(this,F),z):A(null))}function u(B,F){var x=[102113,102100,3857];return B&&F&&B.wkid===F.wkid&&B.wkt===F.wkt||B&&F&&B.wkid&&F.wkid&&-1<m.indexOf(x,B.wkid)&&-1<m.indexOf(x,F.wkid)?!0:!1}function v(B,F,x,w){if(B.featureSet&&0!==B.featureSet.features.length)if(u(x,F))w(B);else{var A=function(L){var R=[];m.forEach(B.featureSet.features,function(T,aa){L[aa]&&(T.geometry=L[aa],R.push(T))},this);w(B)},z=function(L,R){console.error("error projecting featureSet ("+B.layerDefinition.name+"). Final try.");
w(B)},G=function(L,R){console.error("error projecting featureSet ("+B.layerDefinition.name+"). Try one more time.");q(J,B.featureSet.geometryType,F,x,H.hitch(this,A),H.hitch(this,z))};if(B.featureSet.features&&0<B.featureSet.features.length){var J=[];m.forEach(B.featureSet.features,function(L){if(L.geometry.toJson)J.push(L.geometry);else{var R=e.getGeometryType(B.featureSet.geometryType);J.push(new R(L.geometry))}});F.toJson||(F=new f(F));x.toJson||(x=new f(x));q(J,B.featureSet.geometryType,F,x,H.hitch(this,
A),H.hitch(this,G))}else w(B)}}var t="lat latitude y ycenter latitude83 latdecdeg point-y lat_dd".split(" "),y="lon lng long longitude x xcenter longitude83 longdecdeg point-x long_dd".split(" "),C={latFieldStrings:t,longFieldStrings:y,buildCSVFeatureCollection:function(B){var F=new n,x=function(A,z){z?F.errback(z):F.callback(A)},w={url:B.url,handleAs:"text",load:function(A){p(A,B,H.hitch(this,x))},error:function(A){F.errback(A);console.error("error: "+A)}};-1<B.url.indexOf("arcgis.com")&&-1<B.url.indexOf("/content/items")&&
-1<B.url.indexOf("/data")&&(w.headers={"Content-Type":""});d(w,{usePost:!1});return F},projectFeatureCollection:function(B,F,x){var w=new n;x||(x=new f({wkid:4326}));v(B,x,F,H.hitch(this,function(A){w.callback(A)}));return w},generateDefaultPopupInfo:function(B){var F={esriFieldTypeDouble:1,esriFieldTypeSingle:1},x={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},w={esriFieldTypeDate:1},A=null;B=m.map(B.layerDefinition.fields,H.hitch(this,function(z){"NAME"===z.name.toUpperCase()&&(A=z.name);
var G="esriFieldTypeOID"!==z.type&&"esriFieldTypeGlobalID"!==z.type&&"esriFieldTypeGeometry"!==z.type,J=null;if(G){var L=z.name.toLowerCase();if(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+L+",")||-1<L.indexOf("area")||-1<L.indexOf("length")||-1<L.indexOf("shape")||-1<L.indexOf("perimeter")||-1<L.indexOf("objectid")||L.indexOf("_")===L.length-1||L.indexOf("_i")===L.length-2&&1<L.length)G=!1;z.type in x?J={places:0,digitSeparator:!0}:z.type in
F?J={places:2,digitSeparator:!0}:z.type in w&&(J={dateFormat:"shortDateShortTime"})}return H.mixin({},{fieldName:z.name,label:z.alias,isEditable:!0,tooltip:"",visible:G,format:J,stringFieldOption:"textbox"})}));return{title:A?"{"+A+"}":"",fieldInfos:B,description:null,showAttachments:!1,mediaInfos:[]}},_getSeparator:c,_isValidDate:g,_processCsvData:p,_projectGeometries:q,_sameSpatialReference:u,_projectFeatureSet:v};r("extend-esri")&&H.setObject("arcgis.csv",C,b);return C})},"dojox/data/CsvStore":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/xhr dojo/_base/kernel dojo/data/util/filter dojo/data/util/simpleFetch".split(" "),
function(H,m,n,r,l,k){m=m("dojox.data.CsvStore",null,{constructor:function(b){this._attributes=[];this._attributeIndexes={};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=!1;b.url&&(this.url=b.url);this._csvData=b.data;b.label?this.label=b.label:""===this.label&&(this.label=void 0);this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._loadInProgress=!1;this._queuedFetches=[];this.identifier=b.identifier;""===this.identifier?
delete this.identifier:this._idMap={};"separator"in b&&(this.separator=b.separator);"urlPreventCache"in b&&(this.urlPreventCache=b.urlPreventCache?!0:!1)},url:"",label:"",identifier:"",separator:",",urlPreventCache:!1,_assertIsItem:function(b){if(!this.isItem(b))throw Error(this.declaredClass+": a function was passed an item argument that was not an item");},_getIndex:function(b){b=this.getIdentity(b);this.identifier&&(b=this._idMap[b]);return b},getValue:function(b,a,d){this._assertIsItem(b);var f=
d;if("string"===typeof a)a=this._attributeIndexes[a],null!=a&&(f=this._dataArray[this._getIndex(b)][a]||d);else throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");return f},getValues:function(b,a){return(b=this.getValue(b,a))?[b]:[]},getAttributes:function(b){this._assertIsItem(b);var a=[];b=this._dataArray[this._getIndex(b)];for(var d=0;d<b.length;d++)""!==b[d]&&a.push(this._attributes[d]);return a},hasAttribute:function(b,a){this._assertIsItem(b);
if("string"===typeof a)return a=this._attributeIndexes[a],b=this._dataArray[this._getIndex(b)],"undefined"!==typeof a&&a<b.length&&""!==b[a];throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");},containsValue:function(b,a,d){var f=void 0;"string"===typeof d&&(f=l.patternToRegExp(d,!1));return this._containsValue(b,a,d,f)},_containsValue:function(b,a,d,f){b=this.getValues(b,a);for(a=0;a<b.length;++a){var e=b[a];if("string"===typeof e&&f)return null!==
e.match(f);if(d===e)return!0}return!1},isItem:function(b){if(b&&b[this._storeProp]===this)if(b=b[this._idProp],this.identifier){if(this._dataArray[this._idMap[b]])return!0}else if(0<=b&&b<this._dataArray.length)return!0;return!1},isItemLoaded:function(b){return this.isItem(b)},loadItem:function(b){},getFeatures:function(){return this._features},getLabel:function(b){if(this.label&&this.isItem(b))return this.getValue(b,this.label)},getLabelAttributes:function(b){return this.label?[this.label]:null},
_fetchItems:function(b,a,d){var f=this,e=function(p,q){var u=null;if(p.query){var v;u=[];var t=p.queryOptions?p.queryOptions.ignoreCase:!1,y={};for(v in p.query){var C=p.query[v];"string"===typeof C&&(y[v]=l.patternToRegExp(C,t))}for(t=0;t<q.length;++t){var B=!0,F=q[t];for(v in p.query)C=p.query[v],f._containsValue(F,v,C,y[v])||(B=!1);B&&u.push(F)}}else u=q.slice(0,q.length);a(u,p)};if(this._loadFinished)e(b,this._arrayOfAllItems);else if(""!==this.url)if(this._loadInProgress)this._queuedFetches.push({args:b,
filter:e});else{this._loadInProgress=!0;var h=n.get({url:f.url,handleAs:"text",preventCache:f.urlPreventCache});h.addCallback(function(p){try{f._processData(p),e(b,f._arrayOfAllItems),f._handleQueuedFetches()}catch(q){d(q,b)}});h.addErrback(function(p){f._loadInProgress=!1;if(d)d(p,b);else throw p;});var c=null;b.abort&&(c=b.abort);b.abort=function(){var p=h;p&&-1===p.fired&&(p.cancel(),p=null);c&&c.call(b)}}else if(this._csvData)try{this._processData(this._csvData),this._csvData=null,e(b,this._arrayOfAllItems)}catch(p){d(p,
b)}else{var g=Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(d)d(g,b);else throw g;}},close:function(b){},_getArrayOfArraysFromCsvFileContents:function(b){if(H.isString(b)){var a=RegExp("^\\s+","g"),d=RegExp("\\s+$","g"),f=RegExp('""',"g"),e=[],h=this._splitLines(b);for(b=0;b<h.length;++b){var c=h[b];if(0<c.length){c=c.split(this.separator);for(var g=0;g<c.length;){var p=c[g].replace(a,""),q=p.replace(d,""),u=q.charAt(0),v=q.charAt(q.length-1),
t=q.charAt(q.length-2),y=q.charAt(q.length-3);if(2===q.length&&'""'==q)c[g]="";else if('"'==u&&('"'!=v||'"'==v&&'"'==t&&'"'!=y)){if(g+1===c.length)return;c[g]=p+this.separator+c[g+1];c.splice(g+1,1)}else'"'==u&&'"'==v&&(q=q.slice(1,q.length-1),q=q.replace(f,'"')),c[g]=q,g+=1}e.push(c)}}this._attributes=e.shift();for(b=0;b<this._attributes.length;b++)this._attributeIndexes[this._attributes[b]]=b;this._dataArray=e}},_splitLines:function(b){var a=[],d,f="",e=!1;for(d=0;d<b.length;d++){var h=b.charAt(d);
switch(h){case '"':e=!e;f+=h;break;case "\r":e?f+=h:(a.push(f),f="",d<b.length-1&&"\n"==b.charAt(d+1)&&d++);break;case "\n":e?f+=h:(a.push(f),f="");break;default:f+=h}}""!==f&&a.push(f);return a},_processData:function(b){this._getArrayOfArraysFromCsvFileContents(b);this._arrayOfAllItems=[];if(this.identifier&&void 0===this._attributeIndexes[this.identifier])throw Error(this.declaredClass+": Identity specified is not a column header in the data set.");for(b=0;b<this._dataArray.length;b++){var a=b;
this.identifier&&(a=this._dataArray[b][this._attributeIndexes[this.identifier]],this._idMap[a]=b);this._arrayOfAllItems.push(this._createItemFromIdentity(a))}this._loadFinished=!0;this._loadInProgress=!1},_createItemFromIdentity:function(b){var a={};a[this._storeProp]=this;a[this._idProp]=b;return a},getIdentity:function(b){return this.isItem(b)?b[this._idProp]:null},fetchItemByIdentity:function(b){var a=b.scope?b.scope:r.global;if(this._loadFinished){var d=this._createItemFromIdentity(b.identity);
this.isItem(d)||(d=null);b.onItem&&b.onItem.call(a,d)}else{var f=this;if(""!==this.url)this._loadInProgress?this._queuedFetches.push({args:b}):(this._loadInProgress=!0,d=n.get({url:f.url,handleAs:"text"}),d.addCallback(function(e){try{f._processData(e);var h=f._createItemFromIdentity(b.identity);f.isItem(h)||(h=null);b.onItem&&b.onItem.call(a,h);f._handleQueuedFetches()}catch(c){b.onError&&b.onError.call(a,c)}}),d.addErrback(function(e){this._loadInProgress=!1;b.onError&&b.onError.call(a,e)}));else if(this._csvData)try{f._processData(f._csvData),
f._csvData=null,d=f._createItemFromIdentity(b.identity),f.isItem(d)||(d=null),b.onItem&&b.onItem.call(a,d)}catch(e){b.onError&&b.onError.call(a,e)}}},getIdentityAttributes:function(b){return this.identifier?[this.identifier]:null},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var b=0;b<this._queuedFetches.length;b++){var a=this._queuedFetches[b],d=a.filter,f=a.args;d?d(f,this._arrayOfAllItems):this.fetchItemByIdentity(a.args)}this._queuedFetches=[]}}});H.extend(m,k);return m})},
"esri/dijit/analysis/ProjectExtent":function(){define(["dojo/_base/array","esri/geometry/Extent","esri/geometry/webMercatorUtils","esri/geometry/Polygon","esri/tasks/GeometryService"],function(H,m,n,r,l){function k(b,a){if(b&&a.xmin>a.xmax){var d=b.valid[1]-a.xmin,f=a.xmax-b.valid[0];d>f?a.xmax=b.valid[1]+f:a.xmin=b.valid[0]-d}}return function(b,a,d,f,e,h){var c=[102113,102100,3857],g=b.spatialReference.wkid;if(g===a.wkid)return d([b],null);if(4326==g&&-1<H.indexOf(c,a.wkid))return b.ymin=Math.max(b.ymin,
-89.99),b.ymax=Math.min(b.ymax,89.99),b=n.geographicToWebMercator(b),e=b.spatialReference._getInfo(),k(e,b),b.spatialReference.wkid=a.wkid,d([b],null);if(-1<H.indexOf(c,g)&&4326==a.wkid)return b=n.webMercatorToGeographic(b),e=b.spatialReference._getInfo(),k(e,b),d([b],null);h||(h=new l(window.esriGeowConfig.self.helperServices.geometry.url));if(e&&e.wrapAround180&&"extent"===b.type){var p=b;b=r.fromExtent(b)}h.project([b],a,function(q,u){if(!(q&&0<q.length&&q[0]&&"extent"==q[0].type)||isNaN(q[0].xmin)||
isNaN(q[0].ymin)||isNaN(q[0].xmax)||isNaN(q[0].ymax)){if(q&&0<q.length&&q[0]&&"point"==q[0].type&&!isNaN(q[0].x)&&!isNaN(q[0].y))return d(q,u);if(p&&"polygon"===q[0].type){if(1===q[0].rings.length)q[0]=new m(q[0].getExtent());else{var v=(new r(q[0].spatialReference.toJson())).addRing(q[0].rings[0]).getExtent(),t=(new r(q[0].spatialReference.toJson())).addRing(q[0].rings[1]).getExtent();q[0]=t;q[0].xmin=t.xmin-v.getWidth();q[0].ymin=Math.min(t.ymin,v.ymin);q[0].ymax=Math.max(t.ymax,v.ymax)}return d(q,
u)}if(f)return f()}else return d(q,u)},f)}})},"esri/dijit/analysis/mixins/browselayers/configs/AGOLBrowseItem":function(){define(["dojo/_base/lang","dojo/has","../../../../../kernel","./EnterpriseBrowseItem","../../../ItemTypes"],function(H,m,n,r,l){var k={getConfig:function(b){var a=r.getConfig(b);a.baseSections.push("all");a.baseSections.push("subscription");(-1<b.allowedItemTypes.indexOf(l.RFT)||-1<b.allowedItemTypes.indexOf(l.DLPK))&&a.baseSections.push("livingAtlas");return a}};m("extend-esri")&&
H.setObject("dijit.analysis.mixins.browselayers.configs.AGOLBrowseItem",k,n);return k})},"esri/dijit/analysis/mixins/browselayers/configs/EnterpriseBrowseItem":function(){define("dojo/_base/lang dojo/has dojox/lang/functional/object ../../../../../kernel ./Common ../../../AnalysisRegistry ../../../ItemTypes dojo/i18n!../../../nls/BrowseLayerMixin".split(" "),function(H,m,n,r,l,k,b,a){var d={getConfig:function(f){var e=f.disableLAAL?{customSections:[]}:{customSections:l.getLAALCustomSection(f)};!f.disableBoundary&&
f.portal.EsriBoundaryLayersGroupQuery&&e.customSections.push(l.getBoundaryLayersSection(f));-1<f.allowedItemTypes.indexOf(b.RFT)&&f.showRFTSystemSection&&e.customSections.push(l.getSystemRFTSection(f));e=H.mixin({dialogTitle:f.title||a.customAnalysisLayerTitle,allowedItemTypes:f.allowedItemTypes,availableItemTypeFilters:f.availableItemTypeFilters,baseSections:["myContent","myFavorites","myGroups","myOrganization"],resultsPerQuery:l.getNumberOfPages(),layoutMode:"fullscreen",staticFilters:l.getStaticFilters(f.customQueryTags),
mainActionTitle:a.mainActionTitle,customActions:[l.getAddtoMapActions(f.onActionSubLayer)],showSubResources:this._getSubResourcesForPortal(f),disabledSubResources:f.disabledSubResources,addQueryParameters:f.addQueryParameters,enableMapAreaFilter:f.enableMapAreaFilter},e);f.showRFTEditCustomAction&&e.customActions.push(l.getEditRFTActions(f.onEditRFT));return e},_getSubResourcesForPortal:function(f){var e={};-1<f.allowedItemTypes.indexOf(b.FS)&&(e[b.FS]={allowed:function(h){return this.allowedItemsForTypes(h,
f.customQueryTags)}.bind(this),onSelect:f.onSelectSubLayer,customActions:[l.getAddtoMapActions(f.onActionSubLayer)],filters:this._getFilterforSubLayer(!1,f.customQueryTags)});-1<f.allowedItemTypes.indexOf(b.MS)&&(e[b.MS]={allowed:function(h){return this.allowedItemsForTypes(h,f.customQueryTags)}.bind(this),onSelect:f.onSelectSubLayer,customActions:[l.getAddtoMapActions(f.onActionSubLayer)],filters:this._getFilterforSubLayer(!1,f.customQueryTags)});-1<f.allowedItemTypes.indexOf(b.BIGDATA)&&(e[b.BIGDATA]=
{allowed:function(h){return this.allowedItemsForTypes(h,f.customQueryTags)}.bind(this),onSelect:f.onSelectSubLayer,filters:this._getFilterforSubLayer(!0,f.customQueryTags)});-1<f.allowedItemTypes.indexOf(b.GPSERVICE)&&(e[b.GPSERVICE]={allowed:function(){return!0},onSelect:f.onSelectGPTool,filters:[]});return e},_getFilterforSubLayer:function(f,e){var h=[];h.push(this.getGeometryFilter(e.geometryTypes));e.layerTypes&&(f?h.push(this.getFilterForLayerTypesForBigData(e.layerTypes)):h.push(this.getFilterForLayerTypesForFS(e.layerTypes)));
e.timeTypes&&h.push(this.getTimeFilter(e.timeTypes));return h},getGeometryFilter:function(f){var e=[];(f&&0<f.length?f:n.values(k.GeometryTypes)).forEach(function(h){switch(h){case k.GeometryTypes.Point:e.push({displayName:a.pointFilterName,allowed:this.filters.geometryTypes[k.GeometryTypes.Point],value:"point"});break;case k.GeometryTypes.Polygon:e.push({displayName:a.polygonFilterName,allowed:this.filters.geometryTypes[k.GeometryTypes.Polygon],value:"polygon"});break;case k.GeometryTypes.Line:e.push({displayName:a.lineFilterName,
allowed:this.filters.geometryTypes[k.GeometryTypes.Line],value:"line"});break;case k.GeometryTypes.MultiPoint:e.push({displayName:a.multiPointFilterName,allowed:this.filters.geometryTypes[k.GeometryTypes.MultiPoint],value:"multipoint"})}},this);return{allowed:function(){return!0},displayName:a.geometryFilterName,value:"geometry",children:e}},getFilterForLayerTypesForFS:function(f){var e=[];(f?0<f.length?f:[b.FLAYER,b.TABLE]:[]).forEach(function(h){switch(h){case b.FLAYER:e.push({displayName:a.featureLayerName,
allowed:this.filters.layerTypes[b.FLAYER],value:"featurelayer"});break;case b.TABLE:e.push({displayName:a.tableLayerName,allowed:this.filters.layerTypes[b.TABLE],value:"ftable"})}},this);return{allowed:function(){return!0},displayName:a.itemTypeFilterName,value:"itemtype",children:e}},getFilterForLayerTypesForBigData:function(f){var e=[];(f?0<f.length?f:[b.BDATAFEATURE,b.BTABLE]:[]).forEach(function(h){switch(h){case b.BDATAFEATURE:e.push({displayName:a.featureLayerName,allowed:this.filters.layerTypes[b.BDATAFEATURE],
value:"bfeaturelayer"});break;case b.BTABLE:e.push({displayName:a.tableLayerName,allowed:this.filters.layerTypes[b.BTABLE],value:"btable"})}},this);return{allowed:function(){return!0},displayName:a.featureLayerName,value:"itemtype",children:e}},getTimeFilter:function(f){var e=[];(f?0<f.length?f:[k.TimeTypes.Instant,k.TimeTypes.Interval]:[]).forEach(function(h){switch(h){case k.TimeTypes.Instant:e.push({displayName:a.instantFilterName,allowed:this.filters.timeTypes[k.TimeTypes.Instant].bind(this),
value:"instant"});break;case k.TimeTypes.Interval:e.push({displayName:a.intervalFilterName,allowed:this.filters.timeTypes[k.TimeTypes.Interval].bind(this),value:"interval"})}},this);return{allowed:function(){return!0},displayName:a.timeFilterName,value:"time",children:e}},allowedItemsForTypes:function(f,e){var h=!0,c=e.layerTypes||[b.FLAYER,b.BDATAFEATURE];e.geometryTypes&&f.geometryType&&(e.geometryTypes=0<e.geometryTypes.length?e.geometryTypes:n.values(k.GeometryTypes),h=h&&-1!==e.geometryTypes.indexOf(f.geometryType));
c&&f.type&&(c=0<c.length?c:[b.FLAYER,b.BDATAFEATURE,b.BTABLE,b.TABLE],h=h&&-1!==c.indexOf(f.type));e.timeTypes&&(e.timeTypes=0<e.timeTypes.length?e.timeTypes:[k.TimeTypes.Instant,k.TimeTypes.Interval],h=h&&-1!==e.timeTypes.indexOf(this.getTimeType(f)));e.customCheck&&e.customCheck.customCheckHandler&&(h=h&&e.customCheck.customCheckHandler(f));return h&&f},getTimeType:function(f){return f?this.isDefined(f.timeInfo)&&this.isDefined(f.timeInfo.startTimeField)&&!this.isDefined(f.timeInfo.endTimeField)?
k.TimeTypes.Instant:this.isDefined(f.timeInfo)&&this.isDefined(f.timeInfo.startTimeField)&&this.isDefined(f.timeInfo.endTimeField)?k.TimeTypes.Interval:this.isDefined(f.time)&&this.isDefined(f.time.timeType)?f.time.timeType:!1:!1},isDefined:function(f){return void 0!==f&&null!==f},filters:{layerTypes:{"Feature Layer":function(f){return f.type===b.FLAYER},Table:function(f){return f.type===b.TABLE},featureClass:function(f){return f.type===b.BDATAFEATURE},table:function(f){return f.type===b.BTABLE}},
geometryTypes:{esriGeometryMultipoint:function(f){return f.geometryType===k.GeometryTypes.MultiPoint},esriGeometryPolyline:function(f){return f.geometryType===k.GeometryTypes.Line},esriGeometryPolygon:function(f){return f.geometryType===k.GeometryTypes.Polygon},esriGeometryPoint:function(f){return f.geometryType===k.GeometryTypes.Point}},timeTypes:{instant:function(f){return this.getTimeType(f)===k.TimeTypes.Instant},interval:function(f){return this.getTimeType(f)===k.TimeTypes.Interval}}}};m("extend-esri")&&
H.setObject("dijit.analysis.mixins.browselayers.configs.EnterpriseBrowseItem",d,r);return d})},"esri/dijit/analysis/mixins/browselayers/configs/Common":function(){define(["dojo/_base/lang","dojo/has","../../../../../kernel","dojo/i18n!../../../nls/BrowseLayerMixin","../../../ItemTypes"],function(H,m,n,r,l){var k={getLAALCustomSection:function(b){var a=this._isCustomAnalysisQuery(b.portal,b.isPortal),d=[{name:r.customeSectionName,baseQuery:this._getLAALBaseQuery(b.customQueryTags,b.portal,b.isPortal),
filters:[{fetchGroupIdByQuery:this._getDefaultQueryString(b.isPortal),name:r.Categories,type:"group",path:["categories"],staticSchema:this._getStaticLAALSchema(b.portal,b.isPortal)}].concat(this._getFilters(b.isPortal)),disableSubResources:!0}];a&&d.push({name:r.customAnalysisGroupName,baseQuery:"",filters:[{id:this._getAnalysisGroupQuery(b.portal,b.isPortal).split(":")[1],name:r.Categories,type:"group",path:["categories"],staticSchema:void 0}].concat(this._getFilters(b.isPortal)),disableSubResources:!1});
return d},getAddtoMapActions:function(b){return{allowed:function(a){return a.type!==l.RFT&&a.type!==l.XLS&&a.type!==l.CSV&&a.type!==l.DLPK},asynchronous:!1,onAction:b,name:r.customActionName}},getEditRFTActions:function(b){return{allowed:function(a){return a.type===l.RFT&&!a.rfxTemplateData},asynchronous:!1,onAction:b,name:r.edit}},getSystemRFTSection:function(b){var a='(group:"'+(b.rftGroupId&&b.rftGroupId.id)+'") -type:"Attachment" -tags:"mature support"';b.isPortal||(a+=' -typekeywords:"categoryname#distance (legacy)system_rft"');
return{name:"System",baseQuery:a,filters:[].concat(this._getFilters(b.isPortal)),addToFront:!1,sortField:"title"}},getStaticFilters:function(b){if((b=b.tags)&&0!==b.length){var a=[];b.forEach(function(d){a.push(r[d]?r[d]:d)});return a}},getBoundaryLayersSection:function(b){return{name:r.boundaryLayers,baseQuery:"("+b.portal.EsriBoundaryLayersGroupQuery.split("AND")[1].trim()+')-type:"Attachment" -tags:"mature support"',filters:this._getFilters(b.isPortal),addToFront:!1,disableSubResources:!1}},getNumberOfPages:function(){return 16},
_getLAALBaseQuery:function(b,a,d){d=['typekeywords:"Analysis Ready"'];(a||a.user||!a.user.demographics)&&d.push('-typekeywords:"Requires Credits"');d.push('-type:"Attachment" -tags:"mature support"');d.push(this._queryTagsForLivingAtlasItemBrowser(b));return d.join(" ")},_queryTagsForLivingAtlasItemBrowser:function(b){b=b.tags;var a=[];if(!b||0===b.length)return"";if(1===b.length)return"tags: ("+b[0]+")";b.forEach(function(d){a.push(d)});return"tags: ("+a.join(" OR ")+")"},_getAnalysisGroupQuery:function(b,
a){return this._isCustomAnalysisQuery(b,a)},_getDefaultQueryString:function(b){var a='title:"Living Atlas Analysis Layers" AND owner:esri';b&&(a='title:"Living Atlas Analysis Layers" AND owner:esri_livingatlas');return a},_isCustomAnalysisQuery:function(b,a){return b&&b.analysisLayersGroupQuery&&b.analysisLayersGroupQuery!==this._getDefaultQueryString(a)?b.analysisLayersGroupQuery:!1},_getStaticLAALSchema:function(b,a){return[{title:"categories",categories:[{title:"boundaries and places",categories:[{title:"boundaries",
categories:[],displayName:r.boundaries},{title:"places",categories:[],displayName:r.places}],displayName:r.boundariesAndPlaces},{title:"hexbins",categories:[],displayName:r.hexbins},{title:"transportation",categories:[],displayName:r.transportation}]}]},_getFilters:function(b){return["tags"]}};m("extend-esri")&&H.setObject("dijit.analysis.mixins.browselayers.configs.Common",k,n);return k})},"esri/dijit/analysis/mixins/FilterAndSelection":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/dom-construct dojo/dom-class ../../../kernel dojo/aspect ../components/FilterAndSelection/FilterAndSelection".split(" "),
function(H,m,n,r,l,k,b,a,d,f){H=H([],{showFilterAndSelection:!1,filterAndSelections:[],aspectsForFilters:[],_updateJobFilterAndSelection:function(e){this.showFilterAndSelection&&this.filterObjects&&this.filterObjects.forEach(function(h){var c=e[h.layer]||e[h.jobParamLayer],g=this.filterAndSelections[h.layer];if((c="string"===typeof c?r.fromJson(c):c)&&g){var p=g.get("inputQuery");p&&(c.filter=c.filter?c.filter+" AND "+p:p,e[h.layer]=r.toJson(c),e[h.jobParamLayer]&&(e[h.jobParamLayer]=r.toJson(c)),
g.get("expression")&&(e[h.expressionObj]=r.toJson(g.get("expression"))))}}.bind(this));return e},clearFilterAndSelection:function(){n.forEach(this.aspectsForFilters,function(e){e.remove()});n.forEach(Object.keys(this.filterAndSelections),function(e){this.filterAndSelections[e].clear()},this)},_createFilterAndSelections:function(){this.filterAndSelections={};this.showFilterAndSelection&&n.forEach(this.filterObjects,function(e){this.filterAndSelections[e.layer]=this._createFilterAndSelection(e)},this)},
_createFilterAndSelection:function(e){b.add(e.select.domNode,"with-filter");var h=e.layerForTool||e.layer,c={map:this.map,layer:this[e.layer]||this[e.layerForTool]||e.layers&&e.layers[e.select.get("value")],expression:this[e.expressionObj]};c=this.constructDomForFilter(c,e.select);this.aspectsForFilters.push(d.after(e.select,"onChange",function(g){0<=parseInt(g)&&(g=e.layers&&e.layers[g]||this[h],this.filterAndSelections[e.layer]&&this.filterAndSelections[e.layer].set("layer",g))}.bind(this),!0));
this.aspectsForFilters.push(d.after(this,"_onClose",this.clearFilterAndSelection.bind(this)));return c},constructDomForFilter:function(e,h){h=h.domNode.parentNode;var c=k.create("div",null,h);e.msgContainer=k.create("div",{class:"esriLeadingMargin1 paddingTop1"},h);return new f(e,c)}});l("extend-esri")&&m.setObject("dijit.analysis.mixins.FilterAndSelection.FilterAndSelection",H,a);return H})},"esri/dijit/analysis/components/FilterAndSelection/FilterAndSelection":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/connect dojo/has dojo/string dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Button dijit/form/ToggleButton dijit/Dialog ../../../../kernel ../../../../lang ../../../../layers/FeatureLayer ../../ExpressionForm ../../../../geometry/Extent ../../../../geometry/ScreenPoint ../../../../symbols/CartographicLineSymbol ../../../../symbols/SimpleMarkerSymbol ../../../../symbols/SimpleLineSymbol ../../../../symbols/SimpleFillSymbol ../../../../tasks/query ../../ItemTypes ../../AnalysisRegistry dojo/i18n!../../../../nls/jsapi dojo/text!./FilterAndSelection.html".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J){H=H([d,f,e],{declaredClass:"esri.dijit.analysis.components.FilterAndSelection.FilterAndSelection",templateString:J,_pbConnects:[],i18n:{},map:{},layer:{},msgContainer:null,expression:{},inputQuery:"",postMixInProperties:function(){this.inherited(arguments);m.mixin(this.i18n,G.expressionGrid);m.mixin(this.i18n,G.common)},destroy:function(){this.inherited(arguments);n.forEach(this._pbConnects,l.disconnect);delete this._pbConnects},
postCreate:function(){this.inherited(arguments);this.own(this._expressionForm.on("add-expression",m.hitch(this,this._handleExpressionFormAdd)));this.own(this._expressionForm.on("cancel-expression",m.hitch(this,this._handleExpressionFormCancel)))},startup:function(){},_handleSelectionButtonClick:function(L){L&&!this._mapClickHandle?(this._mapClickHandle=this.map.on("click",m.hitch(this,this._handleMapClick)),this.emit("selecttool-activate",{}),this.set("expression",void 0)):(this._mapClickHandle&&
(this._mapClickHandle.remove(),this._mapClickHandle=null),this.emit("selecttool-deactivate",{}))},_setInputQueryForRerun:function(){var L=this.layer&&(this.layer.type===A.BDATAFEATURE||this.layer.type===A.BTABLE);this.layer&&this.layer.filter&&-1!==this.layer.filter.indexOf(" AND ")?(this.set("inputQuery",this.layer.filter.substring(this.layer.filter.indexOf(" AND ")+5)),L||this.layer.setDefinitionExpression(this.layer.filter.substring(0,this.layer.filter.indexOf(" AND ")))):this.layer&&this.layer.filter&&
-1===this.layer.filter.indexOf(" AND ")&&(this.set("inputQuery",this.layer.filter),L||this.layer.setDefinitionExpression(null));this.inputQuery===(this.expression&&this.expression.expression.where)?a.set(this.msgContainer,"innerHTML",this.expression.expression._attributeText):0===this._getObjectIds().length&&a.set(this.msgContainer,"innerHTML","")},_handleQueryButtonClick:function(){this._expDialog.set("title",this.i18n.queryLabel);this._selectBtn.set("checked",!1);this._isAttrFlag=!0;this._expressionForm.set("showUnique",
!(this.layer&&(this.layer.type===A.BDATAFEATURE||this.layer.type===A.TABLE||this.layer.type===A.BTABLE)));this.expression?(this._expressionForm.set("action","edit"),this._expressionForm.set("expression",this.expression.expression)):this._expressionForm.set("action","add");this._expDialog.show()},_handleExpressionFormAdd:function(L){this.selectionLayer&&this.selectionLayer.clearSelection();if("add"===L.action||"edit"===L.action)this.set("expression",L),this.set("inputQuery",L.expression&&L.expression.where||
""),L=this._getQuery(),this.selectionLayer&&this.selectionLayer.selectFeatures(L,u.SELECTION_ADD);this._expDialog.hide()},_handleExpressionFormCancel:function(){this._expDialog.hide()},clear:function(){this.selectionLayer&&(this.selectionLayer.clearSelection(),this.map.removeLayer(this.selectionLayer),this.selectionLayer=null,this.set("inputQuery",""));this._mapClickHandle&&(this._mapClickHandle.remove(),delete this._mapClickHandle)},_handleMapClick:function(L){var R;!this._isAttrFlag&&this.expression&&
this.selectionLayer.clearSelection();var T=6;if((R=this.layer.renderer)&&"esri.renderer.SimpleRenderer"===R.declaredClass){var aa=R.symbol;aa.xoffset&&(T=Math.max(T,Math.abs(aa.xoffset)));aa.yoffset&&(T=Math.max(T,Math.abs(aa.yoffset)))}else!R||"esri.renderer.UniqueValueRenderer"!==R.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==R.declaredClass||n.forEach(R.infos,function(ca){aa=ca.symbol;aa.xoffset&&(T=Math.max(T,Math.abs(aa.xoffset)));aa.yoffset&&(T=Math.max(T,Math.abs(aa.yoffset)))});R=
L.screenPoint;L=this.map.toMap(new y(R.x-T,R.y+T));R=this.map.toMap(new y(R.x+T,R.y-T));L=new t(L.x,L.y,R.x,R.y,this.map.spatialReference);L=this._getQuery({extent:L});this.layer.getDefinitionExpression&&(L.where=this.layer.getDefinitionExpression());this.layer.queryFeatures(L).then(m.hitch(this,function(ca){if(ca){var ba=[],la=[],oa=[];this.selectionLayer&&0<this.selectionLayer.getSelectedFeatures().length&&(la=n.map(this.selectionLayer.getSelectedFeatures(),function(fa){return fa.attributes[this.selectionLayer.objectIdField]},
this));n.forEach(ca.features,function(fa){0===la.length?ba.push(fa.attributes[this.selectionLayer.objectIdField]):-1===n.indexOf(la,fa.attributes[this.selectionLayer.objectIdField])?ba.push(fa.attributes[this.selectionLayer.objectIdField]):oa.push(fa.attributes[this.selectionLayer.objectIdField])},this);0<ba.length&&(ca=this._getQuery({oids:ba}),this.selectionLayer.selectFeatures(ca,u.SELECTION_ADD));0<oa.length&&(ca=this._getQuery({oids:oa}),this.selectionLayer.selectFeatures(ca,u.SELECTION_SUBTRACT))}}))},
_handleLayerSelectionComplete:function(){var L=this.selectionLayer.getSelectedFeatures();if(!this._isAttrFlag&&0<L.length){var R="";n.forEach(L,function(T){R+=this.selectionLayer.objectIdField+" \x3d "+T.attributes[this.selectionLayer.objectIdField]+" OR ";return T.attributes[this.selectionLayer.objectIdField]},this);R=R.substring(0,R.lastIndexOf(" OR "));this.set("inputQuery",R);a.set(this.msgContainer,"innerHTML",b.substitute(this.i18n.selectedFeaturesLabel,{total:L.length}))}this._isAttrFlag||
0!==L.length||(a.set(this.msgContainer,"innerHTML",""),this.set("inputQuery",""))},_onSelectionLayerLoad:function(L,R){R.setScaleRange(L.minScale,L.maxScale);this._connect(L,"onScaleRangeChange",m.hitch(this,function(T,aa){T.setScaleRange(aa.minScale,aa.maxScale)},R,L));this.map.addLayer(R);R.geometryType===z.GeometryTypes.Point||"esriGeometryMultPoint"===R.geometryType?(L=new B,L.setStyle(B.STYLE_TARGET),L._setDim(16,16,0),L.setOutline(new C(F.STYLE_SOLID,new r([0,255,255]),2,C.CAP_ROUND,C.JOIN_ROUND)),
L.setColor(new r([0,0,0,0])),R.setSelectionSymbol(L)):R.geometryType===z.GeometryTypes.Line?R.setSelectionSymbol(new F(F.STYLE_SOLID,new r([0,255,255]),2)):R.geometryType===z.GeometryTypes.Polygon&&R.setSelectionSymbol(new x(x.STYLE_NULL,new F(F.STYLE_SOLID,new r([0,255,255]),2),new r([0,0,0,0])));this.selectionLayer&&this.inputQuery&&(this.inputQuery.match(/ OR /g)||!this.expression?this._isAttrFlag=!1:(this._isAttrFlag=!0,this.set("expression",{action:"edit",expression:this.expression.expression})),
R=this._getQuery(),this.selectionLayer.selectFeatures(R,u.SELECTION_ADD))},_isLayerPresentInMap:function(L){var R=!1;this.map.getLayersVisibleAtScale().forEach(function(T){R=R||T.url===L.url});return R},_getObjectIds:function(){var L=this.get("inputQuery");L=L?L.split(" OR "):[];L=n.map(L,function(R){return R.split(" \x3d ")[1]});a.set(this.msgContainer,"innerHTML",b.substitute(this.i18n.selectedFeaturesLabel,{total:L.length}));return L},_getQuery:function(L){var R=new w;R.returnGeometry=!0;if(!L)return this._isAttrFlag?
R.where=this.get("inputQuery"):R.objectIds=this._getObjectIds(),R;L.extent&&(R.geometry=L.extent);L.oids&&(R.objectIds=L.oids);return R},_setMapAttr:function(L){this.map=L},_getMapAttr:function(){return this.map},_getInputQueryAttr:function(){return this.inputQuery},_setInputQueryAttr:function(L){this.inputQuery=L},_getLayerAttr:function(){return this.selectionLayer},_setLayerAttr:function(L){if(L&&L.url){var R=this.layer&&(this.layer.type===A.BDATAFEATURE||this.layer.type===A.BTABLE||this.layer.type===
A.TABLE);this.layer=L;this.set("inputQuery","");this.selectionLayer&&this.clear();this._selectBtn.set("checked",!1);this._expressionForm.set("showUnique",!R);this._expressionForm.set("showFirstRow",!1);this._expressionForm.set("firstOperands",[L]);this._expressionForm.set("inputOperands",[L]);this._expressionForm.set("selectedFirstOperand",L);this._expressionForm.init();this._queryBtn.set("disabled",!1);this._setInputQueryForRerun();if(this._isLayerPresentInMap(L))if(this._selectBtn.set("disabled",
!1),this.selectionLayer=new u(L.url&&!L._collection?L.url:this.layer.toJson(),{outFields:["*"],mode:L.url&&!L._collection?u.MODE_SELECTION:u.MODE_SNAPSHOT}),this.selectionLayer.setRenderer(null),this.selectionLayer.on("selection-complete",m.hitch(this,this._handleLayerSelectionComplete)),this.selectionLayer.loaded)this._onSelectionLayerLoad(L,this.selectionLayer);else this.selectionLayer.on("load",m.hitch(this,this._onSelectionLayerLoad,L,this.selectionLayer));else this._selectBtn.set("disabled",
!0)}else this._selectBtn.set("disabled",!0),this._queryBtn.set("disabled",!0)},_setExpressionAttr:function(L){L?(this._isAttrFlag=!0,this.expression=L,this.expression.expression&&(a.set(this.msgContainer,"innerHTML",this.expression.expression._attributeText),this.set("inputQuery",this.expression.expression.where))):(this._isAttrFlag=!1,this.expression=void 0)},_getExpressionAttr:function(){return this.expression},_connect:function(L,R,T){this._pbConnects.push(l.connect(L,R,T))}});k("extend-esri")&&
m.setObject("dijit.analysis.components.FilterAndSelection.FilterAndSelection",H,p);return H})},"esri/dijit/analysis/ExpressionForm":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/fx dojo/has dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/_base/event dojo/Evented dojo/fx/easing dojo/number dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/Button dijit/form/CheckBox dijit/form/Form dijit/form/Select dijit/form/TextBox dijit/form/ValidationTextBox dijit/layout/ContentPane dijit/form/FilteringSelect dijit/Dialog dijit/Tooltip ../../kernel ../../lang ./utils ../SingleFilter dojo/i18n!../../nls/jsapi dojo/text!./templates/ExpressionForm.html".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa,M,X,da){H=m([y,C,B,F,x,u],{declaredClass:"esri.dijit.analysis.ExpressionForm",templateString:da,widgetsInTemplate:!0,firstOperands:null,defaultUnits:"english",showFirstRow:!0,showUnique:!0,operator:null,isServerAdvanceLicensed:!0,allLayersOpertors:["intersects","notIntersects","withinDistance","notWithinDistance","nearest"],constructor:function(Q){Q.containerNode&&(this.container=Q.containerNode);this._setClasses(Q)},
_setClasses:function(Q){this._addBtnClass=Q.primaryActionButttonClass||"esriAnalysisSubmitButton"},destroy:function(){this.inherited(arguments);r.forEach(this._pbConnects,l.disconnect);delete this._pbConnects},postMixInProperties:function(){this.inherited(arguments);this.i18n={};n.mixin(this.i18n,X.common);n.mixin(this.i18n,X.expressionGrid);n.mixin(this.i18n,X.expressionForm)},postCreate:function(){this.inherited(arguments);this.attributeChangeHandler=l.subscribe("filter-expression-change",n.hitch(this,
this._handleAttributeFilterChange));this._distanceInput.set("validator",n.hitch(this,this._validateDistance));this.set("action","add");e.set(this._firstRow,"display",this.showFirstRow?"":"none");this.isServerAdvanceLicensed||this._operatorSelect.removeOption("nearest");this.own(this.watch("showUnique",n.hitch(this,function(Q,K,E){this._attributeFilter&&this._attributeFilter.set("showUnique",E)})))},init:function(){this.isServerAdvanceLicensed||this._operatorSelect.removeOption("nearest");this.showReadyToUseLayers&&
this.owningWidget&&!this._browseTitle&&(this._browseTitle=fa._isCustomAnalysisQuery(this.owningWidget)?this.i18n.browseAnalysisLayers:this.i18n.browseAnalysisTitle);if(this._firstOperandSelect&&this.firstOperands&&this.inputOperands){this._firstOperandSelect.getOptions()&&this._firstOperandSelect.removeOption(this._firstOperandSelect.getOptions());var Q,K,E=this.inputOperands.length,N=this.firstOperands.length,I=[];for(Q=0;Q<E;Q+=1)for(K=0;K<N;K+=1)oa.isDefined(this.inputOperands[Q].id)&&oa.isDefined(this.firstOperands[K].id)&&
this.inputOperands[Q].id===this.firstOperands[K].id?I[this.firstOperands[K].id]=Q.toString():oa.isDefined(this.inputOperands[Q].name)&&oa.isDefined(this.firstOperands[K].name)&&this.inputOperands[Q].name===this.firstOperands[K].name&&(I[this.firstOperands[K].name]=Q.toString());r.forEach(this.firstOperands,function(O,U){oa.isDefined(O)&&this._firstOperandSelect.addOption({value:I[O.id||O.name],label:O.name})},this);this.selectedFirstOperand&&(oa.isDefined(this.selectedFirstOperand.id)||(this.selectedFirstOperand.id=
this.selectedFirstOperand.name),this._firstOperandSelect.set("value",I[this.selectedFirstOperand.id]));(this.get("showReadyToUseLayers")||this.get("showReadyLayersForFirst"))&&this._firstOperandSelect.addOption({type:"separator",value:""});this.get("showReadyToUseLayers")&&this.get("showReadyLayersForFirst")&&this._firstOperandSelect.addOption({value:"browse",label:this._browseTitle});this.get("showBrowseLayers")&&this.get("showReadyLayersForFirst")&&this._firstOperandSelect.addOption({value:"browselayers",
label:this.i18n.browseLayers});1===E&&!this.get("showReadyToUseLayers")&&!this.get("showBrowseLayers")&&this._operatorSelect&&this._operatorSelect.getOptions()&&(this._operatorSelect.removeOption(this._operatorSelect.getOptions()),this._operatorSelect.addOption({value:"where",label:this.i18n.where}))}"add"===this.get("action")&&(this._operatorSelect.set("value","where"),this._handleOperatorChange("where"),this._distanceInput.set("value",""),"metric"===this.defaultUnits?this._distanceUnitsSelect.set("value",
"Kilometers"):this._distanceUnitsSelect.set("value","Miles"))},startup:function(){},clear:function(){this.init()},_validateDistance:function(Q){var K=this._operatorSelect.get("value");return-1===r.indexOf(["withinDistance","notWithinDistance"],K)?!0:(Q=t.parse(Q))&&0<parseFloat(Q,10)&&Infinity>parseFloat(Q,10)},_handleAttributeFilterChange:function(){if(this._attributeFilter){var Q=this._attributeFilter.toJson();Q=this._attributeFilter.builtSingleFilterString(Q);Q.whereClause?this._addBtn.set("disabled",
!1):this._addBtn.set("disabled",!0)}},_handleSecondOperandChange:function(Q){if("browse"===Q||"browselayers"===Q)this.owningWidget.layersSelect=this._secondOperandSelect,this.owningWidget.showReadyToUseLayersDialog(!1,Q)},_handleFirstOperandChange:function(Q){"browse"!==Q&&"browselayers"!==Q||!this.get("showReadyLayersForFirst")?this._handleOperatorChange("where"):(this.owningWidget.layersSelect=this._firstOperandSelect,this.owningWidget.showReadyToUseLayersDialog(!0,Q))},_handleDistanceInputChange:function(Q){this._addBtn.set("disabled",
!this._distanceInput.validate())},_handleOperatorChange:function(Q){var K=this.get("operator");this.set("operator",Q);-1===r.indexOf(["where","withinDistance","notWithinDistance"],Q)?!0!==this._checkBetweenPairs(Q,K)&&this._buildSpatialExpression(Q,K):"where"===Q?this._buildAttributeExpression(Q):-1!==r.indexOf(["withinDistance","notWithinDistance"],Q)&&this._buildDistanceExpression(Q,K)},_checkBetweenPairs:function(Q,K){return r.some([["contains","notContains"],["within","notWithin"]],function(E){if(Q===
E[0]&&K===E[1]||Q===E[1]&&K===E[0])return!0})},_isValidSecondOperand:function(Q,K,E){var N=!1;"contains"===Q||"notContains"===Q?"esriGeometryPoint"!==K&&"esriGeometryMultipoint"!==K||"esriGeometryPoint"!==E&&"esriGeometryMultipoint"!==E?"esriGeometryPolyline"!==K||"esriGeometryPoint"!==E&&"esriGeometryPolyline"!==E&&"esriGeometryMultipoint"!==E?"esriGeometryPolygon"===K&&(N=!0):N=!0:N=!0:"within"===Q||"notWithin"===Q?"esriGeometryPoint"===K||"esriGeometryMultipoint"===K?N=!0:"esriGeometryPolyline"!==
K||"esriGeometryPolygon"!==E&&"esriGeometryPolyline"!==E?"esriGeometryPolygon"===K&&"esriGeometryPolygon"===E&&(N=!0):N=!0:N=!0;return N},_isValidFirstOperand:function(Q){var K=!0;Q&&Q.fields?Q.fields&&1===Q.fields.length&&"esriFieldTypeOID"===Q.fields[0].type&&(this._showMessages(f.substitute(this.i18n.inValidAttributeFilterMessage,{layername:Q.name})),K=!1):K=!1;return K},_addBrowseAndBrowseLayerOptions:function(Q){if(!Q)return!1;(this.get("showReadyToUseLayers")||this.get("showBrowseLayers"))&&
Q.addOption({type:"separator",value:""});this.get("showReadyToUseLayers")&&Q.addOption({value:"browse",label:this._browseTitle});this.get("showBrowseLayers")&&Q.addOption({value:"browselayers",label:this.i18n.browseLayers});return!0},_buildSpatialExpression:function(Q,K){var E=parseInt(this._firstOperandSelect.get("value"),10);var N=this.inputOperands[E].geometryType;this._addBtn.set("disabled",!1);this._distanceInput.set("required",!1);e.set(this._attrFilterDiv,"display","none");e.set(this._secondOperandSelect.domNode,
"display","");this._secondOperandSelect&&(-1===this.allLayersOpertors.indexOf(K)&&(this._secondOperandSelect.getOptions()&&this._secondOperandSelect.removeOption(this._secondOperandSelect.getOptions()),r.forEach(this.inputOperands,function(I,O){O.toString()!==this._firstOperandSelect.get("value")&&this._isValidSecondOperand(Q,N,I.geometryType)&&(this._secondOperandSelect.addOption({value:O.toString(),label:I.name}),""!==this._secondOperandSelect.get("value")&&this._secondOperandSelect.get("value")||
this._secondOperandSelect.set("value",O.toString()))},this),this._addBrowseAndBrowseLayerOptions(this._secondOperandSelect)),e.set(this._secondRow,"display",""),e.set(this._secondExpressionDiv,"display","none"),e.set(this._secondOperandSelect,{display:"",width:"75%"}))},_buildAttributeExpression:function(Q){this._distanceInput.set("required",!1);e.set(this._secondExpressionDiv,"display","none");this._secondOperandSelect&&this._secondOperandSelect.getOptions()&&this._secondOperandSelect.removeOption(this._secondOperandSelect.getOptions());
e.set(this._secondOperandSelect.domNode,"display","none");Q=parseInt(this._firstOperandSelect.get("value"),10);Q=this.inputOperands[Q];this._isValidFirstOperand(Q)?(this._addBtn.set("disabled",!0),e.set(this._secondRow,"display",""),e.set(this._attrFilterDiv,"display",""),this._attributeFilter&&(this._attributeFilter.init({mapLayer:Q,version:Q.version,fields:Q.fields,allowAllDateTypes:!0,part:"edit"===this.get("action")&&this.expression&&this.expression._attributeExprObj?this.expression._attributeExprObj:
null}),this._attributeFilter.set("showUnique",this.showUnique)),this._attributeFilter||(this._attributeFilter=new M({"class":"filterSegment",mapLayer:Q,version:Q.version,fields:Q.fields,part:"edit"===this.get("action")&&this.expression&&this.expression._attributeExprObj?this.expression._attributeExprObj:null,enableEvents:!0,isEnableInteractiveFilter:!1,allowAllDateTypes:!0,showUnique:this.showUnique},c.create("div",{},this._attrFilterDiv)),this._attributeFilter.fillFieldsList(this._attributeFilter.fieldsStore))):
(e.set(this._secondRow,"display","none"),e.set(this._attrFilterDiv,"display","none"),this._addBtn.set("disabled",!0))},_buildDistanceExpression:function(Q,K){this._addBtn.set("disabled",!this._distanceInput.validate());this._distanceInput.set("required",!0);e.set(this._secondRow,"display","");e.set(this._secondOperandSelect.domNode,"display","");e.set(this._secondExpressionDiv,{display:"",width:"75%"});e.set(this._secondOperandSelect,{display:"",width:"75%"});e.set(this._attrFilterDiv,"display","none");
this._secondOperandSelect&&this._secondOperandSelect.getOptions()&&-1===this.allLayersOpertors.indexOf(K)&&(this._secondOperandSelect.removeOption(this._secondOperandSelect.getOptions()),r.forEach(this.inputOperands,function(E,N){N.toString()!==this._firstOperandSelect.get("value")&&this._secondOperandSelect.addOption({value:N.toString(),label:E.name})},this),this._addBrowseAndBrowseLayerOptions(this._secondOperandSelect))},_handleAddButtonClick:function(Q){q.stop(Q);this._expressionForm&&!this._expressionForm.validate()?
this.emit("cancel-expression",{}):(this.set("expression"),this.emit("add-expression",{expression:this.get("expression"),text:this.get("text"),displayText:this.get("displayText"),action:this.get("action")}))},_handleCloseButtonClick:function(Q){q.stop(Q);this.emit("cancel-expression",{})},_setInputOperandsAttr:function(Q){this.inputOperands=Q},_getInputOperandsAttr:function(){return this.inputOperands},_setFirstOperandsAttr:function(Q){this.firstOperands=Q},_getFirstOperandsAttr:function(Q){return this.firstOperands},
_setSelectedFirstOperandAttr:function(Q){this.selectedFirstOperand=Q},_getExpressionAttr:function(Q){return this.expression},_setExpressionAttr:function(Q){var K=!1;if(Q)this._operatorSelect&&(this._firstOperandSelect.set("value",Q.layer),this._operatorSelect.set("value",Q.spatialRel?Q.spatialRel:"where"),"where"===this._operatorSelect.get("value")?K=!0:(-1!==r.indexOf(["withinDistance","notWithinDistance"],this._operatorSelect.get("value"))&&(this._distanceInput.set("value",Q.distance),this._distanceUnitsSelect.set("value",
Q.units)),setTimeout(n.hitch(this,function(){this._secondOperandSelect.set("value",Q.selectingLayer)}),100)));else if(Q={},this._operatorSelect)if(Q.layer=parseInt(this._firstOperandSelect.get("value"),10),"where"===this._operatorSelect.get("value")){var E=this._attributeFilter.toJson();var N=this._attributeFilter.builtSingleFilterString(E);Q._attributeFilter=N;Q._attributeExprObj=E;Q._attributeText=this._attributeFilter.buildFriendlyTextExpr(E);Q.where=N.whereClause}else Q.selectingLayer=parseInt(this._secondOperandSelect.get("value"),
10),Q.spatialRel=this._operatorSelect.get("value"),-1!==r.indexOf(["withinDistance","notWithinDistance"],this._operatorSelect.get("value"))&&(Q.distance=this._distanceInput.get("value"),Q.units=this._distanceUnitsSelect.get("value"));this.expression=Q;K&&this._handleOperatorChange("where")},_showMessages:function(Q){h.set(this._bodyNode,"innerHTML",Q);b.fadeIn({node:this._errorMessagePane,easing:v.quadIn,onEnd:n.hitch(this,function(){e.set(this._errorMessagePane,{display:""})})}).play()},_handleCloseMsg:function(Q){Q&&
Q.preventDefault();b.fadeOut({node:this._errorMessagePane,easing:v.quadOut,onEnd:n.hitch(this,function(){e.set(this._errorMessagePane,{display:"none"})})}).play()},_setActionAttr:function(Q){this.action=Q},_getActionAttr:function(){return this.action},_setTextAttr:function(Q){this.text=Q},_getTextAttr:function(){var Q="";this.expression&&(Q=this.inputOperands[this.expression.layer].name);this.expression.spatialRel?(Q+=" "+this.i18n[this.expression.spatialRel],this.expression.distance&&(Q+=" "+this.expression.distance+
" "+this.expression.units+" "+this.i18n.from),Q+=" "+this.inputOperands[this.expression.selectingLayer].name):Q+=" "+this.i18n.whereLabel+" "+this.expression._attributeText;return Q},_getDisplayTextAttr:function(){var Q="";if(this.expression){var K=this.inputOperands[this.expression.layer].name;Q+=this.shortenString(K)}this.expression.spatialRel?(Q+=" \x3clabel style\x3d'font-style: italic;'\x3e"+this.i18n[this.expression.spatialRel],this.expression.distance&&(Q+=" "+this.expression.distance+" "+
this.expression.units+" "+this.i18n.from),K=this.inputOperands[this.expression.selectingLayer].name,Q=Q+"\x3c/label\x3e "+this.shortenString(K)):Q+=" \x3clabel style\x3d'font-style: italic;'\x3e"+this.i18n.whereLabel+" "+this.expression._attributeText+"\x3c/label";return Q+"\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e"},shortenString:function(Q){return"\x3clabel style\x3d'overflow: hidden;text-overflow: ellipsis'\x3e"+Q+"\x3c/label\x3e\x3c/td\x3e"},_setPrimaryActionButttonClassAttr:function(Q){this.primaryActionButttonClass=
Q},_getPrimaryActionButttonClassAttr:function(){return this.primaryActionButttonClass},_setShowFirstRowAttr:function(Q){this.showFirstRow=Q},_getShowFirstRowAttr:function(){return this.showFirstRow},_setShowReadyToUseLayersAttr:function(Q){this._set("showReadyToUseLayers",Q)},_setShowReadyLayersForFirstAttr:function(Q){this._set("showReadyLayersForFirst",Q)},_setShowBrowseLayersAttr:function(Q){this._set("showBrowseLayers",Q)},_setOwningWidgetAttr:function(Q){this._set("owningWidget",Q)}});a("extend-esri")&&
n.setObject("dijit.analysis.ExpressionForm",H,la);return H})},"esri/dijit/analysis/CreditEstimator":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/_base/kernel dojo/has dojo/dom-construct dojo/dom-class dojo/dom-attr dojo/dom-style dojo/string dojo/number dijit/_WidgetBase dijit/_TemplatedMixin dijit/_OnDijitClickMixin dijit/_FocusMixin ../../kernel ../../lang dojo/i18n!../../nls/jsapi dojo/text!./templates/CreditEstimator.html".split(" "),function(H,
m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C){H=m([g,p,q,u],{declaredClass:"esri.dijit.analysis.CreditEstimator",i18n:null,templateString:C,postMixInProperties:function(){this.inherited(arguments);this.i18n={};n.mixin(this.i18n,y.common);n.mixin(this.i18n,y.analysisMsgCodes);n.mixin(this.i18n,y.creditEstimator)},postCreate:function(){this.inherited(arguments)},_setContentAttr:function(B){var F="";B.code&&!B.messageCode&&(B.messageCode=B.code);B.messageCode?(F=t.isDefined(this.i18n[B.messageCode])?this.i18n[B.messageCode]:
B.message,F=t.isDefined(B.params)?h.substitute(F,B.params):F,f.set(this._messageDiv,"display","block"),f.set(this._messageDiv,"innerHTML",F),e.set(this._table,"display","none")):(e.set(this._table,"display","table"),f.set(this._messageDiv,"display",t.isDefined(B.infoMessage)?"block":"none"),f.set(this._messageDiv,"innerHTML",t.isDefined(B.infoMessage)?B.infoMessage:""),t.isDefined(B.infoMessage)&&e.set(this._messageDiv,"margin-top","1em"),F=t.isDefined(B.cost)?B.cost:B.maximumCost,B.maximumCost&&
f.set(this._costLabelNode,"innerHTML",this.i18n.maxCreditsLabel),B.totalRecords?f.set(this._totalRecordsNode,"innerHTML",c.format(B.totalRecords,{locale:k.locale})):e.set(this._totalRecordsLabelNode,"display","none"),f.set(this._creditsReqNode,"innerHTML",c.format(F,{locale:k.locale})))},_setErrorContentAttr:function(B){e.set(this._table,"display","none");f.set(this._messageDiv,"innerHTML",B)}});b("extend-esri")&&n.setObject("dijit.analysis.CreditEstimator",H,v);return H})},"widgets/Visibility/js/geometryUtils":function(){define("esri/geometry/Point esri/geometry/Polyline esri/geometry/webMercatorUtils dojo/Deferred dojo/_base/array dojo/_base/lang esri/SpatialReference".split(" "),
function(H,m,n,r,l,k,b){var a={getProjectedGeometry:function(d,f,e){var h=new r;if(n.canProject(d,f)){var c=n.project(d,f);h.resolve(c)}else e.project([d],f,function(g){c=g[0];h.resolve(c)});return h.promise},getDestinationPoint:function(d,f,e){var h=d.x*Math.PI/180,c=f*Math.PI/180;f=Math.sin(c);c=Math.cos(c);var g=.9966471893352243*Math.tan(d.y*Math.PI/180);d=1/Math.sqrt(1+g*g);var p=g*d,q=Math.atan2(g,c);g=d*f;var u=1-g*g,v=2.7233160610984375E11*u/4.040829998465916E13,t=1+v/16384*(4096+v*(-768+
v*(320-175*v))),y=v/1024*(256+v*(-128+v*(74-47*v))),C=e/(6356752.314245*t),B=0;do{v=Math.cos(2*q+C);var F=Math.sin(C);var x=Math.cos(C);var w=y*F*(v+y/4*(x*(-1+2*v*v)-y/6*v*(-3+4*F*F)*(-3+4*v*v)));var A=C;C=e/(6356752.314245*t)+w}while(1E-12<Math.abs(C-A)&&200>++B);if(200<=B)return console.log("Formula failed to converge"),null;e=p*F-d*x*c;e=Math.atan2(p*x+d*F*c,.9966471893352243*Math.sqrt(g*g+e*e));u=2.0955066654848088E-4*u*(4+.003352810664775694*(4-3*u));h=(h+(Math.atan2(F*f,d*x-p*F*c)-.003352810664775694*
(1-u)*g*(C+u*F*(v+u*x*(-1+2*v*v))))+3*Math.PI)%(2*Math.PI)-Math.PI;e=180*e/Math.PI;h=180*h/Math.PI;return new H(h,e,new b(4326))},getInverseCalculations:function(d,f){var e=f.x*Math.PI/180-d.x*Math.PI/180,h=.9966471893352243*Math.tan(d.y*Math.PI/180);d=1/Math.sqrt(1+h*h);h*=d;var c=.9966471893352243*Math.tan(f.y*Math.PI/180);f=1/Math.sqrt(1+c*c);c*=f;var g=e,p=0;do{var q=Math.sin(g);var u=Math.cos(g);var v=f*q*f*q+(d*c-h*f*u)*(d*c-h*f*u);v=Math.sqrt(v);if(0==v)return{distance:0,initialBearing:0,finalBearing:0};
var t=h*c+d*f*u;var y=Math.atan2(v,t);var C=d*f*q/v;var B=1-C*C;var F=t-2*h*c/B;isNaN(F)&&(F=0);var x=2.0955066654848088E-4*B*(4+.003352810664775694*(4-3*B));var w=g;g=e+.003352810664775694*(1-x)*C*(y+x*v*(F+x*t*(-1+2*F*F)))}while(1E-12<Math.abs(g-w)&&200>++p);if(200<=p)return null;g=2.7233160610984375E11*B/4.040829998465916E13;p=g/1024*(256+g*(-128+g*(74-47*g)));e=Math.atan2(f*q,d*c-h*f*u);d=Math.atan2(d*q,-h*f+d*c*u);e=(e+2*Math.PI)%(2*Math.PI);d=(d+2*Math.PI)%(2*Math.PI);h=Number((6356752.314245*
(1+g/16384*(4096+g*(-768+g*(320-175*g))))*(y-p*v*(F+p/4*(t*(-1+2*F*F)-p/6*F*(-3+4*v*v)*(-3+4*F*F))))).toFixed(3));e=180*e/Math.PI;d=180*d/Math.PI;return{distance:h,initialBearing:e,finalBearing:d}},getLineBetweenPoints:function(d){var f,e=[];l.forEach(d,k.hitch(this,function(h){e.push([a.removeNegativeExponents(h.x),a.removeNegativeExponents(h.y)])}));0<e.length&&(f=new m({paths:[e],spatialReference:{wkid:4326}}));return f},getAngleBetweenPoints:function(d,f){d=a.getInverseCalculations(d,f);return null===
d?0:d.initialBearing},getDistanceBetweenPoints:function(d,f){d=a.getInverseCalculations(d,f);return null===d?0:d.distance},getPointsForArc:function(d,f,e,h){var c=[];var g=f-d;0>g&&(g=360+g);f=parseInt(g,10);0===f&&(f=1);var p=Math.abs(g)/Math.abs(f);if(0<p)for(g=0;g<Math.abs(f)+1;g++){var q=d+p*g;(q=a.getDestinationPoint(e,q,Math.abs(h)))&&c.push(q)}return c},removeNegativeExponents:function(d){return 1<d.toString().toLowerCase().split("e-").length?0:d}};return a})},"jimu/dijit/CoordinateControl":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang jimu/utils dojo/on dojo/has dojo/query dojo/dom-attr dojo/dom-class dojo/dom-style dojo/string dojo/topic dojo/keys dojo/Deferred dojo/Evented dojo/dom dojo/dom-construct dojo/aspect jimu/BaseWidget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/Tooltip dijit/TooltipDialog dijit/popup dojo/text!./templates/CoordinateControl.html esri/geometry/webMercatorUtils esri/graphic esri/geometry/Point esri/request esri/SpatialReference esri/tasks/GeometryService esri/tasks/ProjectParameters esri/toolbars/draw jimu/dijit/Message ./_CoordinateControlFormatNotation ./_CoordinateControlConfirmNotation jimu/portalUtils dojo/_base/sniff dijit/form/TextBox dijit/form/Textarea dijit/form/Select dijit/InlineEditBox".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w,A,z,G,J,L,R,T,aa,ca,ba,la,oa,fa){return H([t,y,C,p],{templateString:A,baseClass:"jimu-coordinate-control",parentWidget:null,input:!0,label:null,showCopyButton:!1,showFormatButton:!1,zoomScale:null,showDeleteButton:!0,showExpandButton:!0,showDrawPoint:!0,drawButtonLabel:null,drawToolTip:null,graphicsLayer:null,type:"DD",inputFromText:!0,addSign:!1,hasCustomLabel:!1,numberOfDecimals:null,postMixInProperties:function(){this.nls=window.jimuNls.coordinateControl;
this.isRenderIdForAttrs=!0},constructor:function(M){H.safeMixin(this,M);this.uid=M.id||B.getUniqueId("cc");null===this.parentWidget&&console.error("No parentWidget parameter supplied: Parameter is mandatory");null===this.label&&console.info("No label parameter supplied (optional): Coordinate Control will have no label");null===this.zoomScale&&console.info("No zoomScale parameter supplied (optional): Coordinate Control will have no zoom button");null===this.drawButtonLabel&&console.info("No drawButtonLabel parameter supplied (optional): Coordinate Control will have no draw button");
null===this.graphicsLayer&&console.info("No graphicsLayer parameter supplied: Input graphics will not be shown on map")},postCreate:function(){this._frmtdlg=new x({id:this.uid+"_formatCoordinateTooltip",content:new la({nls:this.nls,ct:this.type}),style:"width: 400px",onClose:n.hitch(this,this.popupDidClose)});v.after(this._frmtdlg,"onShow",n.hitch(this,function(){null!==this.numberOfDecimals?this._frmtdlg.content.significantDigitTextbox.set("value",this.numberOfDecimals):this._frmtdlg.content.significantDigitTextbox.set("value",
2);this._frmtdlg.content.frmtSelect.focus()}));v.after(this._frmtdlg,"onClose",n.hitch(this,function(){this.formatButton.focus()}));this.own(l(this._frmtdlg,"keydown",n.hitch(this,function(M){M.keyCode===c.ESCAPE&&w.close(this._frmtdlg)})));"DartTheme"===this.parentWidget.appConfig.theme.name&&d.add(this._frmtdlg.domNode,"coordinateControlDialog");this.defaultFormat&&(this._frmtdlg.content.formats[this.type].defaultFormat=this.defaultFormat);this._fetchPortalGeomSrvcUrl().then(n.hitch(this,function(M){""===
n.trim(M)&&(M=this.parentWidget.appConfig.geometryService);this.geomsrvc=new T(M);this.dt=new ca(this.parentWidget.map);this.initUI();this.setUIListeners()}))},_fetchPortalGeomSrvcUrl:function(){var M=new g;this.parentWidget.appConfig.portalUrl&&""!==n.trim(this.parentWidget.appConfig.portalUrl)?fa.getPortalSelfInfo(this.parentWidget.appConfig.portalUrl).then(n.hitch(this,function(X){X=X&&X.helperServices;var da="";X&&X.geometry&&X.geometry.url&&""!==X.geometry.url&&(da=X.geometry.url);M.resolve(da)}),
n.hitch(this,function(){M.resolve("")})):M.resolve("");return M.promise},initUI:function(){null===this.label?this.setHidden(this.coordNameContainer,!1):this.coordName.setValue(this.label);this.input?(this.zoomButton.parentNode.style.display="none",this.setHidden(this.expandButton,!0),this.setHidden(this.removeControlBtn,!0),this.coordName.set("disabled","disabled"),this.coordName.set("value",this.label+" ("+this._frmtdlg.content.ct+")"),this.showDrawPoint?(this.drawPointButton.title=this.drawButtonLabel,
null===this.drawToolTip&&(this.drawToolTip=this.nls.tooltip)):this.setHidden(this.drawPointButton,!0)):(this.coordtext.disabled=!0,this.coordtext.placeholder="",this.setHidden(this.drawPointButton,!0),this.showExpandButton||(this.setHidden(this.expandButton,!0),d.remove(this.domNode,"coordinateContainer"),d.add(this.domNode,"outputCoordinateContainer"),d.add(this.cpbtn,"outputCopyBtn"),this.coordtext.readOnly=!0),this.showDeleteButton||this.setHidden(this.removeControlBtn,!0));this.showCopyButton||
(this.setHidden(this.cpbtn,!0),d.add(this.cpbtn,"inputCopyBtn"),a.set(this.cpbtn,"title",this.nls.copyAll));this.showFormatButton||this.setHidden(this.formatButton,!0);null===this.zoomScale&&this.setHidden(this.zoomButton,!0);this.formatButton.title=this.input?this.nls.formatInput:this.nls.formatOutput;a.set(this.formatButton,"aria-label",this.formatButton.title)},setUIListeners:function(){this.input||h.subscribe("INPUTPOINTDIDCHANGE",n.hitch(this,this.mapWasClicked));h.subscribe("INPUTERROR",n.hitch(this,
this.inputError));h.subscribe("VALIDINPUT",n.hitch(this,function(M){this.toggleZoomButton(M)}));this.own(l(this.expandButton,"click",n.hitch(this,this.expandButtonWasClicked)));this.own(l(this.expandButton,"keydown",n.hitch(this,function(M){if(M.keyCode===c.ENTER||M.keyCode===c.SPACE)this.expandButtonWasClicked(M),M.preventDefault()})));this.own(l(this.zoomButton,"click",n.hitch(this,this.zoomButtonWasClicked)));this.own(l(this.zoomButton,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==
c.SPACE||this.zoomButtonWasClicked(M)})));this.own(l(this.coordName,"change",n.hitch(this,this.coordNameDidChange)));this.cpbtn.addEventListener("click",n.hitch(this,this.cpBtnWasClicked));this.own(l(this.cpbtn,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.cpBtnWasClicked(M)})));this.subVal1CpBtn.addEventListener("click",n.hitch(this,this.cpSubBtnWasClicked));this.own(l(this.subVal1CpBtn,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||
this.cpSubBtnWasClicked(M)})));this.subVal2CpBtn.addEventListener("click",n.hitch(this,this.cpSubBtnWasClicked));this.own(l(this.subVal2CpBtn,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.cpSubBtnWasClicked(M)})));this.subVal3CpBtn.addEventListener("click",n.hitch(this,this.cpSubBtnWasClicked));this.own(l(this.subVal3CpBtn,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.cpSubBtnWasClicked(M)})));this.subVal4CpBtn.addEventListener("click",
n.hitch(this,this.cpSubBtnWasClicked));this.own(l(this.subVal4CpBtn,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.cpSubBtnWasClicked(M)})));this.own(l(this.formatButton,"click",n.hitch(this,this.formatButtonWasClicked)));this.own(l(this.formatButton,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.formatButtonWasClicked(M)})));this.own(l(this.drawPointButton,"click",n.hitch(this,this.drawPointButtonWasClicked)));this.own(l(this.drawPointButton,
"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.drawPointButtonWasClicked(M)})));this.own(l(this.removeControlBtn,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.remove()})));this.own(l(this._frmtdlg.content.applyButton,"click",n.hitch(this,this.formatDialogApplyButtonClicked)));this.own(l(this._frmtdlg.content.applyButton,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||this.formatDialogApplyButtonClicked()})));
this.own(l(this._frmtdlg.content.cancelButton,"click",n.hitch(this,function(){w.close(this._frmtdlg)})));this.own(l(this._frmtdlg.content.cancelButton,"keydown",n.hitch(this,function(M){M.keyCode!==c.ENTER&&M.keyCode!==c.SPACE||w.close(this._frmtdlg)})));this.own(l(this.coordtext,"keydown",n.hitch(this,this.coordTextInputKeyWasPressed)));this.own(l(this.coordtext,"input",n.hitch(this,function(){this.currentClickPointDD=null;this.zoomButton.parentNode&&(this.zoomButton.parentNode.style.display="none");
this.emit("coordinates-deleted",{})})));this.own(this.geomsrvc.on("error",n.hitch(this,this.geomSrvcDidFail)));this.own(l(this.dt,"draw-complete",n.hitch(this,this.drawComplete)));this.own(v.after(this.parentWidget,"onClose",n.hitch(this,function(){this.input&&d.contains(this.drawPointButton,"drawPointBtn-active")&&this.deactivateDrawTool();this._frmtdlg&&this._frmtdlg.domNode.offsetParent&&"closed"===this.parentWidget.state&&w.close(this._frmtdlg)})));this.own(v.after(this.parentWidget,"onOpen",
n.hitch(this,function(){var M=this.parentWidget.getParent().getParent().domNode;this.own(l(M,"click",n.hitch(this,function(X){"settingBtn"!==X.target.className&&this._frmtdlg&&this._frmtdlg.domNode.offsetParent&&"active"===this.parentWidget.state&&w.close(this._frmtdlg)})))})))},formatDialogApplyButtonClicked:function(){this._frmtdlg.content.significantDigitTextbox.isValid()?(this.type=this._frmtdlg.content.ct,this.updateDisplay(),this.input?this.coordName.set("value",this.label+" ("+this._frmtdlg.content.ct+
")"):this.hasCustomLabel&&this.coordName.set("value",this.label),w.close(this._frmtdlg)):this._frmtdlg.content.significantDigitTextbox.focus()},popupDidClose:function(){if(this._frmtdlg.content.isCanceled)this.addSign!==this._frmtdlg.content.addSignChkBox.checked&&this._frmtdlg.content.addSignChkBox.setValue(this.addSign);else{this.addSign=this._frmtdlg.content.addSignChkBox.checked;this.numberOfDecimals=this._frmtdlg.content.significantDigitTextbox.value;var M=this._frmtdlg.content.ct;this.type!==
M&&(this.type=M,this.updateDisplay())}},coordNameDidChange:function(){this.hasCustomLabel=!0},cpSubBtnWasClicked:function(M){this[M.currentTarget.id.split("~")[0]].select();try{var X=document.execCommand("copy")}catch(da){X=!1}this.showToolTip(M.currentTarget.id,X?this.nls.copySuccessful:this.nls.copyFailed)},cpBtnWasClicked:function(M){M.preventDefault();if(this.input){M=B.toArray().filter(function(Q){return"jimu-coordinate-control"===Q.baseClass&&!Q.input});var X=M.map(function(Q){if(Q.coordtext)return Q.coordtext.value}).join("\r\n");
M=this.coordtext.value;this.coordtext.value=M+"\r\n"+X;this.selectText(this.coordtext);try{var da=document.execCommand("copy")}catch(Q){da=!1}this.coordtext.value=M}else{this.selectText(this.coordtext);try{da=document.execCommand("copy")}catch(Q){da=!1}}this.showToolTip(this.cpbtn.id,da?this.nls.copySuccessful:this.nls.copyFailed)},selectText:function(M){var X=document.getSelection();X.removeAllRanges();M.focus();var da=/Edge/.test(navigator.userAgent),Q=!!window.MSInputMethodContext&&!!document.documentMode;
if(k("ff")||k("chrome")||k("safari"))!this.input&&this.coordtext.disabled?(this.coordtext.disabled=!1,M.select(),this.coordtext.disabled=!0):M.select();da&&M.select();Q&&(da=document.createRange(),da.selectNode(M),X.addRange(da))},showToolTip:function(M,X){var da=q.byId(M);F.show(X,da);setTimeout(function(){F.hide(da)},1E3)},geomSrvcDidComplete:function(M){0>=M[0].length?(new ba({message:this.nls.parseCoordinatesError}),h.publish("INPUTERROR")):(this.currentClickPointDD=this.currentClickPoint=new J(M[0][0],
M[0][1],new R({wkid:4326})),this.input&&(this.currentClickPoint.spatialReference.equals(this.parentWidget.map.spatialReference)?this.parentWidget.map.centerAt(this.currentClickPoint):this.getProjectedPoint(this.currentClickPoint).then(n.hitch(this,function(X){this.currentClickPoint=X;this.parentWidget.map.centerAt(this.currentClickPoint)}),n.hitch(this,function(X){console.error(X);h.publish("INPUTERROR")})),this.updateDisplay(),h.publish("INPUTPOINTDIDCHANGE",{mapPoint:this.currentClickPointDD,inputFromText:!0}),
h.publish("VALIDINPUT",{show:!0})))},geomSrvcDidFail:function(){new ba({message:this.nls.parseCoordinatesError});h.publish("INPUTERROR")},coordTextInputKeyWasPressed:function(M){if(M.keyCode===c.ENTER){M.preventDefault();var X=this.getCleanInput(M.currentTarget.value);this.inputFromText=!1;this.getCoordinateType(X).then(n.hitch(this,function(da){if(da)if(1===da.length){var Q=this.processCoordTextInput(X,da[0],!1);this.getXYNotation(Q,da[0].conversionType).then(n.hitch(this,function(K){0<K[0].length?
this.geomSrvcDidComplete(K):this.geomSrvcDidFail()}))}else this.confirmNotationDialog||(this.confirmNotationDialog=new oa({title:this.nls.comfirmInputNotation,nls:this.nls,options:da,style:"width: 400px",hasSkipCheckBox:!1,theme:this.parentWidget.appConfig.theme.name})),this.confirmNotationDialog.show().then(n.hitch(this,function(){var K=m.filter(da,function(N){return N.name===this.confirmNotationDialog.comboOptions.get("value")},this),E=this.processCoordTextInput(X,K[0],!1);this.getXYNotation(E,
K[0].conversionType).then(n.hitch(this,function(N){0<N[0].length?this.geomSrvcDidComplete(N):this.geomSrvcDidFail()}))},function(){}));else new ba({message:this.nls.parseCoordinatesError}),h.publish("INPUTERROR")}));a.set(this.coordtext,"value",X);this.emit("get-coordinate-complete",X);this.currentClickPoint=null}if(M.keyCode===c.BACKSPACE||M.keyCode===c.DELETE)this.currentClickPointDD=null,this.zoomButton&&this.zoomButton.parentNode&&(this.zoomButton.parentNode.style.display="none"),this.emit("coordinates-deleted",
{})},getFormattedCoordinateText:function(){return this.coordtext.value},getCurrentMapCoordinate:function(){return this.currentClickPoint},getMapCoordinateDD:function(){return this.currentClickPointDD},deactivateDrawTool:function(){this.dt.deactivate();d.remove(this.drawPointButton,"drawPointBtn-active")},processCoordTextInput:function(M,X,da){var Q=X.pattern.exec(M),K=!1,E=X.name;switch(X.name){case "DD":var N=Q[2];var I=Q[7];var O=Q[10];var U=Q[16];var ha=Q[3].replace(/[,:]/,".");var ia=Q[11].replace(/[,:]/,
".");E="DD";break;case "DDrev":N=Q[11];I=Q[16];O=Q[2];U=Q[8];ha=Q[12].replace(/[,:]/,".");ia=Q[3].replace(/[,:]/,".");E="DD";break;case "DDM":N=Q[2];I=Q[7];O=Q[10];U=Q[15];ha=Q[3];var S=Q[4].replace(/[,:]/,".");ia=Q[11];var W=Q[12].replace(/[,:]/,".");E="DDM";break;case "DDMrev":N=Q[10];I=Q[15];O=Q[2];U=Q[7];ha=Q[11];S=Q[12].replace(/[,:]/,".");ia=Q[3];W=Q[4].replace(/[,:]/,".");E="DDM";break;case "DMS":N=Q[2];I=Q[8];O=Q[11];U=Q[17];ha=Q[3];S=Q[4];var ka=Q[5].replace(/[,:]/,".");ia=Q[12];W=Q[13];
var ja=Q[14].replace(/[,:]/,".");E="DMS";break;case "DMSrev":N=Q[11],I=Q[17],O=Q[2],U=Q[8],ha=Q[12],S=Q[13],ka=Q[14].replace(/[,:]/,"."),ia=Q[3],W=Q[4],ja=Q[5].replace(/[,:]/,"."),E="DMS"}N&&I?(K=!0,N=(new RegExp(/[Ss-]/)).test(N)?"-":"+"):N=N&&(new RegExp(/[Ss-]/)).test(N)?"-":I&&(new RegExp(/[Ss-]/)).test(I)?"-":"+";O&&U?(K=!0,O=(new RegExp(/[Ww-]/)).test(O)?"-":"+"):O=O&&(new RegExp(/[Ww-]/)).test(O)?"-":U&&(new RegExp(/[Ww-]/)).test(U)?"-":"+";K&&(da||new ba({message:this.nls.latLongWarningMessage}));
switch(E){case "DD":M=N+ha+","+O+ia;break;case "DDM":M=N+ha+" "+S+","+O+ia+" "+W;break;case "DMS":M=N+ha+" "+S+" "+ka+","+O+ia+" "+W+" "+ja}return M},zoomButtonWasClicked:function(){this.currentClickPoint&&(this.parentWidget.map.getZoom()<this.zoomScale?this.parentWidget.map.centerAt(this.currentClickPoint).then(n.hitch(this,function(){this.parentWidget.map.setScale(this.zoomScale)})):this.parentWidget.map.centerAt(this.currentClickPoint))},setHidden:function(M,X){f.set(M,"display","none");X&&u.destroy(M.parentNode)},
setVisible:function(M){f.set(M,"display","inline-flex")},remove:function(){this._frmtdlg&&this._frmtdlg.domNode.offsetParent&&w.close(this._frmtdlg);this.destroyRecursive();this.emit("removeCoordsControl")},mapWasClicked:function(M){this.currentClickPoint=M.mapPoint;this.getDDPoint(M.mapPoint).then(n.hitch(this,function(X){this.currentClickPointDDDD=this.currentClickPointDD=X;this.inputFromText=M.inputFromText?!0:!1;this.updateDisplay()}),n.hitch(this,function(X){console.error(X)}))},getDDPoint:function(M){var X=
new g,da=new R(3857);z.canProject(M,da)?X.resolve(z.webMercatorToGeographic(z.project(M,da))):(da={url:this.geomsrvc.url+"/findTransformations",content:{f:"json",inSR:JSON.stringify(M.spatialReference.toJson()),outSR:4326,extentOfInterest:JSON.stringify(this.parentWidget.map.extent)},handleAs:"json",callbackParamName:"callback"},(new L(da,{usePost:!1})).then(n.hitch(this,function(Q){Q=(Q=Q&&Q.transformations?Q.transformations:void 0)&&0<Q.length?Q[0].wkid:void 0;var K=new aa;K.outSR=new R(4326);K.geometries=
[M];K.transformForward=!0;K.transformation=Q;this.geomsrvc.project(K,n.hitch(this,function(E){X.resolve(E[0])}),function(E){X.reject(E)})}),n.hitch(this,function(Q){X.reject(Q)})));return X},getProjectedPoint:function(M){var X=new g;if(z.canProject(M,this.parentWidget.map))X.resolve(z.geographicToWebMercator(M));else{var da={url:this.geomsrvc.url+"/findTransformations",content:{f:"json",inSR:4326,outSR:JSON.stringify(this.parentWidget.map.spatialReference.toJson()),extentOfInterest:JSON.stringify(this.parentWidget.map.extent)},
handleAs:"json",callbackParamName:"callback"};(new L(da,{usePost:!1})).then(n.hitch(this,function(Q){Q=(Q=Q&&Q.transformations?Q.transformations:void 0)&&0<Q.length&&Q[0].geoTransforms&&0<Q[0].geoTransforms.length&&Q[0].geoTransforms[0].wkid?Q[0].geoTransforms[0].wkid:void 0;var K=new aa;K.outSR=new R(this.parentWidget.map.spatialReference);K.geometries=[M];K.transformForward=!0;K.transformation=Q;this.geomsrvc.project(K,n.hitch(this,function(E){X.resolve(E[0])}),function(E){X.reject(E)})}),n.hitch(this,
function(Q){X.reject(Q)}))}return X},expandButtonWasClicked:function(){d.toggle(this.coordcontrols,"expanded");d.contains(this.coordcontrols,"expanded")?(d.remove(this.expandButton,"expandBtn"),d.add(this.expandButton,"collapseBtn"),a.set(this.expandButton,"aria-expanded","true")):(d.remove(this.expandButton,"collapseBtn"),d.add(this.expandButton,"expandBtn"),a.set(this.expandButton,"aria-expanded","false"));this.setSubCoordUI(d.contains(this.coordcontrols,"expanded"));this._setCoordControlsTabindex(d.contains(this.coordcontrols,
"expanded"));this.emit("expandButtonClicked",d.contains(this.coordcontrols,"expanded"))},_setCoordControlsTabindex:function(M){var X=[];if(M){var da=0;M=-1}else da=-1,M=0;X=b("input[tabindex\x3d'"+M+"']",this.coordcontrols);X=X.concat(b("span[tabindex\x3d'"+M+"']",this.coordcontrols));m.forEach(X,n.hitch(this,function(Q){a.set(Q,"tabindex",da)}))},formatButtonWasClicked:function(){this._frmtdlg.content.setCt(this.type);w.open({popup:this._frmtdlg,around:this.formatButton})},drawPointButtonWasClicked:function(){if(d.contains(this.drawPointButton,
"drawPointBtn-active"))this.dt.deactivate(),this.parentWidget.map.enableMapNavigation();else{this.parentWidget.map.disableMapNavigation();this.dt.activate(ca.POINT);var M=this.dt._tooltip;M&&(M.innerHTML=this.drawToolTip)}d.toggle(this.drawPointButton,"drawPointBtn-active")},drawComplete:function(M){var X={};X.mapPoint=M.geometry;this.parentWidget.map.enableMapNavigation();this.mapWasClicked(X)},setSubCoordUI:function(M){if(M){M="165px";switch(this.type){case "DD":case "DMS":case "DDM":this.sub1label.innerHTML=
"Lat";this.sub2label.innerHTML="Lon";this.setHidden(this.sub3,!1);this.setHidden(this.sub4,!1);M="90px";break;case "GARS":this.sub1label.innerHTML="Lon";this.sub2label.innerHTML="Lat";this.sub3label.innerHTML="Quadrant";this.sub4label.innerHTML="Key";this.setVisible(this.sub3);this.setVisible(this.sub4);break;case "GEOREF":this.sub1label.innerHTML="15\u00b0 Quad";this.sub2label.innerHTML="1\u00b0 Quad";this.sub3label.innerHTML="Easting";this.setVisible(this.sub3);this.sub4label.innerHTML="Northing";
this.setVisible(this.sub4);break;case "USNG":case "MGRS":this.sub1label.innerHTML="GZD";this.sub2label.innerHTML="Grid Sq";this.sub3label.innerHTML="Easting";this.sub4label.innerHTML="Northing";this.setVisible(this.sub3);this.setVisible(this.sub4);break;case "UTM":this.sub1label.innerHTML="Zone";this.sub2label.innerHTML="Band";this.sub3label.innerHTML="Easting";this.sub4label.innerHTML="Northing";this.setVisible(this.sub3);this.setVisible(this.sub4);break;case "UTM_H":this.sub1label.innerHTML="Zone",
this.sub2label.innerHTML="Hemisphere",this.sub3label.innerHTML="Easting",this.sub4label.innerHTML="Northing",this.setVisible(this.sub3),this.setVisible(this.sub4)}f.set(this.coordcontrols,"display","block");f.set(this.coordcontrols,"height",M);f.set(this.coordcontrols,"width","300px")}else f.set(this.coordcontrols,"display","none"),f.set(this.coordcontrols,"height","0px");M=this.uid.split("_")[1];a.set(this["cc_"+M+"sub1val"],"aria-label",this.sub1label.innerHTML);a.set(this["cc_"+M+"sub2val"],"aria-label",
this.sub2label.innerHTML);a.set(this["cc_"+M+"sub3val"],"aria-label",this.sub3label.innerHTML);a.set(this["cc_"+M+"sub4val"],"aria-label",this.sub4label.innerHTML)},setCoordUI:function(M){if(M){var X=this.uid.split("_")[1];if(!this["cc_"+X+"sub1val"]||this.input&&this.inputFromText)return;var da=this._frmtdlg.content.formats[this.type];da=da.useCustom?da.customFormat:da.defaultFormat;switch(this.type){case "DD":M=this.getFormattedDDStr(M,da,this.addSign);this["cc_"+X+"sub1val"].value=e.substitute("${xcrd}",
{xcrd:M.latdeg});this["cc_"+X+"sub2val"].value=e.substitute("${ycrd}",{ycrd:M.londeg});var Q=M.formatResult;break;case "DDM":M=this.getFormattedDDMStr(M,da,this.addSign);this["cc_"+X+"sub1val"].value=e.substitute("${latd} ${latm}",{latd:M.latdeg,latm:M.latmin});this["cc_"+X+"sub2val"].value=e.substitute("${lond} ${lonm}",{lond:M.londeg,lonm:M.lonmin});Q=M.formatResult;break;case "DMS":M=this.getFormattedDMSStr(M,da,this.addSign);this["cc_"+X+"sub1val"].value=e.substitute("${latd} ${latm} ${lats}",
{latd:M.latdeg,latm:M.latmin,lats:M.latsec});this["cc_"+X+"sub2val"].value=e.substitute("${lond} ${lonm} ${lons}",{lond:M.londeg,lonm:M.lonmin,lons:M.lonsec});Q=M.formatResult;break;case "USNG":M=this.getFormattedUSNGStr(M,da,!1);this["cc_"+X+"sub1val"].value=M.gzd;this["cc_"+X+"sub2val"].value=M.grdsq;this["cc_"+X+"sub3val"].value=M.easting;this["cc_"+X+"sub4val"].value=M.northing;Q=M.formatResult;break;case "MGRS":M=this.getFormattedMGRSStr(M,da,!1);this["cc_"+X+"sub1val"].value=M.gzd;this["cc_"+
X+"sub2val"].value=M.grdsq;this["cc_"+X+"sub3val"].value=M.easting;this["cc_"+X+"sub4val"].value=M.northing;Q=M.formatResult;break;case "GARS":M=this.getFormattedGARSStr(M,da,!1);this["cc_"+X+"sub1val"].value=M.lon;this["cc_"+X+"sub2val"].value=M.lat;this["cc_"+X+"sub3val"].value=M.quadrant;this["cc_"+X+"sub4val"].value=M.key;Q=M.formatResult;break;case "GEOREF":M=this.getFormattedGEOREFStr(M,da,!1);this["cc_"+X+"sub1val"].value=M.lon+M.lat;this["cc_"+X+"sub2val"].value=M.quadrant15lon+M.quadrant15lat;
this["cc_"+X+"sub3val"].value=M.quadrant1lon;this["cc_"+X+"sub4val"].value=M.quadrant1lat;Q=M.formatResult;break;case "UTM":M=this.getFormattedUTMStr(M,da,!1);M.bandLetter.match(/^[AaBbYyZz]/)?(this["cc_"+X+"sub1val"].value="",this["cc_"+X+"sub2val"].value="",this["cc_"+X+"sub3val"].value="",this["cc_"+X+"sub4val"].value="",M.formatResult=""):(this["cc_"+X+"sub1val"].value=M.zone,this["cc_"+X+"sub2val"].value=M.bandLetter,this["cc_"+X+"sub3val"].value=M.easting,this["cc_"+X+"sub4val"].value=M.westing);
Q=M.formatResult;break;case "UTM_H":M=this.getFormattedUTMHStr(M,da,!1),M.hemisphere.match(/^[AaBbYyZz]/)?(this["cc_"+X+"sub1val"].value="",this["cc_"+X+"sub2val"].value="",this["cc_"+X+"sub3val"].value="",this["cc_"+X+"sub4val"].value="",M.formatResult=""):(this["cc_"+X+"sub1val"].value=M.zone,this["cc_"+X+"sub2val"].value=M.hemisphere,this["cc_"+X+"sub3val"].value=M.easting,this["cc_"+X+"sub4val"].value=M.westing),Q=M.formatResult}}else Q="";this.coordcontrols&&this.setSubCoordUI(d.contains(this.coordcontrols,
"expanded"));this.coordtext&&(a.set(this.coordtext,"value",Q),this.emit("get-coordinate-complete",Q))},getFormattedCoordinates:function(){this.getCoordValues(this.currentClickPointDD,this.type,4).then(n.hitch(this,function(M){this.setCoordUI(M)}),n.hitch(this,function(M){console.log(M)}))},updateDisplay:function(){this.currentClickPoint&&(this.currentClickPointDD||(this.currentClickPointDD=this.currentClickPoint),this.getFormattedCoordinates(this.currentClickPointDD),this.input&&(null!==this.graphicsLayer&&
(this.graphicsLayer.clear(),this.currentClickPoint.spatialReference.equals(this.parentWidget.map.spatialReference)?this.graphicsLayer.add(new G(this.currentClickPoint)):this.getProjectedPoint(this.currentClickPointDD).then(n.hitch(this,function(M){this.graphicsLayer.add(new G(M))}),n.hitch(this,function(M){console.error(M)}))),h.publish("INPUTPOINTDIDCHANGE",{mapPoint:this.currentClickPointDD,inputFromText:!0}),h.publish("VALIDINPUT",{show:!0})))},clear:function(){this.coordtext.value="";this.currentClickPointDDDD=
this.currentClickPointDD=this.currentClickPoint=null;this.graphicsLayer.clear()},inputError:function(){this.setCoordUI();this.toggleZoomButton(!1)},toggleZoomButton:function(M){this.zoomButton&&this.zoomButton.parentNode&&(this.zoomButton.parentNode.style.display=M?"inline-block":"none")},getCleanInput:function(M){M=M.replace(/\n/g,"");M=M.replace(/\s+/g," ").trim();return M.toUpperCase()},getCoordValues:function(M,X,da){var Q=new g;M={sr:4326,coordinates:[[M.x,M.y]],conversionType:X.name?X.name:
X,numOfDigits:da||6,rounding:!0,addSpaces:!1};switch(X){case "DD":M.numOfDigits=6;break;case "USNG":M.numOfDigits=5;break;case "MGRS":M.conversionMode="mgrsDefault";M.numOfDigits=5;break;case "UTM_H":M.conversionType="utm";M.conversionMode="utmNorthSouth";M.addSpaces=!0;break;case "UTM":M.conversionType="utm";M.conversionMode="utmDefault";M.addSpaces=!0;break;case "GARS":M.conversionMode="garsDefault"}this.geomsrvc.toGeoCoordinateString(M).then(function(K){Q.resolve(K)},function(){Q.resolve(null)});
return Q.promise},getXYNotation:function(M,X){var da=new g;var Q=X.name?X.name:X;X={sr:4326,conversionType:Q,strings:[]};switch(Q){case "DD":case "DDM":case "DMS":X.numOfDigits=2;M=M.replace(/[\u00b0\u02da\u00ba^~*"'\u2032\u00a8\u02dd]/g,"");X.strings.push(M);break;case "DDrev":X.conversionType="DD";X.numOfDigits=2;M=M.replace(/[\u00b0\u02da\u00ba^~*"'\u2032\u00a8\u02dd]/g,"");X.strings.push(M);break;case "DDMrev":X.conversionType="DDM";X.numOfDigits=2;M=M.replace(/[\u00b0\u02da\u00ba^~*"'\u2032\u00a8\u02dd]/g,
"");X.strings.push(M);break;case "DMSrev":X.conversionType="DMS";X.numOfDigits=2;M=M.replace(/[\u00b0\u02da\u00ba^~*"'\u2032\u00a8\u02dd]/g,"");X.strings.push(M);break;case "USNG":X.strings.push(M);X.addSpaces="false";break;case "MGRS":X.conversionMode="mgrsNewStyle";X.strings.push(M);X.addSpaces="false";break;case "UTM_H":X.conversionType="utm";X.conversionMode="utmNorthSouth";X.strings.push(M);break;case "UTM":X.conversionType="utm";X.conversionMode="utmDefault";X.strings.push(M);break;case "GARS":X.conversionMode=
"garsCenter";X.strings.push(M);break;case "GEOREF":X.strings.push(M)}this.geomsrvc.fromGeoCoordinateString(X).then(function(K){da.resolve(K)},function(){da.resolve(null)});return da.promise},getNotations:function(){return[{name:"DD",pattern:new RegExp([/^(([NS\+\-\s])*([0-8]?\d([,.]\d*)?|90([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([NS\+\-\s])*)([,:;\s|\/\\]+)/,/(([EW\+\-\s])*([0]?\d?\d([,.]\d*)?|1[0-7]\d([,.]\d*)?|180([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([EW\+\-\s])*)$/].map(function(M){return M.source}).join("")),
notationType:this.nls.DDLatLongNotation,conversionType:"DD"},{name:"DDrev",pattern:new RegExp([/^(([EW\+\-\s])*([0]?\d?\d([,.]\d*)?|1[0-7]\d([,.]\d*)?|180([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([EW\+\-\s])*)/,/([,:;\s|\/\\]+)(([NS\+\-\s])*([0-8]?\d([,.]\d*)?|90([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([NS\+\-\s])*)$/].map(function(M){return M.source}).join("")),notationType:this.nls.DDLongLatNotation,conversionType:"DD"},{name:"DDM",pattern:new RegExp([/^(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)['\u2032\s_]*([NS\+\-\s])*)/,
/([,:;\s|\/\\]+)/,/(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]\d|\d)([,.]\d*)?)['\u2032\s_]*([EW\+\-\s])*)/,/[\s]*$/].map(function(M){return M.source}).join("")),notationType:this.nls.DDMLatLongNotation,conversionType:"DDM"},{name:"DDMrev",pattern:new RegExp([/^(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]\d|\d)([,.]\d*)?)['\u2032\s_]*([EW\+\-\s])*)/,/([,:;\s|\/\\]+)/,/(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)['\u2032\s_]*([NS\+\-\s])*)[\s]*$/].map(function(M){return M.source}).join("")),
notationType:this.nls.DDMLongLatNotation,conversionType:"DDM"},{name:"DMS",pattern:new RegExp([/^(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]?\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([NS\+\-\s])*)/,/([,:;\s|\/\\]+)/,/(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([EW\+\-\s])*)[\s]*$/].map(function(M){return M.source}).join("")),notationType:this.nls.DMSLatLongNotation,
conversionType:"DMS"},{name:"DMSrev",pattern:new RegExp([/^(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([EW\+\-\s])*)/,/([,:;\s|\/\\]+)/,/(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]?\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([NS\+\-\s])*)[\s]*$/].map(function(M){return M.source}).join("")),notationType:this.nls.DMSLongLatNotation,conversionType:"DMS"},{name:"GARS",
pattern:/^\d{3}[a-zA-Z]{2}[1-4]?[1-9]?$/,notationType:this.nls.GARSNotation,conversionType:"GARS"},{name:"GEOREF",pattern:/^[a-zA-Z]{4}\d{1,8}$/,notationType:this.nls.GEOREFNotation,conversionType:"GEOREF"},{name:"MGRS",pattern:new RegExp([/^\d{1,2}[-,;:\s]*[C-HJ-NP-X][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*/,/(\d[-,;:\s]+\d|\d{2}[-,;:\s]+\d{2}|\d{3}[-,;:\s]+\d{3}|\d{4}[-,;:\s]+\d{4}|\d{5}[-,;:\s]+\d{5})/,/$|^(\d{1,2}[-,;:\s]*[C-HJ-NP-X][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*)/,/(\d{2}|\d{4}|\d{6}|\d{8}|\d{10})?$|^[ABYZ][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*/,
/(\d[-,;:\s]+\d|\d{2}[-,;:\s]+\d{2}|\d{3}[-,;:\s]+\d{3}|\d{4}[-,;:\s]+\d{4}|\d{5}[-,;:\s]+\d{5})/,/$|^[ABYZ][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*(\d{2}|\d{4}|\d{6}|\d{8}|\d{10})?$/].map(function(M){return M.source}).join("")),notationType:this.nls.MGRSNotation,conversionType:"MGRS"},{name:"UTM",pattern:new RegExp([/^\d{1,2}[-,;:\s]*[c-hj-np-xC-HJ-NP-X][-,;:\s]*\d{1,6}\.?\d*[mM]?[-,;:\s]?\d{1,7}\.?\d*[mM]?$/].map(function(M){return M.source}).join("")),notationType:this.nls.UTMBandNotation,conversionType:"UTM"},
{name:"UTM (H)",pattern:new RegExp([/^\d{1,2}[-,;:\s]*[NnSs][-,;:\s]*\d{1,6}\.?\d*[mM]?[-,;:\s]+\d{1,7}\.?\d*[mM]?$/].map(function(M){return M.source}).join("")),notationType:this.nls.UTMHemNotation,conversionType:"UTM_H"}]},getCoordinateType:function(M){var X=this.getCleanInput(M);M=new g;var da=this.getNotations();X=m.filter(da,function(Q){return Q.pattern.test(this.v)},{v:X});0<X.length?M.resolve(X):M.resolve(null);return M.promise},getFormattedDDStr:function(M,X,da){var Q={};Q.sourceValue=M;Q.sourceFormatString=
X;M=M[0].split(/[ ,]+/);Q.latdeg=M[0].replace(/[nNsS]/,"");Q.londeg=M[1].replace(/[eEwW]/,"");null!==this.numberOfDecimals?(Q.latdeg=r.localizeNumber(parseFloat(Q.latdeg),{places:this.numberOfDecimals}),Q.londeg=r.localizeNumber(parseFloat(Q.londeg),{places:this.numberOfDecimals})):(Q.latdeg=r.localizeNumber(parseFloat(Q.latdeg)),Q.londeg=r.localizeNumber(parseFloat(Q.londeg)));da&&("N"===M[0].slice(-1)?Q.latdeg="+"+Q.latdeg:Q.latdeg="-"+Q.latdeg,"W"===M[1].slice(-1)?Q.londeg="-"+Q.londeg:Q.londeg=
"+"+Q.londeg);X=X.replace(/X/,Q.londeg);X=X.replace(/[eEwW]/,M[1].slice(-1));X=X.replace(/[nNsS]/,M[0].slice(-1));X=X.replace(/Y/,Q.latdeg);Q.formatResult=X;return Q},getFormattedDDMStr:function(M,X,da){var Q={};Q.sourceValue=M;Q.sourceFormatString=X;Q.parts=M[0].split(/[ ,]+/);Q.latdeg=Q.parts[0];Q.latmin=Q.parts[1].replace(/[nNsS]/,"");Q.londeg=Q.parts[2];Q.lonmin=Q.parts[3].replace(/[eEwW]/,"");null!==this.numberOfDecimals?(Q.latmin=r.localizeNumber(parseFloat(Q.latmin),{places:this.numberOfDecimals}),
Q.lonmin=r.localizeNumber(parseFloat(Q.lonmin),{places:this.numberOfDecimals})):(Q.latmin=r.localizeNumber(parseFloat(Q.latmin)),Q.lonmin=r.localizeNumber(parseFloat(Q.lonmin)));da&&("N"===Q.parts[1].slice(-1)?Q.latdeg="+"+Q.latdeg:Q.latdeg="-"+Q.latdeg,"W"===Q.parts[3].slice(-1)?Q.londeg="-"+Q.londeg:Q.londeg="+"+Q.londeg);M=X.replace(/[EeWw]/,Q.parts[3].slice(-1));M=M.replace(/Y/,Q.lonmin);M=M.replace(/X/,Q.londeg);M=M.replace(/[NnSs]/,Q.parts[1].slice(-1));M=M.replace(/B/,Q.latmin);M=M.replace(/A/,
Q.latdeg);Q.formatResult=M;return Q},getFormattedDMSStr:function(M,X,da){var Q={};Q.sourceValue=M;Q.sourceFormatString=X;Q.parts=M[0].split(/[ ,]+/);Q.latdeg=Q.parts[0];Q.latmin=Q.parts[1];Q.latsec=Q.parts[2].replace(/[NnSs]/,"");Q.londeg=Q.parts[3];Q.lonmin=Q.parts[4];Q.latsec=null!==this.numberOfDecimals?r.localizeNumber(parseFloat(Q.latsec),{places:this.numberOfDecimals}):r.localizeNumber(parseFloat(Q.latsec));Q.parts[5]&&(Q.lonsec=Q.parts[5].replace(/[EWew]/,""),Q.lonsec=null!==this.numberOfDecimals?
r.localizeNumber(parseFloat(Q.lonsec),{places:this.numberOfDecimals}):r.localizeNumber(parseFloat(Q.lonsec)));da&&("N"===Q.parts[2].slice(-1)?Q.latdeg="+"+Q.latdeg:Q.latdeg="-"+Q.latdeg,"W"===Q.parts[5].slice(-1)?Q.londeg="-"+Q.londeg:Q.londeg="+"+Q.londeg);M=X.replace(/A/,Q.latdeg);M=M.replace(/B/,Q.latmin);M=M.replace(/C/,Q.latsec);M=M.replace(/X/,Q.londeg);M=M.replace(/Y/,Q.lonmin);M=M.replace(/Z/,Q.lonsec);M=M.replace(/[NnSs]/,Q.parts[2].slice(-1));Q.parts[5]&&(M=M.replace(/[EeWw]/,Q.parts[5].slice(-1)));
Q.formatResult=M;return Q},getFormattedUSNGStr:function(M,X){var da={};da.sourceValue=M;da.sourceFormatString=X;M[0].match(/^[ABYZ]/)?da.gzd=M[0].match(/[ABYZ]/)[0].trim():da.gzd=M[0].match(/\d{1,2}[C-HJ-NP-X]/)[0].trim();M[0].replace(da.gzd,"").match(/[a-hJ-zA-HJ-Z]{2}/)&&(da.grdsq=M[0].replace(da.gzd,"").match(/[a-hJ-zA-HJ-Z]{2}/)[0].trim());M[0].replace(da.gzd+da.grdsq,"").match(/^\d{1,5}/)&&(da.easting=M[0].replace(da.gzd+da.grdsq,"").match(/^\d{1,5}/)[0].trim());M[0].replace(da.gzd+da.grdsq,
"").match(/\d{1,5}$/)&&(da.northing=M[0].replace(da.gzd+da.grdsq,"").match(/\d{1,5}$/)[0].trim());M=X.replace(/Y/,da.northing);M=M.replace(/X/,da.easting);M=M.replace(/S/,da.grdsq);M=M.replace(/Z/,da.gzd);da.formatResult=M;return da},getFormattedMGRSStr:function(M,X){var da={};da.sourceValue=M;da.sourceFormatString=X;M[0].match(/^[ABYZ]/)?da.gzd=M[0].match(/[ABYZ]/)[0].trim():da.gzd=M[0].match(/\d{1,2}[C-HJ-NP-X]/)[0].trim();da.grdsq=M[0].replace(da.gzd,"").match(/[a-hJ-zA-HJ-Z]{2}/)[0].trim();da.easting=
M[0].replace(da.gzd+da.grdsq,"").match(/^\d{1,5}/)[0].trim();da.northing=M[0].replace(da.gzd+da.grdsq,"").match(/\d{1,5}$/)[0].trim();M=X.replace(/Y/,da.northing);M=M.replace(/X/,da.easting);M=M.replace(/S/,da.grdsq);M=M.replace(/Z/,da.gzd);da.formatResult=M;return da},getFormattedGARSStr:function(M,X){var da={};da.sourceValue=M;da.sourceFormatString=X;da.lon=M[0].match(/\d{3}/);da.lat=M[0].match(/[a-zA-Z]{2}/);M=M[0].match(/\d*$/);da.quadrant=M[0][0];da.key=M[0][1];X=X.replace(/K/,da.key);X=X.replace(/Q/,
da.quadrant);X=X.replace(/Y/,da.lat);X=X.replace(/X/,da.lon);da.formatResult=X;return da},getFormattedGEOREFStr:function(M,X){var da={};da.sourceValue=M;da.sourceFormatString=X;da.lon=M[0].match(/[a-zA-Z]{1}/)[0].trim();da.lat=M[0].replace(da.lon,"").match(/[a-zA-Z]{1}/)[0].trim();da.quadrant15lon=M[0].replace(da.lon+da.lat,"").match(/[a-zA-Z]{1}/)[0].trim();da.quadrant15lat=M[0].replace(da.lon+da.lat+da.quadrant15lon,"").match(/[a-zA-Z]{1}/)[0].trim();M=M[0].replace(da.lon+da.lat+da.quadrant15lon+
da.quadrant15lat,"");da.quadrant1lon=M.substr(0,M.length/2);da.quadrant1lat=M.substr(M.length/2,M.length);X=X.replace(/Y/,da.quadrant1lat);X=X.replace(/X/,da.quadrant1lon);X=X.replace(/D/,da.quadrant15lat);X=X.replace(/C/,da.quadrant15lon);X=X.replace(/B/,da.lat);X=X.replace(/A/,da.lon);da.formatResult=X;return da},getFormattedUTMStr:function(M,X){var da={};da.sourceValue=M;da.sourceFormatString=X;da.parts=M[0].split(/[ ,]+/);da.zone=da.parts[0].replace(/[A-Z]/,"");da.bandLetter=da.parts[0].slice(-1);
da.easting=da.parts[1];da.westing=da.parts[2];M=X.replace(/Y/,da.westing);M=M.replace(/X/,da.easting);M=M.replace(/B/,da.bandLetter);M=M.replace(/Z/,da.zone);da.formatResult=M;return da},getFormattedUTMHStr:function(M,X){var da={};da.sourceValue=M;da.sourceFormatString=X;da.parts=M[0].split(/[ ,]+/);da.zone=da.parts[0].replace(/[A-Z]/,"");da.hemisphere=da.parts[0].slice(-1);da.easting=da.parts[1];da.westing=da.parts[2];M=X.replace(/Y/,da.westing);M=M.replace(/X/,da.easting);M=M.replace(/H/,da.hemisphere);
M=M.replace(/Z/,da.zone);da.formatResult=M;return da}})})},"jimu/dijit/_CoordinateControlFormatNotation":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/on dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/formSelect jimu/dijit/CheckBox dijit/form/NumberSpinner".split(" "),function(H,m,n,r,l,k,b,a){return H([k,b,a],{baseClass:"jimu-coordinate-control",templateString:'\x3cdiv\x3e\x3cspan class\x3d"formatText"\x3e${nls.editCoordinateDialogTitle}\x3c/span\x3e\x3cdiv class\x3d"controlContainer"\x3e\x3cselect tabindex\x3d"0" class\x3d"selectFormat" data-dojo-attach-point\x3d"frmtSelect" aria-label\x3d"${nls.editCoordinateDialogTitle}" data-dojo-type\x3d"jimu/dijit/formSelect"\x3e\x3c/select\x3e\x3cinput tabindex\x3d"0" type\x3d"text" data-dojo-attach-point\x3d"frmtVal" class\x3d"formatInput"\x3e\x3c/input\x3e\x3cdiv class\x3d"settingsContainer" data-dojo-attach-point\x3d"prefixContainer"\x3e\x3cdiv class \x3d "esriCTSignificantDigitNode"\x3e\x3cdiv class\x3d"formatText esriCTSignificantDigitLabel"title \x3d"${nls.significantDigitLabel}"\x3e${nls.significantDigitLabel}\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"significantDigitTextbox" value\x3d"2" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d"constraints:{min:0,max:100,places:0}" aria-label\x3d"${nls.significantDigitLabel} style\x3d"width:50%"\x3e\x3c/div\x3e\x3c/div\x3e \x3cdiv class\x3d"formatText" data-dojo-attach-point\x3d"addSignChkBox" label\x3d"${nls.posNegPrefixLabel}" data-dojo-type\x3d"jimu/dijit/CheckBox"/\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"btnContainer"\x3e\x3cdiv tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.applyButtonLabel}" data-dojo-attach-point\x3d"applyButton" class\x3d"jimu-btn"\x3e${nls.applyButtonLabel}\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"cancelButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.cancelButtonLabel}" class\x3d"jimu-btn formatCoordCancelButton"\x3e${nls.cancelButtonLabel}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
isCanceled:!1,formats:{},setCt:function(d){this.ct=d;this.frmtSelect.set("value",this.ct)},postCreate:function(){this.formats={DD:{defaultFormat:"YN XE",customFormat:null,useCustom:!1},DDM:{defaultFormat:"A\u00b0 B'N X\u00b0 Y'E",customFormat:null,useCustom:!1},DMS:{defaultFormat:"A\u00b0 B' C\"N X\u00b0 Y' Z\"E",customFormat:null,useCustom:!1},GARS:{defaultFormat:"XYQK",customFormat:null,useCustom:!1},GEOREF:{defaultFormat:"ABCDXY",customFormat:null,useCustom:!1},MGRS:{defaultFormat:"ZSXY",customFormat:null,
useCustom:!1},USNG:{defaultFormat:"ZSXY",customFormat:null,useCustom:!1},UTM:{defaultFormat:"ZB X Y",customFormat:null,useCustom:!1},UTM_H:{defaultFormat:"ZH X Y",customFormat:null,useCustom:!1}};var d=[],f;for(f in this.formats){var e={value:f,label:this.nls.notations[f]};d.push(e)}this.frmtSelect.addOption(d);l.set(this.frmtVal,"value",this.formats[this.ct].defaultFormat);this.own(r(this.frmtSelect,"change",m.hitch(this,this.frmtSelectValueDidChange)));this.own(r(this.frmtVal,"change",m.hitch(this,
this.formatValDidChange)));this.own(r(this.cancelButton,"click",m.hitch(this,function(){this.isCanceled=!0})));this.own(r(this.applyButton,"click",m.hitch(this,function(){this.isCanceled=!1})));this.displayPrefixContainer()},formatValDidChange:function(){var d=l.get(this.frmtVal,"value"),f=this.frmtSelect.get("value");this.formats[f].customFormat=d;this.formats[f].useCustom=!0},frmtSelectValueDidChange:function(d){var f=this.formats[d].useCustom?this.formats[d].customFormat:this.formats[d].defaultFormat;
this.ct=d;l.set(this.frmtVal,"value",f);this.displayPrefixContainer()},displayPrefixContainer:function(){switch(this.ct){case "DD":case "DDM":case "DMS":n.set(this.prefixContainer,{display:""});break;default:n.set(this.prefixContainer,{display:"none"})}}})})},"jimu/dijit/_CoordinateControlConfirmNotation":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/aspect dojo/keys dojo/query dijit/Dialog dijit/form/Select dojo/_base/lang".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e){return H([d],{baseClass:"jimu-coordinate-control",numberOfInputs:0,selectOptions:{},comboOptions:{},dfd:null,constructor:function(h){e.mixin(this,h);this.numberOfInputs=h.options.length;this.selectOptions=h.options},postCreate:function(){this.inherited("postCreate",arguments);this.closable=!1;this.closeButtonNode.style.display="none";"DartTheme"===this.theme&&l.add(this.containerNode,"coordinateControlDialog");this.message=r.create("div",{style:"margin-bottom: 5px"},
this.containerNode,"first");this.message.innerHTML=this.numberOfInputs+" "+this.nls.multipleNotationLabel;this.comboOptions=new f({style:{width:"99%"},"aria-label":this.numberOfInputs+" "+this.nls.multipleNotationLabel},r.create("div",{},this.containerNode,"last"));this.own(k.after(this.comboOptions,"onChange",n.hitch(this,this._onComboOptionsChanged)));for(var h=0;h<this.selectOptions.length;h++)this.comboOptions.addOption({value:this.selectOptions[h].name,label:this.selectOptions[h].notationType});
this.buttonDiv=r.create("div",{"class":"buttonContainer",style:"margin-top:10px;"+(window.isRTL?"text-align:left":"text-align:right")},this.containerNode,"last");this.okButton=r.create("div",{innerHTML:this.nls.applyButtonLabel,"class":"jimu-btn",role:"button",tabindex:"0","aria-label":this.nls.applyButtonLabel,onclick:e.hitch(this,function(){this.hide();this.dfd.resolve()}),onkeypress:e.hitch(this,function(c){if(c.keyCode===b.ENTER||c.keyCode===b.SPACE)this.hide(),this.dfd.resolve()})},this.buttonDiv,
"first");this.cancelButton=r.create("div",{innerHTML:this.nls.cancelButtonLabel,"class":"jimu-btn",style:"margin: 0 5px 0 5px",role:"button",tabindex:"0","aria-label":this.nls.cancelButtonLabel,onclick:e.hitch(this,function(){this.hide();this.dfd.cancel()}),onkeypress:e.hitch(this,function(c){if(c.keyCode===b.ENTER||c.keyCode===b.SPACE)this.hide(),this.dfd.cancel()})},this.buttonDiv,"last")},show:function(){this.inherited("show",arguments);this.dfd=new m;var h=this._getDOMElement(".dijitSelectLabel",
this.comboOptions.domNode);h&&l.add(h,"dijitSelectLabelConfirmNotation");return this.dfd},_onComboOptionsChanged:function(){var h=this._getDOMElement(".dijitSelectLabel",this.comboOptions.domNode);h&&l.add(h,"dijitSelectLabelConfirmNotation")},_getDOMElement:function(h,c){return(h=a(h,c))&&1===h.length?h[0]:null}})})},"dijit/form/Textarea":function(){define(["dojo/_base/declare","dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(H,m,n,r){return H("dijit.form.Textarea",[r,n],
{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",buildRendering:function(){this.inherited(arguments);m.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),function(H,m,n,r,l,k,b){n.add("textarea-needs-help-shrinking",
function(){var a=k.body(),d=m.create("textarea",{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},a,"last"),f=d.scrollHeight>=d.clientHeight;a.removeChild(d);return f});return H("dijit.form._ExpandingTextAreaMixin",null,{_setValueAttr:function(){this.inherited(arguments);
this.resize()},postCreate:function(){this.inherited(arguments);var a=this.textbox;a.style.overflowY="hidden";this.own(l(a,"focus, resize",r.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);this.own(b.on("resize",r.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(a){this.inherited(arguments);this.resize()},_estimateHeight:function(){var a=this.textbox;a.rows=(a.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},resize:function(){function a(){var q=
!1;""===d.value&&(d.value=" ",q=!0);var u=d.scrollHeight;q&&(d.value="");return u}var d=this.textbox;"hidden"==d.style.overflowY&&(d.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(a()||d.offsetHeight){var f=a()+Math.max(d.offsetHeight-d.clientHeight,0),e=f+"px";e!=d.style.height&&(d.style.height=e,d.rows=1);if(n("textarea-needs-help-shrinking")){var h=a(),c=d.style.minHeight,g=4,p=d.scrollTop;d.style.minHeight=e;for(d.style.height="auto";0<f;){d.style.minHeight=Math.max(f-g,4)+"px";e=
a();h-=e;f-=h;if(h<g)break;h=e;g<<=1}d.style.height=f+"px";d.style.minHeight=c;d.scrollTop=p}d.style.overflowY=a()>d.clientHeight?"auto":"hidden";"hidden"==d.style.overflowY&&(d.scrollTop=0)}else this._estimateHeight();this.busyResizing=!1}}})})},"dijit/InlineEditBox":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/i18n dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/when ./a11yclick ./focus ./_Widget ./_TemplatedMixin ./_WidgetsInTemplateMixin ./_Container ./form/Button ./form/_TextBoxMixin ./form/TextBox dojo/text!./templates/InlineEditBox.html dojo/i18n!./nls/common".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x,w){t=r("dijit._InlineEditor",[v,t,y],{templateString:w,contextRequire:H,postMixInProperties:function(){this.inherited(arguments);this.messages=d.getLocalization("dijit","common",this.lang);m.forEach(["buttonSave","buttonCancel"],function(A){this[A]||(this[A]=this.messages[A])},this)},buildRendering:function(){this.inherited(arguments);var A="string"==typeof this.editor?h.getObject(this.editor)||H(this.editor):this.editor,z=this.sourceStyle,
G="line-height:"+z.lineHeight+";",J=a.getComputedStyle(this.domNode);m.forEach(["Weight","Family","Size","Style"],function(R){J["font"+R]!=z["font"+R]&&(G+="font-"+R+":"+z["font"+R]+";")},this);m.forEach("marginTop marginBottom marginLeft marginRight position left top right bottom float clear display".split(" "),function(R){this.domNode.style[R]=z[R]},this);var L=this.inlineEditBox.width;"100%"==L?(G+="width:100%;",this.domNode.style.display="block"):G+="width:"+(L+(Number(L)==L?"px":""))+";";L=h.delegate(this.inlineEditBox.editorParams,
{style:G,dir:this.dir,lang:this.lang,textDir:this.textDir});this.editWidget=new A(L,this.editorPlaceholder);this.inlineEditBox.autoSave&&(this.saveButton.destroy(),this.cancelButton.destroy(),this.saveButton=this.cancelButton=null,b.destroy(this.buttonContainer))},postCreate:function(){this.inherited(arguments);var A=this.editWidget;this.inlineEditBox.autoSave?this.own(n.after(A,"onChange",h.hitch(this,"_onChange"),!0),c(A,"keydown",h.hitch(this,"_onKeyDown"))):"intermediateChanges"in A&&(A.set("intermediateChanges",
!0),this.own(n.after(A,"onChange",h.hitch(this,"_onIntermediateChange"),!0)),this.saveButton.set("disabled",!0))},startup:function(){this.editWidget.startup();this.inherited(arguments)},_onIntermediateChange:function(){this.saveButton.set("disabled",this.getValue()==this._resetValue||!this.enableSave())},destroy:function(){this.editWidget.destroy(!0);this.inherited(arguments)},getValue:function(){var A=this.editWidget;return String(A.get("displayedValue"in A||"_getDisplayedValueAttr"in A?"displayedValue":
"value"))},_onKeyDown:function(A){this.inlineEditBox.autoSave&&this.inlineEditBox.editing&&!A.altKey&&!A.ctrlKey&&(A.keyCode==e.ESCAPE?(A.stopPropagation(),A.preventDefault(),this.cancel(!0)):A.keyCode==e.ENTER&&"INPUT"==A.target.tagName&&(A.stopPropagation(),A.preventDefault(),this._onChange()))},_onBlur:function(){this.inherited(arguments);this.inlineEditBox.autoSave&&this.inlineEditBox.editing&&(this.getValue()==this._resetValue?this.cancel(!1):this.enableSave()&&this.save(!1))},_onChange:function(){this.inlineEditBox.autoSave&&
this.inlineEditBox.editing&&this.enableSave()&&u.focus(this.inlineEditBox.displayNode)},enableSave:function(){return this.editWidget.isValid?this.editWidget.isValid():!0},focus:function(){this.editWidget.focus();this.editWidget.focusNode&&(u._onFocusNode(this.editWidget.focusNode),"INPUT"==this.editWidget.focusNode.tagName&&this.defer(function(){F.selectInputText(this.editWidget.focusNode)}))}});v=r("dijit.InlineEditBox"+(g("dojo-bidi")?"_NoBidi":""),v,{editing:!1,autoSave:!0,buttonSave:"",buttonCancel:"",
renderAsHtml:!1,editor:x,editorWrapper:t,editorParams:{},disabled:!1,onChange:function(){},onCancel:function(){},width:"100%",value:"",noValueIndicator:6>=g("ie")?"\x3cspan style\x3d'font-family: wingdings; text-decoration: underline;'\x3e\x26#160;\x26#160;\x26#160;\x26#160;\x26#x270d;\x26#160;\x26#160;\x26#160;\x26#160;\x3c/span\x3e":"\x3cspan style\x3d'text-decoration: underline;'\x3e\x26#160;\x26#160;\x26#160;\x26#160;\x26#x270d;\x26#160;\x26#160;\x26#160;\x26#160;\x3c/span\x3e",constructor:function(){this.editorParams=
{}},postMixInProperties:function(){this.inherited(arguments);this.displayNode=this.srcNodeRef;this.own(c(this.displayNode,q,h.hitch(this,"_onClick")),c(this.displayNode,"mouseover, focus",h.hitch(this,"_onMouseOver")),c(this.displayNode,"mouseout, blur",h.hitch(this,"_onMouseOut")));this.displayNode.setAttribute("role","button");this.displayNode.getAttribute("tabIndex")||this.displayNode.setAttribute("tabIndex",0);this.value||"value"in this.params||(this.value=h.trim(this.renderAsHtml?this.displayNode.innerHTML:
this.displayNode.innerText||this.displayNode.textContent||""));this.value||(this.displayNode.innerHTML=this.noValueIndicator);k.add(this.displayNode,"dijitInlineEditBoxDisplayMode")},setDisabled:function(A){f.deprecated("dijit.InlineEditBox.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",A)},_setDisabledAttr:function(A){this.domNode.setAttribute("aria-disabled",A?"true":"false");A?this.displayNode.removeAttribute("tabIndex"):this.displayNode.setAttribute("tabIndex",
0);k.toggle(this.displayNode,"dijitInlineEditBoxDisplayModeDisabled",A);this._set("disabled",A)},_onMouseOver:function(){this.disabled||k.add(this.displayNode,"dijitInlineEditBoxDisplayModeHover")},_onMouseOut:function(){k.remove(this.displayNode,"dijitInlineEditBoxDisplayModeHover")},_onClick:function(A){this.disabled||(A&&(A.stopPropagation(),A.preventDefault()),this._onMouseOut(),this.defer("edit"))},edit:function(){if(!this.disabled&&!this.editing){this._set("editing",!0);this._savedTabIndex=
l.get(this.displayNode,"tabIndex")||"0";if(!this.wrapperWidget){var A=b.create("span",null,this.domNode,"before");this.wrapperWidget=new ("string"==typeof this.editorWrapper?h.getObject(this.editorWrapper):this.editorWrapper)({value:this.value,buttonSave:this.buttonSave,buttonCancel:this.buttonCancel,dir:this.dir,lang:this.lang,tabIndex:this._savedTabIndex,editor:this.editor,inlineEditBox:this,sourceStyle:a.getComputedStyle(this.displayNode),save:h.hitch(this,"save"),cancel:h.hitch(this,"cancel"),
textDir:this.textDir},A);this.wrapperWidget._started||this.wrapperWidget.startup();this._started||this.startup()}var z=this.wrapperWidget;k.add(this.displayNode,"dijitOffScreen");k.remove(z.domNode,"dijitOffScreen");a.set(z.domNode,{visibility:"visible"});l.set(this.displayNode,"tabIndex","-1");var G=z.editWidget,J=this;p(G.onLoadDeferred,h.hitch(z,function(){G.set("displayedValue"in G||"_setDisplayedValueAttr"in G?"displayedValue":"value",J.value);this.defer(function(){z.saveButton&&z.saveButton.set("disabled",
"intermediateChanges"in G);this.focus();this._resetValue=this.getValue()})}))}},_onBlur:function(){this.inherited(arguments)},destroy:function(){this.wrapperWidget&&!this.wrapperWidget._destroyed&&(this.wrapperWidget.destroy(),delete this.wrapperWidget);this.inherited(arguments)},_showText:function(A){var z=this.wrapperWidget;a.set(z.domNode,{visibility:"hidden"});k.add(z.domNode,"dijitOffScreen");k.remove(this.displayNode,"dijitOffScreen");l.set(this.displayNode,"tabIndex",this._savedTabIndex);A&&
u.focus(this.displayNode)},save:function(A){if(!this.disabled&&this.editing){this._set("editing",!1);var z=this.wrapperWidget.getValue();this.set("value",z);this._showText(A)}},setValue:function(A){f.deprecated("dijit.InlineEditBox.setValue() is deprecated.  Use set('value', ...) instead.","","2.0");return this.set("value",A)},_setValueAttr:function(A){A=h.trim(A);var z=this.renderAsHtml?A:A.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;").replace(/\n/g,
"\x3cbr\x3e");this.displayNode.innerHTML=this.editorParams&&"password"===this.editorParams.type?"********":z||this.noValueIndicator;this._set("value",A);this._started&&this.defer(function(){this.onChange(A)})},getValue:function(){f.deprecated("dijit.InlineEditBox.getValue() is deprecated.  Use get('value') instead.","","2.0");return this.get("value")},cancel:function(A){!this.disabled&&this.editing&&(this._set("editing",!1),this.defer("onCancel"),this._showText(A))}});g("dojo-bidi")&&(v=r("dijit.InlineEditBox",
v,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.displayNode)}}));v._InlineEditor=t;return v})},"widgets/Visibility/js/util":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/Deferred","esri/tasks/GeometryService"],function(H,m,n,r){return H(null,{constructor:function(l){this.appConfig=l.appConfig;this.nls=l.nls;(l=this.appConfig.geometryService)||(l="//utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer");this.geomService=new r(l)},
getCleanInput:function(l){l=l.replace(/\n/g,"");l=l.replace(/\s+/g," ").trim();return l.toUpperCase()},getCoordValues:function(l,k,b){var a=new n;l={sr:4326,coordinates:[[l.x,l.y]],conversionType:k.name?k.name:k,numOfDigits:b||6,rounding:!0,addSpaces:!1};switch(k){case "DD":l.numOfDigits=6;break;case "USNG":l.numOfDigits=5;break;case "MGRS":l.conversionMode="mgrsDefault";l.numOfDigits=5;break;case "UTM (H)":l.conversionType="utm";l.conversionMode="utmNorthSouth";l.addSpaces=!0;break;case "UTM":l.conversionType=
"utm";l.conversionMode="utmDefault";l.addSpaces=!0;break;case "GARS":l.conversionMode="garsDefault"}this.geomService.toGeoCoordinateString(l).then(function(d){a.resolve(d)},function(){a.resolve(null)});return a.promise},getXYNotation:function(l,k){var b=new n;var a=k.name?k.name:k;k={sr:4326,conversionType:a,strings:[]};switch(a){case "DD":case "DDM":case "DMS":k.numOfDigits=2;l=l.replace(/[\u00b0\u02da\u00ba^~*"'\u2032\u00a8\u02dd]/g,"");k.strings.push(l);break;case "USNG":k.strings.push(l);k.addSpaces=
"false";break;case "MGRS":k.conversionMode="mgrsNewStyle";k.strings.push(l);k.addSpaces="false";break;case "UTM (H)":k.conversionType="utm";k.conversionMode="utmNorthSouth";k.strings.push(l);break;case "UTM":k.conversionType="utm";k.conversionMode="utmDefault";k.strings.push(l);break;case "GARS":k.conversionMode="garsCenter";k.strings.push(l);break;case "GEOREF":k.strings.push(l)}this.geomService.fromGeoCoordinateString(k).then(function(d){b.resolve(d)},function(){b.resolve(null)});return b.promise},
getNotations:function(){return[{name:"DD",pattern:new RegExp([/^(([NS\+\-\s])*([0-8]?\d([,.]\d*)?|90([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([NS\+\-\s])*)([,:;\s|\/\\]+)/,/(([EW\+\-\s])*([0]?\d?\d([,.]\d*)?|1[0-7]\d([,.]\d*)?|180([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([EW\+\-\s])*)$/].map(function(l){return l.source}).join("")),notationType:this.nls.DDLatLongNotation,conversionType:"DD"},{name:"DDrev",pattern:new RegExp([/^(([EW\+\-\s])*([0]?\d?\d([,.]\d*)?|1[0-7]\d([,.]\d*)?|180([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([EW\+\-\s])*)/,
/([,:;\s|\/\\]+)(([NS\+\-\s])*([0-8]?\d([,.]\d*)?|90([,.]0*)?)([\u00b0\u02da\u00ba^~*]*)([NS\+\-\s])*)$/].map(function(l){return l.source}).join("")),notationType:this.nls.DDLongLatNotation,conversionType:"DD"},{name:"DDM",pattern:new RegExp([/^(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)['\u2032\s_]*([NS\+\-\s])*)/,/([,:;\s|\/\\]+)/,/(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]\d|\d)([,.]\d*)?)['\u2032\s_]*([EW\+\-\s])*)/,/[\s]*$/].map(function(l){return l.source}).join("")),
notationType:this.nls.DDMLatLongNotation,conversionType:"DDM"},{name:"DDMrev",pattern:new RegExp([/^(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]\d|\d)([,.]\d*)?)['\u2032\s_]*([EW\+\-\s])*)/,/([,:;\s|\/\\]+)/,/(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)['\u2032\s_]*([NS\+\-\s])*)[\s]*$/].map(function(l){return l.source}).join("")),notationType:this.nls.DDMLongLatNotation,conversionType:"DDM"},{name:"DMS",pattern:new RegExp([/^(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]?\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([NS\+\-\s])*)/,
/([,:;\s|\/\\]+)/,/(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([EW\+\-\s])*)[\s]*$/].map(function(l){return l.source}).join("")),notationType:this.nls.DMSLatLongNotation,conversionType:"DMS"},{name:"DMSrev",pattern:new RegExp([/^(([EW\+\-\s])*([0]?\d?\d|1[0-7]\d|180)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([EW\+\-\s])*)/,/([,:;\s|\/\\]+)/,/(([NS\+\-\s])*([0-8]?\d|90)[\u00b0\u02da\u00ba^~*\s\-_]+([0-5]?\d|\d)['\u2032\s\-_]+(([0-5]?\d|\d)([,.]\d*)?)["\u00a8\u02dd\s_]*([NS\+\-\s])*)[\s]*$/].map(function(l){return l.source}).join("")),
notationType:this.nls.DMSLongLatNotation,conversionType:"DMS"},{name:"GARS",pattern:/^\d{3}[a-zA-Z]{2}[1-4]?[1-9]?$/,notationType:this.nls.GARSNotation,conversionType:"GARS"},{name:"GEOREF",pattern:/^[a-zA-Z]{4}\d{1,8}$/,notationType:this.nls.GEOREFNotation,conversionType:"GEOREF"},{name:"MGRS",pattern:new RegExp([/^\d{1,2}[-,;:\s]*[C-HJ-NP-X][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*/,/(\d[-,;:\s]+\d|\d{2}[-,;:\s]+\d{2}|\d{3}[-,;:\s]+\d{3}|\d{4}[-,;:\s]+\d{4}|\d{5}[-,;:\s]+\d{5})/,/$|^(\d{1,2}[-,;:\s]*[C-HJ-NP-X][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*)/,
/(\d{2}|\d{4}|\d{6}|\d{8}|\d{10})?$|^[ABYZ][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*/,/(\d[-,;:\s]+\d|\d{2}[-,;:\s]+\d{2}|\d{3}[-,;:\s]+\d{3}|\d{4}[-,;:\s]+\d{4}|\d{5}[-,;:\s]+\d{5})/,/$|^[ABYZ][-,;:\s]*[A-HJ-NP-Z]{2}[-,;:\s]*(\d{2}|\d{4}|\d{6}|\d{8}|\d{10})?$/].map(function(l){return l.source}).join("")),notationType:this.nls.MGRSNotation,conversionType:"MGRS"},{name:"UTM",pattern:new RegExp([/^\d{1,2}[-,;:\s]*[c-hj-np-xC-HJ-NP-X][-,;:\s]*\d{1,6}\.?\d*[mM]?[-,;:\s]?\d{1,7}\.?\d*[mM]?$/].map(function(l){return l.source}).join("")),
notationType:this.nls.UTMBandNotation,conversionType:"UTM"},{name:"UTM (H)",pattern:new RegExp([/^\d{1,2}[-,;:\s]*[NnSs][-,;:\s]*\d{1,6}\.?\d*[mM]?[-,;:\s]+\d{1,7}\.?\d*[mM]?$/].map(function(l){return l.source}).join("")),notationType:this.nls.UTMHemNotation,conversionType:"UTM (H)"}]},getCoordinateType:function(l){var k=this.getCleanInput(l);l=new n;var b=this.getNotations();k=m.filter(b,function(a){return a.pattern.test(this.v)},{v:k});0<k.length?l.resolve(k):l.resolve(null);return l.promise},getFormattedDDStr:function(l,
k,b){var a={};a.sourceValue=l;a.sourceFormatString=k;l=l[0].split(/[ ,]+/);a.latdeg=l[0].replace(/[nNsS]/,"");a.londeg=l[1].replace(/[eEwW]/,"");b&&(a.latdeg="N"===l[0].slice(-1)?"+"+a.latdeg:"-"+a.latdeg,a.londeg="W"===l[1].slice(-1)?"-"+a.londeg:"+"+a.londeg);k=k.replace(/X/,a.londeg);k=k.replace(/[eEwW]/,l[1].slice(-1));k=k.replace(/[nNsS]/,l[0].slice(-1));k=k.replace(/Y/,a.latdeg);a.formatResult=k;return a},getFormattedDDMStr:function(l,k,b){var a={};a.sourceValue=l;a.sourceFormatString=k;a.parts=
l[0].split(/[ ,]+/);a.latdeg=a.parts[0];a.latmin=a.parts[1].replace(/[nNsS]/,"");a.londeg=a.parts[2];a.lonmin=a.parts[3].replace(/[eEwW]/,"");b&&(a.latdeg="N"===a.parts[1].slice(-1)?"+"+a.latdeg:"-"+a.latdeg,a.londeg="W"===a.parts[3].slice(-1)?"-"+a.londeg:"+"+a.londeg);l=k.replace(/[EeWw]/,a.parts[3].slice(-1));l=l.replace(/Y/,a.lonmin);l=l.replace(/X/,a.londeg);l=l.replace(/[NnSs]/,a.parts[1].slice(-1));l=l.replace(/B/,a.latmin);l=l.replace(/A/,a.latdeg);a.formatResult=l;return a},getFormattedDMSStr:function(l,
k,b){var a={};a.sourceValue=l;a.sourceFormatString=k;a.parts=l[0].split(/[ ,]+/);a.latdeg=a.parts[0];a.latmin=a.parts[1];a.latsec=a.parts[2].replace(/[NnSs]/,"");a.londeg=a.parts[3];a.lonmin=a.parts[4];a.lonsec=a.parts[5].replace(/[EWew]/,"");b&&(a.latdeg="N"===a.parts[2].slice(-1)?"+"+a.latdeg:"-"+a.latdeg,a.londeg="W"===a.parts[5].slice(-1)?"-"+a.londeg:"+"+a.londeg);l=k.replace(/A/,a.latdeg);l=l.replace(/B/,a.latmin);l=l.replace(/C/,a.latsec);l=l.replace(/X/,a.londeg);l=l.replace(/Y/,a.lonmin);
l=l.replace(/Z/,a.lonsec);l=l.replace(/[NnSs]/,a.parts[2].slice(-1));l=l.replace(/[EeWw]/,a.parts[5].slice(-1));a.formatResult=l;return a},getFormattedUSNGStr:function(l,k){var b={};b.sourceValue=l;b.sourceFormatString=k;l[0].match(/^[ABYZ]/)?b.gzd=l[0].match(/[ABYZ]/)[0].trim():b.gzd=l[0].match(/\d{1,2}[C-HJ-NP-X]/)[0].trim();b.grdsq=l[0].replace(b.gzd,"").match(/[a-hJ-zA-HJ-Z]{2}/)[0].trim();b.easting=l[0].replace(b.gzd+b.grdsq,"").match(/^\d{1,5}/)[0].trim();b.northing=l[0].replace(b.gzd+b.grdsq,
"").match(/\d{1,5}$/)[0].trim();l=k.replace(/Y/,b.northing);l=l.replace(/X/,b.easting);l=l.replace(/S/,b.grdsq);l=l.replace(/Z/,b.gzd);b.formatResult=l;return b},getFormattedMGRSStr:function(l,k){var b={};b.sourceValue=l;b.sourceFormatString=k;l[0].match(/^[ABYZ]/)?b.gzd=l[0].match(/[ABYZ]/)[0].trim():b.gzd=l[0].match(/\d{1,2}[C-HJ-NP-X]/)[0].trim();b.grdsq=l[0].replace(b.gzd,"").match(/[a-hJ-zA-HJ-Z]{2}/)[0].trim();b.easting=l[0].replace(b.gzd+b.grdsq,"").match(/^\d{1,5}/)[0].trim();b.northing=l[0].replace(b.gzd+
b.grdsq,"").match(/\d{1,5}$/)[0].trim();l=k.replace(/Y/,b.northing);l=l.replace(/X/,b.easting);l=l.replace(/S/,b.grdsq);l=l.replace(/Z/,b.gzd);b.formatResult=l;return b},getFormattedGARSStr:function(l,k){var b={};b.sourceValue=l;b.sourceFormatString=k;b.lon=l[0].match(/\d{3}/);b.lat=l[0].match(/[a-zA-Z]{2}/);l=l[0].match(/\d*$/);b.quadrant=l[0][0];b.key=l[0][1];k=k.replace(/K/,b.key);k=k.replace(/Q/,b.quadrant);k=k.replace(/Y/,b.lat);k=k.replace(/X/,b.lon);b.formatResult=k;return b},getFormattedGEOREFStr:function(l,
k){var b={};b.sourceValue=l;b.sourceFormatString=k;b.lon=l[0].match(/[a-zA-Z]{1}/)[0].trim();b.lat=l[0].replace(b.lon,"").match(/[a-zA-Z]{1}/)[0].trim();b.quadrant15lon=l[0].replace(b.lon+b.lat,"").match(/[a-zA-Z]{1}/)[0].trim();b.quadrant15lat=l[0].replace(b.lon+b.lat+b.quadrant15lon,"").match(/[a-zA-Z]{1}/)[0].trim();l=l[0].replace(b.lon+b.lat+b.quadrant15lon+b.quadrant15lat,"");b.quadrant1lon=l.substr(0,l.length/2);b.quadrant1lat=l.substr(l.length/2,l.length);k=k.replace(/Y/,b.quadrant1lat);k=
k.replace(/X/,b.quadrant1lon);k=k.replace(/D/,b.quadrant15lat);k=k.replace(/C/,b.quadrant15lon);k=k.replace(/B/,b.lat);k=k.replace(/A/,b.lon);b.formatResult=k;return b},getFormattedUTMStr:function(l,k){var b={};b.sourceValue=l;b.sourceFormatString=k;b.parts=l[0].split(/[ ,]+/);b.zone=b.parts[0].replace(/[A-Z]/,"");b.bandLetter=b.parts[0].slice(-1);b.easting=b.parts[1];b.westing=b.parts[2];l=k.replace(/Y/,b.westing);l=l.replace(/X/,b.easting);l=l.replace(/B/,b.bandLetter);l=l.replace(/Z/,b.zone);b.formatResult=
l;return b},getFormattedUTMHStr:function(l,k){var b={};b.sourceValue=l;b.sourceFormatString=k;b.parts=l[0].split(/[ ,]+/);b.zone=b.parts[0].replace(/[A-Z]/,"");b.hemisphere=b.parts[0].slice(-1);b.easting=b.parts[1];b.westing=b.parts[2];l=k.replace(/Y/,b.westing);l=l.replace(/X/,b.easting);l=l.replace(/H/,b.hemisphere);l=l.replace(/Z/,b.zone);b.formatResult=l;return b},convertMetersToUnits:function(l,k){var b=0;switch(k.toLowerCase()){case "meters":b=l;break;case "feet":b=3.28084*l;break;case "kilometers":b=
.001*l;break;case "miles":b=6.21371E-4*l;break;case "nauticalMiles":b=5.39957E-4*l;break;case "yards":b=1.09361*l}return b},convertToMeters:function(l,k){var b=l;switch(k){case "meters":b=l;break;case "feet":b=.3048*l;break;case "kilometers":b=1E3*l;break;case "miles":b=1609.34*l;break;case "nauticalMiles":b=1852.001376036*l;break;case "yards":b=.9144*l}return b}})})},"widgets/Visibility/js/portal-publish":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin jimu/dijit/CheckBox dojo/_base/array dojo/_base/lang dojo/json dojo/text!../templates/portal-publish.html dojo/dom-construct dojo/on dojo/dom-class dojo/dom-style esri/arcgis/Portal dojo/Evented ./portal-utils jimu/LayerInfos/LayerInfos esri/layers/FeatureLayer esri/graphic esri/dijit/util/busyIndicator jimu/utils dojo/keys dijit/focus dojo/query dojo/topic dijit/form/ValidationTextBox jimu/dijit/formSelect".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q,u,v,t,y,C,B,F,x){return H([m,n,g],{templateString:a,baseClass:"jimu-widget-visibility-publish",publishNewLayer:null,busyIndicator:null,fieldsObj:null,postCreate:function(){String.prototype.format||(String.prototype.format=function(){var w=arguments;return this.replace(/{(\d+)}/g,function(A,z){return"undefined"!==typeof w[z]?w[z]:A})});this.addLayerNameArea&&(this.addLayerNameArea.invalidMessage=this.nls.invalidLayerName,this.addLayerNameArea.missingMessage=
this.nls.missingLayerNameMessage);this.fieldsObj={RegionType:{value:"",dataType:"esriFieldTypeInteger"},CenterPoint:{value:this.centerPoint,dataType:"esriFieldTypeString"},ObservationHeight:{value:this.observerHeight,dataType:"esriFieldTypeDouble"},HeightUnit:{value:this.observerHeightDD,dataType:"esriFieldTypeString"},MinObservationDistance:{value:this.minObsRange,dataType:"esriFieldTypeDouble"},MaxObservationDistance:{value:this.maxObsRange,dataType:"esriFieldTypeDouble"},DistanceUnit:{value:this.distanceUnitDD,
dataType:"esriFieldTypeString"},FOVStartAngle:{value:this.fovStartAngle,dataType:"esriFieldTypeDouble"},FOVEndAngle:{value:this.fovEndAngle,dataType:"esriFieldTypeDouble"},AngleUnits:{value:this.angleUnits,dataType:"esriFieldTypeString"}};this.fields={RegionType:"",CenterPoint:this.centerPoint,ObservationHeight:this.observerHeight,HeightUnit:this.observerHeightDD,MinObservationDistance:this.minObsRange,MaxObservationDistance:this.maxObsRange,DistanceUnit:this.distanceUnitDD,FOVStartAngle:this.fovStartAngle,
FOVEndAngle:this.fovEndAngle,AngleUnits:this.angleUnits};this.publishNewLayer=new r({checked:!1,label:this.nls.publishToNewLayer},d.create("div",{},this.checkBoxParentContainer));this.own(f(this.publishNewLayer,"change",k.hitch(this,this._onCheckboxClicked)));this._populateSelectList(this.featureLayerList,this._layerList,!0);0===this.featureLayerList.options.length&&(this.publishNewLayer.setValue(!0),e.add(this.checkBoxParentContainer,"esriCTHidden"));!this.config.hasOwnProperty("operationalLayer")||
this.config.hasOwnProperty("operationalLayer")&&this.config.operationalLayer.hasOwnProperty("name")&&""===this.config.operationalLayer.name?(e.add(this.featureLayerList.domNode,"esriCTHidden"),this.publishNewLayer.setValue(!0),e.remove(this.addLayerNameArea.domNode,"esriCTHidden")):(e.remove(this.featureLayerList.domNode,"esriCTHidden"),this.publishNewLayer.setValue(!1),e.add(this.addLayerNameArea.domNode,"esriCTHidden"));this.own(f(this.resultsPanelBackButton,"click",k.hitch(this,function(){this.emit("displayMainPageOnBack")})));
this.own(f(this.resultsPanelBackButton,"keydown",k.hitch(this,function(w){w.keyCode!==C.ENTER&&w.keyCode!==C.SPACE||this.emit("displayMainPageOnBack")})));this.own(f(this.publishButton,"click",k.hitch(this,function(){if(this.publishNewLayer.checked&&!this.addLayerNameArea.isValid())this.publishMessage.innerHTML=this.nls.missingLayerNameMessage;else{this.publishMessage.innerHTML="";var w={layerName:this.publishNewLayer.checked?this.addLayerNameArea.value:this.featureLayerList.getValue(),url:"",itemId:"",
serviceItemId:""};if(!this.publishNewLayer.checked){var A=this._layerList.filter(function(z){return z.name===w.layerName},this);1===A.length&&(w.url=A[0].url,w.itemId=A[0].id,w.serviceItemId=b.parse(A[0]._json).serviceItemId)}this._initSaveToPortal(w)}})));this.own(f(this.publishButton,"keydown",k.hitch(this,function(w){if(w.keyCode===C.ENTER||w.keyCode===C.SPACE)if(this.publishNewLayer.checked&&!this.addLayerNameArea.isValid())this.publishMessage.innerHTML=this.nls.missingLayerNameMessage,this._setFirstLastFocusNodes();
else{this.publishMessage.innerHTML="";var A={layerName:this.publishNewLayer.checked?this.addLayerNameArea.value:this.featureLayerList.getValue(),url:"",itemId:"",serviceItemId:"",map:this.map,appConfig:this.appConfig,renderer:this._renderer,publishMessage:this.publishMessage,nls:this.nls,graphics:this.ThreatArea.graphics};this.publishNewLayer.checked||(w=this._layerList.filter(function(z){return z.name===A.layerName},this),1===w.length&&(A.url=w[0].url,A.itemId=w[0].id,A.serviceItemId=b.parse(w[0]._json).serviceItemId));
this._initSaveToPortal(A)}})));this.own(x.subscribe("WIDGET_RESIZE",k.hitch(this,this._onWidgetResize)));this.own(f(this.featureLayerList,"change",k.hitch(this,function(){this._onWidgetResize()})))},startup:function(){this.busyIndicator=t.create({target:this.parentNode.parentNode.parentNode.parentNode,backgroundOpacity:0})},_onWidgetResize:function(){var w=F(".dijitValidationTextBoxLabel",this.featureLayerList.domNode);0<w.length&&h.set(w[0],"width",this.publishButton.clientWidth-53+"px")},_onCheckboxClicked:function(){this.publishNewLayer.checked?
(e.add(this.featureLayerList.domNode,"esriCTHidden"),e.remove(this.addLayerNameArea.domNode,"esriCTHidden"),this.addLayerNameArea.reset(),this.addLayerNameArea.focus()):(e.add(this.addLayerNameArea.domNode,"esriCTHidden"),e.remove(this.featureLayerList.domNode,"esriCTHidden"));this._addLayerToMap=this.publishNewLayer.checked},_containsSupportedCapabilities:function(w){var A=!0;["create","delete","query","update","editing"].forEach(function(z){-1===w.toLowerCase().split(",").indexOf(z)&&(A=!1)});return A},
_populateSelectList:function(w,A,z){var G=[];z&&(G=l.filter(A,function(J){return"esriGeometryPolygon"===J.geometryType},this));A=0<G.length?G:A;l.forEach(A,k.hitch(this,function(J){J.url&&"Feature Layer"===J.type&&this._containsSupportedCapabilities(J.capabilities)&&w.addOption({value:J.name,label:y.sanitizeHTML(J.name),selected:!1,id:J.id})}));this.config.hasOwnProperty("operationalLayer")&&this.config.operationalLayer.hasOwnProperty("name")&&""!==this.config.operationalLayer.name?w.setValue(this.config.operationalLayer.name):
w.setValue("")},_toLowerCaseProps:function(w){for(var A,z=Object.keys(w),G=z.length,J={};G--;)A=z[G],J[A.toLowerCase()]=w[A];return J},_initSaveToPortal:function(w){var A=w.layerName,z=new c.Portal(this.appConfig.portalUrl);this.own(f(z,"load",k.hitch(this,function(){z.signIn().then(k.hitch(this,function(G){var J=G.credential.token,L=G.orgId,R=G.username;if("org_user"===G.role)this.publishMessage.innerHTML=y.sanitizeHTML(this.nls.createService.format(this.nls.userRole)),this._setFirstLastFocusNodes();
else if(w.url){G=new u(w.url+"?token\x3d"+J,{id:w.layerName,outFields:["*"]});G._wabProperties={itemLayerInfo:{portalUrl:this.appConfig.portalUrl,itemId:w.itemId}};this.busyIndicator.show();var T=[];this.graphics.forEach(function(ca){if(void 0!==ca.attributes&&ca.attributes.hasOwnProperty("type")){var ba=k.clone(this.fields);ba.RegionType="visible"===ca.attributes.regionType?1:0;ba=z.isPortal?this._toLowerCaseProps(ba):ba;T.push(new v(ca.geometry,null,ba))}},this);G.applyEdits(T,null,null).then(k.hitch(this,
function(){x.publish("moveMap",!1);this.publishMessage.innerHTML=this.nls.successfullyPublished.format('\x3cbr /\x3e\x3ca href\x3d"'+this.appConfig.portalUrl+"home/item.html?id\x3d"+w.serviceItemId+'" target\x3d"_blank"\x3e')+"\x3c/a\x3e";this._reset()})).otherwise(k.hitch(this,function(ca){this.publishMessage.innerHTML=ca.message;this._reset()}));this.busyIndicator.hide();this._setFirstLastFocusNodes()}else{var aa=this.appConfig.portalUrl+"sharing/content/users/"+R+"/createService";p.isNameAvailable(this.appConfig.portalUrl+
"sharing/rest/portals/"+L+"/isServiceNameAvailable",J,A).then(k.hitch(this,function(ca){ca.available?(this.busyIndicator.show(),p.createFeatureService(aa,J,p.getFeatureServiceParams(A,this.map)).then(k.hitch(this,function(ba){if(ba.success){var la=ba.serviceurl.replace(RegExp("rest","g"),"rest/admin")+"/addToDefinition";p.addDefinitionToService(la,J,p.getLayerParams(A,this.map,this._renderer,this.nls)).then(k.hitch(this,function(oa){if(oa.success){oa=new u(ba.serviceurl+"/0?token\x3d"+J,{id:A,outFields:["*"]});
oa._wabProperties={itemLayerInfo:{portalUrl:this.appConfig.portalUrl,itemId:ba.itemId}};this.map.addLayer(oa);if(oa.loaded){var fa=q.getInstanceSync().getLayerInfoById(A);fa.enablePopup()}else oa.on("load",k.hitch(this,function(){fa=q.getInstanceSync().getLayerInfoById(A);fa.enablePopup()}));var M=[];l.forEach(this.graphics,function(X){if(void 0!==X.attributes&&X.attributes.hasOwnProperty("type")){var da=k.clone(this.fields);da.RegionType="visible"===X.attributes.regionType?1:0;da=z.isPortal?this._toLowerCaseProps(da):
da;M.push(new v(X.geometry,null,da))}},this);oa.applyEdits(M,null,null).then(k.hitch(this,function(){this._reset()})).otherwise(k.hitch(this,function(){this._reset()}));this.busyIndicator.hide();this.publishMessage.innerHTML=this.nls.successfullyPublished.format('\x3cbr /\x3e\x3ca role\x3d"link" tabindex\x3d0 aria-label\x3d"'+this.nls.successfullyPublished+'" href\x3d"'+this.appConfig.portalUrl+"home/item.html?id\x3d"+ba.itemId+'" target\x3d"_blank"\x3e')+"\x3c/a\x3e";this._setFirstLastFocusNodes()}}),
k.hitch(this,function(oa){this.busyIndicator.hide();this.publishMessage.innerHTML=y.sanitizeHTML(this.nls.addToDefinition.format(oa.message));this._setFirstLastFocusNodes()}))}else this.busyIndicator.hide(),this.publishMessage.innerHTML=y.sanitizeHTML(this.nls.unableToCreate.format(A)),this._setFirstLastFocusNodes()}),k.hitch(this,function(ba){this.busyIndicator.hide();this.publishMessage.innerHTML=y.sanitizeHTML(this.nls.createService.format(ba.message));this._setFirstLastFocusNodes()}))):(this.busyIndicator.hide(),
this.publishMessage.innerHTML=this.nls.layerNameExists)}))}}),k.hitch(this,function(G){this.busyIndicator.hide();this.publishMessage.innerHTML=G.message;this._setFirstLastFocusNodes()}))})))},_reset:function(){this.graphicsLayer.clear();this.graphics=[];this.graphicsLayer.refresh()},_setFirstLastFocusNodes:function(){y.initFirstFocusNode(this.parentNode,this.resultsPanelBackButton);B.focus(this.resultsPanelBackButton);y.initLastFocusNode(this.parentNode,this.publishButton);var w=F("a",this.publishMessage)[0];
""!==this.publishMessage.innerHTML&&w?(y.initLastFocusNode(this.parentNode,this.publishMessage),B.focus(w)):""===this.publishMessage.innerHTML&&B.focus(this.resultsPanelBackButton)},_matchLayerFields:function(w,A){var z={},G=Object.keys(this.fieldsObj);l.forEach(A,k.hitch(this,function(J){l.forEach(G,k.hitch(this,function(L){if(J.name.toLowerCase()===L.toLowerCase()&&(J.type===this.fieldsObj[L].dataType||"esriFieldTypeString"===J.type)){var R=this.fieldsObj[L].value;"esriFieldTypeString"===J.type&&
50>J.length&&"string"===typeof this.fieldsObj[L].value&&(R=this.fieldsObj[L].value.substr(0,J.length));z[J.name]="RegionType"===L?w:R}}))}));return z}})})},"widgets/Visibility/js/portal-utils":function(){define(["esri/request","dojo/json"],function(H,m){return{getFeatureServiceParams:function(n,r){return{name:n,serviceDescription:"",hasStaticData:!1,maxRecordCount:1E3,supportedQueryFormats:"JSON",capabilities:"Create,Delete,Query,Update,Editing",tags:"GRG",description:"",copyrightText:"",spatialReference:r.spatialReference.toJson(),
initialExtent:r.extent.toJson(),allowGeometryUpdates:!0,units:"esriMeters",xssPreventionInfo:{xssPreventionEnabled:!0,xssPreventionRule:"InputOnly",xssInputRule:"rejectInvalid"}}},getLayerParams:function(n,r,l,k){return{layers:[{adminLayerInfo:{geometryField:{name:"Shape"},xssTrustedFields:""},id:0,name:n,type:"Feature Layer",displayField:"",description:"",tags:"GRG",copyrightText:"",defaultVisibility:!0,ownershipBasedAccessControlForFeatures:{allowOthersToQuery:!1,allowOthersToDelete:!1,allowOthersToUpdate:!1},
relationships:[],isDataVersioned:!1,supportsCalculate:!0,supportsAttachmentsByUploadId:!0,supportsRollbackOnFailureParameter:!0,supportsStatistics:!0,supportsAdvancedQueries:!0,supportsValidateSql:!0,supportsCoordinatesQuantization:!0,supportsApplyEditsWithGlobalIds:!0,advancedQueryCapabilities:{supportsPagination:!0,supportsQueryWithDistance:!0,supportsReturningQueryExtent:!0,supportsStatistics:!0,supportsOrderBy:!0,supportsDistinct:!0,supportsQueryWithResultType:!0,supportsSqlExpression:!0,supportsReturningGeometryCentroid:!0},
useStandardizedQueries:!1,geometryType:"esriGeometryPolygon",minScale:0,maxScale:0,extent:r.extent,drawingInfo:{renderer:l.toJson(),transparency:0},allowGeometryUpdates:!0,hasAttachments:!1,htmlPopupType:"esriServerHTMLPopupTypeNone",hasM:!1,hasZ:!1,objectIdField:"OBJECTID",globalIdField:"",typeIdField:"",fields:[{name:"OBJECTID",type:"esriFieldTypeOID",actualType:"int",alias:"OBJECTID",sqlType:"sqlTypeOther",nullable:!1,editable:!1,domain:null,defaultValue:null},{name:"RegionType",type:"esriFieldTypeInteger",
alias:k.regionTypeLabel,actualType:"nvarchar",nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"CenterPoint",type:"esriFieldTypeString",alias:k.centerPointLabel,actualType:"nvarchar",nullable:!0,editable:!0,domain:null,defaultValue:null,sqlType:"sqlTypeNVarchar",length:50},{name:"ObservationHeight",type:"esriFieldTypeDouble",alias:k.observationHeightLabel,nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"HeightUnit",type:"esriFieldTypeString",alias:k.heightUnitLabel,actualType:"nvarchar",
nullable:!0,editable:!0,domain:null,defaultValue:null,sqlType:"sqlTypeNVarchar",length:50},{name:"MinObservationDistance",type:"esriFieldTypeDouble",alias:k.minObservationDistanceLabel,nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"MaxObservationDistance",type:"esriFieldTypeDouble",alias:k.maxObservationDistance,nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"DistanceUnit",type:"esriFieldTypeString",alias:k.distanceUnitLabel,actualType:"nvarchar",nullable:!0,editable:!0,
domain:null,defaultValue:null,sqlType:"sqlTypeNVarchar",length:50},{name:"FOVStartAngle",type:"esriFieldTypeDouble",alias:k.fovstartAngleLabel,nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"FOVEndAngle",type:"esriFieldTypeDouble",alias:k.fovEndAngleLabel,nullable:!0,editable:!0,domain:null,defaultValue:null},{name:"AngleUnits",type:"esriFieldTypeString",alias:k.AngleUnits,actualType:"nvarchar",nullable:!0,editable:!0,domain:null,defaultValue:null,sqlType:"sqlTypeNVarchar",length:50}],
indexes:[],types:[],templates:[{name:"New Feature",description:"",drawingTool:"esriFeatureEditToolPolygon",prototype:{attributes:{}}}],supportedQueryFormats:"JSON",hasStaticData:!1,maxRecordCount:1E4,standardMaxRecordCount:4E3,tileMaxRecordCount:4E3,maxRecordCountFactor:1,exceedsLimitFactor:1,capabilities:"Query,Editing,Create,Update,Delete"}]}},isNameAvailable:function(n,r,l){return H({url:n,content:{name:l,type:"Feature Service",token:r,f:"json"},handleAs:"json",callbackParamName:"callback"},{usePost:!0})},
createFeatureService:function(n,r,l){return H({url:n,content:{f:"json",token:r,typeKeywords:"ArcGIS Server,Data,Feature Access,Feature Service,Service,Hosted Service",createParameters:m.stringify(l),outputType:"featureService"},handleAs:"json",callbackParamName:"callback"},{usePost:!0})},addDefinitionToService:function(n,r,l){return H({url:n,content:{token:r,addToDefinition:m.stringify(l),f:"json"},handleAs:"json",callbackParamName:"callback"},{usePost:!0})}}})},"widgets/Visibility/js/symbologySettings":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/on ./ColorPickerEditor jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!../templates/symbologySettings.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/dom-attr dojo/query dojo/keys jimu/utils dijit/focus jimu/dijit/formSelect jimu/dijit/SymbolChooser".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p,q){return H([k,b,f],{baseClass:"jimu-widget-visibility-symbologySettings",templateString:a,selectedSettings:{},colorPickerNodes:[],colorPickerObjList:[],constructor:function(u){d.mixin(this,u);this.colorPickerObjList=[];this.colorPickerNodes=[]},startup:function(){if(!this.config.hasOwnProperty("symbology"))var u={visibleSectionOutlineColor:{color:"#000000",transparency:1,type:"esriSLSSolid"},visibleSectionFillColor:{color:"#00ff00",transparency:.5,type:"esriSFSSolid"},
nonVisibleSectionOutlineColor:{color:"#000000",transparency:1,type:"esriSLSSolid"},nonVisibleSectionFillColor:{color:"#ff0000",transparency:.5,type:"esriSFSSolid"}};m.forEach(this.colorPickerNodes,d.hitch(this,function(t){var y=h.get(t,"nodeId");t=new l({nls:this.nls,type:e.contains(t,"Line")?"line":"fill",nodeId:y},t);t.setValues({color:u?u[y].color:this.config.symbology[y].color,transparency:u?u[y].transparency:this.config.symbology[y].transparency});t.startup();t.dropdown.set("value",u?u[y].type:
this.config.symbology[y].type);this.colorPickerObjList.push(t)}));var v=c(".jimu-color-pickerPopup",this.domNode);m.forEach(v,d.hitch(this,function(t){this.own(r(t,"keydown",d.hitch(this,function(y){y.keyCode!==g.ENTER&&y.keyCode!==g.SPACE||y.currentTarget.click()})))}));this.onSettingsChanged()},postCreate:function(){this.inherited(arguments);this.colorPickerObjList=[];this.colorPickerNodes=[];this.colorPickerNodes=c(".colorPicker",this.domNode);this._handleClickEvents();this.visibleSectionSettingsButton.click()},
_handleClickEvents:function(){this.own(r(this.visibleSectionSettingsButton,"click",d.hitch(this,function(){this._openCloseNodes(this.visibleSectionSettingsButton,this.visibleSectionContainer)})));this.own(r(this.nonVisibleSectionSettingsButton,"click",d.hitch(this,function(){this._openCloseNodes(this.nonVisibleSectionSettingsButton,this.nonVisibleSectionContainer)})));this.own(r(this.visibleSectionSettingsButton,"keydown",d.hitch(this,function(u){u.keyCode!==g.ENTER&&u.keyCode!==g.SPACE||this._openCloseNodes(this.visibleSectionSettingsButton,
this.visibleSectionContainer)})));this.own(r(this.nonVisibleSectionSettingsButton,"keydown",d.hitch(this,function(u){u.keyCode!==g.ENTER&&u.keyCode!==g.SPACE||this._openCloseNodes(this.nonVisibleSectionSettingsButton,this.nonVisibleSectionContainer)})))},_openCloseNodes:function(u,v){var t=c(".container",this.domNode),y=c(".esriCTSettingsButtonIcon",this.domNode),C=!1;this.validInputs()&&(u&&e.contains(u,"esriCTLabelSettingsRightButton")&&(C=!0),m.forEach(t,d.hitch(this,function(B){n.addClass(B,"esriCTGroupHidden")})),
m.forEach(y,d.hitch(this,function(B,F){n.removeClass(B,"esriCTLabelSettingsDownButton");n.addClass(B,"esriCTLabelSettingsRightButton");h.set(B,"aria-expanded","false");F===y.length-1&&setTimeout(d.hitch(this,function(){this._setLastFocusNode()}),100)})),C?(n.removeClass(v,"esriCTGroupHidden"),n.removeClass(u,"esriCTLabelSettingsRightButton"),n.addClass(u,"esriCTLabelSettingsDownButton"),h.set(u,"aria-expanded","true"),u=c(".jimu-color-picker",v),u.length&&q.focus(u[0])):q.focus(u))},onClose:function(){if(!this.validInputs())return!1;
this.onSettingsChanged();this._openCloseNodes()},onSettingsChanged:function(){m.forEach(this.colorPickerObjList,d.hitch(this,function(u){var v={color:u.getValues().color,transparency:u.getValues().transparency,type:u.dropdown.getValue()};this.selectedSettings[u.nodeId]=v}));this.emit("settingsChanged",this.selectedSettings)},validInputs:function(){var u=!0;m.some(this.colorPickerObjList,function(v){v.validateSpinner()||(u=!1)},this);return u},_setLastFocusNode:function(){var u=this.colorPickerObjList.length-
1;this.refDomNode&&(e.contains(this.nonVisibleSectionSettingsButton,"esriCTLabelSettingsDownButton")?p.initLastFocusNode(this.refDomNode,this.colorPickerObjList[u].dropdown.domNode):p.initLastFocusNode(this.refDomNode,this.nonVisibleSectionSettingsButton))}})})},"widgets/Visibility/js/ColorPickerEditor":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/Color dojo/on dojo/query dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!../templates/ColorPickerEditor.html dijit/form/HorizontalSlider jimu/dijit/ColorPickerPopup dojo/dom-style dojo/_base/kernel dijit/form/NumberSpinner".split(" "),
function(H,m,n,r,l,k,b,a,d,f,e,h,c,g,p){return H([a,d,f],{_defaultColor:"#485566",templateString:e,nls:null,postCreate:function(){this.colorPicker=new c({color:this._defaultColor,tabindex:0,"aria-label":this.nls.colorPicker},this.colorPicker);this.colorPicker.startup();this.slider=new h({name:"slider",value:100,minimum:0,maximum:100,discreteValues:101,intermediateChanges:!0,showButtons:!1,style:"display: inline-block;","aria-label":this.nls.transparency},this.sliderBar);this.slider.startup();"vi"===
p.locale&&g.set(this.sliderBarLabel.domNode,"white-space","nowrap");var q=[],u,v="esriSLSDash esriSLSDashDot esriSLSDashDotDot esriSLSDot esriSLSLongDash esriSLSLongDashDot esriSLSNull esriSLSShortDash esriSLSShortDashDot esriSLSShortDashDotDot esriSLSShortDot esriSLSSolid".split(" "),t="esriSFSBackwardDiagonal esriSFSCross esriSFSDiagonalCross esriSFSForwardDiagonal esriSFSHorizontal esriSFSNull esriSFSSolid esriSFSVertical".split(" ");"line"===this.type?m.forEach(v,n.hitch(this,function(y){u={value:y,
label:this.nls.lineStyles[y]};q.push(u)})):m.forEach(t,n.hitch(this,function(y){u={value:y,label:this.nls.fillStyles[y]};q.push(u)}));this.dropdown.addOption(q);this.inherited(arguments)},startup:function(){this.own(l(this.slider,"change",n.hitch(this,function(q){!1===this._isSameVal()&&this.spinner.setValue(q)})));this.own(l(this.spinner,"change",n.hitch(this,function(q){q<=this.slider.maximum&&this.slider.setValue(q)})));this._stylePolyfill();this.inherited(arguments)},_isSameVal:function(){return this.slider.getValue()===
this.spinner.getValue()},getValues:function(){var q=null,u=null;(u=this.colorPicker.getColor())&&u.toHex&&(q=u.toHex());u=this.spinner.getValue()/100;return{color:q,transparency:u}},setValues:function(q){if("object"===typeof q||"string"===typeof q)this.colorPicker.setColor(new r(q.color)),q.transparency="undefined"===typeof q.transparency?0:100*q.transparency,this.slider.setValue(q.transparency),this.spinner.setValue(q.transparency)},_stylePolyfill:function(){var q=k(".dijitSliderLeftBumper",this.domNode)[0];
q&&q.parentNode&&b.setStyle(q.parentNode,"background-color","#24b5cc")},validateSpinner:function(){var q=!0;this.spinner.isValid()||(this._shake(this.spinner.domNode,16),this.spinner.focus(),q=!1);return q},_shake:function(q,u){function v(){if(15>t){q.style.transform="translate(0px, 0px)";u-=y;var F=C(-u,u),x=C(-u,u);q.style.transform="translate("+F+"px, "+x+"px)";t+=1;requestAnimationFrame(v)}15<=t&&(q.style.transform="translate(0, 0)",B._shakingElements.splice(B._shakingElements.indexOf(q),1))}
var t=1,y=u/15,C=function(F,x){return Math.floor(Math.random()*(x-F+1))+F};this._shakingElements||(this._shakingElements=[]);if(-1===this._shakingElements.indexOf(q)){this._shakingElements.push(q);var B=this;v()}}})})},"jimu/dijit/ColorPickerPopup":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorPalette jimu/utils".split(" "),function(H,m,n,r,l,k,b,a,d,f,e){return H([m,
n],{baseClass:"jimu-color-pickerPopup",declaredClass:"jimu.dijit.ColorPickerPopup",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,color:null,showLabel:!1,around:null,_ENABLE:!0,recordUID:"",postCreate:function(){this.inherited(arguments);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){d.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},enable:function(){this._ENABLE=
!0;l.removeClass(this.domNode,"disable")},disable:function(){this._ENABLE=!1;l.addClass(this.domNode,"disable")},isPartOfPopup:function(h){var c=this.tooltipDialog.domNode;return h===c||l.isDescendant(h,c)},hideTooltipDialog:function(){this._hideTooltipDialog()},showTooltipDialog:function(){this._showTooltipDialog()},initUI:function(){this.picker.initUI()},isOpen:function(){return this._isTooltipDialogOpened},_showTooltipDialog:function(){d.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.around?
this.around:this.domNode,orient:this.orient});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){d.hide(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var h=l.create("div");this.tooltipDialog=new a({content:h});l.addClass(this.tooltipDialog.domNode,"jimu-color-picker-popup-dialog");var c=new f({appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!0,showCoustomRecord:!0,closeDialogWhenChange:!0},
recordUID:this.recordUID,onChange:r.hitch(this,function(g){g&&(g=new b(g),this.setColor(g),this.onChange(g))})});c.placeAt(h);c.startup();this.own(k(c,"close",r.hitch(this,function(){this._hideTooltipDialog()})));this.own(k(c,"change-style",r.hitch(this,function(){this._hideTooltipDialog();this._showTooltipDialog()})));this.own(k(this.domNode,"click",r.hitch(this,function(g){g.stopPropagation();g.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():!1!==this._ENABLE&&this._showTooltipDialog()})));
this.own(k(document,"click",r.hitch(this,function(g){this.isPartOfPopup(g.srcElement||g.target)||this._hideTooltipDialog()})));this.picker=c},setColor:function(h){if(h instanceof b){null===this.color&&!0===this.showLabel&&this._changeLabel(h);var c=h.toHex();this.color=h;l.setStyle(this.domNode,"backgroundColor",c);this.picker&&(this.picker.refreshRecords(),this.picker.setColor(c,!1,!0));this.showLabel&&this._changeLabel(this.color)}},getColor:function(){return this.color},_changeLabel:function(h){l.empty(this.domNode);
l.create("span",{innerHTML:h.toHex(),className:"color-label",style:{color:e.invertColor(h.toHex())}},this.domNode)},onChange:function(h){h&&this.showLabel&&this._changeLabel(h)},changeColor:function(){this.picker&&this.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},setTitle:function(h){this.domNode.title=h},getTooltipDialog:function(){return this.tooltipDialog||null}})})},"widgets/Visibility/js/jquery.knob.min":function(){define(["jimu/loaderplugins/jquery-loader! ./libs/jquery/jquery-1-11-1.js"],
function(H){var m=Math.max,n=Math.min;var r=void 0;r=H(document);var l=function(){var b=this;this.cv=this.v=this.g=this.i=this.$=this.o=null;this.h=this.w=this.y=this.x=0;this.c=this.$c=null;this.t=0;this.isInit=!1;this.rH=this.eH=this.cH=this.dH=this.pColor=this.fgColor=null;this.scale=1;this.relativeHeight=this.relativeWidth=this.relative=!1;this.$div=null;this.run=function(){var a=function(d,f){for(var e in f)b.o[e]=f[e];b._carve().init();b._configure()._draw()};if(!this.$.data("kontroled")){this.$.data("kontroled",
!0);this.extend();this.o=H.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:!0===this.$.data("cursor")&&90||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null===
this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#999",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||1,rotation:this.$.data("rotation"),units:"degrees",milsValue:0,draw:null,change:null,cancel:null,release:null,format:function(d){return d},parse:function(d){return d}},this.o);this.o.flip="anticlockwise"===
this.o.rotation||"acw"===this.o.rotation;this.o.inputColor||(this.o.inputColor=this.o.fgColor);this.i=this.$;this.v=this.o.parse(this.$.val());this.$.bind("change blur",function(){"mils"===b.o.units&&(b.o.milsValue=b.$.val());b.val(b._validate(b.o.parse("degrees"===b.o.units?b.$.val():b.$.val()/17.777777777778)));b.o.cursor="degrees"===b.o.units?b.$.val():b.$.val()/17.777777777778;b.o.inputColor=0!==b.$.val()?"#ccc":"#f37371";b._carve().init();b._draw()});this.$c=H(document.createElement("canvas")).attr({width:this.o.width,
height:this.o.height});this.$div=H('\x3cdiv style\x3d"'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"\x3e\x3c/div\x3e');this.$.wrap(this.$div).before(this.$c);this.$div=this.$.parent();"undefined"!==typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.$c[0]);this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null;if(!this.c)throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+
": "+this.message}};this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);this.relativeWidth=0!==this.o.width%1&&this.o.width.indexOf("%");this.relativeHeight=0!==this.o.height%1&&this.o.height.indexOf("%");this.relative=this.relativeWidth||this.relativeHeight;this._carve();this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=
this.v;this.$.bind("configure",a).parent().bind("configure",a);this._listen()._configure()._xy().init();this.isInit=!0;this._draw();return this}};this._carve=function(){if(this.relative){var a=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width,10)/100:this.$div.parent().width(),d=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height,10)/100:this.$div.parent().height();this.w=this.h=Math.min(a,d)}else this.w=this.o.width,this.h=this.o.height;this.$div.css({width:this.w+
"px",height:this.h+"px"});this.$c.attr({width:this.w,height:this.h});1!==this.scale&&(this.$c[0].width*=this.scale,this.$c[0].height*=this.scale,this.$c.width(this.w),this.$c.height(this.h));return this};this._draw=function(){var a=!0;b.g=b.c;b.clear();b.dH&&(a=b.dH());!1!==a&&b.draw()};this._mouse=function(a){var d=function(f){f=b.xy2val(f.pageX,f.pageY);f===b.cv||b.cH&&!1===b.cH(f)||(b.change(b._validate(f)),b._draw())};d(a);r.bind("mousemove.k",d).bind("keyup.k",function(f){27===f.keyCode&&(r.unbind("mouseup.k mousemove.k keyup.k"),
b.eH&&!1===b.eH()||b.cancel())}).bind("mouseup.k",function(){r.unbind("mousemove.k mouseup.k keyup.k");b.val(b.cv)});return this};this._xy=function(){var a=this.$c.offset();this.x=a.left;this.y=a.top;return this};this._listen=function(){this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(a){a.preventDefault();b._xy()._mouse(a)}),this.listen());this.relative&&H(window).resize(function(){b._carve().init();b._draw()});return this};this._configure=function(){this.o.draw&&
(this.dH=this.o.draw);this.o.change&&(this.cH=this.o.change);this.o.cancel&&(this.eH=this.o.cancel);this.o.release&&(this.rH=this.o.release);this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.5"),this.fgColor=this.h2rgba(this.o.fgColor,"0.5")):this.fgColor=this.o.fgColor;return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(a){return Math.round(~~((0>a?-.5:.5)+a/this.o.step)*this.o.step*100)/100};this.listen=function(){};this.extend=function(){};
this.init=function(){};this.change=function(){};this.val=function(){};this.xy2val=function(){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(a,d){a=a.substring(1,7);a=[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)];return"rgba("+a[0]+","+a[1]+","+a[2]+","+d+")"};this.copy=function(a,d){for(var f in a)d[f]=a[f]}};var k=function(){l.call(this);this.w2=this.cursorExt=this.lineWidth=this.radius=this.xy=this.startAngle=null;
this.PI2=2*Math.PI;this.extend=function(){this.o=H.extend({bgColor:this.$.data("bgcolor")||"#999",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)};this.val=function(b,a){if(null!==b)b=this.o.parse(b),!1!==a&&b!==this.v&&this.rH&&!1===this.rH(b)||(this.v=this.cv=this.o.stopper?m(n(b,this.o.max),this.o.min):b,this._draw());else return this.v};this.xy2val=function(b,a){b=Math.atan2(b-(this.x+this.w2),-(a-this.y-this.w2))-this.angleOffset;this.o.flip&&
(b=this.angleArc-b-this.PI2);this.angleArc!==this.PI2&&0>b&&-.5<b?b=0:0>b&&(b+=this.PI2);b=b*(this.o.max-this.o.min)/this.angleArc+this.o.min;this.o.stopper&&(b=m(n(b,this.o.max),this.o.min));return b};this.listen=function(){var b=this,a,d;this.$.bind("keydown",function(f){var e=f.keyCode;96<=e&&105>=e&&(e=f.keyCode=e-48);a=parseInt(String.fromCharCode(e),10);isNaN(a)&&13!==e&&8!==e&&9!==e&&f.preventDefault()}).bind("keyup",function(){isNaN(a)?d&&(window.clearTimeout(d),d=null,b.val(b.$.val())):b.$.val()>
b.o.max&&b.$.val(b.o.max)||b.$.val()<b.o.min&&b.$.val(b.o.min)})};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;"degrees"===this.o.units?this.$.val(this.v):this.$.val(this.o.milsValue);this.w2=this.w/2;this.cursorExt=this.o.cursor*Math.PI/180/2;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&
(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var b=m(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:this.w/2+4+"px",height:this.w/3+"px",position:"absolute","vertical-align":"middle","margin-top":this.w/3+"px","margin-left":"-"+
(3*this.w/4+2)+"px",border:0,background:"none",font:this.o.fontWeight+" "+this.w/b+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(b){this.cv=b};this.angle=function(b){return(b-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.arc=function(b){b=this.angle(b);if(this.o.flip){var a=this.endAngle+1E-5;b=a-b-1E-5}else a=this.startAngle-1E-5,b=a+b+1E-5;
this.o.cursor&&(a=b-this.cursorExt)&&(b+=this.cursorExt);return{s:a,e:b,d:this.o.flip&&!this.o.cursor}};this.draw=function(){var b=this.g,a=this.arc(this.cv);var d=1;b.lineWidth=this.lineWidth;b.lineCap=this.lineCap;"none"!==this.o.bgColor&&(b.beginPath(),b.strokeStyle=this.o.bgColor,b.arc(this.xy,this.xy,this.radius,this.endAngle-1E-5,this.startAngle+1E-5,!0),b.stroke());this.o.displayPrevious&&(d=this.arc(this.v),b.beginPath(),b.strokeStyle=this.pColor,b.arc(this.xy,this.xy,this.radius,d.s,d.e,
d.d),b.stroke(),d=this.cv===this.v);b.beginPath();b.strokeStyle=d?this.o.fgColor:this.fgColor;b.arc(this.xy,this.xy,this.radius,a.s,a.e,a.d);b.stroke()};this.cancel=function(){this.val(this.v)}};H.fn.dial=H.fn.knob=function(b){return this.each(function(){var a=new k;a.o=b;a.$=H(this);a.run()}).parent()}})},"jimu/loaderplugins/jquery-loader":function(){define(["dojo/Deferred","dojo/when"],function(H,m){var n,r={},l=function(d){var f=new H;if(r.locked)return setTimeout(function(){l(d)},50),f;if(r[d])return r.locked=
!0,f.resolve(r[d]),f;r.locked=!0;n([d],function(){r[d]=window.jQuery;f.resolve(r[d])});return f},k=function(d,f,e){n([d[f]],function(){f===d.length-1?e.resolve():(f++,k(d,f,e))})},b=function(d,f){d=new H;f[0]?k(f,0,d):d.resolve();return d},a=function(d,f){var e=new H;l(d).then(function(h){b(d,f).then(function(){r.locked=!1;e.resolve(h)})});return e};return{load:function(d,f,e){d=d.split(",");var h=[];n=f;0===d.length?e(null):(f=d[0],h=d.slice(1),m(a(f,h),e))}}})},"widgets/Visibility/js/PrivilegeUtil":function(){define("dojo/_base/declare dojo/_base/lang jimu/portalUtils jimu/portalUrlUtils jimu/Role esri/lang".split(" "),
function(H,m,n,r,l,k){var b=null,a=H([],{userRole:null,userPortalUrl:null,portalAnalysis:null,portalSelf:null,portalUrl:null,_isServiceAvailable:!1,constructor:function(d){this.portalUrl=d},_clearLoadedInfo:function(){this.portalUrl=this.portalSelf=this.userPortalUrl=this.userRole=null},loadPrivileges:function(d){this.portalSelf=this.userPortalUrl=this.userRole=null;this._isServiceAvailable=!1;d&&(this.portalUrl=d);d=n.getPortal(this.portalUrl);return d.haveSignIn()?this._loadUserInfo(d):this._signIn(d)},
getPortalUrl:function(d){return d?r.getStandardPortalUrl(d):this.portalUrl?r.getStandardPortalUrl(this.portalUrl):r.getStandardPortalUrl(this.appConfig.portalUrl)},_privilegeLoaded:function(){return null!==this.portalSelf},getUserPortal:function(){return this._privilegeLoaded()?this.getPortalUrl(this.userPortalUrl):null},_signIn:function(d){return d.loadSelfInfo().then(m.hitch(this,function(f){var e=n.getPortal(f.portalHostname);return null===e?!1:e.signIn().then(m.hitch(this,function(h){return this._loadUserInfo(e,
h)}),function(){return!1})}),function(){return!1})},_loadUserInfo:function(d){return d.loadSelfInfo().then(m.hitch(this,function(f){this.userPortalUrl=f.urlKey?f.urlKey+"."+f.customBaseUrl:this.portalUrl;return f&&f.user?(this.userRole=new l({id:f.user.roleId?f.user.roleId:f.user.role,role:f.user.role}),f.user.privileges&&this.userRole.setPrivileges(f.user.privileges),this.portalSelf=f,!0):!1}),function(){return!1})},_canPerformElevationAnalysis:function(){this.portalSelf&&(this._isServiceAvailable=
k.isDefined(this.portalSelf.helperServices.elevation));return this.canPerformAnalysis()&&this._isServiceAvailable},canPerformAnalysis:function(){var d=!1;this.userRole&&(this.userRole.isAdmin()||this.userRole.isPublisher())?d=!0:this.userRole&&this.userRole.isCustom()&&(d=this.userRole.canCreateItem()&&this.userRole.canPublishFeatures()&&this.userRole.canUseSpatialAnalysis());this.portalSelf&&this.portalSelf.isPortal&&(d=d&&k.isDefined(this.portalSelf.helperServices.analysis)&&k.isDefined(this.portalSelf.helperServices.analysis.url));
return d}});a.getInstance=function(d){null===b&&(b=new a(d));return b};return a})},"widgets/Visibility/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Visibility/templates/VisibilityControl.html":'\x3cdiv\x3e\r\n\x3cdiv class\x3d"" data-dojo-attach-point\x3d"visibiltyWidget"\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTNewHeader"\x3e\r\n\x3c!-- Panel Title --\x3e\r\n\x3cdiv class\x3d"esriCTMainTitleDiv esriCTEllipsis" title\x3d"${nls.mainPageTitle}"\x3e\r\n  ${nls.mainPageTitle}\r\n  \x3c/div\x3e\r\n  \x3c!-- Settings Icon --\x3e\r\n  \x3cdiv class\x3d"esriCTRightSideButton"\x3e\r\n    \x3cdiv class\x3d"esriCTSettingsIcon esriCTPointer" title\x3d"${nls.settingsTitle}" tabindex\x3d"0" role\x3d\'button\'\r\n    aria-label\x3d\'${nls.settingsTitle}\' data-dojo-attach-point\x3d"settingsIcon"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTSaveToLayerIcon esriCTPointer esriCTHidden" title\x3d"${nls.resultsTitle}" tabindex\x3d"0"  role\x3d\'button\' aria-label\x3d\'${nls.resultsTitle}\' data-dojo-attach-point\x3d"saveToLayerIcon"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3clabel data-dojo-attach-point\x3d"errorText" style\x3d"display: none"\x3e\x3c/label\x3e\r\n  \x3cdiv class\x3d"controls" data-dojo-attach-point\x3d"controls"\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"observerCoordsContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel class\x3d"titleLabel" data-dojo-attach-point\x3d"FOVLabel"\x3e${nls.fieldOfView}\x3c/label\x3e\r\n      \x3cdiv class\x3d"center" data-dojo-attach-point\x3d"FOVGroup"\x3e\r\n        \x3cinput type\x3d"text" value\x3d"360" class\x3d"fov" data-displayInput\x3d"true" data-cursor\x3d"true" disabled\x3d"true"\r\n          data-dojo-attach-point\x3d"FOVInput" aria-label\x3d"${nls.fieldOfView}" /\x3e\r\n        \x3cp class\x3d"cursortooltip" data-dojo-attach-point\x3d"tooltip" hidden\x3d\'true\'\x3e\x3c/p\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3cinput class\x3d"switch-toggle" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"angleUnits" checked\x3d"false" aria-label\x3d"${nls.useMilsText}"/\x3e\r\n      \x3clabel class\x3d"titleLabel"\x3e${nls.useMilsText}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel class\x3d"titleLabel"\x3e${nls.observerHeight}\x3c/label\x3e\r\n      \x3cdiv\x3e\r\n        \x3cinput class\x3d"inputNumberTextbox" data-dojo-type\x3d\'dijit/form/NumberTextBox\' required\x3d"true" value\x3d"2"\r\n          data-dojo-props\x3d\'constraints: {min: 0}\' data-dojo-attach-point\x3d"observerHeight" aria-label\x3d"${nls.observerHeight}"\x3e\r\n        \x3cselect style\x3d"width: 100px" class\x3d"controlSpace noResize" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n          data-dojo-attach-point\x3d"observerHeightDD" aria-label\x3d"${nls.observerHeight}"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel class\x3d"titleLabel"\x3e${nls.minObsDistance}\x3c/label\x3e\r\n      \x3cdiv\x3e\r\n        \x3cinput class\x3d"inputNumberTextbox" data-dojo-type\x3d\'dijit/form/NumberTextBox\' required\x3d"true" value\x3d"3"\r\n          data-dojo-props\x3d\'constraints: {min: 0},intermediateChanges:true\' data-dojo-attach-point\x3d"minObsRange"\r\n          aria-label\x3d"${nls.minObsDistance}"\x3e\r\n        \x3cselect style\x3d"width: 100px" class\x3d"controlSpace noResize" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n          data-dojo-attach-point\x3d"distanceUnitDD" aria-label\x3d"${nls.minObsDistance}"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel class\x3d"titleLabel"\x3e${nls.maxObsDistance}\x3c/label\x3e\r\n      \x3cdiv\x3e\r\n        \x3cinput class\x3d"inputNumberTextbox" data-dojo-type\x3d\'dijit/form/NumberTextBox\' required\x3d"true" value\x3d"5"\r\n          data-dojo-props\x3d\'constraints: {min: 0}\' data-dojo-attach-point\x3d"maxObsRange" aria-label\x3d"${nls.maxObsDistance}"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttonContainer" data-dojo-attach-point\x3d"buttonContainer"\x3e\r\n      \x3cdiv class\x3d"btnContainer HalfWidthLeft"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnCreate" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.createBtn}"\x3e${nls.createBtn}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"btnContainer HalfWidthRight"\x3e\r\n        \x3cdiv class\x3d"jimu-btn controlSpace" data-dojo-attach-point\x3d"btnClear" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.clearBtn}"\x3e${nls.clearBtn}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\x3c/div\x3e\r\n\x3cdiv class\x3d"esriCTHidden" data-dojo-attach-point\x3d"portalPublishContainer"\x3e\x3c/div\x3e\r\n\x3cdiv class\x3d"esriCTHidden" data-dojo-attach-point\x3d"settingsContainer"\x3e\r\n  \x3cdiv\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTSettingHeader"\x3e\r\n      \x3cdiv class\x3d"esriCTBackButton" title\x3d"${nls.back}"\x3e\r\n        \x3cdiv class\x3d"esriCTItemLeftArrow" data-dojo-attach-point\x3d"settingsPanelBackButton" tabindex\x3d"0"\r\n          aria-label\x3d"${nls.back}" role\x3d"button"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.settingsTitle}"\x3e${nls.settingsTitle}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n      \x3cdiv style\x3d"overflow: hidden;" data-dojo-attach-point\x3d"symbologySettingsNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/SingleFilter.html":'\x3cdiv class\x3d"esriSingleFilterForm singleFilter" id\x3d"${id}.singleFilter"\x3e\r\n  \x3cdiv\x3e\r\n    \x3ctable id\x3d"${id}.exprTable" class\x3d"rowTable" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column1"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column2"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column3"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column4"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column5"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column6"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column7"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3ca id\x3d"${id}.deleteExpression" href\x3d"JavaScript:void(0);" style\x3d"margin:0 5px;display:none;" class\x3d"esriAGOFilterRemoveIcon" title\x3d"${i18n.deleteExpression}"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_interactiveFilterRow"\x3e\r\n          \x3ctd colspan\x3d"8"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"interactiveFilter"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3cinput dojoAttachPoint\x3d"interactiveCheck" type\x3d"checkbox" class\x3d"promptCheckBox" title\x3d"${i18n.promptMsg}"/\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3clabel class\x3d"labels" for\x3d"promptCheckBox"\x3e\r\n                              \x26nbsp;\x26nbsp;${i18n.askForValues}\r\n                            \x3c/label\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cspan dojoAttachPoint\x3d"interactiveArrow" style\x3d"color:#cbcbcb;cursor:pointer;" class\x3d"showHidePromptDiv"\x3e\x26nbsp;\x26#9660;\x3c/span\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr dojoAttachPoint\x3d"interactiveSpace" style\x3d"display:none"\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.prompt}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"promptText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.hint}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"hintText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"promptDiv" style\x3d"display:none;padding:10px 0px;"\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtPrompt"\x3e\r\n      ${i18n.prompt}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtPrompt" type\x3d"text"/\x3e\r\n    \x3cbr/\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtHint"\x3e\r\n      ${i18n.hint}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtHint" type\x3d"text" /\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/layers/support/rasterFunctionSchema.json":'{\r\n  "AspectFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "ColormapFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ColorSchemeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.colorSchemeTypeName}",\r\n        "defaultValue": 0,\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "colorSchemeTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                0\r\n              ],\r\n              "active": [\r\n                "ColormapName"\r\n              ],\r\n              "inactive": [\r\n                "ColorRamp"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Colormap": {\r\n        "required": true,\r\n        "displayName": "${rasterFunctions.rfxArgs.colormapName}",\r\n        "dataType": "rastercolormap",\r\n        "hidden": true\r\n      },\r\n      "ColormapName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.colormapNameName}",\r\n        "hidden": false,\r\n        "defaultValue": "Gray",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "colormapTypes"\r\n        }\r\n      },\r\n      "ColorRamp": {\r\n        "required": true,\r\n        "displayName": "${rasterFunctions.rfxArgs.colorRampName}",\r\n        "dataType": "colorramp",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "ContrastBrightnessFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ContrastOffset": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.contrastOffsetName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "range",\r\n          "min": -100,\r\n          "max": 100\r\n        }\r\n      },\r\n      "BrightnessOffset": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.brightnessOffsetName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "range",\r\n          "min": -100,\r\n          "max": 100\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "ExtractBandFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Method": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.methodName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "bandComboMethods"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": false,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                0\r\n              ],\r\n              "active": [\r\n                "BandNames"\r\n              ],\r\n              "inactive": [\r\n                "BandWavelengths",\r\n                "BandIds"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                1\r\n              ],\r\n              "active": [\r\n                "BandWavelengths"\r\n              ],\r\n              "inactive": [\r\n                "BandNames",\r\n                "BandIds"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                2\r\n              ],\r\n              "active": [\r\n                "BandIds"\r\n              ],\r\n              "inactive": [\r\n                "BandNames",\r\n                "BandWavelengths"\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "BandNames": {\r\n        "required": true,\r\n        "dataType": "stringarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandNamesName}",\r\n        "hidden": false,\r\n        "defaultValue": [\r\n          "Red",\r\n          "Green",\r\n          "Blue"\r\n        ]\r\n      },\r\n      "BandWavelengths": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandWavelengthsName}",\r\n        "hidden": false,\r\n        "defaultValue": [\r\n          600,\r\n          400,\r\n          200\r\n        ]\r\n      },\r\n      "BandIds": {\r\n        "required": true,\r\n        "dataType": "longarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandIdsName}",\r\n        "hidden": false,\r\n        "defaultValue": [\r\n          0,\r\n          1,\r\n          2\r\n        ]\r\n      },\r\n      "MissingBandAction": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.missingBandActionName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriMissingBandActions"\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "Method",\r\n            "BandNames",\r\n            "BandWavelengths",\r\n            "BandIds"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxBandCombinationEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "GrayscaleFunction": {\r\n    "Description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ConversionParameters": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "dataTypeAttributes": {\r\n          "type": "bandmatrix",\r\n          "nBands": "Raster",\r\n          "cols": 1,\r\n          "displayNames": [\r\n            "${rasterFunctions.rfxArgs.weightName}"\r\n          ]\r\n        },\r\n        "displayName": "${rasterFunctions.rfxArgs.conversionParametersName}",\r\n        "hidden": false,\r\n        "defaultValue": [\r\n          0.299,\r\n          0.587,\r\n          0.114\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  "HillshadeFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "DEM": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "HillshadeType": {\r\n        "required": false,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.hillshadeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriHillshadeTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                1\r\n              ],\r\n              "inactive": [\r\n                "Azimuth",\r\n                "Altitude"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Azimuth": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.azimuthName}",\r\n        "hidden": false,\r\n        "defaultValue": 315\r\n      },\r\n      "Altitude": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.altitudeName}",\r\n        "hidden": false,\r\n        "defaultValue": 45\r\n      },\r\n      "SlopeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.slopeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSlopeTypes13"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                3\r\n              ],\r\n              "active": [\r\n                "PSPower",\r\n                "PSZFactor"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "ZFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "PSPower": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.PSPowerName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.664\r\n      },\r\n      "PSZFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.PSZFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.024\r\n      },\r\n      "RemoveEdgeEffect": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.removeEdgeEffectName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "ShadedReliefFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ColorSchemeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.colorSchemeTypeName}",\r\n        "hidden": true,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "colorSchemeTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                1\r\n              ],\r\n              "active": [\r\n                "ColorRamp"\r\n              ],\r\n              "inactive": [\r\n                "Colormap"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "HillshadeType": {\r\n        "required": false,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.hillshadeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriHillshadeTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [1],\r\n              "inactive": ["Azimuth", "Altitude"],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "ColorRamp": {\r\n        "required": true,\r\n        "dataType": "colorramp",\r\n        "displayName": "${rasterFunctions.rfxArgs.colorRampName}",\r\n        "hidden": false\r\n      },\r\n      "Colormap": {\r\n        "required": true,\r\n        "dataType": "rastercolormap",\r\n        "displayName": "${rasterFunctions.rfxArgs.colormapName}",\r\n        "hidden": true\r\n      },\r\n      "Azimuth": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.azimuthName}",\r\n        "hidden": false,\r\n        "defaultValue": 315\r\n      },\r\n      "Altitude": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.altitudeName}",\r\n        "hidden": false,\r\n        "defaultValue": 45\r\n      },\r\n      "SlopeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.slopeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSlopeTypes13"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                3\r\n              ],\r\n              "active": [\r\n                "PSPower",\r\n                "PSZFactor"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "ZFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "PSPower": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.PSPowerName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.664\r\n      },\r\n      "PSZFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.PSZFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.024\r\n      },\r\n      "RemoveEdgeEffect": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.removeEdgeEffectName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "SlopeFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "DEM": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.DEMName}",\r\n        "hidden": false\r\n      },\r\n      "SlopeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.slopeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSlopeTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                3\r\n              ],\r\n              "active": [\r\n                "PSPower",\r\n                "PSZFactor"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Zfactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "PSPower": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.PSPowerName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.664\r\n      },\r\n      "PSZFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.PSZFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.024\r\n      },\r\n      "RemoveEdgeEffect": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.removeEdgeEffectName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "UnitConversionFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "FromUnit": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.fromUnitName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriUnitConversionFxUnitTypes"\r\n        }\r\n      },\r\n      "ToUnit": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.toUnitName}",\r\n        "hidden": false,\r\n        "defaultValue": 10,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriUnitConversionFxUnitTypes"\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "FromUnit",\r\n            "ToUnit"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxUnitPicker"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "StretchFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "StretchType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRasterStretchTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                0,\r\n                5\r\n              ],\r\n              "inactive": [\r\n                "MinPercent",\r\n                "MaxPercent",\r\n                "NumberOfStandardDeviation",\r\n                "SigmoidStrengthLevel"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                3\r\n              ],\r\n              "active": [\r\n                "NumberOfStandardDeviation"\r\n              ],\r\n              "inactive": [\r\n                "MinPercent",\r\n                "MaxPercent",\r\n                "SigmoidStrengthLevel"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                6\r\n              ],\r\n              "active": [\r\n                "MinPercent",\r\n                "MaxPercent"\r\n              ],\r\n              "inactive": [\r\n                "NumberOfStandardDeviation",\r\n                "SigmoidStrengthLevel"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                9\r\n              ],\r\n              "active": [\r\n                "SigmoidStrengthLevel"\r\n              ],\r\n              "inactive": [\r\n                "MinPercent",\r\n                "MaxPercent",\r\n                "NumberOfStandardDeviation"\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Min": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.minName}",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      },\r\n      "Max": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxName}",\r\n        "hidden": false,\r\n        "defaultValue": 255\r\n      },\r\n      "MinPercent": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.minPercentName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.25\r\n      },\r\n      "MaxPercent": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxPercentName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.5\r\n      },\r\n      "NumberOfStandardDeviation": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.numberOfStandardDeviationName}",\r\n        "hidden": false,\r\n        "defaultValue": 2\r\n      },\r\n      "SigmoidStrengthLevel": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.sigmoidStrengthLevelName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "numlist",\r\n          "start": 1,\r\n          "count": 6,\r\n          "inc": 1,\r\n          "asc": true\r\n        }\r\n      },\r\n      "EstimateStatsHistogram": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.estimateStatsHistogramName}",\r\n        "hidden": false,\r\n        "defaultValue": false,\r\n        "categoryRefId": "rfxArgCat_Statistics"\r\n      },\r\n      "DRA": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.DRAName}",\r\n        "hidden": false,\r\n        "defaultValue": false,\r\n        "categoryRefId": "rfxArgCat_Statistics"\r\n      },\r\n      "Statistics": {\r\n        "required": true,\r\n        "dataType": "arrayofrasterstatistics",\r\n        "displayName": "${rasterFunctions.rfxArgs.statisticsName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_Statistics"\r\n      },\r\n      "Histograms": {\r\n        "required": true,\r\n        "dataType": "arrayofrasterhistogram",\r\n        "displayName": "${rasterFunctions.rfxArgs.histogramsName}",\r\n        "hidden": true,\r\n        "categoryRefId": "rfxArgCat_Statistics"\r\n      },\r\n      "ComputeGamma": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.computeGammaName}",\r\n        "hidden": false,\r\n        "defaultValue": false,\r\n        "categoryRefId": "rfxArgCat_Gamma"\r\n      },\r\n      "UseGamma": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.useGammaName}",\r\n        "hidden": false,\r\n        "defaultValue": false,\r\n        "categoryRefId": "rfxArgCat_Gamma"\r\n      },\r\n      "Gamma": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.gammaName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_Gamma"\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "Gamma"\r\n          ],\r\n          "triggerArguments": ["Raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxGammaEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "RasterCalculatorFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false,\r\n        "allowScalar": true\r\n      },\r\n      "InputNames": {\r\n        "required": true,\r\n        "dataType": "stringarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.inputNamesName}",\r\n        "hidden": false\r\n      },\r\n      "Expression": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.expressionName}",\r\n        "hidden": false\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "Rasters",\r\n            "InputNames"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxNamedRasterEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "ClassifyFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ClassifierDefinitionFile": {\r\n        "required": true,\r\n        "dataType": "file",\r\n        "fileExtSupported": ["ecd"],\r\n        "displayName": "${rasterFunctions.rfxArgs.classifierDefinitionFileName}",\r\n        "hidden": false\r\n      },\r\n      "Raster2": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.raster2Name}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "MaskFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "NoDataInterpretation": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.noDataInterpretationName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriNoDataInterpretationTypes"\r\n        }\r\n      },\r\n      "NoDataValues": {\r\n        "required": true,\r\n        "dataType": "stringarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.noDataValuesName}",\r\n        "hidden": false,\r\n        "dataTypeAttributes": {\r\n          "type": "bandmatrix",\r\n          "nBands": "Raster",\r\n          "cols": 1,\r\n          "displayNames": [\r\n            "${rasterFunctions.rfxArgs.noDataValuesName}"\r\n          ]\r\n        }\r\n      },\r\n      "IncludedRanges": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.includedRangesName}",\r\n        "hidden": false,\r\n        "defaultValue": [0, 0],\r\n        "dataTypeAttributes": {\r\n          "type": "bandmatrix",\r\n          "nBands": "Raster",\r\n          "cols": 2,\r\n          "displayNames": [\r\n            "${rasterFunctions.rfxArgs.minimumName}",\r\n            "${rasterFunctions.rfxArgs.maximumName}"\r\n          ]\r\n        }\r\n      },\r\n      "Invert": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "hidden": true,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "ColormapToRGBFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "UnmappedAsRandomColor": {\r\n        "required": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.unmappedAsRandomColorName}",\r\n        "dataType": "boolean",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "CurvatureFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.DEMName}",\r\n        "hidden": false\r\n      },\r\n      "CurvatureType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.curvatureTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCurvatureTypes"\r\n        }\r\n      },\r\n      "ZFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      }\r\n    }\r\n  },\r\n  "CompositeBandFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "TableFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "AttributeTableAsRecordSet": {\r\n        "required": true,\r\n        "dataType": "table",\r\n        "displayName": "${rasterFunctions.rfxArgs.attributeTableName}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["Raster", "AttributeTableAsRecordSet"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxAttributeTable"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "ConvolutionFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ConvolutionType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 19,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRasterFilterTypes"\r\n        }\r\n      },\r\n      "Rows": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.rowsName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "domain": {\r\n          "type": "numlist",\r\n          "start": 1,\r\n          "count": 100,\r\n          "inc": 1,\r\n          "asc": true\r\n        }\r\n      },\r\n      "Columns": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.columnsName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "domain": {\r\n          "type": "numlist",\r\n          "start": 1,\r\n          "count": 100,\r\n          "inc": 1,\r\n          "asc": true\r\n        }\r\n      },\r\n      "Kernel": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.kernelName}",\r\n        "hidden": false\r\n      },\r\n      "MirrorEdges": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.mirrorEdgesName}",\r\n        "hidden": true,\r\n        "defaultValue": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["ConvolutionType", "Rows", "Columns", "Kernel"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxKernelSelector"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "StatisticsHistogramFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Statistics": {\r\n        "required": true,\r\n        "dataType": "rasterstatisticsarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.statisticsName}",\r\n        "hidden": false\r\n      },\r\n      "Histograms": {\r\n        "required": true,\r\n        "dataType": "rasterhistogramarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.histogramsName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "WeightedOverlayFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false\r\n      },\r\n      "Influences": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.influencesName}",\r\n        "hidden": false\r\n      },\r\n      "Fields": {\r\n        "required": true,\r\n        "dataType": "stringarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.fieldsName}",\r\n        "hidden": false\r\n      },\r\n      "Remaps": {\r\n        "required": true,\r\n        "dataType": "stringarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.remapsName}",\r\n        "hidden": false\r\n      },\r\n      "EvalFrom": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.evalFromName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "EvalTo": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.evalToName}",\r\n        "hidden": false,\r\n        "defaultValue": 9\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "Rasters",\r\n            "Influences",\r\n            "Fields",\r\n            "Remaps",\r\n            "EvalFrom",\r\n            "EvalTo"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxWeightedOverlayTableEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "WeightedSumFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false\r\n      },\r\n      "Fields": {\r\n        "required": true,\r\n        "dataType": "stringarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.fieldsName}",\r\n        "hidden": false\r\n      },\r\n      "Weights": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.weightsName}",\r\n        "hidden": false\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "Rasters",\r\n            "Fields",\r\n            "Weights"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxWeightedSumTableEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "ElevationVoidFillFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.DEMName}",\r\n        "hidden": false\r\n      },\r\n      "ShortRangeIDWRadius": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.shortRangeIDWRadiusName}",\r\n        "hidden": false,\r\n        "defaultValue": -1\r\n      },\r\n      "MaxVoidWidth": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxVoidWidthName}",\r\n        "hidden": false,\r\n        "defaultValue": -1\r\n      }\r\n    }\r\n  },\r\n  "ContourFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "DEM": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "SigmaGaussian": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.sigmaGaussianName}",\r\n        "hidden": false,\r\n        "defaultValue": 2.5\r\n      },\r\n      "ContourType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.contourTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriContourTypes"\r\n        }\r\n      },\r\n      "ZBase": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zBaseName}",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      },\r\n      "NumberOfContours": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.numberOfContoursName}",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      },\r\n      "ContourInterval": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.contourIntervalName}",\r\n        "hidden": false,\r\n        "defaultValue": 100\r\n      },\r\n      "NthContourLineInBold": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.nthContourLineInBoldName}",\r\n        "hidden": false,\r\n        "defaultValue": 5\r\n      },\r\n      "ZFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      }\r\n    }\r\n  },\r\n  "RasterizeFeatureClassFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "FeatureClass": {\r\n        "required": true,\r\n        "dataType": "featureclass",\r\n        "displayName": "${rasterFunctions.rfxArgs.featureClassName}",\r\n        "hidden": false\r\n      },\r\n      "ClassIndexField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.classIndexFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "FeatureClass"\r\n        }\r\n      },\r\n      "ResolveOverlapMethod": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.resolveOverlapMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRasterizeResolveOverlapMethod"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "ResampleFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ResamplingType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.resamplingTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "rstResamplingTypes"\r\n        }\r\n      },\r\n      "InputCellsize": {\r\n        "required": true,\r\n        "dataType": "cellsize",\r\n        "displayName": "${rasterFunctions.rfxArgs.inputCellsizeName}",\r\n        "hidden": false\r\n      },\r\n      "OutputCellsize": {\r\n        "required": true,\r\n        "dataType": "cellsize",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputCellsizeName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "TesseledCapFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "RegionGrowFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "PointFeatureClass": {\r\n        "required": true,\r\n        "dataType": "featureclass",\r\n        "displayName": "${rasterFunctions.rfxArgs.pointFeatureClassName}",\r\n        "hidden": false\r\n      },\r\n      "MaxGrowthRadiusField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxGrowthRadiusFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "PointFeatureClass"\r\n        }\r\n      },\r\n      "SimilarityThresholdField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.similarityThresholdFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "PointFeatureClass"\r\n        }\r\n      },\r\n      "FillValueField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.fillValueFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "PointFeatureClass"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "SegmentMeanShiftFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "SpectralDetail": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.spectralDetailName}",\r\n        "hidden": false,\r\n        "defaultValue": 15.5\r\n      },\r\n      "SpatialDetail": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.spatialDetailName}",\r\n        "hidden": false,\r\n        "defaultValue": 15\r\n      },\r\n      "MinNumPixelsPerSegment": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.minNumPixelsPerSegmentName}",\r\n        "hidden": false,\r\n        "defaultValue": 20\r\n      },\r\n      "BoundariesOnly": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.boundariesOnlyName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "MaxNumPixelsPerSegment": {\r\n        "required": false,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxNumPixelsPerSegment}",\r\n        "hidden": false,\r\n        "defaultValue": -1\r\n      }\r\n    }\r\n  },\r\n  "StatisticsFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "StatisticsType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.statisticsTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriFocalStatisticTypes"\r\n        }\r\n      },\r\n      "Rows": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.rowsName}",\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings",\r\n        "hidden": false,\r\n        "defaultValue": 3\r\n      },\r\n      "Columns": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.columnsName}",\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings",\r\n        "hidden": false,\r\n        "defaultValue": 3\r\n      },\r\n      "FillNoDataOnly": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.fillNoDataOnlyName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "VectorFieldFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster1": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.raster1Name}",\r\n        "hidden": false\r\n      },\r\n      "Raster2": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.raster2Name}",\r\n        "hidden": false\r\n      },\r\n      "InputDataType": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.inputDataTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "Unknown",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "uvMagDirUnkTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                "Vector-MagDir"\r\n              ],\r\n              "active": [\r\n                "AngleReferenceSystem"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "AngleReferenceSystem": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.angleReferenceSystemName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriAngleReferenceSystemTypes"\r\n        }\r\n      },\r\n      "OutputDataType": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputDataTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "Vector-MagDir",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "uvMagDirTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "InterpolateIrregularDataFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "PointFeatureClass": {\r\n        "required": true,\r\n        "dataType": "featureclass",\r\n        "dataTypeAttributes": {\r\n          "type": "point",\r\n          "hasZ": true\r\n        },\r\n        "displayName": "${rasterFunctions.rfxArgs.inputSamplePointFeatureClassName}",\r\n        "hidden": false\r\n      },\r\n      "ValueField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.valueFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "PointFeatureClass"\r\n        }\r\n      },\r\n      "RasterInfo": {\r\n        "required": true,\r\n        "dataType": "rasterinfo",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellSizeName}",\r\n        "hidden": false\r\n      },\r\n      "InterpolationMethod": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.interpolationMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriInterpolateIrregularDataMethods"\r\n        },\r\n        "editorValueTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                0\r\n              ],\r\n              "changedArgs": [\r\n                {"Radius": 3}\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                2, 3\r\n              ],\r\n              "changedArgs": [\r\n                {"Radius": 0.5}\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                4\r\n              ],\r\n              "changedArgs": [\r\n                {"Radius": 9}\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Radius": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.radiusName}",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "RasterInfo"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRasterInfoCellSizeEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "ReflectanceFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "RadianceGainValues": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.radianceGainValuesName}",\r\n        "hidden": false\r\n      },\r\n      "RadianceBiasValues": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.radianceBiasValuesName}",\r\n        "hidden": false\r\n      },\r\n      "ReflectanceGainValues": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.reflectedGainValuesName}",\r\n        "hidden": false\r\n      },\r\n      "ReflectanceBiasValues": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.reflectedBiasValuesName}",\r\n        "hidden": false\r\n      },\r\n      "SunElevation": {\r\n        "required": true,\r\n        "order": 1000,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.sunElevationName}",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      },\r\n      "Albedo": {\r\n        "required": true,\r\n        "order": 1001,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.albedoName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "ScaleFactor": {\r\n        "required": true,\r\n        "order": 1001,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.scaleFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 2147483647\r\n      },\r\n      "Offset": {\r\n        "required": true,\r\n        "order": 1001,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.offsetName}",\r\n        "hidden": false,\r\n        "defaultValue": 2147483647\r\n      }\r\n    }\r\n  },\r\n  "ThresholdFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ThresholdType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.thresholdTypeName}",\r\n        "hidden": true,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRasterThresholdTypes"\r\n        }\r\n      },\r\n      "Thresholds": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.thresholdsName}",\r\n        "hidden": true\r\n      }\r\n    }\r\n  },\r\n  "ArgStatisticsFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false\r\n      },\r\n      "ArgStatisticsType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.methodName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriArgStatisticsTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                0\r\n              ],\r\n              "active": [\r\n                "UndefinedClass"\r\n              ],\r\n              "inactive": [\r\n                "MinValue",\r\n                "MaxValue"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                1\r\n              ],\r\n              "active": [\r\n                "UndefinedClass"\r\n              ],\r\n              "inactive": [\r\n                "MinValue",\r\n                "MaxValue"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                2\r\n              ],\r\n              "active": [\r\n                ""\r\n              ],\r\n              "inactive": [\r\n                "UndefinedClass",\r\n                "MinValue",\r\n                "MaxValue"\r\n              ]\r\n            },\r\n            {\r\n              "values": [\r\n                3\r\n              ],\r\n              "active": [\r\n                "MinValue",\r\n                "MaxValue"\r\n              ],\r\n              "inactive": [\r\n                "UndefinedClass"\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "UndefinedClass": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.undefinedClassName}",\r\n        "hidden": false,\r\n        "defaultValue": 100\r\n      },\r\n      "MinValue": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.minValueName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "MaxValue": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxValueName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      }\r\n    }\r\n  },\r\n  "ArithmeticFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false,\r\n        "allowScalar": true\r\n      },\r\n      "Raster2": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.raster2Name}",\r\n        "hidden": false,\r\n        "allowScalar": true\r\n      },\r\n      "Operation": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.operationName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRasterArithmeticOperations"\r\n        }\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "ClipFunction": {\r\n    "description": "",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ClippingType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.clippingTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRasterClippingTypes"\r\n        }\r\n      },\r\n      "ClippingRaster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${widgets.rasterFunctionEditor.rfxClippingGeometry.clippingRaster}",\r\n        "hidden": false\r\n      },\r\n      "ClippingGeometry": {\r\n        "required": true,\r\n        "dataType": "geometry",\r\n        "displayName": "${rasterFunctions.rfxArgs.clippingGeometryName}",\r\n        "hidden": false\r\n      },\r\n      "Extent": {\r\n        "required": true,\r\n        "dataType": "extent",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentName}",\r\n        "hidden": false\r\n      },\r\n      "UseInputFeatureGeometry": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.useInputFeatureGeometryName}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "ClippingRaster",\r\n            "ClippingGeometry",\r\n            "Extent"\r\n          ],\r\n          "triggerArguments": ["Raster","ClippingType", "UseInputFeatureGeometry"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxClippingGeometry"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "RemapFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "UseTable": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "hidden": true,\r\n        "defaultValue": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.remapDefinitionTypeName}",\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "autoRevert": true,\r\n              "values": [\r\n                true\r\n              ],\r\n              "active": [\r\n                "Table",\r\n                "InputField",\r\n                "OutputField",\r\n                "InputMaxField",\r\n                "RemapTableType"\r\n              ],\r\n              "inactive": [\r\n                "InputRanges",\r\n                "OutputValues",\r\n                "NoDataRanges"\r\n              ]\r\n            }\r\n          ]\r\n        },\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "remapDefinitionTypes"\r\n        }\r\n      },\r\n      "InputRanges": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.inputRangeName}",\r\n        "hidden": false\r\n      },\r\n      "OutputValues": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputValuesName}",\r\n        "hidden": false\r\n      },\r\n      "OutputRanges": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputValuesName}",\r\n        "hidden": false\r\n      },\r\n      "NoDataRanges": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.noDataRangeName}",\r\n        "hidden": false\r\n      },\r\n      "Table": {\r\n        "required": true,\r\n        "dataType": "table",\r\n        "displayName": "${rasterFunctions.rfxArgs.remapsName}",\r\n        "hidden": true\r\n      },\r\n      "InputField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.inputFieldName}",\r\n        "hidden": true\r\n      },\r\n      "OutputField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputFieldName}",\r\n        "hidden": true\r\n      },\r\n      "InputMaxField": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.inputMaxFieldName}",\r\n        "hidden": true\r\n      },\r\n      "RemapTableType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.remapTableTypeName}",\r\n        "hidden": true,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "remapTableTypes"\r\n        }\r\n      },\r\n      "AllowUnmatched": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.changeMissingValuesToNoDataName}",\r\n        "reverseDisplayValue": true,\r\n        "defaultValue": true,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [true],\r\n              "active": ["ReplacementValue"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        },\r\n        "hidden": false\r\n      },\r\n      "ReplacementValue": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.replacementValue}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "InputRanges",\r\n            "OutputValues",\r\n            "NoDataRanges"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRemapGrid"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "NDVIFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "VisibleBandID": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.visibleBandIDName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "bandIndex",\r\n          "argumentName": "Raster"\r\n        }\r\n      },\r\n      "InfraredBandID": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.infraredBandIDName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "bandIndex",\r\n          "argumentName": "Raster"\r\n        }\r\n      },\r\n      "ScientificOutput": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.scientificOutputName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "BandArithmeticFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Method": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.methodName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "bandArithmeticMethods"\r\n        }\r\n      },\r\n      "BandIndexes": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandIndexesName}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["BandIndexes"],\r\n          "triggerArguments": ["Method"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxBandArithmeticBandIndexesEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "ConstantFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Constant": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.constantName}",\r\n        "hidden": false,\r\n        "defaultValue": [1]\r\n      },\r\n      "RasterInfo": {\r\n        "required": true,\r\n        "dataType": "rasterinfo",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterInfoName}",\r\n        "hidden": false\r\n      },\r\n      "Statistics": {\r\n        "required": false,\r\n        "dataType": "rasterstatisticsarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.statisticsName}",\r\n        "hidden": true\r\n      }\r\n    }\r\n  },\r\n  "CostAllocation": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "CostAllocation_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_allocation_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "source_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_source_data"\r\n        }\r\n      },\r\n      "in_cost_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "in_value_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.valueRasterName}",\r\n        "hidden": false\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_start_cost": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.startCostName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_resistance_rate": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.accumCostResistanceRateName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_capacity": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.capacityName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "CostBackLink": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "CostBackLink_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_backlink_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_start_cost": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.startCostName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_resistance_rate": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.accumCostResistanceRateName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_capacity": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.capacityName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "CostDistance": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "CostDistance_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_distance_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_start_cost": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.startCostName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_resistance_rate": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.accumCostResistanceRateName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_capacity": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.capacityName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  },\r\n    "CostPath": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "CostPath_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_destination_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_destination_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.destinationDataName}",\r\n        "hidden": false\r\n      },\r\n      "destination_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.destinationFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_destination_data"\r\n        }\r\n      },\r\n      "in_cost_distance_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.costDistanceRaster}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_backlink_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.costBacklinkRaster}",\r\n        "hidden": false\r\n      },\r\n      "path_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.pathTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "EACH_CELL",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaLeastCostPathTypes"\r\n        }\r\n      },\r\n      "force_flow_direction_convention": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.forceFlowDirectionConvention}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "EucAllocation": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "EucAllocation_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_allocation_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "source_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_source_data"\r\n        }\r\n      },\r\n      "in_barrier_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.barrierDataName}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "in_value_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.valueRasterName}",\r\n        "hidden": false\r\n      },\r\n      "cell_size": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellSizeName}",\r\n        "hidden": false\r\n      },\r\n      "distance_method" : {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": "PLANAR",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaDistanceMethods"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "PathDistance": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "PathDistance_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_distance_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.surfaceRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_horizontal_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.horizontalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["horizontal_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "horizontal_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.horizontalFactor}",\r\n        "hidden": false\r\n      },\r\n      "in_vertical_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.verticalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["vertical_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "vertical_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.verticalFactor}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_start_cost": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.startCostName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_resistance_rate": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.accumCostResistanceRateName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_capacity": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.capacityName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["horizontal_factor"],\r\n          "triggerArguments": ["in_horizontal_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["vertical_factor"],\r\n          "triggerArguments": ["in_vertical_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "PathBackLink": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "PathBackLink_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_backlink_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.surfaceRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_horizontal_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.horizontalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["horizontal_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "horizontal_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.horizontalFactor}",\r\n        "hidden": false\r\n      },\r\n      "in_vertical_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.verticalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["vertical_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "vertical_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.verticalFactor}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_start_cost": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.startCostName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_resistance_rate": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.accumCostResistanceRateName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_capacity": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.capacityName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["horizontal_factor"],\r\n          "triggerArguments": ["in_horizontal_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["vertical_factor"],\r\n          "triggerArguments": ["in_vertical_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "PathAllocation": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "PathAllocation_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_distance_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.surfaceRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_horizontal_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.horizontalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["horizontal_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "horizontal_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.horizontalFactor}",\r\n        "hidden": false\r\n      },\r\n      "in_vertical_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.verticalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["vertical_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "vertical_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.verticalFactor}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "in_value_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.valueRasterName}",\r\n        "hidden": false\r\n      },\r\n      "source_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.sourceFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_source_data"\r\n        }\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_start_cost": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.startCostName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_resistance_rate": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.accumCostResistanceRateName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_capacity": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.capacityName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["horizontal_factor"],\r\n          "triggerArguments": ["in_horizontal_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["vertical_factor"],\r\n          "triggerArguments": ["in_vertical_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "EucDistance": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "EucDistance_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_distance_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_barrier_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.barrierDataName}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "cell_size": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellSizeName}",\r\n        "hidden": false\r\n      },\r\n      "distance_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": "PLANAR",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaDistanceMethods"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "EucDirection": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "EucDirection_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_direction_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_barrier_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.barrierDataName}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "cell_size": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellSizeName}",\r\n        "hidden": false\r\n      },\r\n      "distance_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": "PLANAR",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaDistanceMethods"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "KernelDensity": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "KernelDensity_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_features"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "RasterInfo": {\r\n        "required": true,\r\n        "dataType": "rasterinfo",\r\n        "hidden": true,\r\n        "defaultValue": {\r\n          "pixelType": 9,\r\n          "bandCount": 1\r\n        }\r\n      },\r\n      "in_features": {\r\n        "required": true,\r\n        "dataType": "featureclass",\r\n        "displayName": "${rasterFunctions.rfxArgs.featureClassName}",\r\n        "hidden": false\r\n      },\r\n      "population_field": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.populationFieldName}",\r\n        "defaultValue": "NONE",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_features",\r\n          "otherOptions": {\r\n            "NONE": "${rasterFunctions.enumLabels.none}"\r\n          }\r\n        }\r\n      },\r\n      "cell_size": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellSizeName}",\r\n        "hidden": false\r\n      },\r\n      "search_radius": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.radiusName}",\r\n        "hidden": false\r\n      },\r\n      "area_unit_scale_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.areaUnitsName}",\r\n        "hidden": false,\r\n        "defaultValue": "SQUARE_MAP_UNITS",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaKernelDensityAreaUnitTypes"\r\n        }\r\n      },\r\n      "out_cell_values": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputValueTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "DENSITIES",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaKernelDensityOutValTypes"\r\n        }\r\n      },\r\n      "method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.methodName}",\r\n        "hidden": false,\r\n        "defaultValue": "PLANAR",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaKernelDensityMethods"\r\n        }\r\n      },\r\n      "in_barriers": {\r\n        "required": false,\r\n        "dataType": "featureclass",\r\n        "dataTypeAttributes": {\r\n          "type": ["polygon", "line"]\r\n        },\r\n        "displayName": "${rasterFunctions.rfxArgs.barriersName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "ShortestPath": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "ShortestPath"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_path_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_destination_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.destinationDataName}",\r\n        "hidden": false\r\n      },\r\n      "destination_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.destinationFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_destination_data"\r\n        }\r\n      },\r\n      "in_cost_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "path_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.pathTypeName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaLeastCostPathTypes"\r\n        }\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}",\r\n        "hidden": false\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_start_cost": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.startCostName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_resistance_rate": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.accumCostResistanceRateName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_capacity": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.capacityName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "Viewshed2": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "Viewshed2_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_observer_features": {\r\n        "required": true,\r\n        "dataType": "featureclass",\r\n        "displayName": "${rasterFunctions.rfxArgs.observerFeaturesName}",\r\n        "hidden": false\r\n      },\r\n      "analysis_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.analysisMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": "ALL_SIGHTLINES",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaViewshedAnalysisMethods"\r\n        },\r\n        "categoryRefId": "rfxArgCat_ViewshedParameters"\r\n      },\r\n      "analysis_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.analysisTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "FREQUENCY",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaViewshedAnalysisTypes"\r\n        },\r\n        "categoryRefId": "rfxArgCat_ViewshedParameters"\r\n      },\r\n      "vertical_error": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.verticalErrorName}",\r\n        "hidden": false,\r\n        "defaultValue": "0 Meters",\r\n        "domain": {\r\n          "type": "linearUnit",\r\n          "enum": "gpsaLinearUnitTypes"\r\n        },\r\n        "categoryRefId": "rfxArgCat_ViewshedParameters"\r\n      },\r\n      "refractivity_coefficient": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.refractivityCoefficientName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.13,\r\n        "categoryRefId": "rfxArgCat_ViewshedParameters"\r\n      },\r\n      "surface_offset": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.surfaceOffsetName}",\r\n        "hidden": false,\r\n        "defaultValue": "0 Meters",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "linearUnit",\r\n              "enum": "gpsaLinearUnitTypes"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "observer_elevation": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.observerElevationName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "linearUnit",\r\n              "enum": "gpsaLinearUnitTypes"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "observer_offset": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.observerOffsetName}",\r\n        "hidden": false,\r\n        "defaultValue": "1 Meters",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "linearUnit",\r\n              "enum": "gpsaLinearUnitTypes"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "inner_radius": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.innerRadiusName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "linearUnit",\r\n              "enum": "gpsaLinearUnitTypes"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "inner_radius_is_3d": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.innerRadiusIs3DDistanceName}",\r\n        "hidden": false,\r\n        "defaultValue": false,\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "outer_radius": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outerRadiusName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "linearUnit",\r\n              "enum": "gpsaLinearUnitTypes"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "outer_radius_is_3d": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.outerRadiusIs3DDistanceName}",\r\n        "hidden": false,\r\n        "defaultValue": false,\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "horizontal_start_angle": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.horizontalStartAngleName}",\r\n        "hidden": false,\r\n        "defaultValue": "0",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "horizontal_end_angle": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.horizontalEndAngleName}",\r\n        "hidden": false,\r\n        "defaultValue": "360",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "vertical_upper_angle": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.verticalUpperAngleName}",\r\n        "hidden": false,\r\n        "defaultValue": "90",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      },\r\n      "vertical_lower_angle": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.verticalLowerAngleName}",\r\n        "hidden": false,\r\n        "defaultValue": "-90",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [{\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_observer_features"\r\n            }\r\n          ]\r\n        },\r\n        "categoryRefId": "rfxArgCat_ObserverParameters"\r\n      }\r\n    }\r\n  },\r\n  "ZonalStatistics": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "ZonalStatistics_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_value_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_zone_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneDataName}",\r\n        "hidden": false\r\n      },\r\n      "zone_field": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_zone_data"\r\n        }\r\n      },\r\n      "in_value_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.valueRasterName}",\r\n        "hidden": false\r\n      },\r\n      "statistics_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.statisticsTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "MEAN",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaZonalStatisticsTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": ["PERCENTILE"],\r\n              "active": ["percentile_value"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            },\r\n            {\r\n              "values": ["PERCENTILE", "MEDIAN"],\r\n              "active": ["percentile_interpolation_type"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            },\r\n            {\r\n              "values": ["MAXIMUM", "MINIMUM", "RANGE", "PERCENTILE", "MEDIAN", "SUM"],\r\n              "active": [],\r\n              "inactive": ["circular_calculation", "circular_wrap_value"],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "percentile_value": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.percentileValue}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_Percentile",\r\n        "defaultValue": 90\r\n      },\r\n      "percentile_interpolation_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.percentileInterpolationType}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_Percentile",\r\n        "defaultValue": "AUTO_DETECT",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaZonalPercentileInterpolationTypes"\r\n        }\r\n      },\r\n      "circular_calculation": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.circularCalculation}",\r\n        "hidden": false,\r\n        "defaultValue": "ARITHMETIC",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaCircularCalculation"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": ["ARITHMETIC"],\r\n              "active": [],\r\n              "inactive": ["circular_wrap_value"],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "circular_wrap_value": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.circularWrapValue}",\r\n        "hidden": false,\r\n        "defaultValue": 360.0\r\n      },\r\n      "ignore_nodata": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.ignoreNoDataName}",\r\n        "hidden": false,\r\n        "defaultValue": "DATA",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaIgnoreNoData"\r\n        }\r\n      },\r\n      "process_as_multidimensional": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.processMultidimensional}",\r\n        "hidden": false,\r\n        "defaultValue": "CURRENT_SLICE",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaProcessAsMultidimensionalOptions"\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["statistics_type"],\r\n          "triggerArguments": ["in_value_raster"],\r\n          "triggerAttributes": "pixelType:in_value_raster,float,MEAN|MAXIMUM|MINIMUM|RANGE|STD|SUM",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFilteredArgumentEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["percentile_value"],\r\n          "triggerAttributes": "minValue:0;maxValue:100",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRangedValueEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "HeatIndex": {\r\n    "rasterFunctionArguments": {\r\n      "PythonModule": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "ClassName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "temperature": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.temperatureRasterName}",\r\n        "hidden": false\r\n      },\r\n      "units": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.inTemperatureUnitsName}",\r\n        "hidden": false,\r\n        "defaultValue": "Fahrenheit",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "pyStdTemperatureUnitTypes"\r\n        }\r\n      },\r\n      "rh": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.relativeHumidityRasterName}",\r\n        "hidden": false\r\n      },\r\n      "outunits": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outHeatIndexTemperatureUnitsName}",\r\n        "hidden": false,\r\n        "defaultValue": "Fahrenheit",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "pyStdTemperatureUnitTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "Windchill": {\r\n    "rasterFunctionArguments": {\r\n      "PythonModule": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "ClassName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "temperature": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.temperatureRasterName}",\r\n        "hidden": false\r\n      },\r\n      "tunits": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.inTemperatureUnitsName}",\r\n        "hidden": false,\r\n        "defaultValue": "Fahrenheit",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "pyStdTemperatureUnitTypes"\r\n        }\r\n      },\r\n      "ws": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.windSpeedRasterName}",\r\n        "hidden": false\r\n      },\r\n      "wunits": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.inWindSpeedUnitsName}",\r\n        "hidden": false,\r\n        "defaultValue": "mph",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "pyStdWindspeedUnitTypes"\r\n        }\r\n      },\r\n      "ounits": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outWindChillTemperatureUnitsName}",\r\n        "hidden": false,\r\n        "defaultValue": "Fahrenheit",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "pyStdTemperatureUnitTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "KeyMetadata": {\r\n    "rasterFunctionArguments": {\r\n      "PythonModule": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "ClassName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "property": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.propertyName}",\r\n        "hidden": false\r\n      },\r\n      "value": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.valueName}",\r\n        "hidden": false\r\n      },\r\n      "bands": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandNamesName}",\r\n        "hidden": false\r\n      },\r\n      "json": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.jsonName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "RasterizeAttributes": {\r\n    "rasterFunctionArguments": {\r\n      "PythonModule": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "ClassName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "vraster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.valueRasterName}",\r\n        "hidden": false\r\n      },\r\n      "zraster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneDataName}",\r\n        "hidden": false\r\n      },\r\n      "ztable": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneTableName}",\r\n        "hidden": false\r\n      },\r\n      "zid": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneFieldName}",\r\n        "hidden": false\r\n      },\r\n      "attribs": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.attributeFieldNames}",\r\n        "hidden": false\r\n      },\r\n      "background": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.backgroundName}",\r\n        "hidden": false\r\n      },\r\n      "where": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.whereClauseName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "ZonalRemap": {\r\n    "rasterFunctionArguments": {\r\n      "PythonModule": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "ClassName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "vraster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.valueRasterName}",\r\n        "hidden": false\r\n      },\r\n      "zraster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneDataName}",\r\n        "hidden": false\r\n      },\r\n      "ztable": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneTableName}",\r\n        "hidden": false\r\n      },\r\n      "zid": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneFieldName}",\r\n        "hidden": false\r\n      },\r\n      "zmin": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumValueFieldName}",\r\n        "hidden": false\r\n      },\r\n      "zmax": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumValueFieldName}",\r\n        "hidden": false\r\n      },\r\n      "zval": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outValueFieldName}",\r\n        "hidden": false\r\n      },\r\n      "background": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.backgroundName}",\r\n        "hidden": false\r\n      },\r\n      "defzval":  {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.defaultValueName}",\r\n        "hidden": false\r\n      },\r\n      "where": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.whereClauseName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "AspectSlope": {\r\n    "rasterFunctionArguments": {\r\n      "PythonModule": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "ClassName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true\r\n      },\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "zf": {\r\n        "required": true,\r\n        "displayName": "${rasterFunctions.rfxArgs.zFactorName}",\r\n        "hidden": false,\r\n        "dataType": "double"\r\n      }\r\n    }\r\n  },\r\n\r\n  "LocalFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false,\r\n        "allowScalar": true,\r\n        "nElementsArgument": "Operation",\r\n        "elementInfos": [\r\n            {\r\n              "values": [78],\r\n              "inputArgs": [\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                },\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.trueRasterName}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                },\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.falseRasterName}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              "values": [1, 2, 3, 5, 11, 12, 14, 15, 16, 17, 19, 20, 23, 24, 28, 29, 33, 34, 44, 46, 61],\r\n              "inputArgs": [\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                },\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.raster2Name}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              "values": [50],\r\n              "inputArgs": [\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                },\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.falseRasterName}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              "values": [4, 6, 7, 8, 9, 10, 13, 18, 21, 22, 25, 26, 27, 30, 31, 32, 35, 36, 37, 45, 48, 49, 51, 52, 53, 56, 57, 59, 60],\r\n              "inputArgs": [\r\n                {\r\n                  "required": true,\r\n                  "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n                  "hidden": false,\r\n                  "allowScalar": true\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n      },\r\n      "Operation": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.operationName}",\r\n        "hidden": true,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "localFunctionOperations"\r\n        }\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "CellStatisticsFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false,\r\n        "allowScalar": true\r\n      },\r\n      "Operation": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.operationName}",\r\n        "hidden": false,\r\n        "defaultValue": 40,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "cellStatisticsTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [93, 94],\r\n              "active": ["PercentileValue"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            },\r\n            {\r\n              "values": [93, 94, 41, 69],\r\n              "active": ["PercentileInterpolationType"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "ProcessAsMultiband": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.processAsMultiband}",\r\n        "hidden": false\r\n      },\r\n      "PercentileValue": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.percentileValue}",\r\n        "hidden": false,\r\n        "defaultValue": 90\r\n      },\r\n      "PercentileInterpolationType": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.percentileInterpolationType}",\r\n        "hidden": false,\r\n        "defaultValue": "AUTO_DETECT",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaZonalPercentileInterpolationTypes"\r\n        }\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "SpectralConversionFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ConversionMatrix": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName": "${rasterFunctions.rfxArgs.conversionMatrixName}",\r\n        "hidden": false\r\n      },\r\n      "IsPseudoColorOutput": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.IsPseudoColorOutputName}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "ConversionMatrix"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxConversionGrid"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n\r\n  "Watershed": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "Watershed_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_flow_direction_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_flow_direction_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.flowDirRasterName}"\r\n      },\r\n      "in_pour_point_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.pourPointName}"\r\n      },\r\n      "pour_point_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.pourPointFieldName}",\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_pour_point_data"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "GeometricFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "UseDEM": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.methodName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "geometricCorrectionMethods"\r\n        },\r\n        "defaultValue": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                true\r\n              ],\r\n              "active": [\r\n                "DEM",\r\n                "ZFactor",\r\n                "ZOffset",\r\n                "CorrectGeoid"\r\n              ],\r\n              "inactive": [\r\n                "ConstantZ"\r\n              ],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "ConstantZ": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.constantZName}",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      },\r\n      "DEM": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.DEMName}",\r\n        "hidden": false\r\n      },\r\n      "ZFactor": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "ZOffset": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zOffsetName}",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      },\r\n      "CorrectGeoid": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.geoIdName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "Tolerance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "Tolerance (Pixels)",\r\n        "hidden": false,\r\n        "defaultValue": 0\r\n      }\r\n    }\r\n  },\r\n  "RadarCalibrationFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "CalibrationType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.calibrationTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRadarCalibrations"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "S1RadiometricCalibrationFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "CalibrationType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.calibrationTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRadarCalibrations"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "SpeckleFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "FilterType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.filterTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSpeckleFilterTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                0\r\n              ],\r\n              "active": [\r\n                "NoiseModel"\r\n              ],\r\n              "inactive": [\r\n                "DampFactor"\r\n              ],\r\n              "autoRevert": true\r\n            },\r\n            {\r\n              "values": [\r\n                1\r\n              ],\r\n              "active": [\r\n                "NLooks",\r\n                "DampFactor"\r\n              ],\r\n              "inactive": [\r\n                "NoiseVar",\r\n                "AdditiveNoiseMean",\r\n                "MultiplicativeNoiseMean"\r\n              ],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [\r\n                2\r\n              ],\r\n              "active": [\r\n                "DampFactor"\r\n              ],\r\n              "inactive": [\r\n                "NoiseVar",\r\n                "AdditiveNoiseMean",\r\n                "MultiplicativeNoiseMean",\r\n                "NLooks"\r\n              ],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [\r\n                3\r\n              ],\r\n              "active": [\r\n                "NLooks"\r\n              ],\r\n              "inactive": [\r\n                "NoiseVar",\r\n                "AdditiveNoiseMean",\r\n                "MultiplicativeNoiseMean",\r\n                "DampFactor"\r\n              ],\r\n              "autoRevert": false\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "FilterSize": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.filterSizeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSpeckleFilterKernelTypes"\r\n        }\r\n      },\r\n      "NoiseModel": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.noiseModelName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSpeckleNoiseModelTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [\r\n                0\r\n              ],\r\n              "active": [\r\n                "MultiplicativeNoiseMean",\r\n                "NLooks"\r\n              ],\r\n              "inactive": [\r\n                "NoiseVar",\r\n                "AdditiveNoiseMean"\r\n\r\n              ],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [\r\n                1\r\n              ],\r\n              "active": [\r\n                "NoiseVar"\r\n              ],\r\n              "inactive": [\r\n                "AdditiveNoiseMean",\r\n                "MultiplicativeNoiseMean",\r\n                "NLooks"\r\n\r\n              ],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [\r\n                2\r\n              ],\r\n              "active": [\r\n                "NoiseVar",\r\n                "AdditiveNoiseMean",\r\n                "MultiplicativeNoiseMean"\r\n              ],\r\n              "inactive": [\r\n                "NLooks"\r\n              ],\r\n              "autoRevert": false\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "NoiseVar": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.noiseVarianceName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.25\r\n      },\r\n      "AdditiveNoiseMean": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.additiveNoiseMeanName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.0\r\n      },\r\n      "MultiplicativeNoiseMean": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.multiplicativeNoiseMeanName}",\r\n        "hidden": false,\r\n        "defaultValue": 1.0\r\n      },\r\n      "NLooks": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.numberofLooksName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "DampFactor": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.dampingFactorName}",\r\n        "hidden": false,\r\n        "defaultValue": 1.0\r\n      }\r\n    }\r\n  },\r\n\r\n  "MosaicRastersFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false\r\n      },\r\n      "MosaicType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.operationName}",\r\n        "hidden": false,\r\n        "defaultValue": 6,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriMosaicOperatorTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "Nibble": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "Nibble_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_mask_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.maskRasterName}",\r\n        "hidden": false\r\n      },\r\n      "nibble_values": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.nibbleValuesName}",\r\n        "hidden": false,\r\n        "defaultValue": "ALL_VALUES",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaNibbleValues"\r\n        }\r\n      },\r\n      "nibble_nodata": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.nibbleNoDataName}",\r\n        "hidden": false,\r\n        "defaultValue": "PRESERVE_NODATA",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaNibbleNoData"\r\n        }\r\n      },\r\n      "in_zone_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneDataName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "SwathFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "InterpolationMethod": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.interpolationMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSwathInterpolationMethods"\r\n        }\r\n      },\r\n      "RasterInfo": {\r\n        "required": true,\r\n        "dataType": "rasterinfo",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellSizeName}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "RasterInfo"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRasterInfoCellSizeEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n\r\n  "Fill": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "Fill_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_surface_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_surface_raster"\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "z_limit": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.zLimitName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n   "FlowAccumulation": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "FlowAccumulation_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_flow_direction_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_accumulation_raster"\r\n      },\r\n      "in_flow_direction_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_weight_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.weightRasterName}",\r\n        "hidden": false\r\n      },\r\n      "data_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputDataTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "FLOAT",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaOutputDataType"\r\n        }\r\n      },\r\n      "flow_direction_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.flowDirectionTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "D8",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaFlowDirectionType"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n   "FlowDirection": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "FlowDirection_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_surface_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_flow_direction_raster"\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "force_flow": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.forceEdgeName}",\r\n        "hidden": false,\r\n        "defaultValue": "NORMAL",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaForceFlow"\r\n        }\r\n      },\r\n      "flow_direction_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.flowDirectionTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "D8",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaFlowDirectionType"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "FlowDistance": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "FlowDistance_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_stream_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_stream_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.streamRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.surfaceRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_flow_direction_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.flowDirRasterName}"\r\n      },\r\n      "distance_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "VERTICAL",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaFlowDistanceType"\r\n        }\r\n      },\r\n      "flow_direction_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.flowDirectionTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "D8",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaFlowDirectionType"\r\n        }\r\n      },\r\n      "statistics_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.statisticsTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": "MINIMUM",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaFlowDistanceStatsType"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "FlowLength": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "FlowLength_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_flow_direction_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_flow_direction_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.flowDirRaster}",\r\n        "hidden": false\r\n      },\r\n      "direction_measurement": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.directionMeasurementName}",\r\n        "hidden": false,\r\n        "defaultValue": "DOWNSTREAM",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaDirectionMeasurementType"\r\n        }\r\n      },\r\n      "in_weight_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.weightRasterName}",\r\n        "hidden": false\r\n      },\r\n      "MatchVariable": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "hidden": true\r\n      },\r\n      "UnionDimension": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "hidden": true\r\n      }\r\n    }\r\n  },\r\n\r\n  "Corridor": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "Corridor_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_distance_raster1"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_distance_raster1": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.distanceRaster1}",\r\n        "hidden": false\r\n      },\r\n      "in_distance_raster2": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.distanceRaster2}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "StreamLink": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "StreamLink_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_stream_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_stream_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.streamRaster}",\r\n        "hidden": false\r\n      },\r\n      "in_flow_direction_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.flowDirRaster}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "StreamOrder": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "StreamOrder_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_stream_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_stream_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.streamRaster}",\r\n        "hidden": false\r\n      },\r\n      "in_flow_direction_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.flowDirRaster}",\r\n        "hidden": false\r\n      },\r\n      "order_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.orderMethodName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaOrderMethodType"\r\n        },\r\n        "defaultValue": "STRAHLER"\r\n      },\r\n      "MatchVariable": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "hidden": true\r\n      },\r\n      "UnionDimension": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "hidden": true\r\n      }\r\n    }\r\n  },\r\n\r\n    "RegionGroup": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "RegionGroup_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.zoneDataName}",\r\n        "hidden": false\r\n      },\r\n      "number_neighbors": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.numberNeighborCells}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaNumberNeighborCells"\r\n        }\r\n      },\r\n      "zone_connectivity": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.zoneConnectivity}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaZoneConnectivity"\r\n        }\r\n      },\r\n      "add_link": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.addLinkBehavior}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaAddLink"\r\n        }\r\n      },\r\n      "excluded_value": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.excludedValue}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "BufferedRasterFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "hasArgumentsObject": true\r\n  },\r\n\r\n  "ColorspaceConversionFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ConversionType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.conversionType}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "colorspaceConversionTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "ComplexFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "TasseledCapFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "RasterInfoFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "RasterInfo": {\r\n        "required": true,\r\n        "dataType": "rasterinfo",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterInfoName}",\r\n        "hidden": false\r\n      },\r\n      "Statistics": {\r\n        "required": false,\r\n        "dataType": "rasterstatisticsarray",\r\n        "displayName":"${rasterFunctions.rfxArgs.statisticsName}",\r\n        "hidden": true\r\n      },\r\n       "Overwrite": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "hidden": true\r\n      }\r\n    }\r\n  },\r\n\r\n  "RecastFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Arguments": {\r\n        "required": true,\r\n        "dataType": "propertyset",\r\n        "displayName":"${rasterFunctions.rfxArgs.overridesName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "LookupFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Field": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.fieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "Raster"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "MLClassifyFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "SignatureFile": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.signatureFileOrUrl}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "PansharpeningFunction": {\r\n    "rasterFunctionArguments": {\r\n      "MSImage": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.multispectralName}",\r\n        "hidden": false\r\n      },\r\n      "PanImage": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.panchromaticName}",\r\n        "hidden": false\r\n      },\r\n      "PansharpeningType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.pansharpeningType}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "pansharpeningTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [4],\r\n              "active": ["Sensor"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            },\r\n            {\r\n              "values": [3],\r\n              "active": [],\r\n              "inactive": ["Weights"],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        },\r\n        "editorValueTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [0, 1],\r\n              "changedArgs": [{ "Weights": [0.334, 0.333, 0.333, 0] }]\r\n            },\r\n            {\r\n              "values": [2],\r\n              "changedArgs": [{ "Weights": [0.166, 0.167, 0.167, 0.5] }]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Sensor": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName":"${rasterFunctions.rfxArgs.sensorName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "sensorTypes"\r\n        }\r\n      },\r\n      "Weights": {\r\n        "displayName":"${rasterFunctions.rfxArgs.weightsName}",\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "hidden": false,\r\n        "defaultValue": [0.166, 0.167, 0.167, 0.5],\r\n        "dataTypeAttributes": {\r\n          "type": "bandmatrix",\r\n          "nBands": "Raster",\r\n          "cols": 4,\r\n          "hasIdColumn": false,\r\n          "isExtensible": false,\r\n          "displayNames": [\r\n           "${rasterFunctions.rfxArgs.redName}",\r\n           "${rasterFunctions.rfxArgs.greenName}",\r\n           "${rasterFunctions.rfxArgs.blueName}",\r\n           "${rasterFunctions.rfxArgs.infraredName}"\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["Sensor"],\r\n          "triggerArguments": ["Weights"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxPansharpenSensorPicker"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n\r\n  "ReprojectFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "SpatialReference": {\r\n        "required": true,\r\n        "dataType": "spatialReference",\r\n        "displayName":"${rasterFunctions.rfxArgs.spatialReferenceName}",\r\n        "hidden": false\r\n      },\r\n      "XCellsize": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.xCellsizeName}",\r\n        "hidden": false\r\n      },\r\n      "YCellsize": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.yCellsizeName}",\r\n        "hidden": false\r\n      },\r\n      "XOrigin": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.xOriginName}",\r\n        "hidden": false\r\n      },\r\n      "YOrigin": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.yOriginName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "S1ThermalNoiseRemovalFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "FocalFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "NeighborhoodType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.neighborhoodType}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriFocalNeighborhoodTypes"\r\n        },\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings",\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [{\r\n              "values": [1],\r\n              "active": ["Width", "Height"],\r\n              "inactive": [\r\n                "Radius", "InnerRadius", "OuterRadius", "StartAngle", "EndAngle", "NeighborhoodValues"\r\n              ]\r\n            },\r\n            {\r\n              "values": [2],\r\n              "active": ["Radius"],\r\n              "inactive": [\r\n                "Width",\r\n                "Height",\r\n                "InnerRadius",\r\n                "OuterRadius",\r\n                "StartAngle",\r\n                "EndAngle",\r\n                "NeighborhoodValues"\r\n              ]\r\n            },\r\n            {\r\n              "values": [3],\r\n              "active": ["InnerRadius", "OuterRadius"],\r\n              "inactive": [\r\n                "Width", "Height", "Radius", "StartAngle", "EndAngle", "NeighborhoodValues"\r\n              ]\r\n            },\r\n            {\r\n              "values": [4],\r\n              "active": [\r\n                "Radius", "StartAngle", "EndAngle"\r\n              ],\r\n              "inactive": [\r\n                "Width", "Height", "InnerRadius", "OuterRadius", "NeighborhoodValues"\r\n              ]\r\n            },\r\n            {\r\n              "values": [5, 6],\r\n              "active": [\r\n                "Width", "Height", "NeighborhoodValues"\r\n              ],\r\n              "inactive": [\r\n                "Radius", "InnerRadius", "OuterRadius", "StartAngle", "EndAngle"\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Width": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.widthName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "Height": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.heightName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "InnerRadius": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.innerRadiusName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "OuterRadius": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.outerRadiusName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "Radius": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.radiusName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "StartAngle": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.startAngleName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "EndAngle": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.endAngleName}",\r\n        "hidden": false,\r\n        "defaultValue": 90,\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "NeighborhoodValues": {\r\n        "required": true,\r\n        "dataType": "doublearray",\r\n        "displayName":"${rasterFunctions.rfxArgs.neighborhoodValues}",\r\n        "hidden": false,\r\n        "defaultValue": [0, 1, 0, 1, 1, 1, 0, 1, 0],\r\n        "categoryRefId": "rfxArgCat_NeighborhoodSettings"\r\n      },\r\n      "StatisticType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName":"${rasterFunctions.rfxArgs.statisticsTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 3,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriGAFocalStatisticsTypes"\r\n        },\r\n        "categoryRefId": "rfxArgCat_FocalStatistics",\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [12],\r\n              "active": ["Percentile"],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "Percentile": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName":"${rasterFunctions.rfxArgs.percentileName}",\r\n        "hidden": false,\r\n        "defaultValue": 90,\r\n        "categoryRefId": "rfxArgCat_FocalStatistics"\r\n      },\r\n      "NoDataPolicy": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName":"${rasterFunctions.rfxArgs.ignoreNoDataName}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["StatisticType"],\r\n          "triggerArguments": ["Raster", "NeighborhoodType"],\r\n          "triggerAttributes": "pixelType:Raster,float,3|2|4|5|12|7|8|9;value:NeighborhoodType,6,3|8|9",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFilteredArgumentEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["NeighborhoodType"],\r\n          "triggerArguments": ["StatisticType"],\r\n          "triggerAttributes": "value:StatisticType,1|2|4|5|6|7|10,1|2|3|4|5",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFilteredArgumentEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["NeighborhoodValues"],\r\n          "triggerArguments": ["Width", "Height"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxNeighborhoodValues"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["Width"],\r\n          "triggerAttributes": "minValue:1",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRangedValueEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["Height"],\r\n          "triggerAttributes": "minValue:1",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRangedValueEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["Radius"],\r\n          "triggerAttributes": "minValue:1",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRangedValueEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["InnerRadius"],\r\n          "triggerAttributes": "minValue:1;lessThan:OuterRadius",\r\n          "triggerArguments": ["OuterRadius"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRangedValueEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["OuterRadius"],\r\n          "triggerAttributes": "minValue:2;greaterThan:InnerRadius",\r\n          "triggerArguments": ["InnerRadius"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRangedValueEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["Percentile"],\r\n          "triggerAttributes": "minValue:0;maxValue:100",\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxRangedValueEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n\r\n  "TransposeBitsFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ConstantFillCheck": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName":"${rasterFunctions.rfxArgs.constantFillCheck}",\r\n        "hidden": false,\r\n        "defaultValue": true,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "boolean"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [{\r\n            "values": [\r\n              true\r\n            ],\r\n            "active": [\r\n              "ConstantFillValue"\r\n            ],\r\n            "inactive": [\r\n              "FillRaster"\r\n            ],\r\n            "autoRevert": true\r\n          }]\r\n        }\r\n      },\r\n      "FillRaster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.fillRaster}",\r\n        "hidden": false\r\n      },\r\n      "ConstantFillValue": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "defaultValue": 0,\r\n        "displayName":"${rasterFunctions.rfxArgs.constantFillValue}",\r\n        "hidden": false\r\n      },\r\n      "InputBitPositions": {\r\n        "required": true,\r\n        "dataType": "longarray",\r\n        "displayName":"${rasterFunctions.rfxArgs.inputBitPositions}",\r\n        "hidden": false\r\n      },\r\n      "OutputBitPositions": {\r\n        "required": true,\r\n        "dataType": "longarray",\r\n        "displayName":"${rasterFunctions.rfxArgs.outputBitPositions}",\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": [\r\n            "InputBitPositions",\r\n            "OutputBitPositions"\r\n          ],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxTransposeBit"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n\r\n  "Sink": {\r\n   "rasterFunctionArguments": {\r\n     "ToolName": {\r\n       "required": true,\r\n       "dataType": "string",\r\n       "hidden": true,\r\n       "defaultValue": "Sink_sa"\r\n     },\r\n     "PrimaryInputParameterName": {\r\n       "required": true,\r\n       "dataType": "string",\r\n       "hidden": true,\r\n       "defaultValue": "in_flow_direction_raster"\r\n     },\r\n     "OutputRasterParameterName": {\r\n       "required": true,\r\n       "dataType": "string",\r\n       "hidden": true,\r\n       "defaultValue": "out_raster"\r\n     },\r\n     "in_flow_direction_raster": {\r\n       "required": true,\r\n       "dataType": "raster",\r\n       "displayName": "${rasterFunctions.rfxArgs.flowDirRaster}",\r\n       "hidden": false\r\n     },\r\n     "MatchVariable": {\r\n       "required": false,\r\n       "dataType": "boolean",\r\n       "hidden": true\r\n     },\r\n     "UnionDimension": {\r\n       "required": false,\r\n       "dataType": "boolean",\r\n       "hidden": true\r\n     }\r\n   }\r\n },\r\n\r\n   "SnapPourPoint": {\r\n   "rasterFunctionArguments": {\r\n     "ToolName": {\r\n       "required": true,\r\n       "dataType": "string",\r\n       "hidden": true,\r\n       "defaultValue": "SnapPourPoint_sa"\r\n     },\r\n     "PrimaryInputParameterName": {\r\n       "required": true,\r\n       "dataType": "string",\r\n       "hidden": true,\r\n       "defaultValue": "in_pour_point_data"\r\n     },\r\n     "OutputRasterParameterName": {\r\n       "required": true,\r\n       "dataType": "string",\r\n       "hidden": true,\r\n       "defaultValue": "out_raster"\r\n     },\r\n     "in_pour_point_data": {\r\n       "required": false,\r\n       "dataType": "raster",\r\n       "displayName": "${rasterFunctions.rfxArgs.pourPointDataName}",\r\n       "hidden": false\r\n     },\r\n     "in_accumulation_raster": {\r\n       "required": false,\r\n       "dataType": "raster",\r\n       "displayName": "${rasterFunctions.rfxArgs.accumulationRasterName}",\r\n       "hidden": false\r\n     },\r\n     "snap_distance": {\r\n       "required": false,\r\n       "dataType": "double",\r\n       "displayName": "${rasterFunctions.rfxArgs.snapDistanceName}",\r\n       "hidden": false,\r\n       "defaultValue": 0\r\n     },\r\n     "pour_point_field": {\r\n       "required": false,\r\n       "dataType": "string",\r\n       "hidden": false,\r\n       "displayName": "${rasterFunctions.rfxArgs.pourPointFieldName}",\r\n       "domain": {\r\n         "type": "fields",\r\n         "argumentName": "in_pour_point_data"\r\n       }\r\n     },\r\n     "MatchVariable": {\r\n       "required": false,\r\n       "dataType": "boolean",\r\n       "hidden": true\r\n     },\r\n     "UnionDimension": {\r\n       "required": false,\r\n       "dataType": "boolean",\r\n       "hidden": true\r\n     }\r\n   }\r\n  },\r\n  "EucBackDirection": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "EucBackDirection_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_back_direction_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_barrier_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.barrierDataName}",\r\n        "hidden": false\r\n      },\r\n      "maximum_distance": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.maxDistanceName}"\r\n      },\r\n      "cell_size": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.cellSizeName}"\r\n      },\r\n      "distance_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceMethodName}",\r\n        "defaultValue": "PLANAR",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaDistanceMethods"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "DistanceAllocation": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "DistanceAllocation_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_distance_allocation_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "source_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_source_data"\r\n        }\r\n      },\r\n      "in_barrier_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.barrierDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.surfaceRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_vertical_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.verticalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["vertical_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "vertical_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.verticalFactor}",\r\n        "hidden": false\r\n      },\r\n      "in_horizontal_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.horizontalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["horizontal_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "horizontal_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.horizontalFactor}",\r\n        "hidden": false\r\n      },\r\n      "generate_source_location_bands": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceLocationBands}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "distance_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceMethodName}",\r\n        "defaultValue": "PLANAR",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaDistanceMethods"\r\n        }\r\n      },\r\n      "source_initial_accumulation": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.initialAccumulation}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_maximum_accumulation": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumAccumulation}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["horizontal_factor"],\r\n          "triggerArguments": ["in_horizontal_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["vertical_factor"],\r\n          "triggerArguments": ["in_vertical_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "DistanceAccumulation": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "DistanceAccumulation_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_source_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_distance_accumulation_raster"\r\n      },\r\n      "in_source_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.sourceDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_barrier_data": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.barrierDataName}",\r\n        "hidden": false\r\n      },\r\n      "in_surface_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.surfaceRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_cost_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_vertical_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.verticalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["vertical_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "vertical_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.verticalFactor}",\r\n        "hidden": false\r\n      },\r\n      "in_horizontal_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.horizontalRaster}",\r\n        "hidden": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [],\r\n              "checkValuePresent": true,\r\n              "active": ["horizontal_factor"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "horizontal_factor": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.horizontalFactor}",\r\n        "hidden": false\r\n      },\r\n      "generate_back_direction_band": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.backDirectionBand}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "distance_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceMethodName}",\r\n        "defaultValue": "PLANAR",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaDistanceMethods"\r\n        }\r\n      },\r\n      "source_initial_accumulation": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.initialAccumulation}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_maximum_accumulation": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumAccumulation}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_cost_multiplier": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.costMultiplierName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "number"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "source_direction": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.travelDirectionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_SourceCharacteristics",\r\n        "domain": {\r\n          "type": "switchable",\r\n          "attributes": [\r\n            {\r\n              "type": "list",\r\n              "enum": "gpsaTravelDirections",\r\n              "defaultValue": "FROM_SOURCE"\r\n            },\r\n            {\r\n              "type": "field",\r\n              "argumentName": "in_source_data"\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["horizontal_factor"],\r\n          "triggerArguments": ["in_horizontal_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        },\r\n        {\r\n          "argumentNames": ["vertical_factor"],\r\n          "triggerArguments": ["in_vertical_raster"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxFactorFunctionEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "Shrink": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "Shrink_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "number_cells": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.numberOfCells}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "zone_values": {\r\n        "required": true,\r\n        "dataType": "longarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneValues}",\r\n        "hidden": false\r\n      },\r\n      "shrink_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.shrinkMethod}",\r\n        "hidden": true,\r\n        "defaultValue": "DISTANCE",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaExpandMethod"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "BoundaryClean": {\r\n    "category": "dataManagement",\r\n    "icon": "boundaryClean.png",\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "BoundaryClean_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_raster": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "sort_type": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.sortType}",\r\n        "hidden": false,\r\n        "defaultValue": "NO_SORT",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaSortType"\r\n        }\r\n      },\r\n      "number_of_runs": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.numberOfRuns}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      }\r\n    }\r\n  },\r\n\r\n  "Expand": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "Expand_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_raster"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "number_cells": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.numberOfCells}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "zone_values": {\r\n        "required": true,\r\n        "dataType": "longarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.zoneValues}",\r\n        "hidden": false\r\n      },\r\n      "expand_method": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.expandMethod}",\r\n        "hidden": true,\r\n        "defaultValue": "DISTANCE",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaExpandMethod"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "SpectralUnmixingFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "SpectralProfileType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.inputSpectralProfileType}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum":"spectralProfileFileTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [0],\r\n              "active": ["SpectralProfileFile"],\r\n              "inactive": ["TrainingFeature"],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "SpectralProfileFile": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.spectralProfileName}",\r\n        "hidden": false\r\n      },\r\n      "TrainingFeature": {\r\n        "required": true,\r\n        "dataType": "featureclass",\r\n        "displayName": "${rasterFunctions.rfxArgs.trainingFeatureName}",\r\n        "hidden": false\r\n      },\r\n      "NonNegative": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.nonNegative}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "SumToOne": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.sumToOne}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "RandomFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Distribution" : {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.randomDistribution}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "randomDistributionType"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [1],\r\n              "active": ["MinimumUniform","MaximumUniform"],\r\n              "inactive": ["MinimumInteger","MaximumInteger","NormalMean","ExponentialMean","StandardDeviation","Alpha","Beta","N","Probability","r"]\r\n            },\r\n            {\r\n              "values": [2],\r\n              "active": ["MinimumInteger","MaximumInteger"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","NormalMean","ExponentialMean","StandardDeviation","Alpha","Beta","N","Probability","r"]\r\n            },\r\n            {\r\n              "values": [3],\r\n              "active": ["NormalMean","StandardDeviation"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","MinimumInteger","MaximumInteger","ExponentialMean","Alpha","Beta","N","Probability","r"]\r\n            },\r\n            {\r\n              "values": [4],\r\n              "active": ["ExponentialMean"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","MinimumInteger","MaximumInteger","NormalMean","StandardDeviation","Alpha","Beta","N","Probability","r"]\r\n            },\r\n            {\r\n              "values": [5],\r\n              "active": ["ExponentialMean"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","MinimumInteger","MaximumInteger","NormalMean","StandardDeviation","Alpha","Beta","N","Probability","r"]\r\n            },\r\n            {\r\n              "values": [6],\r\n              "active": ["Alpha","Beta"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","MinimumInteger","MaximumInteger","NormalMean","StandardDeviation","ExponentialMean","N","Probability","r"]\r\n            },\r\n            {\r\n              "values": [7],\r\n              "active": ["N","Probability"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","MinimumInteger","MaximumInteger","NormalMean","StandardDeviation","ExponentialMean","Alpha","Beta","r"]\r\n            },\r\n            {\r\n              "values": [8],\r\n              "active": ["Probability"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","MinimumInteger","MaximumInteger","NormalMean","StandardDeviation","ExponentialMean","Alpha","Beta","N","r"]\r\n            },\r\n            {\r\n              "values": [9],\r\n              "active": ["r","Probability"],\r\n              "inactive": ["MinimumUniform","MaximumUniform","MinimumInteger","MaximumInteger","NormalMean","StandardDeviation","ExponentialMean","Alpha","Beta","N"]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "MinimumUniform" : {\r\n        "required": true,\r\n        "dataType":  "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.0\r\n      },\r\n      "MaximumUniform": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumName}",\r\n        "hidden": false,\r\n        "defaultValue": 1.0\r\n      },\r\n      "MinimumInteger": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "MaximumInteger": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumName}",\r\n        "hidden": false,\r\n        "defaultValue": 10\r\n      },\r\n      "NormalMean": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.enumLabels.mean}",\r\n        "hidden": false,\r\n        "defaultValue": 0.0\r\n      },\r\n      "StandardDeviation": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.enumLabels.stretchTypeStdDev}",\r\n        "hidden": false,\r\n        "defaultValue": 1.0\r\n      },\r\n      "ExponentialMean": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.enumLabels.mean}",\r\n        "hidden": false,\r\n        "defaultValue": 1.0\r\n      },\r\n      "Alpha": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.alphaName}",\r\n        "hidden": false,\r\n        "defaultValue": 1.0\r\n      },\r\n      "Beta": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.betaName}",\r\n        "hidden": false,\r\n        "defaultValue": 1.0\r\n      },\r\n      "N": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.nName}",\r\n        "hidden": false,\r\n        "defaultValue": 10\r\n      },\r\n      "r": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.rName}",\r\n        "hidden": false,\r\n        "defaultValue": 10.0\r\n      },\r\n      "Probability": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.probabilityName}",\r\n        "hidden": false,\r\n        "defaultValue": 0.5\r\n      },\r\n      "Seed": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.seed}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "GeneratorType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.randomNumberGenerator}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "randomGeneratorType"\r\n        }\r\n      },\r\n      "RasterInfo": {\r\n        "required": true,\r\n        "dataType": "rasterinfo",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterInfoName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "AggregateFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "CellFactor": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellFactor}",\r\n        "hidden": false,\r\n        "defaultValue": 2\r\n      },\r\n      "AggregationType": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.aggregationType}",\r\n        "hidden": false,\r\n        "defaultValue": 9,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaAggregationTypes"\r\n        }\r\n      },\r\n      "ExpandHandling": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentHandling}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      },\r\n      "IgnoreNoData": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.ignoreNoDataName}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      }\r\n    }\r\n  },\r\n  "TrendAnalysisFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "DimensionName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.trendAnalysisDimensionName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "rasterDimensions",\r\n          "argumentName": "Raster"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": ["StdTime"],\r\n              "active": ["CycleUnit"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "RegressionType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.trendAnalysisType}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriTrendAnalysisTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [0],\r\n              "active": ["SlopePValue", "RMSE", "R2"],\r\n              "inactive": ["Frequency", "Order", "CycleLength", "CycleUnit", "SeasonalPeriod"]\r\n            },\r\n            {\r\n              "values": [1],\r\n              "active": ["Frequency", "SlopePValue","RMSE", "R2", "CycleLength", "CycleUnit"],\r\n              "inactive": ["Order", "SeasonalPeriod"]\r\n            },\r\n            {\r\n              "values": [2],\r\n              "active": ["Order", "RMSE", "R2"],\r\n              "inactive": ["Frequency", "SlopePValue", "CycleLength", "CycleUnit", "SeasonalPeriod"]\r\n            },\r\n            {\r\n              "values": [3],\r\n              "active": [],\r\n              "inactive": [\r\n                "Frequency",\r\n                "Order",\r\n                "SlopePValue",\r\n                "CycleLength",\r\n                "CycleUnit",\r\n                "SeasonalPeriod",\r\n                "RMSE",\r\n                "R2"\r\n              ]\r\n            },\r\n            {\r\n              "values": [4],\r\n              "active": ["SeasonalPeriod"],\r\n              "inactive": ["Order", "Frequency", "SlopePValue", "CycleLength", "CycleUnit", "RMSE", "R2"]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "CycleLength": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.cycleLengthName}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "CycleUnit": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.cycleUnitName}",\r\n        "hidden": false,\r\n        "defaultValue": "YEARS",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCycleUnits"\r\n        }\r\n      },\r\n      "Frequency": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.harmonicFrequency}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "Order": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.polynomialOrder}",\r\n        "hidden": false,\r\n        "defaultValue": 2\r\n      },\r\n      "IgnoreNoData": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.ignoreNoDataName}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      },\r\n      "RMSE": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.trendAnalysisRMSE}",\r\n        "categoryRefId": "rfxArgCat_ModelStatistics",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      },\r\n      "R2": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.trendAnalysisR2}",\r\n        "categoryRefId": "rfxArgCat_ModelStatistics",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "SlopePValue": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.trendAnalysisSlopePValue}",\r\n        "categoryRefId": "rfxArgCat_ModelStatistics",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "SeasonalPeriod": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.trendAnalysisSeasonalPeriod}",\r\n        "hidden": false,\r\n        "defaultValue": "DAYS",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriTrendSeasonlPeriod"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "TrendFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "DimensionDefinitionType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.dimensionDefinitionType}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type":"list",\r\n          "enum": "dimensionDefinitionTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [0],\r\n              "active": ["DimensionValues"],\r\n              "inactive": ["DimensionStart","DimensionEnd","DimensionInterval","DimensionUnit"]\r\n            },\r\n            {\r\n              "values": [1],\r\n              "active": ["DimensionStart","DimensionEnd","DimensionInterval","DimensionUnit"],\r\n              "inactive": ["DimensionValues"]\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "DimensionValues": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.predictDimensionValues}",\r\n        "hidden": false\r\n      },\r\n      "DimensionStart": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.predictDimensionStart}",\r\n        "hidden": false\r\n      },\r\n      "DimensionEnd": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.predictDimensionEnd}",\r\n        "hidden": false\r\n      },\r\n      "DimensionInterval": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.predictDimensionInterval}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      },\r\n      "DimensionUnit": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.dimensionUnit}",\r\n        "hidden": false,\r\n        "defaultValue": "HOURS",\r\n        "domain": {\r\n          "type":"list",\r\n          "enum": "esriMdimTimeIntervalUnits"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "MultidimensionalRasterFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Variables": {\r\n        "required": true,\r\n        "dataType": "stringarray",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.variableName}",\r\n        "domain": {\r\n          "type": "rasterVariables",\r\n          "argumentName": "Raster"\r\n        }\r\n      },\r\n      "InterpolationMethod": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.interpolationMethodName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_IrregularDataInterpolation",\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriInterpolateIrregularDataMethods"\r\n        }\r\n      },\r\n      "InterpolationCellsize": {\r\n        "required": true,\r\n        "displayName": "${rasterFunctions.rfxArgs.interpolationCellsizeName}",\r\n        "dataType": "double",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "categoryRefId": "rfxArgCat_IrregularDataInterpolation"\r\n      }\r\n    }\r\n  },\r\n  "MultidimensionalFilterFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName":"${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Filter": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.variableName}",\r\n        "domain": {\r\n          "type": "mdimdef",\r\n          "argumentName": "Raster"\r\n        }\r\n      },\r\n      "Dimensionless": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.dimensionlessName}",\r\n        "defaultValue": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["Dimensionless"],\r\n          "triggerArguments": ["Raster","Filter"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxDimensionlessEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "DetectChangeFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.changeAnalysisRasterName}",\r\n        "hidden": false\r\n      },\r\n      "SegmentDate": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.segmentDate}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSegmentDate"\r\n        }\r\n      },\r\n      "ChangeDirection": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.changeDirectionName}",\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriChangeDirection"\r\n        }\r\n      },\r\n      "ChangeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.changeTypeName}",\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriDetectChangeTypes"\r\n        }\r\n      },\r\n      "MaxNumberChanges": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.maxNumChangesName}",\r\n        "defaultValue": 1\r\n      },\r\n      "FilterByYear": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.filterByYear}",\r\n        "defaultValue": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [true],\r\n              "active": ["MinimumYear","MaximumYear"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "MinimumYear": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumYear}"\r\n      },\r\n      "MaximumYear": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumYear}"\r\n      },\r\n      "FilterByDuration": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.filterByDuration}",\r\n        "defaultValue": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [true],\r\n              "active": ["MinimumDuration","MaximumDuration"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "MinimumDuration": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumDuration}"\r\n      },\r\n      "MaximumDuration": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumDuration}"\r\n      },\r\n      "FilterByMagnitude": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.filterByMagnitude}",\r\n        "defaultValue": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [true],\r\n              "active": ["MinimumMagnitude","MaximumMagnitude"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "MinimumMagnitude": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumMagnitude}"\r\n      },\r\n      "MaximumMagnitude": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumMagnitude}"\r\n      },\r\n      "FilterByStartValue": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.filterByStartValue}",\r\n        "defaultValue": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [true],\r\n              "active": ["MinimumStartValue", "MaximumStartValue"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "MinimumStartValue": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumStartValue}"\r\n      },\r\n      "MaximumStartValue": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumStartValue}"\r\n      },\r\n      "FilterByEndValue": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.filterByEndValue}",\r\n        "defaultValue": false,\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [true],\r\n              "active": ["MinimumEndValue", "MaximumEndValue"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "MinimumEndValue": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.minimumEndValue}"\r\n      },\r\n      "MaximumEndValue": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "categoryRefId": "rfxArgCat_FilterByAttributes",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.maximumEndValue}"\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["ChangeType"],\r\n          "triggerArguments": ["Raster","SegmentDate","ChangeDirection","FilterByDuration","MinimumDuration","MaximumDuration","FilterByMagnitude","MinimumMagnitude","MaximumMagnitude","FilterByStartValue","MinimumStartValue","MaximumStartValue","FilterByEndValue","MinimumEndValue","MaximumEndValue","MaxNumberChanges"],\r\n          "widget": {\r\n            "path": "esri/dijit/RasterFunctionEditor/RFxDetectChangeTypePicker"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "TrendToRGBFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ModelType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.modelTypeName}",\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriRenderTrendTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "ComputeChangeFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.fromRasterName}",\r\n        "hidden": false\r\n      },\r\n      "Raster2": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.toRasterName}",\r\n        "hidden": false\r\n      },\r\n      "Method": {\r\n        "required": false,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.computeChangeMethod}",\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriComputeChangeMethods"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [2],\r\n              "active": ["FromClassValues","ToClassValues","FromClassNameFieldName",\r\n                "ToClassNameFieldName", "KeepMethod","UseColorMethod"],\r\n              "inactive": [""],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "FromClassValues": {\r\n        "required": false,\r\n        "dataType": "longarray",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.fromClassValues}"\r\n      },\r\n      "ToClassValues": {\r\n        "required": false,\r\n        "dataType": "longarray",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.toClassValues}"\r\n      },\r\n      "FromClassNameFieldName": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.fromClassNameFieldName}"\r\n      },\r\n      "ToClassNameFieldName": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.toClassNameFieldName}"\r\n      },\r\n      "KeepMethod": {\r\n        "required": false,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.keepMethod}",\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriComputeChangeKeepMethods"\r\n        }\r\n      },\r\n      "UseColorMethod": {\r\n        "required": false,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.useColorMethod}",\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriComputeChangeUseColorMethods"\r\n        }\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "CCDCFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "BandIDs": {\r\n        "required": true,\r\n        "dataType": "longarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.detectChangeBands}",\r\n        "hidden": false\r\n      },\r\n      "TmaskBandIDs": {\r\n        "required": true,\r\n        "dataType": "longarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.tmaskBands}",\r\n        "hidden": false\r\n      },\r\n      "ChiSquareProb": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.chiSquaredThreshold}",\r\n        "hidden": false,\r\n        "defaultValue": 0.99\r\n      },\r\n      "MinNumberAnomaly": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.minAnomaly}",\r\n        "hidden": false,\r\n        "defaultValue": 6\r\n      },\r\n      "UpdatingFrequency": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.updatingFrequency}",\r\n        "hidden": false,\r\n        "defaultValue": 1\r\n      }\r\n    }\r\n  },\r\n  "OptimalPathAsRaster": {\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "OptimalPathAsRaster_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_destination_data"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_path_accumulation_raster"\r\n      },\r\n      "in_destination_data": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.destinationDataName}",\r\n        "hidden": false\r\n      },\r\n      "destination_field": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.destinationFieldName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "fields",\r\n          "argumentName": "in_destination_data"\r\n        }\r\n      },\r\n      "in_distance_accumulation_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.distanceAccumulationRasterName}",\r\n        "hidden": false\r\n      },\r\n      "in_back_direction_raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costBackdirectionRasterName}",\r\n        "hidden": false\r\n      },\r\n      "path_type": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.pathTypeName}",\r\n        "defaultValue": "EACH_ZONE",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaLeastCostPathTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "RasterCollectionFunction": {\r\n    "rasterFunctionArguments": {\r\n      "RasterCollection": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ItemFunction": {\r\n        "required": false,\r\n        "dataType": "rfxtemplate",\r\n        "displayName": "${rasterFunctions.rfxArgs.itemFunctionName}",\r\n        "hidden": false\r\n      },\r\n      "AggregationFunction": {\r\n        "required": false,\r\n        "dataType": "rfxtemplate",\r\n        "displayName": "${rasterFunctions.rfxArgs.aggregationFunctionName}",\r\n        "hidden": false\r\n      },\r\n      "ProcessingFunction":{\r\n        "required": false,\r\n        "dataType": "rfxtemplate",\r\n        "displayName": "${rasterFunctions.rfxArgs.processingFunctionName}",\r\n        "hidden": false\r\n      },\r\n      "WhereClause": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.whereClauseName}",\r\n        "hidden": true\r\n      },\r\n      "AggregationDefinition": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.aggregationDefinitionName}",\r\n        "hidden": false,\r\n        "categoryRefId": "rfxArgCat_AggregationDef",\r\n        "domain": {\r\n          "type": "aggregationdef",\r\n          "argumentName": "RasterCollection"\r\n        }\r\n      },\r\n      "QueryGeometry": {\r\n        "required": false,\r\n        "dataType": "geometry",\r\n        "displayName": "${rasterFunctions.rfxArgs.queryGeometryName}",\r\n        "hidden": true\r\n      }\r\n    }\r\n  },\r\n  "landTrendrFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "ProcessingBand": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.processingBandName}",\r\n        "hidden": false,\r\n        "defaultValue": "Band_1",\r\n        "domain": {\r\n          "type": "bandName",\r\n          "argumentName": "Raster"\r\n        }\r\n      },\r\n      "SnappingDate": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.snappingDate}",\r\n        "hidden": false,\r\n        "defaultValue": "06-30"\r\n      },\r\n      "MaxSegments": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxNumSegments}",\r\n        "hidden": false,\r\n        "defaultValue": 5\r\n      },\r\n      "VertexCountOvershoot": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.vertexCountOvershoot}",\r\n        "hidden": false,\r\n        "defaultValue": 2\r\n      },\r\n      "SpikeThreshold": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.spikeThreshold}",\r\n        "hidden": false,\r\n        "defaultValue": 0.9\r\n      },\r\n      "RecoveryThreshold": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.recoveryThreshold}",\r\n        "hidden": false,\r\n        "defaultValue": 0.25\r\n      },\r\n      "MinObs": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.minNumObs}",\r\n        "hidden": false,\r\n        "defaultValue": 6\r\n      },\r\n      "PValueThreshold": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.pValueThreshold}",\r\n        "hidden": false,\r\n        "defaultValue": 0.01\r\n      },\r\n      "BestModelProportion": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.bestModelProportion}",\r\n        "hidden": false,\r\n        "defaultValue": 1.25\r\n      },\r\n      "PreventOneYearRecovery": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.preventOneYearRecovery}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      },\r\n      "RecoveryIncreaseTrend": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.recoveryIncreaseTrend}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      },\r\n      "OutputOtherBands": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.outputOtherBands}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "mergeRastersFunction": {\r\n    "category": "dataManagement",\r\n    "icon": "mergeRasters.png",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false\r\n      },\r\n      "mosaicOperator": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.resolveOverlapMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": "MT_FIRST",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriResolveOverlapMethods"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "PredictUsingRegressionFunction": {\r\n    "icon": "predictUsingRegression.png",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false\r\n      },\r\n      "RegressionDefinitionFile": {\r\n        "required": true,\r\n        "dataType": "file",\r\n        "fileExtSupported": ["ecd"],\r\n        "displayName": "${rasterFunctions.rfxArgs.inputDefinitionFileName}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n  "DimensionalMovingStatisticsFunction": {\r\n    "category": "statistical",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Dimension": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.dimensionName}",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "rasterDimensions",\r\n          "argumentName": "Raster"\r\n        }\r\n      },\r\n      "BackwardWindow": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.backwardWindowName}",\r\n        "defaultValue": 1,\r\n        "hidden": false\r\n      },\r\n      "ForwardWindow": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.forwardWindowName}",\r\n        "defaultValue": 1,\r\n        "hidden": false\r\n      },\r\n      "NoDataHandling": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.noDataHandlingName}",\r\n        "defaultValue": -1,\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriGANoDataHandling"\r\n        }\r\n      },\r\n      "StatisticsType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.statisticsTypeName}",\r\n        "defaultValue": 3,\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriGADimensionalMovingStatisticsTypes"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [12],\r\n              "active": ["PercentileValue"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            },\r\n            {\r\n              "values": [4, 12],\r\n              "active": ["PercentileInterpolationType"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            },\r\n            {\r\n              "values": [13],\r\n              "active": ["CircularWrapValue"],\r\n              "inactive": [],\r\n              "autoRevert": true\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "PercentileValue": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.percentileValue}",\r\n        "hidden": false,\r\n        "defaultValue": 90\r\n      },\r\n      "PercentileInterpolationType": {\r\n        "required": false,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.percentileInterpolationType}",\r\n        "hidden": false,\r\n        "defaultValue": "AUTO_DETECT",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaZonalPercentileInterpolationTypes"\r\n        }\r\n      },\r\n      "CircularWrapValue": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.circularWrapValueName}",\r\n        "defaultValue": 360.0,\r\n        "hidden": false\r\n      }\r\n    },\r\n    "editorArgumentOverride": {\r\n      "active": true,\r\n      "overrides": [\r\n        {\r\n          "argumentNames": ["Percentile"],\r\n          "triggerAttributes": "minValue:0;maxValue:100",\r\n          "widget": {\r\n            "path": "widgets/ToolModeler/RasterFunctionEditor/ArgumentEditors/RFxRangedValueEditor"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  "InterpolateRasterByDimensionFunction": {\r\n    "category": "dataManagement",\r\n    "icon": "interpolateRasterByDimensionFunction.png",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "DimensionDefinition": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.variableName}",\r\n        "domain": {\r\n          "type": "mdimdef",\r\n          "attributes": "interpolateByDim",\r\n          "argumentName": "Raster"\r\n        }\r\n      },\r\n      "InterpolationMethod": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.interpolationMethodName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriInterpolateByDimMethods"\r\n        }\r\n      },\r\n      "IgnoreNoData": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.ignoreNoDataName}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      }\r\n    }\r\n  },\r\n  "TerrainFlattenFunction": {\r\n    "category": "SAR",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "DEM": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.DEMName}"\r\n      },\r\n      "CorrectGeoid": {\r\n        "required": false,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.geoIdName}",\r\n        "hidden": false,\r\n        "defaultValue": true\r\n      },\r\n      "CalibrationType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.calibrationTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 0,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriFlattenCalibrationTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "CreateColorCompositeFunction": {\r\n    "category": "dataManagement",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "Method": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.methodName}",\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "bandCompositeMethods"\r\n        }\r\n      },\r\n      "BandIndexesR": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandIndexesR}",\r\n        "hidden": false\r\n      },\r\n      "BandIndexesG": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandIndexesG}",\r\n        "hidden": false\r\n      },\r\n      "BandIndexesB": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.bandIndexesB}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "SurfaceParamFunction": {\r\n    "category": "surface",\r\n    "icon": "surfaceParameters.png",\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "SurfaceCalculation": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.surfaceParameterType}",\r\n        "defaultValue": 4,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriSurfaceParameterType"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": [4],\r\n              "active": ["SlopeType"],\r\n              "inactive": ["ProjectAzimuths", "UseEquatorialAspect"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [5],\r\n              "active": ["ProjectAzimuths", "UseEquatorialAspect"],\r\n              "inactive": ["SlopeType"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [1],\r\n              "inactive": ["SlopeType", "ProjectAzimuths", "UseEquatorialAspect"]\r\n            },\r\n            {\r\n              "values": [2],\r\n              "inactive": ["SlopeType", "ProjectAzimuths", "UseEquatorialAspect"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [3],\r\n              "inactive": ["SlopeType", "ProjectAzimuths", "UseEquatorialAspect"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [6],\r\n              "inactive": ["SlopeType", "ProjectAzimuths", "UseEquatorialAspect"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [7],\r\n              "inactive": ["SlopeType", "ProjectAzimuths", "UseEquatorialAspect"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [8],\r\n              "inactive": ["SlopeType", "ProjectAzimuths", "UseEquatorialAspect"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": [9],\r\n              "inactive": ["SlopeType", "ProjectAzimuths", "UseEquatorialAspect"],\r\n              "autoRevert": false\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "LocalSurface": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.localSurfaceType}",\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriLocalSurfaceType"\r\n        }\r\n      },\r\n      "AnalysisScaleWithUnits": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.neighborhoodDistance}",\r\n        "hidden": false,\r\n        "defaultValue": "1 Meters"\r\n      },\r\n      "UseAdaptiveScale": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.useAdaptiveNeighborhood}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "ZUnit": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.zUnit}",\r\n        "defaultValue": "Meters",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gpsaLinearUnitTypes"\r\n        }\r\n      },\r\n      "SlopeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "hidden": false,\r\n        "displayName": "${rasterFunctions.rfxArgs.outputSlopeType}",\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "outputSlopeType"\r\n        }\r\n      },\r\n      "ProjectAzimuths": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.projectAzimuths}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "UseEquatorialAspect": {\r\n        "required": true,\r\n        "dataType": "boolean",\r\n        "displayName": "${rasterFunctions.rfxArgs.useEquatorialAspect}",\r\n        "hidden": false,\r\n        "defaultValue": false\r\n      },\r\n      "AnalysisMask": {\r\n        "required": false,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.analysisMask}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "LeastCostCorridor": {\r\n    "category": "distance",\r\n    "rasterFunctionArguments": {\r\n      "ToolName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "LeastCostCorridor_sa"\r\n      },\r\n      "PrimaryInputParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "in_accumulative_cost_distance_raster1"\r\n      },\r\n      "OutputRasterParameterName": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "hidden": true,\r\n        "defaultValue": "out_raster"\r\n      },\r\n      "in_accumulative_cost_distance_raster1": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costDistanceRaster1}",\r\n        "hidden": false\r\n      },\r\n      "in_back_direction_raster1": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.directionRaster1}",\r\n        "hidden": false\r\n      },\r\n      "in_accumulative_cost_distance_raster2": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.costDistanceRaster2}",\r\n        "hidden": false\r\n      },\r\n      "in_back_direction_raster2": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.directionRaster2}",\r\n        "hidden": false\r\n      },\r\n      "threshold_method": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.thresholdMethod}",\r\n        "hidden": false,\r\n        "defaultValue": "NO_THRESHOLD",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriLeastCostThresholdMethod"\r\n        },\r\n        "editorStateTrigger": {\r\n          "active": true,\r\n          "triggers": [\r\n            {\r\n              "values": ["NO_THRESHOLD"],\r\n              "active": [],\r\n              "inactive": ["threshold"],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": ["PERCENT_OF_LEAST_COST"],\r\n              "active": ["threshold"],\r\n              "inactive": [],\r\n              "autoRevert": false\r\n            },\r\n            {\r\n              "values": ["ACCUMULATIVE_COST"],\r\n              "active": ["threshold"],\r\n              "inactive": [],\r\n              "autoRevert": false\r\n            }\r\n          ]\r\n        }\r\n      },\r\n      "threshold": {\r\n        "required": false,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.threshold}",\r\n        "hidden": false\r\n      }\r\n    }\r\n  },\r\n\r\n  "GeometricMedianFunction": {\r\n    "category": "dataManagement",\r\n    "rasterFunctionArguments": {\r\n      "Rasters": {\r\n        "required": true,\r\n        "dataType": "rasterarray",\r\n        "displayName": "${rasterFunctions.rfxArgs.rastersName}",\r\n        "hidden": false,\r\n        "allowScalar": false\r\n      },\r\n      "Epsilon": {\r\n        "required": true,\r\n        "dataType": "double",\r\n        "displayName": "${rasterFunctions.rfxArgs.epsilon}",\r\n        "hidden": false,\r\n        "defaultValue": 0.001\r\n      },\r\n      "MaxIteration": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxIterations}",\r\n        "hidden": false,\r\n        "defaultValue": 10\r\n      },\r\n      "CellsizeType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.cellsizeTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 2,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriCellsizeTypes"\r\n        }\r\n      },\r\n      "ExtentType": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.extentTypeName}",\r\n        "hidden": false,\r\n        "defaultValue": 1,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "esriExtentTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  "RegionPixelCountFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "MaxRegionSize": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.maxRegionSizeName}",\r\n        "defaultValue": 100,\r\n        "hidden": false\r\n      },\r\n      "PixelNeighborhood": {\r\n        "required": true,\r\n        "dataType": "long",\r\n        "displayName": "${rasterFunctions.rfxArgs.pixelNeighborhoodName}",\r\n        "defaultValue": 0,\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "pixelNeighborhoodTypes"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  "GradientFunction": {\r\n    "rasterFunctionArguments": {\r\n      "Raster": {\r\n        "required": true,\r\n        "dataType": "raster",\r\n        "displayName": "${rasterFunctions.rfxArgs.rasterName}",\r\n        "hidden": false\r\n      },\r\n      "GradientDimension": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.gradientDimensionName}",\r\n        "defaultValue": "X",\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "gradientDimensionList"\r\n        },\r\n        "hidden": false\r\n      },\r\n      "DenominatorUnit": {\r\n        "required": true,\r\n        "dataType": "string",\r\n        "displayName": "${rasterFunctions.rfxArgs.denominatorUnitName}",\r\n        "defaultValue": "DEFAULT",\r\n        "hidden": false,\r\n        "domain": {\r\n          "type": "list",\r\n          "enum": "denominatorUnitList"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n',
"url:dijit/templates/actionBar.html":"\x3cdiv class\x3d'dijitDialogPaneActionBar' data-dojo-attach-point\x3d\"actionBarNode\"\x3e\r\n\t\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' data-dojo-attach-point\x3d\"okButton\"\x3e\x3c/button\x3e\r\n\t\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'button'\r\n\t\t\tdata-dojo-attach-point\x3d\"cancelButton\" data-dojo-attach-event\x3d'click:onCancel'\x3e\x3c/button\x3e\r\n\x3c/div\x3e\r\n","url:esri/dijit/analysis/templates/JobsList.html":'\x3cdiv class\x3d"esriAnalysis"\x3e\r\n   \x3cdiv class\x3d"analysisCategoryCtr" style\x3d"overflow:auto;" data-dojo-attach-point\x3d"_tableDiv"\x3e\r\n    \x3ctable class\x3d"calciteWebTable table-striped"\x3e\r\n       \x3cthead\x3e\r\n         \x3ctr\x3e\r\n          \x3cth\x3e${i18n.toolName}\x3c/th\x3e\r\n          \x3cth\x3e${i18n.dateCreated}\x3c/th\x3e\r\n         \x3c/tr\x3e\r\n      \x3c/thead\x3e\r\n      \x3ctbody data-dojo-attach-point\x3d"_analysisJobTBody"\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n   \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/analysis/templates/Settings.html":'\x3cdiv class\x3d"esriAnalysis"\x3e\r\n  \x3cdiv\x3e\r\n    \x3cdiv class\x3d"analysisTitle" style\x3d"padding:1em;" data-dojo-attach-point\x3d"_settingsHeader"\x3e\r\n         \x3ctable class\x3d"esriFormTable"\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"2"\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_analysisTitle"\x3e${i18n.analysisEnv}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"esriFloatTrailing" style\x3d"padding:0;"\x3e\r\n                    \x3cdiv class\x3d"esriFloatTrailing" data-dojo-attach-point\x3d"_closeDiv"\x3e\r\n                      \x3ca href\x3d"#" data-dojo-attach-point\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"esriAnalysisCloseIcon"\x3e\x3c/a\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n         \x3c/table\x3e\r\n    \x3c/div\x3e\r\n    \x3cnav class\x3d"tab-nav feature-nav" data-dojo-attach-point\x3d"_settingsNavCtrl" style\x3d"display:none;"\x3e\r\n      \x3ca href\x3d"#" class\x3d"tab-title is-active general-tab" data-dojo-attach-point\x3d"_generalTab"\x3eGeneral\x3c/a\x3e\r\n      \x3ca href\x3d"#" class\x3d"tab-title history-tab" data-dojo-attach-point\x3d"_historyTab"\x3eHistory\x3c/a\x3e\r\n    \x3c/nav\x3e\r\n   \x3c!--\x3cdiv style\x3d"clear:both; border-bottom: #CCC thin solid; height:1px;width:100%;"\x3e\x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_form" readOnly\x3d"true"\x3e\r\n     \x3ctable class\x3d"esriFormTable"\x3e\r\n       \x3ctbody\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_overwriteRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriSelectLabel esriLeadingMargin1"\x3e\r\n               \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"_overwriteCheck" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"checked:false" name\x3d"overwriteResult" value\x3d"false" /\x3e\r\n               ${i18n.overwriteResultLayer}\r\n             \x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' data-dojo-attach-point\x3d"_analysisFieldHelpLink" esriHelpTopic\x3d"overwriteResult"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_closeAnalysisRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriSelectLabel esriLeadingMargin1"\x3e\r\n               \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"_closeAnalysisCheck" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"checked:${viewModel.closeAnalysisWidget}" data-dojo-attach-event\x3d"onChange:_handleCloseAnalysisCheck" name\x3d"closeAnalysisWidget" value\x3d"false" /\x3e\r\n               ${i18n.closeAnalysisWisget}\r\n             \x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' data-dojo-attach-point\x3d"_analysisFieldHelpLink" esriHelpTopic\x3d"closeAnalysisWidget"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_storeAnalysisRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriSelectLabel esriLeadingMargin1"\x3e\r\n               \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"_storeAnalysisCheck" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"checked:false" data-dojo-attach-event\x3d"onChange:_handleReturnFeatureCollectionCheck" name\x3d"storeAnalysisResults" value\x3d"false" /\x3e\r\n               ${i18n.storeAnalysisResults}\r\n             \x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' data-dojo-attach-point\x3d"_analysisFieldHelpLink" esriHelpTopic\x3d"storeAnalysisResults"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_coordinateLblRow"\x3e\r\n           \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.CoordinateSys}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_outSRLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.outSR}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"outputCoordinateSystem"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_outSRRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_outSRSelect" data-dojo-attach-event\x3d"onChange:_handleSRSelectChange"\x3e\r\n               \x3coption value\x3d"DEFAULT"\x3e${i18n.defaultExtentLabel}\x3c/option\x3e\r\n               \x3coption value\x3d"SPECIFIED"\x3e${i18n.extentSpecfiedBelow}\x3c/option\x3e\r\n             \x3c/select\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd style\x3d"width:15%"\x3e\r\n             \x3cdiv data-dojo-type\x3d"dijit/form/ToggleButton" data-dojo-props\x3d"showLabel:false,iconClass:\'esriAnalysisSRIcon\'" data-dojo-attach-point\x3d"_outSRBtn" data-dojo-attach-event\x3d"onChange:_handleOutSRBtnClick"\x3e\x3c/div\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_outSRCustomRow" style\x3d"display:none;"\x3e\r\n           \x3ctd colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin2"\x3e${i18n.spatialReference}\x3c/label\x3e\r\n             \x3cinput style\x3d"width:20%;" class\x3d"mediumInput esriMediumLabel" type\x3d"text" data-dojo-props\x3d"constraints: {pattern: \'######\', places: 0}" data-dojo-attach-point\x3d"_outSRInput" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"onChange:_handleOutSRInputChange"\x3e\x3c/input\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_outSRCustomInputRow" style\x3d"display:none;"\x3e\r\n           \x3ctd colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin2" data-dojo-attach-point\x3d"_outSRLabel"\x3e\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processSRLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.processSR}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"processingCoordinateSystem"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processSRRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_processSRSelect" data-dojo-attach-event\x3d"onChange:_handleProcessSRSelectChange"\x3e\r\n               \x3coption value\x3d"DEFAULT"\x3e${i18n.defaultExtentLabel}\x3c/option\x3e\r\n               \x3coption value\x3d"SPECIFIED"\x3e${i18n.extentSpecfiedBelow}\x3c/option\x3e\r\n             \x3c/select\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd style\x3d"width:15%"\x3e\r\n             \x3cdiv data-dojo-type\x3d"dijit/form/ToggleButton" class\x3d"esriFloatLeading" data-dojo-props\x3d"showLabel:false,iconClass:\'esriAnalysisSRIcon\'" data-dojo-attach-point\x3d"_processSRBtn" data-dojo-attach-event\x3d"onChange:_handleProcessSRBtnClick"\x3e\x3c/div\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processSRCustomRow" style\x3d"display:none;"\x3e\r\n           \x3ctd colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin2"\x3e${i18n.spatialReference}\x3c/label\x3e\r\n             \x3cinput style\x3d"width:20%;" class\x3d"mediumInput esriMediumLabel" type\x3d"text" data-dojo-props\x3d"constraints: {pattern: \'######\', places: 0}" data-dojo-attach-point\x3d"_processSRInput" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"onChange:_handleProcessSRInputChange"\x3e\x3c/input\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processSRCustomInputRow" style\x3d"display:none;"\x3e\r\n           \x3ctd colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin2" data-dojo-attach-point\x3d"_processSRLabel"\x3e\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processExtLblRow"\x3e\r\n           \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.processExtent}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_extentLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.extent}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"processingExtent"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_extentRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_extentSelect" data-dojo-attach-event\x3d"onChange:_handleExtentOptionChange"\x3e\r\n               \x3coption value\x3d"DEFAULT"\x3e${i18n.defaultLabel}\x3c/option\x3e\r\n               \x3coption value\x3d"DISPLAY"\x3e${i18n.extentAsDisplay}\x3c/option\x3e\r\n               \x3coption value\x3d"SPECIFIED"\x3e${i18n.extentSpecfiedBelow}\x3c/option\x3e\r\n             \x3c/select\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_extentLbl"\x3e\r\n           \x3ctd style\x3d"padding:0" colspan\x3d"2"\x3e\r\n             \x3cdiv class\x3d"esriLeadingMargin1"\x3e\r\n               \x3clabel class\x3d"esriSmallLabel"\x3e${i18n.enterCoords}\x3c/label\x3e\r\n             \x3c/div\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_customExtentRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3ctable class\x3d"esriLeadigMargin1 esriFormTable" style\x3d"width:90%;"\x3e\r\n               \x3ctr\x3e\r\n                 \x3ctd\x3e\r\n                   \x3clabel class\x3d""\x3e${i18n.xMin}\x3c/label\x3e\r\n                   \x3cinput type\x3d"text" class\x3d"mediumInput" style\x3d"width:65%;" data-dojo-attach-point\x3d"_xMinInput" data-dojo-type\x3d"dijit/form/NumberTextBox"\x3e\x3c/input\x3e\r\n                 \x3c/td\x3e\r\n                 \x3ctd\x3e\r\n                   \x3clabel\x3e${i18n.xMax}\x3c/label\x3e\r\n                   \x3cinput type\x3d"text" class\x3d"mediumInput" style\x3d"width:65%;" data-dojo-attach-point\x3d"_xMaxInput" data-dojo-type\x3d"dijit/form/NumberTextBox"\x3e\x3c/input\x3e\r\n                 \x3c/td\x3e\r\n               \x3c/tr\x3e\r\n               \x3ctr\x3e\r\n                 \x3ctd\x3e\r\n                   \x3clabel class\x3d""\x3e${i18n.yMin}\x3c/label\x3e\r\n                   \x3cinput type\x3d"text" class\x3d"mediumInput" style\x3d"width:65%;" data-dojo-attach-point\x3d"_yMinInput" data-dojo-type\x3d"dijit/form/NumberTextBox"\x3e\x3c/input\x3e\r\n                 \x3c/td\x3e\r\n                 \x3ctd\x3e\r\n                   \x3clabel\x3e${i18n.yMax}\x3c/label\x3e\r\n                   \x3cinput type\x3d"text" class\x3d"mediumInput" style\x3d"width:65%;" data-dojo-attach-point\x3d"_yMaxInput" data-dojo-type\x3d"dijit/form/NumberTextBox"\x3e\x3c/input\x3e\r\n                 \x3c/td\x3e\r\n               \x3c/tr\x3e\r\n             \x3c/table\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_snapLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.snapRaster}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"snapRaster"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_snapSelRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_snapRasterSelect" data-dojo-attach-event\x3d"onChange:_handleSnapRasterSelectChange"\x3e\x3c/select\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_geoanalyticsLblRow"\x3e\r\n           \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.geoanalytis}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_datastoreLabelRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.datastoreLabel}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"dataStore"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_selectDataStore"\x3e\r\n           \x3ctd colspan\x3d"2" data-dojo-attach-point\x3d"_dataStoreTd"\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_rasterLblRow"\x3e\r\n           \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.rasterLabel}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_cellLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.cellSize}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"cellSize"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_cellSelectRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_cellSizeSelect" data-dojo-attach-event\x3d"onChange:_handleCellSizeSelectChange"\x3e\x3c/select\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_cellSelectNumRow" style\x3d"display:none;"\x3e\r\n           \x3ctd colspan\x3d"3"\x3e\r\n             \x3cinput style\x3d"width:20%;" class\x3d"esriLeadingMargin1 mediumInput esriMediumLabel" type\x3d"text" data-dojo-attach-point\x3d"_cellSizeInput" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"onChange:_handleCellSizeInputChange"\x3e\x3c/input\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_maskLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.mask}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"mask"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_maskSelRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_maskSelect" data-dojo-attach-event\x3d"onChange:_handleMaskSelectChange"\x3e\x3c/select\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_creditWarningRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriSelectLabel esriLeadingMargin1"\x3e\r\n               \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"_creditWarningCheck" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"checked:true" data-dojo-attach-event\x3d"onChange:_handleCreditWarningCheck" name\x3d"creditWarning" value\x3d"false" /\x3e\r\n               ${i18n.creditWarning}\r\n             \x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_storageLblRow"\x3e\r\n           \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.storageLabel}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_resamplingMethodLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.resamplingMethod}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"resamplingMethod"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_resamplingMethodSelRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_resamplingMethodSelect" data-dojo-attach-event\x3d"onChange:_handleResamplingMethodSelectChange"\x3e\x3c/select\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processorLblRow"\x3e\r\n           \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.processorType}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processorTypeLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.processorType}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"processorType"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_processorTypeSelRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_processorTypeSelect" data-dojo-attach-event\x3d"onChange:_handleProcessorTypeSelectChange"\x3e\x3c/select\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_parallelProcessingLblRow"\x3e\r\n           \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" colspan\x3d"3"\x3e\r\n             \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.parallelProcessingLabel}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_recycleProcessingWorkersLblRow" hidden\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.recycleProcessingWorkers}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"recycleProcessingWorkers"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_recycleProcessingWorkersNumRow" hidden\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cinput class\x3d"esriLeadingMargin1 mediumInput esriMediumLabel" type\x3d"text" data-dojo-attach-point\x3d"_recycleProcessingWorkersInput" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"onChange:_handlerecycleProcessingWorkersInputChange"\x3e\x3c/input\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_parallelProcessingFactorLblRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.parallelProcessingFactor}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"parallelProcessingFactor"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_parallelProcessingFactorNumRow"\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cinput class\x3d"esriLeadingMargin1 mediumInput esriMediumLabel" type\x3d"text" data-dojo-attach-point\x3d"_parallelProcessingFactorInput" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"onChange:_handleparallelProcessingFactorInputChange"\x3e\x3c/input\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_retryOnFailuresLblRow" hidden\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.retryOnFailures}\x3c/label\x3e\r\n           \x3c/td\x3e\r\n           \x3ctd class\x3d"shortTextInput"\x3e\r\n             \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"retryOnFailures"\x3e\x3c/a\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n         \x3ctr data-dojo-attach-point\x3d"_retryOnFailuresNumRow" hidden\x3e\r\n           \x3ctd colspan\x3d"2"\x3e\r\n             \x3cinput class\x3d"esriLeadingMargin1 mediumInput esriMediumLabel" type\x3d"text" data-dojo-attach-point\x3d"_retryOnFailuresInput" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"onChange:_handleretryOnFailuresInputChange"\x3e\x3c/input\x3e\r\n           \x3c/td\x3e\r\n         \x3c/tr\x3e\r\n       \x3c/tbody\x3e\r\n     \x3c/table\x3e\r\n    \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_jobHistoryCtr" style\x3d"display:none;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_jobsListDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriFormWarning esriRoundedBox" data-dojo-attach-point\x3d"_errorMessagePane" style\x3d"display:none;"\x3e\r\n      \x3ca href\x3d"#" title\x3d"${i18n.close}" class\x3d"esriFloatTrailing esriAnalysisCloseIcon" title\x3d\'${i18n.close}\' data-dojo-attach-event\x3d"onclick:_handleCloseMsg"\x3e\r\n      \x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_bodyNode"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/ConfirmDialog" class\x3d"esriAnalysisStgSpatialDialog" title\x3d"${i18n.coordSysDialogTitle}" data-dojo-props\x3d"closable:false" data-dojo-attach-point\x3d"_coordDialog" style\x3d"width:40em;" data-dojo-attach-event\x3d"onExecute:_handleSRDlgOk,onCancel:_handleSRDlgCancel"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_spatialRefGridNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv  class\x3d"esriFloatTrailing" data-dojo-attach-point\x3d"_actionbuttonCtr"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/Button"  class\x3d"${cssClass.primaryButton}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleOkButtonClick"\x3e\r\n      ${i18n.apply}\r\n    \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${cssClass.button}" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_handleCancelButtonClick"\x3e\r\n      ${i18n.cancel}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/analysis/templates/ExpressionForm.html":'\x3cdiv class\x3d"esriAnalysis esriExpressionForm"\x3e\r\n  \x3cdiv class\x3d"esriFormError esriRoundedBox" data-dojo-attach-point\x3d"_errorMessagePane" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3c!--\x3cdiv class\x3d"clear" style\x3d"height:1em;"\x3e\x3c/div\x3e--\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" class\x3d"esriSimpleForm" data-dojo-attach-point\x3d"_expressionForm"\x3e\r\n    \x3ctable class\x3d"esriFormTable" style\x3d"border: 1px solid #929497;background-color: #F7F8F8 !important;"\x3e \r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_firstRow" \x3e\r\n          \x3ctd style\x3d"width:75%"\x3e\r\n            \x3cselect class\x3d"" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%;table-layout:fixed;" data-dojo-attach-event\x3d"onChange:_handleFirstOperandChange" data-dojo-attach-point\x3d"_firstOperandSelect"\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:25%"\x3e\r\n            \x3cselect class\x3d"" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"onChange:_handleOperatorChange" style\x3d"width:100%;table-layout:fixed;" data-dojo-attach-point\x3d"_operatorSelect"\x3e\r\n              \x3coption value\x3d"where"\x3e${i18n.where}\x3c/option\x3e\r\n              \x3coption value\x3d"intersects"\x3e${i18n.intersects}\x3c/option\x3e\r\n              \x3coption value\x3d"notIntersects"\x3e${i18n.notIntersects}\x3c/option\x3e\r\n              \x3coption value\x3d"withinDistance"\x3e${i18n.withinDistance}\x3c/option\x3e\r\n              \x3coption value\x3d"notWithinDistance"\x3e${i18n.notWithinDistance}\x3c/option\x3e\r\n              \x3coption value\x3d"contains"\x3e${i18n.contains}\x3c/option\x3e\r\n              \x3coption value\x3d"notContains"\x3e${i18n.notContains}\x3c/option\x3e\r\n              \x3coption value\x3d"within"\x3e${i18n.within}\x3c/option\x3e\r\n              \x3coption value\x3d"notWithin"\x3e${i18n.notWithin}\x3c/option\x3e\r\n              \x3coption value\x3d"nearest"\x3e${i18n.nearest}\x3c/option\x3e\r\n              \x3c!--\x3coption value\x3d"contains"\x3e${i18n.contains}\x3c/option\x3e\r\n              \x3coption value\x3d"notContains"\x3e${i18n.notContains}\x3c/option\x3e--\x3e\r\n              \x3c!--\x3coption value\x3d"within"\x3e${i18n.within}\x3c/option\x3e\r\n              \x3coption value\x3d"notWithin"\x3e${i18n.notWithin}\x3c/option\x3e--\x3e\r\n              \x3c!--\x3coption value\x3d"identical"\x3e${i18n.identical}\x3c/option\x3e\r\n              \x3coption value\x3d"notIdentical"\x3e${i18n.notIdentical}\x3c/option\x3e\r\n              \x3coption value\x3d"touches"\x3e${i18n.touches}\x3c/option\x3e\r\n              \x3coption value\x3d"notTouches"\x3e${i18n.notTouches}\x3c/option\x3e--\x3e\r\n              \x3c!--\x3coption value\x3d"crossesOutline"\x3e${i18n.crossesOutline}\x3c/option\x3e\r\n              \x3coption value\x3d"notCrossesOutline"\x3e${i18n.notCrossesOutline}\x3c/option\x3e--\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_secondRow" style\x3d"display:none;"\x3e\r\n          \x3ctd data-dojo-attach-point\x3d"_secondOperandTd" colspan\x3d"2"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_secondExpressionDiv" style\x3d"display:none; padding-bottom:0.25em;"\x3e\r\n              \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"onChange:_handleDistanceInputChange" data-dojo-props\x3d"intermediateChanges:true" data-dojo-attach-point\x3d"_distanceInput" style\x3d"width:20%;"\x3e\x3c/input\x3e\r\n              \x3cselect data-dojo-type\x3d"dijit/form/Select"  data-dojo-attach-point\x3d"_distanceUnitsSelect"  style\x3d"width:20%;table-layout:fixed;"\x3e\r\n                \x3coption value\x3d"Miles"\x3e${i18n.miles}\x3c/option\x3e\r\n                \x3coption value\x3d"Yards"\x3e${i18n.yards}\x3c/option\x3e\r\n                \x3coption value\x3d"Feet"\x3e${i18n.feet}\x3c/option\x3e\r\n                \x3coption type\x3d"separator"\x3e\x3c/option\x3e\r\n                \x3coption value\x3d"Kilometers"\x3e${i18n.kilometers}\x3c/option\x3e\r\n                \x3coption value\x3d"Meters"\x3e${i18n.meters}\x3c/option\x3e\r\n                \x3coption value\x3d"NauticalMiles"\x3e${i18n.nautMiles}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n              \x3clabel\x3e ${i18n.from} \x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cselect class\x3d"" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:75%;table-layout:fixed;" data-dojo-attach-point\x3d"_secondOperandSelect" data-dojo-attach-event\x3d"onChange:_handleSecondOperandChange"\x3e\r\n            \x3c/select\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_attrFilterDiv" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv class\x3d"esriFormWarning esriRoundedBox" data-dojo-attach-point\x3d"_errorMessagePane" style\x3d"display:none;"\x3e\r\n      \x3ca href\x3d"#" title\x3d"${i18n.close}" class\x3d"esriFloatTrailing esriAnalysisInfoPaneCloseIcon" title\x3d\'${i18n.close}\' data-dojo-attach-event\x3d"onclick:_handleCloseMsg"\x3e\r\n      \x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_bodyNode"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e    \r\n    \x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv  class\x3d"esriFloatTrailing" style\x3d"padding: 10px 5px;"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button"  class\x3d"${_addBtnClass}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleAddButtonClick"\x3e\r\n        ${i18n.add}\r\n      \x3c/div\x3e\r\n       \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriLeadingMargin05" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_handleCloseButtonClick"\x3e\r\n        ${i18n.close}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \r\n  \x3c/div\x3e\r\n\x3c/div\x3e  \r\n',
"url:esri/dijit/analysis/components/FilterAndSelection/FilterAndSelection.html":'\x3cdiv class\x3d"esriLeadingMargin1 esriFloatTrailing marginTop1"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/ToggleButton" class\x3d"esriActionButton" data-dojo-props\x3d"label:\'${i18n.selectLabel}\',iconClass:\'esriAnalysisSelectFilterIcon\',showLabel:false" data-dojo-attach-point\x3d"_selectBtn" data-dojo-attach-event\x3d"onChange:_handleSelectionButtonClick"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriActionButton" data-dojo-props\x3d"label:\'${i18n.queryLabel}\',iconClass:\'esriAnalysisAttributeFiltercon\',showLabel:false" data-dojo-attach-point\x3d"_queryBtn" data-dojo-attach-event\x3d"onClick:_handleQueryButtonClick"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" title\x3d"${i18n.expression}" data-dojo-props\x3d"closable:false" data-dojo-attach-point\x3d"_expDialog" style\x3d"width:65em;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_expressionForm" data-dojo-type\x3d"esri/dijit/analysis/ExpressionForm" data-dojo-props\x3d"showFirstRow:false,primaryActionButttonClass:\'btn calcite blue\'"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/analysis/templates/CreditEstimator.html":'\x3cdiv class\x3d"esriAnalysis esriSimpleForm"\x3e\r\n  \x3ctable class\x3d"esriFormTable"  data-dojo-attach-point\x3d"_table"  style\x3d"border-collapse:collapse;border-spacing:5px;"\x3e\r\n     \x3c!--\x3ctr\x3e\r\n      \x3ctd\x3e\r\n        \x3clabel class\x3d"esriFloatLeading"\x3e${i18n.analysisLayersLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e--\x3e\r\n     \x3ctr\x3e\r\n      \x3ctd\x3e\r\n        \x3clabel class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_totalRecordsLabelNode"\x3e${i18n.totalRecordsLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"_totalRecordsNode"\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n     \x3c!--\x3ctr\x3e\r\n      \x3ctd\x3e\r\n        \x3clabel class\x3d"esriFloatLeading"\x3e${i18n.creditsAvailLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e--\x3e\r\n     \x3ctr\x3e\r\n      \x3ctd\x3e\r\n        \x3clabel class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_costLabelNode"\x3e${i18n.creditsReqLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"_creditsReqNode"\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_messageDiv"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/analysis/templates/CreateViewshed.html":'\x3cdiv class\x3d"esriAnalysis"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" style\x3d"margin-top:0.5em; margin-bottom: 0.5em;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_hotspotsToolContentTitle" class\x3d"analysisTitle"\x3e\r\n         \x3ctable class\x3d"esriFormTable" \x3e \r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"esriToolIconTd"\x3e\x3cdiv class\x3d"createViewshedIcon"\x3e\x3c/div\x3e\x3c/td\x3e\r\n              \x3ctd class\x3d"esriAlignLeading esriAnalysisTitle" data-dojo-attach-point\x3d"_toolTitle"\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_titleLbl"\x3e${i18n.createViewshed}\x3c/label\x3e\r\n                \x3cnav class\x3d"breadcrumbs"  data-dojo-attach-point\x3d"_analysisModeLblNode" style\x3d"display:none;"\x3e\r\n                  \x3ca href\x3d"#" class\x3d"crumb breadcrumbs__modelabel" data-dojo-attach-event\x3d"onclick:_handleModeCrumbClick" data-dojo-attach-point\x3d"_analysisModeCrumb"\x3e\x3c/a\x3e\r\n                  \x3ca href\x3d"#" class\x3d"crumb is-active" data-dojo-attach-point\x3d"_analysisTitleCrumb" style\x3d"font-size:16px;"\x3e${i18n.createViewshed}\x3c/a\x3e\r\n                \x3c/nav\x3e                 \r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"esriFloatTrailing" style\x3d"padding:0;"\x3e\r\n                    \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n                      \x3ca href\x3d"#" class\x3d\'esriFloatLeading helpIcon\' esriHelpTopic\x3d"toolDescription"\x3e\x3c/a\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n                      \x3ca href\x3d"#" data-dojo-attach-point\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"esriAnalysisCloseIcon"\x3e\x3c/a\x3e\r\n                    \x3c/div\x3e              \r\n                \x3c/div\x3e  \r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n         \x3c/table\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both; border-bottom: #CCC thin solid; height:1px;width:100%;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_form" readOnly\x3d"true"\x3e\r\n     \x3ctable class\x3d"esriFormTable"\x3e \r\n       \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_titleRow"\x3e\r\n          \x3ctd  colspan\x3d"3" class\x3d"sectionHeader" data-dojo-attach-point\x3d"_interpolateToolDescription" \x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_analysisLabelRow" style\x3d"display:none;"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3clabel class\x3d"esriFloatLeading  esriTrailingMargin025 esriAnalysisNumberLabel"\x3e${i18n.oneLabel}\x3c/label\x3e\r\n            \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.analysisLayerLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"inputLayer"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_selectAnalysisRow" style\x3d"display:none;"\x3e\r\n          \x3ctd  colspan\x3d"3"\x3e\r\n            \x3ctable style\x3d"width:100%;"\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd style\x3d"width:80%"\x3e  \r\n                \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel"  style\x3d"margin-top:1.0em;" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_analysisSelect" data-dojo-attach-event\x3d"onChange:_handleAnalysisLayerChange"\x3e\x3c/select\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd style\x3d"width:20%"\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/ToggleButton"  data-dojo-attach-point\x3d"_analysisPointDrawBtn"  class\x3d"esriFloatLeading esriActionButton" data-dojo-props\x3d"showLabel:false,iconClass:\'toolbarIcon esriPointIcon\',label:\'${i18n.drawLabel}\'" data-dojo-attach-event\x3d"onChange:_handleInputDrawPointChange"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e          \r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3clabel class\x3d"esriFloatLeading esriTrailingMargin025 esriAnalysisNumberLabel"\x3e${i18n.oneLabel}\x3c/label\x3e\r\n            \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.viewshedOptionlabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3clabel class\x3d"esriLeadingMargin2"\x3e${i18n.observerHghtLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"shortTextInput"\x3e\r\n            \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"ObserverHeight"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e                    \r\n        \x3c/tr\x3e                  \r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3" style\x3d"padding:0;"\x3e\r\n            \x3ctable class\x3d"esriFormTable esriLeadingMargin2" style\x3d"width:90%;"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                \x3ctd  style\x3d"width:50%;padding-right:1em;"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"value:${observerHeight},intermediateChanges:true,invalidMessage:\'${i18n.distanceInValidMsg}\',constraints:{min:0}" data-dojo-attach-point\x3d"_obsrHeightInput" style\x3d"width:100%;"\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd colspan\x3d"2"\x3e\r\n            \x3cselect class\x3d"longInput esriAnalysisSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_obsrUnitsSelect"\x3e\r\n            \x3c/select\x3e\r\n                \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3clabel class\x3d"esriLeadingMargin2"\x3e${i18n.targetHghtLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"shortTextInput"\x3e\r\n            \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"TargetHeight"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e                    \r\n        \x3c/tr\x3e                  \r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3" style\x3d"padding:0;"\x3e\r\n            \x3ctable class\x3d"esriFormTable esriLeadingMargin2" style\x3d"width:90%;"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                \x3ctd  style\x3d"width:50%;padding-right:1em;"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"value:${targetHeight},intermediateChanges:true,invalidMessage:\'${i18n.distanceInValidMsg}\',constraints:{min:0}" data-dojo-attach-point\x3d"_targetHgtInput" style\x3d"width:100%;"\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd colspan\x3d"2"\x3e\r\n            \x3cselect class\x3d"longInput esriAnalysisSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_targetUnitsSelect"\x3e\r\n            \x3c/select\x3e\r\n                \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3clabel class\x3d"esriLeadingMargin2"\x3e${i18n.maxDistanceLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"shortTextInput"\x3e\r\n            \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"MaximumDistance"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e                    \r\n        \x3c/tr\x3e                   \r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3" style\x3d"padding:0;"\x3e\r\n            \x3ctable class\x3d"esriFormTable esriLeadingMargin2" style\x3d"width:90%;"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                \x3ctd  style\x3d"width:50%;padding-right:1em;"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"value:${maximumDistance},intermediateChanges:true,invalidMessage:\'${i18n.distanceInValidMsg}\', constraints:{min:0}" data-dojo-attach-point\x3d"_maximumDistanceInput" style\x3d"width:100%;" data-dojo-attach-event\x3d"onChange:_handleMaxDstChange"\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd colspan\x3d"2"\x3e\r\n            \x3cselect class\x3d"longInput esriAnalysisSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_distanceUnitsSelect" data-dojo-attach-event\x3d"onChange:_handleMaxDstUnitsChange"\x3e\r\n            \x3c/select\x3e\r\n                \x3c/td\x3e\r\n               \x3c/tr\x3e                  \r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3" class\x3d"clear"\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3clabel class\x3d"esriFloatLeading esriTrailingMargin025 esriAnalysisNumberLabel"\x3e${i18n.twoLabel}\x3c/label\x3e\r\n            \x3clabel class\x3d"esriAnalysisStepsLabel"\x3e${i18n.outputLayerLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"shortTextInput"\x3e\r\n            \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"OutputLayer"\x3e\x3c/a\x3e \r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true,required:true" class\x3d"longTextInput esriLeadingMargin1" data-dojo-attach-point\x3d"_outputLayerInput"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n             \x3cdiv data-dojo-attach-point\x3d"_chooseFolderRow" class\x3d"esriLeadingMargin1"\x3e\r\n               \x3clabel style\x3d"width:9px;font-size:smaller;"\x3e${i18n.saveResultIn}\x3c/label\x3e\r\n               \x3cinput class\x3d"longInput" data-dojo-attach-point\x3d"_webMapFolderSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" trim\x3d"true" style\x3d"width:55%;"\x3e\x3c/input\x3e\r\n             \x3c/div\x3e              \r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n     \x3c/table\x3e\r\n   \x3c/div\x3e\r\n  \x3cdiv style\x3d"padding:5px;margin-top:5px;border-top:solid 1px #BBB;"\x3e\r\n    \x3cdiv class\x3d"esriExtentCreditsCtr"\x3e\r\n      \x3ca class\x3d"esriFloatTrailing esriSmallFont"  href\x3d"#" data-dojo-attach-point\x3d"_showCreditsLink"\x3e${i18n.showCredits}\x3c/a\x3e\r\n     \x3clabel data-dojo-attach-point\x3d"_chooseExtentDiv" class\x3d"esriSelectLabel esriExtentLabel"\x3e\r\n       \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"_useExtentCheck" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"checked:true" name\x3d"extent" value\x3d"true"/\x3e\r\n         ${i18n.useMapExtent}\r\n     \x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" type\x3d"submit" data-dojo-attach-point\x3d"_saveBtn" class\x3d"esriLeadingMargin4 esriAnalysisSubmitButton" data-dojo-attach-event\x3d"onClick:_handleSaveBtnClick"\x3e\r\n        ${i18n.runAnalysis}\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" title\x3d"${i18n.creditTitle}" data-dojo-attach-point\x3d"_usageDialog" style\x3d"width:40em;"\x3e\r\n    \x3cdiv data-dojo-type\x3d"esri/dijit/analysis/CreditEstimator"  data-dojo-attach-point\x3d"_usageForm"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e    \r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/CoordinateControl.html":"\x3cdiv class\x3d'coordinateContainer'\x3e\r\n  \x3cdiv class\x3d'coordLabel' data-dojo-attach-point\x3d'coordNameContainer' data-a11y-label-id\x3d'coordLabel'\x3e\r\n    \x3cspan data-dojo-type\x3d'dijit/InlineEditBox' width\x3d'75px' data-dojo-props\x3d\"editor:'dijit/form/TextBox', autoSave:true\"\r\n      data-dojo-attach-point\x3d'coordName'\x3e${type}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d'add-with-icon coordInput'\x3e\r\n    \x3ctextarea data-a11y-label-by\x3d'coordLabel' tabindex\x3d\"0\" aria-multiline\x3d\"true\" role\x3d\"textbox\" id\x3d'${uid}' type\x3d'text' rows\x3d'1' data-dojo-attach-point\x3d'coordtext' spellcheck\x3d'false'\r\n    placeholder\x3d'${nls.coordinateInputLabel}' title\x3d'${nls.coordinateInputLabel}'\x3e\x3c/textarea\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d'coordactions'\x3e\r\n    \x3cdiv class\x3d'add-with-icon'\x3e\r\n      \x3cspan tabindex\x3d\"0\" role\x3d\"button\" id\x3d'${uid}_cpbtn' aria-label\x3d'${nls.copyToClipboard}' title\x3d'${nls.copyToClipboard}' data-dojo-attach-point\x3d'cpbtn' class\x3d'cpbtn'\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d'add-with-icon'\x3e\r\n      \x3cspan tabindex\x3d\"0\" role\x3d\"button\" title\x3d\"${nls.formatOutput}\" class\x3d'settingBtn' data-dojo-attach-point\x3d'formatButton'\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d'add-with-icon'\x3e\r\n      \x3cspan tabindex\x3d\"0\" role\x3d\"button\" aria-label\x3d'${nls.zoomLabel}' title\x3d'${nls.zoomLabel}' class\x3d'zoomBtn' data-dojo-attach-point\x3d'zoomButton'\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d'add-with-icon'\x3e\r\n      \x3cspan tabindex\x3d\"0\" role\x3d\"button\" aria-label\x3d'${nls.addPointLabel}' title\x3d'${nls.addPointLabel}' class\x3d'drawPointBtn' data-dojo-attach-point\x3d'drawPointButton'\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d'add-with-icon'\x3e\r\n      \x3cspan tabindex\x3d\"0\" role\x3d\"button\" aria-label\x3d'${nls.removeCoordinate}' title\x3d'${nls.removeCoordinate}' class\x3d'jimu-icon jimu-icon-close' data-dojo-attach-point\x3d'removeControlBtn'\r\n        data-dojo-attach-event\x3d'onclick: remove'\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d'add-with-icon'\x3e\r\n      \x3cspan tabindex\x3d\"0\" role\x3d\"button\" aria-label\x3d\"${nls.expandOutput}\" aria-expanded \x3d \"false\" title\x3d\"${nls.expandOutput}\" class\x3d'expandBtn' data-dojo-attach-point\x3d'expandButton'\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d'coordcontrols' class\x3d'coordarea' style\x3d\"display: none\"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d'sub1' class\x3d'coordformat'\x3e\r\n      \x3cdiv class\x3d'crdfrmtlabel'\x3e\r\n        \x3cspan data-dojo-attach-point\x3d'sub1label' data-a11y-label-id\x3d'sub1Label'/\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput data-a11y-label-by\x3d'sub1Label' tabindex\x3d\"-1\" role\x3d\"textbox\" readonly data-dojo-attach-point\x3d'${uid}sub1val' class\x3d'jimu-input crds'\x3e\x3c/input\x3e\r\n      \x3cdiv class\x3d'add-with-icon'\x3e\r\n        \x3cspan tabindex\x3d\"-1\" role\x3d\"button\" id\x3d'${uid}sub1val~cpbtn' aria-label\x3d'${nls.copyToClipboard}' title\x3d'${nls.copyToClipboard}' data-dojo-attach-point\x3d'subVal1CpBtn' class\x3d'jimu-icon cpbtn'\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d'sub2' class\x3d'coordformat'\x3e\r\n      \x3cdiv class\x3d'crdfrmtlabel'\x3e\r\n        \x3cspan data-dojo-attach-point\x3d'sub2label' data-a11y-label-id\x3d'sub2Label'/\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput data-a11y-label-by\x3d'sub2Label' tabindex\x3d\"-1\" role\x3d\"textbox\" readonly data-dojo-attach-point\x3d'${uid}sub2val' class\x3d'jimu-input crds'\x3e\x3c/input\x3e\r\n      \x3cdiv class\x3d'add-with-icon'\x3e\r\n        \x3cspan tabindex\x3d\"-1\" role\x3d\"button\" id\x3d'${uid}sub2val~cpbtn' aria-label\x3d'${nls.copyToClipboard}' title\x3d'${nls.copyToClipboard}' data-dojo-attach-point\x3d'subVal2CpBtn' class\x3d'jimu-icon cpbtn'\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d'sub3' class\x3d'coordformat sub3'\x3e\r\n      \x3cdiv class\x3d'crdfrmtlabel'\x3e\r\n        \x3cspan data-dojo-attach-point\x3d'sub3label' data-a11y-label-id\x3d'sub3Label'/\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput data-a11y-label-by\x3d'sub3Label' tabindex\x3d\"-1\" role\x3d\"textbox\" readonly data-dojo-attach-point\x3d'${uid}sub3val' class\x3d'jimu-input crds'\x3e\r\n      \x3c/input\x3e\r\n      \x3cdiv class\x3d'add-with-icon'\x3e\r\n        \x3cspan tabindex\x3d\"-1\" role\x3d\"button\" id\x3d'${uid}sub3val~cpbtn' aria-label\x3d'$${nls.copyToClipboard}' title\x3d'$${nls.copyToClipboard}' data-dojo-attach-point\x3d'subVal3CpBtn' class\x3d'jimu-icon cpbtn'\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d'sub4' class\x3d'coordformat sub4'\x3e\r\n      \x3cdiv class\x3d'crdfrmtlabel'\x3e\r\n        \x3cspan data-dojo-attach-point\x3d'sub4label' data-a11y-label-id\x3d'sub4Label' /\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput data-a11y-label-by\x3d'sub4Label' tabindex\x3d\"-1\" role\x3d\"textbox\" readonly data-dojo-attach-point\x3d'${uid}sub4val' class\x3d'jimu-input crds'\x3e\r\n      \x3c/input\x3e\r\n      \x3cdiv class\x3d'add-with-icon'\x3e\r\n        \x3cspan tabindex\x3d\"-1\" role\x3d\"button\" id\x3d'${uid}sub4val~cpbtn' aria-label\x3d'${nls.copyToClipboard} title\x3d'${nls.copyToClipboard}' data-dojo-attach-point\x3d'subVal4CpBtn' class\x3d'jimu-icon cpbtn'\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d\"line-separator\"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e",
"url:dijit/templates/InlineEditBox.html":'\x3cspan data-dojo-attach-point\x3d"editNode" role\x3d"presentation" class\x3d"dijitReset dijitInline dijitOffScreen"\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"editorPlaceholder"\x3e\x3c/span\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"buttonContainer"\r\n\t\t\x3e\x3cbutton data-dojo-type\x3d"./form/Button" data-dojo-props\x3d"label: \'${buttonSave}\', \'class\': \'saveButton\'"\r\n\t\t\tdata-dojo-attach-point\x3d"saveButton" data-dojo-attach-event\x3d"onClick:save"\x3e\x3c/button\r\n\t\t\x3e\x3cbutton data-dojo-type\x3d"./form/Button"  data-dojo-props\x3d"label: \'${buttonCancel}\', \'class\': \'cancelButton\'"\r\n\t\t\tdata-dojo-attach-point\x3d"cancelButton" data-dojo-attach-event\x3d"onClick:cancel"\x3e\x3c/button\r\n\t\x3e\x3c/span\r\n\x3e\x3c/span\x3e\r\n',
"url:widgets/Visibility/templates/portal-publish.html":'\x3cdiv class\x3d"esriCTFullHeight" data-dojo-attach-point\x3d"resultsPageNode"\x3e\r\n  \x3cdiv class\x3d"esriCTFullWidth esriCTSettingHeader"\x3e\r\n    \x3cdiv class\x3d"esriCTBackButton" title\x3d"${nls.back}"\x3e\r\n      \x3cdiv class\x3d"esriCTItemLeftArrow" data-dojo-attach-point\x3d"resultsPanelBackButton" tabindex\x3d"0"\r\n        aria-label\x3d"${nls.back}" role\x3d"button"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.resultsTitle}"\x3e${nls.resultsTitle}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n      \x3c!-- esriCT Layer Name --\x3e\r\n      \x3cdiv class\x3d"esriCTFullWidth esriCTSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTInputLabel esriCTEllipsis" title\x3d"${nls.layerName}"\x3e${nls.layerName}\x3c/div\x3e\r\n        \x3cinput aria-label\x3d"${nls.layerName}" class\x3d"esriCTHidden" style\x3d"width: 100%; margin-bottom: 8px;"\r\n          data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"addLayerNameArea"\r\n          data-dojo-props\x3d"regExp:\'[a-zA-Z0-9_ -]*\'" required\x3d"true" tabindex\x3d"0" trim\x3d"true"\x3e\x3c/input\x3e\r\n        \x3cselect class\x3d"publishSelect" aria-label\x3d"${nls.layerName}" data-dojo-type\x3d"jimu/dijit/formSelect" tabindex\x3d"0"\r\n          data-dojo-attach-point\x3d"featureLayerList"\x3e\x3c/select\x3e\r\n        \x3cdiv class\x3d"esriCTCheckBoxNode" data-dojo-attach-point\x3d"checkBoxParentContainer"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- Publish esriCT Button --\x3e\r\n      \x3cdiv class\x3d"esriCTPublishBtnContainer"\x3e\r\n        \x3cdiv class\x3d\'jimu-btn\' data-dojo-attach-point\x3d\'publishButton\' tabindex\x3d"0" aria-label\x3d"${nls.publishBtnLabel}"\r\n          role\x3d"button"\x3e${nls.publishBtnLabel}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!-- Publishing Message --\x3e\r\n      \x3cdiv class\x3d"esriCTPublishMessage" data-dojo-attach-point\x3d"publishMessage"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Visibility/templates/ColorPickerEditor.html":'\x3cdiv class\x3d"esriCTColorPickerEditor"\x3e\r\n  \x3cdiv class\x3d"colorPicker" data-dojo-attach-point\x3d"colorPicker"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTSliderWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTSliderbar" data-dojo-attach-point\x3d"sliderBar"\x3e\r\n      \x3col data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" class\x3d"esriCTSliderLabelHeight" style\x3d"height:2.5em;" container\x3d"topDecoration" data-dojo-attach-point\x3d"sliderBarLabel"\x3e\r\n        \x3cli\x3e${nls.transparency}\x3c/li\x3e\r\n        \x3cli\x3e\x3c/li\x3e\r\n      \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberSpinner" value\x3d"0" data-dojo-attach-point\x3d"spinner"\r\n    data-dojo-props\x3d"smallDelta:10,intermediateChanges:true,constraints: {min:0,max:100}" aria-label\x3d"${nls.transparency}"\x3e\r\n  \x3cdiv class\x3d"esriCTOutFillSection"\x3e\r\n    \x3clabel for\x3d"${id}_select"\x3e${nls.style}\x3c/label\x3e\r\n    \x3cselect class\x3d"noResize" data-dojo-type\x3d"jimu/dijit/formSelect" aria-label\x3d"${nls.style}" data-dojo-attach-point\x3d"dropdown" /\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Visibility/templates/symbologySettings.html":'\x3cdiv\x3e\r\n       \x3c!-- Visible Section DropDown --\x3e\r\n       \x3cdiv class\x3d"esriCTSettingsRow"\x3e\r\n        \x3cdiv class\x3d"esriCTLabelSettingsRightButton esriCTSettingsButtonIcon esriCTPointer"\r\n          title\x3d"${nls.visibleSectionButtonLabel}" data-dojo-attach-point\x3d"visibleSectionSettingsButton"\r\n          role\x3d"button" aria-label\x3d"${nls.visibleSectionButtonLabel}" tabindex\x3d"0" aria-expanded \x3d"false"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTInputLabelSettings esriCTEllipsis esriCTSubTitle" title\x3d"${nls.visibleSectionLabel}"\x3e\r\n          ${nls.visibleSectionLabel}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!-- Visible Section Color Pickers --\x3e\r\n      \x3cdiv class\x3d"container esriCTGroupHidden" data-dojo-attach-point\x3d"visibleSectionContainer"\x3e\r\n        \x3cdiv class\x3d"esriCTEllipsis" title\x3d"${nls.outline}"\x3e${nls.outline}\x3c/div\x3e\r\n        \x3cdiv class\x3d"colorPicker Line" nodeId\x3d"visibleSectionOutlineColor"\r\n          data-dojo-attach-point\x3d"visibleAreaOutlineColorPicker"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTEllipsis" title\x3d"${nls.fill}"\x3e${nls.fill}\x3c/div\x3e\r\n        \x3cdiv class\x3d"colorPicker Fill" nodeId\x3d"visibleSectionFillColor"\r\n          data-dojo-attach-point\x3d"visibleAreaFillColorPicker"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!-- Non-visible Section DropDown --\x3e\r\n      \x3cdiv class\x3d"esriCTSettingsRow"\x3e\r\n        \x3cdiv class\x3d"esriCTLabelSettingsRightButton esriCTSettingsButtonIcon esriCTPointer"\r\n        title\x3d"${nls.nonVisibleSectionButtonLabel}" data-dojo-attach-point\x3d"nonVisibleSectionSettingsButton"\r\n        role\x3d"button" aria-label\x3d"${nls.nonVisibleSectionButtonLabel}" tabindex\x3d"0" aria-expanded \x3d"false"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTInputLabelSettings esriCTEllipsis esriCTSubTitle" title\x3d"${nls.nonVisibleSectionLabel}"\x3e${nls.nonVisibleSectionLabel}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!-- Non-visible Section --\x3e\r\n      \x3cdiv class\x3d"container esriCTGroupHidden" data-dojo-attach-point\x3d"nonVisibleSectionContainer"\x3e\r\n        \x3cdiv class\x3d"esriCTEllipsis" title\x3d"${nls.outline}"\x3e${nls.outline}\x3c/div\x3e\r\n        \x3cdiv class\x3d"colorPicker Line" nodeId\x3d"nonVisibleSectionOutlineColor" data-dojo-attach-point\x3d"nonVisibleAreaOutlineColorPicker"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTEllipsis" title\x3d"${nls.fill}"\x3e${nls.fill}\x3c/div\x3e\r\n        \x3cdiv class\x3d"colorPicker Fill" nodeId\x3d"nonVisibleSectionFillColor" data-dojo-attach-point\x3d"nonVisibleAreaFillColorPicker"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e   \r\n\x3c/div\x3e',
"url:widgets/Visibility/Widget.html":"\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d'visibilityContainer'\x3e\x3c/div\x3e\r\n\x3c/div\x3e","url:widgets/Visibility/css/style.css":".jimu-widget-visibility-control .controls {margin: 20px 0 0 0;}.jimu-widget-visibility-control .inputNumberTextbox {width: calc(100% - 120px) !important; margin: 0px;}.jimu-widget-visibility-control .controlGroup {padding: 4px 2px;}.jimu-widget-visibility-control .buttonContainer {display: flex;}.jimu-widget-visibility-control .controlSpace {margin-left: unset;}.jimu-widget-visibility-control .titleLabel {padding-bottom: 5px; display: block;}.jimu-widget-visibility-control .noResize .dijitSelectLabel,.jimu-widget-visibility-control .noResize .dijitTextBox .dijitInputInner,.jimu-widget-visibility-control .noResize.dijitValidationTextBox .dijitValidationContainer {text-overflow: ellipsis; overflow: hidden; width: 60px; text-align: initial; padding-top: 5px;}.jimu-widget-visibility-control .claro .dijitSelect {background-color: rgba(255, 255, 255, 0);}.jimu-widget-visibility-control .dijitSelect .dijitButtonContents {border-style: none none none none; background-color: #ffffff;}.jimu-widget-visibility-control .dijitSelect .dijitButtonContentsDartTheme {background-color: inherit;}.jimu-widget-visibility-control .dijitSelect .dijitArrowButton {background-color: #ffffff; background-image: none; border-color: #ffffff;}.jimu-widget-visibility-control .dijitSelect .dijitArrowButtonDartTheme {background-color: rgba(0, 0, 0, 0.5) !important;}.jimu-widget-visibility-control .dijitMenuItem {color: #7989a0;}.jimu-widget-visibility-control .dijitSelect .dijitInputField {margin-right: 8px;}.jimu-widget-visibility-control .cursortooltip {z-index: 10; position: fixed; border: 1px solid #777; color: black; background-color: white; margin: 2px; padding: 6px; border-radius: 6px;}.jimu-widget-visibility-control .center {display: table !important; margin: 0 auto;}.jimu-widget-visibility-control .btnContainer {text-align: right; margin-top: 15px; display: grid; padding: 15px 4px;}.jimu-widget-visibility-control .HalfWidthLeft {width: 50%;}.jimu-widget-visibility-control .HalfWidthRight {width: 50%;}.jimu-widget-visibility-control .jimu-coordinate-control textarea {width: 100%;}.jimu-widget-visibility-control .jimu-coordinate-control .add-with-icon.coordInput {width: calc(100% - 60px);}.jimu-widget-visibility-control .jimu-coordinate-control .coordLabel {font-size: 12px;}.jimu-widget-visibility-control .switch-toggle-group {padding: 5px;}.jimu-widget-visibility-control .switch-toggle-group .checkbox-inline {padding-left: 36px; vertical-align: top;}.jimu-widget-visibility-control .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: -36px;}.jimu-widget-visibility-control .switch-toggle.dijitCheckBox {height: 16px; width: 28px; border: 0 none; background: #adadad; position: relative; float: right; cursor: pointer; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}.jimu-rtl .jimu-widget-visibility-control .switch-toggle.dijitCheckBox {float: left;}.jimu-widget-visibility-control .switch-toggle.dijitCheckBox:before {content: \"\"; background: #f8f8f8; position: absolute; padding: 0; height: 12px; width: 12px; left: auto; right: 14px; top: 2px; z-index: 1; -webkit-transition: right 0.3s; -moz-transition: right 0.3s; -o-transition: right 0.3s; transition: right 0.3s; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%;}.jimu-widget-visibility-control .switch-toggle.dijitCheckBox input {width: 100%; height: 100%; position: absolute; left: 0; z-index: 2;}.jimu-widget-visibility-control .switch-toggle.dijitCheckBox.dijitCheckBoxChecked {background: #50ad4e;}.jimu-widget-visibility-control .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before {right: 2px;}.btnContainer {text-align: right; margin-top: 6px;}.settingsContainer {margin-top: 6px;}.checkBoxText {padding: 0 5px 0 5px;}.controlContainer {margin-top: 6px;}.customFormatTextbox {height: 30px; background-color: transparent; border: 1px solid #d2dae2; padding: 5px; margin: 0 3px 0 3px; width: 55%; font-family: 'Avenir Light', Verdana, Geneva, sans-serif;}.coordNotationSelect {background-color: transparent; height: 30px; user-select: none; width: 40%; float: left; border: 1px solid #d2dae2; font-family: 'Avenir Light', Verdana, Geneva, sans-serif; margin-bottom: 5px;}.jimu-rtl .coordNotationSelect {float: right;}.DartTheme .jimu-widget-visibility-control .cusrortooltip {background-color: #4c4c4c;}.claro .dartThemeClaroDijitTooltipContainerOverride .dijitTooltipContainer {background-color: #4c4c4c; background-image: -webkit-linear-gradient(bottom, rgb(76, 76, 76) 0px, #4c4c4c 10px); border: 1px solid #ffffff; color: #ffffff;}.claro .dartThemeClaroDijitTooltipContainerOverride .jimu-widget-subtitle {color: #ffffff;}.claro .dartThemeClaroDijitTooltipContainerOverride .dijitTooltipConnector {background-image: url('images/tooltip.png');}.jimu-widget-visibility-control .jimu-coordinate-control .settingBtn {margin-left: 1px;}.jimu-widget-visibility-control .jimu-coordinate-control .drawPointBtn {margin-left: 2px;}.jimu-widget-visibility-publish .esriCTFullHeight {height: 100%;}.jimu-widget-visibility-publish .esriCTFullWidth,.jimu-widget-visibility-control .esriCTFullWidth {width: 100%;}.jimu-widget-visibility-publish .esriCTSettingHeader,.jimu-widget-visibility-control .esriCTSettingHeader {height: 30px; border-bottom: 1px solid #464646;}.jimu-widget-visibility-publish .esriCTBackButton,.jimu-widget-visibility-control .esriCTBackButton {display: table; width: 100%;}.jimu-widget-visibility-publish .esriCTItemLeftArrow,.jimu-widget-visibility-control .esriCTItemLeftArrow {background-image: url('./images/left-arrow_black.png'); display: table-cell; width: 20px; height: 20px; background-repeat: no-repeat; background-position: center center; cursor: pointer;}.jimu-rtl .jimu-widget-visibility-publish .esriCTItemLeftArrow {transform: rotate(180deg);}.jimu-widget-visibility-publish .esriCTItemLeftArrow:hover {background-image: url('./images/left-arrow_black_hover.png');}.jimu-widget-visibility-publish .esriCTTitleDiv,.jimu-widget-visibility-control .esriCTTitleDiv {line-height: 10px; font-weight: bold; text-align: center; width: calc(100% - 50px); height: 20px; padding-top: 6px;}.jimu-widget-visibility-publish .esriCTEllipsis,.jimu-widget-visibility-control .esriCTEllipsis {overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-visibility-publish .esriCTMainPageRow,.jimu-widget-visibility-control .esriCTMainPageRow {width: calc(100% - 20px); margin: 20px 10px 10px 10px; display: inline-block;}.jimu-widget-visibility-publish .esriCTInputLabel {float: left; line-height: 28px; padding: 5px 0px 0px 0px; width: 100%;}.jimu-widget-visibility-publish .SelectStyle {height: 30px; color: #7d7d7d; padding-left: 5px; font-size: 13px; width: 100%; margin: 1px 0 8px 0;}.jimu-widget-visibility-publish .publishSelect .dijitSelectLabel {overflow: hidden; white-space: nowrap; text-overflow: ellipsis; width: 288px; text-align: left;}.jimu-widget-visibility-publish .esriCTCheckBoxNode {padding-top: 10px;}.jimu-widget-visibility-publish .esriCTPublishBtnContainer {text-align: right; margin-top: 15px; display: grid;}.jimu-widget-visibility-publish .esriCTPublishMessage {float: left; line-height: 16px; padding: 18px 0px 0px 0; font-weight: bold; display: inline-block; word-break: break-all;}.jimu-rtl .jimu-widget-visibility-publish .esriCTPublishMessage {float: right;}.jimu-widget-visibility-publish .esriCTHidden {display: none;}.jimu-widget-visiblity .esriCTHidden {display: none;}.jimu-widget-visiblity .jimu-btn {width: 100%;}.jimu-widget-visibility-publish .esriCTPublishControl {float: right; min-width: 9px; line-height: 12px; padding-bottom: 3px; padding-top: 3px;}.jimu-widget-visibility-control .esriCTMainTitleDiv {line-height: 10px; font-weight: bold; text-align: left; width: calc(100% - 50px); padding: 5px 3px 5px 3px; display: inline-block;}.jimu-rtl .jimu-widget-visibility-control .esriCTMainTitleDiv {text-align: right;}.jimu-widget-visibility-control .esriCTSaveToLayerIcon {background-image: url('./images/left-arrow_black.png'); width: 20px; height: 20px; background-repeat: no-repeat; background-position: center center; cursor: pointer; transform: rotate(180deg);}.jimu-rtl .jimu-widget-visibility-control .esriCTSaveToLayerIcon {float: left; transform: rotate(360deg);}.jimu-widget-visibility-control .esriCTSaveToLayerIcon:hover {background-image: url('./images/left-arrow_black_hover.png'); background-repeat: no-repeat;}.jimu-widget-visibility-control .esriCTNewHeader {float: left; height: 30px; border-bottom: 1px solid #464646; padding: 0px 2px;}.jimu-widget-visibility-control .esriCTSliderWrapper {width: calc(100% - 278px); display: inline-block; margin: 5px;}.jimu-widget-visibility-control .dijitSlider {width: 100%;}.jimu-rtl .jimu-widget-visibility-control .dijitSlider {margin-left: auto; margin-right: 10px;}.jimu-widget-visibility-control .dijitSlider .dijitSliderImageHandleH {top: -10px; width: 20px; height: 20px;}.jimu-widget-visibility-control .esriCTColorPickerEditor {padding-top: 5px; padding-bottom: 8px; min-width: 350px; display: inline-table;}.jimu-widget-visibility-control .esriCTColorPickerEditor .jimu-color-picker {display: inline-block; width: 25px; height: 25px;}.jimu-widget-visibility-control .esriCTColorPickerEditor .dijitSpinner.dijitNumberTextBox.dijitValidationTextBox {width: 70px; height: 30px;}.jimu-widget-visibility-control .dijitSliderImageHandleH {top: -7px;}.jimu-widget-visibility-control .dijitSliderThumbHover {background-image: url(\"../images/sliderball.svg\"); background-position: 0 0;}.jimu-widget-visibility-control .dijitSliderImageHandle.dijitSliderImageHandleH {background-image: url(\"../images/sliderball.svg\"); background-position: 0 0;}.jimu-widget-visibility-control .dijitSliderImageHandle.dijitSliderImageHandleH.dojoMoveItem {background-image: url(\"../images/sliderball.svg\"); background-position: 0 0;}.jimu-widget-visibility-control .dijitSlider .dijitSliderProgressBarH,.jimu-widget-visibility-control .dijitSlider .dijitSliderLeftBumper {border-color: #000; background-color: #000; background-image: -webkit-linear-gradient(top, #000 0px, #000 1px, rgba(255, 255, 255, 0) 2px); background-image: -o-linear-gradient(top, #000 0px, #000 1px, rgba(255, 255, 255, 0) 2px); background-image: linear-gradient(top, #000 0px, #000 1px, rgba(255, 255, 255, 0) 2px);}.jimu-widget-visibility-control .dijitSlider .dijitSliderRemainingBarH,.jimu-widget-visibility-control .dijitSlider .dijitSliderRightBumper {border-color: #d7d7d7; background-color: #d7d7d7;}.jimu-widget-visibility-control .esriCTColorPickerEditor .trans {font-family: \"Avenir Light\"; font-size: 12px; padding: 0 5px 0 5px; letter-spacing: 0.33px;}.jimu-widget-visibility-control .sliderbar {width: 60px;}.dijitRuleLabelH {left: -12%;}.jimu-widget-visibility-control .esriCTOutFillSection {vertical-align: middle; display: inline-flex; flex-direction: column; margin: 0px 0px 14px 3px;}.jimu-rtl .jimu-widget-visibility-control .esriCTOutFillSection {margin: 0px 3px 14px 0px;}.jimu-widget-visibility-symbologySettings .esriCTSettingsRow {width: 100%; display: inline-flex;}.jimu-widget-visibility-symbologySettings .esriCTLabelSettingsRightButton {background: url(\"../images/arrow-right_black.png\") no-repeat;}.jimu-rtl .jimu-widget-visibility-symbologySettings .esriCTLabelSettingsRightButton {transform: rotate(180deg);}.jimu-widget-visibility-symbologySettings .esriCTLabelSettingsRightButton:hover {background: url(\"../images/arrow-right_black_hover.png\") no-repeat;}.jimu-widget-visibility-symbologySettings .esriCTSettingsButtonIcon {margin-top: 13px; height: 16px; width: 16px;}.jimu-rtl .jimu-widget-visibility-symbologySettings .esriCTSettingsButtonIcon {margin: 10px 0px 0px 5px;}.jimu-widget-visibility-symbologySettings .esriCTPointer {cursor: pointer;}.jimu-widget-visibility-symbologySettings .esriCTInputLabelSettings {float: left; line-height: 28px; padding: 5px 0px 0px 0px;}.jimu-widget-visibility-symbologySettings .esriCTEllipsis {overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-visibility-symbologySettings .esriCTSubTitle {font-weight: bold;}.jimu-widget-visibility-symbologySettings .esriCTGroupHidden {display: none;}.jimu-widget-visibility-symbologySettings .esriCTLabelSettingsDownButton {background: url(\"../images/arrow-down_black.png\") no-repeat; margin-top: 15px;}.jimu-rtl .jimu-widget-visibility-symbologySettings .esriCTLabelSettingsDownButton {margin: 15px 0px 0px 5px;}.jimu-widget-visibility-symbologySettings .esriCTLabelSettingsDownButton:hover {background: url(\"../images/arrow-down_black_hover.png\") no-repeat;}.jimu-widget-visibility-control .esriCTSettingsIcon {background-image: url('./images/settings_black.png'); height: 16px; width: 16px; background-size: 16px; background-repeat: no-repeat; margin-top: 2px; margin-right: 13px; display: inline-block;}.jimu-rtl .jimu-widget-visibility-control .esriCTSettingsIcon {float: left;}.jimu-widget-visibility-control .esriCTSettingsIcon:hover {background-image: url('./images/settings_black_hover.png'); background-repeat: no-repeat;}.jimu-widget-visibility-symbologySettings .esriCTSettingsButtonIcon:focus {outline: 2px solid #24B5CC !important; outline-offset: -2px;}.jimu-widget-visibility-control .esriCTRightSideButton {float: right; display: inline-flex;}.jimu-rtl .jimu-widget-visibility-control .esriCTRightSideButton {float: left;}.DashboardTheme.light .jimu-widget-visibility-control .settingBtn {background-image: url(./images/settings_black.png);}.DashboardTheme.light .jimu-widget-visibility-control .settingBtn:hover {background-image: url(./images/settings_black_hover.png);}",
"*now":function(H){H(['dojo/i18n!*preload*widgets/Visibility/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/topic dojo/dom-attr jimu/BaseWidget dijit/_WidgetsInTemplateMixin jimu/dijit/Message jimu/utils ./js/VisibilityControl ./js/PrivilegeUtil".split(" "),function(H,m,n,r,l,k,b,a,d,f,e){return H([k,b],{baseClass:"jimu-widget-visiblity",privilegeUtil:null,_visibilityControl:null,postMixInProperties:function(){this.nls=n.mixin(this.nls,window.jimuNls.coordinateControl)},destroy:function(){if(this._visibilityControl)this._visibilityControl.onClearBtnClicked();
this.inherited(arguments)},resize:function(){r.publish("WIDGET_RESIZE",{})},startup:function(){this.inherited(arguments);this.config.portalUrl?(this.config.hasOwnProperty("defaultObserverHeightUnit")||(this.config.defaultObserverHeightUnit="meters"),this.config.hasOwnProperty("defaultObservableDistanceUnit")||(this.config.defaultObservableDistanceUnit="kilometers"),this.config.hasOwnProperty("defaultAngleUnits")||(this.config.defaultAngleUnits=!1),this.privilegeUtil=e.getInstance(this.config.portalUrl),
this.privilegeUtil.loadPrivileges().then(n.hitch(this,this._validatePrivileges),n.hitch(this,this._showError))):this._showError(this.nls.portalURLError)},_validatePrivileges:function(h){h&&this.privilegeUtil._canPerformElevationAnalysis()?this._createVisibilityControl():this._showError()},_showError:function(h){h||(h=this.nls.privilegeError,this.privilegeUtil._isServiceAvailable||(h=this.nls.noServiceError));new a({message:h});l.set(this.visibilityContainer,"innerHTML",h)},_createVisibilityControl:function(){var h=
this.privilegeUtil.getUserPortal();!this._visibilityControl&&h&&(this._visibilityControl=(new f({config:this.config,parentWidget:this,nls:this.nls,appConfig:this.appConfig,portalUrl:h,pointSymbol:{color:[255,0,0,64],size:12,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,0,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"}},map:this.map},m.create("div"))).placeAt(this.visibilityContainer),this._visibilityControl.startup(),this._setTheme())},_removeStyleFile:function(h,c){var g=null;g="js"===
c?"src":"css"===c?"href":"none";c=document.getElementsByTagName("js"===c?"script":"css"===c?"link":"none");for(var p=c.length;0<=p;p--)c[p]&&null!==c[p].getAttribute(g)&&-1!==c[p].getAttribute(g).indexOf(h)&&c[p].parentNode.removeChild(c[p])},_setTheme:function(){"DartTheme"===this.appConfig.theme.name?d.loadStyleLink("dartOverrideCSS",this.folderUrl+"css/dartTheme.css",null):this._removeStyleFile(this.folderUrl+"css/dartTheme.css","css");"DashboardTheme"===this.appConfig.theme.name?d.loadStyleLink("dashboardOverrideCSS",
this.folderUrl+"css/dashboardTheme.css",null):this._removeStyleFile(this.folderUrl+"css/dashboardTheme.css","css");"LaunchpadTheme"===this.appConfig.theme.name?d.loadStyleLink("launchpadOverrideCSS",this.folderUrl+"css/launchpadTheme.css",null):this._removeStyleFile(this.folderUrl+"css/launchpadTheme.css","css");"BoxTheme"===this.appConfig.theme.name?d.loadStyleLink("boxOverrideCSS",this.folderUrl+"css/boxTheme.css",null):this._removeStyleFile(this.folderUrl+"css/boxTheme.css","css")}})});