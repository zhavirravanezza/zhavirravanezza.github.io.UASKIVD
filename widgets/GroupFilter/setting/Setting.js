// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),function(u,E,K,H,G,c,
d,f,h,l,n,p,t,y,z,b,g,A,O,q,r,B,F,Q,P){function C(k){return new q({command:k.name})}function m(k){return new q({buttonClass:O,command:k.name})}K=K("dijit.Editor",Q,{plugins:null,extraPlugins:null,constructor:function(){n.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",r]);this._plugins=[];this._editInterval=
1E3*this.editActionInterval;if(p("ie")||p("trident")||p("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new H;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);n.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=G.getLocalization("dijit._editor","commands",this.lang);
p("webkit")&&h.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new b({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));E.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);d.add(this.iframe.parentNode,"dijitEditorIFrameContainer");d.add(this.iframe,"dijitEditorIFrame");c.set(this.iframe,"allowTransparency",!0);this.toolbar.startup();
this.onNormalizedDisplayChanged()},destroy:function(){E.forEach(this._plugins,function(k){k&&k.destroy&&k.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(k,D){var I=n.isString(k)?{name:k}:n.isFunction(k)?{ctor:k}:k;if(!I.setEditor){var a={args:I,plugin:null,editor:this};I.name&&(q.registry[I.name]?a.plugin=q.registry[I.name](I):y.publish(P._scopeName+".Editor.getPlugin",a));if(!a.plugin)try{var e=I.ctor||n.getObject(I.name)||
u(I.name);e&&(a.plugin=new e(I))}catch(v){throw Error(this.id+": cannot find plugin ["+I.name+"]");}if(!a.plugin)throw Error(this.id+": cannot find plugin ["+I.name+"]");k=a.plugin}1<arguments.length?this._plugins[D]=k:this._plugins.push(k);k.setEditor(this);n.isFunction(k.setToolbar)&&k.setToolbar(this.toolbar)},resize:function(k){k&&A.prototype.resize.apply(this,arguments)},layout:function(){var k=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+f.getPadBorderExtents(this.iframe.parentNode).h+
f.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=k+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(k){var D,I=this.document.body,a=I.clientWidth,e=I.clientHeight,v=I.clientLeft,x=I.offsetWidth,w=I.offsetHeight,N=I.offsetLeft;/^rtl$/i.test(I.dir||"")?a<x&&k.x>a&&k.x<x&&(D=!0):k.x<v&&k.x>N&&(D=!0);D||e<w&&k.y>e&&k.y<w&&(D=!0);D||(delete this._cursorToStart,delete this._savedSelection,"BODY"==k.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(k){this.customUndo&&this.endEditing(!0);"BODY"!=k.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(k){this._inEditing||(this._inEditing=!0,this._beginEditing(k));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(k){if(!this.customUndo||
"undo"!=k&&"redo"!=k){this.customUndo&&(this.endEditing(),this._beginEditing());var D=this.inherited(arguments);this.customUndo&&this._endEditing();return D}return this[k]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(k){try{var D=this.document.execCommand(k,!1,null);if(p("webkit")&&!D)throw{};}catch(I){D=t.substitute,alert(D(this.commands.systemShortcut,
[this.commands[k],D(this.commands[p("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[k]])])),D=!1}return D},queryCommandEnabled:function(k){return!this.customUndo||"undo"!=k&&"redo"!=k?this.inherited(arguments):"undo"==k?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(k){var D=k.mark,I=k.mark;k=k.isCollapsed;var a;if(I)if(9>p("ie")||9===p("ie")&&p("quirks"))if(n.isArray(I))D=[],E.forEach(I,function(x){D.push(F.getNode(x,this.editNode))},this),this.selection.moveToBookmark({mark:D,
isCollapsed:k});else{if(I.startContainer&&I.endContainer&&(a=F.getSelection(this.window))&&a.removeAllRanges){a.removeAllRanges();k=F.create(this.window);var e=F.getNode(I.startContainer,this.editNode);var v=F.getNode(I.endContainer,this.editNode);e&&v&&(k.setStart(e,I.startOffset),k.setEnd(v,I.endOffset),a.addRange(k))}}else(a=F.getSelection(this.window))&&a.removeAllRanges&&(a.removeAllRanges(),k=F.create(this.window),e=F.getNode(I.startContainer,this.editNode),v=F.getNode(I.endContainer,this.editNode),
e&&v&&(k.setStart(e,I.startOffset),k.setEnd(v,I.endOffset),a.addRange(k)))},_changeToStep:function(k,D){this.setValue(D.text);(k=D.bookmark)&&this._moveToBookmark(k)},undo:function(){var k=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var D=this._steps.pop();D&&0<this._steps.length&&(this.focus(),this._changeToStep(D,this._steps[this._steps.length-1]),this._undoedSteps.push(D),this.onDisplayChanged(),delete this._undoRedoActive,k=!0);delete this._undoRedoActive}return k},
redo:function(){var k=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var D=this._undoedSteps.pop();D&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],D),this._steps.push(D),this.onDisplayChanged(),k=!0);delete this._undoRedoActive}return k},endEditing:function(k){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(k),this._inEditing=!1)},_getBookmark:function(){var k=this.selection.getBookmark(),
D=[];if(k&&k.mark){var I=k.mark;if(9>p("ie")||9===p("ie")&&p("quirks")){var a=F.getSelection(this.window);if(n.isArray(I))E.forEach(k.mark,function(v){D.push(F.getIndex(v,this.editNode).o)},this),k.mark=D;else if(a){var e;a.rangeCount&&(e=a.getRangeAt(0));k.mark=e?e.cloneRange():this.selection.getBookmark()}}try{k.mark&&k.mark.startContainer&&(D=F.getIndex(k.mark.startContainer,this.editNode).o,k.mark={startContainer:D,startOffset:k.mark.startOffset,endContainer:k.mark.endContainer===k.mark.startContainer?
D:F.getIndex(k.mark.endContainer,this.editNode).o,endOffset:k.mark.endOffset})}catch(v){k.mark=null}}return k},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:B.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var k=B.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:k,bookmark:this._getBookmark()})},onKeyDown:function(k){p("ie")||this.iframe||k.keyCode!=l.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var D=
k.keyCode;if(k.ctrlKey&&!k.shiftKey&&!k.altKey){if(90==D||122==D){k.stopPropagation();k.preventDefault();this.undo();return}if(89==D||121==D){k.stopPropagation();k.preventDefault();this.redo();return}}this.inherited(arguments);switch(D){case l.ENTER:case l.BACKSPACE:case l.DELETE:this.beginEditing();break;case 88:case 86:if(k.ctrlKey&&!k.altKey&&!k.metaKey){this.endEditing();88==k.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!k.ctrlKey&&!k.altKey&&
!k.metaKey&&(k.keyCode<l.F1||k.keyCode>l.F15)){this.beginEditing();break}case l.ALT:this.endEditing();break;case l.UP_ARROW:case l.DOWN_ARROW:case l.LEFT_ARROW:case l.RIGHT_ARROW:case l.HOME:case l.END:case l.PAGE_UP:case l.PAGE_DOWN:this.endEditing(!0);case l.CTRL:case l.SHIFT:case l.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(k){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(k){this.customUndo?this.isClosed?this.setValue(k):(this.beginEditing(),k||(k="\x26#160;"),this.setValue(k),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(k){this.setValueDeferred.then(n.hitch(this,function(){!this.disabled&&k||!this._buttonEnabledPlugins&&k?
E.forEach(this._plugins,function(D){D.set("disabled",!0)}):this.disabled&&!k&&E.forEach(this._plugins,function(D){D.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(h.set(this.document.body,"color",h.get(this.iframe,"color")),h.set(this.document.body,"background-color",h.get(this.iframe,"background-color")))}catch(k){}}});n.mixin(q.registry,{undo:C,redo:C,cut:C,copy:C,paste:C,insertOrderedList:C,insertUnorderedList:C,
indent:C,outdent:C,justifyCenter:C,justifyFull:C,justifyLeft:C,justifyRight:C,"delete":C,selectAll:C,removeFormat:C,unlink:C,insertHorizontalRule:C,bold:m,italic:m,underline:m,strikethrough:m,subscript:m,superscript:m,"|":function(){return new q({setEditor:function(k){this.editor=k;this.button=new g({ownerDocument:k.ownerDocument})}})}});return K})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(u,E,K,H,G,c,d,f){K("dijit-legacy-requires")&&G(0,function(){u(["dijit/ToolbarSeparator"])});return E("dijit.Toolbar",[c,f,d],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(u,E,K,H){return u("dijit.ToolbarSeparator",[K,H],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);E.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(u,E,K,H,G){E=E("dijit._editor._Plugin",H,{constructor:function(c){this.params=
c||{};K.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:G,disabled:!1,getLabel:function(c){return this.editor.commands[c]},_initButton:function(){if(this.command.length){var c=this.getLabel(this.command),d=this.editor,f=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(c=K.mixin({label:c,ownerDocument:d.ownerDocument,dir:d.dir,
lang:d.lang,showLabel:!1,iconClass:f,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete c.name,this.button=new this.buttonClass(c))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(c,d,f){this.own(u.connect(c,d,this,f))},updateState:function(){var c=this.editor,d=this.command;if(c&&c.isLoaded&&d.length){var f=this.get("disabled");if(this.button)try{var h=
c._implCommand(d);var l=!f&&(this[h]?this[h](d):c.queryCommandEnabled(d));this.enabled!==l&&(this.enabled=l,this.button.set("disabled",!l));if(l&&"boolean"==typeof this.button.checked){var n=c.queryCommandState(d);this.checked!==n&&(this.checked=n,this.button.set("checked",c.queryCommandState(d)))}}catch(p){console.log(p)}}},setEditor:function(c){this.editor=c;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",K.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",K.hitch(this,"updateState")))},setToolbar:function(c){this.button&&c.addChild(this.button)},set:function(c,d){if("object"===typeof c){for(var f in c)this.set(f,c[f]);return this}f=this._getAttrNames(c);if(this[f.s])var h=this[f.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(c,d);return h||this},get:function(c){var d=this._getAttrNames(c);
return this[d.g]?this[d.g]():this[c]},_setDisabledAttr:function(c){this._set("disabled",c);this.updateState()},_getAttrNames:function(c){var d=this._attrPairNames;if(d[c])return d[c];var f=c.charAt(0).toUpperCase()+c.substr(1);return d[c]={s:"_set"+f+"Attr",g:"_get"+f+"Attr"}},_set:function(c,d){this[c]=d}});E.registry={};return E})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n){return u("dijit._editor.plugins.EnterKeyHandling",h,{blockNodeForEnter:"BR",constructor:function(p){p&&("blockNodeForEnter"in p&&(p.blockNodeForEnter=p.blockNodeForEnter.toUpperCase()),H.mixin(this,p))},setEditor:function(p){if(this.editor!==p)if(this.editor=p,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,p.onLoadDeferred.then(H.hitch(this,function(y){this.own(G(p.document,"keydown",H.hitch(this,function(z){if(z.keyCode==K.ENTER){var b=H.mixin({},z);b.shiftKey=
!0;this.handleEnterKey(b)||(z.stopPropagation(),z.preventDefault())}})));9<=c("ie")&&10>=c("ie")&&this.own(G(p.document,"paste",H.hitch(this,function(z){setTimeout(H.hitch(this,function(){var b=this.editor.document.selection.createRange();b.move("character",-1);b.select();b.move("character",1);b.select()}),0)})));return y}));else if(this.blockNodeForEnter){var t=H.hitch(this,"handleEnterKey");p.addKeyHandler(13,0,0,t);p.addKeyHandler(13,0,1,t);this.own(this.editor.on("KeyPressed",H.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var p=this.editor.selection.getAncestorElement("LI");if(p){c("mozilla")&&"LI"==p.parentNode.parentNode.nodeName&&(p=p.parentNode.parentNode);var t=p.firstChild;!t||1!=t.nodeType||"UL"!=t.nodeName&&"OL"!=t.nodeName||(p.insertBefore(t.ownerDocument.createTextNode("\u00a0"),t),t=n.create(this.editor.window),t.setStart(p.firstChild,0),p=n.getSelection(this.editor.window,!0),p.removeAllRanges(),p.addRange(t))}else l.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(p=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(p.innerHTML=this.bogusHtmlContent,9>=c("ie")&&(p=this.editor.document.selection.createRange(),p.move("character",-1),p.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(p){var t,y=this.editor.document,z;if(p.shiftKey){p=this.editor.selection.getParentElement();if(t=n.getAncestor(p,this.blockNodes)){if("LI"==t.tagName)return!0;p=n.getSelection(this.editor.window);var b=p.getRangeAt(0);b.collapsed||(b.deleteContents(),p=n.getSelection(this.editor.window),b=p.getRangeAt(0));if(n.atBeginningOfContainer(t,b.startContainer,b.startOffset)){var g=y.createElement("br");b=n.create(this.editor.window);t.insertBefore(g,
t.firstChild);b.setStartAfter(g);p.removeAllRanges();p.addRange(b)}else if(n.atEndOfContainer(t,b.startContainer,b.startOffset))b=n.create(this.editor.window),g=y.createElement("br"),t.appendChild(g),t.appendChild(y.createTextNode("\u00a0")),b.setStart(t.lastChild,0),p.removeAllRanges(),p.addRange(b);else{if((z=b.startContainer)&&3==z.nodeType){var A=z.nodeValue;var O=y.createTextNode(A.substring(0,b.startOffset));var q=y.createTextNode(A.substring(b.startOffset));t=y.createElement("br");""==q.nodeValue&&
c("webkit")&&(q=y.createTextNode("\u00a0"));E.place(O,z,"after");E.place(t,O,"after");E.place(q,t,"after");E.destroy(z);b=n.create(this.editor.window);b.setStart(q,0);p.removeAllRanges();p.addRange(b);return!1}return!0}}else p=n.getSelection(this.editor.window),p.rangeCount?(b=p.getRangeAt(0))&&b.startContainer&&(b.collapsed||(b.deleteContents(),p=n.getSelection(this.editor.window),b=p.getRangeAt(0)),(z=b.startContainer)&&3==z.nodeType?(t=b.startOffset,z.length<t&&(q=this._adjustNodeAndOffset(z,t),
z=q.node,t=q.offset),A=z.nodeValue,O=y.createTextNode(A.substring(0,t)),q=y.createTextNode(A.substring(t)),t=y.createElement("br"),q.length||(q=y.createTextNode("\u00a0")),O.length?E.place(O,z,"after"):O=z,E.place(t,O,"after"),E.place(q,t,"after"),E.destroy(z)):(0<=b.startOffset&&(g=z.childNodes[b.startOffset]),t=y.createElement("br"),q=y.createTextNode("\u00a0"),g?(E.place(t,g,"before"),E.place(q,t,"after")):(z.appendChild(t),z.appendChild(q))),b=n.create(this.editor.window),b.setStart(q,0),b.setEnd(q,
q.length),p.removeAllRanges(),p.addRange(b),this.editor.selection.collapse(!0)):l.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var r=!0;p=n.getSelection(this.editor.window);b=p.getRangeAt(0);b.collapsed||(b.deleteContents(),p=n.getSelection(this.editor.window),b=p.getRangeAt(0));g=n.getBlockAncestor(b.endContainer,null,this.editor.editNode);var B=g.blockNode;if(this._checkListLater=B&&("LI"==B.nodeName||"LI"==B.parentNode.nodeName))return c("mozilla")&&(this._pressedEnterInBlock=
B),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(B.innerHTML)&&(B.innerHTML="",c("webkit")&&(b=n.create(this.editor.window),b.setStart(B,0),p.removeAllRanges(),p.addRange(b)),this._checkListLater=!1),!0;if(!g.blockNode||g.blockNode===this.editor.editNode){try{l.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(F){}g={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(g.blockNode){if(g.blockNode!=this.editor.editNode&&!(g.blockNode.textContent||g.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(g.blockNode),!1}else g.blockNode=this.editor.editNode;p=n.getSelection(this.editor.window);b=p.getRangeAt(0)}B=y.createElement(this.blockNodeForEnter);B.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(g.blockNode);q=b.endOffset;r=b.endContainer;r.length<q&&(q=this._adjustNodeAndOffset(r,q),r=
q.node,q=q.offset);if(n.atEndOfContainer(g.blockNode,r,q))g.blockNode===g.blockContainer?g.blockNode.appendChild(B):E.place(B,g.blockNode,"after"),r=!1,b=n.create(this.editor.window),b.setStart(B,0),p.removeAllRanges(),p.addRange(b),this.editor.height&&f.scrollIntoView(B);else if(n.atBeginningOfContainer(g.blockNode,b.startContainer,b.startOffset))E.place(B,g.blockNode,g.blockNode===g.blockContainer?"first":"before"),B.nextSibling&&this.editor.height&&(b=n.create(this.editor.window),b.setStart(B.nextSibling,
0),p.removeAllRanges(),p.addRange(b),f.scrollIntoView(B.nextSibling)),r=!1;else{g.blockNode===g.blockContainer?g.blockNode.appendChild(B):E.place(B,g.blockNode,"after");r=!1;g.blockNode.style&&B.style&&g.blockNode.style.cssText&&(B.style.cssText=g.blockNode.style.cssText);if((z=b.startContainer)&&3==z.nodeType){q=b.endOffset;z.length<q&&(q=this._adjustNodeAndOffset(z,q),z=q.node,q=q.offset);A=z.nodeValue;O=y.createTextNode(A.substring(0,q));q=y.createTextNode(A.substring(q,A.length));E.place(O,z,
"before");E.place(q,z,"after");E.destroy(z);for(b=O.parentNode;b!==g.blockNode;){A=y.createElement(b.tagName);b.style&&A.style&&b.style.cssText&&(A.style.cssText=b.style.cssText);"FONT"===b.tagName&&(b.color&&(A.color=b.color),b.face&&(A.face=b.face),b.size&&(A.size=b.size));for(;q;)z=q.nextSibling,A.appendChild(q),q=z;E.place(A,b,"after");O=b;q=A;b=b.parentNode}if(1==q.nodeType||3==q.nodeType&&q.nodeValue)B.innerHTML="";for(O=q;q;)z=q.nextSibling,B.appendChild(q),q=z}b=n.create(this.editor.window);
y=O;if("BR"!==this.blockNodeForEnter){for(;y;)t=y,y=z=y.firstChild;t&&t.parentNode?(B=t.parentNode,b.setStart(B,0),p.removeAllRanges(),p.addRange(b),this.editor.height&&f.scrollIntoView(B),c("mozilla")&&(this._pressedEnterInBlock=g.blockNode)):r=!0}else b.setStart(B,0),p.removeAllRanges(),p.addRange(b),this.editor.height&&f.scrollIntoView(B),c("mozilla")&&(this._pressedEnterInBlock=g.blockNode)}return r},_adjustNodeAndOffset:function(p,t){for(;p.length<t&&p.nextSibling&&3==p.nextSibling.nodeType;)t-=
p.length,p=p.nextSibling;return{node:p,offset:t}},removeTrailingBr:function(p){if(p=/P|DIV|LI/i.test(p.tagName)?p:this.editor.selection.getParentOfType(p,["P","DIV","LI"]))p.lastChild&&(1<p.childNodes.length&&3==p.lastChild.nodeType&&/^[\s\xAD]*$/.test(p.lastChild.nodeValue)||"BR"==p.lastChild.tagName)&&E.destroy(p.lastChild),p.childNodes.length||(p.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t,y,z,b,g,A,O,q,r,B,F,Q,P,C,m,k,D){var I=K("dijit._editor.RichText",[F,Q],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&t.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new H},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[t.trim,t.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);g("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));g("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(g("ie")||g("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[t.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[t.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);O.publish(D._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=t.hitch(this,function(x,w){return function(){return!this.execCommand(x,w)}}),e={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};g("ie")||(e.Z=a("redo"));for(var v in e)this.addKeyHandler(v,!0,!1,e[v])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(I._editorCommandsLocalized)this._local2NativeFormatNames=I._local2NativeFormatNames,this._native2LocalFormatNames=I._native2LocalFormatNames;else{I._editorCommandsLocalized=!0;I._local2NativeFormatNames={};
I._native2LocalFormatNames={};this._local2NativeFormatNames=I._local2NativeFormatNames;this._native2LocalFormatNames=I._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),e="",v,x=0;v=a[x++];)e="l"!==v.charAt(1)?e+("\x3c"+v+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+v+"\x3e\x3cbr/\x3e"):e+("\x3c"+v+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+v+"\x3e\x3cbr/\x3e");var w=f.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:e});this.ownerDocumentBody.appendChild(w);
a=t.hitch(this,function(){for(var N=w.firstChild;N;)try{this.selection.selectElement(N.firstChild);var J=N.tagName.toLowerCase();this._local2NativeFormatNames[J]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[J]]=J;N=N.nextSibling.nextSibling}catch(L){}f.destroy(w)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new H;this.isClosed||this.close();O.publish(D._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var e=this.domNode;if(t.isString(this.value)){var v=this.value;e.innerHTML=""}else if(e.nodeName&&"textarea"==e.nodeName.toLowerCase()){var x=this.textarea=e;this.name=x.name;v=x.value;e=this.domNode=this.ownerDocument.createElement("div");e.setAttribute("widgetId",this.id);x.removeAttribute("widgetId");e.cssText=x.cssText;e.className+=" "+x.className;f.place(e,x,"before");var w=t.hitch(this,function(){l.set(x,{display:"block",position:"absolute",
top:"-1000px"});if(g("ie")){var M=x.style;this.__overflow=M.overflow;M.overflow="hidden"}});g("ie")?this.defer(w,10):w();if(x.form){var N=x.value;this.reset=function(){this.getValue()!==N&&this.replaceValue(N)};y(x.form,"submit",t.hitch(this,function(){c.set(x,"disabled",this.disabled);x.value=this.getValue()}))}}else v=m.getChildrenHtml(e),e.innerHTML="";this.value=v;e.nodeName&&"LI"===e.nodeName&&(e.innerHTML=" \x3cbr\x3e");this.header=e.ownerDocument.createElement("div");e.appendChild(this.header);
this.editingArea=e.ownerDocument.createElement("div");e.appendChild(this.editingArea);this.footer=e.ownerDocument.createElement("div");e.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!E.useXDomain||E.allowXdRichTextSave)){if((v=G.byId(D._scopeName+"._editor.RichText.value"))&&""!==v.value){w=v.value.split(this._SEPARATOR);for(var J=0,L;L=w[J++];)if(L=L.split(this._NAME_CONTENT_SEP),L[0]===this.name){this.value=L[1];w=w.splice(J,1);v.value=w.join(this._SEPARATOR);
break}}I._globalSaveHandler||(I._globalSaveHandler={},q.addOnUnload(function(){for(var M in I._globalSaveHandler){var S=I._globalSaveHandler[M];t.isFunction(S)&&S()}}));I._globalSaveHandler[this.id]=t.hitch(this,"_saveContent")}this.isClosed=!1;v=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");v.id=this.id+"_iframe";v.style.border="none";v.style.width="100%";this._layoutMode?v.style.height="100%":7<=g("ie")?(this.height&&(v.style.height=this.height),this.minHeight&&(v.style.minHeight=
this.minHeight)):v.style.height=this.height?this.height:this.minHeight;v.frameBorder=0;v._loadFunc=t.hitch(this,function(M){this.window=M;this.document=M.document;this.selection=new P.SelectionManager(M);g("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});w=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");w=11>g("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+w+"');document.close()":"javascript: '"+
w+"'";this.editingArea.appendChild(v);v.src=w;"LI"===e.nodeName&&(e.lastChild.style.marginTop="-1.2em");d.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=l.getComputedStyle(this.domNode);if(this["aria-label"])var e=this["aria-label"];else{var v=z('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||G.byId(this["aria-labelledby"],this.ownerDocument);v&&(e=v.textContent||v.innerHTML||"")}v="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(e?" aria-label\x3d'"+A.escape(e)+"'":"")+"\x3e\x3c/div\x3e";var x=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),w=a.lineHeight;w=0<=w.indexOf("px")?parseFloat(w)/parseFloat(a.fontSize):0<=w.indexOf("em")?parseFloat(w):"normal";var N="",J=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(L){L=L.replace(/^;/ig,"")+";";var M=L.split(":")[0];if(M){M=t.trim(M);M=M.toLowerCase();var S,R="";for(S=0;S<M.length;S++){var T=M.charAt(S);switch(T){case "-":S++,T=M.charAt(S).toUpperCase();default:R+=
T}}l.set(J.domNode,R,"")}N+=L+";"});this.iframe.setAttribute("title",e);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||n.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",e?"\x3ctitle\x3e"+A.escape(e)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",x,";\n",this.height||g("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",w,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",g("ie")||g("trident")||g("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",e?" aria-label\x3d'"+A.escape(e)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+N+"'\x3e",v,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var e="",v=0,x,w=B.get(this.ownerDocument);x=a[v++];)x=(new r(w.location,x)).toString(),this.editingAreaStyleSheets.push(x),e+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+x+'"/\x3e';return e},addStyleSheet:function(a){var e=a.toString(),v=B.get(this.ownerDocument);if("."===e.charAt(0)||"/"!==e.charAt(0)&&!a.host)e=(new r(v.location,e)).toString();-1<u.indexOf(this.editingAreaStyleSheets,e)||(this.editingAreaStyleSheets.push(e),
this.onLoadDeferred.then(t.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(e);else{var x=this.document.getElementsByTagName("head")[0],w=this.document.createElement("link");w.rel="stylesheet";w.type="text/css";w.href=e;x.appendChild(w)}})))},removeStyleSheet:function(a){var e=a.toString(),v=B.get(this.ownerDocument);if("."===e.charAt(0)||"/"!==e.charAt(0)&&!a.host)e=(new r(v.location,e)).toString();a=u.indexOf(this.editingAreaStyleSheets,e);-1!==a&&(delete this.editingAreaStyleSheets[a],
z('link[href\x3d"'+e+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var e=g("ie")&&(this.isLoaded||!this.focusOnLoad);e&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;e&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(g("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var v in a)if(a.hasOwnProperty(v))try{this.document.execCommand(v,
!1,a[v])}catch(x){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=k.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var e=this;this.beforeIframeNode=f.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=f.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){e.editNode.focus()};this.focusNode=
this.editNode;var v=this.events.concat(this.captureEvents),x=this.iframe?this.document:this.editNode;this.own.apply(this,u.map(v,function(w){var N=w.toLowerCase().replace(/^on/,"");return y(x,N,t.hitch(this,w))},this));this.own(y(x,"mouseup",t.hitch(this,"onClick")));g("ie")&&(this.own(y(this.document,"mousedown",t.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);g("webkit")&&(this._webkitListener=this.own(y(this.document,"mouseup",t.hitch(this,"onDisplayChanged")))[0],this.own(y(this.document,
"mousedown",t.hitch(this,function(w){w=w.target;!w||w!==this.document.body&&w!==this.document||this.defer("placeCursorAtEnd")}))));if(g("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(w){}this.isLoaded=!0;this.set("disabled",this.disabled);v=t.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&b(t.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(v):v()},onKeyDown:function(a){if(a.keyCode===p.SHIFT||a.keyCode===p.ALT||a.keyCode===p.META||a.keyCode===p.CTRL)return!0;a.keyCode===p.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")&&this.execCommand(a.shiftKey?"outdent":"indent"));if(a.keyCode==p.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>g("ie")&&a.keyCode===p.BACKSPACE&&"Control"===this.document.selection.type&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));g("ff")&&(a.keyCode===p.PAGE_UP||a.keyCode===p.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var e=this._keyHandlers[a.keyCode],v=arguments;e&&!a.altKey&&u.some(e,function(x){if(!(x.shift^a.shiftKey||x.ctrl^(a.ctrlKey||a.metaKey)))return x.handler.apply(this,v)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){n.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?c.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(t.hitch(this,function(){c.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,e,v,x){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));t.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:v||!1,ctrl:e||!1,handler:x})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(g("ie")||g("trident"))&&this.defer(function(){k.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var e=this.getValue(!0);if(e!==this.value)this.onChange(e);
this._set("value",e)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!g("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>g("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,e){a=a.toLowerCase();"formatblock"===a?g("safari")&&void 0===e&&(a="heading"):"hilitecolor"!==a||g("mozilla")||(a="backcolor");return a},_implCommand:function(a){return"_"+this._normalizeCommand(a)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(a){var e=this._qcaCache[a];return void 0!==e?e:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return g("ie")||g("trident")||g("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!g("webkit");default:return!1}},execCommand:function(a,e){this.focused&&this.focus();a=this._normalizeCommand(a,e);if(void 0!==e){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(g("ie")||g("trident"))&&(e="\x3c"+e+"\x3e")}var v="_"+a+"Impl";if(this[v])var x=this[v](e);else if((e=1<arguments.length?e:null)||"createlink"!==a)x=this.document.execCommand(a,!1,e);this.onDisplayChanged();return x},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var e=this._implCommand(a);return this[e]?this[e](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(e){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(g("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(g("mozilla")&&"hilitecolor"===a){try{var e=this.document.queryCommandValue("styleWithCSS")}catch(v){e=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,e)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,e){return this.selection[a].apply(this.selection,e)},placeCursorAtStart:function(){this.focus();var a=!1;if(g("mozilla"))for(var e=this.editNode.firstChild;e;){if(3===e.nodeType){if(0<e.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(e);break}}else if(1===e.nodeType){a=!0;var v=e.tagName?e.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(v)?this.selection.selectElement(e):
this.selection.selectElementChildren(e);break}e=e.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(g("mozilla"))for(var e=this.editNode.lastChild;e;){if(3===e.nodeType){if(0<e.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(e);break}}else if(1===e.nodeType){a=!0;this.selection.selectElement(e.lastChild||e);break}e=e.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var e=this.isClosed?this.domNode:this.editNode;e.innerHTML=a;this._preDomFilterContent(e)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(t.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!g("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var e=
a;u.forEach(this.contentPreFilters,function(v){v&&(e=v(e))});return e},_preDomFilterContent:function(a){a=a||this.editNode;u.forEach(this.contentDomPreFilters,function(e){e&&t.isFunction(e)&&e(a)},this)},_postFilterContent:function(a,e){if(t.isString(a))var v=a;else a=a||this.editNode,this.contentDomPostFilters.length&&(e&&(a=t.clone(a)),u.forEach(this.contentDomPostFilters,function(x){a=x(a)})),v=m.getChildrenHtml(a);t.trim(v.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(v="");u.forEach(this.contentPostFilters,
function(x){v=x(v)});return v},_saveContent:function(){var a=G.byId(D._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,e){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");e||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){n.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return m.getNodeHtml(a)},getNodeChildrenHtml:function(a){n.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return m.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);g("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var e=this.textarea.style;e.position="";e.left=e.top="";g("ie")&&(e.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;f.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;d.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);I._globalSaveHandler&&delete I._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset="utf-8" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ >])/gi,"\x3c$1b$2").replace(/<(\/)?em([ >])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
var e=9>g("ie")?this.document.selection.createRange():this.document;try{return e.queryCommandEnabled(a)}catch(v){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=g("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=g("mozilla")||g("webkit")?this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=
!0;return a=g("mozilla")||g("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;g("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;g("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");return a},_pasteEnabledImpl:function(){var a=!0;return g("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},
_inserthorizontalruleImpl:function(a){return g("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(g("mozilla")||g("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",!1,a)},_hilitecolorImpl:function(a){if(!this._handleTextColorOrProperties("hilitecolor",a))if(g("mozilla")){this.document.execCommand("styleWithCSS",
!1,!0);console.log("Executing color command.");var e=this.document.execCommand("hilitecolor",!1,a);this.document.execCommand("styleWithCSS",!1,!1)}else e=this.document.execCommand("hilitecolor",!1,a);return e},_backcolorImpl:function(a){g("ie")&&(a=a?a:null);var e=this._handleTextColorOrProperties("backcolor",a);e||(e=this.document.execCommand("backcolor",!1,a));return e},_forecolorImpl:function(a){g("ie")&&(a=a?a:null);var e=!1;(e=this._handleTextColorOrProperties("forecolor",a))||(e=this.document.execCommand("forecolor",
!1,a));return e},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var e=!0;if(9>g("ie")){var v=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var x=v.item(0);v.length;)v.remove(v.item(0));x.outerHTML=a}else v.pasteHTML(a);v.select()}else if(8>g("trident")){var w=C.getSelection(this.window);if(w&&w.rangeCount&&w.getRangeAt){v=w.getRangeAt(0);v.deleteContents();var N=f.create("div");N.innerHTML=a;for(x=this.document.createDocumentFragment();a=
N.firstChild;)var J=x.appendChild(a);v.insertNode(x);J&&(v=v.cloneRange(),v.setStartAfter(J),v.collapse(!1),w.removeAllRanges(),w.addRange(v))}}else g("mozilla")&&!a.length?this.selection.remove():e=this.document.execCommand("inserthtml",!1,a);return e},_boldImpl:function(a){var e=!1;if(g("ie")||g("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("bold");e||(e=this.document.execCommand("bold",!1,a));return e},_italicImpl:function(a){var e=!1;if(g("ie")||g("trident"))this._adaptIESelection(),
e=this._adaptIEFormatAreaAndExec("italic");e||(e=this.document.execCommand("italic",!1,a));return e},_underlineImpl:function(a){var e=!1;if(g("ie")||g("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("underline");e||(e=this.document.execCommand("underline",!1,a));return e},_strikethroughImpl:function(a){var e=!1;if(g("ie")||g("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("strikethrough");e||(e=this.document.execCommand("strikethrough",!1,a));return e},_superscriptImpl:function(a){var e=
!1;if(g("ie")||g("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("superscript");e||(e=this.document.execCommand("superscript",!1,a));return e},_subscriptImpl:function(a){var e=!1;if(g("ie")||g("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("subscript");e||(e=this.document.execCommand("subscript",!1,a));return e},_fontnameImpl:function(a){if(g("ie")||g("trident"))var e=this._handleTextColorOrProperties("fontname",a);e||(e=this.document.execCommand("fontname",
!1,a));return e},_fontsizeImpl:function(a){if(g("ie")||g("trident"))var e=this._handleTextColorOrProperties("fontsize",a);e||(e=this.document.execCommand("fontsize",!1,a));return e},_insertorderedlistImpl:function(a){var e=!1;if(g("ie")||g("trident")||g("edge"))e=this._adaptIEList("insertorderedlist",a);e||(e=this.document.execCommand("insertorderedlist",!1,a));return e},_insertunorderedlistImpl:function(a){var e=!1;if(g("ie")||g("trident")||g("edge"))e=this._adaptIEList("insertunorderedlist",a);
e||(e=this.document.execCommand("insertunorderedlist",!1,a));return e},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var e=0;if(a&&a.childNodes){var v;for(v=0;v<a.childNodes.length;v++){var x=h.position(a.childNodes[v]);e+=x.h}}return e},_isNodeEmpty:function(a,e){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],e):!0:3===a.nodeType?
""===a.nodeValue.substring(e):!1},_removeStartingRangeFromRange:function(a,e){if(a.nextSibling)e.setStart(a.nextSibling,0);else{for(a=a.parentNode;a&&null==a.nextSibling;)a=a.parentNode;a&&e.setStart(a.nextSibling,0)}return e},_adaptIESelection:function(){var a=C.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var e=a.getRangeAt(0),v=e.startContainer,x=e.startOffset;3===v.nodeType&&x>=v.length&&v.nextSibling;)x-=v.length,v=v.nextSibling;for(var w=null;this._isNodeEmpty(v,x)&&v!==
w;)w=v,e=this._removeStartingRangeFromRange(v,e),v=e.startContainer,x=0;a.removeAllRanges();a.addRange(e)}},_adaptIEFormatAreaAndExec:function(a){var e=C.getSelection(this.window),v=this.document,x;if(a&&e&&e.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);var w=e.getRangeAt(0);var N=w.startContainer;if(3===N.nodeType){var J=w.endOffset;N.length<J&&(J=this._adjustNodeAndOffset(L,J),N=J.node,J=J.offset)}for(;N&&N!==this.editNode;){var L=N.tagName?N.tagName.toLowerCase():"";
if(-1<u.indexOf(a,L)){var M=N;break}N=N.parentNode}if(M&&(L=w.startContainer,a=v.createElement(M.tagName),f.place(a,M,"after"),L&&3===L.nodeType)){J=w.endOffset;L.length<J&&(J=this._adjustNodeAndOffset(L,J),L=J.node,J=J.offset);N=L.nodeValue;w=v.createTextNode(N.substring(0,J));var S=N.substring(J,N.length);S&&(x=v.createTextNode(S));f.place(w,L,"before");if(x){var R=v.createElement("span");R.className="ieFormatBreakerSpan";f.place(R,L,"after");f.place(x,R,"after");x=R}f.destroy(L);J=w.parentNode;
for(L=[];J!==M;){N=J.tagName;w={tagName:N};L.push(w);N=v.createElement(N);J.style&&N.style&&J.style.cssText&&(N.style.cssText=J.style.cssText,w.cssText=J.style.cssText);"FONT"===J.tagName&&(J.color&&(N.color=J.color,w.color=J.color),J.face&&(N.face=J.face,w.face=J.face),J.size&&(N.size=J.size,w.size=J.size));J.className&&(N.className=J.className,w.className=J.className);if(x)for(;x;)w=x.nextSibling,N.appendChild(x),x=w;N.tagName==J.tagName?(R=v.createElement("span"),R.className="ieFormatBreakerSpan",
f.place(R,J,"after"),f.place(N,R,"after")):f.place(N,J,"after");w=J;x=N;J=J.parentNode}if(x){if(1===x.nodeType||3===x.nodeType&&x.nodeValue)a.innerHTML="";for(;x;)w=x.nextSibling,a.appendChild(x),x=w}if(L.length){w=L.pop();x=v.createElement(w.tagName);w.cssText&&x.style&&(x.style.cssText=w.cssText);w.className&&(x.className=w.className);"FONT"===w.tagName&&(w.color&&(x.color=w.color),w.face&&(x.face=w.face),w.size&&(x.size=w.size));for(f.place(x,a,"before");L.length;)w=L.pop(),M=v.createElement(w.tagName),
w.cssText&&M.style&&(M.style.cssText=w.cssText),w.className&&(M.className=w.className),"FONT"===w.tagName&&(w.color&&(M.color=w.color),w.face&&(M.face=w.face),w.size&&(M.size=w.size)),x.appendChild(M),x=M;M=v.createTextNode(".");R.appendChild(M);x.appendChild(M)}else R=v.createElement("span"),R.className="ieFormatBreakerSpan",M=v.createTextNode("."),R.appendChild(M),f.place(R,a,"before");x=C.create(this.window);x.setStart(M,0);x.setEnd(M,M.length);e.removeAllRanges();e.addRange(x);this.selection.collapse(!1);
M.parentNode.innerHTML="";a.firstChild||f.destroy(a);return!0}return!1}w=e.getRangeAt(0);if((L=w.startContainer)&&3===L.nodeType)return J=w.startOffset,L.length<J&&(J=this._adjustNodeAndOffset(L,J),L=J.node,J=J.offset),N=L.nodeValue,w=v.createTextNode(N.substring(0,J)),S=N.substring(J),""!==S&&(x=v.createTextNode(N.substring(J))),R=v.createElement("span"),M=v.createTextNode("."),R.appendChild(M),w.length?f.place(w,L,"after"):w=L,f.place(R,w,"after"),x&&f.place(x,R,"after"),f.destroy(L),x=C.create(this.window),
x.setStart(M,0),x.setEnd(M,M.length),e.removeAllRanges(),e.addRange(x),v.execCommand(a),f.place(R.firstChild,R,"before"),f.destroy(R),x.setStart(M,0),x.setEnd(M,M.length),e.removeAllRanges(),e.addRange(x),this.selection.collapse(!1),M.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var e=C.getSelection(this.window);if(e.isCollapsed&&e.rangeCount&&!this.queryCommandValue(a)){var v=e.getRangeAt(0),x=v.startContainer;if(x&&3==x.nodeType&&!v.startOffset)return v="ul","insertorderedlist"===
a&&(v="ol"),a=this.document.createElement(v),v=f.create("li",null,a),f.place(a,x,"before"),v.appendChild(x),f.create("br",null,a,"after"),a=C.create(this.window),a.setStart(x,0),a.setEnd(x,x.length),e.removeAllRanges(),e.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,e){var v=C.getSelection(this.window),x=this.document,w,N;e=e||null;if(a&&v&&v.isCollapsed&&v.rangeCount){var J=v.getRangeAt(0);if((w=J.startContainer)&&3===w.nodeType){var L=J.startOffset;
w.length<L&&(J=this._adjustNodeAndOffset(w,L),w=J.node,L=J.offset);var M=w.nodeValue;J=x.createTextNode(M.substring(0,L));""!==M.substring(L)&&(N=x.createTextNode(M.substring(L)));M=x.createElement("span");L=x.createTextNode(".");M.appendChild(L);x=x.createElement("span");M.appendChild(x);J.length?f.place(J,w,"after"):J=w;f.place(M,J,"after");N&&f.place(N,M,"after");f.destroy(w);w=C.create(this.window);w.setStart(L,0);w.setEnd(L,L.length);v.removeAllRanges();v.addRange(w);if(g("webkit")){v="color";
if("hilitecolor"===a||"backcolor"===a)v="backgroundColor";l.set(M,v,e);this.selection.remove();f.destroy(x);M.innerHTML="\x26#160;";this.selection.selectElement(M);this.focus()}else this.execCommand(a,e),f.place(M.firstChild,M,"before"),f.destroy(M),w.setStart(L,0),w.setEnd(L,L.length),v.removeAllRanges(),v.addRange(w),this.selection.collapse(!1),L.parentNode.removeChild(L);return!0}}return!1},_adjustNodeAndOffset:function(a,e){for(;a.length<e&&a.nextSibling&&3===a.nextSibling.nodeType;)e-=a.length,
a=a.nextSibling;return{node:a,offset:e}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return z(".ieFormatBreakerSpan",a).forEach(function(e){for(;e.firstChild;)f.place(e.firstChild,e,"before");f.destroy(e)}),a},_stripTrailingEmptyNodes:function(a){function e(v){return/^(p|div|br)$/i.test(v.nodeName)&&
0==v.children.length&&/^[\s\xA0]*$/.test(v.textContent||v.innerText||"")||3===v.nodeType&&/^[\s\xA0]*$/.test(v.nodeValue)}for(;a.lastChild&&e(a.lastChild);)f.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(t.hitch(this,function(){this.editNode.dir=a}))}});return I})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(u,E,K){var H={getIndex:function(d,f){for(var h=[],l=[],n=d,p,t;d!=
f;){var y=0;for(p=d.parentNode;t=p.childNodes[y++];)if(t===d){--y;break}h.unshift(y);l.unshift(y-p.childNodes.length);d=p}if(0<h.length&&3==n.nodeType){for(t=n.previousSibling;t&&3==t.nodeType;)h[h.length-1]--,t=t.previousSibling;for(t=n.nextSibling;t&&3==t.nodeType;)l[l.length-1]++,t=t.nextSibling}return{o:h,r:l}},getNode:function(d,f){if(!K.isArray(d)||0==d.length)return f;var h=f;u.every(d,function(l){if(0<=l&&l<h.childNodes.length)h=h.childNodes[l];else return h=null,!1;return!0});return h},getCommonAncestor:function(d,
f,h){h=h||d.ownerDocument.body;var l=function(t){for(var y=[];t;)if(y.unshift(t),t!==h)t=t.parentNode;else break;return y};d=l(d);f=l(f);l=Math.min(d.length,f.length);for(var n=d[0],p=1;p<l;p++)if(d[p]===f[p])n=d[p];else break;return n},getAncestor:function(d,f,h){for(h=h||d.ownerDocument.body;d&&d!==h;){var l=d.nodeName.toUpperCase();if(f.test(l))return d;d=d.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(d,f,h){h=h||d.ownerDocument.body;
f=f||H.BlockTagNames;for(var l=null,n;d&&d!==h;){var p=d.nodeName.toUpperCase();!l&&f.test(p)&&(l=d);!n&&/^(?:BODY|TD|TH|CAPTION)$/.test(p)&&(n=d);d=d.parentNode}return{blockNode:l,blockContainer:n||d.ownerDocument.body}},atBeginningOfContainer:function(d,f,h){var l=!1,n=0==h;n||3!=f.nodeType||/^[\s\xA0]+$/.test(f.nodeValue.substr(0,h))&&(n=!0);if(n)for(l=!0;f&&f!==d;){if(f.previousSibling){l=!1;break}f=f.parentNode}return l},atEndOfContainer:function(d,f,h){var l=!1,n=h==(f.length||f.childNodes.length);
n||3!=f.nodeType||/^[\s\xA0]+$/.test(f.nodeValue.substr(h))&&(n=!0);if(n)for(l=!0;f&&f!==d;){if(f.nextSibling){l=!1;break}f=f.parentNode}return l},adjacentNoneTextNode:function(d,f){var h=d;d=0-d.length||0;for(f=f?"nextSibling":"previousSibling";h&&3==h.nodeType;)d+=h.length,h=h[f];return[h,d]},create:function(d){d=d||window;return d.getSelection?d.document.createRange():new c},getSelection:function(d,f){if(d.getSelection)return d.getSelection();d=new G.selection(d);f||d._getCurrentSelection();return d}};
if(!window.getSelection)var G=H.ie={cachedSelection:{},selection:function(d){this._ranges=[];this.addRange=function(f,h){this._ranges.push(f);h||f._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(f){return this._ranges[f]};this._getCurrentSelection=function(){this.removeAllRanges();var f=d.document.selection.createRange();f="CONTROL"==d.document.selection.type.toUpperCase()?new c(G.decomposeControlRange(f)):
new c(G.decomposeTextRange(f));this.addRange(f,!0),this.isCollapsed=f.collapsed}},decomposeControlRange:function(d){var f=d.item(0),h=d.item(d.length-1);d=f.parentNode;var l=h.parentNode;f=H.getIndex(f,d).o[0];h=H.getIndex(h,l).o[0]+1;return[d,f,l,h]},getEndPoint:function(d,f){var h=d.duplicate();h.collapse(!f);var l="EndTo"+(f?"End":"Start"),n=h.parentElement(),p;if(0<n.childNodes.length)u.every(n.childNodes,function(z,b){if(3!=z.nodeType)if(h.moveToElementText(z),0<h.compareEndPoints(l,d))if(p&&
3==p.nodeType){t=p;var g=!0}else return t=n,y=b,!1;else{if(b==n.childNodes.length-1)return t=n,y=n.childNodes.length,!1}else b==n.childNodes.length-1&&(t=z,g=!0);if(g&&t)return t=(z=H.adjacentNoneTextNode(t)[0])?z.nextSibling:n.firstChild,b=H.adjacentNoneTextNode(t),z=b[0],b=b[1],z?(h.moveToElementText(z),h.collapse(!1)):h.moveToElementText(n),h.setEndPoint(l,d),y=h.text.length-b,!1;p=z;return!0});else{var t=n;var y=0}f||1!=t.nodeType||y!=t.childNodes.length||(f=t.nextSibling)&&3==f.nodeType&&(t=
f,y=0);return[t,y]},setEndPoint:function(d,f,h){d=d.duplicate();var l;if(3!=f.nodeType)if(0<h){if(l=f.childNodes[h-1])if(3==l.nodeType)f=l,h=l.length;else if(l.nextSibling&&3==l.nextSibling.nodeType)f=l.nextSibling,h=0;else{d.moveToElementText(l.nextSibling?l:f);var n=l.parentNode;l=n.insertBefore(l.ownerDocument.createTextNode(" "),l.nextSibling);d.collapse(!1);n.removeChild(l)}}else d.moveToElementText(f),d.collapse(!0);3==f.nodeType&&(l=H.adjacentNoneTextNode(f),n=l[0],l=l[1],n?(d.moveToElementText(n),
d.collapse(!1),"inherit"!=n.contentEditable&&l++):(d.moveToElementText(f.parentNode),d.collapse(!0),d.move("character",1),d.move("character",-1)),h+=l,0<h&&d.move("character",h)!=h&&console.error("Error when moving!"));return d},decomposeTextRange:function(d){var f=G.getEndPoint(d),h=f[0],l=f[1],n=f[0];f=f[1];d.htmlText.length&&(d.htmlText==d.text?f=l+d.text.length:(f=G.getEndPoint(d,!0),n=f[0],f=f[1]));return[h,l,n,f]},setRange:function(d,f,h,l,n,p){f=G.setEndPoint(d,f,h);d.setEndPoint("StartToStart",
f);if(!p)var t=G.setEndPoint(d,l,n);d.setEndPoint("EndToEnd",t||f);return d}},c=H.W3CRange=E(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?H.getCommonAncestor(this.startContainer,
this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(d,f){f=parseInt(f);if(this.startContainer!==d||this.startOffset!=f)delete this._cachedBookmark,this.startContainer=d,this.startOffset=f,this.endContainer?this._updateInternal():this.setEnd(d,f)},setEnd:function(d,f){f=parseInt(f);if(this.endContainer!==d||this.endOffset!=f)delete this._cachedBookmark,this.endContainer=d,this.endOffset=f,this.startContainer?
this._updateInternal():this.setStart(d,f)},setStartAfter:function(d,f){this._setPoint("setStart",d,f,1)},setStartBefore:function(d,f){this._setPoint("setStart",d,f,0)},setEndAfter:function(d,f){this._setPoint("setEnd",d,f,1)},setEndBefore:function(d,f){this._setPoint("setEnd",d,f,0)},_setPoint:function(d,f,h,l){h=H.getIndex(f,f.parentNode).o;this[d](f.parentNode,h.pop()+l)},_getIERange:function(){var d=(this._body||this.endContainer.ownerDocument.body).createTextRange();G.setRange(d,this.startContainer,
this.startOffset,this.endContainer,this.endOffset,this.collapsed);return d},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var d=this.startContainer,f=this._getIERange();3!==d.nodeType||this.startOffset||this.setStartBefore(d);f.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var d=new c([this.startContainer,this.startOffset,
this.endContainer,this.endOffset]);d._body=this._body;return d},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});K.setObject("dijit.range",H);return H})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(u,E,K){var H={};E.setObject("dijit._editor.html",H);var G=H.escapeXml=function(c,d){c=c.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,
"\x26gt;").replace(/"/gm,"\x26quot;");d||(c=c.replace(/'/gm,"\x26#39;"));return c};H.getNodeHtml=function(c){var d=[];H.getNodeHtmlHelper(c,d);return d.join("")};H.getNodeHtmlHelper=function(c,d){switch(c.nodeType){case 1:var f=c.nodeName.toLowerCase();if(!f||"/"==f.charAt(0))return"";d.push("\x3c",f);var h=[],l={},n;if(K("dom-attributes-explicit")||K("dom-attributes-specified-flag"))for(var p=0;n=c.attributes[p++];){var t=n.name;"_dj"===t.substr(0,3)||K("dom-attributes-specified-flag")&&!n.specified||
t in l||(n=n.value,("src"==t||"href"==t)&&c.getAttribute("_djrealurl")&&(n=c.getAttribute("_djrealurl")),8===K("ie")&&"style"===t&&(n=n.replace("HEIGHT:","height:").replace("WIDTH:","width:")),h.push([t,n]),l[t]=n)}else{var y=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML;l=y.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi);y=y.substr(0,y.indexOf("\x3e"));u.forEach(l,function(z){if(z){var b=z.indexOf("\x3d");if(0<b&&(z=z.substring(0,b),"_dj"!=z.substr(0,3)))if("src"!=z&&"href"!=z||!c.getAttribute("_djrealurl")){switch(z){case "style":var g=
c.style.cssText.toLowerCase();break;case "class":g=c.className;break;case "width":if("img"===f){(b=/width=(\S+)/i.exec(y))&&(g=b[1]);break}case "height":if("img"===f){(b=/height=(\S+)/i.exec(y))&&(g=b[1]);break}default:g=c.getAttribute(z)}null!=g&&h.push([z,g.toString()])}else h.push([z,c.getAttribute("_djrealurl")])}},this)}h.sort(function(z,b){return z[0]<b[0]?-1:z[0]==b[0]?0:1});for(l=0;n=h[l++];)d.push(" ",n[0],'\x3d"',"string"===typeof n[1]?G(n[1],!0):n[1],'"');switch(f){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":d.push(" /\x3e");
break;case "script":d.push("\x3e",c.innerHTML,"\x3c/",f,"\x3e");break;default:d.push("\x3e"),c.hasChildNodes()&&H.getChildrenHtmlHelper(c,d),d.push("\x3c/",f,"\x3e")}break;case 4:case 3:d.push(G(c.nodeValue,!0));break;case 8:d.push("\x3c!--",G(c.nodeValue,!0),"--\x3e");break;default:d.push("\x3c!-- Element not recognized - Type: ",c.nodeType," Name: ",c.nodeName,"--\x3e")}};H.getChildrenHtml=function(c){var d=[];H.getChildrenHtmlHelper(c,d);return d.join("")};H.getChildrenHtmlHelper=function(c,d){if(c)for(var f=
c.childNodes||c,h=!K("ie")||f!==c,l,n=0;l=f[n++];)h&&l.parentNode!=c||H.getNodeHtmlHelper(l,d)};return H})},"widgets/GroupFilter/LayersHandler":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all esri/request".split(" "),function(u,E,K,H,G,c,d){return E([u],{declaredClass:"LayersHandler",layers:null,layerStore:[],fieldName:null,childList:null,validFieldTypes:"esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeDouble esriFieldTypeSingle esriFieldTypeString esriFieldTypeDate esriFieldTypeGeometry esriFieldTypeOID esriFieldTypeBlob esriFieldTypeGlobalID esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeXML".split(" "),
layersOnly:!1,constructor:function(f){E.safeMixin(this,f)},getAllMapLayers:function(){var f=[],h=new G,l;this.layerStore=[];H.forEach(this.layers,K.hitch(this,function(n){if(!n.featureCollection)if(n.getLayerType(),"undefined"===typeof n.originOperLayer||!n.originOperLayer.layerType||"ArcGISFeatureLayer"!==n.originOperLayer.layerType&&"ArcGISImageServiceLayer"!==n.originOperLayer.layerType)if(0<n.newSubLayers.length){if(this.childList=[],"undefined"===typeof n.originOperLayer.layerType||"ArcGISTiledMapServiceLayer"!==
n.originOperLayer.layerType&&"VectorTileLayer"!==n.originOperLayer.layerType&&"WMS"!==n.originOperLayer.layerType)H.forEach(n.layerObject.layerInfos,K.hitch(this,function(p){p={label:p.name,id:n.id+"."+p.id,url:n.originOperLayer.url+"/"+p.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:n.layerObject};this.childList.push(p);f.push(this._getLayerInfo(p))})),l={label:n.title,id:n.id,url:n.originOperLayer.url,type:"Service",checked:!1,children:this.childList,layer:n.layerObject},
this.layerStore.push(l)}else("undefined"===typeof n.originOperLayer.layerType||"ArcGISTiledMapServiceLayer"!==n.originOperLayer.layerType&&"VectorTileLayer"!==n.originOperLayer.layerType&&"WMS"!==n.originOperLayer.layerType)&&"ArcGISMapServiceLayer"===n.originOperLayer.layerType&&(this.childList=[],H.forEach(n.layerObject.layerInfos,K.hitch(this,function(p){p={label:p.name,id:n.id+"."+p.id,url:n.originOperLayer.url+"/"+p.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:n.layerObject};
this.childList.push(p);f.push(this._getLayerInfo(p))})),l={label:n.title,id:n.id,url:n.originOperLayer.url,type:"MapService",checked:!1,children:this.childList,layer:n.layerObject},this.layerStore.push(l));else"undefined"===typeof n.originOperLayer.featureCollection&&(l={label:n.title,id:n.id,url:n.url,fieldName:this.fieldName,type:"Feature Layer",checked:!1,children:[],layer:n.layerObject},f.push(this._getLayerInfo(l)),this.layerStore.push(l))}));c(f).then(K.hitch(this,function(){var n=this._controlComplete();
this.emit("complete",n);h.resolve(n)}),K.hitch(this,function(){h.resolve(null)}));return h.promise},_getLayerInfo:function(f){var h=new G;f.url?0===f.url.length?h.resolve():d({url:f.url,content:{f:"json"},callbackParamName:"callback"}).then(K.hitch(this,function(l){if(l.hasOwnProperty("fields")&&!1===this.layersOnly){var n=H.map(l.fields,K.hitch(this,function(p){return{label:p.alias,id:f.id+"."+p.name,name:p.name,type:"Field",fieldType:p.type,checked:!1}}));n=H.filter(n,K.hitch(this,function(p){return 0<=
H.indexOf(this.validFieldTypes,p.fieldType)}));f.children=n}f.geometryType=l.geometryType;f.visible=!0;this.geometryTypes&&!H.some(this.geometryTypes,function(p){if(p===f.geometryType)return!0})&&(f.visible=!1);h.resolve(l)}),function(){h.resolve(null)}):h.resolve();return h.promise},_controlComplete:function(){H.forEach(this.layerStore,function(f){if(f.children&&0<f.children.length){var h=H.filter(f.children,function(l){return l.hasOwnProperty("visible")?l.visible:!0});f.children=h;0===f.children.length&&
(f.visible=!1)}});return this.store={data:{identifier:"id",label:"label",items:H.filter(this.layerStore,function(f){return f.hasOwnProperty("visible")?f.visible:!0})}}}})})},"widgets/GroupFilter/setting/presetValuePicker":function(){define("dojo/_base/declare jimu/BaseWidgetSetting jimu/dijit/FilterParameters dijit/_WidgetsInTemplateMixin dojo/on dojo/dom-construct dojo/dom-attr dojo/query dojo/_base/lang dojo/_base/array dijit/form/Select esri/layers/FeatureLayer dojo/text!./presetValuePicker.html".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t){return u([E,H],{baseClass:"jimu-widget-map-filter-preset",templateString:t,layerList:null,map:null,nls:null,valueParam:null,postCreate:function(){this.inherited(arguments);this.startup()},startup:function(){this.inherited(arguments);this.createLayerSelection()},createLayerSelection:function(){var y=[];l.forEach(this.layerList,h.hitch(this,function(b){if(0<b.children.length)l.forEach(b.children,h.hitch(this,function(A){var O={};O.value=A.id;O.label=A.label;O.selected=
!1;y.push(O)}));else{var g={};g.value=b.id;g.label=b.label;g.selected=!1;y.push(g)}}));var z=(new n({options:y})).placeAt(this.layerLevel);z.startup();this.own(G(z,"change",h.hitch(this,function(b){this.createFieldSelection(b)})));this.createFieldSelection(z.value)},createFieldSelection:function(y){var z=[];l.forEach(this.layerList,h.hitch(this,function(g){0<g.children.length?l.forEach(g.children,h.hitch(this,function(A){A.id===y&&l.forEach(A.children,h.hitch(this,function(O){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(O.fieldType)){var q=
{};q.value=O.name;q.label=O.label;q.selected=!1;z.push(q)}}))})):g.id===y&&l.forEach(g.layer.fields,h.hitch(this,function(A){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(A.type)){var O={};O.value=A.name;O.label=""===A.alias?A.name:A.alias;O.selected=!1;z.push(O)}}))}));c.empty(this.fieldLevel);var b=(new n({options:z})).placeAt(this.fieldLevel);b.startup();this.own(G(b,"change",h.hitch(this,function(g){this.createValueList(g,y)})));this.createValueList(b.value,y)},createValueList:function(y,
z){c.empty(this.valueLevel);this.valueParam=new K;this.valueParam.placeAt(this.valueLevel);this.valueParam.startup();setTimeout(function(){var b=f(".jimu-single-filter-parameter");b=f("colgroup",b[0]);0<b.length&&d.set(b[0].childNodes[1],"width","0px")},200);l.forEach(this.layerList,h.hitch(this,function(b){0<b.children.length?l.forEach(b.children,h.hitch(this,function(g){g.id===z&&l.forEach(g.children,h.hitch(this,function(A){if("Shape"!==A.name&&A.name===y){var O=new p(g.url);this.own(G(O,"load",
h.hitch(this,function(){var q=this._makefilterObject({name:A.name,label:A.label,type:A.fieldType});this.valueParam.build(g.url,O,q);q=f(".jimu-single-filter-parameter");q=f("colgroup",q[0]);d.set(q[0].childNodes[1],"width","0px")})))}}))})):b.id===z&&l.forEach(b.layer.fields,h.hitch(this,function(g){g.name===y&&(g=this._makefilterObject({name:g.name,label:g.alias,type:g.type}),this.valueParam.build(b.layer.url,b.layer,g),g=f(".jimu-single-filter-parameter"),g=f("colgroup",g[0]),0<g.length&&d.set(g[0].childNodes[1],
"width","0px"))}))}))},_makefilterObject:function(y){var z={},b=[],g={fieldObj:{}};g.fieldObj.name=y.name;g.fieldObj.label="undefined"===typeof y.alias?y.name:y.alias;g.fieldObj.shortType=y.type.replace("esriFieldType","").toLowerCase();if("guid"!==g.fieldObj.shortType||"globalid"!==g.fieldObj.shortType)g.fieldObj.shortType="string";"date"!==g.fieldObj.shortType&&"string"!==g.fieldObj.shortType&&(g.fieldObj.shortType="number");g.fieldObj.type=y.type;g.operator=g.fieldObj.shortType+"OperatorIs";g.valueObj=
{};g.valueObj.isValid=!0;g.valueObj.type="unique";g.valueObj.value="";g.interactiveObj={};g.interactiveObj.prompt="";g.interactiveObj.hint="";g.caseSensitive=!1;b.push(g);z.logicalOperator="OR";z.expr="";z.parts=b;return z}})})},"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),function(u,E,K,H,G,c){var d=null,f=u([K,G],{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",
sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new c({whiteList:this.whiteList,safeAttrValue:H.hitch(this,function(h,l,n,p){return"style"===l?this.xss.friendlyAttrValue(n).replace(/"/g,"'"):"img"===h&&"src"===l?this.xss.escapeAttrValue(n):this.xss.safeAttrValue(h,l,n,p)}),onTag:H.hitch(this,function(h,l,n){if(n.isWhite&&this._isInWhiteList(h,this.graphicsWhiteList))return l}),onIgnoreTagAttr:H.hitch(this,function(h,
l,n,p){if("data-"===l.substr(0,5))return l+'\x3d"'+this.xss.escapeAttrValue(n)+'"'}),onIgnoreTag:H.hitch(this,function(h,l,n){if("o:"===h.substr(0,2)||"!--[if"===h||"!--[endif]--"===h)return l})},!0);this.xss=this.sanitizer.xss},sanitize:function(h){return this.sanitizer.sanitize(h)},_getWhiteList:function(){var h="title height width class style font-family id align text-align".split(" "),l={div:h,h1:h,h2:h,h3:h,h4:h,h5:h,h6:h,span:h,p:h,s:h,strong:h,em:h,u:h,ol:h,ul:h,li:h,a:["href","target"].concat(h),
img:["src","alt","border"].concat(h),blockquote:h,font:["face","size","color"].concat(h),pre:h,code:h,b:h,i:h,wbr:h,video:"autoplay controls loop muted poster preload".split(" ").concat(h),audio:["autoplay","controls","loop","muted","preload"].concat(h),source:["media","src","type"].concat(h),table:["cellpadding","cellspacing","border"].concat(h),tbody:[].concat(h),tr:["valign"].concat(h),td:["valign","colspan","rowspan","nowrap"].concat(h),th:["valign","colspan","rowspan","nowrap"].concat(h),hr:h,
html:h,title:h,link:["rel","href"],style:["type"].concat(h),body:h};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],feFuncA:[],feFuncB:[],feFuncG:[],feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],
feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],textPath:[],title:[],tspan:[],use:[],view:[],object:[],canvas:h};return this._extendObjectOfArrays([l,{a:["target",
"href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src",
"alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},
_extendObjectOfArrays:function(h){var l={};E.forEach(h,function(n){var p=Object.keys(n);E.forEach(p,function(t){Array.isArray(n[t])&&Array.isArray(l[t])?l[t]=l[t].concat(n[t]):l[t]=n[t]},this)},this);return l},_isInWhiteList:function(h,l){l=Object.keys(l);var n=!1;E.forEach(l,function(p){h===p&&(n=!0)},this);return n}});f.getInstance=function(){null===d&&(d=new f);return d};return f})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t){var y=K("dijit._editor.plugins.LinkDialog",n,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:p,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=c.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(b){u("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),c.hitch(this,function(g,A,O){var q=this;this.tag="insertImage"==this.command?"img":"a";g=c.delegate(g.getLocalization("dijit","common",this.lang),g.getLocalization("dijit._editor",
"LinkDialog",this.lang));var r=this.dropDown=this.button.dropDown=new A({title:g[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:c.hitch(this,"setValue"),onOpen:function(){q._onOpenDialog();A.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(c.hitch(q,"_onCloseDialog"),0)}});g.urlRegExp=this.urlRegExp;g.id=O.getUniqueId(this.editor.id);this._uniqueId=g.id;this._setContent(r.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
l.substitute(this.linkDialogTemplate,g));r.startup();this._urlInput=O.byId(this._uniqueId+"_urlInput");this._textInput=O.byId(this._uniqueId+"_textInput");this._setButton=O.byId(this._uniqueId+"_setButton");this.own(O.byId(this._uniqueId+"_cancelButton").on("click",c.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",c.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",c.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=c.hitch(this,function(){var B=this._urlInput.get("value");return this._urlRegExp.test(B)||this._emailRegExp.test(B)});this.own(d(r.domNode,"keydown",c.hitch(this,c.hitch(this,function(B){!B||B.keyCode!=G.ENTER||B.shiftKey||B.metaKey||B.ctrlKey||B.altKey||this._setButton.get("disabled")||(r.onExecute(),r.execute(r.get("value")))}))));b()}))},_checkAndFixInput:function(){var b=this,g=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var A=g,O=!1,q=!1;A&&1<A.length&&(A=c.trim(A),0!==A.indexOf("mailto:")&&(0<A.indexOf("/")?-1===A.indexOf("://")&&"/"!==A.charAt(0)&&A.indexOf("./")&&0!==A.indexOf("../")&&b._hostRxp.test(A)&&(O=!0):b._userAtRxp.test(A)&&(q=!0)));O&&b._urlInput.set("value","http://"+A);q&&b._urlInput.set("value","mailto:"+A);b._setButton.set("disabled",!b._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(c.hitch(this,
function(){this.own(d(this.editor.editNode,"mouseup",c.hitch(this,"_onMouseUp")));this.own(d(this.editor.editNode,"dblclick",c.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(b){this.dropDown.set({parserScope:"dojo",content:b})},_checkValues:function(b){b&&b.urlInput&&(b.urlInput=b.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&b&&b.textInput&&("function"===typeof this.linkFilter?b.textInput=this.linkFilter(b.textInput):
E.forEach(this.linkFilter,function(g){b.textInput=b.textInput.replace(g[0],g[1])}));return b},_createlinkEnabledImpl:function(){return!0},setValue:function(b){this._onCloseDialog();if(9>f("ie")){var g=t.getSelection(this.editor.window).getRangeAt(0).endContainer;3===g.nodeType&&(g=g.parentNode);g&&g.nodeName&&g.nodeName.toLowerCase()!==this.tag&&(g=this.editor.selection.getSelectedElement(this.tag));g&&g.nodeName&&g.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(g),
this.editor.execCommand("unlink"))}b=this._checkValues(b);this.editor.execCommand("inserthtml",l.substitute(this.htmlTemplate,b));h("a",this.editor.document).forEach(function(A){A.innerHTML||H.has(A,"name")||A.parentNode.removeChild(A)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(b){if(b&&b.tagName.toLowerCase()===this.tag){var g=b.getAttribute("_djrealurl")||b.getAttribute("href");var A=b.getAttribute("target")||"_self";var O=b.textContent||
b.innerText;this.editor.selection.selectElement(b,!0)}else O=this.editor.selection.getSelectedText();return{urlInput:g||"",textInput:O||"",targetSelect:A||""}},_onOpenDialog:function(){if(f("ie")){var b=t.getSelection(this.editor.window);if(b.rangeCount){var g=b.getRangeAt(0);var A=g.endContainer;3===A.nodeType&&(A=A.parentNode);A&&A.nodeName&&A.nodeName.toLowerCase()!==this.tag&&(A=this.editor.selection.getSelectedElement(this.tag));if(!A||A.nodeName&&A.nodeName.toLowerCase()!==this.tag)(b=this.editor.selection.getAncestorElement(this.tag))&&
b.nodeName&&b.nodeName.toLowerCase()==this.tag?(A=b,this.editor.selection.selectElement(A)):g.startContainer===g.endContainer&&(b=g.startContainer.firstChild)&&b.nodeName&&b.nodeName.toLowerCase()==this.tag&&(A=b,this.editor.selection.selectElement(A))}}else A=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(A))},_onDblClick:function(b){if(b&&b.target&&(b=b.target,(b.tagName?b.tagName.toLowerCase():
"")===this.tag&&H.get(b,"href"))){var g=this.editor;this.editor.selection.selectElement(b);g.onDisplayChanged();g._updateTimer&&(g._updateTimer.remove(),delete g._updateTimer);g.onNormalizedDisplayChanged();var A=this.button;setTimeout(function(){A.set("disabled",!1);A.loadAndOpenDropDown().then(function(){A.dropDown.focus&&A.dropDown.focus()})},10)}},_onMouseUp:function(){if(f("ff")){var b=this.editor.selection.getAncestorElement(this.tag);if(b){var g=t.getSelection(this.editor.window).getRangeAt(0);
if(g.collapsed&&b.childNodes.length){var A=g.cloneRange();A.selectNodeContents(b.childNodes[b.childNodes.length-1]);A.setStart(b.childNodes[0],0);1!==g.compareBoundaryPoints(A.START_TO_START,A)?g.setStartBefore(b):-1!==g.compareBoundaryPoints(A.END_TO_START,A)&&g.setStartAfter(b)}}}}}),z=K("dijit._editor.plugins.ImgLinkDialog",[y],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(b){if(b&&b.tagName.toLowerCase()===this.tag){var g=b.getAttribute("_djrealurl")||b.getAttribute("src");var A=b.getAttribute("alt");this.editor.selection.selectElement(b,!0)}else A=this.editor.selection.getSelectedText();return{urlInput:g||"",textInput:A||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(c.hitch(this,function(){this.own(d(this.editor.editNode,"mousedown",c.hitch(this,"_selectTag")))}))},_selectTag:function(b){b&&b.target&&(b=b.target,(b.tagName?b.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(b))},_checkValues:function(b){b&&b.urlInput&&(b.urlInput=b.urlInput.replace(/"/g,"\x26quot;"));b&&b.textInput&&(b.textInput=b.textInput.replace(/"/g,"\x26quot;"));return b},_onDblClick:function(b){if(b&&b.target&&(b=b.target,(b.tagName?
b.tagName.toLowerCase():"")===this.tag&&H.get(b,"src"))){var g=this.editor;this.editor.selection.selectElement(b);g.onDisplayChanged();g._updateTimer&&(g._updateTimer.remove(),delete g._updateTimer);g.onNormalizedDisplayChanged();var A=this.button;setTimeout(function(){A.set("disabled",!1);A.loadAndOpenDropDown().then(function(){A.dropDown.focus&&A.dropDown.focus()})},10)}}});n.registry.createLink=function(b){var g={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in b?b.allowUnsafeHtml:!1};
"linkFilter"in b&&(g.linkFilter=b.linkFilter);return new y(g)};n.registry.insertImage=function(){return new z({command:"insertImage"})};y.ImgLinkDialog=z;return y})},"dijit/_editor/plugins/ViewSource":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t,y,z,b,g,A){var O=K("dijit._editor.plugins.ViewSource",z,{stripScripts:!0,stripComments:!0,stripIFrames:!0,stripEventHandlers:!0,readOnly:!1,_fsPlugin:null,toggle:function(){p("webkit")&&(this._vsFocused=!0);this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var q=f.getLocalization("dijit._editor","commands"),r=this.editor;this.button=new b({label:q.viewSource,ownerDocument:r.ownerDocument,dir:r.dir,lang:r.lang,showLabel:!1,iconClass:this.iconClassPrefix+
" "+this.iconClassPrefix+"ViewSource",tabIndex:"-1",onChange:l.hitch(this,"_showSource")});this.button.set("readOnly",!1)},setEditor:function(q){this.editor=q;this._initButton();this.removeValueFilterHandles();this._setValueFilterHandle=E.before(this.editor,"setValue",l.hitch(this,function(r){return[this._filter(r)]}));this._getValueFilterHandle=E.after(this.editor,"getValue",l.hitch(this,function(r){return this._filter(r)}));this.editor.addKeyHandler(h.F12,!0,!0,l.hitch(this,function(r){this.button.focus();
this.toggle();r.stopPropagation();r.preventDefault();setTimeout(l.hitch(this,function(){this.editor.focused&&this.editor.focus()}),100)}))},_showSource:function(q){var r=this.editor,B=r._plugins;this._sourceShown=q;var F=this;try{this.sourceArea||this._createSourceView();if(q)r._sourceQueryCommandEnabled=r.queryCommandEnabled,r.queryCommandEnabled=function(P){return"viewsource"===P.toLowerCase()},this.editor.onDisplayChanged(),u.forEach(B,function(P){!P||P instanceof O||!P.isInstanceOf(z)||P.set("disabled",
!0)}),this._fsPlugin&&(this._fsPlugin._getAltViewNode=function(){return F.sourceArea}),this.sourceArea.value=r.get("value"),this.sourceArea.style.height=r.iframe.style.height,this.sourceArea.style.width=r.iframe.style.width,r.iframe.parentNode.style.position="relative",d.set(r.iframe,{position:"absolute",top:0,visibility:"hidden"}),d.set(this.sourceArea,{display:"block"}),this._resizeHandle=n(window,"resize",l.hitch(this,function(){var P=t.getBox(r.ownerDocument);"_prevW"in this&&"_prevH"in this&&
P.w===this._prevW&&P.h===this._prevH||(this._prevW=P.w,this._prevH=P.h,this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(l.hitch(this,function(){delete this._resizer;this._resize()}),10))})),setTimeout(l.hitch(this,this._resize),100),this.editor.onNormalizedDisplayChanged(),this.editor.__oldGetValue=this.editor.getValue,this.editor.getValue=l.hitch(this,function(){var P=this.sourceArea.value;return P=this._filter(P)}),this._setListener=E.after(this.editor,
"setValue",l.hitch(this,function(P){this.sourceArea.value=P||""}),!0);else{if(!r._sourceQueryCommandEnabled)return;this._setListener.remove();delete this._setListener;this._resizeHandle.remove();delete this._resizeHandle;this.editor.__oldGetValue&&(this.editor.getValue=this.editor.__oldGetValue,delete this.editor.__oldGetValue);r.queryCommandEnabled=r._sourceQueryCommandEnabled;if(!this._readOnly){var Q=this.sourceArea.value;r.beginEditing();r.set("value",Q);r.endEditing()}u.forEach(B,function(P){P&&
P.isInstanceOf(z)&&P.set("disabled",!1)});d.set(this.sourceArea,"display","none");d.set(r.iframe,{position:"relative",visibility:"visible"});delete r._sourceQueryCommandEnabled;this.editor.onDisplayChanged()}setTimeout(l.hitch(this,function(){var P=r.domNode.parentNode;P&&(P=A.getEnclosingWidget(P))&&P.resize&&P.resize();r.resize()}),300)}catch(P){console.log(P)}},updateState:function(){this.button.set("disabled",this.get("disabled"))},_resize:function(){var q=this.editor,r=q.getHeaderHeight(),B=
q.getFooterHeight(),F=c.position(q.domNode),Q=c.getPadBorderExtents(q.iframe.parentNode),P=c.getMarginExtents(q.iframe.parentNode),C=c.getPadBorderExtents(q.domNode),m=F.w-C.w;F=F.h-(r+C.h+B);this._fsPlugin&&this._fsPlugin.isFullscreen&&(q=t.getBox(q.ownerDocument),m=q.w-C.w,F=q.h-(r+C.h+B));c.setMarginBox(this.sourceArea,{w:Math.round(m-(Q.w+P.w)),h:Math.round(F-(Q.h+P.h))})},_createSourceView:function(){var q=this.editor,r=q._plugins;this.sourceArea=G.create("textarea");this.readOnly&&(H.set(this.sourceArea,
"readOnly",!0),this._readOnly=!0);d.set(this.sourceArea,{padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});H.set(this.sourceArea,"aria-label",this.editor.id);G.place(this.sourceArea,q.iframe,"before");p("ie")&&q.iframe.parentNode.lastChild!==q.iframe&&d.set(q.iframe.parentNode.lastChild,{width:"0px",height:"0px",padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});q._viewsource_oldFocus=q.focus;var B=this;q.focus=function(){if(B._sourceShown)B.setSourceAreaCaret();else try{this._vsFocused?
(delete this._vsFocused,y.focus(q.editNode)):q._viewsource_oldFocus()}catch(P){console.log("ViewSource focus code error: "+P)}};var F,Q;for(F=0;F<r.length;F++)if((Q=r[F])&&("dijit._editor.plugins.FullScreen"===Q.declaredClass||Q.declaredClass===g._scopeName+"._editor.plugins.FullScreen")){this._fsPlugin=Q;break}this._fsPlugin&&(this._fsPlugin._viewsource_getAltViewNode=this._fsPlugin._getAltViewNode,this._fsPlugin._getAltViewNode=function(){return B._sourceShown?B.sourceArea:this._viewsource_getAltViewNode()});
this.own(n(this.sourceArea,"keydown",l.hitch(this,function(P){this._sourceShown&&P.keyCode==h.F12&&P.ctrlKey&&P.shiftKey&&(this.button.focus(),this.button.set("checked",!1),setTimeout(l.hitch(this,function(){q.focus()}),100),P.stopPropagation(),P.preventDefault())})))},_stripScripts:function(q){q&&(q=q.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig,""),q=q.replace(/<\s*script\b([^<>]|\s)*>?/ig,""),q=q.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig,""));return q},_stripComments:function(q){q&&
(q=q.replace(/\x3c!--(.|\s){1,}?--\x3e/g,""));return q},_stripIFrames:function(q){q&&(q=q.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig,""));return q},_stripEventHandlers:function(q){if(q){var r=q.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);if(r)for(var B=0,F=r.length;B<F;B++){var Q=r[B],P=Q.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm,"");q=q.replace(Q,P)}}return q},_filter:function(q){q&&(this.stripScripts&&(q=this._stripScripts(q)),this.stripComments&&(q=this._stripComments(q)),
this.stripIFrames&&(q=this._stripIFrames(q)),this.stripEventHandlers&&(q=this._stripEventHandlers(q)));return q},removeValueFilterHandles:function(){this._setValueFilterHandle&&(this._setValueFilterHandle.remove(),delete this._setValueFilterHandle);this._getValueFilterHandle&&(this._getValueFilterHandle.remove(),delete this._getValueFilterHandle)},setSourceAreaCaret:function(){var q=this.sourceArea;y.focus(q);this._sourceShown&&!this.readOnly&&(q.setSelectionRange?q.setSelectionRange(0,0):this.sourceArea.createTextRange&&
(q=q.createTextRange(),q.collapse(!0),q.moveStart("character",-99999),q.moveStart("character",0),q.moveEnd("character",0),q.select()))},destroy:function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer);this._resizeHandle&&(this._resizeHandle.remove(),delete this._resizeHandle);this._setListener&&(this._setListener.remove(),delete this._setListener);this.removeValueFilterHandles();this.inherited(arguments)}});z.registry.viewSource=z.registry.viewsource=function(q){return new O({readOnly:"readOnly"in
q?q.readOnly:!1,stripComments:"stripComments"in q?q.stripComments:!0,stripScripts:"stripScripts"in q?q.stripScripts:!0,stripIFrames:"stripIFrames"in q?q.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in q?q.stripEventHandlers:!0})};return O})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t,y,z){u=K("dijit._editor.plugins._FontDropDown",[l,n,p],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:u,postMixInProperties:function(){this.inherited(arguments);this.strings=G.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=h.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new f({idProperty:"value",data:E.map(this.values,function(q){var r=this.strings[q]||q;return{label:this.getLabel(q,r),name:r,value:q}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(q,r){r=!1!==r;this.select.set("value",0>E.indexOf(this.values,q)?"":q,r);r||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(q){this._set("disabled",q);this.select.set("disabled",q)}});var b=K("dijit._editor.plugins._FontNameDropDown",u,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(q,r){return this.plainText?r:"\x3cdiv style\x3d'font-family: "+q+"'\x3e"+r+"\x3c/div\x3e"},_normalizeFontName:function(q){var r=this.values;if(!q||!r)return q;var B=q.split(",");if(1<B.length)for(var F=0,Q=B.length;F<Q;F++){var P=d.trim(B[F]);if(-1<E.indexOf(r,P))return P}return q},_setValueAttr:function(q,r){r=!1!==
r;q=this._normalizeFontName(q);this.generic&&(q={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[q]||q);this.inherited(arguments,[q,r])}}),g=K("dijit._editor.plugins._FontSizeDropDown",u,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(q,
r){return this.plainText?r:"\x3cfont size\x3d"+q+"'\x3e"+r+"\x3c/font\x3e"},_setValueAttr:function(q,r){r=!1!==r;q.indexOf&&-1!=q.indexOf("px")&&(q={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(q,10)]||q);this.inherited(arguments,[q,r])}}),A=K("dijit._editor.plugins._FormatBlockDropDown",u,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(q,r){return this.plainText||
"noFormat"==q?r:"\x3c"+q+"\x3e"+r+"\x3c/"+q+"\x3e"},_execCommand:function(q,r,B){if("noFormat"===B){var F;if((r=z.getSelection(q.window))&&0<r.rangeCount&&(B=r.getRangeAt(0),B)){r=B.startContainer;for(F=B.endContainer;r&&r!==q.editNode&&r!==q.document.body&&1!==r.nodeType;)r=r.parentNode;for(;F&&F!==q.editNode&&F!==q.document.body&&1!==F.nodeType;)F=F.parentNode;var Q=c.hitch(this,function(k,D){if(k.childNodes&&k.childNodes.length){var I;for(I=0;I<k.childNodes.length;I++){var a=k.childNodes[I];if(1==
a.nodeType&&q.selection.inSelection(a)){var e=a.tagName?a.tagName.toLowerCase():"";-1!==E.indexOf(this.values,e)&&D.push(a);Q(a,D)}}}});B=c.hitch(this,function(k){if(k&&k.length){for(q.beginEditing();k.length;)this._removeFormat(q,k.pop());q.endEditing()}});var P=[];if(r==F){for(F=r;F&&F!==q.editNode&&F!==q.document.body;){if(1==F.nodeType){var C=F.tagName?F.tagName.toLowerCase():"";if(-1!==E.indexOf(this.values,C)){var m=F;break}}F=F.parentNode}Q(r,P);m&&(P=[m].concat(P))}else for(F=r;q.selection.inSelection(F);)1==
F.nodeType&&(C=F.tagName?F.tagName.toLowerCase():"",-1!==E.indexOf(this.values,C)&&P.push(F),Q(F,P)),F=F.nextSibling;B(P);q.onDisplayChanged()}}else q.execCommand(r,B)},_removeFormat:function(q,r){if(q.customUndo){for(;r.firstChild;)H.place(r.firstChild,r,"before");r.parentNode.removeChild(r)}else{q.selection.selectElementChildren(r);var B=q.selection.getSelectedHtml();q.selection.selectElement(r);q.execCommand("inserthtml",B||"")}}}),O=K("dijit._editor.plugins.FontChoice",y,{useDefaultCommand:!1,
_initButton:function(){var q={fontName:b,fontSize:g,formatBlock:A}[this.command],r=this.params;this.params.custom&&(r.values=this.params.custom);var B=this.editor;this.button=new q(c.delegate({dir:B.dir,lang:B.lang},r));this.own(this.button.select.on("change",c.hitch(this,function(F){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=F.indexOf(" ")&&(F="'"+F+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,F):this.editor.execCommand(this.command,
F)})))},updateState:function(){var q=this.editor,r=this.command;if(q&&q.isLoaded&&r.length&&this.button){var B=this.get("disabled");this.button.set("disabled",B);if(!B){try{var F=q.queryCommandValue(r)||""}catch(P){F=""}(B=c.isString(F)&&(F.match(/'([^']*)'/)||F.match(/"([^"]*)"/)))&&(F=B[1]);"fontSize"!==r||F||(F=3);if("formatBlock"===r)if(F&&"p"!=F)0>E.indexOf(this.button.values,F)&&(F="noFormat");else{F=null;if((r=z.getSelection(this.editor.window))&&0<r.rangeCount&&(r=r.getRangeAt(0)))var Q=r.endContainer;
for(;Q&&Q!==q.editNode&&Q!==q.document;){if((r=Q.tagName?Q.tagName.toLowerCase():"")&&-1<E.indexOf(this.button.values,r)){F=r;break}Q=Q.parentNode}F||(F="noFormat")}F!==this.button.get("value")&&this.button.set("value",F,!1)}}}});E.forEach(["fontName","fontSize","formatBlock"],function(q){y.registry[q]=function(r){return new O({command:q,plainText:r.plainText})}});O._FontDropDown=u;O._FontNameDropDown=b;O._FontSizeDropDown=g;O._FormatBlockDropDown=A;return O})},"dojox/editor/plugins/Preview":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/Button dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Preview".split(" "),
function(u,E,K,H){var G=u.declare("dojox.editor.plugins.Preview",H,{useDefaultCommand:!1,styles:"",stylesheets:null,iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=u.i18n.getLocalization("dojox.editor.plugins","Preview");this.button=new E.form.Button({label:this._nlsResources.preview,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Preview",tabIndex:"-1",onClick:u.hitch(this,"_preview")})},setEditor:function(c){this.editor=c;this._initButton()},
updateState:function(){this.button.set("disabled",this.get("disabled"))},_preview:function(){try{var c=this.editor.get("value"),d="\t\t\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dUTF-8'\x3e\n",f;if(this.stylesheets)for(f=0;f<this.stylesheets.length;f++)d+="\t\t\x3clink rel\x3d'stylesheet' type\x3d'text/css' href\x3d'"+this.stylesheets[f]+"'\x3e\n";this.styles&&(d+="\t\t\x3cstyle\x3e"+this.styles+"\x3c/style\x3e\n");c="\x3chtml\x3e\n\t\x3chead\x3e\n"+d+"\t\x3c/head\x3e\n\t\x3cbody\x3e\n"+
c+"\n\t\x3c/body\x3e\n\x3c/html\x3e";var h=window.open("javascript: ''",this._nlsResources.preview,"status\x3d1,menubar\x3d0,location\x3d0,toolbar\x3d0");h.document.open();h.document.write(c);h.document.close()}catch(l){console.warn(l)}}});u.subscribe(E._scopeName+".Editor.getPlugin",null,function(c){c.plugin||"preview"!==c.args.name.toLowerCase()||(c.plugin=new G({styles:"styles"in c.args?c.args.styles:"",stylesheets:"stylesheets"in c.args?c.args.stylesheets:null}))});return G})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),
function(u,E,K,H,G,c){var d=K("dijit._editor.plugins.TextColor",G,{buttonClass:c,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var f=this;this.button.loadDropDown=function(h){function l(n){f.button.dropDown=new n({dir:f.editor.dir,ownerDocument:f.editor.ownerDocument,value:f.value,onChange:function(p){f.editor.execCommand(f.command,p)},onExecute:function(){f.editor.execCommand(f.command,this.get("value"))}});h()}"string"==
typeof f.colorPicker?u([f.colorPicker],l):l(f.colorPicker)}},updateState:function(){var f=this.editor,h=this.command;if(f&&f.isLoaded&&h.length){if(this.button){var l=this.get("disabled");this.button.set("disabled",l);if(l)return;try{var n=f.queryCommandValue(h)||""}catch(p){n=""}}""==n&&(n="#000000");"transparent"==n&&(n="#ffffff");"string"==typeof n?-1<n.indexOf("rgb")&&(n=E.fromRgb(n).toHex()):(n=((n&255)<<16|n&65280|(n&16711680)>>>16).toString(16),n="#000000".slice(0,7-n.length)+n);this.value=
n;(f=this.button.dropDown)&&f.get&&n!==f.get("value")&&f.set("value",n,!1)}}});G.registry.foreColor=function(f){return new d(f)};G.registry.hiliteColor=function(f){return new d(f)};return d})},"dojox/editor/plugins/ToolbarLineBreak":function(){define("dojo dijit dojox dijit/_Widget dijit/_TemplatedMixin dijit/_editor/_Plugin dojo/_base/declare".split(" "),function(u,E,K,H,G,c,d){var f=d("dojox.editor.plugins.ToolbarLineBreak",[H,G],{templateString:"\x3cspan class\x3d'dijit dijitReset'\x3e\x3cbr\x3e\x3c/span\x3e",
postCreate:function(){u.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}});u.subscribe(E._scopeName+".Editor.getPlugin",null,function(h){if(!h.plugin){var l=h.args.name.toLowerCase();if("||"===l||"toolbarlinebreak"===l)h.plugin=new c({button:new f,setEditor:function(n){this.editor=n}})}});return f})},"dojox/editor/plugins/FindReplace":function(){define("dojo dijit dojox dijit/_base/manager dijit/_base/popup dijit/_Widget dijit/_TemplatedMixin dijit/_KeyNavContainer dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/Toolbar dijit/form/CheckBox dijit/form/_TextBoxMixin dijit/form/TextBox dijit/_editor/_Plugin dijit/form/Button dijit/form/DropDownButton dijit/form/ToggleButton ./ToolbarLineBreak dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/FindReplace".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t,y,z){u.experimental("dojox.editor.plugins.FindReplace");var b=u.declare("dojox.editor.plugins._FindReplaceCloseBox",[c,d,h],{btnId:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'float: right' class\x3d'dijitInline' tabindex\x3d'-1'\x3e\x3cbutton class\x3d'dijit dijitReset dijitInline' id\x3d'${btnId}' dojoAttachPoint\x3d'button' dojoType\x3d'dijit.form.Button' tabindex\x3d'-1' iconClass\x3d'dijitEditorIconsFindReplaceClose' showLabel\x3d'false'\x3eX\x3c/button\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=E.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.btnId=this.id+"_close";this.inherited(arguments)},startup:function(){this.connect(this.button,"onClick","onClick")},onClick:function(){}}),g=u.declare("dojox.editor.plugins._FindReplaceTextBox",[c,d,h],{textId:"",label:"",toolTip:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceTextBox' title\x3d'${tooltip}' tabindex\x3d'-1'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${textId}' tabindex\x3d'-1'\x3e${label}\x3c/label\x3e\x3cinput dojoType\x3d'dijit.form.TextBox' intermediateChanges\x3d'true' class\x3d'focusTextBox' tabIndex\x3d'0' id\x3d'${textId}' dojoAttachPoint\x3d'textBox, focusNode' value\x3d'' dojoAttachEvent\x3d'onKeyPress: _onKeyPress'/\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=E.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.textId=this.id+"_text";this.inherited(arguments)},postCreate:function(){this.textBox.set("value","");this.disabled=this.textBox.get("disabled");this.connect(this.textBox,"onChange","onChange");u.attr(this.textBox.textbox,"formnovalidate","true")},_setValueAttr:function(r){this.value=r;this.textBox.set("value",r)},focus:function(){this.textBox.focus()},_setDisabledAttr:function(r){this.disabled=r;this.textBox.set("disabled",
r)},onChange:function(r){this.value=r},_onKeyPress:function(r){var B=0,F=0;!r.target||r.ctrlKey||r.altKey||r.shiftKey||(r.keyCode==u.keys.LEFT_ARROW?(B=r.target.selectionStart,F=r.target.selectionEnd,B<F&&(E.selectInputText(r.target,B,B),u.stopEvent(r))):r.keyCode==u.keys.RIGHT_ARROW&&(B=r.target.selectionStart,F=r.target.selectionEnd,B<F&&(E.selectInputText(r.target,F,F),u.stopEvent(r))))}}),A=u.declare("dojox.editor.plugins._FindReplaceCheckBox",[c,d,h],{checkId:"",label:"",tooltip:"",widget:null,
widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' tabindex\x3d'-1' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceCheckBox' title\x3d'${tooltip}' \x3e\x3cinput dojoType\x3d'dijit.form.CheckBox' tabIndex\x3d'0' id\x3d'${checkId}' dojoAttachPoint\x3d'checkBox, focusNode' value\x3d''/\x3e\x3clabel tabindex\x3d'-1' class\x3d'dijitLeft dijitInline' for\x3d'${checkId}'\x3e${label}\x3c/label\x3e\x3c/span\x3e",postMixInProperties:function(){this.id=E.getUniqueId(this.declaredClass.replace(/\./g,
"_"));this.checkId=this.id+"_check";this.inherited(arguments)},postCreate:function(){this.checkBox.set("checked",!1);this.disabled=this.checkBox.get("disabled");this.checkBox.isFocusable=function(){return!1}},_setValueAttr:function(r){this.checkBox.set("value",r)},_getValueAttr:function(){return this.checkBox.get("value")},focus:function(){this.checkBox.focus()},_setDisabledAttr:function(r){this.disabled=r;this.checkBox.set("disabled",r)}}),O=u.declare("dojox.editor.plugins._FindReplaceToolbar",n,
{postCreate:function(){this.connectKeyNavHandlers([],[]);this.connect(this.containerNode,"onclick","_onToolbarEvent");this.connect(this.containerNode,"onkeydown","_onToolbarEvent");u.addClass(this.domNode,"dijitToolbar")},addChild:function(r,B){E._KeyNavContainer.superclass.addChild.apply(this,arguments)},_onToolbarEvent:function(r){r.stopPropagation()}}),q=u.declare("dojox.editor.plugins.FindReplace",[z],{buttonClass:E.form.ToggleButton,iconClassPrefix:"dijitEditorIconsFindReplace",editor:null,button:null,
_frToolbar:null,_closeBox:null,_findField:null,_replaceField:null,_findButton:null,_replaceButton:null,_replaceAllButton:null,_caseSensitive:null,_backwards:null,_promDialog:null,_promDialogTimeout:null,_strings:null,_bookmark:null,_initButton:function(){this._strings=u.i18n.getLocalization("dojox.editor.plugins","FindReplace");this.button=new E.form.ToggleButton({label:this._strings.findReplace,showLabel:!1,iconClass:this.iconClassPrefix+" dijitEditorIconFindString",tabIndex:"-1",onChange:u.hitch(this,
"_toggleFindReplace")});u.isOpera&&this.button.set("disabled",!0);this.connect(this.button,"set",u.hitch(this,function(r,B){"disabled"===r&&this._toggleFindReplace(!B&&this._displayed,!0,!0)}))},setEditor:function(r){this.editor=r;this._initButton()},toggle:function(){this.button.set("checked",!this.button.get("checked"))},_toggleFindReplace:function(r,B,F){var Q=u.marginBox(this.editor.domNode);r&&!u.isOpera?(u.style(this._frToolbar.domNode,"display","block"),this._populateFindField(),B||(this._displayed=
!0)):(u.style(this._frToolbar.domNode,"display","none"),B||(this._displayed=!1),F||this.editor.focus());this.editor.resize({h:Q.h})},_populateFindField:function(){var r=this.editor._sCall("getSelectedText",[null]);this._findField&&this._findField.textBox&&(r&&this._findField.textBox.set("value",r),this._findField.textBox.focus(),E.selectInputText(this._findField.textBox.focusNode))},setToolbar:function(r){this.inherited(arguments);if(!u.isOpera){var B=this._frToolbar=new O;u.style(B.domNode,"display",
"none");u.place(B.domNode,r.domNode,"after");B.startup();this._closeBox=new b;B.addChild(this._closeBox);this._findField=new g({label:this._strings.findLabel,tooltip:this._strings.findTooltip});B.addChild(this._findField);this._replaceField=new g({label:this._strings.replaceLabel,tooltip:this._strings.replaceTooltip});B.addChild(this._replaceField);B.addChild(new K.editor.plugins.ToolbarLineBreak);this._findButton=new E.form.Button({label:this._strings.findButton,showLabel:!0,iconClass:this.iconClassPrefix+
" dijitEditorIconFind"});this._findButton.titleNode.title=this._strings.findButtonTooltip;B.addChild(this._findButton);this._replaceButton=new E.form.Button({label:this._strings.replaceButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplace"});this._replaceButton.titleNode.title=this._strings.replaceButtonTooltip;B.addChild(this._replaceButton);this._replaceAllButton=new E.form.Button({label:this._strings.replaceAllButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplaceAll"});
this._replaceAllButton.titleNode.title=this._strings.replaceAllButtonTooltip;B.addChild(this._replaceAllButton);this._caseSensitive=new A({label:this._strings.matchCase,tooltip:this._strings.matchCaseTooltip});B.addChild(this._caseSensitive);this._backwards=new A({label:this._strings.backwards,tooltip:this._strings.backwardsTooltip});B.addChild(this._backwards);this._findButton.set("disabled",!0);this._replaceButton.set("disabled",!0);this._replaceAllButton.set("disabled",!0);this.connect(this._findField,
"onChange","_checkButtons");this.connect(this._findField,"onKeyDown","_onFindKeyDown");this.connect(this._replaceField,"onKeyDown","_onReplaceKeyDown");this.connect(this._findButton,"onClick","_find");this.connect(this._replaceButton,"onClick","_replace");this.connect(this._replaceAllButton,"onClick","_replaceAll");this.connect(this._closeBox,"onClick","toggle");this._promDialog=new E.TooltipDialog;this._promDialog.startup();this._promDialog.set("content","")}},_checkButtons:function(){this._findField.get("value")?
(this._findButton.set("disabled",!1),this._replaceButton.set("disabled",!1),this._replaceAllButton.set("disabled",!1)):(this._findButton.set("disabled",!0),this._replaceButton.set("disabled",!0),this._replaceAllButton.set("disabled",!0))},_onFindKeyDown:function(r){r.keyCode==u.keys.ENTER&&(this._find(),u.stopEvent(r))},_onReplaceKeyDown:function(r){r.keyCode==u.keys.ENTER&&(this._replace()||this._replace(),u.stopEvent(r))},_find:function(r){var B=this._findField.get("value")||"";if(B){var F=this._caseSensitive.get("value"),
Q=this._backwards.get("value");B=this._findText(B,F,Q);!B&&r&&(this._promDialog.set("content",u.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextFind})),E.popup.open({popup:this._promDialog,around:this._findButton.domNode}),this._promDialogTimeout=setTimeout(u.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;E.popup.close(this._promDialog)}),3E3),setTimeout(u.hitch(this,function(){this.editor.focus()}),0));return B}return!1},_replace:function(r){var B=
!1,F=this.editor;F.focus();var Q=this._findField.get("value")||"",P=this._replaceField.get("value")||"";if(Q){var C=this._caseSensitive.get("value"),m=this._backwards.get("value"),k=F._sCall("getSelectedText",[null]);u.isMoz&&(Q=u.trim(Q),k=u.trim(k));Q=this._filterRegexp(Q,!C);k&&Q.test(k)&&(F.execCommand("inserthtml",P),B=!0,m&&(this._findText(P,C,m),F._sCall("collapse",[!0])));!this._find(!1)&&r&&(this._promDialog.set("content",u.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextReplace})),
E.popup.open({popup:this._promDialog,around:this._replaceButton.domNode}),this._promDialogTimeout=setTimeout(u.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;E.popup.close(this._promDialog)}),3E3),setTimeout(u.hitch(this,function(){this.editor.focus()}),0));return B}return null},_replaceAll:function(r){var B=0;this._backwards.get("value")?this.editor.placeCursorAtEnd():this.editor.placeCursorAtStart();this._replace(!1)&&B++;var F=u.hitch(this,function(){this._replace(!1)?
(B++,setTimeout(F,10)):r&&(this._promDialog.set("content",u.string.substitute(this._strings.replaceDialogText,{0:""+B})),E.popup.open({popup:this._promDialog,around:this._replaceAllButton.domNode}),this._promDialogTimeout=setTimeout(u.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;E.popup.close(this._promDialog)}),3E3),setTimeout(u.hitch(this,function(){this._findField.focus();this._findField.textBox.focusNode.select()}),0))});F()},_findText:function(r,B,
F){var Q=this.editor,P=Q.window,C=!1;if(r)if(P.find)C=P.find(r,B,F,!1,!1,!1,!1);else{var m=Q.document;if(m.selection||P.getSelection)if(this.editor.focus(),Q=m.body.createTextRange(),C=Q.duplicate(),P.getSelection().getRangeAt(0),(m=m.selection?m.selection.createRange():null)?F?Q.setEndPoint("EndToStart",m):Q.setEndPoint("StartToEnd",m):this._bookmark&&(P=P.getSelection().toString(),Q.moveToBookmark(this._bookmark),Q.text!=P?(Q=C.duplicate(),this._bookmark=null):(F?C.setEndPoint("EndToStart",Q):C.setEndPoint("StartToEnd",
Q),Q=C.duplicate())),B=B?4:0,F&&(B|=1),C=Q.findText(r,Q.text.length,B))Q.select(),this._bookmark=Q.getBookmark()}return C},_filterRegexp:function(r,B){for(var F="",Q=null,P=0;P<r.length;P++)switch(Q=r.charAt(P),Q){case "\\":F+=Q;P++;F+=r.charAt(P);break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":F+="\\";default:F+=Q}F="^"+F+"$";return B?new RegExp(F,"mi"):new RegExp(F,"m")},updateState:function(){this.button.set("disabled",this.get("disabled"))},
destroy:function(){this.inherited(arguments);this._promDialogTimeout&&(clearTimeout(this._promDialogTimeout),this._promDialogTimeout=null,E.popup.close(this._promDialog));this._frToolbar&&(this._frToolbar.destroyRecursive(),this._frToolbar=null);this._promDialog&&(this._promDialog.destroyRecursive(),this._promDialog=null)}});q._FindReplaceCloseBox=b;q._FindReplaceTextBox=g;q._FindReplaceCheckBox=A;q._FindReplaceToolbar=O;u.subscribe(E._scopeName+".Editor.getPlugin",null,function(r){r.plugin||"findreplace"!==
r.args.name.toLowerCase()||(r.plugin=new q({}))});return q})},"dojox/editor/plugins/PasteFromWord":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/RichText dijit/form/Button dijit/Dialog dojox/html/format dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/PasteFromWord dojo/i18n!dijit/nls/common dojo/i18n!dijit/_editor/nls/commands".split(" "),function(u,E,K,H){var G=u.declare("dojox.editor.plugins.PasteFromWord",
H,{iconClassPrefix:"dijitAdditionalEditorIcon",width:"400px",height:"300px",_template:"\x3cdiv class\x3d'dijitPasteFromWordEmbeddedRTE'\x3e\x3cdiv style\x3d'width: ${width}; padding-top: 5px; padding-bottom: 5px;'\x3e${instructions}\x3c/div\x3e\x3cdiv id\x3d'${uId}_rte' style\x3d'width: ${width}; height: ${height}'\x3e\x3c/div\x3e\x3ctable style\x3d'width: ${width}' tabindex\x3d'-1'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_paste'\x3e${paste}\x3c/button\x3e\x26nbsp;\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_cancel'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",
_filters:[{regexp:/(<meta\s*[^>]*\s*>)|(<\s*link\s* href="file:[^>]*\s*>)|(<\/?\s*\w+:[^>]*\s*>)/gi,handler:""},{regexp:/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,handler:""},{regexp:/(class="Mso[^"]*")|(\x3c!--(.|\s){1,}?--\x3e)/gi,handler:""},{regexp:/(<p[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/p[^>]*>)|(<p[^>]*>\s*<font[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/\s*font\s*>\s<\/p[^>]*>)/ig,handler:""},{regexp:/(style="[^"]*mso-[^;][^"]*")|(style="margin:\s*[^;"]*;")/gi,
handler:""},{regexp:/(<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>)|(<\s*script\b([^<>]|\s)*>?)|(<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>)/ig,handler:""},{regexp:/<(\/?)o:p[^>]*>/gi,handler:""}],_initButton:function(){this._filters=this._filters.slice(0);var c=u.i18n.getLocalization("dojox.editor.plugins","PasteFromWord");u.mixin(c,u.i18n.getLocalization("dijit","common"));u.mixin(c,u.i18n.getLocalization("dijit._editor","commands"));this.button=new E.form.Button({label:c.pasteFromWord,
showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"PasteFromWord",tabIndex:"-1",onClick:u.hitch(this,"_openDialog")});this._uId=E.getUniqueId(this.editor.id);c.uId=this._uId;c.width=this.width||"400px";c.height=this.height||"300px";this._dialog=(new E.Dialog({title:c.pasteFromWord})).placeAt(u.body());this._dialog.set("content",u.string.substitute(this._template,c));u.style(u.byId(this._uId+"_rte"),"opacity",.001);this.connect(E.byId(this._uId+"_paste"),"onClick","_paste");this.connect(E.byId(this._uId+
"_cancel"),"onClick","_cancel");this.connect(this._dialog,"onHide","_clearDialog")},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(c){this.editor=c;this._initButton()},_openDialog:function(){this._dialog.show();this._rte||setTimeout(u.hitch(this,function(){this._rte=new E._editor.RichText({height:this.height||"300px"},this._uId+"_rte");this._rte.startup();this._rte.onLoadDeferred.addCallback(u.hitch(this,function(){u.animateProperty({node:this._rte.domNode,
properties:{opacity:{start:.001,end:1}}}).play()}))}),100)},_paste:function(){var c=K.html.format.prettyPrint(this._rte.get("value"));this._dialog.hide();var d;for(d=0;d<this._filters.length;d++){var f=this._filters[d];c=c.replace(f.regexp,f.handler)}c=K.html.format.prettyPrint(c);this.editor.focus();this.editor.execCommand("inserthtml",c)},_cancel:function(){this._dialog.hide()},_clearDialog:function(){this._rte.set("value","")},destroy:function(){this._rte&&this._rte.destroy();this._dialog&&this._dialog.destroyRecursive();
delete this._dialog;delete this._rte;this.inherited(arguments)}});u.subscribe(E._scopeName+".Editor.getPlugin",null,function(c){c.plugin||"pastefromword"!==c.args.name.toLowerCase()||(c.plugin=new G({width:"width"in c.args?c.args.width:"400px",height:"height"in c.args?c.args.width:"300px"}))});return G})},"dojox/html/format":function(){define(["dojo/_base/kernel","./entities","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(u,E,K,H,G){var c=u.getObject("dojox.html.format",!0);c.prettyPrint=
function(d,f,h,l,n){var p=[],t=0,y=[],z="\t",b="",g=[],A,O=/[=]([^"']+?)(\s|>)/g,q=/style=("[^"]*"|'[^']*'|\S*)/gi,r=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;if(f&&0<f&&10>f)for(z="",A=0;A<f;A++)z+=" ";f=H.doc.createElement("div");f.innerHTML=d;var B=E.encode,F=E.decode,Q=f.ownerDocument.createElement("div"),P=function(a){a=a.cloneNode(!1);Q.appendChild(a);a=Q.innerHTML;Q.innerHTML="";return a},C=function(){var a;for(a=0;a<t;a++)p.push(z)},m=function(){p.push("\n")},k=function(a){var e;a=a.split("\n");for(e=
0;e<a.length;e++)a[e]=u.trim(a[e]);a=a.join(" ");a=u.trim(a);if(""!==a){var v=[];if(h&&0<h){var x="";for(e=0;e<t;e++)x+=z;e=x.length;x=h;for(h>e&&(x-=e);a;)if(a.length>h){for(e=x;0<e&&" "!==a.charAt(e);e--);if(!e)for(e=x;e<a.length&&" "!==a.charAt(e);e++);var w=a.substring(0,e);w=u.trim(w);a=u.trim(a.substring(e==a.length?a.length:e+1,a.length));if(w){var N="";for(e=0;e<t;e++)N+=z;w=N+w+"\n"}v.push(w)}else{N="";for(e=0;e<t;e++)N+=z;a=N+a+"\n";v.push(a);a=null}return v.join("")}N="";for(e=0;e<t;e++)N+=
z;return a=N+a+"\n"}return""},D=function(a){var e=a.nodeName.toLowerCase(),v=u.trim(P(a));a=v.substring(0,v.indexOf("\x3e")+1);a=a.replace(O,'\x3d"$1"$2');a=a.replace(q,function(w){var N=w.substring(0,6);w=w.substring(6,w.length);var J=w.charAt(0);w=u.trim(w.substring(1,w.length-1));w=w.split(";");var L=[];K.forEach(w,function(S){if(S=u.trim(S))S=S.substring(0,S.indexOf(":")).toLowerCase()+S.substring(S.indexOf(":"),S.length),L.push(S)});L=L.sort();w=L.join("; ");var M=u.trim(w);return M&&";"!==M?
N+J+(w+";")+J:""});var x=[];a=a.replace(r,function(w){x.push(u.trim(w));return""});x=x.sort();a="\x3c"+e;x.length&&(a+=" "+x.join(" "));-1!=v.indexOf("\x3c/")?(y.push(e),a+="\x3e"):(a=n?a+" /\x3e":a+"\x3e",y.push(!1));a:switch(e){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "small":e=!0;break a;default:e=!1}g.push(e);b&&!e&&(p.push(k(b)),b="");e?b+=a:(C(),p.push(a),m(),t++)},I=
function(a){var e=a.childNodes;if(e){var v;for(v=0;v<e.length;v++){var x=e[v];if(1===x.nodeType){var w=u.trim(x.tagName.toLowerCase());if(!G("ie")||x.parentNode==a)if(!w||"/"!==w.charAt(0)){D(x);if("script"===w){w=p;var N=w.push,J=void 0,L=J=void 0,M=void 0;if(M=x.innerHTML){M&&(M=M.replace(/&quot;/gi,'"'),M=M.replace(/&gt;/gi,"\x3e"),M=M.replace(/&lt;/gi,"\x3c"),M=M.replace(/&amp;/gi,"\x26"));x=0;var S=M.split("\n"),R=[];for(M=0;M<S.length;M++){var T=S[M],U=-1<T.indexOf("\n");if(T=u.trim(T)){U=x;
for(J=0;J<T.length;J++)L=T.charAt(J),"{"===L?x++:"}"===L&&(x--,U=x);J="";for(L=0;L<t+U;L++)J+=z;R.push(J+T+"\n")}else U&&0===M&&R.push("\n")}M=R.join("")}N.call(w,M)}else"pre"===w?(w=x.innerHTML,G("mozilla")&&(w=w.replace("\x3cbr\x3e","\n"),w=w.replace("\x3cpre\x3e",""),w=w.replace("\x3c/pre\x3e","")),"\n"!==w.charAt(w.length-1)&&(w+="\n"),p.push(w)):I(x);w=g.pop();b&&!w&&(p.push(k(b)),b="");(N=y.pop())?(N="\x3c/"+N+"\x3e",w?b+=N:(t--,C(),p.push(N),m())):t--}}else 3===x.nodeType||4===x.nodeType?b+=
B(x.nodeValue,l):8===x.nodeType&&(w=F(x.nodeValue,l),C(),p.push("\x3c!--"),m(),t++,p.push(k(w)),t--,C(),p.push("--\x3e"),m())}}};I(f);b&&(p.push(k(b)),b="");return p.join("")};return c})},"dojox/editor/plugins/InsertAnchor":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/range dijit/_Templated dijit/TooltipDialog dijit/form/ValidationTextBox dijit/form/Select dijit/form/Button dijit/form/DropDownButton dojo/_base/declare dojo/i18n dojo/string dojo/NodeList-dom dojox/editor/plugins/ToolbarLineBreak dojo/i18n!dojox/editor/plugins/nls/InsertAnchor dojo/i18n!dijit/nls/common".split(" "),
function(u,E,K,H){var G=u.declare("dojox.editor.plugins.InsertAnchor",H,{htmlTemplate:'\x3ca name\x3d"${anchorInput}" class\x3d"dijitEditorPluginInsertAnchorStyle"\x3e${textInput}\x3c/a\x3e',iconClassPrefix:"dijitAdditionalEditorIcon",_template:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_anchorInput'\x3e${anchor}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_anchorInput' name\x3d'anchorInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${cancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){var c=this,d=u.i18n.getLocalization("dojox.editor.plugins","InsertAnchor",this.lang),f=this.dropDown=new E.TooltipDialog({title:d.title,execute:u.hitch(this,"setValue"),onOpen:function(){c._onOpenDialog();E.TooltipDialog.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(u.hitch(c,"_onCloseDialog"),0)}});this.button=new E.form.DropDownButton({label:d.insertAnchor,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"InsertAnchor",tabIndex:"-1",
dropDown:this.dropDown});d.id=E.getUniqueId(this.editor.id);this._uniqueId=d.id;this.dropDown.set("content",f.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+u.string.substitute(this._template,d));f.startup();this._anchorInput=E.byId(this._uniqueId+"_anchorInput");this._textInput=E.byId(this._uniqueId+"_textInput");this._setButton=E.byId(this._uniqueId+"_setButton");this.connect(E.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel()});
this._anchorInput&&this.connect(this._anchorInput,"onChange","_checkInput");this._textInput&&this.connect(this._anchorInput,"onChange","_checkInput");this.editor.contentDomPreFilters.push(u.hitch(this,this._preDomFilter));this.editor.contentDomPostFilters.push(u.hitch(this,this._postDomFilter));this._setup()},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(c){this.editor=c;this._initButton()},_checkInput:function(){var c=!0;this._anchorInput.isValid()&&
(c=!1);this._setButton.set("disabled",c)},_setup:function(){this.editor.onLoadDeferred.addCallback(u.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);setTimeout(u.hitch(this,function(){this._applyStyles()}),100)}))},getAnchorStyle:function(){var c=u.moduleUrl(K._scopeName,"editor/plugins/resources").toString();if(!c.match(/^https?:\/\//i)&&!c.match(/^file:\/\//i)){var d="/"===c.charAt(0)?u.doc.location.protocol+"//"+u.doc.location.host:this._calcBaseUrl(u.global.location.href);
"/"!==d[d.length-1]&&"/"!==c.charAt(0)&&(d+="/");c=d+c}return"@media screen {\n\t.dijitEditorPluginInsertAnchorStyle {\n\t\tbackground-image: url({MODURL}/images/anchor.gif);\n\t\tbackground-repeat: no-repeat;\n\t\tbackground-position: top left;\n\t\tborder-width: 1px;\n\t\tborder-style: dashed;\n\t\tborder-color: #D0D0D0;\n\t\tpadding-left: 20px;\n\t}\n}\n".replace(/\{MODURL\}/gi,c)},_applyStyles:function(){if(!this._styled)try{this._styled=!0;var c=this.editor.document,d=this.getAnchorStyle();if(u.isIE)c.createStyleSheet("").cssText=
d;else{var f=c.createElement("style");f.appendChild(c.createTextNode(d));c.getElementsByTagName("head")[0].appendChild(f)}}catch(h){}},_calcBaseUrl:function(c){var d=null;null!==c&&(d=c.indexOf("?"),-1!=d&&(c=c.substring(0,d)),d=c.lastIndexOf("/"),d=0<d&&d<c.length?c.substring(0,d):c);return d},_checkValues:function(c){c&&(c.anchorInput&&(c.anchorInput=c.anchorInput.replace(/"/g,"\x26quot;")),c.textInput||(c.textInput="\x26nbsp;"));return c},setValue:function(c){this._onCloseDialog();if(!this.editor.window.getSelection){var d=
E.range.getSelection(this.editor.window).getRangeAt(0).endContainer;3===d.nodeType&&(d=d.parentNode);d&&d.nodeName&&"a"!==d.nodeName.toLowerCase()&&(d=this.editor._sCall("getSelectedElement",["a"]));d&&d.nodeName&&"a"===d.nodeName.toLowerCase()&&this.editor.queryCommandEnabled("unlink")&&(this.editor._sCall("selectElementChildren",[d]),this.editor.execCommand("unlink"))}c=this._checkValues(c);this.editor.execCommand("inserthtml",u.string.substitute(this.htmlTemplate,c))},_onCloseDialog:function(){this.editor.focus()},
_getCurrentValues:function(c){if(c&&"a"===c.tagName.toLowerCase()&&u.attr(c,"name")){var d=u.attr(c,"name");var f=c.textContent||c.innerText;this.editor._sCall("selectElement",[c,!0])}else f=this.editor._sCall("getSelectedText");return{anchorInput:d||"",textInput:f||""}},_onOpenDialog:function(){if(this.editor.window.getSelection)var c=this.editor._sCall("getAncestorElement",["a"]);else c=E.range.getSelection(this.editor.window).getRangeAt(0).endContainer,3===c.nodeType&&(c=c.parentNode),c&&c.nodeName&&
"a"!==c.nodeName.toLowerCase()&&(c=this.editor._sCall("getSelectedElement",["a"]));this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(c))},_onDblClick:function(c){c&&c.target&&(c=c.target,"a"===(c.tagName?c.tagName.toLowerCase():"")&&u.attr(c,"name")&&(this.editor.onDisplayChanged(),this.editor._sCall("selectElement",[c]),setTimeout(u.hitch(this,function(){this.button.set("disabled",!1);this.button.openDropDown();this.button.dropDown.focus&&this.button.dropDown.focus()}),
10)))},_preDomFilter:function(c){u.query("a[name]:not([href])",this.editor.editNode).addClass("dijitEditorPluginInsertAnchorStyle")},_postDomFilter:function(c){c&&u.query("a[name]:not([href])",c).removeClass("dijitEditorPluginInsertAnchorStyle");return c}});u.subscribe(E._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin){var d=c.args.name;d&&(d=d.toLowerCase());"insertanchor"===d&&(c.plugin=new G)}});return G})},"dojox/editor/plugins/Blockquote":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/ToggleButton dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Blockquote".split(" "),
function(u,E,K,H){var G=u.declare("dojox.editor.plugins.Blockquote",H,{iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=u.i18n.getLocalization("dojox.editor.plugins","Blockquote");this.button=new E.form.ToggleButton({label:this._nlsResources.blockquote,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Blockquote",tabIndex:"-1",onClick:u.hitch(this,"_toggleQuote")})},setEditor:function(c){this.editor=c;this._initButton();this.connect(this.editor,
"onNormalizedDisplayChanged","updateState");c.customUndo=!0},_toggleQuote:function(c){try{var d=this.editor;d.focus();var f=this.button.get("checked"),h=E.range.getSelection(d.window),l,n,p,t;h&&0<h.rangeCount&&(l=h.getRangeAt(0));if(l){d.beginEditing();if(f)if(l.startContainer===l.endContainer){if(this._isRootInline(l.startContainer)){for(p=l.startContainer;p&&p.parentNode!==d.editNode;)p=p.parentNode;for(;p&&p.previousSibling&&(this._isTextElement(p)||1===p.nodeType&&this._isInlineFormat(this._getTagName(p)));)p=
p.previousSibling;p&&1===p.nodeType&&!this._isInlineFormat(this._getTagName(p))&&(p=p.nextSibling);if(p){var y=d.document.createElement("blockquote");u.place(y,p,"after");y.appendChild(p);for(t=y.nextSibling;t&&(this._isTextElement(t)||1===t.nodeType&&this._isInlineFormat(this._getTagName(t)));)y.appendChild(t),t=y.nextSibling}}else{for(var z=l.startContainer;(this._isTextElement(z)||this._isInlineFormat(this._getTagName(z))||"li"===this._getTagName(z))&&z!==d.editNode&&z!==d.document.body;)z=z.parentNode;
z!==d.editNode&&z!==z.ownerDocument.documentElement&&(y=d.document.createElement("blockquote"),u.place(y,z,"after"),y.appendChild(z))}y&&(d._sCall("selectElementChildren",[y]),d._sCall("collapse",[!0]))}else{var b;p=l.startContainer;for(t=l.endContainer;p&&this._isTextElement(p)&&p.parentNode!==d.editNode;)p=p.parentNode;for(b=p;b.nextSibling&&d._sCall("inSelection",[b]);)b=b.nextSibling;t=b;if(t===d.editNode||t===d.document.body){y=d.document.createElement("blockquote");u.place(y,p,"after");var g=
this._getTagName(p);if(this._isTextElement(p)||this._isInlineFormat(g))for(d=p;d&&(this._isTextElement(d)||1===d.nodeType&&this._isInlineFormat(this._getTagName(d)));)y.appendChild(d),d=y.nextSibling;else y.appendChild(p);return}t=t.nextSibling;for(b=p;b&&b!==t;){if(1===b.nodeType){if(g=this._getTagName(b),"br"!==g){if(!window.getSelection&&"p"===g&&this._isEmpty(b)){b=b.nextSibling;continue}this._isInlineFormat(g)?y||(y=d.document.createElement("blockquote"),u.place(y,b,"after")):(y&&this._isEmpty(y)&&
y.parentNode.removeChild(y),y=d.document.createElement("blockquote"),u.place(y,b,"after"));y.appendChild(b);b=y}}else this._isTextElement(b)&&(y||(y=d.document.createElement("blockquote"),u.place(y,b,"after")),y.appendChild(b),b=y);b=b.nextSibling}y&&(this._isEmpty(y)?y.parentNode.removeChild(y):(d._sCall("selectElementChildren",[y]),d._sCall("collapse",[!0])),y=null)}else if(y=!1,l.startContainer===l.endContainer){for(n=l.endContainer;n&&n!==d.editNode&&n!==d.document.body;){if("blockquote"===(n.tagName?
n.tagName.toLowerCase():"")){y=!0;break}n=n.parentNode}if(y){for(var A;n.firstChild;)A=n.firstChild,u.place(A,n,"before");n.parentNode.removeChild(n);A&&(d._sCall("selectElementChildren",[A]),d._sCall("collapse",[!0]))}}else{p=l.startContainer;for(t=l.endContainer;p&&this._isTextElement(p)&&p.parentNode!==d.editNode;)p=p.parentNode;for(l=[];p&&p.nextSibling&&d._sCall("inSelection",[p]);)p.parentNode&&"blockquote"===this._getTagName(p.parentNode)&&(p=p.parentNode),l.push(p),p=p.nextSibling;for(var O=
this._findBlockQuotes(l);O.length;){var q=O.pop();if(q.parentNode){for(;q.firstChild;)u.place(q.firstChild,q,"before");q.parentNode.removeChild(q)}}}d.endEditing()}d.onNormalizedDisplayChanged()}catch(r){}},updateState:function(){var c=this.editor,d=this.get("disabled");if(c&&c.isLoaded&&this.button&&(this.button.set("disabled",d),!d)){d=!1;var f=E.range.getSelection(c.window);if(f&&0<f.rangeCount&&(f=f.getRangeAt(0)))var h=f.endContainer;for(;h&&h!==c.editNode&&h!==c.document;){if("blockquote"===
(h.tagName?h.tagName.toLowerCase():"")){d=!0;break}h=h.parentNode}this.button.set("checked",d)}},_findBlockQuotes:function(c){var d=[];if(c){var f;for(f=0;f<c.length;f++){var h=c[f];1===h.nodeType&&("blockquote"===this._getTagName(h)&&d.push(h),h.childNodes&&0<h.childNodes.length&&(d=d.concat(this._findBlockQuotes(h.childNodes))))}}return d},_getTagName:function(c){var d="";c&&1===c.nodeType&&(d=c.tagName?c.tagName.toLowerCase():"");return d},_isRootInline:function(c){var d=this.editor;if(this._isTextElement(c)&&
c.parentNode===d.editNode||1===c.nodeType&&this._isInlineFormat(c)&&c.parentNode===d.editNode)return!0;if(this._isTextElement(c)&&this._isInlineFormat(this._getTagName(c.parentNode))){for(c=c.parentNode;c&&c!==d.editNode&&this._isInlineFormat(this._getTagName(c));)c=c.parentNode;if(c===d.editNode)return!0}return!1},_isTextElement:function(c){return c&&3===c.nodeType||4===c.nodeType?!0:!1},_isEmpty:function(c){if(c.childNodes){var d=!0,f;for(f=0;f<c.childNodes.length;f++){var h=c.childNodes[f];if(1===
h.nodeType){if("p"!==this._getTagName(h)||u.trim(h.innerHTML)){d=!1;break}}else if(this._isTextElement(h)){if((h=u.trim(h.nodeValue))&&"\x26nbsp;"!==h&&"\u00a0"!==h){d=!1;break}}else{d=!1;break}}return d}return!0},_isInlineFormat:function(c){switch(c){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "img":case "small":return!0;default:return!1}}});u.subscribe(E._scopeName+".Editor.getPlugin",
null,function(c){c.plugin||"blockquote"!==c.args.name.toLowerCase()||(c.plugin=new G({}))});return G})},"dojox/editor/plugins/UploadImage":function(){define("dojo dijit dojox dijit/_editor/_Plugin dojo/_base/connect dojo/_base/declare dojox/form/FileUploader dijit/_editor/_Plugin".split(" "),function(u,E,K,H){u.experimental("dojox.editor.plugins.UploadImage");var G=u.declare("dojox.editor.plugins.UploadImage",H,{tempImageUrl:"",iconClassPrefix:"editorIcon",useDefaultCommand:!1,uploadUrl:"",button:null,
label:"Upload",setToolbar:function(c){this.button.destroy();this.createFileInput();c.addChild(this.button)},_initButton:function(){this.command="uploadImage";this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",arguments);delete this.command},updateState:function(){this.button.set("disabled",this.get("disabled"))},createFileInput:function(){var c=u.create("span",{innerHTML:"."},document.body);u.style(c,{width:"40px",height:"20px",paddingLeft:"8px",paddingRight:"8px"});this.button=
new K.form.FileUploader({isDebug:!0,uploadUrl:this.uploadUrl,uploadOnChange:!0,selectMultipleFiles:!1,baseClass:"dojoxEditorUploadNorm",hoverClass:"dojoxEditorUploadHover",activeClass:"dojoxEditorUploadActive",disabledClass:"dojoxEditorUploadDisabled"},c);this.connect(this.button,"onChange","insertTempImage");this.connect(this.button,"onComplete","onComplete")},onComplete:function(c,d,f){c=c[0];d=u.byId(this.currentImageId,this.editor.document);f=this.downloadPath?this.downloadPath+c.name:c.file;
d.src=f;u.attr(d,"_djrealurl",f);c.width&&(d.width=c.width,d.height=c.height)},insertTempImage:function(){this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+this.tempImageUrl+'" width\x3d"32" height\x3d"32"/\x3e')}});u.subscribe(E._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin)switch(c.args.name){case "uploadImage":c.plugin=new G({url:c.args.url})}});return G})},"dojox/form/FileUploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/_base/sniff dojo/query dojo/dom dojo/dom-style dojo/dom-geometry dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-form dojo/_base/config dijit/_base/manager dojo/io/iframe dojo/_base/Color dojo/_base/unload dijit/_Widget dijit/_TemplatedMixin dijit/_Contained dojox/embed/Flash dojox/embed/flashVars dojox/html/styles".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t,y,z,b,g,A,O,q,r,B,F,Q,P,C){u.deprecated("dojox.form.FileUploader","Use dojox.form.Uploader","2.0");return E("dojox.form.FileUploader",[r,B,F],{swfPath:b.uploaderPath||require.toUrl("dojox/form/resources/fileuploader.swf"),templateString:'\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d"progNode"\x3e\x3cdiv dojoAttachPoint\x3d"progTextNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d"insideNode" class\x3d"uploaderInsideNode"\x3e\x3c/div\x3e\x3c/div\x3e',uploadUrl:"",
isDebug:!1,devMode:!1,baseClass:"dojoxUploaderNorm",hoverClass:"dojoxUploaderHover",activeClass:"dojoxUploaderActive",disabledClass:"dojoxUploaderDisabled",force:"",uploaderType:"",flashObject:null,flashMovie:null,insideNode:null,deferredUploading:1,fileListId:"",uploadOnChange:!1,selectMultipleFiles:!0,htmlFieldName:"uploadedfile",flashFieldName:"flashUploadFiles",fileMask:null,minFlashVersion:9,tabIndex:-1,showProgress:!1,progressMessage:"Loading",progressBackgroundUrl:require.toUrl("dijit/themes/tundra/images/buttonActive.png"),
progressBackgroundColor:"#ededed",progressWidgetId:"",skipServerCheck:!1,serverTimeout:5E3,log:function(){this.isDebug&&console.log(Array.prototype.slice.call(arguments).join(" "))},constructor:function(){this._subs=[]},postMixInProperties:function(){this.fileList=[];this._cons=[];this.fileMask=this.fileMask||[];this.fileInputs=[];this.fileCount=0;this._disabled=this.flashReady=!1;this.force=this.force.toLowerCase();this.uploaderType=(Q.available>=this.minFlashVersion||"flash"==this.force)&&"html"!=
this.force?"flash":"html";this.deferredUploading=!0===this.deferredUploading?1:this.deferredUploading;this._refNode=this.srcNodeRef;this.getButtonStyle()},startup:function(){},postCreate:function(){this.inherited(arguments);this.setButtonStyle();if("flash"==this.uploaderType)var m="createFlashUploader";else this.uploaderType="html",m="createHtmlUploader";this[m]();this.fileListId&&this.connect(h.byId(this.fileListId),"click",function(k){k=k.target.parentNode.parentNode.parentNode;k.id&&-1<k.id.indexOf("file_")&&
this.removeFile(k.id.split("file_")[1])});q.addOnUnload(this,this.destroy)},getHiddenNode:function(m){if(!m)return null;var k=null;for(m=m.parentNode;m&&"body"!=m.tagName.toLowerCase();){if("none"==l.get(m,"display")){k=m;break}m=m.parentNode}return k},getButtonStyle:function(){var m=this.srcNodeRef;(this._hiddenNode=this.getHiddenNode(m))&&l.set(this._hiddenNode,"display","block");if(!m&&this.button&&this.button.domNode){var k=!0;m=this.button.domNode.className+" dijitButtonNode";var D=this.getText(f(".dijitButtonText",
this.button.domNode)[0]);this.srcNodeRef=m=y.place('\x3cbutton id\x3d"'+this.button.id+'" class\x3d"'+m+'"\x3e'+D+"\x3c/button\x3e",this.button.domNode,"after");this.button.destroy();this.baseClass="dijitButton";this.hoverClass="dijitButtonHover";this.pressClass="dijitButtonActive";this.disabledClass="dijitButtonDisabled"}else!this.srcNodeRef&&this.button&&(m=this.button);p.get(m,"class")&&(this.baseClass+=" "+p.get(m,"class"));p.set(m,"class",this.baseClass);this.norm=this.getStyle(m);this.width=
this.norm.w;this.height=this.norm.h;"flash"==this.uploaderType?(this.over=this.getTempNodeStyle(m,this.baseClass+" "+this.hoverClass,k),this.down=this.getTempNodeStyle(m,this.baseClass+" "+this.activeClass,k),this.dsbl=this.getTempNodeStyle(m,this.baseClass+" "+this.disabledClass,k),this.fhtml={cn:this.getText(m),nr:this.norm,ov:this.over,dn:this.down,ds:this.dsbl}):(this.fhtml={cn:this.getText(m),nr:this.norm},"middle"==this.norm.va&&(this.norm.lh=this.norm.h));this.devMode&&(this.log("classes - base:",
this.baseClass," hover:",this.hoverClass,"active:",this.activeClass),this.log("fhtml:",this.fhtml),this.log("norm:",this.norm),this.log("over:",this.over),this.log("down:",this.down))},setButtonStyle:function(){l.set(this.domNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+"px",padding:"0px",lineHeight:"normal",position:"relative"});"html"==this.uploaderType&&"middle"==this.norm.va&&l.set(this.domNode,"lineHeight",this.norm.lh+"px");this.showProgress?(this.progTextNode.innerHTML=this.progressMessage,
l.set(this.progTextNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",lineHeight:this.fhtml.nr.h+0+"px",position:"absolute"}),l.set(this.progNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",position:"absolute",display:"none",backgroundImage:"url("+this.progressBackgroundUrl+")",backgroundPosition:"bottom",backgroundRepeat:"repeat-x",backgroundColor:this.progressBackgroundColor})):y.destroy(this.progNode);
l.set(this.insideNode,{position:"absolute",top:"0px",left:"0px",display:""});t.add(this.domNode,this.srcNodeRef.className);-1<this.fhtml.nr.d.indexOf("inline")&&t.add(this.domNode,"dijitInline");try{this.insideNode.innerHTML=this.fhtml.cn}catch(k){if("flash"==this.uploaderType){this.insideNode=this.insideNode.parentNode.removeChild(this.insideNode);c.body().appendChild(this.insideNode);this.insideNode.innerHTML=this.fhtml.cn;var m=G.connect(this,"onReady",this,function(){G.disconnect(m);this.insideNode=
this.insideNode.parentNode.removeChild(this.insideNode);this.domNode.appendChild(this.insideNode)})}else this.insideNode.appendChild(document.createTextNode(this.fhtml.cn))}this._hiddenNode&&l.set(this._hiddenNode,"display","none")},onChange:function(m){},onProgress:function(m){},onComplete:function(m){},onCancel:function(){},onError:function(m){},onReady:function(m){},onLoad:function(m){},submit:function(m){m=m?z.toObject(m):null;this.upload(m);return!1},upload:function(m){if(!this.fileList.length)return!1;
if(!this.uploadUrl)return console.warn("uploadUrl not provided. Aborting."),!1;this.showProgress||this.set("disabled",!0);if(this.progressWidgetId){var k=g.byId(this.progressWidgetId).domNode;"none"==l.get(k,"display")&&(this.restoreProgDisplay="none",l.set(k,"display","block"));"hidden"==l.get(k,"visibility")&&(this.restoreProgDisplay="hidden",l.set(k,"visibility","visible"))}m&&!m.target&&(this.postData=m);this.log("upload type:",this.uploaderType," - postData:",this.postData);for(m=0;m<this.fileList.length;m++)k=
this.fileList[m],k.bytesLoaded=0,k.bytesTotal=k.size||1E5,k.percent=0;"flash"==this.uploaderType?this.uploadFlash():this.uploadHTML();return!1},removeFile:function(m,k){var D;for(D=0;D<this.fileList.length;D++)if(this.fileList[D].name==m){k||this.fileList.splice(D,1);break}"flash"==this.uploaderType?this.flashMovie.removeFile(m):k||(y.destroy(this.fileInputs[D]),this.fileInputs.splice(D,1),this._renumberInputs());this.fileListId&&y.destroy("file_"+m)},destroy:function(){"flash"!=this.uploaderType||
this.flashMovie?(H.forEach(this._subs,G.unsubscribe,dojo),H.forEach(this._cons,G.disconnect,dojo),this.scrollConnect&&G.disconnect(this.scrollConnect),"flash"==this.uploaderType?(this.flashObject.destroy(),delete this.flashObject):(y.destroy(this._fileInput),y.destroy(this._formNode)),this.inherited(arguments)):this._cons.push(G.connect(this,"onLoad",this,"destroy"))},_displayProgress:function(m){!0===m?("flash"==this.uploaderType?l.set(this.insideNode,"top","-2500px"):l.set(this.insideNode,"display",
"none"),l.set(this.progNode,"display","")):!1===m?(l.set(this.insideNode,{display:"",top:"0"}),l.set(this.progNode,"display","none")):l.set(this.progNode,"width",m*this.fhtml.nr.w+"px")},_animateProgress:function(){this._displayProgress(!0);var m=!1,k=G.connect(this,"_complete",function(){G.disconnect(k);m=!0}),D=0,I=setInterval(K.hitch(this,function(){D+=5;D>this.fhtml.nr.w&&(D=0,m=!0);this._displayProgress(D/this.fhtml.nr.w);m&&(clearInterval(I),setTimeout(K.hitch(this,function(){this._displayProgress(!1)}),
500))}),50)},_error:function(m){"string"==typeof m&&(m=Error(m));this.onError(m)},_addToFileList:function(){if(this.fileListId){var m="";H.forEach(this.fileList,function(k){m+='\x3ctable id\x3d"file_'+k.name+'" class\x3d"fileToUpload"\x3e\x3ctr\x3e\x3ctd class\x3d"fileToUploadClose"\x3e\x3c/td\x3e\x3ctd class\x3d"fileToUploadName"\x3e'+k.name+'\x3c/td\x3e\x3ctd class\x3d"fileToUploadSize"\x3e'+(k.size?Math.ceil(.001*k.size)+"kb":"")+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"},this);h.byId(this.fileListId).innerHTML=
m}},_change:function(m){d("ie")&&H.forEach(m,function(k){k.name=k.name.split("\\")[k.name.split("\\").length-1]});this.selectMultipleFiles?this.fileList=this.fileList.concat(m):(this.fileList[0]&&this.removeFile(this.fileList[0].name,!0),this.fileList=m);this._addToFileList();this.onChange(m);this.uploadOnChange?("html"==this.uploaderType&&this._buildFileInput(),this.upload()):"html"==this.uploaderType&&this.selectMultipleFiles&&(this._buildFileInput(),this._connectInput())},_complete:function(m){m=
K.isArray(m)?m:[m];H.forEach(m,function(k){k.ERROR&&this._error(k.ERROR)},this);H.forEach(this.fileList,function(k){k.bytesLoaded=1;k.bytesTotal=1;k.percent=100;this._progress(k)},this);H.forEach(this.fileList,function(k){this.removeFile(k.name,!0)},this);this.onComplete(m);this.fileList=[];this._resetHTML();this.set("disabled",!1);this.restoreProgDisplay&&setTimeout(K.hitch(this,function(){l.set(g.byId(this.progressWidgetId).domNode,"none"==this.restoreProgDisplay?"display":"visibility",this.restoreProgDisplay)}),
500)},_progress:function(m){for(var k=0,D=0,I=0;I<this.fileList.length;I++){var a=this.fileList[I];a.name==m.name&&(a.bytesLoaded=m.bytesLoaded,a.bytesTotal=m.bytesTotal,a.percent=Math.ceil(a.bytesLoaded/a.bytesTotal*100),this.log(a.name,"percent:",a.percent));D+=Math.ceil(.001*a.bytesLoaded);k+=Math.ceil(.001*a.bytesTotal)}m=Math.ceil(D/k*100);this.progressWidgetId&&g.byId(this.progressWidgetId).update({progress:m+"%"});this.showProgress&&this._displayProgress(.01*m);this.onProgress(this.fileList)},
_getDisabledAttr:function(){return this._disabled},_setDisabledAttr:function(m){if(this._disabled!=m){if("flash"==this.uploaderType){if(!this.flashReady){var k=G.connect(this,"onLoad",this,function(){G.disconnect(k);this._setDisabledAttr(m)});return}this._disabled=m;this.flashMovie.doDisable(m)}else this._disabled=m,l.set(this._fileInput,"display",this._disabled?"none":"");t.toggle(this.domNode,this.disabledClass,m)}},_onFlashBlur:function(){this.flashMovie.blur();if(!this.nextFocusObject&&this.tabIndex)for(var m=
f("[tabIndex]"),k=0;k<m.length;k++)if(m[k].tabIndex>=Number(this.tabIndex)+1){this.nextFocusObject=m[k];break}this.nextFocusObject.focus()},_disconnect:function(){H.forEach(this._cons,G.disconnect,dojo)},uploadHTML:function(){this.selectMultipleFiles&&y.destroy(this._fileInput);this._setHtmlPostData();this.showProgress&&this._animateProgress();A.send({url:this.uploadUrl.toString(),form:this._formNode,handleAs:"json",error:K.hitch(this,function(m){this._error("HTML Upload Error:"+m.message)}),load:K.hitch(this,
function(m,k,D){this._complete(m)})})},createHtmlUploader:function(){this._buildForm();this._setFormStyle();this._buildFileInput();this._connectInput();this._styleContent();l.set(this.insideNode,"visibility","visible");this.onReady()},_connectInput:function(){this._disconnect();this._cons.push(G.connect(this._fileInput,"mouseover",this,function(m){t.add(this.domNode,this.hoverClass);this.onMouseOver(m)}));this._cons.push(G.connect(this._fileInput,"mouseout",this,function(m){setTimeout(K.hitch(this,
function(){t.remove(this.domNode,this.activeClass);t.remove(this.domNode,this.hoverClass);this.onMouseOut(m);this._checkHtmlCancel("off")}),0)}));this._cons.push(G.connect(this._fileInput,"mousedown",this,function(m){t.add(this.domNode,this.activeClass);t.remove(this.domNode,this.hoverClass);this.onMouseDown(m)}));this._cons.push(G.connect(this._fileInput,"mouseup",this,function(m){t.remove(this.domNode,this.activeClass);this.onMouseUp(m);this.onClick(m);this._checkHtmlCancel("up")}));this._cons.push(G.connect(this._fileInput,
"change",this,function(){this._checkHtmlCancel("change");var m=this._fileInput.value;m?this._change([{name:m,type:"",size:0}]):this._change([])}));0<=this.tabIndex&&p.set(this.domNode,"tabIndex",this.tabIndex)},_checkHtmlCancel:function(m){"change"==m&&(this.dialogIsOpen=!1);"up"==m&&(this.dialogIsOpen=!0);if("off"==m){if(this.dialogIsOpen)this.onCancel();this.dialogIsOpen=!1}},_styleContent:function(){var m=this.fhtml.nr;l.set(this.insideNode,{width:m.w+"px",height:"middle"==m.va?m.h+"px":"auto",
textAlign:m.ta,paddingTop:m.p[0]+"px",paddingRight:m.p[1]+"px",paddingBottom:m.p[2]+"px",paddingLeft:m.p[3]+"px"});try{l.set(this.insideNode,"lineHeight","inherit")}catch(k){}},_resetHTML:function(){"html"==this.uploaderType&&this._formNode&&(this.fileInputs=[],f("*",this._formNode).forEach(function(m){y.destroy(m)}),this.fileCount=0,this._buildFileInput(),this._connectInput())},_buildForm:function(){this._formNode||(9>d("ie")||d("ie")&&d("quirks")?(this._formNode=document.createElement('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e'),
this._formNode.encoding="multipart/form-data",this._formNode.id=g.getUniqueId("FileUploaderForm"),this.domNode.appendChild(this._formNode)):this._formNode=y.create("form",{enctype:"multipart/form-data",method:"post",id:g.getUniqueId("FileUploaderForm")},this.domNode))},_buildFileInput:function(){this._fileInput&&(this._disconnect(),this._fileInput.id+=this.fileCount,l.set(this._fileInput,"display","none"));this._fileInput=document.createElement("input");this.fileInputs.push(this._fileInput);var m=
this.htmlFieldName;this.selectMultipleFiles&&(m+=this.fileCount,this.fileCount++);p.set(this._fileInput,{id:this.id,name:m,type:"file"});t.add(this._fileInput,"dijitFileInputReal");this._formNode.appendChild(this._fileInput);m=n.getMarginBox(this._fileInput);l.set(this._fileInput,{position:"relative",left:this.fhtml.nr.w-m.w+"px",opacity:0})},_renumberInputs:function(){if(this.selectMultipleFiles){var m;this.fileCount=0;H.forEach(this.fileInputs,function(k){m=this.htmlFieldName+this.fileCount;this.fileCount++;
p.set(k,"name",m)},this)}},_setFormStyle:function(){C.insertCssRule("#"+this._formNode.id+" input","font-size:"+Math.max(2,Math.max(Math.ceil(this.fhtml.nr.w/60),Math.ceil(this.fhtml.nr.h/15)))+"em");l.set(this.domNode,{overflow:"hidden",position:"relative"});l.set(this.insideNode,"position","absolute")},_setHtmlPostData:function(){if(this.postData)for(var m in this.postData)y.create("input",{type:"hidden",name:m,value:this.postData[m]},this._formNode)},uploadFlash:function(){try{if(this.showProgress){this._displayProgress(!0);
var m=G.connect(this,"_complete",this,function(){G.disconnect(m);this._displayProgress(!1)})}var k={},D;for(D in this.postData)k[D]=this.postData[D];this.flashMovie.doUpload(k)}catch(I){this._error("FileUploader - Sorry, the SWF failed to initialize."+I)}},createFlashUploader:function(){if(this.uploadUrl=this.uploadUrl.toString())if(0>this.uploadUrl.toLowerCase().indexOf("http")&&0!=this.uploadUrl.indexOf("/")){var m=window.location.href.split("/");m.pop();m=m.join("/")+"/";this.uploadUrl=m+this.uploadUrl;
this.log("SWF Fixed - Relative loc:",m," abs loc:",this.uploadUrl)}else this.log("SWF URL unmodified:",this.uploadUrl);else console.warn("Warning: no uploadUrl provided.");m={expressInstall:!0,path:this.swfPath.uri||this.swfPath,width:this.fhtml.nr.w,height:this.fhtml.nr.h,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName,uploadUrl:this.uploadUrl,uploadOnSelect:this.uploadOnChange,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.selectMultipleFiles,
id:this.id,isDebug:this.isDebug,devMode:this.devMode,flashButton:P.serialize("fh",this.fhtml),fileMask:P.serialize("fm",this.fileMask),noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new Q(m,this.insideNode);this.flashObject.onError=K.hitch(function(k){this._error("Flash Error: "+k)});this.flashObject.onReady=K.hitch(this,function(){l.set(this.insideNode,"visibility","visible");
this.log("FileUploader flash object ready");this.onReady(this)});this.flashObject.onLoad=K.hitch(this,function(k){this.flashMovie=k;this.flashReady=!0;this.onLoad(this)});this._connectFlash()},_connectFlash:function(){this._doSub("/filesSelected","_change");this._doSub("/filesUploaded","_complete");this._doSub("/filesProgress","_progress");this._doSub("/filesError","_error");this._doSub("/filesCanceled","onCancel");this._doSub("/stageBlur","_onFlashBlur");this._doSub("/up","onMouseUp");this._doSub("/down",
"onMouseDown");this._doSub("/over","onMouseOver");this._doSub("/out","onMouseOut");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&p.set(this.domNode,"tabIndex",this.tabIndex)},_doSub:function(m,k){this._subs.push(G.subscribe(this.id+m,this,k))},urlencode:function(m){return m&&"none"!=m?m.replace(/:/g,"||").replace(/\./g,"^^").replace("url(","").replace(")","").replace(/'/g,"").replace(/"/g,""):!1},isButton:function(m){m=m.tagName.toLowerCase();
return"button"==m||"input"==m},getTextStyle:function(m){var k={};k.ff=l.get(m,"fontFamily");if(k.ff){k.ff=k.ff.replace(", ",",");k.ff=k.ff.replace(/"|'/g,"");k.ff="sans-serif"==k.ff?"Arial":k.ff;k.fw=l.get(m,"fontWeight");k.fi=l.get(m,"fontStyle");k.fs=parseInt(l.get(m,"fontSize"),10);if(-1<l.get(m,"fontSize").indexOf("%"))for(var D=m;D.tagName;){if(-1==l.get(D,"fontSize").indexOf("%")){k.fs=parseInt(l.get(D,"fontSize"),10);break}"body"==D.tagName.toLowerCase()&&(k.fs=.16*parseInt(l.get(D,"fontSize"),
10));D=D.parentNode}k.fc=(new O(l.get(m,"color"))).toHex();k.fc=parseInt(k.fc.substring(1,Infinity),16)}k.lh=l.get(m,"lineHeight");k.ta=l.get(m,"textAlign");k.ta="start"!=k.ta&&k.ta?k.ta:"left";k.va=this.isButton(m)?"middle":k.lh==k.h?"middle":l.get(m,"verticalAlign");return k},getText:function(m){m=K.trim(m.innerHTML);-1<m.indexOf("\x3c")&&(m=escape(m));return m},getStyle:function(m){var k={},D=n.getContentBox(m),I=n.getPadExtents(m);k.p=[I.t,I.w-I.l,I.h-I.t,I.l];k.w=D.w+I.w;k.h=D.h+I.h;k.d=l.get(m,
"display");D=new O(l.get(m,"backgroundColor"));k.bc=0==D.a?"#ffffff":D.toHex();k.bc=parseInt(k.bc.substring(1,Infinity),16);if(D=this.urlencode(l.get(m,"backgroundImage")))k.bi={url:D,rp:l.get(m,"backgroundRepeat"),pos:escape(l.get(m,"backgroundPosition"))},k.bi.pos||(D=l.get(m,"backgroundPositionX"),I=l.get(m,"backgroundPositionY"),k.bi.pos=escape(("left"==D?"0%":"right"==D?"100%":D)+" "+("top"==I?"0%":"bottom"==I?"100%":I)));return K.mixin(k,this.getTextStyle(m))},getTempNodeStyle:function(m,k,
D){if(D){D=y.place("\x3c"+m.tagName+"\x3e\x3cspan\x3e"+m.innerHTML+"\x3c/span\x3e\x3c/"+m.tagName+"\x3e",m.parentNode);var I=D.firstChild;t.add(I,m.className);t.add(D,k);m=this.getStyle(I)}else D=y.place("\x3c"+m.tagName+"\x3e"+m.innerHTML+"\x3c/"+m.tagName+"\x3e",m.parentNode),t.add(D,m.className),t.add(D,k),D.id=m.id,m=this.getStyle(D);y.destroy(D);return m}})})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(u,E,K,H,G,c,d,f,h,l,n,p,t){K.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");c=t._iframeName;c=c.substring(0,c.lastIndexOf("_"));var y=H.delegate(t,{create:function(){return y._frame=t.create.apply(t,arguments)},get:null,post:null,send:function(z){var b=G._ioSetArgs(z,function(B){r&&r.cancel()},function(B){var F=null;B=B.ioArgs;try{var Q=B.handleAs;"xml"===Q||"html"===Q?F=r.response.data:(F=r.response.text,"json"===Q?F=E.fromJson(F):"javascript"===Q&&(F=K.eval(F)))}catch(P){F=
P}return F},function(B,F){F.ioArgs._hasError=!0;return B}),g=b.ioArgs,A="GET",O=f.byId(z.form);z.method&&"POST"===z.method.toUpperCase()&&O&&(A="POST");z={method:A,handleAs:"json"===z.handleAs||"javascript"===z.handleAs?"text":z.handleAs,form:z.form,query:O?null:z.content,data:O?z.content:null,timeout:z.timeout,ioArgs:g};z.method&&(z.method=z.method.toUpperCase());if(u.ioPublish&&K.publish&&!1!==g.args.ioPublish)var q=p.after(t,"_notifyStart",function(B){B.options.ioArgs===g&&(q.remove(),G._ioNotifyStart(b))},
!0);var r=t(g.url,z,!0);g._callNext=r._callNext;r.then(function(){b.resolve(b)}).otherwise(function(B){b.ioArgs.error=B;b.reject(B)});return b},_iframeOnload:d.global[c+"_onload"]});H.setObject("dojo.io.iframe",y);return y})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),function(u,E,K,H,G,c,d,f,h){function l(b){b=u.delegate(p,b);if(!("path"in b))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),
null;"id"in b||(b.id="dojox-embed-flash-"+n++);return b}var n=0,p={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};if(G("ie")){var t=function(b){b=l(b);if(!b)return null;var g,A=b.path;if(b.vars){var O=[];for(g in b.vars)O.push(encodeURIComponent(g)+"\x3d"+encodeURIComponent(b.vars[g]));b.params.FlashVars=O.join("\x26");delete b.vars}A='\x3cobject id\x3d"'+h.escape(String(b.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+
h.escape(String(b.width))+'" height\x3d"'+h.escape(String(b.height))+'"'+(b.style?' style\x3d"'+h.escape(String(b.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+h.escape(String(A))+'" /\x3e';if(b.params)for(g in b.params)A+='\x3cparam name\x3d"'+h.escape(g)+'" value\x3d"'+h.escape(String(b.params[g]))+'" /\x3e';return{id:b.id,markup:A+"\x3c/object\x3e"}};var y=function(){for(var b=10,g=null;!g&&7<b;)try{g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b--)}catch(A){}return g?(b=g.GetVariable("$version").split(" ")[1].split(","),
{major:null!=b[0]?parseInt(b[0]):0,minor:null!=b[1]?parseInt(b[1]):0,rev:null!=b[2]?parseInt(b[2]):0}):{major:0,minor:0,rev:0}}();E.addOnWindowUnload(function(){console.warn("***************UNLOAD");var b=function(){};H("object").reverse().style("display","none").forEach(function(g){for(var A in g)if("FlashVars"!=A&&"function"==typeof g[A])try{g[A]=b}catch(O){}})})}else t=function(b){b=l(b);if(!b)return null;var g,A=b.path;if(b.vars){var O=[];for(g in b.vars)O.push(encodeURIComponent(g)+"\x3d"+encodeURIComponent(b.vars[g]));
b.params.flashVars=O.join("\x26");delete b.vars}A='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+h.escape(String(A))+'" id\x3d"'+h.escape(String(b.id))+'" width\x3d"'+h.escape(String(b.width))+'" height\x3d"'+h.escape(String(b.height))+'"'+(b.style?' style\x3d"'+h.escape(String(b.style))+'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(b.params)for(g in b.params)A+=" "+h.escape(g)+'\x3d"'+h.escape(String(b.params[g]))+'"';return{id:b.id,markup:A+
" /\x3e"}},y=function(){var b=navigator.plugins["Shockwave Flash"];return b&&b.description?(b=b.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=b[0]?parseInt(b[0]):0,minor:null!=b[1]?parseInt(b[1]):0,rev:null!=b[2]?parseInt(b[2]):0}):{major:0,minor:0,rev:0}}();var z=function(b,g){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
this.available=y.major;this.minimumVersion=b.minimumVersion||9;this.domNode=this.movie=this.id=null;g&&(g=c.byId(g));setTimeout(u.hitch(this,function(){if(b.expressInstall||this.available&&this.available>=this.minimumVersion)if(b&&g)this.init(b,g);else this.onError("embed.Flash was not provided with the proper arguments.");else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),
100)};u.extend(z,{onReady:function(b){},onLoad:function(b){},onError:function(b){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(b,g){this.destroy();g=c.byId(g||this.domNode);if(!g)throw Error("dojox.embed.Flash: no domNode reference has been passed.");var A=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;z.initialized&&(this.id=z.place(b,g),this.domNode=g,setTimeout(u.hitch(this,
function(){this.movie=this.byId(this.id,b.doc);this.onReady(this.movie);this._poller=setInterval(u.hitch(this,function(){try{A=this.movie.PercentLoaded()}catch(O){console.warn("this.movie.PercentLoaded() failed",O,this.movie)}if(100==A)this._onload();else if(0==A&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(b){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var b=
u.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),g;for(g in this)b[g]||delete this[g];this._poller?d(this,"Load",this,"_destroy"):this._destroy()}},byId:function(b,g){g=g||document;return g.embeds[b]?g.embeds[b]:g[b]?g[b]:window[b]?window[b]:document[b]?document[b]:null}});u.mixin(z,{minSupported:8,available:y.major,supported:y.major>=y.required,minimumRequired:y.required,version:y,initialized:!1,onInitialize:function(){z.initialized=!0},__ie_markup__:function(b){return t(b)},proxy:function(b,
g){K.forEach(g instanceof Array?g:[g],function(A){this[A]=u.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+A+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+K.map(arguments,function(O){return __flash__toXML(O)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,arguments||[])})},b)}});z.place=function(b,g){b=t(b);g=c.byId(g);g||(g=f.doc.createElement("div"),g.id=b.id+"-container",f.body().appendChild(g));return b?(g.innerHTML=b.markup,
b.id):null};z.onInitialize();u.setObject("dojox.embed.Flash",z);return z})},"dojox/embed/flashVars":function(){define(["dojo"],function(u){u.deprecated("dojox.embed.flashVars","Will be removed in 2.0","2.0");var E={serialize:function(K,H){var G=function(h){"string"==typeof h&&(h=h.replace(/;/g,"_sc_"),h=h.replace(/\./g,"_pr_"),h=h.replace(/:/g,"_cl_"));return h},c=dojox.embed.flashVars.serialize,d="";if(u.isArray(H)){for(var f=0;f<H.length;f++)d+=c(K+"."+f,G(H[f]))+";";return d.replace(/;{2,}/g,";")}if(u.isObject(H)){for(f in H)d+=
c(K+"."+f,G(H[f]))+";";return d.replace(/;{2,}/g,";")}return K+":"+H}};u.setObject("dojox.embed.flashVars",E);return E})},"dojox/html/styles":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(u,E,K,H){var G=u.getObject("dojox.html",!0),c={},d={},f=[];G.insertCssRule=function(h,l,n){n=G.getDynamicStyleSheet(n);var p=h+" {"+l+"}";console.log("insertRule:",p);H("ie")?(n.cssText+=p,console.log("ss.cssText:",n.cssText)):n.sheet?n.sheet.insertRule(p,
n._indicies.length):n.appendChild(K.doc.createTextNode(p));n._indicies.push(h+" "+l);return h};G.removeCssRule=function(h,l,n){var p=-1,t,y;for(t in c)if(!n||n===t){var z=c[t];for(y=0;y<z._indicies.length;y++)if(h+" "+l===z._indicies[y]){p=y;break}if(-1<p)break}if(!z)return console.warn("No dynamic style sheet has been created from which to remove a rule."),!1;if(-1===p)return console.warn("The css rule was not found and could not be removed."),!1;z._indicies.splice(p,1);H("ie")?z.removeRule(p):z.sheet&&
z.sheet.deleteRule(p);return!0};G.modifyCssRule=function(h,l,n){};G.getStyleSheet=function(h){if(c[h||"default"])return c[h||"default"];if(!h)return!1;var l=G.getStyleSheets();if(l[h])return G.getStyleSheets()[h];for(var n in l)if(l[n].href&&-1<l[n].href.indexOf(h))return l[n];return!1};G.getDynamicStyleSheet=function(h){h||(h="default");c[h]||(K.doc.createStyleSheet?(c[h]=K.doc.createStyleSheet(),9>H("ie")&&(c[h].title=h)):(c[h]=K.doc.createElement("style"),c[h].setAttribute("type","text/css"),K.doc.getElementsByTagName("head")[0].appendChild(c[h]),
console.log(h," ss created: ",c[h].sheet)),c[h]._indicies=[]);return c[h]};G.enableStyleSheet=function(h){if(h=G.getStyleSheet(h))h.sheet?h.sheet.disabled=!1:h.disabled=!1};G.disableStyleSheet=function(h){if(h=G.getStyleSheet(h))h.sheet?h.sheet.disabled=!0:h.disabled=!0};G.activeStyleSheet=function(h){var l=G.getToggledStyleSheets(),n;if(1===arguments.length)E.forEach(l,function(p){p.disabled=p.title===h?!1:!0});else for(n=0;n<l.length;n++)if(!1===l[n].disabled)return l[n];return!0};G.getPreferredStyleSheet=
function(){};G.getToggledStyleSheets=function(){var h;if(!f.length){var l=G.getStyleSheets();for(h in l)l[h].title&&f.push(l[h])}return f};G.getStyleSheets=function(){if(d.collected)return d;E.forEach(K.doc.styleSheets,function(h){var l=h.sheet?h.sheet:h;h=l.title||l.href;if(H("ie"))-1===l.cssText.indexOf("#default#VML")&&(l.href?d[h]=l:l.imports.length?E.forEach(l.imports,function(n){d[n.title||n.href]=n}):d[h]=l);else{d[h]=l;d[h].id=l.ownerNode.id;h=[];try{h=l[l.cssRules?"cssRules":"rules"]}catch(n){console.warn("Reading css rules from stylesheet "+
l.href+" is forbidden due to same-origin policy. See http://www.w3.org/TR/CSP/#cascading-style-sheet-css-parsing",l)}E.forEach(h,function(n){n.href&&(d[n.href]=n.styleSheet,d[n.href].id=l.ownerNode.id)})}});d.collected=!0;return d};return G})},"widgets/GroupFilter/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/GroupFilter/setting/presetValuePicker.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e\x3ch3\x3e${nls.picker.description}\x3c/h3\x3e\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n\t\x3ctable width\x3d"100%" cellpadding\x3d"2" cellspacing\x3d"2"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d"picker-cell"\x3e\r\n\t\t\t\t${nls.picker.layer}\x3cbr\x3e\r\n\t\t\t\t\x3cdiv class\x3d"" data-dojo-attach-point\x3d"layerLevel"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d"picker-cell"\x3e\r\n\t\t\t\t${nls.picker.field}\x3cbr\x3e\r\n\t\t\t\t\x3cdiv class\x3d"" data-dojo-attach-point\x3d"fieldLevel"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d"picker-cell"\x3e\r\n\t\t\t\t${nls.picker.value}\x3cbr\x3e\r\n\t\t\t\t\x3cdiv class\x3d"value-level" data-dojo-attach-point\x3d"valueLevel"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:widgets/GroupFilter/setting/Setting.html":'\x3cdiv\x3e\r\n\t\x3clabel\x3e${nls.configText}\x3c/label\x3e\r\n\t\x3cdiv class\x3d"widget-intro" data-dojo-attach-point\x3d"widgetIntro"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"layer-Mapping-Block" data-dojo-attach-point\x3d"layerMappingBlock" id\x3d"layerMappingBlock"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"jimu-btn layer-Mapping-Block-add" data-dojo-attach-point\x3d"layerMappingBlockAdd" data-dojo-attach-event\x3d"click:createGroupBlock" title\x3d"${nls.buttons.addNewGroupTip}"\x3e${nls.buttons.addNewGroup}\x3c/div\x3e\r\n  \x3chr\x3e\r\n\r\n  \x3clabel\x3e${nls.labels.headerTextHelp}\x3c/label\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"editorDescription"\x3e\x3c/div\x3e\r\n  \x3chr\x3e\r\n\r\n\t\x3cdiv\x3e\r\n\t\t\x3ctable width\x3d"98%"\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkSimpleMode" data-dojo-props\x3d"value:true,checked:false"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.simpleModeTip}"\x3e${nls.inputs.simpleMode}\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkOptionsMode" data-dojo-props\x3d"value:true,checked:false"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.optionsModeTip}"\x3e${nls.inputs.optionsMode}\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkWebmapAppendMode" data-dojo-props\x3d"value:true,checked:true"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.webmapAppendModeTip}"\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"slAppendChoice" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\t\t\t    \x3coption value\x3d"OR"\x3e${nls.inputs.webmapAppendModeAny}\x3c/option\x3e\r\n\t\t\t\t\t    \x3coption value\x3d"AND"\x3e${nls.inputs.webmapAppendModeAll}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkZoomMode" data-dojo-props\x3d"value:true,checked:true"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.tables.zoomTip}"\x3e${nls.tables.zoomTo}\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkPersistOnClose" data-dojo-props\x3d"value:true,checked:false"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.persistOnClose}"\x3e${nls.inputs.persistOnClose}\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkHideDropdown" data-dojo-props\x3d"value:true,checked:false"/\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd title\x3d"${nls.inputs.hideDropDownTip}"\x3e${nls.inputs.hideDropDown}\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/GroupFilter/setting/css/style.css":'.jimu-widget-map-filter input{margin-left: 0;}.jimu-widget-map-filter .group-block {background-color: #FFFFFF; border-color: #e1e1e1; border-style: solid; border-width: 2px; border-radius: 5px; width: 100%; position: relative; margin-top: 10px;}.jimu-widget-map-filter .layer-Mapping-Block-add {margin-top: 10px; margin-bottom: 5px;}.jimu-widget-map-filter .group-setting-table {width: 100%; margin-left: 10px;}.jimu-widget-map-filter .group-block-item {position: relative; width: 90%;}.jimu-widget-map-filter .group-block-delete{padding-left: 10px; padding-right: 10px; cursor: pointer; cursor: hand; content: url("../../images/delete.png");}.jimu-widget-map-filter .group-block-delete:after{padding-left: 10px; padding-right: 10px; cursor: pointer; cursor: hand; content: url("../../images/delete.png");}.jimu-widget-map-filter .group-block-delete:hover{padding-left: 10px; padding-right: 10px; cursor: pointer; cursor: hand; content: url("../../images/delete_hover.png");}.jimu-widget-map-filter .group-block-layer-select {}.jimu-widget-map-filter .group-block-field-select {position: absolute; right: 0px; top: 0px;}.jimu-widget-map-filter .group-block-add-layer {margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px;}.jimu-widget-map-filter .groupName-textbox {margin-top: 5px; margin-bottom: 5px; margin-left: 0px; margin-right: 0px; width: 175px;}.jimu-widget-map-filter .groupName-Desctextbox {margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px; width: 400px;}.jimu-widget-map-filter .groupName-Defaulttextbox {margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px; width: 400px;}.jimu-widget-map-filter .groupName-defaultPicker {padding-left: 10px; padding-right: 10px; content: url("../../images/find.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .groupName-defaultPicker:after {padding-left: 10px; padding-right: 10px; content: url("../../images/find.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .layer-tables {margin-top: 5px; margin-bottom: 5px; width: 98%; margin-left: 10px;}.jimu-widget-map-filter .operator-select {font-size: 8pt;}.jimu-widget-map-filter .operator-append-select {font-size: 8pt; margin-top: 5px; margin-bottom: 5px; margin-left: 10px; margin-right: 10px;}.jimu-widget-map-filter-preset .picker-cell {padding-bottom: 15px;}.jimu-widget-map-filter-preset .value-level{margin-left: -3px; margin-right: -3px;}',
"*now":function(u){u(['dojo/i18n!*preload*widgets/GroupFilter/setting/nls/Setting*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin jimu/dijit/SimpleTable dojo/dom dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/dom-attr dojo/_base/lang dojo/_base/array dijit/form/Select dijit/form/TextBox dijit/form/ValidationTextBox dijit/form/CheckBox dijit/Editor jimu/utils jimu/LayerInfos/LayerInfos jimu/dijit/Message jimu/dijit/Popup dojox/html/entities ../LayersHandler ./presetValuePicker jimu/dijit/EditorXssFilter dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/ViewSource dijit/_editor/plugins/FontChoice dojox/editor/plugins/Preview dijit/_editor/plugins/TextColor dojox/editor/plugins/ToolbarLineBreak dojox/editor/plugins/FindReplace dojox/editor/plugins/PasteFromWord dojox/editor/plugins/InsertAnchor dojox/editor/plugins/Blockquote dojox/editor/plugins/UploadImage".split(" "),function(u,
E,K,H,G,c,d,f,h,l,n,p,t,y,z,b,g,A,O,q,r,B,F,Q,P){return u([E,K],{baseClass:"jimu-widget-map-filter",groupCounter:0,groupLayerContainer:[],groupLayerName:[],groupLayerDesc:[],groupLayerOperator:[],groupLayerDefault:[],groupAppendSameConjunc:[],groupCaseSearch:[],layerCounter:0,layerList:null,_editorObj:null,postMixInProperties:function(){this.nls=n.mixin(this.nls,window.jimuNls.common);this.nls=n.mixin(this.nls,window.jimuNls.spatialFilterByFeatures)},postCreate:function(){this.inherited(arguments);
this.editorXssFilter=P.getInstance()},startup:function(){this.inherited(arguments);this.setConfig(this.config)},setConfig:function(C){this.config=C;this.groupLayerContainer=[];this.groupLayerName=[];this.groupLayerDesc=[];this.groupLayerOperator=[];this.groupLayerDefault=[];this.groupAppendSameConjunc=[];this.groupCaseSearch=[];this.chkSimpleMode.set("checked",this.config.simpleMode);this.chkOptionsMode.set("checked",this.config.optionsMode);this.chkWebmapAppendMode.set("checked",this.config.webmapAppendMode);
this.slAppendChoice.set("value",this.config.slAppendChoice);this.chkZoomMode.set("checked",this.config.zoomMode);this.chkPersistOnClose.set("checked",this.config.persistOnClose);this.chkHideDropdown.set("checked",this.config.hideHeaderSelection);this.createMapLayerList();this.createHeaderEditor()},getConfig:function(){if(null===this.layerList)return new q({message:this.nls.errors.noLayers}),!1;if(0<this.layerList.length){var C=this.validateNoGroups(),m=this.validateNoGroupsName(),k=this.validateDuplicateGroupsName(),
D=this.validateTableRows();return C&&m&&k&&D?(this.config.simpleMode=this.chkSimpleMode.checked,this.config.optionsMode=this.chkOptionsMode.checked,this.config.webmapAppendMode=this.chkWebmapAppendMode.checked,this.config.slAppendChoice=this.slAppendChoice.get("value"),this.config.zoomMode=this.chkZoomMode.checked,this.config.persistOnClose=this.chkPersistOnClose.checked,this.config.headerText=this.editorXssFilter.sanitize(this._editorObj.get("value")),this.config.hideHeaderSelection=this.chkHideDropdown.checked,
this.config.groups=[],p.forEach(this.groupLayerName,n.hitch(this,function(I,a){if(null!==I&&null!==this.groupLayerContainer[a]){var e={};e.name=A.sanitizeHTML(I.value);e.desc=A.sanitizeHTML(this.groupLayerDesc[a].value);e.operator=A.sanitizeHTML(this.groupLayerOperator[a].value);e.defaultVal=A.sanitizeHTML(this.groupLayerDefault[a].value);e.appendSameLayer=!0;e.appendSameLayerConjunc=this.groupAppendSameConjunc[a].value;e.caseSearch=this.groupCaseSearch[a].get("checked");e.layers=[];p.forEach(this.groupLayerContainer[a].getRows(),
n.hitch(this,function(v){var x={},w=v.cells[2].childNodes[0];x.layer=v.layerCol.value;x.field=v.fieldCol.value;x.dataType=v.dataTypeCol.attr("displayedValue");x.useDomain=w.checked?w.checked:"";e.layers.push(x)}));this.config.groups.push(e)}})),this.config):!1}new q({message:this.nls.errors.noLayers});return!1},createMapLayerList:function(){O.getInstance(this.map,this.map.itemInfo).then(n.hitch(this,function(C){C._layerInfos&&0<C._layerInfos.length&&(C=new F({layers:C._layerInfos}),this.own(f(C,"complete",
n.hitch(this,function(m){this.layerList=m.data.items;0<this.config.groups.length?p.forEach(this.config.groups,n.hitch(this,function(k){this.createGroupBlock({group:k})})):this.createGroupBlock({group:null})}))),this.own(f(C,"error",n.hitch(this,function(){console.log("error")}))),C.getAllMapLayers())}))},createGroupBlock:function(C){this.groupCounter++;var m=c.create("div",{id:"grpDiv_"+this.groupCounter,"class":"group-block"});c.place(m,this.layerMappingBlock);var k=c.create("table",{"class":"group-setting-table"});
c.place(k,m);var D=k.insertRow(-1),I=D.insertCell(0);l.set(I,"title",this.nls.labels.groupNameTip);var a=D.insertCell(1),e=D.insertCell(2);l.set(e,"title",this.nls.labels.groupDescTip);m=D.insertCell(3);D=D.insertCell(4);var v=k.insertRow(-1),x=v.insertCell(0);l.set(x,"title",this.nls.labels.groupOperatorTip);var w=v.insertCell(1),N=v.insertCell(2);l.set(N,"title",this.nls.labels.groupDefaultTip);var J=v.insertCell(3);v=v.insertCell(4);var L=k.insertRow(-1),M=L.insertCell(0);l.set(M,"colspan","3");
var S=L.insertCell(1);L.insertCell(2);l.set(L,"id","appendLayers_"+this.groupCounter);L=k.insertRow(-1);var R=L.insertCell(0);l.set(R,"colspan","3");k=L.insertCell(1);L.insertCell(2);l.set(L,"id","caseSearch_"+this.groupCounter);I.innerHTML=this.nls.labels.groupName;e.innerHTML=this.nls.labels.groupDesc;x.innerHTML=this.nls.labels.groupOperator;N.innerHTML=this.nls.labels.groupDefault;M.innerHTML=this.nls.labels.sameLayerAppend;R.innerHTML=this.nls.labels.caseSearch;e=N=I=M=L="";x=!1;"undefined"!==
typeof C.group&&null!==C.group&&(L=C.group.name,M=C.group.desc,I=C.group.operator,N=C.group.defaultVal,"undefined"!==typeof C.group.appendSameLayerConjunc&&(e=C.group.appendSameLayerConjunc),"undefined"!==typeof C.group.caseSearch&&(x=C.group.caseSearch));L=new z({name:"txtGroupName",value:L,"class":"groupName-textbox",placeHolder:this.nls.inputs.groupName,required:"true"});c.place(L.domNode,a);this.groupLayerName.push(L);a=new y({name:"txtGroupDesc",value:M,"class":"groupName-Desctextbox",placeHolder:this.nls.inputs.groupDesc});
c.place(a.domNode,m);this.groupLayerDesc.push(a);var T=new y({name:"txtGroupDefault",value:N,"class":"groupName-Defaulttextbox",placeHolder:this.nls.inputs.groupDefault});c.place(T.domNode,J);this.groupLayerDefault.push(T);m=c.create("div",{"class":"groupName-defaultPicker"});c.place(m,v);this.own(f(m,"click",n.hitch(this,function(){this.presetPickerPopup(T)})));var U=c.create("div",{id:"addGroupDelete_"+this.groupCounter,"class":"group-block-delete"}),W=f(U,"click",n.hitch(this,function(){W.remove();
this.removeGroup(U.id)}));c.place(U,D);this.createOperatorSelection({cell:w,value:I});this.createAppendConjunc({cell:S,value:e});this.createCaseSearch({cell:k,value:x});this.createTableObject(C);var V=c.create("div",{id:"addLyrDiv_"+this.groupCounter,"class":"jimu-btn group-block-add-layer",title:this.nls.buttons.addLayerTip});this.own(f(V,"click",n.hitch(this,function(){this.addLayerRow(V.id)})));c.place(V,G.byId("grpDiv_"+this.groupCounter));G.byId("addLyrDiv_"+this.groupCounter).innerHTML=this.nls.buttons.addLayer},
createOperatorSelection:function(C){var m=(new t({options:[{value:"",label:this.nls.inputs.optionNONE},{value:"\x3d",label:this.nls.inputs.optionEQUAL},{value:"\x3c\x3e",label:this.nls.inputs.optionNOTEQUAL},{value:"\x3e",label:this.nls.inputs.optionGREATERTHAN},{value:"\x3e\x3d",label:this.nls.inputs.optionGREATERTHANEQUAL},{value:"\x3c",label:this.nls.inputs.optionLESSTHAN},{value:"\x3c\x3d",label:this.nls.inputs.optionLESSTHANEQUAL},{value:"START",label:this.nls.inputs.optionSTART},{value:"END",
label:this.nls.inputs.optionEND},{value:"LIKE",label:this.nls.inputs.optionLIKE},{value:"NOT LIKE",label:this.nls.inputs.optionNOTLIKE},{value:"d\x3c\x3d",label:this.nls.inputs.optionONORBEFORE},{value:"d\x3e\x3d",label:this.nls.inputs.optionONORAFTER}],"class":"operator-select"})).placeAt(C.cell);m.startup();m.set("value",B.decode(C.value));this.groupLayerOperator.push(m)},createAppendConjunc:function(C){var m=(new t({options:[{value:"OR",label:this.nls.inputs.sameLayerAny},{value:"AND",label:this.nls.inputs.sameLayerAll}],
"class":"operator-append-select"})).placeAt(C.cell);m.startup();m.set("value",B.decode(C.value));this.groupAppendSameConjunc.push(m)},createCaseSearch:function(C){var m=(new b({"class":"operator-append-select"})).placeAt(C.cell);m.startup();m.set("checked",C.value);this.groupCaseSearch.push(m)},createTableObject:function(C){var m=null;m=[{name:"layerCol",title:this.nls.tables.layer,"class":"label",type:"empty",width:"375px"},{name:"fieldCol",title:this.nls.tables.field,"class":"label",type:"empty",
width:"350px"},{name:"domainCol",title:this.nls.tables.value,"class":"label",type:"radio",width:"100px"},{name:"actions",title:this.nls.tables.action,type:"actions",actions:["delete"],width:"100px"},{name:"dataTypeCol",type:"empty",hidden:!0,width:0}];m=new H({fields:m,"class":"layer-tables"});m.placeAt(G.byId("grpDiv_"+this.groupCounter));this.groupLayerContainer.push(m);"undefined"!==typeof C.group&&null!==C.group?p.forEach(C.group.layers,n.hitch(this,function(k){this.addLayerRow(G.byId("grpDiv_"+
this.groupCounter).id,k)})):this.addLayerRow(G.byId("grpDiv_"+this.groupCounter).id,C)},addLayerRow:function(C,m){C=C.substring(C.indexOf("_")+1);var k=this.groupLayerContainer[C-1].addRow({});if(k.success&&k.tr){k=k.tr;this.createLayerSelection(k,m,C);var D=k.cells[2].childNodes[0],I=D.checked;this.own(f(D,"click",n.hitch(this,function(){I=I?D.checked=!1:D.checked=!0})))}},createLayerSelection:function(C,m,k){var D=[];p.forEach(this.layerList,n.hitch(this,function(e){if(0<e.children.length)p.forEach(e.children,
n.hitch(this,function(x){var w={};w.value=x.id;w.label=x.label;w.selected=!1;D.push(w)}));else{var v={};v.value=e.id;v.label=e.label;v.selected=!1;D.push(v)}}));var I=h(".simple-table-cell",C)[0];if(I){var a=(new t({options:D})).placeAt(I);a.startup();C.layerCol=a;this.own(f(a,"change",n.hitch(this,function(e){this.createFieldSelection(e,C,m,k)})));"undefined"!==typeof m&&a.set("value",m.layer)}this.createFieldSelection(a.value,C,m,k)},createFieldSelection:function(C,m,k,D){var I=[],a=[];p.forEach(this.layerList,
n.hitch(this,function(w){0<w.children.length?p.forEach(w.children,n.hitch(this,function(N){N.id===C&&p.forEach(N.children,n.hitch(this,function(J){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(J.fieldType)){var L={};L.value=J.name;L.label=J.label;L.selected=!1;I.push(L);L={};L.value=J.name;L.label=J.fieldType;L.selected=!1;a.push(L)}}))})):w.id===C&&p.forEach(w.layer.fields,n.hitch(this,function(N){if(-1==="esriFieldTypeBlob,esriFieldTypeOID".indexOf(N.type)){var J={};J.value=N.name;J.label=
""===N.alias?N.name:N.alias;J.selected=!1;I.push(J);J={};J.value=N.name;J.label=N.type;J.selected=!1;a.push(J)}}))}));var e=h(".simple-table-cell",m)[1],v=h(".simple-table-cell",m)[4];if(e){c.empty(e);e=(new t({options:I})).placeAt(e);e.startup();m.fieldCol=e;c.empty(v);var x=(new t({options:a})).placeAt(v);x.startup();m.dataTypeCol=x;this.own(f(e,"change",n.hitch(this,function(w){this.resetRadio({layer:C,field:w,row:m,param:k,counter:D});this.dataTypeSync({layer:C,field:w,row:m,param:k,select:x})})));
"undefined"!==typeof k&&(this.resetRadio({layer:C,row:m,param:k,counter:D}),e.set("value",k.field),x.set("value",k.field))}},createHeaderEditor:function(){this._editorObj=new g({height:"100px",plugins:"bold italic underline foreColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent".split(" "),extraPlugins:["|","createLink","unlink","pastefromword","|","undo","redo","|","toolbarlinebreak",{name:"dijit._editor.plugins.FontChoice",command:"fontName",
custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize","formatBlock"],style:"font-family:Verdana;"},this.editorDescription);this._editorObj.startup();this.config.hasOwnProperty("headerText")?this._editorObj.set("value",this.config.hasOwnProperty("headerText")?this.config.headerText:this.nls.inputs.selectGroup):this._editorObj.set("value",this.nls.inputs.selectGroup)},dataTypeSync:function(C){C.select.set("value",C.field)},resetRadio:function(C){var m=
C.row.cells[2].childNodes[0];"undefined"!==typeof C.param&&(C.param.hasOwnProperty("useDomain")?m.checked=""!==C.param.useDomain?!0:!1:m.checked=!1)},validateNoGroups:function(){var C=!1,m=this.nls.errors.noGroups;p.forEach(this.groupLayerName,n.hitch(this,function(k){null!==k&&(C=!0)}));if(C)return!0;new q({message:m});return!1},validateNoGroupsName:function(){var C=!0,m=this.nls.errors.noGroupName;p.forEach(this.groupLayerName,n.hitch(this,function(k){null!==k&&(k.get("value")||(C=!1))}));!1===
C&&new q({message:m});return C},validateDuplicateGroupsName:function(){var C=!0,m=this.nls.errors.noDuplicates,k=[];p.forEach(this.groupLayerName,n.hitch(this,function(D){null!==D&&D.get("value")&&k.push(D.get("value"))}));1<k.length&&k.sort().filter(function(D,I,a){return D!==a[I-1]}).length!==k.length&&(C=!1);!1===C&&new q({message:m});return C},validateTableRows:function(){var C=!0;p.forEach(this.groupLayerContainer,n.hitch(this,function(m){null!==m&&0>=m.getRows().length&&(C=!1)}));!1===C&&new q({message:this.nls.errors.noRows});
return C},presetPickerPopup:function(C){var m=new Q({map:this.map,nls:this.nls,layerList:this.layerList}),k=new r({titleLabel:this.nls.popupHeader.label,width:500,height:420,content:m,buttons:[{label:window.jimuNls.common.ok,onClick:n.hitch(this,function(){var D="";if("undefined"!==typeof m.valueParam&&null!==m.valueParam.getFilterExpr()){var I=m.valueParam.getValueProviders()[0].getValueObject();I&&(D=I.value);C.set("value",D)}k.close();k=null})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"]}]})},
removeGroup:function(C){C=C.substring(C.indexOf("_")+1);this.groupLayerContainer[C-1]=null;this.groupLayerName[C-1]=null;this.groupLayerDesc[C-1]=null;this.groupLayerOperator[C-1]=null;this.groupLayerDefault[C-1]=null;this.groupAppendSameConjunc[C-1]=null;c.destroy(G.byId("addGroupDelete_"+C));c.destroy(G.byId("addLyrDiv_"+C));c.destroy(G.byId("grpDiv_"+C))}})});