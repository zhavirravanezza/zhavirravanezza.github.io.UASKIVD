// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),function(P,J,D,Q,e,v){var m=null,l=P([D,e],{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new v({whiteList:this.whiteList,safeAttrValue:Q.hitch(this,
function(t,q,z,x){return"style"===q?this.xss.friendlyAttrValue(z).replace(/"/g,"'"):"img"===t&&"src"===q?this.xss.escapeAttrValue(z):this.xss.safeAttrValue(t,q,z,x)}),onTag:Q.hitch(this,function(t,q,z){if(z.isWhite&&this._isInWhiteList(t,this.graphicsWhiteList))return q}),onIgnoreTagAttr:Q.hitch(this,function(t,q,z,x){if("data-"===q.substr(0,5))return q+'\x3d"'+this.xss.escapeAttrValue(z)+'"'}),onIgnoreTag:Q.hitch(this,function(t,q,z){if("o:"===t.substr(0,2)||"!--[if"===t||"!--[endif]--"===t)return q})},
!0);this.xss=this.sanitizer.xss},sanitize:function(t){return this.sanitizer.sanitize(t)},_getWhiteList:function(){var t="title height width class style font-family id align text-align".split(" "),q={div:t,h1:t,h2:t,h3:t,h4:t,h5:t,h6:t,span:t,p:t,s:t,strong:t,em:t,u:t,ol:t,ul:t,li:t,a:["href","target"].concat(t),img:["src","alt","border"].concat(t),blockquote:t,font:["face","size","color"].concat(t),pre:t,code:t,b:t,i:t,wbr:t,video:"autoplay controls loop muted poster preload".split(" ").concat(t),
audio:["autoplay","controls","loop","muted","preload"].concat(t),source:["media","src","type"].concat(t),table:["cellpadding","cellspacing","border"].concat(t),tbody:[].concat(t),tr:["valign"].concat(t),td:["valign","colspan","rowspan","nowrap"].concat(t),th:["valign","colspan","rowspan","nowrap"].concat(t),hr:t,html:t,title:t,link:["rel","href"],style:["type"].concat(t),body:t};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],
desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],feFuncA:[],feFuncB:[],feFuncG:[],feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],
mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],textPath:[],title:[],tspan:[],use:[],view:[],object:[],canvas:t};return this._extendObjectOfArrays([q,{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],
blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align",
"valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},_extendObjectOfArrays:function(t){var q={};J.forEach(t,function(z){var x=Object.keys(z);J.forEach(x,function(u){Array.isArray(z[u])&&Array.isArray(q[u])?q[u]=q[u].concat(z[u]):
q[u]=z[u]},this)},this);return q},_isInWhiteList:function(t,q){q=Object.keys(q);var z=!1;J.forEach(q,function(x){t===x&&(z=!0)},this);return z}});l.getInstance=function(){null===m&&(m=new l);return m};return l})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(P,J,D,Q,e,v,m,l,t,q,z,x,u,p,H,f,r,y,V,N,Z,W,k){P=P(x,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(g){this._jobUpdateHandler=J.hitch(this,this._jobUpdateHandler);this._getJobStatus=J.hitch(this,this._getJobStatus);this._getResultDataHandler=
J.hitch(this,this._getResultDataHandler);this._getResultImageHandler=J.hitch(this,this._getResultImageHandler);this._executeHandler=J.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(g){this.updateDelay=g},setProcessSpatialReference:function(g){this.processSpatialReference=g},setOutputSpatialReference:function(g){this._setOutSR(g)},setOutSpatialReference:function(g){this._setOutSR(g)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(g){this.outSpatialReference=this.outputSpatialReference=g},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(g,I,F){for(var S in g){var w=g[S];J.isArray(w)?g[S]=e.toJson(D.map(w,function(R){return this._gpEncode({item:R},!0).item},this)):w instanceof Date&&(g[S]=w.getTime())}return this._encode(g,I,F)},_decode:function(g){var I=g.dataType,
F=new N(g);if(-1!==D.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],I))return F;if("GPLinearUnit"===I)F.value=new f(F.value);else if("GPFeatureRecordSetLayer"===I||"GPRecordSet"===I)F.value=new u(F.value);else if("GPDataFile"===I)F.value=new r(F.value);else if("GPDate"===I)g=F.value,J.isString(g)?F.value=new V({date:g}):F.value=new Date(g);else if("GPRasterData"===I||"GPRasterDataLayer"===I)g=g.value.mapImage,F.value=g?new k(g):new y(F.value);else if(-1!==I.indexOf("GPMultiValue:")){var S=I.split(":")[1];
g=F.value;F.value=D.map(g,function(w){return this._decode({paramName:"_name",dataType:S,value:w}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+F.dataType),F=null;return F},submitJob:function(g,I,F,S,w){var R=this._getOutSR(),T=w.assembly;g=this._gpEncode(J.mixin({},this._url.query,{f:"json","env:outSR":R?R.wkid||e.toJson(R.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||e.toJson(this.processSpatialReference.toJson()):
null},g),null,T&&T[0]);var c=this._jobUpdateHandler,n=this._errorHandler;return t({url:this._url.path+"/submitJob",content:g,callbackParamName:"callback",load:function(C,O){c(C,O,!1,I,F,w.dfd)},error:function(C){n(C,S,w.dfd)}})},_jobUpdateHandler:function(g,I,F,S,w,R){var T=g.jobId;I=new p(g);this._successHandler([I],"onStatusUpdate",w,F&&R);if(!F)switch(clearTimeout(this._updateTimers[T]),this._updateTimers[T]=null,R&&R.progress(I),g.jobStatus){case p.STATUS_SUBMITTED:case p.STATUS_EXECUTING:case p.STATUS_WAITING:case p.STATUS_NEW:var c=
this._getJobStatus;this._updateTimers[T]=setTimeout(function(){c(T,F,S,w,R)},this.updateDelay);break;default:this._successHandler([I],"onJobComplete",S,R)}},_getJobStatus:function(g,I,F,S,w){var R=this._jobUpdateHandler;t({url:this._url.path+"/jobs/"+g,content:J.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(T,c){R(T,c,I,F,S,w)},error:this._errorHandler})},_getResultDataHandler:function(g,I,F,S,w){try{var R=this._decode(g);this._successHandler([R],"onGetResultDataComplete",
F,w)}catch(T){this._errorHandler(T,S,w)}},getResultData:function(g,I,F,S){var w=this._getResultDataHandler,R=this._errorHandler,T=new Q(q._dfdCanceller);T._pendingDfd=t({url:this._url.path+"/jobs/"+g+"/results/"+I,content:J.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(c,n){w(c,n,F,S,T)},error:function(c){R(c,S,T)}});return T},checkJobStatus:function(g,I,F){var S=this._jobUpdateHandler,w=this._errorHandler,R=new Q(q._dfdCanceller);R._pendingDfd=
t({url:this._url.path+"/jobs/"+g,content:J.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(T,c){S(T,c,!0,null,I,R)},error:function(T){w(T,F,R)}});return R},cancelJob:function(g,I,F){var S=this._errorHandler,w=new Q(q._dfdCanceller);w._pendingDfd=t({url:this._url.path+"/jobs/"+g+"/cancel",content:J.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:J.hitch(this,function(R,T){this._successHandler([R],"onJobCancel",I,w)}),error:function(R){S(R,F,w)}});
return w},execute:function(g,I,F,S){var w=this._getOutSR(),R=S.assembly;g=this._gpEncode(J.mixin({},this._url.query,{f:"json","env:outSR":w?w.wkid||e.toJson(w.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||e.toJson(this.processSpatialReference.toJson()):null},g),null,R&&R[0]);var T=this._executeHandler,c=this._errorHandler;return t({url:this._url.path+"/execute",content:g,callbackParamName:"callback",load:function(n,C){T(n,C,I,F,S.dfd)},error:function(n){c(n,
F,S.dfd)}})},_executeHandler:function(g,I,F,S,w){try{var R=g.results,T,c=g.messages;var n=0;for(T=R.length;n<T;n++)R[n]=this._decode(R[n]);n=0;for(T=c.length;n<T;n++)c[n]=new H(c[n]);this._successHandler([R,c],"onExecuteComplete",F,w)}catch(C){this._errorHandler(C,S,w)}},_getResultImageHandler:function(g,I,F,S,w){try{var R=this._decode(g);this._successHandler([R],"onGetResultImageComplete",F,w)}catch(T){this._errorHandler(T,S,w)}},getResultImage:function(g,I,F,S,w){var R=this._getResultImageHandler,
T=this._errorHandler;F=this._gpEncode(J.mixin({},this._url.query,{f:"json"},F.toJson()));var c=new Q(q._dfdCanceller);c._pendingDfd=t({url:this._url.path+"/jobs/"+g+"/results/"+I,content:F,callbackParamName:"callback",load:function(n,C){R(n,C,S,w,c)},error:function(n){T(n,w,c)}});return c},cancelJobStatusUpdates:function(g){clearTimeout(this._updateTimers[g]);this._updateTimers[g]=null},getResultImageLayer:function(g,I,F,S){if(null==I){var w=this._url.path.indexOf("/GPServer/");g=this._url.path.substring(0,
w)+"/MapServer/jobs/"+g}else g=this._url.path+"/jobs/"+g+"/results/"+I;this._url.query&&(g+="?"+m.objectToQuery(this._url.query));I=null==I?new W(g,{imageParameters:F}):new Z(g,{imageParameters:F},!0);this.onGetResultImageLayerComplete(I);S&&S(I);return I},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});z._createWrappers(P);
v("extend-esri")&&J.setObject("tasks.Geoprocessor",P,l);return P})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(P,J,D,Q,e){P=P(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(v){this.messages=[];J.mixin(this,v);v=this.messages;var m,l=v.length;for(m=0;m<l;m++)v[m]=new e(v[m])},jobId:"",jobStatus:""});J.mixin(P,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",
STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});D("extend-esri")&&J.setObject("tasks.JobInfo",P,Q);return P})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(P,J,D,Q){P=P(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(e){J.mixin(this,
e)}});J.mixin(P,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});D("extend-esri")&&J.setObject("tasks.GPMessage",P,Q);return P})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(P,J,D,Q){P=P(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(e){e&&J.mixin(this,e)},distance:0,units:null,toJson:function(){var e={};this.distance&&(e.distance=this.distance);this.units&&(e.units=this.units);return e}});D("extend-esri")&&J.setObject("tasks.LinearUnit",P,Q);return P})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(P,J,D,Q){P=P(null,{declaredClass:"esri.tasks.DataFile",
constructor:function(e){e&&J.mixin(this,e)},url:null,itemID:null,toJson:function(){var e={};this.url&&(e.url=this.url);this.itemID&&(e.itemID=this.itemID);return e}});D("extend-esri")&&J.setObject("tasks.DataFile",P,Q);return P})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(P,J,D,Q){P=P(null,{declaredClass:"esri.tasks.RasterData",constructor:function(e){e&&J.mixin(this,e)},url:null,format:null,itemID:null,toJson:function(){var e=
{};this.url&&(e.url=this.url);this.format&&(e.format=this.format);this.itemID&&(e.itemID=this.itemID);return e}});D("extend-esri")&&J.setObject("tasks.RasterData",P,Q);return P})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(P,J,D,Q,e){P=P(null,{declaredClass:"esri.tasks.Date",constructor:function(v){v&&(v.format&&(this.format=v.format),this.date=D.parse(v.date,{selector:"date",datePattern:this.format}))},date:new Date,
format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:D.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}});Q("extend-esri")&&J.setObject("tasks.Date",P,e);return P})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(P,J,D,Q){P=P(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(e){J.mixin(this,e)}});D("extend-esri")&&J.setObject("tasks.ParameterValue",P,Q);return P})},
"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(P,J,D,Q,e,v,m){P=P(m,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(l,t){t&&t.imageParameters&&t.imageParameters.extent&&(this.initialExtent=this.fullExtent=t.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=J.hitch(this,this.getImageUrl);
this.loaded=!0;this.onLoad(this)},getImageUrl:function(l,t,q,z){var x=l.spatialReference.wkid;z(this._url.path+"?"+e.objectToQuery(J.mixin(this._params,{f:"image",bbox:D.toJson(l.toJson()),bboxSR:x,imageSR:x,size:t+","+q})))}});Q("extend-esri")&&J.setObject("tasks._GPResultImageLayer",P,v);return P})},"dojox/timing":function(){define(["./timing/_base"],function(P){return P})},"dojox/timing/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang"],function(P){P.experimental("dojox.timing");
P.getObject("timing",!0,dojox);dojox.timing.Timer=function(J){this.timer=null;this.isRunning=!1;this.interval=J;this.onStop=this.onStart=null};P.extend(dojox.timing.Timer,{onTick:function(){},setInterval:function(J){this.isRunning&&window.clearInterval(this.timer);this.interval=J;this.isRunning&&(this.timer=window.setInterval(P.hitch(this,"onTick"),this.interval))},start:function(){if("function"==typeof this.onStart)this.onStart();this.isRunning=!0;this.timer=window.setInterval(P.hitch(this,"onTick"),
this.interval)},stop:function(){if("function"==typeof this.onStop)this.onStop();this.isRunning=!1;window.clearInterval(this.timer)}});return dojox.timing})},"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ./FeatureTable/dataUtils ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(P,J,D,Q,e,v,m,l,t,q,z,x,u,p,H,f,r,y,V,N,Z,W,k,g,I,F,S,w,R,T,c,n,C,O,M,ba,X,ca,K,aa,Y,xa){var wa=P([g,V,N],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:xa,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,
_currentFeature:null,_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},_defaultRichTextPlugins:"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),css:{label:"atiLabel",field:"atiField",textArea:"atiTextAreaField",richText:"atiRichTextField",attachmentEditor:"atiAttachmentEditor",
red:"atiRequiredField"},constructor:function(A,B){J.mixin(this,f.widgets.attributeInspector);A=A||{};A.featureLayer||A.layerInfos||console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(A);this._layerInfos=A.layerInfos||[{featureLayer:A.featureLayer,options:A.options||[]}];this._layerInfos=D.filter(this._layerInfos,function(L){return!L.disableAttributeUpdate});this._hideNavButtons=A.hideNavButtons||!1},postCreate:function(){if(D.every(this._layerInfos,
function(B){return B.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var A=this._layerInfos.length;D.forEach(this._layerInfos,function(B){B=B.featureLayer;if(B.loaded)A--;else var L=Q.connect(B,"onLoad",this,function(U){Q.disconnect(L);L=null;A--;A||(this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature())})},this)}},destroy:function(){this._destroyAttributeTable();D.forEach(this._aiConnects,Q.disconnect);delete this._aiConnects;
this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},next:function(){this.onNextFeature()},previous:function(){this.onPreviousFeature()},showFeature:function(A,B){B&&(this._createOnlyFirstTime=!0);
this._updateSelection([A],B);this._updateUI()},onLayerSelectionChange:function(A,B,L){this._createOnlyFirstTime=!1;this._featureIdx=L===H.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){!this._selection||0>=this._selection.length||(this._featureIdx=this._numFeatures=0,this._selection=[],this._currentLInfo=this._currentFeature=null,this._updateUI())},onLayerUpdateEnd:function(A,B,L,U){},onLayerError:function(A,B,L,U){},onLayerEditsError:function(A,
B,L,U){},onLayerEditsComplete:function(A,B,L,U){U=U||[];if(U.length){var ha=this._selection,la=A.featureLayer.objectIdField;D.forEach(U,J.hitch(this,function(ma){D.some(ha,J.hitch(this,function(ja,pa){if(ja.attributes[la]!==ma.objectId)return!1;this._selection.splice(pa,1);return!0}))}))}B=B||[];B.length&&(this._selection=F.findFeatures(B,A.featureLayer),this._featureIdx=0);U=this._numFeatures=(this._selection=F.sortFeaturesById(this._layerInfos,this._selection))?this._selection.length:0;if(B.length){if(B=
U?this._selection[this._featureIdx]:null)U=B.getLayer().getEditCapabilities(),U.canCreate&&!U.canUpdate||this._showFeature(B);this._updateUI()}L=L||[];if(L.length){var ia=this._rollbackInfo;D.forEach(L,function(ma){var ja=F.findFeatures(L,A.featureLayer)[0];if(!ma.success&&ja.attributes[A.featureLayer.objectIdField]===ma.objectId&&ia){var pa=ia.field;ma=ia.graphic.attributes[pa.name];var sa=D.filter(this._currentLInfo.fieldInfos,function(za){return za.fieldName===pa.name},this)[0].dijit;ja.attributes[pa.name]=
ma;"esriFieldTypeDate"===pa.type&&(ma=new Date(ma));this._setValue(sa,ma)}},this)}this._rollbackInfo=null},onFieldValueChange:function(A,B){var L=A.field,U=A.dijit,ha=this._currentFeature,la=this._currentLInfo,ia=L.name;A=this._isFieldRequired(L,A);if(""===U.displayedValue||"dijit.form.ValidationTextBox"!==U.declaredClass||U.isValid())if(""!==U.displayedValue&&U.displayedValue!==B&&U.isValid&&!U.isValid())this._setValue(U,ha.attributes[L.name]);else{var ma=!("esriFieldTypeInteger"!==L.type&&"esriFieldTypeSmallInteger"!==
L.type&&"esriFieldTypeSingle"!==L.type&&"esriFieldTypeDouble"!==L.type);if(A&&(null===B||""===B||"undefined"===typeof B||ma&&isNaN(B))){ia=ha.attributes[L.name];if("esriFieldTypeDate"===L.type&&(ia=new Date(ia),U instanceof Array)){this._setValue(U[0],ia);this._setValue(U[1],ia);return}this._setValue(U,ia)}else{if(ma){if(isNaN(B)||""===B)B=null;ma&&null!==B&&(B=Number(B))}"esriFieldTypeDate"===L.type&&(U instanceof Array?(B=U[0].getValue(),U=U[1].getValue(),B=B&&U?new Date(B.getFullYear(),B.getMonth(),
B.getDate(),U.getHours(),U.getMinutes(),U.getSeconds(),U.getMilliseconds()):B||U||null):(B=U.getValue(),L.domain&&(B=Number(B))),B=B&&B.getTime?B.getTime():B&&B.toGregorian?B.toGregorian().getTime():B);if(this._currentFeature.attributes[L.name]!==B){if(ia===la.typeIdField){var ja=this._findFirst(la.types,"id",B);D.forEach(la.fieldInfos,function(pa){(L=pa.field)&&L.name!==la.typeIdField&&(pa=pa.dijit,this._setFieldDomain(pa,ja,L)&&pa&&(this._setValue(pa,ha.attributes[L.name]+""),!1===pa.isValid()&&
this._setValue(pa,null)))},this)}this.onAttributeChange(ha,ia,B)}}}else this._setValue(U,ha.attributes[L.name])},onDeleteBtn:function(A){this._deleteFeature()},onNextFeature:function(A){this._onNextFeature(1)},onPreviousFeature:function(A){this._onNextFeature(-1)},onFirstFeature:function(A){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(A){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var A=this._layerInfos;this._editorTrackingInfos={};D.forEach(A,
this._initLayerInfo,this)},_initLayerInfo:function(A){var B=A.featureLayer,L;this._userIds={};var U=B.id;B.credential&&(this._userIds[U]=B.credential.userId);A.userId&&(this._userIds[U]=A.userId);this._connect(B,"onSelectionComplete",J.hitch(this,"onLayerSelectionChange",A));this._connect(B,"onSelectionClear",J.hitch(this,"onLayerSelectionClear",A));this._connect(B,"onEditsComplete",J.hitch(this,"onLayerEditsComplete",A));this._connect(B,"error",J.hitch(this,"onLayerError",A));this._connect(B,"onUpdateEnd",
J.hitch(this,"onLayerUpdateEnd",A));A.showAttachments=B.hasAttachments?x.isDefined(A.showAttachments)?A.showAttachments:!0:!1;A.hideFields=A.hideFields||[];A.htmlFields=A.htmlFields||[];A.isEditable=B.isEditable()?x.isDefined(A.isEditable)?A.isEditable:!0:!1;A.typeIdField=B.typeIdField;A.layerId=B.id;A.types=B.types;B.globalIdField&&((L=this._findFirst(A.fieldInfos,"fieldName",B.globalIdField))||A.showGlobalID||A.hideFields.push(B.globalIdField));(U=this._findFirst(A.fieldInfos,"fieldName",B.objectIdField))||
A.showObjectID||A.hideFields.push(B.objectIdField);var ha=this._getFields(A.featureLayer);if(ha){var la=A.fieldInfos||[];la=D.map(la,function(ia){return J.mixin({},ia)});la.length?A.fieldInfos=D.filter(D.map(la,J.hitch(this,function(ia){var ma=ia.stringFieldOption||(this._isInFields(ia.fieldName,A.htmlFields)?wa.STRING_FIELD_OPTION_RICHTEXT:wa.STRING_FIELD_OPTION_TEXTBOX);return J.mixin(ia,{field:this._findFirst(ha,"name",ia.fieldName),stringFieldOption:ma})})),"return item.field;"):(ha=D.filter(ha,
J.hitch(this,function(ia){return!this._isInFields(ia.name,A.hideFields)})),A.fieldInfos=D.map(ha,J.hitch(this,function(ia){var ma=this._isInFields(ia.name,A.htmlFields)?wa.STRING_FIELD_OPTION_RICHTEXT:wa.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:ia.name,field:ia,stringFieldOption:ma}})));A.showGlobalID&&!L&&la.push(this._findFirst(ha,"name",B.globalIdField));A.showObjectID&&!U&&la.push(this._findFirst(ha,"name",B.objectIdField));L=[];B.editFieldsInfo&&(B.editFieldsInfo.creatorField&&L.push(B.editFieldsInfo.creatorField),
B.editFieldsInfo.creationDateField&&L.push(B.editFieldsInfo.creationDateField),B.editFieldsInfo.editorField&&L.push(B.editFieldsInfo.editorField),B.editFieldsInfo.editDateField&&L.push(B.editFieldsInfo.editDateField));this._editorTrackingInfos[B.id]=L}},_createAttachmentEditor:function(){this._attachmentEditor=null;var A=D.filter(this._layerInfos,function(B){return B.showAttachments});A&&A.length&&(this._attachmentEditor=new I({"class":this.css.attachmentEditor},this.attachmentEditor),this._attachmentEditor.startup())},
_setCurrentLInfo:function(A){var B=this._currentLInfo?this._currentLInfo.featureLayer:null,L=A.featureLayer;if(B&&B.id===L.id&&!B.ownershipBasedAccessControlForFeatures&&(B=L.getEditCapabilities(),!B.canCreate||B.canUpdate))return;this._currentLInfo=A;this._createTable()},_updateSelection:function(A,B){this._selection=A||[];D.forEach(this._layerInfos,this._getSelection,this);this._selection=F.sortFeaturesById(this._layerInfos,this._selection);this._numFeatures=this._selection.length;this._showFeature(this._numFeatures?
this._selection[this._featureIdx]:null,B)},_getSelection:function(A){A=A.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(A)},_updateUI:function(){var A=this._numFeatures,B=this._currentLInfo;this.layerName.innerHTML=B&&0!==A?B.featureLayer?B.featureLayer.name:"":this.NLS_noFeaturesSelected;l.set(this.attributeTable,"display",A?"":"none");l.set(this.editButtons,"display",A?"":"none");l.set(this.navButtons,"display",!this._hideNavButtons&&1<A?"":"none");this.navMessage.innerHTML=
x.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);this._attachmentEditor&&l.set(this._attachmentEditor.domNode,"display",B&&B.showAttachments&&A?"":"none");l.set(this.deleteBtn.domNode,"display",B&&!1===B.showDeleteButton||!this._canDelete?"none":"");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(A){this._featureIdx+=A;0>this._featureIdx?this._featureIdx=this._numFeatures-
1:this._featureIdx>=this._numFeatures&&(this._featureIdx=0);A=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(A);this._updateUI();this.onNext(A)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(A,B){if(A){this._currentFeature=A;B=B?B:A.getLayer();var L=B.getEditCapabilities({feature:A,userId:this._userIds[B.id]});this._canUpdate=L.canUpdate;this._canDelete=L.canDelete;if(L=this._getLInfoFromFeatureLayer(B)){this._setCurrentLInfo(L);
var U=A.attributes,ha=this._findFirst(L.types,"id",U[L.typeIdField]),la=null;D.forEach(L.fieldInfos,function(ia){la=ia.field;var ma=[];ia.dijit&&1<ia.dijit.length?D.forEach(ia.dijit,function(ja){ma.push(ja)}):ma.push(ia.dijit);D.forEach(ma,J.hitch(this,function(ja){if(ja){var pa=this._setFieldDomain(ja,ha,la),sa=U[la.name];sa=sa&&pa&&pa.codedValues&&pa.codedValues.length?pa.codedValues[sa]?pa.codedValues[sa].name:sa:sa;x.isDefined(sa)||(sa="");"dijit.form.DateTextBox"===ja.declaredClass||"dijit.form.TimeTextBox"===
ja.declaredClass?sa=""===sa?null:new Date(sa):"dijit.form.FilteringSelect"===ja.declaredClass&&(ja._lastValueReported=null,sa=U[la.name]+"");try{this._setValue(ja,sa),"dijit.form.FilteringSelect"===ja.declaredClass&&!1===ja.isValid()&&this._setValue(ja,null)}catch(za){ja.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&L.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,B);(A=B.getEditSummary(A))?(this.editorTrackingInfoDiv.innerHTML=A,
u.show(this.editorTrackingInfoDiv)):u.hide(this.editorTrackingInfoDiv)}}},_setFieldDomain:function(A,B,L){if(!A)return null;var U=L.domain;B&&B.domains&&B.domains[L.name]&&!1===B.domains[L.name]instanceof p&&(U=B.domains[L.name]);if(!U)return null;U.codedValues&&0<U.codedValues.length?(A.set("store",this._toStore(D.map(U.codedValues,function(ha){return{id:ha.code+"",name:ha.name}}))),this._setValue(A,U.codedValues[0].code+"")):(A.constraints={min:x.isDefined(U.minValue)?U.minValue:Number.MIN_VALUE,
max:x.isDefined(U.maxValue)?U.maxValue:Number.MAX_VALUE},this._setValue(A,A.constraints.min));return U},_setValue:function(A,B){A.set&&(A._onChangeActive=!1,A.set("value",B,!0),A._onChangeActive=!0)},_getFields:function(A){var B=A._getOutFields();if(!B)return null;A=A.fields;return"*"==B?A:D.filter(D.map(B,J.hitch(this,"_findFirst",A,"name")),x.isDefined)},_isInFields:function(A,B){return A&&(B||B.length)?D.some(B,function(L){return L.toLowerCase()===A.toLowerCase()}):!1},_isFieldNullable:function(A,
B){return!(!1===A.nullable||B.field&&!1===B.field.nullable)},_isFieldRequired:function(A,B){return!1!==A.editable&&!1!==B.isEditable&&!this._isFieldNullable(A,B)},_findFirst:function(A,B,L){return(A=D.filter(A,function(U){return U.hasOwnProperty(B)&&U[B]===L}))&&A.length?A[0]:null},_getLInfoFromFeatureLayer:function(A){return this._findFirst(this._layerInfos,"layerId",A?A.id:null)},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=t.create("table",
{cellspacing:"0",cellpadding:"0"},this.attributeTable);var A=t.create("tbody",null,this._attributes),B=this._currentLInfo,L=this._findFirst(B.types,"id",this._currentFeature.attributes[B.typeIdField]);D.forEach(B.fieldInfos,J.hitch(this,"_createField",L,A),this);this._createOnlyFirstTime=!1},_createField:function(A,B,L){var U=this._currentLInfo,ha=L.field;if(!this._isInFields(ha.name,U.hideFields)&&!this._isInFields(ha.name,this._editorTrackingInfos[U.featureLayer.id])){var la=!1,ia;B=t.create("tr",
null,B);var ma=L.label||ha.alias||ha.name;ma=q.sanitizer?q.sanitizer.sanitize(ma):htmlEntities.encode(ma);ma=t.create("td",{innerHTML:ma,"class":this.css.label,"data-fieldname":ha.name},B);this._isFieldRequired(ha,L)&&t.create("span",{"class":this.css.red,innerHTML:" *"},ma);B=t.create("td",null,B);if(L.customField){t.place(L.customField.domNode||L.customField,t.create("div",null,B),"first");var ja=L.customField}else if(!1===U.isEditable||!1===ha.editable||!1===L.isEditable||"esriFieldTypeOID"===
ha.type||"esriFieldTypeGlobalID"===ha.type||!this._canUpdate&&!this._createOnlyFirstTime)la=!0;U=U.typeIdField&&ha.name.toLowerCase()==U.typeIdField.toLowerCase();ma=!!this._getDomainForField(ha,A);!ja&&U?ja=this._createTypeField(ha,L,B):!ja&&ma&&(ja=this._createDomainField(ha,L,A,B));if(!ja)switch(ha.type){case "esriFieldTypeString":ja=this._createStringField(ha,L,B);break;case "esriFieldTypeDate":ja=this._createDateField(ha,L,B);L.format&&L.format.time&&(ia=this._createTimeField(ha,L,B));break;
case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":ja=this._createIntField(ha,L,B);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":ja=this._createFltField(ha,L,B);break;default:ja=this._createStringField(ha,L,B)}L.tooltip&&L.tooltip.length&&this._toolTips.push(new X({connectId:[ja.id],label:L.tooltip}));ja.onChange=J.hitch(this,"onFieldValueChange",L);ja.set("disabled",la);ia?(L.dijit=[ja,ia],ia.onChange=J.hitch(this,"onFieldValueChange",L),ia.set("disabled",la)):L.dijit=ja}},
_createTypeField:function(A,B,L){L=t.create("div",null,L);var U=A.domain;return U&&"range"===U.type&&U.minValue===U.maxValue?new M({"class":this.css.field,trim:!0,maxLength:A.length,name:A.alias||A.name,required:this._isFieldRequired(A,B)},L):new c({"class":this.css.field,name:A.alias||A.name,required:this._isFieldRequired(A,B),store:this._toStore(D.map(this._currentLInfo.types,function(ha){return{id:ha.id,name:ha.name}})),searchAttr:"name"},L)},_getDomainForField:function(A,B){var L=A.domain;(A=
A.name)&&B&&B.domains&&B.domains[A]&&!1===B.domains[A]instanceof p&&(L=B.domains[A]);return L||null},_createDomainField:function(A,B,L,U){L=this._getDomainForField(A,L);U=t.create("div",null,U);return L.codedValues?new c({"class":this.css.field,name:A.alias||A.name,searchAttr:"name",required:this._isFieldRequired(A,B)},U):new n({"class":this.css.field},U)},_createStringField:function(A,B,L){L=t.create("div",null,L);var U={trim:!0,maxLength:A.length,required:this._isFieldRequired(A,B)};if(B.stringFieldOption===
wa.STRING_FIELD_OPTION_TEXTAREA)return U["class"]=this.css.field+" "+this.css.textArea,new O(U,L);if(B.stringFieldOption===wa.STRING_FIELD_OPTION_RICHTEXT)return U["class"]=this.css.field+" "+this.css.richText,U.height="100%",U.width="100%",U.plugins=B.richTextPlugins||this._defaultRichTextPlugins,L=new Z(U,L),L.startup(),L;var ha=this;U.validator=function(la,ia){this._maskValidSubsetError=!1;this._hasBeenBlurred=!0;return ha._isFieldNullable(A,B)||!(""===la||null===la)};return new M(U,L)},_createTimeField:function(A,
B,L){L=t.create("div",null,L);A={"class":this.css.field,trim:!0,required:this._isFieldRequired(A,B),constraints:{formatLength:"medium"}};this._datePackage&&(A.datePackage=this._datePackage);return new ba(A,L)},_createDateField:function(A,B,L){L=t.create("div",null,L);A={"class":this.css.field,trim:!0,required:this._isFieldRequired(A,B)};this._datePackage&&(A.datePackage=this._datePackage);return new w(A,L)},_createIntField:function(A,B,L){L=t.create("div",null,L);return new T({"class":this.css.field,
constraints:"esriFieldTypeSmallInteger"===A.type?{min:-32768,max:32767,places:0}:{places:0},trim:!0,invalidMessage:this.NLS_validationInt,required:this._isFieldRequired(A,B)},L)},_createFltField:function(A,B,L){L=t.create("div",null,L);return new T({"class":this.css.field,constraints:{max:Infinity,min:-Infinity,places:"0,20"},trim:!0,invalidMessage:this.NLS_validationFlt,required:this._isFieldRequired(A,B)},L)},_toStore:function(A){return new ca({data:{identifier:"id",label:"name",items:A}})},_connect:function(A,
B,L){this._aiConnects.push(Q.connect(A,B,L))},_getDatePackage:function(A){return null===A.datePackage?null:A.datePackage?A.datePackage:"ar"===v.locale?"dojox.date.islamic":null},_destroyAttributeTable:function(){D.forEach(this._layerInfos,function(A){D.forEach(A.fieldInfos,function(B){var L=B.dijit;if(L){L._onChangeHandle=null;if(B.customField)return;L instanceof Array?D.forEach(L,J.hitch(this,function(U){U.destroyRecursive?U.destroyRecursive():U.destroy&&U.destroy();U._onChangeHandle=null})):L.destroyRecursive?
L.destroyRecursive():L.destroy&&L.destroy()}B.dijit=null},this)},this);D.forEach(this._toolTips,function(A){A.destroy()});this._toolTips=[];this._attributes&&t.destroy(this._attributes)}});J.mixin(wa,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});m("extend-esri")&&J.setObject("dijit.AttributeInspector",wa,z);return wa})},"esri/dijit/FeatureTable/dataUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/Deferred dojo/number dojo/string dojo/date/locale dojo/promise/all ../../libs/sanitizer/Sanitizer ../../config ../../graphic ../../numberUtils ../../request ../../ArcadeExpression ../../arcadeProfiles/popupProfile ../../layers/FeatureLayer ../../geometry/Extent ../../tasks/query ../../tasks/StatisticDefinition ../../tasks/QueryTask ../../tasks/RelationshipQuery dojo/i18n dojo/i18n!../../nls/jsapi".split(" "),
function(P,J,D,Q,e,v,m,l,t,q,z,x,u,p,H,f,r,y,V,N,Z,W){return{i18nStrings:W.widgets.FeatureTable,numericFieldTypes:["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeSmallInteger"],statisticDefinitions:[{type:"count",name:"countField"},{type:"sum",name:"sumField"},{type:"min",name:"minField"},{type:"max",name:"maxField"},{type:"avg",name:"avgField"},{type:"stddev",name:"stddevField"}],_reExprField:/^\s*expression\//i,sanitizer:new l({whiteList:{dd:[],dl:[],dt:[],h1:[],
h2:[],h3:[],h4:[],h5:[],h6:[],sub:[],sup:[],animate:[],animatetransform:[],circle:[],clippath:[],defs:[],ellipse:[],g:[],image:[],line:[],lineargradient:[],marker:[],mask:[],path:[],pattern:[],polygon:[],polyline:[],radialgradient:[],rect:[],stop:[],svg:[],"switch":[],symbol:[],text:[],textpath:[],tspan:[],use:[]}},!0),getOrderByString:function(k,g){return k+(g?" DESC":" ASC")},getWhereString:function(k,g){return k+"\x3d'"+g+"'"},getRelationshipWhereClause:function(k){var g=k.layer,I=k.originRelationship,
F=k.destinationRelationship,S=I.relationshipTableId||I.relatedTableId;I=I.keyFieldInRelationshipTable||I.keyField;var w=F.keyFieldInRelationshipTable||F.keyField,R=g.layerId==S?w:I;k=this.getWhereString(R,k.keyValue);I=g._url.path;I=I.substring(0,I.lastIndexOf("/")+1);return x({url:I+S+"/query",content:{f:"json",outFields:["*"],returnGeometry:!1,where:k},handleAs:"json",callbackParamName:"callback"}).then(J.hitch(this,function(T){if(T&&T.features&&T.features.length){var c=T.features,n=[],C="",O;P.forEach(c,
function(M,ba){if(M.attributes&&M.attributes[w])O=M.attributes[w];else{var X=g.getField(R)?g.getField(R).name:null;if(this.isValueEmpty(X)){X=w.toUpperCase();var ca=w.toLowerCase();O=M.attributes[X]||M.attributes[ca]||null}else O=M.attributes[X]}-1===P.indexOf(n,O)&&(0<n.length&&ba<c.length&&(C=C.concat(" OR ")),n.push(O),C=C.concat(this.getWhereString(F.keyField,O)))},this);return C}return null}))},isValueEmpty:function(k){return null===k||" "===k||""===k||"undefined"===typeof k},findFirst:function(k,
g,I){return P.filter(k,function(F){return F.hasOwnProperty(g)&&F[g]===I})[0]||null},compareIntArrays:function(k,g){k.sort();g.sort();var I=P.every(g,function(S){return-1!==P.indexOf(k,S)},this),F=P.every(k,function(S){return-1!==P.indexOf(g,S)},this);return I&&F},findFirstNumberColumn:function(k,g){var I;P.some(k,function(F,S){if(-1!==P.indexOf(this.numericFieldTypes,F.type)&&F.field!==g&&!F.hidden)return I=F,!0},this);return I},getRoundingPrecision:function(k){return 1E3<=k?0:10<=k?2:0<=k?4:6},generateLinkFromString:function(k){var g=
/^\s*(http?:\/\/([^\s]+))\s*$/i,I=/^\s*(https?:\/\/([^\s]+))\s*$/i;if("string"===typeof k){var F;g.test(k)?F=k.indexOf("http:"):I.test(k)&&(F=k.indexOf("https:"));-1<F&&-1===k.indexOf("href\x3d")?(g=k.indexOf(" ",F),-1===g&&(g=k.length),I=k.substring(F,g),k=k.substring(0,F)+"\x3ca href\x3d'"+I+"' target\x3d'_blank'\x3e"+I+"\x3c/a\x3e"+k.substring(g,k.length)):k=this.sanitizer.sanitize(k)}return this.isValueEmpty(k)?"":k},isNumericFieldType:function(k){return-1!==P.indexOf(this.numericFieldTypes,k)},
isIntegerFieldType:function(k){return"esriFieldTypeInteger"===k||"esriFieldTypeSmallInteger"===k},isFloatFieldType:function(k){return"esriFieldTypeDouble"===k||"esriFieldTypeSingle"===k},getDomainValueFromRow:function(k){var g=k.fieldInfo.name,I=k.fieldInfo.domain,F=k.row;if("range"===I.type)return F[g];k=P.filter(I.codedValues,function(S){return S.hasOwnProperty("code")&&S.code==F[g]});return k[0]&&!this.isValueEmpty(k[0].name)?k[0].name:F[g]},getTypeValueFromRow:function(k){var g=k.layerInfo[k.typesProperty],
I=k.typeIdProperty,F=k.fieldInfo,S=k.row;k=g&&g[0];if(k){var w=S[F.name];F=this.isNumericFieldType(F.type);F=(k="string"===typeof k[I])&&F?w.toString():w;w=(w=this.findFirst(g,I,F))?w.name:null}return w},getSubtypeDomainValue:function(k){var g=k.layerInfo,I=k.fieldInfo.name,F=k.row,S;k=(g=this.findFirst(g.types,"id",F[g.typeIdField]))?g.domains:null;if(!g||!k)return F[I];k[I]&&k[I].codedValues&&(S=P.filter(k[I].codedValues,function(w){return w.hasOwnProperty("code")&&w.code==F[I]}));return S&&S[0]&&
!this.isValueEmpty(S[0].name)?S[0].name:F[I]},mergeDictionaries:function(k,g){if(null===k||null===g)return k;for(var I in g){k[I]||(k[I]={});for(var F in g[I])k[I][F]=g[I][F]}return k},isCyclicalRelationship:function(k){return"esriRelCardinalityOneToOne"===k.cardinality||"esriRelCardinalityOneToMany"===k.cardinality&&"esriRelRoleDestination"===k.role},getColumnFromFieldName:function(k){return this.findFirst(k.grid.columns,"field",k.fieldName)},isDateFieldWithStringDataValue:function(k){return"esriFieldTypeDateOnly"===
k||"esriFieldTypeTimeOnly"===k||"esriFieldTypeTimestampOffset"===k},formatNumberForLocale:function(k,g){if(g){var I=Z.getLocalization("dojo.cldr","number");if(g.digitSeparator||!I||this.isValueEmpty(k))return isNaN(k)||null===k?null:Q.format(k,g);k=isNaN(k)||null===k?null:Q.format(k,g);return k.replace(new RegExp("\\"+I.group,"g"),"")}return isNaN(k)||null===k?null:z.format(k,g)},getCombinedDateTime:function(k,g){return new Date(k.getFullYear(),k.getMonth(),k.getDate(),g.getHours(),g.getMinutes(),
g.getSeconds())},formatDateForLocale:function(k){var g=k.dateOptions||{},I=k.timestamp,F=k.fieldInfo,S=!1,w=!1;k={};g=(S=F&&F.dateOptions?F.dateOptions:!1)||g;S=S&&this.isValueEmpty(g.dateEnabled)?!0:!!g.dateEnabled;w=!!g.timeEnabled;this.isValueEmpty(g.datePattern)||(k.datePattern=g.datePattern);this.isValueEmpty(g.timeEnabled)||this.isValueEmpty(g.timePattern)||(k.timePattern=g.timePattern);k.selector=S&&w?"date and time":S&&!w?"date":!S&&w?"time":"date";return v.format(new Date(I),k)},calculateExtentFromFeatures:function(k){var g=
k[0].geometry,I;if(null===g&&1===k.length)return null;for(g=k.length-1;0<=g;g--)null===k[g].geometry&&k.splice(g,1);g=k[0].geometry;var F=g.getExtent();var S=k.length;null===F&&(F=new f(g.x,g.y,g.x,g.y,g.spatialReference));for(I=1;I<S;I++){g=k[I].geometry;var w=g.getExtent();null===w&&(w=new f(g.x,g.y,g.x,g.y,g.spatialReference));F=F.union(w)}return F},initFeatureLayer:function(k,g){k=k._url.path;k=k.substring(0,k.lastIndexOf("/")+1);return new H(k+g,{mode:H.MODE_ONDEMAND,outFields:["*"],visible:!0})},
applyEdits:function(k){var g=[],I=new D;if(!k||0>=k.length)return I.reject(),I;P.forEach(k,function(F){F.layer&&g.push(F.layer.applyEdits(F.adds,F.updates,F.deletes,function(S,w,R){I.resolve({adds:S,updates:w,deletes:R})},function(S){I.reject(S)}))});0<g.length?m(g):I.reject();return I},applyEditsFromRow:function(k){var g=k.layer,I=new q;I.setAttributes(k.row);return this.applyEdits([{layer:g,updates:[I]}],null)},queryLayer:function(k){var g=k.layer;k=k.ids||null;var I=new r;I.where="1\x3d1";I.returnGeometry=
!1;I.objectIds=k;return g.queryFeatures(I)},queryLayerForFeature:function(k){return this.queryLayerForFeatures({layer:k.layer,ids:[k.id]})},queryLayerForFeatures:function(k){var g=k.layer,I=g.advancedQueryCapabilities;I=I&&I.supportsQueryWithCacheHint;k=k.ids;var F=new r;F.objectIds=k;F.outFields=["*"];I&&(F.cacheHint=!0);return g.queryFeatures(F,function(S){return S.features})},queryLayerForCount:function(k){var g=k.layer,I=g.advancedQueryCapabilities;I=I&&I.supportsQueryWithCacheHint;if(g.queryCount){var F=
new r,S=k.layerInfo;k=k.where||"1\x3d1";F.returnGeometry=!1;F.returnCountOnly=!0;F.where=k;I&&(F.cacheHint=!0);return g.queryCount(F).then(function(w){return w}).otherwise(function(){return S.isFeatureCollection?g.graphics.length:2E3}).always(function(w){return w})}return this.queryLayerCustom({layer:g,returnCountOnly:!0,cacheHint:I}).then(function(w){return w&&w.features?w.features.length:0}).otherwise(function(){return g.maxRecordCount||2E3}).always(function(w){return w})},queryLayerCustom:function(k){var g=
new r,I=k.returnCountOnly||!1,F=k.where||"1\x3d1",S=k.returnGeometry||!1,w=k.outFields||["*"],R=k.cacheHint||!1;k=new V(k.layer.url);g.returnGeometry=S;g.outFields=w;g.where=F;g.returnCountOnly=I;R&&(g.cacheHint=!0);return k.execute(g)},queryLayerForIds:function(k){var g=k.layer,I=g.advancedQueryCapabilities;I=I&&I.supportsQueryWithCacheHint;var F=k.idProperty;k=k.where||"1\x3d1";var S=new r;S.returnGeometry=!1;S.outFields=[F];S.where=k;S.returnIdsOnly=!0;I&&(S.cacheHint=!0);return g.queryIds(S)},
queryLayerForAttachments:function(k){return x({url:k.layer._url.path+"/queryAttachments",content:{f:"json",objectIds:k.ids},handleAs:"json",callbackParamName:"callback"})},queryLayerForAttachmentById:function(k){return k.layer.queryAttachmentInfos(k.id||0)},addAttachmentToLayer:function(k){return k.layer.addAttachment(k.featureId,k.formData)},deleteAttachmentFromLayer:function(k){return k.layer.deleteAttachments(k.featureId,[k.attachmentId])},queryLayerForRelatedRecords:function(k){var g=k.layer,
I=k.ids,F=k.outFields||["*"],S=k.relationship;k=k.returnCountOnly||!1;var w=new N;w.outFields=F;w.returnGeometry=!1;w.relationshipId=S.id;w.returnCountOnly=k;w.objectIds=I;return g.queryRelatedFeatures(w)},queryLayerForRelatedRecordCount:function(k){return x({url:k.layer._url.path+"/queryRelatedRecords",content:{f:"json",objectIds:k.objectIds.toString(),outFields:k.outFields,returnGeometry:!1,relationshipId:k.relationship.id,returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"})},getFieldStatistics:function(k){var g=
new D,I=k.layer,F=I.advancedQueryCapabilities;F=F&&F.supportsQueryWithCacheHint;var S=k.idProperty,w=k.where||"1\x3d1",R=k.filterIds,T=k.grid.columns[k.columnId].field;k=I.url;var c=[];var n=P.map(this.statisticDefinitions,function(O){var M=new y;M.onStatisticField=T;M.displayFieldName=T;M.outStatisticFieldName=O.name;M.statisticType=O.type;return M});var C=new r;C.outFields=[T];C.outStatistics=[];C.where=w;C.outStatistics=n;F&&(C.cacheHint=!0);R&&0<R.length&&(c=R);C.where&&0<c.length&&(C.where="("+
C.where+") AND ("+S+" IN ("+c.toString()+"))");I.source&&!this.isValueEmpty(I.source.mapLayerId)&&k.endsWith("/dynamicLayer")&&(k=k.slice(0,-13),k=k+"/"+I.source.mapLayerId);(new V(k)).execute(C).then(function(O){g.resolve(O)}).otherwise(function(){g.reject()});return g},selectFeaturesById:function(k){var g=k.grid,I=g.layer;g=g.layerInfo;var F=k.map,S=k.ids;k=k.id;var w=new r;w.returnGeometry=!!F;w.objectIds=S||[k];g.isFeatureCollection||(w.where="1\x3d1");return I.selectFeatures(w,H.SELECTION_NEW)},
isFeatureEditable:function(k){var g=k.layerInfo;return!!k.layer.getEditCapabilities({userId:g.userIds[g.layerId]||null,feature:{attributes:k.attributes}}).canUpdate},isExpressionField:function(k){return this._reExprField.test(k)},getExpressionInfo:function(k,g){if(this.isExpressionField(g)){var I;g=g.replace(this._reExprField,"");g=g.toLowerCase();P.some(k,function(F){F.name.toLowerCase()===g&&(I=F);return!!I});return I}},compileExpressions:function(k){var g={};P.forEach(k,function(I){var F=I.returnType&&
I.returnType.toLowerCase();g[I.name]=new u({expression:I.expression,returnType:"number"===F?"number":"string",profile:p})});return g},getExpressionValue:function(k,g){var I=k.getLayer(),F=I&&I.getMap();return g?k.evaluateExpression(g,p.getEvalOptions({expression:g,feature:k,layer:I,map:F,spatialReference:F&&F.spatialReference})):null}}})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(P,J,D,Q,e,v,m,l,t,q,z,x,u,p,H,f,r,y,V,N,Z,W,k,g,I){function F(w){return new N({command:w.name})}function S(w){return new N({buttonClass:V,command:w.name})}D=D("dijit.Editor",g,{plugins:null,extraPlugins:null,constructor:function(){z.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",Z]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(x("ie")||x("trident")||x("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new Q;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);z.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=e.getLocalization("dijit._editor",
"commands",this.lang);x("webkit")&&t.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new f({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));J.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);m.add(this.iframe.parentNode,"dijitEditorIFrameContainer");m.add(this.iframe,"dijitEditorIFrame");v.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){J.forEach(this._plugins,function(w){w&&w.destroy&&w.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(w,R){var T=z.isString(w)?{name:w}:z.isFunction(w)?{ctor:w}:w;if(!T.setEditor){var c={args:T,plugin:null,editor:this};T.name&&(N.registry[T.name]?c.plugin=N.registry[T.name](T):p.publish(I._scopeName+".Editor.getPlugin",c));if(!c.plugin)try{var n=
T.ctor||z.getObject(T.name)||P(T.name);n&&(c.plugin=new n(T))}catch(C){throw Error(this.id+": cannot find plugin ["+T.name+"]");}if(!c.plugin)throw Error(this.id+": cannot find plugin ["+T.name+"]");w=c.plugin}1<arguments.length?this._plugins[R]=w:this._plugins.push(w);w.setEditor(this);z.isFunction(w.setToolbar)&&w.setToolbar(this.toolbar)},resize:function(w){w&&y.prototype.resize.apply(this,arguments)},layout:function(){var w=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+l.getPadBorderExtents(this.iframe.parentNode).h+
l.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=w+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(w){var R,T=this.document.body,c=T.clientWidth,n=T.clientHeight,C=T.clientLeft,O=T.offsetWidth,M=T.offsetHeight,ba=T.offsetLeft;/^rtl$/i.test(T.dir||"")?c<O&&w.x>c&&w.x<O&&(R=!0):w.x<C&&w.x>ba&&(R=!0);R||n<M&&w.y>n&&w.y<M&&(R=!0);R||(delete this._cursorToStart,delete this._savedSelection,"BODY"==w.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(w){this.customUndo&&this.endEditing(!0);"BODY"!=w.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(w){this._inEditing||(this._inEditing=!0,this._beginEditing(w));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(w){if(!this.customUndo||
"undo"!=w&&"redo"!=w){this.customUndo&&(this.endEditing(),this._beginEditing());var R=this.inherited(arguments);this.customUndo&&this._endEditing();return R}return this[w]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(w){try{var R=this.document.execCommand(w,!1,null);if(x("webkit")&&!R)throw{};}catch(T){R=u.substitute,alert(R(this.commands.systemShortcut,
[this.commands[w],R(this.commands[x("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[w]])])),R=!1}return R},queryCommandEnabled:function(w){return!this.customUndo||"undo"!=w&&"redo"!=w?this.inherited(arguments):"undo"==w?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(w){var R=w.mark,T=w.mark;w=w.isCollapsed;var c;if(T)if(9>x("ie")||9===x("ie")&&x("quirks"))if(z.isArray(T))R=[],J.forEach(T,function(O){R.push(k.getNode(O,this.editNode))},this),this.selection.moveToBookmark({mark:R,
isCollapsed:w});else{if(T.startContainer&&T.endContainer&&(c=k.getSelection(this.window))&&c.removeAllRanges){c.removeAllRanges();w=k.create(this.window);var n=k.getNode(T.startContainer,this.editNode);var C=k.getNode(T.endContainer,this.editNode);n&&C&&(w.setStart(n,T.startOffset),w.setEnd(C,T.endOffset),c.addRange(w))}}else(c=k.getSelection(this.window))&&c.removeAllRanges&&(c.removeAllRanges(),w=k.create(this.window),n=k.getNode(T.startContainer,this.editNode),C=k.getNode(T.endContainer,this.editNode),
n&&C&&(w.setStart(n,T.startOffset),w.setEnd(C,T.endOffset),c.addRange(w)))},_changeToStep:function(w,R){this.setValue(R.text);(w=R.bookmark)&&this._moveToBookmark(w)},undo:function(){var w=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var R=this._steps.pop();R&&0<this._steps.length&&(this.focus(),this._changeToStep(R,this._steps[this._steps.length-1]),this._undoedSteps.push(R),this.onDisplayChanged(),delete this._undoRedoActive,w=!0);delete this._undoRedoActive}return w},
redo:function(){var w=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var R=this._undoedSteps.pop();R&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],R),this._steps.push(R),this.onDisplayChanged(),w=!0);delete this._undoRedoActive}return w},endEditing:function(w){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(w),this._inEditing=!1)},_getBookmark:function(){var w=this.selection.getBookmark(),
R=[];if(w&&w.mark){var T=w.mark;if(9>x("ie")||9===x("ie")&&x("quirks")){var c=k.getSelection(this.window);if(z.isArray(T))J.forEach(w.mark,function(C){R.push(k.getIndex(C,this.editNode).o)},this),w.mark=R;else if(c){var n;c.rangeCount&&(n=c.getRangeAt(0));w.mark=n?n.cloneRange():this.selection.getBookmark()}}try{w.mark&&w.mark.startContainer&&(R=k.getIndex(w.mark.startContainer,this.editNode).o,w.mark={startContainer:R,startOffset:w.mark.startOffset,endContainer:w.mark.endContainer===w.mark.startContainer?
R:k.getIndex(w.mark.endContainer,this.editNode).o,endOffset:w.mark.endOffset})}catch(C){w.mark=null}}return w},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:W.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var w=W.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:w,bookmark:this._getBookmark()})},onKeyDown:function(w){x("ie")||this.iframe||w.keyCode!=q.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var R=
w.keyCode;if(w.ctrlKey&&!w.shiftKey&&!w.altKey){if(90==R||122==R){w.stopPropagation();w.preventDefault();this.undo();return}if(89==R||121==R){w.stopPropagation();w.preventDefault();this.redo();return}}this.inherited(arguments);switch(R){case q.ENTER:case q.BACKSPACE:case q.DELETE:this.beginEditing();break;case 88:case 86:if(w.ctrlKey&&!w.altKey&&!w.metaKey){this.endEditing();88==w.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!w.ctrlKey&&!w.altKey&&
!w.metaKey&&(w.keyCode<q.F1||w.keyCode>q.F15)){this.beginEditing();break}case q.ALT:this.endEditing();break;case q.UP_ARROW:case q.DOWN_ARROW:case q.LEFT_ARROW:case q.RIGHT_ARROW:case q.HOME:case q.END:case q.PAGE_UP:case q.PAGE_DOWN:this.endEditing(!0);case q.CTRL:case q.SHIFT:case q.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(w){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(w){this.customUndo?this.isClosed?this.setValue(w):(this.beginEditing(),w||(w="\x26#160;"),this.setValue(w),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(w){this.setValueDeferred.then(z.hitch(this,function(){!this.disabled&&w||!this._buttonEnabledPlugins&&w?
J.forEach(this._plugins,function(R){R.set("disabled",!0)}):this.disabled&&!w&&J.forEach(this._plugins,function(R){R.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(t.set(this.document.body,"color",t.get(this.iframe,"color")),t.set(this.document.body,"background-color",t.get(this.iframe,"background-color")))}catch(w){}}});z.mixin(N.registry,{undo:F,redo:F,cut:F,copy:F,paste:F,insertOrderedList:F,insertUnorderedList:F,
indent:F,outdent:F,justifyCenter:F,justifyFull:F,justifyLeft:F,justifyRight:F,"delete":F,selectAll:F,removeFormat:F,unlink:F,insertHorizontalRule:F,bold:S,italic:S,underline:S,strikethrough:S,subscript:S,superscript:S,"|":function(){return new N({setEditor:function(w){this.editor=w;this.button=new r({ownerDocument:w.ownerDocument})}})}});return D})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(P,J,D,Q,e,v,m,l){D("dijit-legacy-requires")&&e(0,function(){P(["dijit/ToolbarSeparator"])});return J("dijit.Toolbar",[v,l,m],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(P,J,D,Q){return P("dijit.ToolbarSeparator",[D,Q],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);J.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(P,J,D,Q,e){J=J("dijit._editor._Plugin",Q,{constructor:function(v){this.params=
v||{};D.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:e,disabled:!1,getLabel:function(v){return this.editor.commands[v]},_initButton:function(){if(this.command.length){var v=this.getLabel(this.command),m=this.editor,l=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(v=D.mixin({label:v,ownerDocument:m.ownerDocument,dir:m.dir,
lang:m.lang,showLabel:!1,iconClass:l,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete v.name,this.button=new this.buttonClass(v))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(v,m,l){this.own(P.connect(v,m,this,l))},updateState:function(){var v=this.editor,m=this.command;if(v&&v.isLoaded&&m.length){var l=this.get("disabled");if(this.button)try{var t=
v._implCommand(m);var q=!l&&(this[t]?this[t](m):v.queryCommandEnabled(m));this.enabled!==q&&(this.enabled=q,this.button.set("disabled",!q));if(q&&"boolean"==typeof this.button.checked){var z=v.queryCommandState(m);this.checked!==z&&(this.checked=z,this.button.set("checked",v.queryCommandState(m)))}}catch(x){console.log(x)}}},setEditor:function(v){this.editor=v;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",D.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",D.hitch(this,"updateState")))},setToolbar:function(v){this.button&&v.addChild(this.button)},set:function(v,m){if("object"===typeof v){for(var l in v)this.set(l,v[l]);return this}l=this._getAttrNames(v);if(this[l.s])var t=this[l.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(v,m);return t||this},get:function(v){var m=this._getAttrNames(v);
return this[m.g]?this[m.g]():this[v]},_setDisabledAttr:function(v){this._set("disabled",v);this.updateState()},_getAttrNames:function(v){var m=this._attrPairNames;if(m[v])return m[v];var l=v.charAt(0).toUpperCase()+v.substr(1);return m[v]={s:"_set"+l+"Attr",g:"_get"+l+"Attr"}},_set:function(v,m){this[v]=m}});J.registry={};return J})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(P,J,D,Q,e,v,m,l,t,q,z){return P("dijit._editor.plugins.EnterKeyHandling",t,{blockNodeForEnter:"BR",constructor:function(x){x&&("blockNodeForEnter"in x&&(x.blockNodeForEnter=x.blockNodeForEnter.toUpperCase()),Q.mixin(this,x))},setEditor:function(x){if(this.editor!==x)if(this.editor=x,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,x.onLoadDeferred.then(Q.hitch(this,function(p){this.own(e(x.document,"keydown",Q.hitch(this,function(H){if(H.keyCode==D.ENTER){var f=Q.mixin({},H);f.shiftKey=
!0;this.handleEnterKey(f)||(H.stopPropagation(),H.preventDefault())}})));9<=v("ie")&&10>=v("ie")&&this.own(e(x.document,"paste",Q.hitch(this,function(H){setTimeout(Q.hitch(this,function(){var f=this.editor.document.selection.createRange();f.move("character",-1);f.select();f.move("character",1);f.select()}),0)})));return p}));else if(this.blockNodeForEnter){var u=Q.hitch(this,"handleEnterKey");x.addKeyHandler(13,0,0,u);x.addKeyHandler(13,0,1,u);this.own(this.editor.on("KeyPressed",Q.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var x=this.editor.selection.getAncestorElement("LI");if(x){v("mozilla")&&"LI"==x.parentNode.parentNode.nodeName&&(x=x.parentNode.parentNode);var u=x.firstChild;!u||1!=u.nodeType||"UL"!=u.nodeName&&"OL"!=u.nodeName||(x.insertBefore(u.ownerDocument.createTextNode("\u00a0"),u),u=z.create(this.editor.window),u.setStart(x.firstChild,0),x=z.getSelection(this.editor.window,!0),x.removeAllRanges(),x.addRange(u))}else q.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(x=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(x.innerHTML=this.bogusHtmlContent,9>=v("ie")&&(x=this.editor.document.selection.createRange(),x.move("character",-1),x.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(x){var u,p=this.editor.document,H;if(x.shiftKey){x=this.editor.selection.getParentElement();if(u=z.getAncestor(x,this.blockNodes)){if("LI"==u.tagName)return!0;x=z.getSelection(this.editor.window);var f=x.getRangeAt(0);f.collapsed||(f.deleteContents(),x=z.getSelection(this.editor.window),f=x.getRangeAt(0));if(z.atBeginningOfContainer(u,f.startContainer,f.startOffset)){var r=p.createElement("br");f=z.create(this.editor.window);u.insertBefore(r,
u.firstChild);f.setStartAfter(r);x.removeAllRanges();x.addRange(f)}else if(z.atEndOfContainer(u,f.startContainer,f.startOffset))f=z.create(this.editor.window),r=p.createElement("br"),u.appendChild(r),u.appendChild(p.createTextNode("\u00a0")),f.setStart(u.lastChild,0),x.removeAllRanges(),x.addRange(f);else{if((H=f.startContainer)&&3==H.nodeType){var y=H.nodeValue;var V=p.createTextNode(y.substring(0,f.startOffset));var N=p.createTextNode(y.substring(f.startOffset));u=p.createElement("br");""==N.nodeValue&&
v("webkit")&&(N=p.createTextNode("\u00a0"));J.place(V,H,"after");J.place(u,V,"after");J.place(N,u,"after");J.destroy(H);f=z.create(this.editor.window);f.setStart(N,0);x.removeAllRanges();x.addRange(f);return!1}return!0}}else x=z.getSelection(this.editor.window),x.rangeCount?(f=x.getRangeAt(0))&&f.startContainer&&(f.collapsed||(f.deleteContents(),x=z.getSelection(this.editor.window),f=x.getRangeAt(0)),(H=f.startContainer)&&3==H.nodeType?(u=f.startOffset,H.length<u&&(N=this._adjustNodeAndOffset(H,u),
H=N.node,u=N.offset),y=H.nodeValue,V=p.createTextNode(y.substring(0,u)),N=p.createTextNode(y.substring(u)),u=p.createElement("br"),N.length||(N=p.createTextNode("\u00a0")),V.length?J.place(V,H,"after"):V=H,J.place(u,V,"after"),J.place(N,u,"after"),J.destroy(H)):(0<=f.startOffset&&(r=H.childNodes[f.startOffset]),u=p.createElement("br"),N=p.createTextNode("\u00a0"),r?(J.place(u,r,"before"),J.place(N,u,"after")):(H.appendChild(u),H.appendChild(N))),f=z.create(this.editor.window),f.setStart(N,0),f.setEnd(N,
N.length),x.removeAllRanges(),x.addRange(f),this.editor.selection.collapse(!0)):q.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var Z=!0;x=z.getSelection(this.editor.window);f=x.getRangeAt(0);f.collapsed||(f.deleteContents(),x=z.getSelection(this.editor.window),f=x.getRangeAt(0));r=z.getBlockAncestor(f.endContainer,null,this.editor.editNode);var W=r.blockNode;if(this._checkListLater=W&&("LI"==W.nodeName||"LI"==W.parentNode.nodeName))return v("mozilla")&&(this._pressedEnterInBlock=
W),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(W.innerHTML)&&(W.innerHTML="",v("webkit")&&(f=z.create(this.editor.window),f.setStart(W,0),x.removeAllRanges(),x.addRange(f)),this._checkListLater=!1),!0;if(!r.blockNode||r.blockNode===this.editor.editNode){try{q.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(k){}r={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(r.blockNode){if(r.blockNode!=this.editor.editNode&&!(r.blockNode.textContent||r.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(r.blockNode),!1}else r.blockNode=this.editor.editNode;x=z.getSelection(this.editor.window);f=x.getRangeAt(0)}W=p.createElement(this.blockNodeForEnter);W.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(r.blockNode);N=f.endOffset;Z=f.endContainer;Z.length<N&&(N=this._adjustNodeAndOffset(Z,N),Z=
N.node,N=N.offset);if(z.atEndOfContainer(r.blockNode,Z,N))r.blockNode===r.blockContainer?r.blockNode.appendChild(W):J.place(W,r.blockNode,"after"),Z=!1,f=z.create(this.editor.window),f.setStart(W,0),x.removeAllRanges(),x.addRange(f),this.editor.height&&l.scrollIntoView(W);else if(z.atBeginningOfContainer(r.blockNode,f.startContainer,f.startOffset))J.place(W,r.blockNode,r.blockNode===r.blockContainer?"first":"before"),W.nextSibling&&this.editor.height&&(f=z.create(this.editor.window),f.setStart(W.nextSibling,
0),x.removeAllRanges(),x.addRange(f),l.scrollIntoView(W.nextSibling)),Z=!1;else{r.blockNode===r.blockContainer?r.blockNode.appendChild(W):J.place(W,r.blockNode,"after");Z=!1;r.blockNode.style&&W.style&&r.blockNode.style.cssText&&(W.style.cssText=r.blockNode.style.cssText);if((H=f.startContainer)&&3==H.nodeType){N=f.endOffset;H.length<N&&(N=this._adjustNodeAndOffset(H,N),H=N.node,N=N.offset);y=H.nodeValue;V=p.createTextNode(y.substring(0,N));N=p.createTextNode(y.substring(N,y.length));J.place(V,H,
"before");J.place(N,H,"after");J.destroy(H);for(f=V.parentNode;f!==r.blockNode;){y=p.createElement(f.tagName);f.style&&y.style&&f.style.cssText&&(y.style.cssText=f.style.cssText);"FONT"===f.tagName&&(f.color&&(y.color=f.color),f.face&&(y.face=f.face),f.size&&(y.size=f.size));for(;N;)H=N.nextSibling,y.appendChild(N),N=H;J.place(y,f,"after");V=f;N=y;f=f.parentNode}if(1==N.nodeType||3==N.nodeType&&N.nodeValue)W.innerHTML="";for(V=N;N;)H=N.nextSibling,W.appendChild(N),N=H}f=z.create(this.editor.window);
p=V;if("BR"!==this.blockNodeForEnter){for(;p;)u=p,p=H=p.firstChild;u&&u.parentNode?(W=u.parentNode,f.setStart(W,0),x.removeAllRanges(),x.addRange(f),this.editor.height&&l.scrollIntoView(W),v("mozilla")&&(this._pressedEnterInBlock=r.blockNode)):Z=!0}else f.setStart(W,0),x.removeAllRanges(),x.addRange(f),this.editor.height&&l.scrollIntoView(W),v("mozilla")&&(this._pressedEnterInBlock=r.blockNode)}return Z},_adjustNodeAndOffset:function(x,u){for(;x.length<u&&x.nextSibling&&3==x.nextSibling.nodeType;)u-=
x.length,x=x.nextSibling;return{node:x,offset:u}},removeTrailingBr:function(x){if(x=/P|DIV|LI/i.test(x.tagName)?x:this.editor.selection.getParentOfType(x,["P","DIV","LI"]))x.lastChild&&(1<x.childNodes.length&&3==x.lastChild.nodeType&&/^[\s\xAD]*$/.test(x.lastChild.nodeValue)||"BR"==x.lastChild.tagName)&&J.destroy(x.lastChild),x.childNodes.length||(x.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(P,J,D,Q,e,v,m,l,t,q,z,x,u,p,H,f,r,y,V,N,Z,W,k,g,I,F,S,w,R){var T=D("dijit._editor.RichText",[k,g],{constructor:function(c){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};c&&u.isString(c.value)&&(this.value=c.value);this.onLoadDeferred=new Q},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[u.trim,u.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);r("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));r("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(r("ie")||r("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[u.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[u.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);V.publish(R._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var c=u.hitch(this,function(O,M){return function(){return!this.execCommand(O,M)}}),n={b:c("bold"),i:c("italic"),u:c("underline"),a:c("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:c("formatblock",
"h1"),2:c("formatblock","h2"),3:c("formatblock","h3"),4:c("formatblock","h4"),"\\":c("insertunorderedlist")};r("ie")||(n.Z=c("redo"));for(var C in n)this.addKeyHandler(C,!0,!1,n[C])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(T._editorCommandsLocalized)this._local2NativeFormatNames=T._local2NativeFormatNames,this._native2LocalFormatNames=T._native2LocalFormatNames;else{T._editorCommandsLocalized=!0;T._local2NativeFormatNames={};
T._native2LocalFormatNames={};this._local2NativeFormatNames=T._local2NativeFormatNames;this._native2LocalFormatNames=T._native2LocalFormatNames;for(var c="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),n="",C,O=0;C=c[O++];)n="l"!==C.charAt(1)?n+("\x3c"+C+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+C+"\x3e\x3cbr/\x3e"):n+("\x3c"+C+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+C+"\x3e\x3cbr/\x3e");var M=l.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:n});this.ownerDocumentBody.appendChild(M);
c=u.hitch(this,function(){for(var ba=M.firstChild;ba;)try{this.selection.selectElement(ba.firstChild);var X=ba.tagName.toLowerCase();this._local2NativeFormatNames[X]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[X]]=X;ba=ba.nextSibling.nextSibling}catch(ca){}l.destroy(M)});this.defer(c)}},open:function(c){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new Q;this.isClosed||this.close();V.publish(R._scopeName+"._editor.RichText::open",
this);1===arguments.length&&c.nodeName&&(this.domNode=c);var n=this.domNode;if(u.isString(this.value)){var C=this.value;n.innerHTML=""}else if(n.nodeName&&"textarea"==n.nodeName.toLowerCase()){var O=this.textarea=n;this.name=O.name;C=O.value;n=this.domNode=this.ownerDocument.createElement("div");n.setAttribute("widgetId",this.id);O.removeAttribute("widgetId");n.cssText=O.cssText;n.className+=" "+O.className;l.place(n,O,"before");var M=u.hitch(this,function(){q.set(O,{display:"block",position:"absolute",
top:"-1000px"});if(r("ie")){var K=O.style;this.__overflow=K.overflow;K.overflow="hidden"}});r("ie")?this.defer(M,10):M();if(O.form){var ba=O.value;this.reset=function(){this.getValue()!==ba&&this.replaceValue(ba)};p(O.form,"submit",u.hitch(this,function(){v.set(O,"disabled",this.disabled);O.value=this.getValue()}))}}else C=S.getChildrenHtml(n),n.innerHTML="";this.value=C;n.nodeName&&"LI"===n.nodeName&&(n.innerHTML=" \x3cbr\x3e");this.header=n.ownerDocument.createElement("div");n.appendChild(this.header);
this.editingArea=n.ownerDocument.createElement("div");n.appendChild(this.editingArea);this.footer=n.ownerDocument.createElement("div");n.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!J.useXDomain||J.allowXdRichTextSave)){if((C=e.byId(R._scopeName+"._editor.RichText.value"))&&""!==C.value){M=C.value.split(this._SEPARATOR);for(var X=0,ca;ca=M[X++];)if(ca=ca.split(this._NAME_CONTENT_SEP),ca[0]===this.name){this.value=ca[1];M=M.splice(X,1);C.value=M.join(this._SEPARATOR);
break}}T._globalSaveHandler||(T._globalSaveHandler={},N.addOnUnload(function(){for(var K in T._globalSaveHandler){var aa=T._globalSaveHandler[K];u.isFunction(aa)&&aa()}}));T._globalSaveHandler[this.id]=u.hitch(this,"_saveContent")}this.isClosed=!1;C=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");C.id=this.id+"_iframe";C.style.border="none";C.style.width="100%";this._layoutMode?C.style.height="100%":7<=r("ie")?(this.height&&(C.style.height=this.height),this.minHeight&&(C.style.minHeight=
this.minHeight)):C.style.height=this.height?this.height:this.minHeight;C.frameBorder=0;C._loadFunc=u.hitch(this,function(K){this.window=K;this.document=K.document;this.selection=new I.SelectionManager(K);r("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});M=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");M=11>r("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+M+"');document.close()":"javascript: '"+
M+"'";this.editingArea.appendChild(C);C.src=M;"LI"===n.nodeName&&(n.lastChild.style.marginTop="-1.2em");m.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var c=q.getComputedStyle(this.domNode);if(this["aria-label"])var n=this["aria-label"];else{var C=H('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||e.byId(this["aria-labelledby"],this.ownerDocument);C&&(n=C.textContent||C.innerHTML||"")}C="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(n?" aria-label\x3d'"+y.escape(n)+"'":"")+"\x3e\x3c/div\x3e";var O=[c.fontWeight,c.fontSize,c.fontFamily].join(" "),M=c.lineHeight;M=0<=M.indexOf("px")?parseFloat(M)/parseFloat(c.fontSize):0<=M.indexOf("em")?parseFloat(M):"normal";var ba="",X=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(ca){ca=ca.replace(/^;/ig,"")+";";var K=ca.split(":")[0];if(K){K=u.trim(K);K=K.toLowerCase();var aa,Y="";for(aa=0;aa<K.length;aa++){var xa=K.charAt(aa);switch(xa){case "-":aa++,xa=K.charAt(aa).toUpperCase();
default:Y+=xa}}q.set(X.domNode,Y,"")}ba+=ca+";"});this.iframe.setAttribute("title",n);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||z.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",n?"\x3ctitle\x3e"+y.escape(n)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",O,";\n",this.height||r("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",M,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",r("ie")||r("trident")||r("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",n?" aria-label\x3d'"+y.escape(n)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+ba+"'\x3e",C,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var c=[];this.styleSheets&&(c=this.styleSheets.split(";"),this.styleSheets=
"");c=c.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var n="",C=0,O,M=W.get(this.ownerDocument);O=c[C++];)O=(new Z(M.location,O)).toString(),this.editingAreaStyleSheets.push(O),n+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+O+'"/\x3e';return n},addStyleSheet:function(c){var n=c.toString(),C=W.get(this.ownerDocument);if("."===n.charAt(0)||"/"!==n.charAt(0)&&!c.host)n=(new Z(C.location,n)).toString();-1<P.indexOf(this.editingAreaStyleSheets,n)||(this.editingAreaStyleSheets.push(n),
this.onLoadDeferred.then(u.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(n);else{var O=this.document.getElementsByTagName("head")[0],M=this.document.createElement("link");M.rel="stylesheet";M.type="text/css";M.href=n;O.appendChild(M)}})))},removeStyleSheet:function(c){var n=c.toString(),C=W.get(this.ownerDocument);if("."===n.charAt(0)||"/"!==n.charAt(0)&&!c.host)n=(new Z(C.location,n)).toString();c=P.indexOf(this.editingAreaStyleSheets,n);-1!==c&&(delete this.editingAreaStyleSheets[c],
H('link[href\x3d"'+n+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(c){c=!!c;this._set("disabled",c);if(this.isLoaded){var n=r("ie")&&(this.isLoaded||!this.focusOnLoad);n&&(this.editNode.unselectable="on");this.editNode.contentEditable=!c;this.editNode.tabIndex=c?"-1":this.tabIndex;n&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(r("mozilla")&&!c&&this._mozSettingProps){c=this._mozSettingProps;for(var C in c)if(c.hasOwnProperty(C))try{this.document.execCommand(C,
!1,c[C])}catch(O){}}this._disabledOK=!0}},onLoad:function(c){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=w.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var n=this;this.beforeIframeNode=l.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=l.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){n.editNode.focus()};this.focusNode=
this.editNode;var C=this.events.concat(this.captureEvents),O=this.iframe?this.document:this.editNode;this.own.apply(this,P.map(C,function(M){var ba=M.toLowerCase().replace(/^on/,"");return p(O,ba,u.hitch(this,M))},this));this.own(p(O,"mouseup",u.hitch(this,"onClick")));r("ie")&&(this.own(p(this.document,"mousedown",u.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);r("webkit")&&(this._webkitListener=this.own(p(this.document,"mouseup",u.hitch(this,"onDisplayChanged")))[0],this.own(p(this.document,
"mousedown",u.hitch(this,function(M){M=M.target;!M||M!==this.document.body&&M!==this.document||this.defer("placeCursorAtEnd")}))));if(r("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(M){}this.isLoaded=!0;this.set("disabled",this.disabled);C=u.hitch(this,function(){this.setValue(c);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&f(u.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(C):C()},onKeyDown:function(c){if(c.keyCode===x.SHIFT||c.keyCode===x.ALT||c.keyCode===x.META||c.keyCode===x.CTRL)return!0;c.keyCode===x.TAB&&this.isTabIndent&&(c.stopPropagation(),c.preventDefault(),this.queryCommandEnabled(c.shiftKey?"outdent":"indent")&&this.execCommand(c.shiftKey?"outdent":"indent"));if(c.keyCode==x.TAB&&!this.isTabIndent&&!c.ctrlKey&&!c.altKey)return c.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>r("ie")&&c.keyCode===x.BACKSPACE&&"Control"===this.document.selection.type&&(c.stopPropagation(),c.preventDefault(),this.execCommand("delete"));r("ff")&&(c.keyCode===x.PAGE_UP||c.keyCode===x.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&c.preventDefault();var n=this._keyHandlers[c.keyCode],C=arguments;n&&!c.altKey&&P.some(n,function(O){if(!(O.shift^c.shiftKey||O.ctrl^(c.ctrlKey||c.metaKey)))return O.handler.apply(this,C)||c.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(c){z.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",c)},_setValueAttr:function(c){this.setValue(c)},_setDisableSpellCheckAttr:function(c){this.document?v.set(this.document.body,"spellcheck",!c):this.onLoadDeferred.then(u.hitch(this,function(){v.set(this.document.body,"spellcheck",!c)}));this._set("disableSpellCheck",c)},addKeyHandler:function(c,n,C,O){"string"==
typeof c&&(c=c.toUpperCase().charCodeAt(0));u.isArray(this._keyHandlers[c])||(this._keyHandlers[c]=[]);this._keyHandlers[c].push({shift:C||!1,ctrl:n||!1,handler:O})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(c){this.onDisplayChanged(c)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(c){(r("ie")||r("trident"))&&this.defer(function(){w.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var n=this.getValue(!0);if(n!==this.value)this.onChange(n);
this._set("value",n)},_onFocus:function(c){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!r("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>r("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(c,n){c=c.toLowerCase();"formatblock"===c?r("safari")&&void 0===n&&(c="heading"):"hilitecolor"!==c||r("mozilla")||(c="backcolor");return c},_implCommand:function(c){return"_"+this._normalizeCommand(c)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(c){var n=this._qcaCache[c];return void 0!==n?n:this._qcaCache[c]=this._queryCommandAvailable(c)},_queryCommandAvailable:function(c){switch(c.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return r("ie")||r("trident")||r("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!r("webkit");default:return!1}},execCommand:function(c,n){this.focused&&this.focus();c=this._normalizeCommand(c,n);if(void 0!==n){if("heading"===c)throw Error("unimplemented");"formatblock"===
c&&(r("ie")||r("trident"))&&(n="\x3c"+n+"\x3e")}var C="_"+c+"Impl";if(this[C])var O=this[C](n);else if((n=1<arguments.length?n:null)||"createlink"!==c)O=this.document.execCommand(c,!1,n);this.onDisplayChanged();return O},queryCommandEnabled:function(c){if(this.disabled||!this._disabledOK)return!1;c=this._normalizeCommand(c);var n=this._implCommand(c);return this[n]?this[n](c):this._browserQueryCommandEnabled(c)},queryCommandState:function(c){if(this.disabled||!this._disabledOK)return!1;c=this._normalizeCommand(c);
try{return this.document.queryCommandState(c)}catch(n){return!1}},queryCommandValue:function(c){if(this.disabled||!this._disabledOK)return!1;c=this._normalizeCommand(c);if(r("ie")&&"formatblock"===c)c=this._native2LocalFormatNames[this.document.queryCommandValue(c)];else if(r("mozilla")&&"hilitecolor"===c){try{var n=this.document.queryCommandValue("styleWithCSS")}catch(C){n=!1}this.document.execCommand("styleWithCSS",!1,!0);c=this.document.queryCommandValue(c);this.document.execCommand("styleWithCSS",
!1,n)}else c=this.document.queryCommandValue(c);return c},_sCall:function(c,n){return this.selection[c].apply(this.selection,n)},placeCursorAtStart:function(){this.focus();var c=!1;if(r("mozilla"))for(var n=this.editNode.firstChild;n;){if(3===n.nodeType){if(0<n.nodeValue.replace(/^\s+|\s+$/g,"").length){c=!0;this.selection.selectElement(n);break}}else if(1===n.nodeType){c=!0;var C=n.tagName?n.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(C)?this.selection.selectElement(n):
this.selection.selectElementChildren(n);break}n=n.nextSibling}else c=!0,this.selection.selectElementChildren(this.editNode);c&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var c=!1;if(r("mozilla"))for(var n=this.editNode.lastChild;n;){if(3===n.nodeType){if(0<n.nodeValue.replace(/^\s+|\s+$/g,"").length){c=!0;this.selection.selectElement(n);break}}else if(1===n.nodeType){c=!0;this.selection.selectElement(n.lastChild||n);break}n=n.previousSibling}else c=!0,this.selection.selectElementChildren(this.editNode);
c&&this.selection.collapse(!1)},getValue:function(c){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,c):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(c){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){c=this._preFilterContent(c);var n=this.isClosed?this.domNode:this.editNode;n.innerHTML=c;this._preDomFilterContent(n)}else this.textarea.value=c;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(u.hitch(this,function(){this.setValue(c)}))},replaceValue:function(c){this.isClosed?this.setValue(c):this.window&&this.window.getSelection&&!r("mozilla")?this.setValue(c):this.window&&this.window.getSelection?(c=this._preFilterContent(c),this.execCommand("selectall"),this.execCommand("inserthtml",c),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(c);this._set("value",this.getValue(!0))},_preFilterContent:function(c){var n=
c;P.forEach(this.contentPreFilters,function(C){C&&(n=C(n))});return n},_preDomFilterContent:function(c){c=c||this.editNode;P.forEach(this.contentDomPreFilters,function(n){n&&u.isFunction(n)&&n(c)},this)},_postFilterContent:function(c,n){if(u.isString(c))var C=c;else c=c||this.editNode,this.contentDomPostFilters.length&&(n&&(c=u.clone(c)),P.forEach(this.contentDomPostFilters,function(O){c=O(c)})),C=S.getChildrenHtml(c);u.trim(C.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(C="");P.forEach(this.contentPostFilters,
function(O){C=O(C)});return C},_saveContent:function(){var c=e.byId(R._scopeName+"._editor.RichText.value");c&&(c.value&&(c.value+=this._SEPARATOR),c.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(c,n){c=c.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");n||(c=c.replace(/'/gm,"\x26#39;"));return c},getNodeHtml:function(c){z.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return S.getNodeHtml(c)},getNodeChildrenHtml:function(c){z.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return S.getChildrenHtml(c)},close:function(c){if(!this.isClosed){arguments.length||(c=!0);c&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);r("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var n=this.textarea.style;n.position="";n.left=n.top="";r("ie")&&(n.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;l.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;m.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);T._globalSaveHandler&&delete T._globalSaveHandler[this.id]},_removeMozBogus:function(c){return c.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(c){c=c.replace(/\sclass="webkit-block-placeholder"/gi,"");c=c.replace(/\sclass="apple-style-span"/gi,
"");return c=c.replace(/<meta charset="utf-8" \/>/gi,"")},_normalizeFontStyle:function(c){return c.replace(/<(\/)?strong([ >])/gi,"\x3c$1b$2").replace(/<(\/)?em([ >])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(c){return c.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(c){if(!c)return!1;
var n=9>r("ie")?this.document.selection.createRange():this.document;try{return n.queryCommandEnabled(c)}catch(C){return!1}},_createlinkEnabledImpl:function(){var c=!0;return c=r("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var c=!0;return c=r("mozilla")||r("webkit")?this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var c=
!0;return c=r("mozilla")||r("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var c=!0;r("webkit")?((c=this.window.getSelection())&&(c=c.toString()),c=!!c):c=this._browserQueryCommandEnabled("cut");return c},_copyEnabledImpl:function(){var c=!0;r("webkit")?((c=this.window.getSelection())&&(c=c.toString()),c=!!c):c=this._browserQueryCommandEnabled("copy");return c},_pasteEnabledImpl:function(){var c=!0;return r("webkit")?!0:c=this._browserQueryCommandEnabled("paste")},
_inserthorizontalruleImpl:function(c){return r("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,c)},_unlinkImpl:function(c){return this.queryCommandEnabled("unlink")&&(r("mozilla")||r("webkit"))?(c=this.selection.getAncestorElement("a"),this.selection.selectElement(c),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",!1,c)},_hilitecolorImpl:function(c){if(!this._handleTextColorOrProperties("hilitecolor",c))if(r("mozilla")){this.document.execCommand("styleWithCSS",
!1,!0);console.log("Executing color command.");var n=this.document.execCommand("hilitecolor",!1,c);this.document.execCommand("styleWithCSS",!1,!1)}else n=this.document.execCommand("hilitecolor",!1,c);return n},_backcolorImpl:function(c){r("ie")&&(c=c?c:null);var n=this._handleTextColorOrProperties("backcolor",c);n||(n=this.document.execCommand("backcolor",!1,c));return n},_forecolorImpl:function(c){r("ie")&&(c=c?c:null);var n=!1;(n=this._handleTextColorOrProperties("forecolor",c))||(n=this.document.execCommand("forecolor",
!1,c));return n},_inserthtmlImpl:function(c){c=this._preFilterContent(c);var n=!0;if(9>r("ie")){var C=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var O=C.item(0);C.length;)C.remove(C.item(0));O.outerHTML=c}else C.pasteHTML(c);C.select()}else if(8>r("trident")){var M=F.getSelection(this.window);if(M&&M.rangeCount&&M.getRangeAt){C=M.getRangeAt(0);C.deleteContents();var ba=l.create("div");ba.innerHTML=c;for(O=this.document.createDocumentFragment();c=
ba.firstChild;)var X=O.appendChild(c);C.insertNode(O);X&&(C=C.cloneRange(),C.setStartAfter(X),C.collapse(!1),M.removeAllRanges(),M.addRange(C))}}else r("mozilla")&&!c.length?this.selection.remove():n=this.document.execCommand("inserthtml",!1,c);return n},_boldImpl:function(c){var n=!1;if(r("ie")||r("trident"))this._adaptIESelection(),n=this._adaptIEFormatAreaAndExec("bold");n||(n=this.document.execCommand("bold",!1,c));return n},_italicImpl:function(c){var n=!1;if(r("ie")||r("trident"))this._adaptIESelection(),
n=this._adaptIEFormatAreaAndExec("italic");n||(n=this.document.execCommand("italic",!1,c));return n},_underlineImpl:function(c){var n=!1;if(r("ie")||r("trident"))this._adaptIESelection(),n=this._adaptIEFormatAreaAndExec("underline");n||(n=this.document.execCommand("underline",!1,c));return n},_strikethroughImpl:function(c){var n=!1;if(r("ie")||r("trident"))this._adaptIESelection(),n=this._adaptIEFormatAreaAndExec("strikethrough");n||(n=this.document.execCommand("strikethrough",!1,c));return n},_superscriptImpl:function(c){var n=
!1;if(r("ie")||r("trident"))this._adaptIESelection(),n=this._adaptIEFormatAreaAndExec("superscript");n||(n=this.document.execCommand("superscript",!1,c));return n},_subscriptImpl:function(c){var n=!1;if(r("ie")||r("trident"))this._adaptIESelection(),n=this._adaptIEFormatAreaAndExec("subscript");n||(n=this.document.execCommand("subscript",!1,c));return n},_fontnameImpl:function(c){if(r("ie")||r("trident"))var n=this._handleTextColorOrProperties("fontname",c);n||(n=this.document.execCommand("fontname",
!1,c));return n},_fontsizeImpl:function(c){if(r("ie")||r("trident"))var n=this._handleTextColorOrProperties("fontsize",c);n||(n=this.document.execCommand("fontsize",!1,c));return n},_insertorderedlistImpl:function(c){var n=!1;if(r("ie")||r("trident")||r("edge"))n=this._adaptIEList("insertorderedlist",c);n||(n=this.document.execCommand("insertorderedlist",!1,c));return n},_insertunorderedlistImpl:function(c){var n=!1;if(r("ie")||r("trident")||r("edge"))n=this._adaptIEList("insertunorderedlist",c);
n||(n=this.document.execCommand("insertunorderedlist",!1,c));return n},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(c){var n=0;if(c&&c.childNodes){var C;for(C=0;C<c.childNodes.length;C++){var O=t.position(c.childNodes[C]);n+=O.h}}return n},_isNodeEmpty:function(c,n){return 1===c.nodeType?0<c.childNodes.length?this._isNodeEmpty(c.childNodes[0],n):!0:3===c.nodeType?
""===c.nodeValue.substring(n):!1},_removeStartingRangeFromRange:function(c,n){if(c.nextSibling)n.setStart(c.nextSibling,0);else{for(c=c.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&n.setStart(c.nextSibling,0)}return n},_adaptIESelection:function(){var c=F.getSelection(this.window);if(c&&c.rangeCount&&!c.isCollapsed){for(var n=c.getRangeAt(0),C=n.startContainer,O=n.startOffset;3===C.nodeType&&O>=C.length&&C.nextSibling;)O-=C.length,C=C.nextSibling;for(var M=null;this._isNodeEmpty(C,O)&&C!==
M;)M=C,n=this._removeStartingRangeFromRange(C,n),C=n.startContainer,O=0;c.removeAllRanges();c.addRange(n)}},_adaptIEFormatAreaAndExec:function(c){var n=F.getSelection(this.window),C=this.document,O;if(c&&n&&n.isCollapsed){if(this.queryCommandValue(c)){c=this._tagNamesForCommand(c);var M=n.getRangeAt(0);var ba=M.startContainer;if(3===ba.nodeType){var X=M.endOffset;ba.length<X&&(X=this._adjustNodeAndOffset(ca,X),ba=X.node,X=X.offset)}for(;ba&&ba!==this.editNode;){var ca=ba.tagName?ba.tagName.toLowerCase():
"";if(-1<P.indexOf(c,ca)){var K=ba;break}ba=ba.parentNode}if(K&&(ca=M.startContainer,c=C.createElement(K.tagName),l.place(c,K,"after"),ca&&3===ca.nodeType)){X=M.endOffset;ca.length<X&&(X=this._adjustNodeAndOffset(ca,X),ca=X.node,X=X.offset);ba=ca.nodeValue;M=C.createTextNode(ba.substring(0,X));var aa=ba.substring(X,ba.length);aa&&(O=C.createTextNode(aa));l.place(M,ca,"before");if(O){var Y=C.createElement("span");Y.className="ieFormatBreakerSpan";l.place(Y,ca,"after");l.place(O,Y,"after");O=Y}l.destroy(ca);
X=M.parentNode;for(ca=[];X!==K;){ba=X.tagName;M={tagName:ba};ca.push(M);ba=C.createElement(ba);X.style&&ba.style&&X.style.cssText&&(ba.style.cssText=X.style.cssText,M.cssText=X.style.cssText);"FONT"===X.tagName&&(X.color&&(ba.color=X.color,M.color=X.color),X.face&&(ba.face=X.face,M.face=X.face),X.size&&(ba.size=X.size,M.size=X.size));X.className&&(ba.className=X.className,M.className=X.className);if(O)for(;O;)M=O.nextSibling,ba.appendChild(O),O=M;ba.tagName==X.tagName?(Y=C.createElement("span"),Y.className=
"ieFormatBreakerSpan",l.place(Y,X,"after"),l.place(ba,Y,"after")):l.place(ba,X,"after");M=X;O=ba;X=X.parentNode}if(O){if(1===O.nodeType||3===O.nodeType&&O.nodeValue)c.innerHTML="";for(;O;)M=O.nextSibling,c.appendChild(O),O=M}if(ca.length){M=ca.pop();O=C.createElement(M.tagName);M.cssText&&O.style&&(O.style.cssText=M.cssText);M.className&&(O.className=M.className);"FONT"===M.tagName&&(M.color&&(O.color=M.color),M.face&&(O.face=M.face),M.size&&(O.size=M.size));for(l.place(O,c,"before");ca.length;)M=
ca.pop(),K=C.createElement(M.tagName),M.cssText&&K.style&&(K.style.cssText=M.cssText),M.className&&(K.className=M.className),"FONT"===M.tagName&&(M.color&&(K.color=M.color),M.face&&(K.face=M.face),M.size&&(K.size=M.size)),O.appendChild(K),O=K;K=C.createTextNode(".");Y.appendChild(K);O.appendChild(K)}else Y=C.createElement("span"),Y.className="ieFormatBreakerSpan",K=C.createTextNode("."),Y.appendChild(K),l.place(Y,c,"before");O=F.create(this.window);O.setStart(K,0);O.setEnd(K,K.length);n.removeAllRanges();
n.addRange(O);this.selection.collapse(!1);K.parentNode.innerHTML="";c.firstChild||l.destroy(c);return!0}return!1}M=n.getRangeAt(0);if((ca=M.startContainer)&&3===ca.nodeType)return X=M.startOffset,ca.length<X&&(X=this._adjustNodeAndOffset(ca,X),ca=X.node,X=X.offset),ba=ca.nodeValue,M=C.createTextNode(ba.substring(0,X)),aa=ba.substring(X),""!==aa&&(O=C.createTextNode(ba.substring(X))),Y=C.createElement("span"),K=C.createTextNode("."),Y.appendChild(K),M.length?l.place(M,ca,"after"):M=ca,l.place(Y,M,
"after"),O&&l.place(O,Y,"after"),l.destroy(ca),O=F.create(this.window),O.setStart(K,0),O.setEnd(K,K.length),n.removeAllRanges(),n.addRange(O),C.execCommand(c),l.place(Y.firstChild,Y,"before"),l.destroy(Y),O.setStart(K,0),O.setEnd(K,K.length),n.removeAllRanges(),n.addRange(O),this.selection.collapse(!1),K.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(c){var n=F.getSelection(this.window);if(n.isCollapsed&&n.rangeCount&&!this.queryCommandValue(c)){var C=n.getRangeAt(0),O=C.startContainer;
if(O&&3==O.nodeType&&!C.startOffset)return C="ul","insertorderedlist"===c&&(C="ol"),c=this.document.createElement(C),C=l.create("li",null,c),l.place(c,O,"before"),C.appendChild(O),l.create("br",null,c,"after"),c=F.create(this.window),c.setStart(O,0),c.setEnd(O,O.length),n.removeAllRanges(),n.addRange(c),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(c,n){var C=F.getSelection(this.window),O=this.document,M,ba;n=n||null;if(c&&C&&C.isCollapsed&&C.rangeCount){var X=C.getRangeAt(0);
if((M=X.startContainer)&&3===M.nodeType){var ca=X.startOffset;M.length<ca&&(X=this._adjustNodeAndOffset(M,ca),M=X.node,ca=X.offset);var K=M.nodeValue;X=O.createTextNode(K.substring(0,ca));""!==K.substring(ca)&&(ba=O.createTextNode(K.substring(ca)));K=O.createElement("span");ca=O.createTextNode(".");K.appendChild(ca);O=O.createElement("span");K.appendChild(O);X.length?l.place(X,M,"after"):X=M;l.place(K,X,"after");ba&&l.place(ba,K,"after");l.destroy(M);M=F.create(this.window);M.setStart(ca,0);M.setEnd(ca,
ca.length);C.removeAllRanges();C.addRange(M);if(r("webkit")){C="color";if("hilitecolor"===c||"backcolor"===c)C="backgroundColor";q.set(K,C,n);this.selection.remove();l.destroy(O);K.innerHTML="\x26#160;";this.selection.selectElement(K);this.focus()}else this.execCommand(c,n),l.place(K.firstChild,K,"before"),l.destroy(K),M.setStart(ca,0),M.setEnd(ca,ca.length),C.removeAllRanges(),C.addRange(M),this.selection.collapse(!1),ca.parentNode.removeChild(ca);return!0}}return!1},_adjustNodeAndOffset:function(c,
n){for(;c.length<n&&c.nextSibling&&3===c.nextSibling.nodeType;)n-=c.length,c=c.nextSibling;return{node:c,offset:n}},_tagNamesForCommand:function(c){return"bold"===c?["b","strong"]:"italic"===c?["i","em"]:"strikethrough"===c?["s","strike"]:"superscript"===c?["sup"]:"subscript"===c?["sub"]:"underline"===c?["u"]:[]},_stripBreakerNodes:function(c){if(this.isLoaded)return H(".ieFormatBreakerSpan",c).forEach(function(n){for(;n.firstChild;)l.place(n.firstChild,n,"before");l.destroy(n)}),c},_stripTrailingEmptyNodes:function(c){function n(C){return/^(p|div|br)$/i.test(C.nodeName)&&
0==C.children.length&&/^[\s\xA0]*$/.test(C.textContent||C.innerText||"")||3===C.nodeType&&/^[\s\xA0]*$/.test(C.nodeValue)}for(;c.lastChild&&n(c.lastChild);)l.destroy(c.lastChild);return c},_setTextDirAttr:function(c){this._set("textDir",c);this.onLoadDeferred.then(u.hitch(this,function(){this.editNode.dir=c}))}});return T})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(P,J,D){var Q={getIndex:function(m,l){for(var t=[],q=[],z=m,x,u;m!=
l;){var p=0;for(x=m.parentNode;u=x.childNodes[p++];)if(u===m){--p;break}t.unshift(p);q.unshift(p-x.childNodes.length);m=x}if(0<t.length&&3==z.nodeType){for(u=z.previousSibling;u&&3==u.nodeType;)t[t.length-1]--,u=u.previousSibling;for(u=z.nextSibling;u&&3==u.nodeType;)q[q.length-1]++,u=u.nextSibling}return{o:t,r:q}},getNode:function(m,l){if(!D.isArray(m)||0==m.length)return l;var t=l;P.every(m,function(q){if(0<=q&&q<t.childNodes.length)t=t.childNodes[q];else return t=null,!1;return!0});return t},getCommonAncestor:function(m,
l,t){t=t||m.ownerDocument.body;var q=function(u){for(var p=[];u;)if(p.unshift(u),u!==t)u=u.parentNode;else break;return p};m=q(m);l=q(l);q=Math.min(m.length,l.length);for(var z=m[0],x=1;x<q;x++)if(m[x]===l[x])z=m[x];else break;return z},getAncestor:function(m,l,t){for(t=t||m.ownerDocument.body;m&&m!==t;){var q=m.nodeName.toUpperCase();if(l.test(q))return m;m=m.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(m,l,t){t=t||m.ownerDocument.body;
l=l||Q.BlockTagNames;for(var q=null,z;m&&m!==t;){var x=m.nodeName.toUpperCase();!q&&l.test(x)&&(q=m);!z&&/^(?:BODY|TD|TH|CAPTION)$/.test(x)&&(z=m);m=m.parentNode}return{blockNode:q,blockContainer:z||m.ownerDocument.body}},atBeginningOfContainer:function(m,l,t){var q=!1,z=0==t;z||3!=l.nodeType||/^[\s\xA0]+$/.test(l.nodeValue.substr(0,t))&&(z=!0);if(z)for(q=!0;l&&l!==m;){if(l.previousSibling){q=!1;break}l=l.parentNode}return q},atEndOfContainer:function(m,l,t){var q=!1,z=t==(l.length||l.childNodes.length);
z||3!=l.nodeType||/^[\s\xA0]+$/.test(l.nodeValue.substr(t))&&(z=!0);if(z)for(q=!0;l&&l!==m;){if(l.nextSibling){q=!1;break}l=l.parentNode}return q},adjacentNoneTextNode:function(m,l){var t=m;m=0-m.length||0;for(l=l?"nextSibling":"previousSibling";t&&3==t.nodeType;)m+=t.length,t=t[l];return[t,m]},create:function(m){m=m||window;return m.getSelection?m.document.createRange():new v},getSelection:function(m,l){if(m.getSelection)return m.getSelection();m=new e.selection(m);l||m._getCurrentSelection();return m}};
if(!window.getSelection)var e=Q.ie={cachedSelection:{},selection:function(m){this._ranges=[];this.addRange=function(l,t){this._ranges.push(l);t||l._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(l){return this._ranges[l]};this._getCurrentSelection=function(){this.removeAllRanges();var l=m.document.selection.createRange();l="CONTROL"==m.document.selection.type.toUpperCase()?new v(e.decomposeControlRange(l)):
new v(e.decomposeTextRange(l));this.addRange(l,!0),this.isCollapsed=l.collapsed}},decomposeControlRange:function(m){var l=m.item(0),t=m.item(m.length-1);m=l.parentNode;var q=t.parentNode;l=Q.getIndex(l,m).o[0];t=Q.getIndex(t,q).o[0]+1;return[m,l,q,t]},getEndPoint:function(m,l){var t=m.duplicate();t.collapse(!l);var q="EndTo"+(l?"End":"Start"),z=t.parentElement(),x;if(0<z.childNodes.length)P.every(z.childNodes,function(H,f){if(3!=H.nodeType)if(t.moveToElementText(H),0<t.compareEndPoints(q,m))if(x&&
3==x.nodeType){u=x;var r=!0}else return u=z,p=f,!1;else{if(f==z.childNodes.length-1)return u=z,p=z.childNodes.length,!1}else f==z.childNodes.length-1&&(u=H,r=!0);if(r&&u)return u=(H=Q.adjacentNoneTextNode(u)[0])?H.nextSibling:z.firstChild,f=Q.adjacentNoneTextNode(u),H=f[0],f=f[1],H?(t.moveToElementText(H),t.collapse(!1)):t.moveToElementText(z),t.setEndPoint(q,m),p=t.text.length-f,!1;x=H;return!0});else{var u=z;var p=0}l||1!=u.nodeType||p!=u.childNodes.length||(l=u.nextSibling)&&3==l.nodeType&&(u=
l,p=0);return[u,p]},setEndPoint:function(m,l,t){m=m.duplicate();var q;if(3!=l.nodeType)if(0<t){if(q=l.childNodes[t-1])if(3==q.nodeType)l=q,t=q.length;else if(q.nextSibling&&3==q.nextSibling.nodeType)l=q.nextSibling,t=0;else{m.moveToElementText(q.nextSibling?q:l);var z=q.parentNode;q=z.insertBefore(q.ownerDocument.createTextNode(" "),q.nextSibling);m.collapse(!1);z.removeChild(q)}}else m.moveToElementText(l),m.collapse(!0);3==l.nodeType&&(q=Q.adjacentNoneTextNode(l),z=q[0],q=q[1],z?(m.moveToElementText(z),
m.collapse(!1),"inherit"!=z.contentEditable&&q++):(m.moveToElementText(l.parentNode),m.collapse(!0),m.move("character",1),m.move("character",-1)),t+=q,0<t&&m.move("character",t)!=t&&console.error("Error when moving!"));return m},decomposeTextRange:function(m){var l=e.getEndPoint(m),t=l[0],q=l[1],z=l[0];l=l[1];m.htmlText.length&&(m.htmlText==m.text?l=q+m.text.length:(l=e.getEndPoint(m,!0),z=l[0],l=l[1]));return[t,q,z,l]},setRange:function(m,l,t,q,z,x){l=e.setEndPoint(m,l,t);m.setEndPoint("StartToStart",
l);if(!x)var u=e.setEndPoint(m,q,z);m.setEndPoint("EndToEnd",u||l);return m}},v=Q.W3CRange=J(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?Q.getCommonAncestor(this.startContainer,
this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(m,l){l=parseInt(l);if(this.startContainer!==m||this.startOffset!=l)delete this._cachedBookmark,this.startContainer=m,this.startOffset=l,this.endContainer?this._updateInternal():this.setEnd(m,l)},setEnd:function(m,l){l=parseInt(l);if(this.endContainer!==m||this.endOffset!=l)delete this._cachedBookmark,this.endContainer=m,this.endOffset=l,this.startContainer?
this._updateInternal():this.setStart(m,l)},setStartAfter:function(m,l){this._setPoint("setStart",m,l,1)},setStartBefore:function(m,l){this._setPoint("setStart",m,l,0)},setEndAfter:function(m,l){this._setPoint("setEnd",m,l,1)},setEndBefore:function(m,l){this._setPoint("setEnd",m,l,0)},_setPoint:function(m,l,t,q){t=Q.getIndex(l,l.parentNode).o;this[m](l.parentNode,t.pop()+q)},_getIERange:function(){var m=(this._body||this.endContainer.ownerDocument.body).createTextRange();e.setRange(m,this.startContainer,
this.startOffset,this.endContainer,this.endOffset,this.collapsed);return m},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var m=this.startContainer,l=this._getIERange();3!==m.nodeType||this.startOffset||this.setStartBefore(m);l.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var m=new v([this.startContainer,this.startOffset,
this.endContainer,this.endOffset]);m._body=this._body;return m},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});D.setObject("dijit.range",Q);return Q})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(P,J,D){var Q={};J.setObject("dijit._editor.html",Q);var e=Q.escapeXml=function(v,m){v=v.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,
"\x26gt;").replace(/"/gm,"\x26quot;");m||(v=v.replace(/'/gm,"\x26#39;"));return v};Q.getNodeHtml=function(v){var m=[];Q.getNodeHtmlHelper(v,m);return m.join("")};Q.getNodeHtmlHelper=function(v,m){switch(v.nodeType){case 1:var l=v.nodeName.toLowerCase();if(!l||"/"==l.charAt(0))return"";m.push("\x3c",l);var t=[],q={},z;if(D("dom-attributes-explicit")||D("dom-attributes-specified-flag"))for(var x=0;z=v.attributes[x++];){var u=z.name;"_dj"===u.substr(0,3)||D("dom-attributes-specified-flag")&&!z.specified||
u in q||(z=z.value,("src"==u||"href"==u)&&v.getAttribute("_djrealurl")&&(z=v.getAttribute("_djrealurl")),8===D("ie")&&"style"===u&&(z=z.replace("HEIGHT:","height:").replace("WIDTH:","width:")),t.push([u,z]),q[u]=z)}else{var p=(/^input$|^img$/i.test(v.nodeName)?v:v.cloneNode(!1)).outerHTML;q=p.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi);p=p.substr(0,p.indexOf("\x3e"));P.forEach(q,function(H){if(H){var f=H.indexOf("\x3d");if(0<f&&(H=H.substring(0,f),"_dj"!=H.substr(0,3)))if("src"!=H&&"href"!=H||!v.getAttribute("_djrealurl")){switch(H){case "style":var r=
v.style.cssText.toLowerCase();break;case "class":r=v.className;break;case "width":if("img"===l){(f=/width=(\S+)/i.exec(p))&&(r=f[1]);break}case "height":if("img"===l){(f=/height=(\S+)/i.exec(p))&&(r=f[1]);break}default:r=v.getAttribute(H)}null!=r&&t.push([H,r.toString()])}else t.push([H,v.getAttribute("_djrealurl")])}},this)}t.sort(function(H,f){return H[0]<f[0]?-1:H[0]==f[0]?0:1});for(q=0;z=t[q++];)m.push(" ",z[0],'\x3d"',"string"===typeof z[1]?e(z[1],!0):z[1],'"');switch(l){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":m.push(" /\x3e");
break;case "script":m.push("\x3e",v.innerHTML,"\x3c/",l,"\x3e");break;default:m.push("\x3e"),v.hasChildNodes()&&Q.getChildrenHtmlHelper(v,m),m.push("\x3c/",l,"\x3e")}break;case 4:case 3:m.push(e(v.nodeValue,!0));break;case 8:m.push("\x3c!--",e(v.nodeValue,!0),"--\x3e");break;default:m.push("\x3c!-- Element not recognized - Type: ",v.nodeType," Name: ",v.nodeName,"--\x3e")}};Q.getChildrenHtml=function(v){var m=[];Q.getChildrenHtmlHelper(v,m);return m.join("")};Q.getChildrenHtmlHelper=function(v,m){if(v)for(var l=
v.childNodes||v,t=!D("ie")||l!==v,q,z=0;q=l[z++];)t&&q.parentNode!=v||Q.getNodeHtmlHelper(q,m)};return Q})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(P,J,D,Q,e,v,m,l,t,q,z,x,u){var p=D("dijit._editor.plugins.LinkDialog",z,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:x,useDefaultCommand:!1,
urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=v.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(f){P("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),v.hitch(this,function(r,y,V){var N=this;this.tag="insertImage"==this.command?"img":"a";r=v.delegate(r.getLocalization("dijit","common",this.lang),r.getLocalization("dijit._editor",
"LinkDialog",this.lang));var Z=this.dropDown=this.button.dropDown=new y({title:r[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:v.hitch(this,"setValue"),onOpen:function(){N._onOpenDialog();y.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(v.hitch(N,"_onCloseDialog"),0)}});r.urlRegExp=this.urlRegExp;r.id=V.getUniqueId(this.editor.id);this._uniqueId=r.id;this._setContent(Z.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
q.substitute(this.linkDialogTemplate,r));Z.startup();this._urlInput=V.byId(this._uniqueId+"_urlInput");this._textInput=V.byId(this._uniqueId+"_textInput");this._setButton=V.byId(this._uniqueId+"_setButton");this.own(V.byId(this._uniqueId+"_cancelButton").on("click",v.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",v.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",v.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=v.hitch(this,function(){var W=this._urlInput.get("value");return this._urlRegExp.test(W)||this._emailRegExp.test(W)});this.own(m(Z.domNode,"keydown",v.hitch(this,v.hitch(this,function(W){!W||W.keyCode!=e.ENTER||W.shiftKey||W.metaKey||W.ctrlKey||W.altKey||this._setButton.get("disabled")||(Z.onExecute(),Z.execute(Z.get("value")))}))));f()}))},_checkAndFixInput:function(){var f=this,r=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var y=r,V=!1,N=!1;y&&1<y.length&&(y=v.trim(y),0!==y.indexOf("mailto:")&&(0<y.indexOf("/")?-1===y.indexOf("://")&&"/"!==y.charAt(0)&&y.indexOf("./")&&0!==y.indexOf("../")&&f._hostRxp.test(y)&&(V=!0):f._userAtRxp.test(y)&&(N=!0)));V&&f._urlInput.set("value","http://"+y);N&&f._urlInput.set("value","mailto:"+y);f._setButton.set("disabled",!f._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(v.hitch(this,
function(){this.own(m(this.editor.editNode,"mouseup",v.hitch(this,"_onMouseUp")));this.own(m(this.editor.editNode,"dblclick",v.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(f){this.dropDown.set({parserScope:"dojo",content:f})},_checkValues:function(f){f&&f.urlInput&&(f.urlInput=f.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&f&&f.textInput&&("function"===typeof this.linkFilter?f.textInput=this.linkFilter(f.textInput):
J.forEach(this.linkFilter,function(r){f.textInput=f.textInput.replace(r[0],r[1])}));return f},_createlinkEnabledImpl:function(){return!0},setValue:function(f){this._onCloseDialog();if(9>l("ie")){var r=u.getSelection(this.editor.window).getRangeAt(0).endContainer;3===r.nodeType&&(r=r.parentNode);r&&r.nodeName&&r.nodeName.toLowerCase()!==this.tag&&(r=this.editor.selection.getSelectedElement(this.tag));r&&r.nodeName&&r.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(r),
this.editor.execCommand("unlink"))}f=this._checkValues(f);this.editor.execCommand("inserthtml",q.substitute(this.htmlTemplate,f));t("a",this.editor.document).forEach(function(y){y.innerHTML||Q.has(y,"name")||y.parentNode.removeChild(y)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(f){if(f&&f.tagName.toLowerCase()===this.tag){var r=f.getAttribute("_djrealurl")||f.getAttribute("href");var y=f.getAttribute("target")||"_self";var V=f.textContent||
f.innerText;this.editor.selection.selectElement(f,!0)}else V=this.editor.selection.getSelectedText();return{urlInput:r||"",textInput:V||"",targetSelect:y||""}},_onOpenDialog:function(){if(l("ie")){var f=u.getSelection(this.editor.window);if(f.rangeCount){var r=f.getRangeAt(0);var y=r.endContainer;3===y.nodeType&&(y=y.parentNode);y&&y.nodeName&&y.nodeName.toLowerCase()!==this.tag&&(y=this.editor.selection.getSelectedElement(this.tag));if(!y||y.nodeName&&y.nodeName.toLowerCase()!==this.tag)(f=this.editor.selection.getAncestorElement(this.tag))&&
f.nodeName&&f.nodeName.toLowerCase()==this.tag?(y=f,this.editor.selection.selectElement(y)):r.startContainer===r.endContainer&&(f=r.startContainer.firstChild)&&f.nodeName&&f.nodeName.toLowerCase()==this.tag&&(y=f,this.editor.selection.selectElement(y))}}else y=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(y))},_onDblClick:function(f){if(f&&f.target&&(f=f.target,(f.tagName?f.tagName.toLowerCase():
"")===this.tag&&Q.get(f,"href"))){var r=this.editor;this.editor.selection.selectElement(f);r.onDisplayChanged();r._updateTimer&&(r._updateTimer.remove(),delete r._updateTimer);r.onNormalizedDisplayChanged();var y=this.button;setTimeout(function(){y.set("disabled",!1);y.loadAndOpenDropDown().then(function(){y.dropDown.focus&&y.dropDown.focus()})},10)}},_onMouseUp:function(){if(l("ff")){var f=this.editor.selection.getAncestorElement(this.tag);if(f){var r=u.getSelection(this.editor.window).getRangeAt(0);
if(r.collapsed&&f.childNodes.length){var y=r.cloneRange();y.selectNodeContents(f.childNodes[f.childNodes.length-1]);y.setStart(f.childNodes[0],0);1!==r.compareBoundaryPoints(y.START_TO_START,y)?r.setStartBefore(f):-1!==r.compareBoundaryPoints(y.END_TO_START,y)&&r.setStartAfter(f)}}}}}),H=D("dijit._editor.plugins.ImgLinkDialog",[p],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(f){if(f&&f.tagName.toLowerCase()===this.tag){var r=f.getAttribute("_djrealurl")||f.getAttribute("src");var y=f.getAttribute("alt");this.editor.selection.selectElement(f,!0)}else y=this.editor.selection.getSelectedText();return{urlInput:r||"",textInput:y||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(v.hitch(this,function(){this.own(m(this.editor.editNode,"mousedown",v.hitch(this,"_selectTag")))}))},_selectTag:function(f){f&&f.target&&(f=f.target,(f.tagName?f.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(f))},_checkValues:function(f){f&&f.urlInput&&(f.urlInput=f.urlInput.replace(/"/g,"\x26quot;"));f&&f.textInput&&(f.textInput=f.textInput.replace(/"/g,"\x26quot;"));return f},_onDblClick:function(f){if(f&&f.target&&(f=f.target,(f.tagName?
f.tagName.toLowerCase():"")===this.tag&&Q.get(f,"src"))){var r=this.editor;this.editor.selection.selectElement(f);r.onDisplayChanged();r._updateTimer&&(r._updateTimer.remove(),delete r._updateTimer);r.onNormalizedDisplayChanged();var y=this.button;setTimeout(function(){y.set("disabled",!1);y.loadAndOpenDropDown().then(function(){y.dropDown.focus&&y.dropDown.focus()})},10)}}});z.registry.createLink=function(f){var r={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in f?f.allowUnsafeHtml:!1};
"linkFilter"in f&&(r.linkFilter=f.linkFilter);return new p(r)};z.registry.insertImage=function(){return new H({command:"insertImage"})};p.ImgLinkDialog=H;return p})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(P,J,D,Q,e,v){var m=D("dijit._editor.plugins.TextColor",e,{buttonClass:v,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;
this.inherited(arguments);var l=this;this.button.loadDropDown=function(t){function q(z){l.button.dropDown=new z({dir:l.editor.dir,ownerDocument:l.editor.ownerDocument,value:l.value,onChange:function(x){l.editor.execCommand(l.command,x)},onExecute:function(){l.editor.execCommand(l.command,this.get("value"))}});t()}"string"==typeof l.colorPicker?P([l.colorPicker],q):q(l.colorPicker)}},updateState:function(){var l=this.editor,t=this.command;if(l&&l.isLoaded&&t.length){if(this.button){var q=this.get("disabled");
this.button.set("disabled",q);if(q)return;try{var z=l.queryCommandValue(t)||""}catch(x){z=""}}""==z&&(z="#000000");"transparent"==z&&(z="#ffffff");"string"==typeof z?-1<z.indexOf("rgb")&&(z=J.fromRgb(z).toHex()):(z=((z&255)<<16|z&65280|(z&16711680)>>>16).toString(16),z="#000000".slice(0,7-z.length)+z);this.value=z;(l=this.button.dropDown)&&l.get&&z!==l.get("value")&&l.set("value",z,!1)}}});e.registry.foreColor=function(l){return new m(l)};e.registry.hiliteColor=function(l){return new m(l)};return m})},
"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),function(P,J,D,Q,e,v,m,l,t,q,z,x,u,p,H,f,r){P=P([q,z],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,
templateString:f,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}' style\x3d'display: flex;'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;padding:0 2px;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},constructor:function(y,V){J.mixin(this,r.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);
this._uploadField_connect=D.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=D.connect(this._uploadField,"onfocus",J.hitch(this,function(y){H.hide(this._attachmentError)}))},destroy:function(){Q.forEach(this._aeConnects,D.disconnect);D.disconnect(this._uploadField_connect);D.disconnect(this._uploadFieldFocus_connect);this.inherited(arguments)},showAttachments:function(y,V){this._attachmentList.innerHTML=this.NLS_none;
this._uploadField.value="";Q.forEach(this.domNode.children,function(N,Z){H.show(N)});H.hide(this._attachmentError);y&&(this._featureLayer=y.getLayer()||V)&&("esri.layers.FeatureLayer"===this._featureLayer.declaredClass&&this._featureLayer.getEditCapabilities?(this._currentLayerId=this._featureLayer.id,this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0),this._featureCanUpdate=
this._featureLayer.getEditCapabilities({feature:y}).canUpdate,this._oid=y.attributes[this._featureLayer.objectIdField],this._getAttachments(y)):V&&V.getEditCapabilities()||(H.hide(this._uploadForm),Q.forEach(this.domNode.children,function(N,Z){H.hide(N)})))},_getAttachments:function(y){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&this._featureLayer.queryAttachmentInfos(this._oid,J.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){H.hide(this._attachmentError);
this._featureLayer&&this._featureLayer.addAttachment?(H.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,J.hitch(this,"_onAddAttachmentComplete"),J.hitch(this,"_onAddAttachmentError"))):this._tempUpload=this._uploadForm},_chainAttachment:function(y,V){this._tempUpload&&(H.show(this._attachmentProgress),V.addAttachment(y,this._tempUpload,J.hitch(this,"_onAddAttachmentComplete"),J.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(y,
V){H.show(this._attachmentProgress);this._featureLayer.deleteAttachments(y,[V],J.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(y){var V=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate?(V=this._listHtml+this._endHtml,this._uploadForm.style.display=
"none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(V=this._listHtml+this._endHtml);var N=this._attachmentList;y=Q.map(y,J.hitch(this,function(Z){return p.substitute({href:Z.url,name:Z.name,oid:Z.objectId,attid:Z.id},V)}));N.innerHTML=y.join("")||this.NLS_none;this._updateConnects()},_onAddAttachmentComplete:function(y){H.hide(this._attachmentProgress.domNode);var V=this._attachmentList,N=this._uploadField,Z=N.value,W=Z.lastIndexOf("\\");
-1<W&&(Z=Z.substring(W+1,Z.length));Z=Z.replace(/ /g,"_");W=l.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var k=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(k=this._listHtml+this._endHtml);y=p.substitute({href:this._featureLayer._url.path+"/"+y.objectId+"/attachments/"+y.attachmentId+(W?"?"+W:""),name:Z,oid:y.objectId,attid:y.attachmentId},
k);V.innerHTML=V.innerHTML==this.NLS_none?y:V.innerHTML+y;this._updateConnects();N.value=""},_onAddAttachmentError:function(y){H.hide(this._attachmentProgress.domNode);if(y){var V=this.NLS_error,N=this._attachmentError;p.isDefined(y.code)&&400===y.code&&(V=this.NLS_fileNotSupported);t.set(N,"innerHTML",V);H.show(N)}},_onDeleteAttachmentComplete:function(y){H.hide(this._attachmentProgress.domNode);var V=this._attachmentList;Q.every(y,function(N){return N.success})&&(e.query("#node_"+y[0].objectId+
"_"+y[0].attachmentId).orphan(),V.children&&V.children.length||(V.innerHTML=this.NLS_none))},_updateConnects:function(){Q.forEach(this._aeConnects,D.disconnect);e.query(".deleteAttachment").forEach(function(y){this._aeConnects.push(D.connect(y,"onclick",J.hitch(this,"_deleteAttachment",this._oid,y.id)))},this)}});v("extend-esri")&&J.setObject("dijit.editing.AttachmentEditor",P,u);return P})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),
function(P,J,D,Q,e,v,m,l){return J("dijit.ProgressBar",[v,m],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:l,_indeterminateHighContrastImagePath:P.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(t){var q="rtl"==t.toLowerCase();D.toggle(this.domNode,"dijitProgressBarRtl",q);D.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&q);this.inherited(arguments)},update:function(t){Q.mixin(this,t||{});t=this.internalProgress;var q=this.domNode,z=1;this.indeterminate?q.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(z=Math.min(parseFloat(this.progress)/100,1),this.progress=z*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),z=this.maximum?this.progress/this.maximum:0),q.setAttribute("aria-valuenow",this.progress));q.setAttribute("aria-labelledby",this.labelNode.id);q.setAttribute("aria-valuemin",0);q.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(z);D.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);D.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());t.style.width=100*z+"%";this.onChange()},_setValueAttr:function(t){this._set("value",
t);Infinity==t?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:t})},_setLabelAttr:function(t){this._set("label",t);this.update()},_setIndeterminateAttr:function(t){this._set("indeterminate",t);this.update()},report:function(t){return this.label?this.label:this.indeterminate?"\x26#160;":e.format(t,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],
function(P,J,D,Q){var e={};e={findFeatures:function(v,m,l){var t=m.objectIdField;m=J.filter(m.graphics,function(q){return J.some(v,function(z){return q.attributes[t]===z.objectId})});if(l)l(m);else return m},getSelection:function(v){var m=[];J.forEach(v,function(l){l=l.getSelectedFeatures();J.forEach(l,function(t){m.push(t)})});return m},sortFeaturesById:function(v,m){var l=J.map(v,function(t){return t.featureLayer});m.sort(function(t,q){var z=t.getLayer(),x=q.getLayer();if(!z)return-1;if(!x)return 1;
var u=J.indexOf(l,z);x=J.indexOf(l,x);u-=x;u||(z=z.objectIdField,u=t.attributes[z]-q.attributes[z]);return u});return m}};D("extend-esri")&&P.setObject("dijit.editing.Util.LayerHelper",e,Q);return e})},"dojox/date/islamic":function(){define(["dojox/main","dojo/_base/lang","dojo/date","./islamic/Date"],function(P,J,D,Q){var e=J.getObject("date.islamic",!0,P);e.getDaysInMonth=function(v){return v.getDaysInIslamicMonth(v.getMonth(),v.getFullYear())};e.compare=function(v,m,l){v instanceof Q&&(v=v.toGregorian());
m instanceof Q&&(m=m.toGregorian());return D.compare.apply(null,arguments)};e.add=function(v,m,l){var t=new Q(v);switch(m){case "day":t.setDate(v.getDate()+l);break;case "weekday":var q=v.getDay();if(5>q+l&&0<q+l)t.setDate(v.getDate()+l);else{var z=m=0;5==q?(q=4,z=0<l?-1:1):6==q&&(q=4,z=0<l?-2:2);q=0<l?5-q-1:-q;var x=l-q,u=parseInt(x/5);0!=x%5&&(m=0<l?2:-2);m=m+7*u+x%5+q;t.setDate(v.getDate()+m+z)}break;case "year":t.setFullYear(v.getFullYear()+l);break;case "week":l*=7;t.setDate(v.getDate()+l);break;
case "month":v=v.getMonth();t.setMonth(v+l);break;case "hour":t.setHours(v.getHours()+l);break;case "minute":t._addMinutes(l);break;case "second":t._addSeconds(l);break;case "millisecond":t._addMilliseconds(l)}return t};e.difference=function(v,m,l){m=m||new Q;l=l||"day";var t=m.getFullYear()-v.getFullYear(),q=1;switch(l){case "weekday":t=Math.round(e.difference(v,m,"day"));q=parseInt(e.difference(v,m,"week"));if(0==t%7)t=5*q;else{l=0;var z=v.getDay(),x=m.getDay();q=parseInt(t/7);m=t%7;v=new Q(v);
v.setDate(v.getDate()+7*q);v=v.getDay();if(0<t)switch(!0){case 5==z:l=-1;break;case 6==z:l=0;break;case 5==x:l=-1;break;case 6==x:l=-2;break;case 5<v+m:l=-2}else if(0>t)switch(!0){case 5==z:l=0;break;case 6==z:l=1;break;case 5==x:l=2;break;case 6==x:l=1;break;case 0>v+m:l=2}t=t+l-2*q}q=t;break;case "year":q=t;break;case "month":l=m.toGregorian()>v.toGregorian()?m:v;z=m.toGregorian()>v.toGregorian()?v:m;q=l.getMonth();x=z.getMonth();if(0==t)q=l.getMonth()-z.getMonth();else for(q=12-x+q,t=z.getFullYear()+
1,l=l.getFullYear(),t;t<l;t++)q+=12;m.toGregorian()<v.toGregorian()&&(q=-q);break;case "week":q=parseInt(e.difference(v,m,"day")/7);break;case "day":q/=24;case "hour":q/=60;case "minute":q/=60;case "second":q/=1E3;case "millisecond":q*=m.toGregorian().getTime()-v.toGregorian().getTime()}return Math.round(q)};return e})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(P,J,D){var Q=J("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,
_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var e=arguments.length;e?1==e?(e=arguments[0],"number"==typeof e&&(e=new Date(e)),e instanceof Date?this.fromGregorian(e):""==e?this._date=new Date(""):(this._year=e._year,this._month=e._month,this._date=e._date,this._hours=e._hours,this._minutes=e._minutes,this._seconds=e._seconds,this._milliseconds=e._milliseconds)):3<=e&&(this._year+=arguments[0],this._month+=arguments[1],this._date+=
arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},getMilliseconds:function(){return this._milliseconds},
setDate:function(e){e=parseInt(e);if(!(0<e&&e<=this.getDaysInIslamicMonth(this._month,this._year))){var v;if(0<e)for(v=this.getDaysInIslamicMonth(this._month,this._year);e>v;e-=v,v=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(v=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=e;v=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:
this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),e+=v}this._date=e;return this},setFullYear:function(e){this._year=+e},setMonth:function(e){this._year+=Math.floor(e/12);this._month=0<e?Math.floor(e%12):Math.floor((e%12+12)%12)},setHours:function(){var e=arguments.length,v=0;1<=e&&(v=parseInt(arguments[0]));2<=e&&(this._minutes=parseInt(arguments[1]));3<=e&&(this._seconds=parseInt(arguments[2]));4==e&&(this._milliseconds=parseInt(arguments[3]));for(;24<=v;)this._date++,e=this.getDaysInIslamicMonth(this._month,
this._year),this._date>e&&(this._month++,12<=this._month&&(this._year++,this._month-=12),this._date-=e),v-=24;this._hours=v},_addMinutes:function(e){e+=this._minutes;this.setMinutes(e);this.setHours(this._hours+parseInt(e/60));return this},_addSeconds:function(e){e+=this._seconds;this.setSeconds(e);this._addMinutes(parseInt(e/60));return this},_addMilliseconds:function(e){e+=this._milliseconds;this.setMilliseconds(e);this._addSeconds(parseInt(e/1E3));return this},setMinutes:function(e){this._minutes=
e%60;return this},setSeconds:function(e){this._seconds=e%60;return this},setMilliseconds:function(e){this._milliseconds=e%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var e=new Date;e.setHours(this._hours);e.setMinutes(this._minutes);e.setSeconds(this._seconds);e.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+e.toTimeString()},toGregorian:function(){var e=this._year;e=Math.floor(this._date+Math.ceil(29.5*this._month)+354*
(e-1)+Math.floor((3+11*e)/30)+this._ISLAMIC_EPOCH-1-.5)+.5;var v=e-this._GREGORIAN_EPOCH,m=Math.floor(v/146097),l=this._mod(v,146097);v=Math.floor(l/36524);var t=this._mod(l,36524);l=Math.floor(t/1461);t=this._mod(t,1461);t=Math.floor(t/365);m=400*m+100*v+4*l+t;4!=v&&4!=t&&m++;v=e-(this._GREGORIAN_EPOCH+365*(m-1)+Math.floor((m-1)/4)-Math.floor((m-1)/100)+Math.floor((m-1)/400));l=this._GREGORIAN_EPOCH-1+365*(m-1)+Math.floor((m-1)/4)-Math.floor((m-1)/100)+Math.floor((m-1)/400)+Math.floor(739/12+(D.isLeapYear(new Date(m,
3,1))?-1:-2)+1);l=e<l?0:D.isLeapYear(new Date(m,3,1))?1:2;v=Math.floor((12*(v+l)+373)/367);l=this._GREGORIAN_EPOCH-1+365*(m-1)+Math.floor((m-1)/4)-Math.floor((m-1)/100)+Math.floor((m-1)/400)+Math.floor((367*v-362)/12+(2>=v?0:D.isLeapYear(new Date(m,v-1,1))?-1:-2)+1);return new Date(m,v-1,e-l+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(e){e=new Date(e);var v=e.getFullYear(),m=e.getMonth(),l=e.getDate();v=this._GREGORIAN_EPOCH-1+365*(v-1)+Math.floor((v-1)/4)+
-Math.floor((v-1)/100)+Math.floor((v-1)/400)+Math.floor((367*(m+1)-362)/12+(2>=m+1?0:D.isLeapYear(e)?-1:-2)+l);v=Math.floor(v)+.5;v-=this._ISLAMIC_EPOCH;m=Math.floor((30*v+10646)/10631);l=Math.ceil((v-29-this._yearStart(m))/29.5);l=Math.min(l,11);this._date=Math.ceil(v-this._monthStart(m,l))+1;this._month=l;this._year=m;this._hours=e.getHours();this._minutes=e.getMinutes();this._seconds=e.getSeconds();this._milliseconds=e.getMilliseconds();this._day=e.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},
_yearStart:function(e){return 354*(e-1)+Math.floor((3+11*e)/30)},_monthStart:function(e,v){return Math.ceil(29.5*v)+354*(e-1)+Math.floor((3+11*e)/30)},_civilLeapYear:function(e){return 11>(14+11*e)%30},getDaysInIslamicMonth:function(e,v){var m=0;m=29+(e+1)%2;11==e&&this._civilLeapYear(v)&&m++;return m},_mod:function(e,v){return e-v*Math.floor(e/v)}});Q.getDaysInIslamicMonth=function(e){return(new Q).getDaysInIslamicMonth(e.getMonth(),e.getFullYear())};return Q})},"dojox/date/islamic/locale":function(){define("dojox/main dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),
function(P,J,D,Q,e,v,m,l,t){function q(H,f,r,y,V){return V.replace(/([a-z])\1*/ig,function(N){var Z=N.charAt(0);N=N.length;var W=["abbr","wide","narrow"];switch(Z){case "G":var k=f.eraAbbr[0];break;case "y":k=String(H.getFullYear());break;case "M":k=H.getMonth();if(3>N){k+=1;var g=!0}else Z=["months-format",W[N-3]].join("-"),k=f[Z][k];break;case "d":k=H.getDate(!0);g=!0;break;case "E":k=H.getDay();3>N?(k+=1,g=!0):(Z=["days-format",W[N-3]].join("-"),k=f[Z][k]);break;case "a":k=12>H.getHours()?"am":
"pm";k=f["dayPeriods-format-wide-"+k];break;case "h":case "H":case "K":case "k":g=H.getHours();switch(Z){case "h":k=g%12||12;break;case "H":k=g;break;case "K":k=g%12;break;case "k":k=g||24}g=!0;break;case "m":k=H.getMinutes();g=!0;break;case "s":k=H.getSeconds();g=!0;break;case "S":k=Math.round(H.getMilliseconds()*Math.pow(10,N-3));g=!0;break;case "z":if(k=Q.getTimezoneName(H.toGregorian()))break;N=4;case "Z":k=H.toGregorian().getTimezoneOffset();k=[0>=k?"+":"-",m.pad(Math.floor(Math.abs(k)/60),2),
m.pad(Math.abs(k)%60,2)];4==N&&(k.splice(0,0,"GMT"),k.splice(3,0,":"));k=k.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+V);}g&&(k=m.pad(k,N));return k})}function z(H,f,r,y){var V=function(W){return W};f=f||V;r=r||V;y=y||V;var N=H.match(/(''|[^'])+/g),Z="'"==H.charAt(0);D.forEach(N,function(W,k){W?(N[k]=(Z?r:f)(W),Z=!Z):N[k]=""});return y(N.join(""))}function x(H,f,r,y){y=v.escapeString(y);e.normalizeLocale(r.locale);return y.replace(/([a-z])\1*/ig,
function(V){var N=V.charAt(0);var Z=V.length,W="";r.strict?1<Z&&(W="0{"+(Z-1)+"}"):W="0?";switch(N){case "y":N="\\d+";break;case "M":N=2<Z?"\\S+ ?\\S+":W+"[1-9]|1[0-2]";break;case "d":N="[12]\\d|"+W+"[1-9]|3[01]";break;case "E":N="\\S+";break;case "h":N=W+"[1-9]|1[0-2]";break;case "k":N=W+"\\d|1[01]";break;case "H":N=W+"\\d|1\\d|2[0-3]";break;case "K":N=W+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":N=W+"\\d|[0-5]\\d";break;case "S":N="\\d{"+Z+"}";break;case "a":Z=r.am||f["dayPeriods-format-wide-am"];
W=r.pm||f["dayPeriods-format-wide-pm"];r.strict?N=Z+"|"+W:(N=Z+"|"+W,Z!=Z.toLowerCase()&&(N+="|"+Z.toLowerCase()),W!=W.toLowerCase()&&(N+="|"+W.toLowerCase()));break;default:N=".*"}H&&H.push(V);return"("+N+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var u=J.getObject("date.islamic.locale",!0,P);u.format=function(H,f){f=f||{};var r=e.normalizeLocale(f.locale),y=f.formatLength||"short",V=u._getIslamicBundle(r),N=[];r=J.hitch(this,q,H,V,r,f.fullYear);if("year"==f.selector)return H.getFullYear();"time"!=f.selector&&
(H=f.datePattern||V["dateFormat-"+y])&&N.push(z(H,r));"date"!=f.selector&&(f=f.timePattern||V["timeFormat-"+y])&&N.push(z(f,r));return N.join(" ")};u.regexp=function(H){return u._parseInfo(H).regexp};u._parseInfo=function(H){H=H||{};var f=e.normalizeLocale(H.locale);f=u._getIslamicBundle(f);var r=H.formatLength||"short",y=H.datePattern||f["dateFormat-"+r];r=H.timePattern||f["timeFormat-"+r];var V=[];return{regexp:z("date"==H.selector?y:"time"==H.selector?r:"undefined"==typeof r?y:y+" "+r,J.hitch(this,
x,V,f,H)),tokens:V,bundle:f}};u.parse=function(H,f){H=H.replace(/[\u200E\u200F\u202A\u202E]/g,"");f||(f={});var r=u._parseInfo(f),y=r.tokens,V=r.bundle;r=r.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");H=(new RegExp("^"+r+"$")).exec(H);e.normalizeLocale(f.locale);if(!H)return null;var N=[1389,0,1,0,0,0,0],Z="",W=["abbr","wide","narrow"];D.every(H,function(k,g){if(!g)return!0;g=y[g-1];var I=g.length;switch(g.charAt(0)){case "y":N[0]=Number(k);break;case "M":if(2<I){if(g=V["months-format-"+W[I-3]].concat(),
f.strict||(k=k.replace(".","").toLowerCase(),g=D.map(g,function(S){return S?S.replace(".","").toLowerCase():S})),k=D.indexOf(g,k),-1==k)return!1}else k--;N[1]=Number(k);break;case "D":N[1]=0;case "d":N[2]=Number(k);break;case "a":g=f.am||V["dayPeriods-format-wide-am"];I=f.pm||V["dayPeriods-format-wide-pm"];if(!f.strict){var F=/\./g;k=k.replace(F,"").toLowerCase();g=g.replace(F,"").toLowerCase();I=I.replace(F,"").toLowerCase()}if(f.strict&&k!=g&&k!=I)return!1;Z=k==I?"p":k==g?"a":"";break;case "K":24==
k&&(k=0);case "h":case "H":case "k":N[3]=Number(k);break;case "m":N[4]=Number(k);break;case "s":N[5]=Number(k);break;case "S":N[6]=Number(k)}return!0});H=+N[3];"p"===Z&&12>H?N[3]=H+12:"a"===Z&&12==H&&(N[3]=0);return new l(N[0],N[1],N[2],N[3],N[4],N[5],N[6])};var p=[];u.addCustomFormats=function(H,f){p.push({pkg:H,name:f})};u._getIslamicBundle=function(H){var f={};D.forEach(p,function(r){r=e.getLocalization(r.pkg,r.name,H);f=J.mixin(f,r)},this);return f};u.addCustomFormats("dojo.cldr","islamic");u.getNames=
function(H,f,r,y,V){y=u._getIslamicBundle(y);H=[H,r,f];if("standAlone"==r){r=H.join("-");var N=y[r];1==N[0]&&(N=void 0)}H[1]="format";return(N||y[H.join("-")]).concat()};u.weekDays=u.getNames("days","wide","format");u.months=u.getNames("months","wide","format");return u})},"widgets/NetworkTrace/highlightSymbolUtils":function(){define("dojo/_base/lang dojo/_base/array esri/geometry/Point esri/geometry/Polygon esri/geometry/Polyline esri/graphic esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/Color".split(" "),
function(P,J,D,Q,e,v,m,l,t,q){var z={getHighLightSymbol:function(x,u){switch(x.geometry.type){case "point":return z._getPointSymbol(x,u);case "polyline":return z._getPolyLineSymbol(x,u);case "polygon":return z._getPolygonSymbol(x,u)}},_getSizeInfo:function(x){var u=null;x.renderer.visualVariables&&J.forEach(x.renderer.visualVariables,P.hitch(this,function(p){"sizeInfo"===p.type&&(u=p)}));return u},_getPointSymbol:function(x,u){var p,H;var f=!1;var r=new m(m.STYLE_SQUARE,null,new l(l.STYLE_SOLID,new q([0,
255,255,1]),3));r.setColor(null);r.size=30;if(u&&u.renderer)if(u.renderer.symbol)f=!0,r=z._updatePointSymbolProperties(r,u.renderer.symbol);else if(u.renderer.infos&&0<u.renderer.infos.length){for(H=0;H<u.renderer.infos.length;H++){u.typeIdField?p=x.attributes[u.typeIdField]:u.renderer.attributeField&&(p=x.attributes[u.renderer.attributeField]);var y=u.renderer.infos[H].value;void 0!==p&&null!==p&&""!==p&&void 0!==y&&null!==y&&""!==y&&p.toString()===y.toString()&&(f=!0,r=z._updatePointSymbolProperties(r,
u.renderer.infos[H].symbol))}!f&&u.renderer.defaultSymbol&&(f=!0,r=z._updatePointSymbolProperties(r,u.renderer.defaultSymbol))}u&&u.graphics&&0<u.graphics.length&&u._getSymbol(x)&&((p=x.getShape())&&p.shape?p.shape.hasOwnProperty("r")?(f=!0,r.size=2*p.shape.r+10):p.shape.hasOwnProperty("width")&&(f=!0,u.renderer&&u.renderer.infos&&0<u.renderer.infos.length&&(r=z._updatePointSymbolProperties(r,u.renderer.infos[0].symbol)),r.size=p.shape.width+10):u.renderer.visualVariables&&(f=u._getRenderer(x),p=
z._getSizeInfo(u))&&(u=f.getSize(x,{sizeInfo:p,shape:u._getSymbol(x),resolution:u&&u.getResolutionInMeters&&u.getResolutionInMeters()}),null!==u&&(r.size=u+10)));u=new D(x.geometry.x,x.geometry.y,x.geometry.spatialReference);return new v(u,r,x.attributes)},_updatePointSymbolProperties:function(x,u){if(u.hasOwnProperty("height")&&u.hasOwnProperty("width")){var p=u.height;var H=u.width;p=(p>H?p:H)+10;x.size=p}u.hasOwnProperty("size")&&(!p||p<u.size)&&(x.size=u.size+10);u.hasOwnProperty("xoffset")&&
(x.xoffset=u.xoffset);u.hasOwnProperty("yoffset")&&(x.yoffset=u.yoffset);return x},_getPolyLineSymbol:function(x,u){var p,H;var f=5;if(u&&u.renderer)if(u.renderer.symbol&&u.renderer.symbol.hasOwnProperty("width"))f=u.renderer.symbol.width;else if(u.renderer.infos&&0<u.renderer.infos.length)for(H=0;H<u.renderer.infos.length;H++){u.typeIdField?p=x.attributes[u.typeIdField]:u.renderer.attributeField&&(p=x.attributes[u.renderer.attributeField]);var r=u.renderer.infos[H].value;void 0!==p&&null!==p&&""!==
p&&void 0!==r&&null!==r&&""!==r&&p.toString()===r.toString()&&u.renderer.infos[H].symbol.hasOwnProperty("width")&&(f=u.renderer.infos[H].symbol.width)}else u.renderer.defaultSymbol&&u.renderer.defaultSymbol.hasOwnProperty("width")&&(f=u.renderer.defaultSymbol.width);u=new l(l.STYLE_SOLID,new q([0,255,255,1]),f);f=new e(x.geometry.spatialReference);x.geometry.paths&&0<x.geometry.paths.length&&f.addPath(x.geometry.paths[0]);return new v(f,u,x.attributes)},_getPolygonSymbol:function(x){var u=new t(t.STYLE_SOLID,
new l(l.STYLE_SOLID,new q([0,255,255,1]),4),new q([0,0,0,0]));var p=new Q(x.geometry.spatialReference);x.geometry.rings&&(p.rings=P.clone(x.geometry.rings));return new v(p,u,x.attributes)}};return z})},"widgets/NetworkTrace/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv\x3e\r\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e        \r\n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e",
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\r\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\r\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\r\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\r\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/NetworkTrace/Widget.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"item esriCTMainParentContainer"\x3e\r\n        \x3cdiv class\x3d"content esriCTMainParentContentContainer" data-dojo-attach-point\x3d"mainParentContentContainer"\x3e\r\n            \x3c!-- Loading indicator starts --\x3e\r\n            \x3cdiv class\x3d"runIconidle" data-dojo-attach-point\x3d"loadingIcon"\x3e\x3c/div\x3e\r\n            \x3c!-- Loading indicator ends --\x3e\r\n            \x3c!-- New Or Load Project starts --\x3e\r\n            \x3cdiv class\x3d"esriCTLoadProjectParentContainer esriCTHidden"\r\n                data-dojo-attach-point\x3d"loadProjectParentContainer"\x3e\r\n                \x3cdiv class\x3d"esriCTLoadProjectDropDownContainer" data-dojo-attach-point\x3d"loadProjectDropdownContainer"\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTDisableEditProjectBtn" title\x3d"${nls.editProjectAttributesToolTip}"\r\n                    data-dojo-attach-event\x3d"onclick:_editProjectAttributes"\r\n                    data-dojo-attach-point\x3d"editProjectAttributes" role\x3d"button" tabindex\x3d"-1"\r\n                    aria-label\x3d"${nls.editProjectAttributesToolTip}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- New Or Load Project ends --\x3e\r\n            \x3c!-- Tab starts --\x3e\r\n            \x3cdiv class\x3d"esriCTInputOutputTabParentContainer esriCTHidden"\r\n                data-dojo-attach-point\x3d"inputOutputTabParentContainer"\x3e\r\n                \x3cdiv class\x3d"esriCTTabParentContainer" data-dojo-attach-point\x3d"tabContainerNetworkTrace"\x3e\r\n                    \x3c!-- Input tab main container starts --\x3e\r\n                    \x3cdiv class\x3d"esriCTInputParentMainContainer" data-dojo-attach-point\x3d"inputTabPanel"\x3e\r\n                        \x3c!-- Input tab summary text container starts --\x3e\r\n                        \x3cdiv class\x3d"esriCTClearBoth esriCTHidden" data-dojo-attach-point\x3d"inputTabSummaryTextContainer" role\x3d"presentation" tabindex\x3d"0"\x3e\r\n                        \x3c/div\x3e\r\n                        \x3c!-- Input tab summary text container ends --\x3e\r\n                        \x3c!-- Trace panel starts --\x3e\r\n                        \x3cdiv class\x3d"tracePanel" data-dojo-attach-point\x3d"tracePanel"\x3e\r\n                            \x3cdiv class\x3d"traceControls"\x3e\r\n                                \x3c!-- Flag icon starts --\x3e\r\n                                \x3cdiv class\x3d"btnFlagStyle" data-dojo-attach-point\x3d"flagIconMainContainer"\x3e\r\n                                    \x3c!-- aria-label added at runtime as it needs to fetched from config --\x3e\r\n                                    \x3cdiv class\x3d"flagbutton esriCTHidden" data-dojo-attach-point\x3d"btnFlag"\r\n                                        aria-pressed\x3d"false" role\x3d"button" tabindex\x3d"0"\r\n                                        data-dojo-attach-event\x3d"onclick:_onFlagButtonClick"\x3e\r\n                                    \x3c/div\x3e\r\n                                    \x3clabel class\x3d"flagLabel" data-dojo-attach-point\x3d"flagLabel" for\x3d"btnFlag"\x3e\r\n                                    \x3c/label\x3e\r\n                                \x3c/div\x3e\r\n                                \x3c!-- Flag icon ends --\x3e\r\n                                \x3c!-- Barrier icon starts --\x3e\r\n                                \x3cdiv class\x3d"btnBarrierStyle" data-dojo-attach-point\x3d"barrierIconMainContainer"\x3e\r\n                                    \x3c!-- aria-label added at runtime as it needs to fetched from config --\x3e\r\n                                    \x3cdiv class\x3d"barrierButton esriCTHidden" data-dojo-attach-point\x3d"btnBarrier"\r\n                                        aria-pressed\x3d"false" role\x3d"button" tabindex\x3d"0"\r\n                                        data-dojo-attach-event\x3d"onclick:_onBarrierButtonClick"\x3e\r\n                                    \x3c/div\x3e\r\n                                    \x3clabel class\x3d"barrierLabel" data-dojo-attach-point\x3d"barrierLabel" for\x3d"btnBarrier"\x3e\r\n                                    \x3c/label\x3e\r\n                                \x3c/div\x3e\r\n                                \x3c!-- Barrier icon ends --\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv class\x3d"traceButtons"\x3e\r\n                                \x3cdiv class\x3d"esriCTRunButtonContainer"\x3e\r\n                                    \x3cdiv class\x3d"jimu-btn jimu-state-disabled esriCTBtnRunTrace"\r\n                                        data-dojo-attach-point\x3d"btnTrace" role\x3d"button" tabindex\x3d"-1"\r\n                                        aria-label\x3d"${nls.defaultValueForRunButton}" type\x3d"submit" disabled\r\n                                        data-dojo-attach-event\x3d"onclick:_onTraceButtonClick"\x3e\r\n                                        ${nls.defaultValueForRunButton}\r\n                                    \x3c/div\x3e\r\n                                \x3c/div\x3e\r\n                                \x3cdiv class\x3d"esriCTClearButtonContainer"\x3e\r\n                                    \x3cdiv class\x3d"jimu-btn esriCTBtnClear" data-dojo-attach-point\x3d"btnClear" type\x3d"submit"\r\n                                        role\x3d"button" tabindex\x3d"0" aria-label\x3d"${nls.clearButtonValue}"\r\n                                        data-dojo-attach-event\x3d"onclick:_onClearButtonClick"\x3e\r\n                                        ${nls.clearButtonValue}\r\n                                    \x3c/div\x3e\r\n                                \x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                        \x3c/div\x3e\r\n                        \x3c!-- Trace panel ends --\x3e\r\n                        \x3c!-- Input, Barrier \x26 Skip Location on main page starts --\x3e\r\n                        \x3cdiv class\x3d"esriCTFlagBarrierSkipLocationMainPage"\r\n                            data-dojo-attach-point\x3d"flagBarrierSkipLocationMainPageContainer"\x3e\r\n                            \x3c!-- Input text --\x3e\r\n                            \x3cdiv class\x3d"esriCTInputLocationTab esriCTHidden" data-dojo-attach-point\x3d"inputLocTab"\r\n                                data-dojo-attach-event\x3d"onclick:_onInputLocTabClick" role\x3d"button" tabindex\x3d"0"\r\n                                aria-label\x3d"${nls.lblInputLocHeader}"\x3e\r\n                                \x3cdiv class\x3d"esriCTlblLoc" data-dojo-attach-point\x3d"lblInputLoc"\x3e\r\n                                    ${nls.lblInputLocHeader}\x3c/div\x3e\r\n                                \x3cdiv class\x3d"esriCTTabRightimg" data-dojo-attach-point\x3d"inputLocRightCaretIcon"\x3e\r\n                                \x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                            \x3c!-- Barrier text --\x3e\r\n                            \x3cdiv class\x3d"esriCTBarrierLocationTab esriCTHidden" data-dojo-attach-point\x3d"barrierLocTab"\r\n                                data-dojo-attach-event\x3d"onclick:_onBarrierLocTabClick" role\x3d"button" tabindex\x3d"0"\r\n                                aria-label\x3d"${nls.lblBlockLocHeader}"\x3e\r\n                                \x3cdiv class\x3d"esriCTlblLoc" data-dojo-attach-point\x3d"lblBlockLoc"\x3e\r\n                                    ${nls.lblBlockLocHeader}\x3c/div\x3e\r\n                                \x3cdiv class\x3d"esriCTTabRightimg"\x3e\r\n                                \x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                            \x3c!-- Skip Location text --\x3e\r\n                            \x3cdiv class\x3d"esriCTSkipLocationTab esriCTHidden" data-dojo-attach-point\x3d"skipLocationTab"\r\n                                data-dojo-attach-event\x3d"onclick:_onSkipLocationTabClick" role\x3d"button" tabindex\x3d"0"\r\n                                aria-label\x3d"${nls.lblSkipLocHeader}"\x3e\r\n                                \x3cdiv class\x3d"esriCTlblLoc" data-dojo-attach-point\x3d"lblSkipLoc"\x3e\r\n                                    ${nls.lblSkipLocHeader}\x3c/div\x3e\r\n                                \x3cdiv class\x3d"esriCTTabRightimg"\x3e\r\n                                \x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                        \x3c/div\x3e\r\n                        \x3c!-- Input, Barrier \x26 Skip Location on main page ends --\x3e\r\n                    \x3c/div\x3e\r\n                    \x3c!-- Input tab main container starts --\x3e\r\n                    \x3c!-- Output tab main container starts --\x3e\r\n                    \x3cdiv class\x3d"esriCTOutputParentMainContainer esriCTHidden" data-dojo-attach-point\x3d"outputTab"\x3e\r\n                        \x3cdiv class\x3d"esriCTLayerInformationContainer esriCTHidden"\r\n                            data-dojo-attach-point\x3d"resultLayersInformationContainer" role\x3d"presentation" tabindex\x3d"0"\x3e\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"esriCTResultsLayerNamesContainer esriCTHidden"\r\n                            data-dojo-attach-point\x3d"resultsLayerNamesContainer"\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3c!-- Output tab main container ends --\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Tab ends --\x3e\r\n            \x3cdiv class\x3d"esriCTResultsLayerFeaturesContainer esriCTHidden"\r\n                data-dojo-attach-point\x3d"layerFeaturesContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Edit project starts --\x3e\r\n            \x3cdiv class\x3d"esriCTEditProjectAttributeContainer esriCTHidden"\r\n                data-dojo-attach-point\x3d"editAttributeContainer"\x3e\r\n                \x3c!-- Attribute Inspector --\x3e\r\n                \x3cdiv class\x3d"esriCTAttributeInspectorContainer" data-dojo-attach-point\x3d"attributeInspectorContainer"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Ok \x26 Cancel button --\x3e\r\n                \x3cdiv class\x3d"esriCTEditProjectOkAndCancelBtnParentContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTEditProjectAttributeOkButtonContainer"\x3e\r\n                        \x3cdiv class\x3d"jimu-btn esriCTEditProjectAttributeOkButton"\r\n                            data-dojo-attach-point\x3d"editProjectAttributeOkButtonNode"\r\n                            data-dojo-attach-event\x3d"onClick:_onOkButtonClick" role\x3d"button" tabindex\x3d"0"\r\n                            aria-label\x3d"${nls.ok}"\x3e\r\n                            ${nls.ok}\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTEditProjectAttributeCancelButtonContainer"\x3e\r\n                        \x3cdiv class\x3d"jimu-btn esriCTEditProjectAttributeCancelButton"\r\n                            data-dojo-attach-event\x3d"onClick:_hideAttributeInspector"\r\n                            data-dojo-attach-point\x3d"editProjectAttributeCancelButtonNode" role\x3d"button" tabindex\x3d"0"\r\n                            aria-label\x3d"${nls.cancel}"\x3e\r\n                            ${nls.cancel}\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Input --\x3e\r\n            \x3cdiv class\x3d"esriCTFlagsList esriCTHidden" data-dojo-attach-point\x3d"inputLocDiv"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButtonContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTFlagsListBackButton"\x3e\r\n                        \x3cdiv class\x3d"esriCTFlagsBackText" data-dojo-attach-point\x3d"inputBackClick" role\x3d"button"\r\n                            tabindex\x3d"0" aria-label\x3d"${nls.backButtonValue}"\x3e\r\n                            \x26lt;${nls.backButtonValue}\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTFlagsCountText" data-dojo-attach-point\x3d"flagCountLabel"\x3e\r\n                        ${nls.lblBlockLocHeader}\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTFlagsContent" data-dojo-attach-point\x3d"flagLocContent"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Barrier --\x3e\r\n            \x3cdiv class\x3d"esriCTBarrierLocationList esriCTHidden" data-dojo-attach-point\x3d"barrierLocDiv"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButtonContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTBarrierListBackButton"\x3e\r\n                        \x3cdiv class\x3d"esriCTBarrierBackText" data-dojo-attach-point\x3d"barrierBackClick" role\x3d"button"\r\n                            tabindex\x3d"0" aria-label\x3d"${nls.backButtonValue}"\x3e\r\n                            \x26lt;${nls.backButtonValue}\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTBarrierCountText" data-dojo-attach-point\x3d"barrierCountLabel"\x3e\r\n                        ${nls.lblBlockLocHeader}\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTBarrierContent" data-dojo-attach-point\x3d"barrierLocContent"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Skip Location --\x3e\r\n            \x3cdiv class\x3d"esriCTSkipLocationList esriCTHidden" data-dojo-attach-point\x3d"skipLocDiv"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButtonContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTSkipLocationListBackButton"\x3e\r\n                        \x3cdiv class\x3d"esriCTSkipLocationBackText" data-dojo-attach-point\x3d"skipLocationBackClick"\r\n                            role\x3d"button" tabindex\x3d"0" aria-label\x3d"${nls.backButtonValue}"\x3e\r\n                            \x26lt;${nls.backButtonValue}\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTSkipLocationsCountText" data-dojo-attach-point\x3d"skipLocationCountLabel"\x3e\r\n                        ${nls.lblSkipLocHeader}\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTRemoveSkipAllLocationParentContainer"\r\n                    data-dojo-attach-point\x3d"removeSkipAllLocationParentContainer"\x3e\r\n                    \x3cdiv class\x3d"jimu-btn esriCTRemoveSkipLocationButton" data-dojo-attach-point\x3d"removeSkipAllButton"\r\n                        data-dojo-attach-event\x3d"onclick:_onRemoveSkipAllButtonClick" role\x3d"button" tabindex\x3d"0"\r\n                        aria-label\x3d"${nls.removeAllSkipLocationLabel}"\x3e\r\n                        ${nls.removeAllSkipLocationLabel}\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTSkipContent" data-dojo-attach-point\x3d"skipLocationsListContainer"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Export to CSV form starts --\x3e\r\n            \x3cdiv class\x3d"esriCTExportToCSVFormParentContainer esriCTHidden"\r\n                data-dojo-attach-point\x3d"exportToCSVFormParentContainer"\x3e\r\n                \x3c!-- Export to CSV form --\x3e\r\n                \x3cdiv class\x3d"esriCTBackButtonContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTExportBackButton"\x3e\r\n                        \x3cdiv class\x3d"esriCTExportBackText" data-dojo-attach-point\x3d"exportBackNode"\r\n                            data-dojo-attach-event\x3d"onClick:_onExportToCSVFormBackBtnClick" role\x3d"button" tabindex\x3d"0"\r\n                            aria-label\x3d"${nls.backButtonValue}"\x3e\r\n                            \x26lt;${nls.backButtonValue}\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTExportToCsvText"\x3e\r\n                        ${nls.exportToCSVText}\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Export to CSV form --\x3e\r\n                \x3cdiv class\x3d"esriCTExportToCSVFormContainer" data-dojo-attach-point\x3d"exportToCSVFormContainer"\x3e\x3c/div\x3e\r\n                \x3c!-- Export OK button button --\x3e\r\n                \x3cdiv class\x3d"esriCTExportToCsvOkBtnParentContainer esriCTTextCenter"\x3e\r\n                    \x3cdiv class\x3d"esriCTExportToCsvOkButtonContainer esriCTExportToCSVOkBtnCenterContainer"\x3e\r\n                        \x3cdiv class\x3d"jimu-btn esriCTExportToCSVOkBtn"\r\n                            data-dojo-attach-event\x3d"onClick:_onExportToCSVFormOkBtnClick"\r\n                            data-dojo-attach-point\x3d"exportToCsvFileMainButton" role\x3d"button" tabindex\x3d"0"\r\n                            aria-label\x3d"${nls.ok}"\x3e\r\n                            ${nls.ok}\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Export to CSV form ends --\x3e\r\n            \x3c!-- Save project, Export to CSV starts --\x3e\r\n            \x3cdiv class\x3d"esriCTSaveAndExportParentContainer esriCTHidden"\r\n                data-dojo-attach-point\x3d"saveAndExportParentContainer"\x3e\r\n                \x3cdiv class\x3d"esriCTSaveButtonContainer esriCTHidden" data-dojo-attach-point\x3d"saveButtonContainer"\x3e\r\n                    \x3cdiv class\x3d"jimu-btn jimu-state-disabled esriCTProjectSaveButton"\r\n                        data-dojo-attach-point\x3d"projectSaveButton"\r\n                        data-dojo-attach-event\x3d"onClick:_onProjectSaveButtonClick" role\x3d"button" tabindex\x3d"0"\r\n                        aria-label\x3d"${nls.saveButtonLabel}"\x3e\r\n                        ${nls.saveButtonLabel}\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTExportButtonContainer esriCTHidden" data-dojo-attach-point\x3d"exportButtonContainer"\x3e\r\n                    \x3cdiv class\x3d"jimu-btn jimu-state-disabled esriCTExportToCSVBtn"\r\n                        data-dojo-attach-event\x3d"onClick:_onExportToLayerButtonClick"\r\n                        data-dojo-attach-point\x3d"exportToCsvMainScreenButton" role\x3d"button" tabindex\x3d"0"\r\n                        aria-label\x3d"${nls.exportToCSVText}"\x3e\r\n                        ${nls.exportToCSVText}\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Save project, Export to CSV ends --\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTHidden" data-dojo-attach-point\x3d"errorNode"\x3e\r\n            ${nls.gpServiceNotAccessible}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"supports-508-node lastFocusNode" tabindex\x3d"0" data-dojo-attach-point\x3d"supports508Node"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/NetworkTrace/css/style.css":'.jimu-widget-NetworkTrace .flagbutton{float: left; cursor: pointer; width: 40px; height: 40px; background-repeat: no-repeat; background-image: url("../images/add-flags.png"); background-size: 40px 40px;}.jimu-widget-NetworkTrace .barrierButton{float: left; cursor: pointer; width: 40px; height: 40px; background-repeat: no-repeat; background-image: url("../images/add-barriers.png"); background-size: 40px 40px;}.jimu-widget-NetworkTrace .flagButtonselected{float: left; cursor: pointer; width: 40px; height: 40px; background-repeat: no-repeat; background-image: url("../images/add-flags-select.png"); background-color: #858585; background-size: 40px 40px;}.jimu-widget-NetworkTrace .barrierButtonselected{float: left; cursor: pointer; width: 40px; height: 40px; background-repeat: no-repeat; background-image: url("../images/add-barriers-select.png"); background-color: #858585; background-size: 40px 40px;}.jimu-widget-NetworkTrace .traceControl{float: left; width: 100%;}.jimu-widget-NetworkTrace .btnFlagStyle{width: 100%; float: left; margin-bottom: 5px; height: 40px;}.jimu-rtl .jimu-widget-NetworkTrace .btnFlagStyle{padding: 2px 2px 0px 0px;}.jimu-widget-NetworkTrace .btnBarrierStyle{width: 100%; float: left; margin-bottom: 5px; height: 40px;}.jimu-rtl .jimu-widget-NetworkTrace .btnBarrierStyle{padding: 2px 2px 0px 0px;}.jimu-widget-NetworkTrace .flagLabel{float: left; padding: 13px 0px 13px 10px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; max-width: 85%;}.jimu-widget-NetworkTrace .barrierLabel{float: left; padding: 13px 0px 13px 10px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; max-width: 85%;}.jimu-widget-NetworkTrace .traceButtons{width: 100%; clear: both;}.resultItemButton{padding: 0; width: 20px; height: 20px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; cursor: pointer; outline: none; background-position: center center; background-repeat: no-repeat; background-size: 20px 20px; border: 0; margin-right: 5px; float: left;}.resultItemLabel{width: calc(100% - 30px); cursor: pointer; font-size: 14px; color: #3e3e3e; font-family: Avenir LT 35 Light; float: left; word-break: break-word; min-height: 19px;}.resultItemSubDiv{clear: both; width: 100%; overflow: hidden; padding: 10px 0px 10px 0px;}.jimu-widget-NetworkTrace .resultItemButtonSkipIcon{background-image: url("../images/skip.png"); background-color: #666666; border-radius:2px;}.jimu-widget-NetworkTrace .alreadySkippedLocation{background-color: #ebdd22; cursor: default;}.jimu-widget-NetworkTrace .runIconidle{display: none;}.boxPanel{top: 140px !important;}.jimu-widget-NetworkTrace .runIconProcessing{position: absolute; z-index: 999; background-image: url(../images/loading.gif); background-position: center; background-repeat: no-repeat; background-size: 40px; height: 100%; width: 100%;}.jimu-widget-NetworkTrace .traceControlDisabledDiv{pointer-events: none;}.claro .dijitTitlePaneContentInner{padding: 0px;}.dijitButtonNode{border: 0px solid gray;}.dijitValidationTextBoxError input.dijitValidationInner, .dijitSelect input, .dijitTextBox input.dijitArrowButtonInner{height: 28px !important;}.dijitTimeTextBox{width: 12em !important;}.dijitDateTextBox{width: 12em !important;}.dijitArrowNode{float: right;}.claro .dijitTitlePaneTitleOpen, .claro .dijitTitlePaneTitleFixedOpen{background-color: #E9EEF4; color: Black;}.dijitTitlePane{background-color: #fff;}.claro .dijitTitlePaneTitle{background-color: #efefef; background-image: none; background-repeat: repeat-x; border-left: none; border-right: none; border-bottom: none; border-top: 1px solid #b5bcc7; color: #494949; min-height: 17px; padding: 7px 15px;}.claro .dijitTitlePaneContentOuter{border-left: none; border-right: none; border-bottom: none; border-top: 1px solid #b5bcc7;}.dijitheadPaneTitle{background-image: none; background-repeat: repeat-x; border-left: none; border-right: none; border-bottom: none; border-top: 1px solid #e5e5e5; color: #494949; min-height: 17px;}.jimu-widget-NetworkTrace .dijitheadPanelIcons{float: right;}.claro .dijitTitlePaneTitleFocus{outline: none;}.jimu-widget-NetworkTrace .esriCTHidden{display: none;}.claro .dijitSelect, .claro .dijitTextBox{width: 144px;}.attrResultInfoTable{border-collapse: collapse;}.attrResultInfoTable td.attrName{color: #888888; padding-right: 5px;}.attrResultInfoTable td{padding: 2px; padding-bottom: 5px;}.attrHeader{font-weight: bold;}.attrSeparator{border: none; border-top: 1px solid #333333; margin-top: 6px; margin-bottom: 6px;}.resultItem{border-bottom: 1px solid #f5f5f5;}.jimu-widget-NetworkTrace .esriCTInputLocationTab,.jimu-widget-NetworkTrace .esriCTBarrierLocationTab,.jimu-widget-NetworkTrace .esriCTSkipLocationTab {color: #3e3e3e; cursor: pointer; font-size: 14px; font-family: Avenir LT 35 Light; height: 42px;}.jimu-widget-NetworkTrace .esriCTTabRightimg{margin: 10px auto; position: relative; float: right; width: 14px; height: 14px; background-repeat: no-repeat; background-image: url("../images/right-arrow.png"); background-size: 14px 14px;}.jimu-widget-NetworkTrace .esriCTBarrierLocationTab,.jimu-widget-NetworkTrace .esriCTSkipLocationTab {border-top: none;}.jimu-widget-NetworkTrace .esriCTResultContainer{background-color: #FFFFFF; width: 100%; height: 100%; z-index: 998; clear: both;}.jimu-widget-NetworkTrace .esriCTResultContainerHeader{width: 100%; height: 40px; border-bottom: 1px solid #B5BCC9; color: #3e3e3e; font-weight: bold; font-size: 14px;}.jimu-widget-NetworkTrace .esriCTResultContainerBack{position: relative; float: left; margin: 10px 0px 10px 0px; cursor: pointer;}.jimu-widget-NetworkTrace .esriCTResultContainerBack:hover,.jimu-widget-NetworkTrace .esriCTExportBackText:hover,.jimu-widget-NetworkTrace .esriCTSkipLocationBackText:hover,.jimu-widget-NetworkTrace .esriCTFlagsBackText:hover,.jimu-widget-NetworkTrace .esriCTBarrierBackText:hover {text-decoration: underline;}.jimu-widget-NetworkTrace .esriCTResultContainerLbl{position: relative; float: right; margin: 10px 10px 10px 0px; max-width: 75%; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;}.jimu-widget-NetworkTrace .esriCTFlagsBarriersSkipLocationsMainDiv{width: 100%; padding: 10px 5px 10px 5px; float: left; box-sizing: border-box; border-bottom: 1px solid #f5f5f5; height: 40px;}.jimu-widget-NetworkTrace .esriCTFlagsBarriersSkipLocationsLabelContainer{float: left; cursor: pointer; font-size: 14px; color: #3e3e3e; font-family: Avenir LT 35 Light; width: calc(100% - 16px); word-break: break-word;}.jimu-widget-NetworkTrace .esriCTInputFlagCloseDiv,.jimu-widget-NetworkTrace .esriCTRemoveSkipLocationIcon {background-image: url(../images/delete.png); background-repeat: no-repeat; background-position: center; background-size: 16px; position: relative; float: right; padding: 0px 0px 0px 10px; width: 16px; height: 16px; cursor: pointer;}.jimu-widget-NetworkTrace .esriCTlblLoc{margin: 10px auto; position: relative; float: left; width: 90%;}.jimu-widget-NetworkTrace .esriCTLayerNameContainer{float: left; width: 100%; cursor: pointer; padding: 10px 0;}.jimu-widget-NetworkTrace .esriCTLayerName{float: left; width: calc(100% - 34px); text-overflow: ellipsis; overflow: hidden; white-space: nowrap; color: #3e3e3e; font-size: 14px; font-family: Avenir LT 35 Light; padding-left: 5px;}.jimu-widget-NetworkTrace .esriCTRightCaretIcon{float: right; width: 14px; height: 14px; color: #3e3e3e; font-size: 14px; font-family: Avenir LT 35 Light; background-repeat: no-repeat; background-image: url("../images/right-arrow.png"); background-size: 14px 14px;}.jimu-widget-NetworkTrace .esriCTResultsLayerFeaturesContainer{clear: both; width: 100%; height: 100%;}.claro .dijitSelect .dijitArrowButtonInner, .claro .dijitComboBox .dijitArrowButtonInner{border: none !important;}.esriCTDartBackgroudColor{background-color: transparent !important;}.jimu-widget-NetworkTrace .traceControls{float: left; width: 100%;}.esriCTDisableScroll{overflow-y: hidden !important;}.claro .dijitTextBoxIE9{background-color: rgba(0, 0, 0, 0.25) !important;}.claro .dijitDateTextBox .dijitArrowButtonIE9::before{content: inherit !important;}.claro .dijitComboBox .dijitButtonNodeIE9{background-image: none !important; background-repeat: no-repeat; background-color: rgba(0, 0, 0, 0.25) !important;}.claro .dijitTextBoxFocusedIE9 .dijitInputContainer{background-color: rgba(0, 0, 0, 0.5) !important;}.claro .dijitDateTextBox .dijitArrowButtonBlankContent::before{content: none !important;}.jimu-popup .content-static{margin: 15px 30px 0 !important; padding-top: 5px !important;}.jimu-widget-NetworkTrace .esriCTSkipAllLocationParentContainer {width: 100%; overflow: hidden; clear: both;}.jimu-widget-NetworkTrace .esriCTSkipLocationButton {margin: 5px auto; display: table; float: none;}.jimu-widget-NetworkTrace .esriCTRemoveSkipLocationButton {margin: 10px auto; display: table; float: none;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTRightCaretIcon {float: right; transform: rotateY(180deg);}.jimu-rtl .jimu-widget-NetworkTrace .esriCTLayerName {float: right; padding-left: 0px; padding-right: 5px;}.jimu-rtl .jimu-widget-NetworkTrace .resultItemButton {float: right; margin-right: 0px; margin-left: 5px;}.jimu-rtl .jimu-widget-NetworkTrace .resultItemLabel {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTTabRightimg {float: left; transform: rotateY(180deg);}.jimu-rtl .jimu-widget-NetworkTrace .esriCTlblLoc {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTFlagsBarriersSkipLocationsLabelContainer {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTRemoveSkipLocationIcon {float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTResultContainerLbl {float: left; margin: 10px 0px 10px 10px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTResultContainerBack {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTInputFlagCloseDiv {float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTBtnRunTrace {margin-right: 0px; margin-left: 20px; float: right;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTBtnClear {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .flagbutton {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .flagLabel {float: right; padding: 13px 10px 13px 0px;}.jimu-rtl .jimu-widget-NetworkTrace .barrierLabel {float: right; padding: 13px 10px 13px 0px;}.jimu-rtl .jimu-widget-NetworkTrace .barrierButton {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .flagButtonselected {float: right;}.jimu-rtl .jimu-widget-NetworkTrace .barrierButtonselected {float: right;}.jimu-widget-NetworkTrace .esriCTLoadProjectDropDownContainer {width: calc(100% - 30px); float: left; padding-right: 10px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTLoadProjectDropDownContainer {float: right; padding-right: 0px; padding-left: 10px;}.jimu-widget-NetworkTrace .esriCTLoadProjectDropDown {width: 100%;}.jimu-widget-NetworkTrace .esriCTEditProjectBtn{height: 30px; width: 30px; background-repeat: no-repeat; background-position: center center; background-image: url("../images/edit-project-attributes.png"); cursor: pointer; float: left;}.DartTheme .jimu-widget-NetworkTrace .esriCTEditProjectBtn {background-image: url("../images/edit-project-attributes-dart-theme.png");}.jimu-widget-NetworkTrace .esriCTDisableEditProjectBtn{height: 30px; width: 30px; background-repeat: no-repeat; background-position: center center; background-image: url("../images/edit-project-attributes-disable.png"); cursor: default; pointer-events: none; float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTEditProjectBtn,.jimu-rtl .jimu-widget-NetworkTrace .esriCTDisableEditProjectBtn {float: right;}.jimu-widget-NetworkTrace .esriCTMainParentContainer,.jimu-widget-NetworkTrace .esriCTMainParentContentContainer {width: 100%; height: 100%;}.jimu-widget-NetworkTrace .esriCTTextCenter {text-align: center;}.jimu-widget-NetworkTrace .esriCTSaveButtonContainer {width: 50%; float: left; padding: 2px 10px 2px 2px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTSaveButtonContainer {float: right; padding-right: 0px; padding-left: 10px;}.jimu-widget-NetworkTrace .esriCTSaveButtonCenterContainer {float: none; display: inline-block;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTSaveButtonCenterContainer {float: none; display: inline-block;}.jimu-widget-NetworkTrace .esriCTExportToCsvOkButtonContainer {width: 50%; float: left; padding: 2px 10px 2px 2px;}.jimu-widget-NetworkTrace .esriCTEditProjectAttributeOkButtonContainer {width: 50%; float: left; padding: 2px 10px 2px 2px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTEditProjectAttributeOkButtonContainer {float: right; padding-right: 0px; padding-left: 10px;}.jimu-widget-NetworkTrace .esriCTExportToCSVOkBtnCenterContainer {float: none; display: inline-block;}.jimu-widget-NetworkTrace .esriCTExportButtonContainer {width: 50%; float: left; padding: 2px 2px 2px 10px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTExportButtonContainer {float: right; padding-left: 0px; padding-right: 10px;}.jimu-widget-NetworkTrace .esriCTExportButtonCenterContainer {float: none; display: inline-block;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTExportButtonCenterContainer {float: none; display: inline-block;}.jimu-widget-NetworkTrace .esriCTEditProjectAttributeCancelButtonContainer {width: 50%; float: left; padding: 2px 2px 2px 10px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTEditProjectAttributeCancelButtonContainer {float: right; padding-left: 0px; padding-right: 10px;}.jimu-widget-NetworkTrace .esriCTRunButtonContainer {width: 50%; float: left; padding-right: 10px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTRunButtonContainer {float: right; padding-right: 0px; padding-left: 10px;}.jimu-widget-NetworkTrace .esriCTClearButtonContainer {width: 50%; float: left; padding-left: 10px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTClearButtonContainer {float: right; padding-left: 0px; padding-right: 10px;}.jimu-widget-NetworkTrace .esriCTProjectSaveButton {margin: 0px; width: 100%;}.jimu-widget-NetworkTrace .esriCTExportToCSVOkBtn {margin: 0px; width: 100%;}.jimu-widget-NetworkTrace .esriCTEditProjectAttributeOkButton {margin: 0px; width: 100%;}.jimu-widget-NetworkTrace .esriCTExportToCSVBtn {margin: 0px; width: 100%;}.jimu-widget-NetworkTrace .esriCTEditProjectAttributeCancelButton {margin: 0px; width: 100%;}.jimu-widget-NetworkTrace .esriCTBtnRunTrace {margin: 0px; width: 100%;}.jimu-widget-NetworkTrace .esriCTBtnClear {margin: 0px; width: 100%;}.jimu-widget-NetworkTrace .esriCTCheckboxParentContainer {float: left; margin-left: 2px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTCheckboxParentContainer {float: right; margin-left: 0; margin-right: 2px;}.jimu-widget-NetworkTrace .esriCTEditProjectAttributeContainer {width: 100%; height: 100%;}.jimu-widget-NetworkTrace .esriCTExportToCSVFormParentContainer {width: 100%; height: 100%;}.jimu-widget-NetworkTrace .esriCTExportToCSVFormContainer {width: 100%; height: calc(100% - 73px); overflow: auto;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorWidgetContainer {width: 100%; height: 100%;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer {width: 100%; height: calc(100% - 35px); overflow: auto;}.jimu-widget-NetworkTrace .atiButton,.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer .atiLayerName{display: none;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer .atiButtons{display: none;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer td {display: block; clear: both; height: auto; width: 100%; float: left;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer table {width: 100%;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer .atiField {width: 100%;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer .atiLabel {margin-top: 6px !important; margin-bottom: 3px !important;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer .dijitTextBox {width: 100% !important;}.jimu-widget-NetworkTrace .esriCTAttributeInspectorContainer .dijitTextArea {width: 100% !important; min-height: 70px; resize: vertical; overflow: auto; font-family: inherit; line-height: 20px !important; font-size: 14px;}.jimu-widget-NetworkTrace .atiAttributes {height: 100%; padding-right: 2px;}.jimu-rtl .jimu-widget-NetworkTrace .atiAttributes {padding-right: 0px; padding-left: 2px;}.jimu-widget-NetworkTrace .esriCTSaveAsPopupContainer,.jimu-widget-NetworkTrace .esriCTSaveProjectPopupContainer{width: 100%; overflow: hidden;}.jimu-widget-NetworkTrace .esriCTprojectNameTextBoxContainer {width: 70%; float: right;}.jimu-widget-NetworkTrace .esriCTProjectNameLabel {width: 30%; float: left; padding: 5px 10px; word-break: break-word; font-size: 14px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTProjectNameLabel {float: right;}.jimu-widget-NetworkTrace .esriCTExportToCsvParentNode {width: 100%; clear: both; padding-top: 10px; padding-bottom: 10px; overflow: hidden; padding-left: 18px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTExportToCsvParentNode {padding-left: 0px; padding-right: 18px;}.jimu-widget-NetworkTrace .esriCTExportToCsvSelectAll {padding-left: 3px; padding-right: 0px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTExportToCsvSelectAll {padding-left: 0px; padding-right: 3px;}.jimu-widget-NetworkTrace .esriCTBackButtonContainer {width: 100%; clear: both; overflow: hidden; padding-top: 10px; padding-bottom: 10px; border-bottom: 1px solid #B5BCC9; color: #3e3e3e; font-weight: bold; font-size: 14px; padding-left: 2px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTBackButtonContainer {padding-right: 2px;}.jimu-widget-NetworkTrace .esriCTExportBackButton {width: 50%; text-align: left; float: left; padding-left: 3px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTExportBackButton {text-align: right; float: right; padding-right: 3px;}.jimu-widget-NetworkTrace .esriCTSkipLocationListBackButton {width: 50%; text-align: left; float: left; padding-left: 2px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTSkipLocationListBackButton {text-align: right; float: right; padding-right: 2px;}.jimu-widget-NetworkTrace .esriCTBarrierListBackButton {width: 50%; text-align: left; float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTBarrierListBackButton {text-align: right; float: right;}.jimu-widget-NetworkTrace .esriCTFlagsListBackButton {width: 50%; text-align: left; float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTFlagsListBackButton {text-align: right; float: right;}.jimu-widget-NetworkTrace .esriCTExportBackText {cursor: pointer; width: fit-content;}.jimu-widget-NetworkTrace .esriCTSkipLocationBackText {cursor: pointer; width: fit-content;}.jimu-widget-NetworkTrace .esriCTBarrierBackText {cursor: pointer; width: fit-content;}.jimu-widget-NetworkTrace .esriCTFlagsBackText {cursor: pointer; width: fit-content;}.jimu-widget-NetworkTrace .esriCTExportToCsvText {width: 50%; text-align: right; float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTExportToCsvText {text-align: left; float: right;}.jimu-widget-NetworkTrace .esriCTSkipLocationsCountText {width: 50%; text-align: right; float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTSkipLocationsCountText {text-align: left; float: right;}.jimu-widget-NetworkTrace .esriCTBarrierCountText {width: 50%; text-align: right; float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTBarrierCountText {text-align: left; float: right;}.jimu-widget-NetworkTrace .esriCTFlagsCountText {width: 50%; text-align: right; float: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTFlagsCountText {text-align: left; float: right;}.jimu-widget-NetworkTrace .esriCTSkipLocationList {width: 100%; height: 100%; clear: both;}.jimu-widget-NetworkTrace .esriCTBarrierLocationList {width: 100%; height: 100%; clear: both;}.jimu-widget-NetworkTrace .esriCTFlagsList {width: 100%; height: 100%; clear: both;}.jimu-widget-NetworkTrace .esriCTRemoveSkipAllLocationParentContainer {width: 100%; overflow: hidden; clear: both; border-bottom: 1px solid #f5f5f5;}.jimu-widget-NetworkTrace .esriCTLoadProjectParentContainer {width: 100%; overflow: hidden; clear: both; padding: 3px 2px 2px 0px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTLoadProjectParentContainer {padding: 3px 0px 2px 2px;}.jimu-widget-NetworkTrace .esriCTInputOutputTabParentContainer {width: 100%; height: 100%; clear: both;}.jimu-widget-NetworkTrace .esriCTSaveAndExportParentContainer {width: 100%; overflow: hidden; clear: both; position: absolute; bottom: 0;}.jimu-widget-NetworkTrace .esriCTEditProjectOkAndCancelBtnParentContainer {width: 100%; overflow: hidden; clear: both; position: absolute; bottom: 0;}.jimu-widget-NetworkTrace .esriCTExportToCsvOkBtnParentContainer {width: 100%; overflow: hidden; clear: both; position: absolute; bottom: 0;}.jimu-widget-NetworkTrace .esriCTTabParentContainer {width: 100%; height: 100%;}.jimu-widget-NetworkTrace .esriCTTabContainer {width: 100%; height: 100%;}.jimu-widget-NetworkTrace .esriCTInputParentMainContainer {width: 100%; height: 100%; clear: both;}.jimu-widget-NetworkTrace .esriCTInputParentMainContainerMobileMode {max-height: 135px; overflow: auto;}.jimu-widget-NetworkTrace .tracePanel{width: 100%; height: 135px; clear: both; padding-bottom: 10px;}.jimu-widget-NetworkTrace .esriCTFlagBarrierSkipLocationMainPage{clear: both; width: 100%; height: calc(100% - 135px); background-color: #FFFFFF; border-top: 1px solid #e5e5e5; overflow: auto; padding: 2px;}.jimu-widget-NetworkTrace .esriCTFlagBarrierSkipLocationMainPageMobileMode {min-height: 112px;}.jimu-widget-NetworkTrace .esriCTOutputParentMainContainer{width: 100%; height: 100%; clear: both; overflow: auto;}.jimu-widget-NetworkTrace .esriCTLayerInformationContainer{clear: both; width: calc(100% - 4px); margin: 2px; padding: 5px 0px 5px 0px; color: #3e3e3e; font-size: 14px; font-family: Avenir LT 35 Light; border-bottom: 1px solid #B5BCC9;}.jimu-widget-NetworkTrace .esriCTResultsLayerNamesContainer{clear: both; width: 100%; background-color: #fff; margin: 2px 0;}.jimu-widget-NetworkTrace .esriCTFlagsContent{clear: both; width: 100%; height: calc(100% - 38px); overflow: auto;}.jimu-widget-NetworkTrace .esriCTBarrierContent{clear: both; width: 100%; height: calc(100% - 38px); overflow: auto;}.jimu-widget-NetworkTrace .esriCTSkipContent{clear: both; width: 100%; height: calc(100% - 94px); overflow: auto; padding-top: 2px;}.jimu-widget-NetworkTrace .esriCTFeaturesListParentContainer{clear: both; width: 100%; height: 100%; overflow: auto; padding: 2px 0;}.jimu-widget-NetworkTrace .esriCTTabLineHeight {line-height: 28px !important;}.jimu-widget-NetworkTrace .esriCTResultLayerNameParent{margin-left: 20px; width: calc(100% - 22px); height: 18px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTResultLayerNameParent{margin-left: 0px; margin-right: 20px;}.jimu-widget-NetworkTrace .esriCTHighlightedGraphic {background-color: #E2F0FB;}.dart-panel .jimu-widget-NetworkTrace .esriCTHighlightedGraphic {background-color: #000000;}.esriCT-feature-action-skip-icon {background-image: url("../images/skip.png"); height: 16px; width: 16px; background-color: rgb(102, 102, 102); background-size: 16px; background-repeat: no-repeat;}.esriCT-feature-action-skip-icon:hover {background-color: rgb(0, 0, 0);}.esriCT-feature-action-unskip-icon {background-image: url("../images/unskip.png"); height: 16px; width: 16px; background-color: rgb(240, 205, 8); background-size: 16px; background-repeat: no-repeat;}.jimu-widget-NetworkTrace .esriCTLoadProjectDropDownContainer .dijitSelectLabel {text-overflow: ellipsis; overflow: hidden; white-space: nowrap; text-align: left;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTLoadProjectDropDownContainer .dijitSelectLabel {text-align: right;}.jimu-widget-NetworkTrace .esriCTInputTabSummaryTextContainer {max-height: 49px; overflow: auto; width: 100%; padding-top: 5px; padding-bottom: 5px;}.jimu-rtl .jimu-widget-NetworkTrace .esriCTInputTabSummaryTextContainer {text-align: right;}',
"*now":function(P){P(['dojo/i18n!*preload*widgets/NetworkTrace/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget dojo/on jimu/dijit/EditorXssFilter dojo/_base/lang dojo/window esri/graphic esri/geometry/Point esri/tasks/Geoprocessor dojo/_base/array esri/layers/GraphicsLayer esri/renderers/SimpleRenderer esri/toolbars/draw dojo/dom-class esri/tasks/FeatureSet dojo/dom-construct dojox/timing dojo/query dojo/promise/all dojo/Deferred esri/InfoTemplate dijit/registry dojo/date/locale dojo/dom-attr dojo/string jimu/PanelManager dojo/dom-style esri/symbols/jsonUtils jimu/dijit/Message jimu/dijit/CheckBox esri/dijit/AttributeInspector esri/geometry/geometryEngine esri/layers/FeatureLayer esri/request esri/tasks/query jimu/dijit/TabContainer dojo/dom dojo/has dojo/keys dijit/focus jimu/utils esri/urlUtils jimu/exportUtils jimu/CSVUtils jimu/dijit/formSelect dojo/dom-style dijit/form/ValidationTextBox jimu/dijit/Popup esri/tasks/QueryTask esri/tasks/GeometryService esri/tasks/ProjectParameters esri/SpatialReference dojo/DeferredList jimu/LayerInfos/LayerInfos esri/geometry/Polygon esri/graphicsUtils esri/lang ./highlightSymbolUtils dojo/sniff".split(" "),function(P,
J,D,Q,e,v,m,l,t,q,z,x,u,p,H,f,r,y,V,N,Z,W,k,g,I,F,S,w,R,T,c,n,C,O,M,ba,X,ca,K,aa,Y,xa,wa,A,B,L,U,ha,la,ia,ma,ja,pa,sa,za,Aa,Ba,Ca){return P([J],{baseClass:"jimu-widget-NetworkTrace",viewPortSize:null,panelManager:null,wManager:null,flagBtnClicked:!1,barrierBtnClicked:!1,gp:null,gpInputDetails:null,toolbar:null,overExtent:null,resultsCnt:null,resultLayers:null,animatedLayer:null,computedPanelStyle:null,mainContainer:null,tooltipDialog:null,IsIE:null,IsSafari:null,IsOpera:null,errorLayerArray:[],savedFeatureObjectId:null,
_flagID:null,_barrierID:null,_inputFlag:null,_inputBlock:null,_flagCount:null,_barrierCount:null,_tabContainer:null,_outputResultCount:0,_outputResultArr:[],_inputSkip:0,_skipLocationCount:0,_skippedLocations:{},_skipAllLocationButtonClicked:!1,_isSaveAndExportHidden:!1,_exportToCSVLayerArray:[],_layerInfosObj:!1,_projectLayerInfo:null,_projectAttributeGraphic:null,_isAttributeChanged:!1,_loadProjectDropdown:null,_flagGraphicsLayer:null,_barrierGraphicsLayer:null,_skipLocationGraphicsLayer:null,_allProjectLoadedInputs:[],
_loadProjectDropdownEvtHandle:null,_fetchedFeaturesDetails:null,_gpServiceOutputParameter:null,_loadProjectDetailsObj:{},_saveAsNewProject:!1,_currentSelectedProjectGuid:null,_pointLayerFields:{},_polygonLayerFields:{},_isWidgetLoadedInProjectMode:!1,_updateExistingProject:!1,_gpServiceOutputParameterObj:{},_widgetTopNode:null,_clonedProjectPolygonLayerObject:null,_currentFeatureDetails:null,_aiConnects:[],_selection:[],_toolTips:[],_isRunButtonClicked:!1,_originalTemplateAttributes:null,_isWidgetStartup:null,
_clickEventHandlerArr:[],_lastDefinitionExpression:null,editorXssFilter:null,startup:function(){this.inherited(arguments);this.editorXssFilter=Q.getInstance();this._initializeData();this._isWidgetStartup=!0;this._fetchLastDefinitionExpression();this.fetchData();this._validateConfigParams()&&this._getLayerInfos();this.handleKeyDownEvents()},handleKeyDownEvents:function(){this.own(D(this.btnFlag,"keydown",e.hitch(this,function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onFlagButtonClick()})));
this.own(D(this.btnBarrier,"keydown",e.hitch(this,function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onBarrierButtonClick()})));this.own(D(this.btnClear,"keydown",e.hitch(this,function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onClearButtonClick()})));this.own(D(this.btnTrace,"keydown",e.hitch(this,function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onTraceButtonClick()})));this.own(D(this.inputLocTab,"keydown",e.hitch(this,function(a){if(a.keyCode===K.ENTER||a.keyCode===
K.SPACE)this._onInputLocTabClick(),aa.focus(this.btnFlag),aa.focus(this.inputBackClick)})));this.own(D(this.inputBackClick,"keydown",e.hitch(this,function(a){if(a.keyCode===K.ENTER||a.keyCode===K.SPACE)this._clearSelectionOnBackBtnClk(),this._hideFlagsList(!0),aa.focus(this.inputLocTab)})));this.own(D(this.barrierLocTab,"keydown",e.hitch(this,function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onBarrierLocTabClick()})));this.own(D(this.barrierBackClick,"keydown",e.hitch(this,function(a){if(a.keyCode===
K.ENTER||a.keyCode===K.SPACE)this._clearSelectionOnBackBtnClk(),this._hideBarrierList(!0),aa.focus(this.barrierLocTab)})));this.own(D(this.skipLocationTab,"keydown",e.hitch(this,function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onSkipLocationTabClick()})));this.own(D(this.skipLocationBackClick,"keydown",e.hitch(this,function(a){if(a.keyCode===K.ENTER||a.keyCode===K.SPACE)this._clearSelectionOnBackBtnClk(),this._hideSkipLocationList(!0),aa.focus(this.skipLocationTab)})));this.own(D(this.editProjectAttributes,
"keydown",e.hitch(this,this._onEditProjectAttributesKeyPress)));this.own(D(this.projectSaveButton,"keydown",e.hitch(this,this._onProjectSaveButtonKeyPress)));this.own(D(this.exportToCsvMainScreenButton,"keydown",e.hitch(this,this._onExportToLayerButtonKeyPress)));this.own(D(this.exportBackNode,"keydown",e.hitch(this,this._onExportToCSVFormBackBtnKeyPress)));this.own(D(this.editProjectAttributeCancelButtonNode,"keydown",e.hitch(this,this._hideAttributeInspectorKeyPress)));this.own(D(this.editProjectAttributeOkButtonNode,
"keydown",e.hitch(this,this._onOkButtonKeyPress)));this.own(D(this.exportToCsvFileMainButton,"keydown",e.hitch(this,this._onExportToCSVFormOkBtnKeyPress)));this.own(D(this.removeSkipAllButton,"keydown",e.hitch(this,this._onRemoveSkipAllButtonKeyPress)))},postCreate:function(){Y.initLastFocusNode(this.domNode,this.supports508Node);this.own(D(this.supports508Node,"focus",e.hitch(this,this._lastNodeFocused)))},postMixInProperties:function(){this.nls=e.mixin(this.nls,window.jimuNls.common)},_fetchWidgetTopNode:function(){if(this.domNode.parentNode)var a=
this.domNode.parentNode;if(a.parentNode)var b=a.parentNode;if(b.parentNode)var d=b.parentNode;d&&(this._widgetTopNode=d)},_loadWidget:function(){var a;this._fetchWidgetTopNode();this._showLoadingIcon(!0);this._setInputTabSummaryText();this._addMobileStyles();this._displayMainScreen();this._createLoadProjectDetailsObj();this._addLoadProjectDropdown();this._initializingJimuTabContainer();this._getFieldAliasFromGPService();this.IsOpera=!!window.opera||0<=navigator.userAgent.indexOf(" OPR/");this.IsSafari=
0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");this.IsIE=!!document.documentMode||!1;this._clickEventHandlerArr.push(this.own(D.pausable(this.map,"click",e.hitch(this,this._mapClickHandler))));this.gp=new t(this.config.geoprocessing.url);D(this.gp,"error",e.hitch(this,this._onSubmitJobError));D(this.gp,"job-complete",e.hitch(this,this._onSubmitJobComplete));this.gp.setOutSpatialReference(this.map.spatialReference);this._createResultPanels();this._createGraphic();this._createHighlightingGraphicLayer();
this.viewPortSize=v.getBox();this.panelManager=F.getInstance();this._enhanceTabThemeStyle();this._enhanceDartThemeStyle();this._setTheme();if(a=this.domNode)this._reStyleWidgetContainer(a),S.set(a,{"z-index":101,width:"100%",height:"100%"});this._setFirstLastNodeOnMainScreen()},onAppConfigChanged:function(a,b,d){"styleChange"===b&&this._setTheme(d)},_reStyleWidgetContainer:function(a){S.set(a.parentNode,{padding:"5px"})},_initializeData:function(){this.wManager=this.panelManager=this.viewPortSize=
null;this.barrierBtnClicked=this.flagBtnClicked=!1;this.IsOpera=this.IsSafari=this.IsIE=this.tooltipDialog=this.mainContainer=this.computedPanelStyle=this.animatedLayer=this.resultLayers=this.resultsCnt=this.overExtent=this.toolbar=this.gpInputDetails=this.gp=null;this.errorLayerArray=[];this._tabContainer=this._barrierCount=this._flagCount=this._inputBlock=this._inputFlag=this._barrierID=this._flagID=this.savedFeatureObjectId=null;this._outputResultCount=0;this._outputResultArr=[];this._skipLocationCount=
this._inputSkip=0;this._skippedLocations={};this._skipAllLocationButtonClicked=!1;this._exportToCSVLayerArray=[];this._projectAttributeGraphic=this._projectLayerInfo=null;this._isAttributeChanged=!1;this._skipLocationGraphicsLayer=this._barrierGraphicsLayer=this._flagGraphicsLayer=this._loadProjectDropdown=null;this._allProjectLoadedInputs=[];this._gpServiceOutputParameter=this._fetchedFeaturesDetails=this._loadProjectDropdownEvtHandle=null;this._loadProjectDetailsObj={};this._saveAsNewProject=!1;
this._currentSelectedProjectGuid=null;this._pointLayerFields={};this._polygonLayerFields={};this._updateExistingProject=this._isWidgetLoadedInProjectMode=!1;this._gpServiceOutputParameterObj={};this._currentFeatureDetails=this._clonedProjectPolygonLayerObject=this._widgetTopNode=null;this._aiConnects=[];this._selection=[];this._toolTips=[];this._isRunButtonClicked=!1;this._isWidgetStartup=this._originalTemplateAttributes=null;this._clickEventHandlerArr=[];this._lastDefinitionExpression=null},_initializingJimuTabContainer:function(){this._tabContainer=
new ba({"class":"esriCTTabContainer",tabs:[{title:this.nls.inputTabTitle,content:this.inputTabPanel,selected:!0},{title:this.nls.outputTabTitle,content:this.outputTab,selected:!1}]},this.tabContainerNetworkTrace);this.own(D(this._tabContainer,"tabChanged",e.hitch(this,function(a){a===this.nls.inputTabTitle?(this._setFirstLastNodeOnMainScreen(),p.contains(this.inputTabSummaryTextContainer,"esriCTHidden")?aa.focus(this.btnFlag):aa.focus(this.inputTabSummaryTextContainer)):this._setFirstLastNodeOnOutputScreen()})));
this._tabContainer.startup();this._tabContainer.controlNodes[0]&&p.add(this._tabContainer.controlNodes[0],"esriCTTabLineHeight");this._tabContainer.controlNodes[1]&&p.add(this._tabContainer.controlNodes[1],"esriCTTabLineHeight")},_setTheme:function(a){var b;if("DartTheme"===this.appConfig.theme.name)Y.loadStyleLink("dartOverrideCSS",this.folderUrl+"/css/dartTheme.css",null);else if(b=document.getElementById("dartOverrideCSS"))b.disabled=!0;"TabTheme"===this.appConfig.theme.name&&Y.loadStyleLink("tabOverrideCSS",
this.folderUrl+"/css/tabTheme.css",null);if("DashboardTheme"===this.appConfig.theme.name){if(Y.loadStyleLink(this.baseClass+"dashboardOverrideCSS",this.folderUrl+"/css/dashboardTheme.css",null),this.appConfig.theme.styles&&0<this.appConfig.theme.styles.length)if("light"===this.appConfig.theme.styles[0]||"light"===a)if(a&&"light"!==a){if(b=document.getElementById(this.baseClass+"dashboardOverrideLightCSS"))b.disabled=!0}else Y.loadStyleLink(this.baseClass+"dashboardOverrideLightCSS",this.folderUrl+
"/css/dashboardThemeLight.css",null);else if(b=document.getElementById(this.baseClass+"dashboardOverrideLightCSS"))b.disabled=!0}else{if(b=document.getElementById(this.baseClass+"dashboardOverrideCSS"))b.disabled=!0;if(b=document.getElementById(this.baseClass+"dashboardOverrideLightCSS"))b.disabled=!0}},destroy:function(){this._clearResults();this._removeAllGraphicLayers();this.inherited(arguments)},onOpen:function(){this._addGraphicLayersBackToMap()},onClose:function(){this._clearResults()},resize:function(){var a=
{};a.node=this.inputOutputTabParentContainer;a.considerSaveAndExport=!0;a.considerLoadProject=!0;this._resetHeight(a);a={};a.node=this.inputLocDiv;a.considerSaveAndExport=!0;this._resetHeight(a);a={};a.node=this.barrierLocDiv;a.considerSaveAndExport=!0;this._resetHeight(a);a={};a.node=this.skipLocDiv;a.considerSaveAndExport=!0;this._resetHeight(a);a={};a.node=this.flagBarrierSkipLocationMainPageContainer;a.resetFlagBarrierSkipLocationMainPage=!0;this._resetHeight(a);a=y(".esriCTFeaturesListParentContainer",
this._widgetTopNode);q.forEach(a,e.hitch(this,function(b){var d=y(".esriCTSkipAllLocationParentContainer",b.parentNode);var h={};h.node=b;h.considerSaveAndExport=!1;h.considerLoadProject=!1;h.considerSkipAll=!0;h.skipAllButton=d;this._resetHeight(h)}))},_addGraphicLayersBackToMap:function(){for(var a in this.resultLayers)this.map.addLayer(this.resultLayers[a]);this.animatedLayer&&this.map.addLayer(this.animatedLayer);for(var b in this.gpInputDetails)this.map.addLayer(this.gpInputDetails[b])},_validateConfigParams:function(){if(this.config.hasOwnProperty("geoprocessing"))if(this.config.geoprocessing.hasOwnProperty("url")&&
this.config.geoprocessing.hasOwnProperty("inputs")&&this.config.geoprocessing.hasOwnProperty("outputs"))if(0<this.config.geoprocessing.inputs.length&&0<this.config.geoprocessing.outputs.length&&""!==this.config.geoprocessing.url)var a=!0;else this._errorMessage(this.nls.configError),a=!1;else this._errorMessage(this.nls.configError),a=!1;else this._errorMessage(this.nls.configError),a=!1;this.appConfig.geometryService?this.geometryService=new ia(this.appConfig.geometryService):(a=!1,this._errorMessage(this.nls.geometryServiceURLNotFoundMSG));
return a},_onFlagButtonClick:function(){p.contains(this.btnFlag,"traceControlDisabledDiv")||(this.flagBtnClicked?this._disableFlagTool():(this.flagBtnClicked=!0,p.remove(this.btnFlag,"flagbutton"),p.add(this.btnFlag,"flagButtonselected"),g.set(this.btnFlag,"aria-pressed","true"),null===this.toolbar&&(this.toolbar=new u(this.map),this.toolbar.activate(u.POINT)),this.barrierBtnClicked&&(this.barrierBtnClicked=!1,p.remove(this.btnBarrier,"barrierButtonselected"),p.add(this.btnBarrier,"barrierButton"),
g.set(this.btnBarrier,"aria-pressed","false")),this.disableWebMapPopup()))},_onBarrierButtonClick:function(){p.contains(this.btnBarrier,"traceControlDisabledDiv")||(this.barrierBtnClicked?this._disableBarrierTool():(this.barrierBtnClicked=!0,p.remove(this.btnBarrier,"barrierButton"),p.add(this.btnBarrier,"barrierButtonselected"),g.set(this.btnBarrier,"aria-pressed","true"),null===this.toolbar&&(this.toolbar=new u(this.map),this.toolbar.activate(u.POINT)),this.flagBtnClicked&&(this.flagBtnClicked=
!1,p.remove(this.btnFlag,"flagButtonselected"),p.add(this.btnFlag,"flagbutton"),g.set(this.btnFlag,"aria-pressed","false")),this.disableWebMapPopup()))},_showLoadingIcon:function(a){var b;(b=y(".jimu-widget-frame.jimu-container",this._widgetTopNode)[0])||(b=y(".jimu-container",this._widgetTopNode)[0]);a?(p.remove(this.loadingIcon,"runIconidle"),p.add(this.loadingIcon,"runIconProcessing"),"undefined"!==typeof b&&p.add(b,"esriCTDisableScroll")):(p.remove(this.loadingIcon,"runIconProcessing"),p.add(this.loadingIcon,
"runIconidle"),"undefined"!==typeof b&&p.remove(b,"esriCTDisableScroll"))},_onTraceButtonClick:function(){p.contains(this.btnTrace,"jimu-state-disabled")||(this._showLoadingIcon(!0),this._isRunButtonClicked=!0,this._executeTracePreRequisites(!0))},_exportToCSVComplete:function(a,b){A._download(b+".csv",a.csvdata)},_replaceDoubleQuotesInString:function(a){var b;(b=a)&&(b=a.toString().replace(/"/g,'""'));return b},_createCSVContent:function(a,b){var d;var h=new N;var G=[];var E;var da=b+",\r\n";if(a&&
a.features&&0<a.features.length){for(E in a.features[0].attributes)if(a.features[0].attributes.hasOwnProperty(E))for(b=0;b<a.fields.length;b++)a.fields[b].name===E&&G.push(a.fields[b].alias);da+=G.join(",")+"\r\n";q.forEach(a.features,function(ea){G=[];var fa;if(null!==ea.attributes)for(fa in ea.attributes)ea.attributes.hasOwnProperty(fa)&&G.push('"'+this._replaceDoubleQuotesInString(ea.attributes[fa])+'"');d=G.join(",");da+=d+"\r\n"},this);da+="\r\n\r\n"}else q.forEach(a.fields,function(ea){G.push(ea.alias)},
this),da+=G.join(",")+"\r\n";h.resolve({csvdata:da,orgResults:a});return h},_formatDate:function(a){if(""!==a&&null!==a){if(!isNaN(a)&&0>Number(a)){var b=new Date(0);b.setUTCSeconds(a/1E3)}else b=new Date(a);return a=k.format(b,{datePattern:"yyyy-MM-dd",selector:"date"})}return""},_destroyWidget:function(a){var b=W.findWidgets(a);f.empty(a);q.forEach(b,function(d){d.destroyRecursive(!0)})},enableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!0)},disableWebMapPopup:function(){this.map&&
this.map.setInfoWindowOnClick(!1)},_mapClickHandler:function(a){if(this.map&&this.map.snappingManager){var b=this.map.snappingManager.getSnappingPoint(a.screenPoint);b.then(e.hitch(this,function(d){d&&(a.mapPoint=d);this._onMapClick(a.mapPoint)}))}else this._onMapClick(a.mapPoint)},_onMapClick:function(a){if(this.flagBtnClicked||this.barrierBtnClicked){if(this.flagBtnClicked){var b="Flag";p.remove(this.btnTrace,"jimu-state-disabled");g.set(this.btnTrace,"tabindex",0);this.btnTrace.disabled=!1;this._flagID++;
var d=this._flagID;this._addInputLocation(new m(a,null,{ObjID:d},null),b)}this.barrierBtnClicked&&(b="Barrier",this._barrierID++,d=this._barrierID,this._addBarrierLocation(new m(a,null,{ObjID:d},null),b));q.some(this.gpInputDetails,function(h){if(h.type===b)return h.add(new m(a,null,{ObjID:d},null)),!0})}},_createGraphicFromJSON:function(a){return w.fromJson(a)},_createGraphic:function(){this.gpInputDetails=[];var a,b,d;y(".btnBarrierStyle",this.tracePanel);q.forEach(this.config.geoprocessing.inputs,
function(h){a=new z;a.id=h.paramName+this.id;a.type=h.type;a.paramName=h.paramName;b=this._createGraphicFromJSON(h.symbol);d=new x(b);a.setRenderer(d);this.gpInputDetails.push(a);if("Flag"===h.type){p.remove(this.btnFlag,"esriCTHidden");this._flagGraphicsLayer=a;if(""!==h.toolTip||null!==h.toolTip)this.btnFlag.title=h.toolTip;this.flagLabel.innerHTML=Y.sanitizeHTML(h.displayName);g.set(this.btnFlag,"aria-label",h.displayName+" "+this.btnFlag.title)}if("Barrier"===h.type){p.remove(this.btnBarrier,
"esriCTHidden");this._barrierGraphicsLayer=a;if(""!==h.toolTip||null!==h.toolTip)this.btnBarrier.title=h.toolTip;this.barrierLabel.innerHTML=Y.sanitizeHTML(h.displayName);g.set(this.btnBarrier,"aria-label",h.displayName+" "+this.btnBarrier.title)}"Skip"===h.type&&(this._skipLocationGraphicsLayer=a)},this);this.map.addLayers(this.gpInputDetails)},_createResultPanels:function(){var a,b,d;this.resultLayers=[];f.empty(this.resultLayersInformationContainer);q.forEach(this.config.geoprocessing.outputs,
function(h){b=a=null;d=new z;isNaN(h.MinScale)&&isNaN(h.MaxScale)?(d.minScale=Number(h.MinScale.replace(",","")),d.maxScale=Number(h.MaxScale.replace(",",""))):(d.minScale=h.MinScale,d.maxScale=h.MaxScale);h.hasOwnProperty("visibility")&&(null!==h.visibility?h.visibility?d.setVisibility(!0):d.setVisibility(!1):d.setVisibility(!0));d.id=h.paramName+this.id;null!==h.symbol&&(a=this._createGraphicFromJSON(h.symbol),b=new x(a),d.setRenderer(b));this.map.addLayer(d);h.layer=d;0<this.config.geoprocessing.outputs.length&&
this._createLayerResultPanel(h);"Result"===h.type&&this.resultLayers.push(d)},this)},_createLayerResultPanel:function(a){var b=!0;y(".esriCTResultContainerBack",this._widgetTopNode);var d=f.create("div",{"class":"esriCTLayerNameContainer",LayerName:a.paramName,"aria-label":a.panelText+" "+a.toolTip,tabindex:"0",role:"button"});var h=f.create("div",{"class":"esriCTCheckboxParentContainer"},d);var G=f.create("div",{"class":"esriCTCheckboxContainer"},h);a.hasOwnProperty("visibility")&&(b=a.visibility);
h=new T({checked:b,"aria-label":a.panelText+" "+a.toolTip},G);this._updateLayerVisibilty(a.paramName,b);g.set(h.domNode,"tabindex",2);g.set(h.domNode,"aria-label",a.panelText+" "+a.toolTip);this.own(D(h,"change",e.hitch(this,function(ea){this._updateLayerVisibilty(a.paramName,ea)})));var E=f.create("div",{"class":"esriCTResultLayerNameParent",title:a.panelText+" "+a.toolTip,"aria-label":a.panelText+" "+a.toolTip,tabindex:"2",role:"button"},d);b=f.create("div",{"class":"esriCTLayerName",innerHTML:Y.sanitizeHTML(a.panelText),
title:a.toolTip},E);g.set(b,"layernamedetails",a.paramName+this.id);f.create("div",{"class":"esriCTRightCaretIcon"},E);this.own(D(E,"keydown",e.hitch(this,function(ea){ea.keyCode===K.ENTER||ea.keyCode===K.SPACE?(this._clickOnLayerLabel(a.paramName),aa.focus(da)):ea.keyCode===K.ESCAPE?(ea.stopPropagation(),ea.preventDefault(),aa.focus(d)):ea.keyCode===K.TAB&&(ea.stopPropagation(),ea.preventDefault(),aa.focus(G))})));this.own(D(G,"keydown",e.hitch(this,function(ea){ea.keyCode===K.ESCAPE?(ea.stopPropagation(),
ea.preventDefault(),aa.focus(d)):ea.keyCode===K.TAB&&ea.shiftKey&&(ea.stopPropagation(),ea.preventDefault(),aa.focus(E))})));this.own(D(d,"keydown",e.hitch(this,function(ea){ea.keyCode!==K.ENTER&&ea.keyCode!==K.SPACE||aa.focus(G)})));this.resultsLayerNamesContainer.appendChild(d);b=f.create("div",{"class":"esriCTResultContainer esriCTHidden",title:""});g.set(b,"resultcontainer",a.paramName+this.id);h=f.create("div",{"class":"esriCTResultContainerHeader",resultType:a.paramName,title:""},b);var da=
f.create("div",{"class":"esriCTResultContainerBack",resultType:a.paramName,innerHTML:Y.sanitizeHTML("\x26lt;"+this.nls.backButtonValue),title:"",role:"button",tabindex:0,"aria-label":this.nls.backButtonValue},h);this.own(D(da,"keydown",e.hitch(this,function(ea){if(ea.keyCode===K.ENTER||ea.keyCode===K.SPACE)this._clickContentOfResultBackButton(a.paramName),aa.focus(E)})));h=f.create("div",{"class":"esriCTResultContainerLbl",title:""},h);g.set(h,"resultcontainerlabel",a.paramName+this.id);h=f.create("div",
{"class":"esriCTFeaturesListParentContainer",title:""},b);g.set(h,"resultcontainerdata",a.paramName+this.id);this.layerFeaturesContainer.appendChild(b);this._displayFeatureOnLayerClick(a.paramName,E,da)},_updateLayerVisibilty:function(a,b){(a=this.map.getLayer(a+this.id))&&a.setVisibility(b)},_displayFeatureOnLayerClick:function(a,b,d){this._clickEventHandlerArr.push(this.own(D.pausable(b,"click",e.hitch(this,function(){this._clickOnLayerLabel(a)}))));this._clickEventHandlerArr.push(this.own(D.pausable(d,
"click",e.hitch(this,function(){this._clickContentOfResultBackButton(a)}))))},_clickContentOfResultBackButton:function(a){this._clearSelectionOnBackBtnClk();a=this._getResultContainerObject(a);p.remove(this.saveAndExportParentContainer,"esriCTHidden");this._hideOutputFeatureList(a)},_clickOnLayerLabel:function(a){if(0!==this._getResultContainerDataObject(a).children.length){var b=this._getResultContainerObject(a);this._displayOutputFeatureList(b);p.add(this.saveAndExportParentContainer,"esriCTHidden");
if((a=y(".esriCTFeaturesListParentContainer",b))&&0<a.length){b=y(".esriCTSkipAllLocationParentContainer",b);var d={};d.node=a[0];d.considerSaveAndExport=!1;d.considerLoadProject=!1;d.considerSkipAll=!0;d.skipAllButton=b;this._resetHeight(d)}}},_onClearButtonClick:function(){var a;this._showLoadingIcon(!0);this._currentSelectedProjectGuid&&(a=e.clone(this._currentSelectedProjectGuid));this._clearResults();this._isWidgetLoadedInProjectMode&&a&&"newproject"!==a&&setTimeout(e.hitch(this,function(){this._reloadCurrentProjectOnClear=
!0;this._loadProjectDropdown.set("value",a);this._setProjectDropdownNameWidth();this._hideOutputPanel()}),200);this._showLoadingIcon(!1)},_clearResults:function(a){var b;this._hideFlagsOnMainScreen();this._hideBarriersOnMainScreen();this._hideSkipLocationsOnMainScreen(!0);this._hideOutputPanel();this._hideAllOutputResultContainer();this._hideAttributeInspector();p.add(this.layerFeaturesContainer,"esriCTHidden");p.add(this.exportToCSVFormParentContainer,"esriCTHidden");f.empty(this.flagLocContent);
f.empty(this.barrierLocContent);f.empty(this.skipLocationsListContainer);f.empty(this.resultLayersInformationContainer);var d=y(".esriCTFeaturesListParentContainer",this._widgetTopNode);for(b=0;b<d.length;b++)f.empty(d[b]);this._inputFlag=this._inputBlock=this._inputSkip=this._flagCount=this._barrierCount=this._skipLocationCount=this._flagID=this._barrierID=0;this._resetInputs();this._resetResults();null!==this.toolbar&&(this.toolbar.deactivate(),this.toolbar=null);this.flagBtnClicked&&(this.flagBtnClicked=
!1,p.remove(this.btnFlag,"flagButtonselected"),p.add(this.btnFlag,"flagbutton"));this.barrierBtnClicked&&(this.barrierBtnClicked=!1,p.remove(this.btnBarrier,"barrierButtonselected"),p.add(this.btnBarrier,"barrierButton"));-1<this.btnFlag.className.indexOf("traceControlDisabledDiv")&&p.remove(this.btnFlag,"traceControlDisabledDiv");-1<this.btnBarrier.className.indexOf("traceControlDisabledDiv")&&p.remove(this.btnBarrier,"traceControlDisabledDiv");this.btnFlag.disabled=!1;this.btnBarrier.disabled=!1;
p.add(this.btnTrace,"jimu-state-disabled");g.set(this.btnTrace,"tabindex",-1);this.btnTrace.disabled=!0;a||(this._loadProjectDropdown.set("value","newproject"),this._setProjectDropdownNameWidth());this._skippedLocations={};this._allProjectLoadedInputs=[];p.add(this.exportToCsvMainScreenButton,"jimu-state-disabled");g.set(this.exportToCsvMainScreenButton,"tabindex",-1);this._disableProjectSaveButton();a=y(".esriCTSkipAllLocationParentContainer",this.layerFeaturesContainer);q.forEach(a,e.hitch(this,
function(h){f.destroy(h)}));this.map&&this.map.infoWindow&&this.map.infoWindow.hide();this._displayEntireMainScreen();this.animatedLayer.clear();this._isRunButtonClicked=!1},_removeAllGraphicLayers:function(){this._removeInputGraphics();this._removeResultGraphics()},_removeResultGraphics:function(){q.forEach(this.resultLayers,e.hitch(this,function(a){this.map.removeLayer(a)}));this.animatedLayer&&this.map.removeLayer(this.animatedLayer)},_removeInputGraphics:function(){q.forEach(this.gpInputDetails,
e.hitch(this,function(a){this.map.removeLayer(a)}))},_GPExecute:function(){var a={},b;null!==this.toolbar&&(this.toolbar.deactivate(),this.toolbar=null);p.add(this.btnTrace,"jimu-state-disabled");g.set(this.btnTrace,"tabindex",-1);this.btnTrace.disabled=!0;p.add(this.btnFlag,"traceControlDisabledDiv");p.add(this.btnBarrier,"traceControlDisabledDiv");this.btnFlag.disabled=!0;this.btnBarrier.disabled=!0;this.flagBtnClicked&&(this.flagBtnClicked=!1,p.remove(this.btnFlag,"flagButtonselected"),p.add(this.btnFlag,
"flagbutton"));this.barrierBtnClicked&&(this.barrierBtnClicked=!1,p.remove(this.btnBarrier,"barrierButtonselected"),p.add(this.btnBarrier,"barrierButton"));var d=!1;q.forEach(this.gpInputDetails,function(h){b=new H;b.features=h.graphics;"Flag"===h.type&&(null===h.graphics&&(d=!0),0===h.graphics.length&&(d=!0));0<h.graphics.length&&(a[h.paramName]=b)});if(d)return this._isRunButtonClicked=!1;this.gp.submitJob(a)},_onSubmitJobComplete:function(a){this._jobID=a.jobInfo.jobId;if("esriJobFailed"===a.jobInfo.jobStatus)p.remove(this.btnFlag,
"traceControlDisabledDiv"),p.remove(this.btnBarrier,"traceControlDisabledDiv"),this.btnFlag.disabled=!1,this.btnBarrier.disabled=!1,this._showLoadingIcon(!1),this._errorMessage(this.nls.GPExecutionFailed);else try{this._resetResults(),this._resetSubmitJobDetails(),q.forEach(this.config.geoprocessing.outputs,function(b){this._verifyParams(a,b.paramName)&&this._processGPResults(a,b.paramName)},this)}catch(b){this._clearResults(),this._showLoadingIcon(!1),this._errorMessage(b.message)}},_onGetResultDataComplete:function(a){var b=
!1;q.forEach(this.config.geoprocessing.outputs,e.hitch(this,function(d){a.paramName===d.paramName&&(d.results=a.value,this._populateResultsToggle(d))}));this.btnFlag.disabled=!1;this.btnBarrier.disabled=!1;this.btnTrace.disabled=!1;q.some(this.config.geoprocessing.inputs,function(d){if(d&&d.paramName&&this.map.getLayer(d.paramName+this.id)&&0<this.map.getLayer(d.paramName+this.id).graphics.length)return b=!0},this);b?(p.remove(this.btnTrace,"jimu-state-disabled"),g.set(this.btnTrace,"tabindex",0)):
(p.add(this.btnTrace,"jimu-state-disabled"),g.set(this.btnTrace,"tabindex",-1));p.remove(this.btnFlag,"traceControlDisabledDiv");p.remove(this.btnBarrier,"traceControlDisabledDiv")},_verifyParams:function(a,b){var d;if(a&&a.jobInfo&&a.jobInfo.results)for(d in a.jobInfo.results)if(a.jobInfo.results.hasOwnProperty(d)&&b===d)return!0;return!1},_processGPResults:function(a,b){this.gp.getResultData(a.jobInfo.jobId,b).then(e.hitch(this,function(d){this._showGPResults(d)}))},_onSubmitJobError:function(){this._clearResults();
this._showLoadingIcon(!1)},_populateResultsToggle:function(a){var b="",d="",h,G,E,da,ea;var fa={Count:0,SkipCount:0};var oa=this._getResultContainerDataObject(a.paramName);this.config&&this.config.geoprocessing&&this.config.geoprocessing.inputs&&0<this.config.geoprocessing.inputs.length&&q.forEach(this.config.geoprocessing.inputs,function(ka){"Skip"!==ka.type||""===ka.toolTip&&null===ka.toolTip||(b=ka.toolTip)});var ua=a.bypassDetails.IDField||this._getResultItemObjectID(a);a.bypassDetails.skipable&&
(this._addSkipAllLocationButton(oa),this.config.skipableLayers||(this.config.skipableLayers=[]),0>this.config.skipableLayers.indexOf(a.layer.id)&&this.config.skipableLayers.push(a.layer.id));a.layer.oid=ua;q.forEach(a.results.features,e.hitch(this,function(ka){var va;h=ka.attributes[ua]||"";d="";E=null;a.bypassDetails.skipable&&null!==this._skipLocationGraphicsLayer&&null===E&&(E=new m(ka.geometry,null,ka.attributes,null),E.GPParam=a.paramName);this._formatDateAttributes(a,ka);da=new m(ka.geometry,
null,ka.attributes,null);a.layer.add(da);ea=f.create("div",{"class":"resultItem"},oa);ka.controlDetails={skipGraphic:E,bypassDetails:a.bypassDetails,selectionGraphic:da};var ra=f.create("div",{"class":"resultItemSubDiv",tabindex:"0"},ea);if(a.bypassDetails.skipable){var ta=null;G=a.paramName+h+"BtnByPass";ka.controlDetails.bypassBtnClass=G;ta=f.create("div",{"class":"resultItemButtonSkipIcon resultItemButton",title:b,"aria-label":b,role:"button",tabindex:"2"},ra);g.set(ta,"layerid",a.layer.id);g.set(ta,
"oid",h);(va=this._checkSkipLocationXY(E))&&va.isFeatureSkipped&&(g.set(ta,"skippedFeatureUniqueId",va.skippedFeatureUniqueId),p.add(ta,"alreadySkippedLocation"));p.add(ta,G);fa.Count+=1;ka.controlDetails.selectionGraphic.bypassed=!1;this._clickEventHandlerArr.push(this.own(D.pausable(ta,"click",e.hitch(this,function(){this._onSkipLocationIconClick(ka,!0,ta)}))))}else ka.controlDetails.selectionGraphic.bypassed=!1,fa.Count+=1;d=this._getZoomToText(a,ka);d=""===d.trim()?"null":d.trim();var ya=f.create("div",
{"class":"resultItemLabel",innerHTML:this.editorXssFilter.sanitize(d),"aria-label":d,role:"button"},ra);a.bypassDetails.skipable?(g.set(ra,"tabindex","0"),g.set(ra,"role","group"),g.set(ra,"aria-label",d),g.set(ya,"tabindex","2"),this.own(D(ya,"keydown",e.hitch(this,function(qa){qa.keyCode===K.ENTER||qa.keyCode===K.SPACE?ya.click():qa.keyCode===K.ESCAPE?(qa.stopPropagation(),qa.preventDefault(),aa.focus(ra)):qa.keyCode===K.TAB&&(qa.stopPropagation(),qa.preventDefault(),aa.focus(ta))}))),this.own(D(ta,
"keydown",e.hitch(this,function(qa){qa.keyCode===K.ENTER||qa.keyCode===K.SPACE?ta.click():qa.keyCode===K.ESCAPE?(qa.stopPropagation(),qa.preventDefault(),aa.focus(ra)):qa.keyCode===K.TAB&&qa.shiftKey&&(qa.stopPropagation(),qa.preventDefault(),aa.focus(ya))})))):(g.set(ra,"tabindex","0"),g.set(ra,"role","button"),g.set(ra,"aria-label",d));this.own(D(ra,"keydown",e.hitch(this,function(qa){if(qa.keyCode===K.ENTER||qa.keyCode===K.SPACE)a.bypassDetails.skipable?aa.focus(ta):ya.click()})));this._clickEventHandlerArr.push(this.own(D.pausable(ya,
"click",e.hitch(this,function(qa){this.map&&this.map.infoWindow&&this.map.infoWindow.hide();this._zoomToBtn(ka,qa)}))));ka.controlDetails.selectionGraphic.resultItem=ka;this._setResultInfoTemplate(da,a,b,ka)}));if("Result"===a.type){var na=this._getLayerNameObject(a);g.set(na.parentElement.parentElement,"aria-label",a.panelText+" ("+(fa.Count+fa.SkipCount)+")");g.set(na.parentElement.parentElement.firstElementChild.firstElementChild,"aria-label",a.panelText+" ("+(fa.Count+fa.SkipCount)+")");g.set(na.parentElement,
"aria-label",a.panelText+" ("+(fa.Count+fa.SkipCount)+")");g.set(na,"innerHTML",Y.sanitizeHTML(a.panelText+" ("+(fa.Count+fa.SkipCount)+")"));na=this._getResultContainerLabelObject(a);g.set(na,"innerHTML",Y.sanitizeHTML(a.panelText+" ("+(fa.Count+fa.SkipCount)+")"))}na={};na.outputLayer=a;na.outputLayerResultCount=fa;this._outputResultArr.push(na);this._outputResultCount++;this._outputResultCount===this.config.geoprocessing.outputs.length&&this._convertSummaryExpressionIntoValue()},_convertSummaryExpressionIntoValue:function(){var a=
null;a=this.config.summaryExpression.summaryExpressionTrimmedValue;a=this._convertExpressionRelatedToInputParameter(a);(a=this._convertExpressionRelatedToOutputParameter(a))&&""!==a&&(this.resultLayersInformationContainer.innerHTML=this.editorXssFilter.sanitize(a),g.set(this.resultLayersInformationContainer,"aria-label",Y.stripHTML(a)),null!==this.resultLayersInformationContainer.innerHTML&&void 0!==this.resultLayersInformationContainer.innerHTML&&""!==this.resultLayersInformationContainer.innerHTML&&
p.remove(this.resultLayersInformationContainer,"esriCTHidden"))},_convertExpressionRelatedToInputParameter:function(a){var b,d;for(b=0;b<this.config.summaryExpression.summaryExpressionValueArr.length;b++){var h=this.config.summaryExpression.summaryExpressionValueArr[b].trimmedValue.split(":");for(d=0;d<this.gpInputDetails.length;d++)if(h[0]===this.gpInputDetails[d].paramName){var G=new RegExp("{"+this.config.summaryExpression.summaryExpressionValueArr[b].trimmedValue+"}","g");var E=this.gpInputDetails[d].graphics.length;
a=a.replace(G,E)}}return a},_convertExpressionRelatedToOutputParameter:function(a){var b,d;var h="";for(b=0;b<this.config.summaryExpression.summaryExpressionValueArr.length;b++){var G=this.config.summaryExpression.summaryExpressionValueArr[b].trimmedValue.split(":");if(2===G.length)for(d=0;d<this._outputResultArr.length;d++){if(G[0]===this._outputResultArr[d].outputLayer.paramName){var E=new RegExp("{"+this.config.summaryExpression.summaryExpressionValueArr[b].trimmedValue+"}","g");G[1]===this.config.summaryExpression.summaryExpressionNLS.outputOperatorCountOption?
h=this._outputResultArr[d].outputLayerResultCount.Count:G[1]===this.config.summaryExpression.summaryExpressionNLS.outputOperatorSkipCountOption&&(h=this._outputResultArr[d].outputLayerResultCount.SkipCount);a=a.replace(E,h)}}else if(3===G.length)for(d=0;d<this._outputResultArr.length;d++)G[0]===this._outputResultArr[d].outputLayer.paramName&&(E=new RegExp("{"+this.config.summaryExpression.summaryExpressionValueArr[b].trimmedValue+"}","g"),G[2]===this.config.summaryExpression.summaryExpressionNLS.fieldOperatorSumOption&&
this._outputResultArr[d].outputLayer.results.features&&(h=this._getSumValueOfField(this._outputResultArr[d].outputLayer.results.features,G[1])),G[2]===this.config.summaryExpression.summaryExpressionNLS.fieldOperatorMinOption&&this._outputResultArr[d].outputLayer.results.features&&(h=this._getMinValueOfField(this._outputResultArr[d].outputLayer.results.features,G[1])),G[2]===this.config.summaryExpression.summaryExpressionNLS.fieldOperatorMaxOption&&this._outputResultArr[d].outputLayer.results.features&&
(h=this._getMaxValueOfField(this._outputResultArr[d].outputLayer.results.features,G[1])),G[2]===this.config.summaryExpression.summaryExpressionNLS.fieldOperatorMeanOption&&this._outputResultArr[d].outputLayer.results.features&&(h=this._getMeanValueOfField(this._outputResultArr[d].outputLayer.results.features,G[1])),a=a.replace(E,h))}return a},_getSumValueOfField:function(a,b){var d;var h=[];for(d=0;d<a.length;d++)null!==a[d].attributes[b]&&""!==a[d].attributes[b]&&void 0!==a[d].attributes[b]&&h.push(a[d].attributes[b]);
return 0<h.length?(a=this._getSummationOfArr(h),2<this._decimalPlaces(a)&&(a=a.toFixed(2)),a):0},_decimalPlaces:function(a){return(a=(""+a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(a[1]?a[1].length:0)-(a[2]?+a[2]:0)):0},_getSummationOfArr:function(a){var b=0,d;for(d in a)b+=a[d];return b},_getMinValueOfField:function(a,b){var d;var h=[];for(d=0;d<a.length;d++)null!==a[d].attributes[b]&&""!==a[d].attributes[b]&&void 0!==a[d].attributes[b]&&h.push(a[d].attributes[b]);return 0<h.length?
(a=Math.min.apply(Math,h),2<this._decimalPlaces(a)&&(a=a.toFixed(2)),a):0},_getMaxValueOfField:function(a,b){var d;var h=[];for(d=0;d<a.length;d++)null!==a[d].attributes[b]&&""!==a[d].attributes[b]&&void 0!==a[d].attributes[b]&&h.push(a[d].attributes[b]);return 0<h.length?(a=Math.max.apply(Math,h),2<this._decimalPlaces(a)&&(a=a.toFixed(2)),a):0},_getMeanValueOfField:function(a,b){var d;var h=[];for(d=0;d<a.length;d++)null!==a[d].attributes[b]&&""!==a[d].attributes[b]&&void 0!==a[d].attributes[b]&&
h.push(a[d].attributes[b]);return 0<h.length?(a=this._getSummationOfArr(h),h=a/h.length,2<this._decimalPlaces(h)&&(h=h.toFixed(2)),h):0},_formatDateAttributes:function(a,b){var d;if(a.results&&a.results.fields)for(d=0;d<a.results.fields.length;d++)"esriFieldTypeDate"===a.results.fields[d].type&&(b.attributes[a.results.fields[d].name]=b.attributes[a.results.fields[d].name]?this._formatDate(b.attributes[a.results.fields[d].name]):"")},_getResultItemObjectID:function(a){for(var b in a.results.fields)if(a.results.fields.hasOwnProperty(b)&&
"esriFieldTypeOID"===a.results.fields[b].type)return a.results.fields[b].name},_createGPServiceOutputParameterObj:function(){q.forEach(this._gpServiceOutputParameter,e.hitch(this,function(a){a.hasOwnProperty("name")&&(this._gpServiceOutputParameterObj[a.name]={},a.defaultValue&&a.defaultValue.fields&&q.forEach(a.defaultValue.fields,e.hitch(this,function(b){this._gpServiceOutputParameterObj[a.name][b.name]=b.type})))}))},_getFieldAliasFromGPService:function(a){var b=[],d,h=[];var G={url:this.config.geoprocessing.url,
content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4};this._showLoadingIcon(!0);O(G).then(e.hitch(this,function(E){b=E.parameters;for(d=0;d<b.length;d++)"esriGPParameterDirectionOutput"===b[d].direction&&h.push(b[d]);this._gpServiceOutputParameter=h;this._createGPServiceOutputParameterObj();a?this._GPExecute():this._loadWidgetInProjectMode()}),e.hitch(this,function(){this._showLoadingIcon(!1);p.add(this.mainParentContentContainer,"esriCTHidden");p.remove(this.errorNode,"esriCTHidden")}))},
_resetInputOutputTabParentContainer:function(){var a={};a.node=this.inputOutputTabParentContainer;a.considerSaveAndExport=!0;a.considerLoadProject=!0;a.considerInputSummaryText=!0;this._resetHeight(a)},_getFieldNameColValue:function(a,b){for(var d=0;d<b.length;d++)if(a===b[d].name)return a=b[d].alias&&""!==b[d].alias?b[d].alias:b[d].name;return a},_setResultInfoTemplate:function(a,b,d,h){var G,E,da=[];var ea=new Z;var fa=b.panelText;ea.setTitle("\x26nbsp;");var oa=f.create("div",{"class":"attrMainSection"});
f.create("div",{"class":"attrHeader",innerHTML:Y.sanitizeHTML(fa)},oa);f.create("div",{"class":"attrSeparator"},oa);fa=f.create("div",null,oa);fa=f.create("table",{"class":"attrResultInfoTable"},fa);if(this._gpServiceOutputParameter)for(E=0;E<this._gpServiceOutputParameter.length;E++)this._gpServiceOutputParameter[E].name===b.paramName&&(da=this._gpServiceOutputParameter[E].defaultValue.fields);if(b.saveToLayer)var ua=this._layerInfosObj.getLayerInfoById(b.saveToLayer).layerObject;E=f.create("tbody",
{},fa);for(G in a.attributes)if(a.attributes.hasOwnProperty(G)){var na=a.attributes[G];fa=f.create("tr",{},E);var ka=f.create("td",{innerHTML:Y.sanitizeHTML(this._getFieldNameColValue(G,da)),"class":"attrName"},fa);ua&&((ka=ua.getField(G))&&ka.domain&&"codedValue"===ka.domain.type&&(na=this._getCodedValue(ka.domain,na)),ka&&"esriFieldTypeDate"===ka.type&&q.some(ua.infoTemplate.info.fieldInfos,e.hitch(this,function(ra){if(ra.fieldName===G)return na=Y.localizeDateByFieldInfo(na,ra),!0})));f.create("td",
{innerHTML:void 0!==na&&null!==na?na:"","class":"attrValue"},fa)}if(b.bypassDetails.skipable){fa=f.create("tr",{},E);ka=f.create("td",{"class":"attrName",colSpan:2},fa);var va=f.create("div",{"class":"resultItemButtonSkipIcon resultItemButton infoPopupSKipIcon",style:{display:"none"},title:d},ka);(b=this._checkSkipLocationXY(h.controlDetails.skipGraphic))&&b.isFeatureSkipped&&(g.set(va,"skippedFeatureUniqueId",b.skippedFeatureUniqueId),p.add(va,"alreadySkippedLocation"));p.add(va,h.controlDetails.bypassBtnClass);
this._clickEventHandlerArr.push(this.own(D.pausable(va,"click",e.hitch(this,function(){this._onSkipLocationIconClick(h,!0,va)}))))}ea.setContent(oa);a.setInfoTemplate(ea)},_getCodedValue:function(a,b){if(a&&a.codedValues){for(var d=0,h=a.codedValues.length;d<h;d++){var G=a.codedValues[d];if(Ba.isDefined(b)&&e.exists("code",G)&&b.toString()===G.code.toString())return G.name}return b}return b||null},_zoomToBtn:function(a,b){a=a.controlDetails.selectionGraphic;this._highlightSelection(a,a.getLayer(),
b.currentTarget.parentNode.parentNode)},_highlightSelection:function(a,b,d){var h;p.contains(d,"esriCTHighlightedGraphic")?(p.remove(d,"esriCTHighlightedGraphic"),this.animatedLayer.clear()):(this.map.setExtent(Aa.graphicsExtent([a]).expand(1.5)),(h=y(".esriCTHighlightedGraphic",this._widgetTopNode))&&0<h.length&&p.remove(h[0],"esriCTHighlightedGraphic"),this.animatedLayer.clear(),p.add(d,"esriCTHighlightedGraphic"),a=Ca.getHighLightSymbol(a,b),this.animatedLayer.add(a))},_createHighlightingGraphicLayer:function(){this.animatedLayer=
new z;this.map.addLayer(this.animatedLayer)},_resetResults:function(){this.map.graphics.clear();q.forEach(this.config.geoprocessing.outputs,function(a){a.layer&&a.layer.clear()},this)},_resetInputs:function(){q.forEach(this.gpInputDetails,function(a){a.clear()},this)},_errorMessage:function(a){(new R({message:a})).message=a},_onInputLocTabClick:function(){this._displayFlagsList();this._clickEventHandlerArr.push(this.own(D.pausable(this.inputBackClick,"click",e.hitch(this,function(){this._clearSelectionOnBackBtnClk();
this._hideFlagsList(!0);aa.focus(this.inputLocTab)}))));var a={};a.node=this.inputLocDiv;a.considerSaveAndExport=!0;this._resetHeight(a)},_onBarrierLocTabClick:function(){this._displayBarrierList();this._clickEventHandlerArr.push(this.own(D.pausable(this.barrierBackClick,"click",e.hitch(this,function(){this._clearSelectionOnBackBtnClk();this._hideBarrierList(!0);aa.focus(this.barrierLocTab)}))));var a={};a.node=this.barrierLocDiv;a.considerSaveAndExport=!0;this._resetHeight(a)},_addInputLocation:function(a,
b){this._flagCount++;this._inputFlag++;this._hideFlagsList(!0);this._hideAllOutputResultContainer();this._hideAttributeInspector();this._hideExportToCSVForm();this._hideSkipLocationList();this._hideBarrierList();p.add(this.layerFeaturesContainer,"esriCTHidden");this._displayFlagsOnMainScreen();g.set(this.lblInputLoc,"innerHTML",Y.sanitizeHTML(this.nls.lblInputLocTab+" ("+this._flagCount+")"));g.set(this.flagCountLabel,"innerHTML",Y.sanitizeHTML(this.nls.lblInputLocTab+" ("+this._flagCount+")"));g.set(this.inputLocTab,
"aria-label",Y.sanitizeHTML(this.nls.lblInputLocTab+" ("+this._flagCount+")"));var d=f.create("div",{"class":"esriCTFlagsBarriersSkipLocationsMainDiv","aria-label":this.nls.lblInputLocation+this._inputFlag,tabindex:"0",role:"button"});g.set(d,"Graphic",JSON.stringify(a));g.set(d,"LayerType",b);var h=f.create("div",{"class":"esriCTFlagsBarriersSkipLocationsLabelContainer",innerHTML:Y.sanitizeHTML(this.nls.lblInputLocation+this._inputFlag),"aria-label":Y.sanitizeHTML(this.nls.lblInputLocation+this._inputFlag),
tabindex:"2",role:"button"},d);var G=f.create("div",{"class":"esriCTInputFlagCloseDiv","aria-label":this.nls.closeButtonLabel+"  "+this.nls.lblInputLocation+this._inputFlag,tabindex:"2",role:"button"},d);f.place(d,this.flagLocContent);this.own(D(d,"keydown",e.hitch(this,function(E){E.keyCode!==K.ENTER&&E.keyCode!==K.SPACE||aa.focus(h)})));this._clickEventHandlerArr.push(this.own(D.pausable(G,"click",e.hitch(this,function(E){this._removeSelectedLocation(E)}))));this.own(D(G,"keydown",e.hitch(this,
function(E){E.keyCode===K.ENTER||E.keyCode===K.SPACE?this._removeSelectedLocation(E):E.keyCode===K.ESCAPE?(E.stopPropagation(),E.preventDefault(),aa.focus(d)):E.keyCode===K.TAB&&(E.stopPropagation(),E.preventDefault(),aa.focus(h))})));this._clickEventHandlerArr.push(this.own(D.pausable(h,"click",e.hitch(this,function(E){this.map&&this.map.infoWindow&&this.map.infoWindow.hide();this._onClickHighlightLocations(E)}))));this.own(D(h,"keydown",e.hitch(this,function(E){E.keyCode===K.ENTER||E.keyCode===
K.SPACE?(this.map&&this.map.infoWindow&&this.map.infoWindow.hide(),this._onClickHighlightLocations(E)):E.keyCode===K.TAB&&E.shiftKey?(E.stopPropagation(),E.preventDefault(),aa.focus(G)):E.keyCode===K.ESCAPE&&(E.stopPropagation(),E.preventDefault(),aa.focus(d))})))},_removeSelectedLocation:function(a){p.contains(a.currentTarget.parentNode,"esriCTHighlightedGraphic")&&this.animatedLayer.clear();this._onClickCloseRemoveGraphics(a);this._flagCount--;g.set(this.lblInputLoc,"innerHTML",Y.sanitizeHTML(this.nls.lblInputLocTab+
" ("+this._flagCount+")"));g.set(this.flagCountLabel,"innerHTML",Y.sanitizeHTML(this.nls.lblInputLocTab+" ("+this._flagCount+")"));g.set(this.inputLocTab,"aria-label",Y.sanitizeHTML(this.nls.lblInputLocTab+" ("+this._flagCount+")"));0===this.flagLocContent.children.length?(p.add(this.btnTrace,"jimu-state-disabled"),g.set(this.btnTrace,"tabindex",-1),this.btnTrace.disabled=!0,this._hideFlagsList(!0),this._hideFlagsOnMainScreen()):aa.focus(y(".esriCTFlagsBarriersSkipLocationsMainDiv",this.flagLocContent)[0])},
_addBarrierLocation:function(a,b){this._barrierCount++;this._inputBlock++;this._hideBarrierList(!0);this._hideAllOutputResultContainer();this._hideAttributeInspector();this._hideExportToCSVForm();this._hideSkipLocationList();this._hideFlagsList();p.add(this.layerFeaturesContainer,"esriCTHidden");this._displayBarriersOnMainScreen();g.set(this.lblBlockLoc,"innerHTML",Y.sanitizeHTML(this.nls.lblBlockLocTab+" ("+this._barrierCount+")"));g.set(this.barrierCountLabel,"innerHTML",Y.sanitizeHTML(this.nls.lblBlockLocTab+
" ("+this._barrierCount+")"));g.set(this.barrierLocTab,"aria-label",Y.sanitizeHTML(this.nls.lblBlockLocTab+" ("+this._barrierCount+")"));var d=f.create("div",{"class":"esriCTFlagsBarriersSkipLocationsMainDiv","aria-label":this.nls.lblBlockLocation+this._inputBlock,tabindex:"0",role:"button"});g.set(d,"Graphic",JSON.stringify(a));g.set(d,"LayerType",b);var h=f.create("div",{"class":"esriCTFlagsBarriersSkipLocationsLabelContainer",innerHTML:Y.sanitizeHTML(this.nls.lblBlockLocation+this._inputBlock),
"aria-label":Y.sanitizeHTML(this.nls.lblBlockLocation+this._inputBlock),tabindex:"2",role:"button"},d);var G=f.create("div",{"class":"esriCTInputFlagCloseDiv","aria-label":this.nls.closeButtonLabel+"  "+this.nls.lblBlockLocation+this._inputBlock,tabindex:"2",role:"button"},d);f.place(d,this.barrierLocContent);this.own(D(d,"keydown",e.hitch(this,function(E){E.keyCode!==K.ENTER&&E.keyCode!==K.SPACE||aa.focus(h)})));this._clickEventHandlerArr.push(this.own(D.pausable(G,"click",e.hitch(this,this._onBlockCloseDivClicked))));
this.own(D(G,"keydown",e.hitch(this,function(E){E.keyCode===K.ENTER||E.keyCode===K.SPACE?this._onBlockCloseDivClicked(E):E.keyCode===K.ESCAPE?(E.stopPropagation(),E.preventDefault(),aa.focus(d)):E.keyCode===K.TAB&&(E.stopPropagation(),E.preventDefault(),aa.focus(h))})));this._clickEventHandlerArr.push(this.own(D.pausable(h,"click",e.hitch(this,function(E){this.map&&this.map.infoWindow&&this.map.infoWindow.hide();this._onClickHighlightLocations(E)}))));this.own(D(h,"keydown",e.hitch(this,function(E){E.keyCode===
K.ENTER||E.keyCode===K.SPACE?(this.map&&this.map.infoWindow&&this.map.infoWindow.hide(),this._onClickHighlightLocations(E)):E.keyCode===K.TAB&&E.shiftKey?(E.stopPropagation(),E.preventDefault(),aa.focus(G)):E.keyCode===K.ESCAPE&&(E.stopPropagation(),E.preventDefault(),aa.focus(d))})))},_onBlockCloseDivClicked:function(a){p.contains(a.currentTarget.parentNode,"esriCTHighlightedGraphic")&&this.animatedLayer.clear();this._onClickCloseRemoveGraphics(a);this._barrierCount--;g.set(this.lblBlockLoc,"innerHTML",
Y.sanitizeHTML(this.nls.lblBlockLocTab+" ("+this._barrierCount+")"));g.set(this.barrierCountLabel,"innerHTML",Y.sanitizeHTML(this.nls.lblBlockLocTab+" ("+this._barrierCount+")"));g.set(this.barrierLocTab,"aria-label",Y.sanitizeHTML(this.nls.lblBlockLocTab+" ("+this._barrierCount+")"));0===this.barrierLocContent.children.length?(this._hideBarrierList(!0),this._hideBarriersOnMainScreen()):aa.focus(y(".esriCTFlagsBarriersSkipLocationsMainDiv",this.barrierLocContent)[0])},_onClickCloseRemoveGraphics:function(a,
b){if("Skip"===b){b=g.get(a.currentTarget.parentNode,"skippedFeatureUniqueId");var d=this._skippedLocations[b];this._skipLocationGraphicsLayer.remove(d);f.destroy(a.currentTarget.parentNode);this._updateSkipLocation();y("[skippedFeatureUniqueId\x3d'"+b+"']",this._widgetTopNode).removeClass("alreadySkippedLocation");delete this._skippedLocations[b]}else{d=JSON.parse(g.get(a.currentTarget.parentNode,"Graphic"));var h=g.get(a.currentTarget.parentNode,"LayerType");q.some(this.gpInputDetails,function(G){G.type===
h&&q.some(G.graphics,function(E){if(E.attributes.ObjID===d.attributes.ObjID)return G.remove(E),!0})});f.destroy(a.currentTarget.parentNode)}},_onClickHighlightLocations:function(a){var b=g.get(a.currentTarget.parentNode,"LayerType");if("Skip"===b){var d=this._skippedLocations[g.get(a.currentTarget.parentNode,"skippedFeatureUniqueId")];this._highlightSelection(d,d.getLayer(),a.currentTarget.parentNode)}else(d=JSON.parse(g.get(a.currentTarget.parentNode,"Graphic")))&&q.some(this.gpInputDetails,e.hitch(this,
function(h){h.type===b&&q.some(h.graphics,e.hitch(this,function(G){if(G.attributes.ObjID===d.attributes.ObjID)return this._highlightSelection(G,G.getLayer(),a.currentTarget.parentNode),!0}))}))},_enhanceTabThemeStyle:function(){var a;(a=y(".jimu-widget-NetworkTrace .tracePanel",this._widgetTopNode)[0])&&("TabTheme"===this.appConfig.theme.name?p.add(a,"esriCTTabThemePaddding"):p.remove(a,"esriCTTabThemePaddding"))},_enhanceDartThemeStyle:function(){if("DartTheme"===this.appConfig.theme.name&&(this._setDartInlineStyle(),
9===ca("ie"))){var a=y(".jimu-widget-frame.jimu-container",this._widgetTopNode)[0];p.add(a,"esriCTDartBackgroudColor")}},_setDartInlineStyle:function(){var a,b=[];b.push(y(".esriCTFlagBarrierSkipLocationMainPage",this._widgetTopNode));b.push(y(".esriCTInputBarrierLoc",this._widgetTopNode));b.push(y(".tracePanel",this._widgetTopNode));b.push(y(".esriCTResultsLayerNamesContainer",this._widgetTopNode));b.push(y(".esriCTResultContainer",this._widgetTopNode));b.push(y(".esriCTLayerInformationContainer",
this._widgetTopNode));for(a=0;a<b.length;a++)this._setInlineStyle(b[a])},_setInlineStyle:function(a){var b;for(b=0;b<a.length;b++)g.set(a[b],"style","background-color: transparent !important; padding-right: 0px; padding-left: 0px;")},_enhanceLaunchpadThemeStyle:function(){var a;if("LaunchpadTheme"===this.appConfig.theme.name){var b=y(".claro .dijitComboBox\x3ediv.dijitArrowButton.dijitDownArrowButton",this._widgetTopNode);for(a=0;a<b.length;a++)g.set(b[a],"style","height: 30px !important")}},_addFocusClassOnTextBoxClick:function(a){var b,
d,h;p.add(a,"dijitTextBoxIE9");this._clickEventHandlerArr.push(this.own(D.pausable(a,"click",e.hitch(this,function(){b=y(".dijitTextBoxFocusedIE9",this._widgetTopNode);d=y(".dijitTextBoxFocused",this._widgetTopNode)[0];for(h=0;h<b.length;h++)p.remove(b[h],"dijitTextBoxFocusedIE9");p.add(d,"dijitTextBoxFocusedIE9")}))))},_addFocusClassOnDateChange:function(a){var b,d,h;D(a,"change",e.hitch(this,function(){b=y(".dijitTextBoxFocusedIE9",this._widgetTopNode);d=y(".dijitTextBoxFocused",this._widgetTopNode)[0];
for(h=0;h<b.length;h++)p.remove(b[h],"dijitTextBoxFocusedIE9");p.add(d,"dijitTextBoxFocusedIE9")}))},_addClassOnFocus:function(a){var b,d,h;D(a,"focus",e.hitch(this,function(){b=y(".dijitTextBoxFocusedIE9",this._widgetTopNode);d=y(".dijitTextBoxFocused",this._widgetTopNode)[0];for(h=0;h<b.length;h++)p.remove(b[h],"dijitTextBoxFocusedIE9");p.add(d,"dijitTextBoxFocusedIE9")}))},_onRemoveSkipAllButtonClick:function(){var a=y(".esriCTRemoveSkipLocationIcon",this.skipLocationsListContainer);a&&0<a.length&&
q.forEach(a,e.hitch(this,function(b){b.click()}))},_onRemoveSkipAllButtonKeyPress:function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onRemoveSkipAllButtonClick()},_checkSkipLocationXY:function(a){var b=!1;for(var d in this._skippedLocations)if(this._skippedLocations.hasOwnProperty(d)&&a.geometry.x===this._skippedLocations[d].geometry.x&&a.geometry.y===this._skippedLocations[d].geometry.y){b=!0;var h=d;break}return{isFeatureSkipped:b,skippedFeatureUniqueId:h}},_onSkipLocationTabClick:function(){this._displaySkipLocationList();
this._clickEventHandlerArr.push(this.own(D.pausable(this.skipLocationBackClick,"click",e.hitch(this,function(){this._clearSelectionOnBackBtnClk();this._hideSkipLocationList(!0);aa.focus(this.skipLocationTab)}))));var a={};a.node=this.skipLocDiv;a.considerSaveAndExport=!0;this._resetHeight(a)},_addSkipLocation:function(a,b){this._displaySkipLocationsOnMainScreen();g.set(this.lblSkipLoc,"innerHTML",Y.sanitizeHTML(this.nls.lblSkipLocTab+" ("+this._skipLocationCount+")"));g.set(this.skipLocationCountLabel,
"innerHTML",Y.sanitizeHTML(this.nls.lblSkipLocTab+" ("+this._skipLocationCount+")"));g.set(this.skipLocationTab,"aria-label",Y.sanitizeHTML(this.nls.lblSkipLocTab+" ("+this._skipLocationCount+")"));var d=f.create("div",{"class":"esriCTFlagsBarriersSkipLocationsMainDiv","aria-label":this.nls.lblSkipLocation+this._inputSkip,tabindex:"0",role:"button"});g.set(d,"LayerType",a);g.set(d,"skippedFeatureUniqueId",b);var h=f.create("div",{"class":"esriCTFlagsBarriersSkipLocationsLabelContainer",innerHTML:Y.sanitizeHTML(this.nls.lblSkipLocation+
this._inputSkip),"aria-label":Y.sanitizeHTML(this.nls.lblSkipLocation+this._inputSkip),tabindex:"2",role:"button"},d);var G=f.create("div",{"class":"esriCTRemoveSkipLocationIcon","aria-label":Y.sanitizeHTML(this.nls.closeButtonLabel+"  "+this.nls.lblSkipLocation+this._inputSkip),tabindex:"2",role:"button"},d);f.place(d,this.skipLocationsListContainer);this.own(D(d,"keydown",e.hitch(this,function(E){E.keyCode!==K.ENTER&&E.keyCode!==K.SPACE||aa.focus(h)})));this._clickEventHandlerArr.push(this.own(D.pausable(G,
"click",e.hitch(this,function(E){p.contains(E.currentTarget.parentNode,"esriCTHighlightedGraphic")&&this.animatedLayer.clear();this._onClickCloseRemoveGraphics(E,"Skip")}))));this.own(D(G,"keydown",e.hitch(this,function(E){E.keyCode===K.ENTER||E.keyCode===K.SPACE?(p.contains(E.currentTarget.parentNode,"esriCTHighlightedGraphic")&&this.animatedLayer.clear(),this._onClickCloseRemoveGraphics(E,"Skip")):E.keyCode===K.ESCAPE?(E.stopPropagation(),E.preventDefault(),aa.focus(d)):E.keyCode===K.TAB&&(E.stopPropagation(),
E.preventDefault(),aa.focus(h))})));this._clickEventHandlerArr.push(this.own(D.pausable(h,"click",e.hitch(this,function(E){this.map&&this.map.infoWindow&&this.map.infoWindow.hide();this._onClickHighlightLocations(E)}))));this.own(D(h,"keydown",e.hitch(this,function(E){E.keyCode===K.ENTER||E.keyCode===K.SPACE?(this.map&&this.map.infoWindow&&this.map.infoWindow.hide(),this._onClickHighlightLocations(E)):E.keyCode===K.TAB&&E.shiftKey?(E.stopPropagation(),E.preventDefault(),aa.focus(G)):E.keyCode===K.ESCAPE&&
(E.stopPropagation(),E.preventDefault(),aa.focus(d))})))},_updateSkipLocation:function(){this._skipLocationCount--;g.set(this.lblSkipLoc,"innerHTML",Y.sanitizeHTML(this.nls.lblSkipLocTab+" ("+this._skipLocationCount+")"));g.set(this.skipLocationCountLabel,"innerHTML",Y.sanitizeHTML(this.nls.lblSkipLocTab+" ("+this._skipLocationCount+")"));g.set(this.skipLocationTab,"aria-label",Y.sanitizeHTML(this.nls.lblSkipLocTab+" ("+this._skipLocationCount+")"));if(0===this.skipLocationsListContainer.children.length){var a=
!1;this._tabContainer&&this._tabContainer.viewStack.getSelectedLabel()===this.nls.inputTabTitle&&(a=!0);this._hideSkipLocationList(a);this._hideSkipLocationsOnMainScreen(a)}else aa.focus(y(".esriCTFlagsBarriersSkipLocationsMainDiv",this.skipLocationsListContainer)[0])},_addSkipAllLocationButton:function(a){var b;(b=y(".esriCTSkipAllLocationParentContainer",a.parentNode))&&0<b.length&&f.destroy(b[0]);b=f.create("div",{"class":"esriCTSkipAllLocationParentContainer"});f.place(b,a,"before");var d=f.create("div",
{innerHTML:Y.sanitizeHTML(this.nls.skipAllLocationButtonLabel),"aria-label":Y.sanitizeHTML(this.nls.skipAllLocationButtonLabel),role:"button",tabindex:"0","class":"jimu-btn esriCTSkipLocationButton"},b);this._clickEventHandlerArr.push(this.own(D.pausable(d,"click",e.hitch(this,function(h){var G=y(".resultItemButtonSkipIcon",h.currentTarget.parentNode.parentNode),E=new ha({titleLabel:this.nls.skipAllLocationButtonLabel,width:420,maxHeight:200,autoHeight:!0,content:this.nls.confirmSkipAllLocationsMessage,
"class":this.baseClass,buttons:[{label:this.nls.yes,onClick:e.hitch(this,function(){this._skipAllLocationButtonClicked=!0;q.forEach(G,e.hitch(this,function(da){p.contains(da,"alreadySkippedLocation")||da.click()}));this._skipAllLocationButtonClicked=!1;E.close()})},{label:this.nls.no,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,function(){E.close()})}]})}))));this.own(D(d,"keydown",e.hitch(this,function(h){h.keyCode!==K.ENTER&&h.keyCode!==K.SPACE||d.click()})))},_fetchUrlParameters:function(){var a,
b;var d=[];var h=xa.urlToObject(document.location.href);this._removeDuplicateParamEntries(h);if(h.query)if(h.query.hasOwnProperty("project")){var G=this._loadProjectDropdown.getOptions();q.some(G,e.hitch(this,function(E){if(E.value===h.query.project||E.label===h.query.project)b=E,a=!0}));a?(this._loadProjectDropdown.set("value",b.value),this._setProjectDropdownNameWidth()):this._errorMessage(this.nls.projectNotFoundErr)}else h.query.hasOwnProperty("wkid")&&(G=h.query.wkid,G=parseInt(G,10),this.map.spatialReference&&
this.map.spatialReference.wkid&&this.map.spatialReference.wkid===G&&(G=null)),h.query.hasOwnProperty("flags")&&d.push(this._placeUrlInputs(h.query.flags,"flags",G)),h.query.hasOwnProperty("barriers")&&d.push(this._placeUrlInputs(h.query.barriers,"barriers",G)),(new pa(d)).then(e.hitch(this,function(){this._runTrace(h)}));else this._showLoadingIcon(!1)},_removeDuplicateParamEntries:function(a){a.query&&(a.query.hasOwnProperty("flags")&&Array.isArray(a.query.flags)&&1<a.query.flags.length&&delete a.query.flags,
a.query.hasOwnProperty("barriers")&&Array.isArray(a.query.barriers)&&1<a.query.barriers.length&&delete a.query.barriers,a.query.hasOwnProperty("project")&&Array.isArray(a.query.project)&&1<a.query.project.length&&delete a.query.project,a.query.hasOwnProperty("runTrace")&&Array.isArray(a.query.runTrace)&&1<a.query.runTrace.length&&delete a.query.runTrace)},_placeUrlInputs:function(a,b,d){var h=new N,G=!1;var E=/(\[-?[0-9]*\.?[0-9]*,[0-9]*\.?[0-9]*\])/gi;if(/^\[(\[-?[0-9]*\.?[0-9]*,[0-9]*\.?[0-9]*\],?)*\]$/gi.test(a))G=
!0;else if(E=a.match(E))a="["+E.toString()+"]",G=!0;if(G){var da=JSON.parse(a);if(d){var ea=[];q.forEach(da,function(fa){ea.push(new l(fa[0],fa[1],new ja(parseInt(d,10))))});a=new ma;a.geometries=ea;a.outSR=this.map.spatialReference;this.geometryService.project(a,e.hitch(this,function(fa){var oa=[];q.forEach(fa,function(ua){oa.push([ua.x,ua.y])});this._addInputsOnMap(oa,b);h.resolve(!0)}))}else setTimeout(e.hitch(this,function(){this._addInputsOnMap(da,b);h.resolve(!0)}),100)}return h.promise},_addInputsOnMap:function(a,
b){"flags"===b?this._onFlagButtonClick():"barriers"===b&&this._onBarrierButtonClick();q.forEach(a,e.hitch(this,function(d){if("skip_locations"===b){var h={controlDetails:{}};h.controlDetails.selectionGraphic={};h.controlDetails.selectionGraphic.infoTemplate={};h.controlDetails.selectionGraphic.infoTemplate.content="";h.controlDetails.selectionGraphic.bypassed="";h.controlDetails.skipGraphic=d;this._onSkipLocationIconClick(h,!1)}else d=new l(d[0],d[1],this.map.spatialReference),this._onMapClick(d)}));
"flags"===b?this._onFlagButtonClick():"barriers"===b&&this._onBarrierButtonClick()},_runTrace:function(a){a.query.hasOwnProperty("runTrace")&&"true"===a.query.runTrace&&this._onTraceButtonClick()},_addLoadProjectDropdown:function(){this._loadProjectDropdown=new B({"class":"esriCTLoadProjectDropDown","aria-label":this.nls.selectProject});this._loadProjectDropdown.placeAt(this.loadProjectDropdownContainer);this._loadProjectDropdownEvtHandle=D.pausable(this._loadProjectDropdown,"change",e.hitch(this,
function(a){this._setProjectDropdownNameWidth();this._currentSelectedProjectGuid=a;"newproject"!==a?this._loadExistingProject(a):(p.remove(this.editProjectAttributes,"esriCTEditProjectBtn"),p.add(this.editProjectAttributes,"esriCTDisableEditProjectBtn"),g.set(this.editProjectAttributes,"tabindex",-1),this._clearResults(!0))}));this._loadProjectDropdown.startup();this._addDefaultOptionInDropdown();this._loadProjectDropdown.set("value","newproject");this._setProjectDropdownNameWidth()},_loadExistingProject:function(a){this._showLoadingIcon(!0);
p.remove(this.editProjectAttributes,"esriCTDisableEditProjectBtn");p.add(this.editProjectAttributes,"esriCTEditProjectBtn");g.set(this.editProjectAttributes,"tabindex",0);this._clearResults(!0);this._loadProjectData(a)},_displaySaveAndExportButton:function(){var a;q.some(this.config.geoprocessing.outputs,e.hitch(this,function(b){b.exportToCSV&&(a=!0,this._exportToCSVLayerArray.push({paramName:b.paramName,displayName:b.panelText}))}));this._isWidgetLoadedInProjectMode&&p.remove(this.saveButtonContainer,
"esriCTHidden");a&&p.remove(this.exportButtonContainer,"esriCTHidden");this._isWidgetLoadedInProjectMode&&!a&&(p.add(this.saveAndExportParentContainer,"esriCTTextCenter"),p.add(this.saveButtonContainer,"esriCTSaveButtonCenterContainer"));!this._isWidgetLoadedInProjectMode&&a&&(p.add(this.saveAndExportParentContainer,"esriCTTextCenter"),p.add(this.exportButtonContainer,"esriCTExportButtonCenterContainer"));this._isWidgetLoadedInProjectMode||a||(this._isSaveAndExportHidden=!0)},_resetHeight:function(a){var b=
a.node;var d=a.considerSaveAndExport;var h=a.considerLoadProject;var G=a.considerSkipAll;var E=a.skipAllButton;var da=a.resetFlagBarrierSkipLocationMainPage;var ea=a.resetHeightOutputPanel;a=a.considerInputSummaryText;da?(G=L.getComputedStyle(this.inputTabPanel).height,G=parseFloat(G),L.set(b,"height",G-135+"px")):ea?(G=L.getComputedStyle(this.inputOutputTabParentContainer).height,G=parseFloat(G),L.set(b,"height",G-30+"px")):(da=L.getComputedStyle(this.mainParentContentContainer).height,da=parseFloat(da),
d&&(d=L.getComputedStyle(this.saveAndExportParentContainer).height,d=parseFloat(d),da-=d),h&&(h=L.getComputedStyle(this.loadProjectParentContainer).height,h=parseFloat(h),"NaN"!==h.toString()&&(da-=h)),G&&(E&&0<E.length&&(G=L.getComputedStyle(E[0]).height,G=parseFloat(G),da-=G),da-=40),""!==a&&null!==a&&void 0!==a&&(G=L.getComputedStyle(this.inputTabSummaryTextContainer).height,G=parseFloat(G),"NaN"!==G.toString()&&(da-=G)),L.set(b,"height",da+"px"))},_createNewProjectPopup:function(){var a=f.create("div",
{className:"esriCTSaveAsPopupContainer"});f.create("div",{innerHTML:Y.sanitizeHTML(this.nls.projectNameLabel),className:"esriCTProjectNameLabel"},a);var b=f.create("div",{className:"esriCTprojectNameTextBoxContainer"},a);var d=new U({required:!0,style:{width:"100%"},trim:!0});d.placeAt(b);d.startup();var h=new ha({titleLabel:this.nls.saveProjectPopupTitle,width:420,maxHeight:200,autoHeight:!0,content:a,"class":this.baseClass,buttons:[{label:this.nls.save,onClick:e.hitch(this,function(){""===d.value||
null===d.value||void 0===d.value?this._setErrorMessage(d,this.nls.enterProjectNameMessage):(this._showLoadingIcon(!0),this._saveAsNewProject=!0,this._checkExistingProjectNames(d.value,d,h))})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,function(){this._saveAsNewProject=!1;h.close()})}],onClose:e.hitch(this,function(){})})},_checkExistingProjectNames:function(a,b,d,h,G){var E;if(E=this.map.getLayer(this.config.projectSettings.polygonLayerId)){E=new la(E.url);var da=
new M;da.outFields=[this._polygonLayerFields.name];da.where="1\x3d1";da.returnGeometry=!1;da.outSpatialReference=this.map.spatialReference;E.execute(da).then(e.hitch(this,function(ea){var fa=!1;q.some(ea.features,e.hitch(this,function(oa){oa.attributes[this._polygonLayerFields.name]===a&&(fa=!0)}));fa&&!G?(d?this._setErrorMessage(b,this.nls.projectNameExistsMessage):this._errorMessage(this.nls.projectNameExistsMessage),this._showLoadingIcon(!1)):(ea=a.length,ea=parseInt(ea,10),ea>this._polygonLayerFields.nameFieldLength?
(d?this._setErrorMessage(b,this.nls.projectLengthErrorMessage+" "+this._polygonLayerFields.nameFieldLength):this._errorMessage(this.nls.projectLengthErrorMessage+" "+this._polygonLayerFields.nameFieldLength),this._showLoadingIcon(!1)):(d&&d.close(),h?(this._isAttributeChanged=!0,this._updateExistingProjectAttributes()):this._saveOutagePolygon(a)))}),e.hitch(this,function(){this._saveAsNewProject=!1;d?this._setErrorMessage(b,this.nls.fetchingProjectNamesErrorMessage):this._errorMessage(this.nls.fetchingProjectNamesErrorMessage);
this._showLoadingIcon(!1)}))}},_setErrorMessage:function(a,b){a.focus();a.set("state","Error");a.set("message",b);a.isValid()},_saveOutagePolygon:function(a){var b=null;var d=this.map.getLayer(this.config.projectSettings.outputParamName+this.id);var h=this.map.getLayer(this.config.projectSettings.polygonLayerId);var G={};G[this._polygonLayerFields.name]=a;d&&0<d.graphics.length&&d.graphics[0].geometry&&(b=d.graphics[0].geometry);b="newproject"===this._loadProjectDropdown.getValue()||this._saveAsNewProject?
new m(b,null,this._currentFeatureDetails.attributes,null):new m(b,null,G,null);h.applyEdits([b],null,null,e.hitch(this,function(E){E&&E[0]&&E[0].success?(this._loadProjectDropdownEvtHandle.pause(),this.addProjectDropdownOpt(E,a),setTimeout(e.hitch(this,function(){this._loadProjectDropdownEvtHandle.resume();this._saveFlagsBarriersAndSkipLocations()}),0)):(this._saveAsNewProject=!1,this._showLoadingIcon(!1),this._errorMessage(this.nls.creatingNewProjectErrorMessage+" "+E[0].error.message))}),e.hitch(this,
function(){this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.creatingNewProjectErrorMessage)}))},addProjectDropdownOpt:function(a,b){var d=a[0].globalId;this._currentSelectedProjectGuid=d;this._loadProjectDropdown.addOption({value:d,label:b,objectId:a[0].objectId})},_loadProject:function(a,b){var d;if(d=this.map.getLayer(this.config.projectSettings.polygonLayerId)){var h=d.getDefinitionExpression();if(""===h||null===h||void 0===h)h="1\x3d1";var G=new la(d.url);var E=
new M;E.outFields=["*"];E.where=h;E.returnGeometry=!1;E.outSpatialReference=this.map.spatialReference;G.execute(E).then(e.hitch(this,function(da){q.forEach(da.features,e.hitch(this,function(fa){this._loadProjectDropdown.addOption({value:fa.attributes[d.globalIdField],label:fa.attributes[this._polygonLayerFields.name],objectId:fa.attributes[d.objectIdField]})}));if(a){var ea=this._loadProjectDropdown.getOptions(b);ea?(this._loadProjectDropdown.set("value",b),this._setProjectDropdownNameWidth()):(this._loadProjectDropdown.set("value",
"newproject"),this._setProjectDropdownNameWidth(),p.remove(this.editProjectAttributes,"esriCTEditProjectBtn"),p.add(this.editProjectAttributes,"esriCTDisableEditProjectBtn"));setTimeout(e.hitch(this,function(){this._loadProjectDropdownEvtHandle.resume();this._resumeAllClickEvents();ea||(this._clearResults(),this._errorMessage(this.nls.filteredProjectLoadMessage));this._loadProjectDropdown.set("disabled",!1);this._showLoadingIcon(!1)}),0)}else this._setProjectDropdownNameWidth(),this._fetchUrlParameters()}),
e.hitch(this,function(){a&&(this._loadProjectDropdownEvtHandle.resume(),this._resumeAllClickEvents(),this._loadProjectDropdown.set("disabled",!1));this._showLoadingIcon(!1);this._errorMessage(this.nls.projectNameFetchingErr)}))}},_onProjectSaveButtonClick:function(){p.contains(this.projectSaveButton,"jimu-state-disabled")||("newproject"===this._currentSelectedProjectGuid?(this._showLoadingIcon(!0),this._displayAttributeInspector(),this._addGraphicToLocalLayer()):this._createEditProjectPopup())},_onProjectSaveButtonKeyPress:function(a){a.keyCode!==
K.ENTER&&a.keyCode!==K.SPACE||this._onProjectSaveButtonClick()},_isProjectFiltered:function(){var a;if(a=this.map.getLayer(this.config.projectSettings.polygonLayerId)){var b=a.getDefinitionExpression();if(""===b||null===b||void 0===b)b="1\x3d1";var d=new la(a.url);var h=new M;h.outFields=["*"];h.where=b;h.returnGeometry=!1;h.outSpatialReference=this.map.spatialReference;d.execute(h).then(e.hitch(this,function(G){var E=!0,da=this._loadProjectDropdown.getValue();q.forEach(G.features,e.hitch(this,function(ea){da.toLowerCase()===
ea.attributes[a.globalIdField].toLowerCase()&&(E=!1)}));E?(this._showLoadingIcon(!1),this._errorMessage(this.nls.filteredProjectMessage)):(this._displayAttributeInspector(),this._loadAttributeInspector())}),e.hitch(this,function(){this._showLoadingIcon(!1);this._errorMessage(this.nls.filteredProjectError)}))}},_editProjectAttributes:function(){this._showLoadingIcon(!0);this._isProjectFiltered()},_onEditProjectAttributesKeyPress:function(a){if(a.keyCode===K.ENTER||a.keyCode===K.SPACE)this._showLoadingIcon(!0),
this._isProjectFiltered()},_isValidProjectAttributes:function(){var a=!0;this._attributeInspector&&this._attributeInspector._layerInfos&&this._attributeInspector._layerInfos[0].fieldInfos&&q.some(this._attributeInspector._layerInfos[0].fieldInfos,function(b){if(b&&b.dijit&&b.dijit.isValid&&!b.dijit.isValid())return b.dijit.focus(),a=!1,!0},this);return a},_onOkButtonClick:function(){if("newproject"===this._currentSelectedProjectGuid||this._saveAsNewProject){this._showLoadingIcon(!0);var a=this._getProjectNameTextBox();
a=a.value;""===a||null===a||void 0===a?(this._errorMessage(this.nls.enterProjectNameMessage),this._showLoadingIcon(!1)):(this._saveAsNewProject=!0,this._checkExistingProjectNames(a,null,null))}else if(this._showLoadingIcon(!0),this._isValidProjectAttributes())if(a=this._getProjectNameTextBox(),a=a.value,""===a||null===a||void 0===a)this._errorMessage(this.nls.enterProjectNameMessage),this._showLoadingIcon(!1);else{var b=this._loadProjectDropdown.getValue();b=this._loadProjectDropdown.getOptions(b);
var d=!1;a===b.label&&(d=!0);this._checkExistingProjectNames(a,null,null,!0,d)}else this._showLoadingIcon(!1)},_onOkButtonKeyPress:function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onOkButtonClick()},_updateExistingProjectAttributes:function(){this._isAttributeChanged?(this._showLoadingIcon(!0),this._isAttributeChanged=!1,this._updateProjectAttributes()):this._hideAttributeInspector()},_hideAttributeInspector:function(){this._clearAttributeInspectorData();p.add(this.editAttributeContainer,
"esriCTHidden");this._displayEntireMainScreen()},_hideAttributeInspectorKeyPress:function(a){if(a.keyCode===K.ENTER||a.keyCode===K.SPACE)this._clearAttributeInspectorData(),p.add(this.editAttributeContainer,"esriCTHidden"),this._displayEntireMainScreen()},_clearAttributeInspectorData:function(){this._attributeInspector&&(this._attributeInspector.layerInfos&&q.forEach(this._attributeInspector.layerInfos,function(a){a=a.featureLayer;a.clearSelection();a.refresh()}),this._attributeInspector.destroy())},
_loadAttributeInspector:function(){var a;var b=this._createFieldInfos();f.empty(this.attributeInspectorContainer);var d=this.map.getLayer(this.config.projectSettings.polygonLayerId);this._attributeInspector=new (P([c],{constructor:function(){this._aiConnects=[];this._selection=[];this._toolTips=[]}}))({layerInfos:[{featureLayer:d,showAttachments:!1,isEditable:!0,fieldInfos:b}]},f.create("div"));this._attributeInspector.on("attribute-change",e.hitch(this,function(G){this._isAttributeChanged=!0;this._projectAttributeGraphic.attributes[G.fieldName]=
G.fieldValue}));this.attributeInspectorContainer.appendChild(this._attributeInspector.domNode);b=new M;var h=Date.now();b.where=d.globalIdField+"\x3d'"+this._loadProjectDropdown.getValue()+"' AND "+h+" \x3d "+h;b.outFields=["*"];d.selectFeatures(b,C.SELECTION_NEW,e.hitch(this,function(G){this._projectAttributeGraphic=G[0];a=this._attributeInspector.attributeTable.childNodes[0];g.set(a,"cellspacing","5");g.set(a,"cellpadding","5");this._add508SupportToATI();this._showLoadingIcon(!1)}),e.hitch(this,
function(){this._showLoadingIcon(!1);this._errorMessage(this.nls.projectAttributeLoadingErr)}))},_add508SupportToATI:function(){var a;this._attributeInspector&&this._attributeInspector.domNode&&(a=y("td.atiLabel",this._attributeInspector.domNode))&&q.forEach(a,e.hitch(this,function(d){var h=this._getAttrInspectorRowInfo(d);h&&(h[0].set("aria-label",h[1]),b||h[0].disabled||(b=h[0].focusNode),1<d.parentNode.childNodes[1].childNodes.length&&(d=d.parentNode.childNodes[1].childNodes[1],d=W.getEnclosingWidget(d),
d.set("aria-label",h[1])))}));if(!b)var b=this.editProjectAttributeOkButtonNode;this._setWidgetFirstFocusNode(b);this._currentLastNode=this.editProjectAttributeCancelButtonNode;aa.focus(b)},_getAttrInspectorRowInfo:function(a){try{if(a&&a.parentNode){var b=a.parentNode.childNodes[1].childNodes[0];return[W.getEnclosingWidget(b),a.childNodes[0].data,b]}return null}catch(d){return console.log(d),null}},_updateProjectAttributes:function(){this.map.getLayer(this.config.projectSettings.polygonLayerId).applyEdits(null,
[this._projectAttributeGraphic],null,e.hitch(this,function(a,b,d){b&&b[0]&&b[0].success?(this._loadProjectDropdownEvtHandle.pause(),a=this._currentSelectedProjectGuid,b=this._loadProjectDropdown.getOptions(a),d=b.objectId,this._loadProjectDropdown.removeOption(b),this._loadProjectDropdown.addOption({label:this._projectAttributeGraphic.attributes[this._polygonLayerFields.name],value:a,objectId:d}),this._loadProjectDropdown.set("value",a),this._setProjectDropdownNameWidth(),setTimeout(e.hitch(this,
function(){this._loadProjectDropdownEvtHandle.resume();this._hideAttributeInspector();this._showLoadingIcon(!1);this._errorMessage(this.nls.attributeUpdatedMsg)}),0)):(this._showLoadingIcon(!1),this._errorMessage(this.nls.projectAttributeUpdatingErr+" "+b[0].error.message))}),e.hitch(this,function(){this._showLoadingIcon(!1);this._errorMessage(this.nls.projectAttributeUpdatingErr)}))},_createFieldsDetailsObject:function(){var a={};q.forEach(this._projectLayerInfo.layerObject.fields,e.hitch(this,function(b){a[b.name]=
b.type}));return a},_createFieldInfos:function(){this._projectLayerInfo=this._layerInfosObj.getLayerInfoById(this.config.projectSettings.polygonLayerId);var a=this._createFieldsDetailsObject();var b=this._getFieldInfosFromLayer(this._projectLayerInfo);this._projectLayerInfo.controlPopupInfo&&this._projectLayerInfo.controlPopupInfo.enablePopup&&this._projectLayerInfo.controlPopupInfo.infoTemplate&&(b=e.clone(this._projectLayerInfo.controlPopupInfo.infoTemplate.info.fieldInfos));var d=[];q.forEach(b,
e.hitch(this,function(h){if(h.visible&&a[h.fieldName]&&"esriFieldTypeRaster"!==a[h.fieldName]&&"esriFieldTypeBlob"!==a[h.fieldName]||h.fieldName===this._polygonLayerFields.name)h.fieldName===this._polygonLayerFields.name&&(h.nullable=!1,h.visible=!0),h.format&&h.format.dateFormat&&h.format.dateFormat.toLowerCase()&&0<=h.format.dateFormat.toLowerCase().indexOf("time")&&(h.format.time=!0),d.push(h)}));return d},mergeFirstToLast:function(){for(var a={},b=arguments.length-1,d;0<=b;b--)for(d in arguments[b])arguments[b].hasOwnProperty(d)&&
(a[d]=arguments[b][d]);return a},_getFieldInfosFromLayer:function(a){var b=[];a&&a.layerObject&&q.forEach(a.layerObject.fields,function(d){var h=Y.getDefaultPortalFieldInfo(d);h=this.mergeFirstToLast(h,d);h.format&&h.format.dateFormat&&h.format.dateFormat.toLowerCase()&&0<=h.format.dateFormat.toLowerCase().indexOf("time")&&(h.format.time=!0);h.visible=!0;h.fieldName===this._polygonLayerFields.name&&(d.nullable=!1);b.push(h)},this);return b},_getLayerInfos:function(){sa.getInstance(this.map,this.map.webMapResponse.itemInfo).then(e.hitch(this,
function(a){this._layerInfosObj=a;this.config.projectSettings&&this.config.projectSettings.polygonLayerId&&this.config.projectSettings.pointLayerId&&(this._getPointLayerFields(),this._getPolygonLayerFields());this._loadWidget()}))},_createLoadProjectDetailsObj:function(){this._loadProjectDetailsObj={};q.forEach(this.config.geoprocessing.outputs,e.hitch(this,function(a){this.config.projectSettings&&a.paramName===this.config.projectSettings.outputParamName&&!a.saveToLayer&&this.config.projectSettings.polygonLayerId&&
(a.saveToLayer=this.config.projectSettings.polygonLayerId);a.saveToLayer&&this.map.getLayer(a.saveToLayer)&&(this._loadProjectDetailsObj[a.paramName]={layerID:a.saveToLayer,guidfield:a.guidField,parameternamefield:a.parameternameField})}))},_loadProjectData:function(a){this._queryOutagePolygon(a)},_loadOutagePolygon:function(a){var b=this.map.getLayer(this.config.projectSettings.outputParamName+this.id);b&&b.add(a)},_queryOutagePolygon:function(a){var b=this.map.getLayer(this.config.projectSettings.polygonLayerId);
var d=new la(b.url);var h=new M;h.outFields=["*"];h.where=b.globalIdField+"\x3d'"+a+"'";h.returnGeometry=!0;h.outSpatialReference=this.map.spatialReference;d.execute(h).then(e.hitch(this,function(G){G&&0<G.features.length&&(G=new m(G.features[0].geometry,null,G.features[0].attributes,null),this._loadOutagePolygon(G));this._queryFlagsBarriersAndSkipLocation(a)}),e.hitch(this,function(){this._showLoadingIcon(!1);this._errorMessage(this.nls.fetchingOutagePolygonMessage)}))},_queryFlagsBarriersAndSkipLocation:function(a){var b=
this.map.getLayer(this.config.projectSettings.pointLayerId);var d=new la(b.url);b=new M;b.outFields=["*"];b.where="projectid\x3d'"+a+"'";b.returnGeometry=!0;b.outSpatialReference=this.map.spatialReference;d.execute(b).then(e.hitch(this,function(h){this._allProjectLoadedInputs=h.features;this._segregateInputs(h.features)}),e.hitch(this,function(){this._showLoadingIcon(!1);this._errorMessage(this.nls.loadingProjectDetailsErrorMessage)}))},_segregateInputs:function(a){var b=[];var d=[];var h=[];a&&0<
a.length&&this._pointLayerFields&&this._pointLayerFields.inputType&&q.forEach(a,e.hitch(this,function(G){switch(G.attributes[this._pointLayerFields.inputType]){case "Flag":b.push([G.geometry.x,G.geometry.y]);break;case "Barrier":d.push([G.geometry.x,G.geometry.y]);break;case "Skip":h.push(G)}}));this._addInputsOnMap(b,"flags");this._addInputsOnMap(d,"barriers");this._addInputsOnMap(h,"skip_locations");this._fetchFeatures()},_onSkipLocationIconClick:function(a,b,d){if(null!==this._skipLocationGraphicsLayer){if(d)if(p.contains(d,
"alreadySkippedLocation")){p.remove(d,"alreadySkippedLocation");var h=!0}else p.add(d,"alreadySkippedLocation"),h=!1;b=this._checkSkipLocationXY(a.controlDetails.skipGraphic);b.isFeatureSkipped?h?(a=y("[skippedFeatureUniqueId\x3d'"+b.skippedFeatureUniqueId+"']",this.skipLocationsListContainer),y(".esriCTRemoveSkipLocationIcon",a[0])[0].click()):(d&&g.set(d,"skippedFeatureUniqueId",b.skippedFeatureUniqueId),this._skipAllLocationButtonClicked||this._errorMessage(this.nls.locationAlreadySkippedMessage)):
(this._skipLocationCount++,this._inputSkip++,h=this._inputSkip,this._skippedLocations[h]=a.controlDetails.skipGraphic,this._addSkipLocation("Skip",h),this._skipLocationGraphicsLayer.add(a.controlDetails.skipGraphic),a.controlDetails.selectionGraphic.bypassed=!0,d&&g.set(d,"skippedFeatureUniqueId",this._inputSkip))}},_deleteExistingInputs:function(){this.map.getLayer(this.config.projectSettings.pointLayerId).applyEdits(null,null,this._allProjectLoadedInputs,e.hitch(this,function(){this._saveFlagsBarriersAndSkipLocations()}),
e.hitch(this,function(){this._updateExistingProject=this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.deletingExistingPolygonErr)}))},_getPolygonLayerFields:function(){var a,b=0;this._polygonLayerFields={name:"",projectId:""};(a=this._layerInfosObj.getLayerInfoById(this.config.projectSettings.polygonLayerId))&&a.layerObject&&q.some(a.layerObject.fields,function(d){"name"===d.name.toLowerCase()&&(this._polygonLayerFields.name=d.name,this._polygonLayerFields.nameFieldLength=
d.length,b++);"esriFieldTypeGlobalID"===d.type&&(this._polygonLayerFields.projectId=d.name,b++);if(2===b)return!0},this)},_getPointLayerFields:function(){var a,b=0;this._pointLayerFields={inputType:"",projectId:""};(a=this._layerInfosObj.getLayerInfoById(this.config.projectSettings.pointLayerId))&&a.layerObject&&q.some(a.layerObject.fields,function(d){var h=d.name.toLowerCase();"inputtype"===h&&(this._pointLayerFields.inputType=d.name,b++);"projectid"===h&&(this._pointLayerFields.projectId=d.name,
b++);if(2===b)return!0},this)},_createInputLocations:function(a,b){var d=[];q.forEach(a,e.hitch(this,function(h){var G={};G[this._pointLayerFields.projectId]=this._currentSelectedProjectGuid;G[this._pointLayerFields.inputType]=b;h=new m(h.geometry,null,G,null);d.push(h)}));return d},_saveFlagsBarriersAndSkipLocations:function(){var a=[];var b=[];var d=[];var h=[];this._flagGraphicsLayer&&(a=this._createInputLocations(this._flagGraphicsLayer.graphics,"Flag"));this._barrierGraphicsLayer&&(b=this._createInputLocations(this._barrierGraphicsLayer.graphics,
"Barrier"));this._skipLocationGraphicsLayer&&(d=this._createInputLocations(this._skipLocationGraphicsLayer.graphics,"Skip"));h=h.concat(a,b,d);a=this.map.getLayer(this.config.projectSettings.pointLayerId);var G=a.objectIdField;a.applyEdits(h,null,null,e.hitch(this,function(E,da,ea){this._allProjectLoadedInputs=[];q.forEach(E,e.hitch(this,function(fa){if(fa.success){var oa={};oa[G]=fa.objectId;fa=new m(null,null,oa,null);this._allProjectLoadedInputs.push(fa)}}));this._saveAsNewProject?this._addProjectFeatures():
this._deleteExistingProjectFeatures()}),e.hitch(this,function(){this._updateExistingProject=this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.savingProjectDetailsErr)}))},_updateOutagePolygon:function(){var a=null;var b=this.map.getLayer(this.config.projectSettings.polygonLayerId),d=b.objectIdField,h=this._loadProjectDropdown.getOptions(this._currentSelectedProjectGuid).objectId,G={};G[d]=h;d=this.map.getLayer(this.config.projectSettings.outputParamName+this.id);0<d.graphics.length&&
d.graphics[0].geometry&&(a=d.graphics[0].geometry);null!==a&&void 0!==a&&""!==a?(a=new m(a,null,G,null),b.applyEdits(null,[a],null,e.hitch(this,function(E,da,ea){0<da.length&&da[0].success?this._deleteExistingInputs():(this._updateExistingProject=this._saveAsNewProject=!1,this._showLoadingIcon(!1),this._errorMessage(this.nls.updatingOutagePolygonErr))}),e.hitch(this,function(){this._updateExistingProject=this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.updatingOutagePolygonErr)}))):
this._deleteExistingInputs()},_deleteExistingProjectFeatures:function(){var a={},b;for(b in this._loadProjectDetailsObj){var d=!0;this.config.projectSettings&&this.config.projectSettings.outputParamName&&this.config.projectSettings.polygonLayerId&&b===this.config.projectSettings.outputParamName&&this._loadProjectDetailsObj[b].layerID===this.config.projectSettings.polygonLayerId&&(d=!1);d&&(d=this._fetchedFeaturesDetails[b].features,0<d.length&&(a[b]=this._deleteFeaturesDeferred(b)))}V(a).then(e.hitch(this,
function(){this._addProjectFeatures()}),e.hitch(this,function(){this._updateExistingProject=this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.deletingExistingProjectFeaturesErr)}))},_deleteFeaturesDeferred:function(a){var b=this.map.getLayer(this._loadProjectDetailsObj[a].layerID);a=this._fetchedFeaturesDetails[a].features;var d=[];var h=b.objectIdField;q.forEach(a,e.hitch(this,function(G){var E={};E[h]=G.attributes[h];G=new m(null,null,E,null);d.push(G)}));return b.applyEdits(null,
null,d).promise},_addProjectFeatures:function(){var a={},b;for(b in this._loadProjectDetailsObj){var d=!0;this.config.projectSettings&&this.config.projectSettings.outputParamName&&this.config.projectSettings.polygonLayerId&&b===this.config.projectSettings.outputParamName&&this._loadProjectDetailsObj[b].layerID===this.config.projectSettings.polygonLayerId&&(d=!1);var h=this.map.getLayer(b+this.id);d&&h&&0<h.graphics.length&&(a[b]=this._addFeaturesDeferred(b))}V(a).then(e.hitch(this,function(){this._saveAsNewProject?
(this._clearResults(),this._loadProjectDropdown.set("value",this._currentSelectedProjectGuid),this._setProjectDropdownNameWidth()):this._updateExistingProject?this._loadExistingProject(this._currentSelectedProjectGuid):(this._updateExistingProject=this._saveAsNewProject=!1,this._showLoadingIcon(!1))}),e.hitch(this,function(){this._updateExistingProject=this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.addingProjectFeaturesErr)}))},_addFeaturesDeferred:function(a){var b=
{};var d={};var h=[];var G=this._currentSelectedProjectGuid;var E=this.map.getLayer(a+this.id);var da=this.map.getLayer(this._loadProjectDetailsObj[a].layerID);q.forEach(da.fields,e.hitch(this,function(oa){b[oa.name.toLowerCase()]={type:oa.type,name:oa.name}}));var ea=this._gpServiceOutputParameterObj[a],fa;for(fa in ea)d[fa.toLowerCase()]={type:ea[fa],name:fa};q.forEach(E.graphics,e.hitch(this,function(oa){var ua={},na;for(na in oa.attributes){var ka,va,ra;var ta=ra=va=ka=null;d.hasOwnProperty(na.toLowerCase())&&
(ka=d[na.toLowerCase()].name,va=d[na.toLowerCase()].type);b.hasOwnProperty(na.toLowerCase())&&(ra=b[na.toLowerCase()].name,ta=b[na.toLowerCase()].type);ka&&ra&&va===ta&&oa.attributes[na]&&""!==oa.attributes[na].toString()&&(ua[ra]=oa.attributes[na])}ua[this._loadProjectDetailsObj[a].guidfield]=G;ua[this._loadProjectDetailsObj[a].parameternamefield]=a;oa=new m(oa.geometry,null,ua,null);h.push(oa)}));return da.applyEdits(h,null,null).promise},_queryLayerDeferred:function(a){var b=this._currentSelectedProjectGuid;
var d=this.map.getLayer(this._loadProjectDetailsObj[a].layerID);var h=new la(d.url);d=new M;d.outFields=["*"];this.config.projectSettings&&this.config.projectSettings.outputParamName&&this.config.projectSettings.polygonLayerId&&a===this.config.projectSettings.outputParamName&&this._loadProjectDetailsObj[a].layerID===this.config.projectSettings.polygonLayerId?d.where=this._polygonLayerFields.projectId+"\x3d'"+b+"'":this._loadProjectDetailsObj[a].guidfield&&this._loadProjectDetailsObj[a].parameternamefield&&
(d.where=this._loadProjectDetailsObj[a].guidfield+"\x3d'"+b+"' and "+this._loadProjectDetailsObj[a].parameternamefield+"\x3d'"+a+"'");if(""===d.where||null===d.where||void 0===d.where)d.where="1!\x3d1";d.returnGeometry=!0;d.outSpatialReference=this.map.spatialReference;return h.execute(d).promise},_fetchFeatures:function(){this._executeTracePreRequisites(!1);var a={},b;for(b in this._loadProjectDetailsObj)a[b]=this._queryLayerDeferred(b);V(a).then(e.hitch(this,function(d){this._fetchedFeaturesDetails=
d;this._resetSubmitJobDetails();for(var h in d){var G=d[h].features;h===this.config.projectSettings.outputParamName&&G&&0<G.length&&!G[0].geometry&&(G=[]);this._createGPResultObj(h,G,d[h].geometryType)}q.forEach(this.config.geoprocessing.outputs,e.hitch(this,function(E,da){d.hasOwnProperty(E.paramName)?this.config.geoprocessing.outputs[da].results=d[E.paramName]:(this._createGPResultObj(E.paramName,[],"esriGeometryPoint"),this.config.geoprocessing.outputs[da].results=[])}));this._zoomToProject();
this._saveAsNewProject?this._saveAsNewProject=!1:this._updateExistingProject&&(this._updateExistingProject=!1);this._showLoadingIcon(!1)}),e.hitch(this,function(){this._showLoadingIcon(!1);this._errorMessage(this.nls.loadingProjectFeaturesErr)}))},_createGPResultObj:function(a,b,d){var h={};h.paramName=a;h.value={};h.value.features=b;h.value.geometryType=d;this._showGPResults(h)},_executeTracePreRequisites:function(a){var b;this._outputResultArr=[];this._outputResultCount=0;this.savedFeatureObjectId=
this.overviewFeature=null;f.empty(this.resultLayersInformationContainer);var d=y(".esriCTFeaturesListParentContainer",this._widgetTopNode);for(b=0;b<d.length;b++)f.empty(d[b]);this.enableWebMapPopup();a&&(this._gpServiceOutputParameter?this._GPExecute():this._getFieldAliasFromGPService(!0))},_resetSubmitJobDetails:function(){this.overExtent=null;this.resultsCnt=0;this.outputStrings={}},_showGPResults:function(a){this._onGetResultDataComplete(a);this.resultsCnt++;this.resultsCnt===this.config.geoprocessing.outputs.length&&
(this.config.autoZoomAfterTrace&&this._zoomToProject(),p.remove(this.exportToCsvMainScreenButton,"jimu-state-disabled"),g.set(this.exportToCsvMainScreenButton,"tabindex",0),this._showLoadingIcon(!1),this._isRunButtonClicked&&(this._isRunButtonClicked=!1,this._enableProjectSaveButton()),this._displayOutputPanel(!0))},_zoomToProject:function(){var a=[];var b=[];q.forEach(this.config.geoprocessing.inputs,function(d){d&&d.paramName&&this.map.getLayer(d.paramName+this.id)&&(a=a.concat(this.map.getLayer(d.paramName+
this.id).graphics))},this);q.forEach(this.config.geoprocessing.outputs,function(d){d&&d.paramName&&this.map.getLayer(d.paramName+this.id)&&(a=a.concat(this.map.getLayer(d.paramName+this.id).graphics))},this);0<a.length&&(q.forEach(a,e.hitch(this,function(d){d.geometry&&b.push(d)})),0<b.length&&this.map.setExtent(Aa.graphicsExtent(b).expand(1.5)))},_createEditProjectPopup:function(){var a=this._loadProjectDropdown.getOptions(this._currentSelectedProjectGuid).label;var b=f.create("div",{className:"esriCTSaveProjectPopupContainer"});
a=Ba.substitute({loadProjectDropdownlabel:a},this.nls.saveChangesMsg);f.create("div",{innerHTML:Y.sanitizeHTML(a),"aria-label":Y.stripHTML(a),style:{margin:"2px"},role:"presentation",tabindex:0},b);var d=new ha({titleLabel:this.nls.saveProjectPopupTitle,width:500,maxHeight:200,autoHeight:!0,content:b,"class":this.baseClass,buttons:[{label:this.nls.save,onClick:e.hitch(this,function(){this._saveAsNewProject=!1;this._updateExistingProject=!0;this._showLoadingIcon(!0);this._updateOutagePolygon();d.close()})},
{label:this.nls.saveAsLabel,onClick:e.hitch(this,function(){this._showLoadingIcon(!0);this._saveAsNewProject=!0;d.close();this._displayAttributeInspector();this._addGraphicToLocalLayer()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,function(){this._updateExistingProject=this._saveAsNewProject=!1;d.close()})}],onClose:e.hitch(this,function(){})})},_onExportToCSVFormOkBtnClick:function(){if(!p.contains(this.exportToCsvFileMainButton,"jimu-state-disabled")){var a=[];
this._showLoadingIcon(!0);q.forEach(this._exportToCSVLayerArray,e.hitch(this,function(b){b.checkbox.getValue()&&a.push(b.paramName)}));this._downloadCSV(a)}},_onExportToCSVFormOkBtnKeyPress:function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onExportToCSVFormOkBtnClick()},_onExportToCSVFormBackBtnClick:function(){this._hideExportToCSVForm();this.resize()},_onExportToCSVFormBackBtnKeyPress:function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onExportToCSVFormBackBtnClick()},_hideExportToCSVForm:function(){p.add(this.exportToCSVFormParentContainer,
"esriCTHidden");this._displayMainScreen()},_onExportToLayerButtonClick:function(){p.contains(this.exportToCsvMainScreenButton,"jimu-state-disabled")||(p.remove(this.exportToCsvFileMainButton,"jimu-state-disabled"),g.set(this.exportToCsvFileMainButton,"tabindex",0),this._clearSelectionOnBackBtnClk(),this._hideEntireMainScreen(),this._hideFlagsList(!1),this._hideBarrierList(!1),this._hideSkipLocationList(!1),p.remove(this.exportToCSVFormParentContainer,"esriCTHidden"),f.empty(this.exportToCSVFormContainer),
this._displayExportToCSVParamList())},_onExportToLayerButtonKeyPress:function(a){a.keyCode!==K.ENTER&&a.keyCode!==K.SPACE||this._onExportToLayerButtonClick();aa.focus(this.exportBackNode)},_downloadCSV:function(a){q.forEach(a,e.hitch(this,function(b){var d=[];q.forEach(this.config.geoprocessing.outputs,e.hitch(this,function(h){b===h.paramName&&h.results&&d.push(this._createCSVContent(h.results,h.paramName).promise)}));V(d).then(e.hitch(this,function(h){if(0!==h.length){var G;q.forEach(h,function(E){G=
E.csvdata.split(",");e.hitch(this,this._exportToCSVComplete(E,G[0],E.orgResults))},this)}}),e.hitch(this,function(h){this._errorMessage(h)}))}));this._showLoadingIcon(!1);this._errorMessage(this.nls.exportToCSVSuccess)},_displayExportToCSVParamList:function(){this._createExportToCSVRow(this.nls.exportSelectAllCheckBoxLabel,!0);q.forEach(this._exportToCSVLayerArray,e.hitch(this,function(a){this._createExportToCSVRow(a)}));aa.focus(this.exportBackNode);this._setFirstLastNodeOnExportToCSVParamList()},
_createExportToCSVRow:function(a,b){var d=Y.detectUserAgent();var h=d.browser.firefox||d.browser.safari?!1:!0;var G=f.create("div",{"class":"esriCTExportToCsvParentNode"},this.exportToCSVFormContainer);b?(p.add(G,"esriCTExportToCsvSelectAll"),d=a,h||(p.add(G,"esriCTHidden"),p.add(this.exportToCsvFileMainButton,"jimu-state-disabled"),g.set(this.exportToCsvFileMainButton,"tabindex",-1))):d=a.displayName;G=f.create("div",{"class":"esriCTCheckBoxParentNode"},G);var E=new T({checked:h,label:d},G);b?this._exportToCSVSelectAllCheckbox=
E:a.checkbox=E;this.own(D(E,"change",e.hitch(this,function(da){b?this._selectAllExportCheckBox(da,!0):h||(this._selectAllExportCheckBox(!1,!0),da?E.check(!0):E.uncheck(!0));this._maintainSelectAllState()})))},_selectAllExportCheckBox:function(a,b){q.forEach(this._exportToCSVLayerArray,e.hitch(this,function(d){a?d.checkbox.check(b):d.checkbox.uncheck(b)}))},_maintainSelectAllState:function(){var a=!0;var b=!1;q.forEach(this._exportToCSVLayerArray,e.hitch(this,function(d){d.checkbox.getValue()||(a=
!1);d.checkbox.getValue()&&(b=!0)}));b?(p.remove(this.exportToCsvFileMainButton,"jimu-state-disabled"),g.set(this.exportToCsvFileMainButton,"tabindex",0)):(p.add(this.exportToCsvFileMainButton,"jimu-state-disabled"),g.set(this.exportToCsvFileMainButton,"tabindex",-1));a?this._exportToCSVSelectAllCheckbox.check(!0):this._exportToCSVSelectAllCheckbox.uncheck(!0);this._setFirstLastNodeOnExportToCSVParamList()},_displayFlagsOnMainScreen:function(){p.remove(this.inputOutputTabParentContainer,"esriCTHidden");
p.remove(this.inputLocTab,"esriCTHidden");this._setFirstLastNodeOnMainScreen()},_hideFlagsOnMainScreen:function(){p.add(this.inputLocTab,"esriCTHidden");this._disableProjectSaveButton();this._setFirstLastNodeOnMainScreen()},_displayBarriersOnMainScreen:function(){p.remove(this.inputOutputTabParentContainer,"esriCTHidden");p.remove(this.barrierLocTab,"esriCTHidden");this._setFirstLastNodeOnMainScreen()},_hideBarriersOnMainScreen:function(){p.add(this.barrierLocTab,"esriCTHidden");this._disableProjectSaveButton();
this._setFirstLastNodeOnMainScreen()},_displaySkipLocationsOnMainScreen:function(){p.remove(this.skipLocationTab,"esriCTHidden")},_hideSkipLocationsOnMainScreen:function(a){p.add(this.skipLocationTab,"esriCTHidden");a&&this._setFirstLastNodeOnMainScreen();this._disableProjectSaveButton()},_setWidgetFirstFocusNode:function(a){this._firstNodeEventHandler&&this._firstNodeEventHandler.remove();this._firstNodeEventHandler=this.own(D(a,"keydown",e.hitch(this,"_firstNodeKeyDown")))[0];Y.initFirstFocusNode(this.domNode,
a)},_firstNodeKeyDown:function(a){a.keyCode===K.TAB&&a.shiftKey&&(this._backToLastNodeFlag=!0)},_lastNodeFocused:function(){if(this._backToLastNodeFlag){var a=this._currentLastNode;a&&aa.focus(a);this._backToLastNodeFlag=!1}else Y.focusFirstFocusNode(this.domNode)},_setFirstLastNodeOnMainScreen:function(){if(this._isWidgetLoadedInProjectMode){var a=this._loadProjectDropdown.focusNode;this._loadProjectDropdown.focus()}else a=this.btnFlag,aa.focus(a);this._setWidgetFirstFocusNode(a);!this.exportToCsvMainScreenButton||
p.contains(this.exportToCsvMainScreenButton,"jimu-state-disabled")||p.contains(this.exportButtonContainer,"esriCTHidden")?!this.projectSaveButton||p.contains(this.projectSaveButton,"jimu-state-disabled")||p.contains(this.saveButtonContainer,"esriCTHidden")?this.skipLocationTab&&!p.contains(this.skipLocationTab,"esriCTHidden")?this._currentLastNode=this.skipLocationTab:this.barrierLocTab&&!p.contains(this.barrierLocTab,"esriCTHidden")?this._currentLastNode=this.barrierLocTab:this.inputLocTab&&!p.contains(this.inputLocTab,
"esriCTHidden")?this._currentLastNode=this.inputLocTab:this._currentLastNode=this.btnClear:this._currentLastNode=this.projectSaveButton:this._currentLastNode=this.exportToCsvMainScreenButton},_setFirstLastNodeOnFlagListScreen:function(){var a=this.inputBackClick;this._setWidgetFirstFocusNode(a);aa.focus(a);!this.exportToCsvMainScreenButton||p.contains(this.exportToCsvMainScreenButton,"jimu-state-disabled")||p.contains(this.exportButtonContainer,"esriCTHidden")?!this.projectSaveButton||p.contains(this.projectSaveButton,
"jimu-state-disabled")||p.contains(this.saveButtonContainer,"esriCTHidden")?(a=y(".esriCTFlagsBarriersSkipLocationsMainDiv",this.flagLocContent))&&0<a.length&&(this._currentLastNode=a[a.length-1]):this._currentLastNode=this.projectSaveButton:this._currentLastNode=this.exportToCsvMainScreenButton},_setFirstLastNodeOnBarrierListScreen:function(){var a=this.barrierBackClick;this._setWidgetFirstFocusNode(a);aa.focus(a);!this.exportToCsvMainScreenButton||p.contains(this.exportToCsvMainScreenButton,"jimu-state-disabled")||
p.contains(this.exportButtonContainer,"esriCTHidden")?!this.projectSaveButton||p.contains(this.projectSaveButton,"jimu-state-disabled")||p.contains(this.saveButtonContainer,"esriCTHidden")?(a=y(".esriCTFlagsBarriersSkipLocationsMainDiv",this.barrierLocContent))&&0<a.length&&(this._currentLastNode=a[a.length-1]):this._currentLastNode=this.projectSaveButton:this._currentLastNode=this.exportToCsvMainScreenButton},_setFirstLastNodeOnSkipListScreen:function(){var a=this.skipLocationBackClick;this._setWidgetFirstFocusNode(a);
aa.focus(a);!this.exportToCsvMainScreenButton||p.contains(this.exportToCsvMainScreenButton,"jimu-state-disabled")||p.contains(this.exportButtonContainer,"esriCTHidden")?!this.projectSaveButton||p.contains(this.projectSaveButton,"jimu-state-disabled")||p.contains(this.saveButtonContainer,"esriCTHidden")?(a=y(".esriCTFlagsBarriersSkipLocationsMainDiv",this.skipLocationsListContainer))&&0<a.length&&(this._currentLastNode=a[a.length-1]):this._currentLastNode=this.projectSaveButton:this._currentLastNode=
this.exportToCsvMainScreenButton},_setFirstLastNodeOnExportToCSVParamList:function(){this._setWidgetFirstFocusNode(this.exportBackNode);if(this.exportToCsvFileMainButton&&!p.contains(this.exportToCsvFileMainButton,"jimu-state-disabled"))this._currentLastNode=this.exportToCsvFileMainButton;else{var a=y(".jimu-checkbox",this.exportToCSVFormContainer);this._currentLastNode=a[a.length-1]}},_setFirstLastNodeOnOutputScreen:function(){var a=y(".esriCTLayerNameContainer",this.resultsLayerNamesContainer);
var b=this._isWidgetLoadedInProjectMode?this._loadProjectDropdown.focusNode:p.contains(this.resultLayersInformationContainer,"esriCTHidden")?0<a.length&&!p.contains(this.resultsLayerNamesContainer,"esriCTHidden")?a[0]:this.supports508Node:this.resultLayersInformationContainer;this._setWidgetFirstFocusNode(b);p.contains(this.resultLayersInformationContainer,"esriCTHidden")?aa.focus(a[0]):aa.focus(this.resultLayersInformationContainer);!this.exportToCsvMainScreenButton||p.contains(this.exportToCsvMainScreenButton,
"jimu-state-disabled")||p.contains(this.exportButtonContainer,"esriCTHidden")?!this.projectSaveButton||p.contains(this.projectSaveButton,"jimu-state-disabled")||p.contains(this.saveButtonContainer,"esriCTHidden")?0<a.length&&!p.contains(this.resultsLayerNamesContainer,"esriCTHidden")?this._currentLastNode=a[a.length-1]:this._currentLastNode=this.supports508Node:this._currentLastNode=this.projectSaveButton:this._currentLastNode=this.exportToCsvMainScreenButton},_setFirstLastNodeOnOutputResultScreen:function(a){var b=
y(".esriCTResultContainerBack",a)[0];this._setWidgetFirstFocusNode(b);aa.focus(b);(a=y(".resultItemSubDiv",a))&&0<a.length&&(this._currentLastNode=a[a.length-1])},_displayFlagsList:function(){this._hideMainScreen();p.remove(this.inputLocDiv,"esriCTHidden");this._setFirstLastNodeOnFlagListScreen()},_hideFlagsList:function(a){p.add(this.inputLocDiv,"esriCTHidden");a&&this._displayMainScreen()},_displayBarrierList:function(){this._hideMainScreen();p.remove(this.barrierLocDiv,"esriCTHidden");this._setFirstLastNodeOnBarrierListScreen()},
_hideBarrierList:function(a){p.add(this.barrierLocDiv,"esriCTHidden");a&&this._displayMainScreen()},_displaySkipLocationList:function(){this._hideMainScreen();p.remove(this.skipLocDiv,"esriCTHidden");this._setFirstLastNodeOnSkipListScreen()},_hideSkipLocationList:function(a){p.add(this.skipLocDiv,"esriCTHidden");a&&this._displayMainScreen()},_displayEntireMainScreen:function(){this._displayMainScreen();p.remove(this.saveAndExportParentContainer,"esriCTHidden");this._setProjectDropdownNameWidth()},
_hideEntireMainScreen:function(){this._hideMainScreen();p.add(this.saveAndExportParentContainer,"esriCTHidden")},_displayMainScreen:function(){this._isWidgetLoadedInProjectMode&&p.remove(this.loadProjectParentContainer,"esriCTHidden");p.remove(this.inputOutputTabParentContainer,"esriCTHidden");p.remove(this.saveAndExportParentContainer,"esriCTHidden");this._tabContainer&&(this._tabContainer.viewStack.getSelectedLabel()===this.nls.inputTabTitle?this._setFirstLastNodeOnMainScreen():this._setFirstLastNodeOnOutputScreen())},
_hideMainScreen:function(){p.add(this.loadProjectParentContainer,"esriCTHidden");p.add(this.inputOutputTabParentContainer,"esriCTHidden")},_displayOutputPanel:function(){this._reloadCurrentProjectOnClear||this._tabContainer.selectTab(this.nls.outputTabTitle);this._reloadCurrentProjectOnClear=!1;p.remove(this.outputTab,"esriCTHidden");p.remove(this.resultsLayerNamesContainer,"esriCTHidden");if("TabTheme"===this.appConfig.theme.name){var a={};a.node=this.outputTab;a.resetHeightOutputPanel=!0;this._resetHeight(a)}this._setFirstLastNodeOnOutputScreen()},
_hideOutputPanel:function(){this._tabContainer&&this._tabContainer.selectTab(this.nls.inputTabTitle);p.add(this.outputTab,"esriCTHidden");p.add(this.resultsLayerNamesContainer,"esriCTHidden")},_displayOutputFeatureList:function(a){this._hideMainScreen();p.remove(this.layerFeaturesContainer,"esriCTHidden");p.remove(a,"esriCTHidden");this._setFirstLastNodeOnOutputResultScreen(a)},_hideOutputFeatureList:function(a){p.add(a,"esriCTHidden");p.add(this.layerFeaturesContainer,"esriCTHidden");this._displayMainScreen()},
_disableProjectSaveButton:function(){p.contains(this.inputLocTab,"esriCTHidden")&&p.contains(this.barrierLocTab,"esriCTHidden")&&p.contains(this.skipLocationTab,"esriCTHidden")&&(p.add(this.projectSaveButton,"jimu-state-disabled"),g.set(this.projectSaveButton,"tabindex",-1))},_enableProjectSaveButton:function(){p.remove(this.projectSaveButton,"jimu-state-disabled");g.set(this.projectSaveButton,"tabindex",0)},_hideAllOutputResultContainer:function(){var a=y(".esriCTResultContainer",this.layerFeaturesContainer);
q.forEach(a,e.hitch(this,function(b){p.add(b,"esriCTHidden")}))},onNormalize:function(){setTimeout(e.hitch(this,function(){this._addMobileStyles()}),10)},onMinimize:function(){setTimeout(e.hitch(this,function(){this._removeMobileStyles()}),10)},onMaximize:function(){setTimeout(e.hitch(this,function(){this._removeMobileStyles()}),10)},_addMobileStyles:function(){window.appInfo.isRunInMobile&&"normal"===this.windowState&&(p.add(this.inputTabPanel,"esriCTInputParentMainContainerMobileMode"),p.add(this.flagBarrierSkipLocationMainPageContainer,
"esriCTFlagBarrierSkipLocationMainPageMobileMode"),this._resetInputOutputTabParentContainer())},_removeMobileStyles:function(){window.appInfo.isRunInMobile||p.remove(this.flagBarrierSkipLocationMainPageContainer,"esriCTFlagBarrierSkipLocationMainPageMobileMode");p.remove(this.inputTabPanel,"esriCTInputParentMainContainerMobileMode");window.appInfo.isRunInMobile&&this._resetInputOutputTabParentContainer()},_getLayerNameObject:function(a){return(a=y("div[layernamedetails\x3d'"+(a.paramName+this.id)+
"']",this.resultsLayerNamesContainer))&&0<a.length?a[0]:null},_getResultContainerLabelObject:function(a){return(a=y("div[resultcontainerlabel\x3d'"+(a.paramName+this.id)+"']",this.layerFeaturesContainer))&&0<a.length?a[0]:null},_getResultContainerDataObject:function(a){return(a=y("div[resultcontainerdata\x3d'"+(a+this.id)+"']",this.layerFeaturesContainer))&&0<a.length?a[0]:null},_getResultContainerObject:function(a){return(a=y("div[resultcontainer\x3d'"+(a+this.id)+"']",this.layerFeaturesContainer))&&
0<a.length?a[0]:null},_addGraphicToLocalLayer:function(){var a,b,d,h;this._clearAttributeInspectorData();this._removeClonedProjectPolygonLayer();this._clearProjectPolygonLayerFromMap();var G=this.map.getLayer(this.config.projectSettings.polygonLayerId);this._clonedProjectPolygonLayerObject=this._cloneProjectPolygonLayer(G);var E=this.own(D(this._clonedProjectPolygonLayerObject,"load",e.hitch(this,function(){E&&E[0]&&E[0].remove();a=this._layerInfosObj.getLayerInfoById(this._clonedProjectPolygonLayerObject.originalLayerId);
a.featureLayer=this._clonedProjectPolygonLayerObject;this._createAttributeInspector();b=a.layerObject.hasOwnProperty("templates")&&0<a.layerObject.templates.length&&a.layerObject.templates[0].hasOwnProperty("prototype")&&a.layerObject.templates[0].prototype.hasOwnProperty("attributes")?a.layerObject.templates[0].prototype.attributes:a.layerObject.hasOwnProperty("types")&&0<a.layerObject.types.length&&a.layerObject.types[0].hasOwnProperty("templates")&&0<a.layerObject.types[0].templates.length&&a.layerObject.types[0].templates[0].hasOwnProperty("prototype")&&
a.layerObject.types[0].templates[0].prototype.hasOwnProperty("attributes")?a.layerObject.types[0].templates[0].prototype.attributes:null;null===this._originalTemplateAttributes||""===this._originalTemplateAttributes||void 0===this._originalTemplateAttributes?(this._originalTemplateAttributes=e.clone(b),this.publishData({networkTraceOriginalTemplateAttributes:this._originalTemplateAttributes})):b=e.clone(this._originalTemplateAttributes);d=new m(null,null,b,null);d.preEditAttrs=JSON.parse(JSON.stringify(d.attributes));
this._clonedProjectPolygonLayerObject.applyEdits([d],null,null,e.hitch(this,function(da){h=new M;h.objectIds=[da[0].objectId];this._clonedProjectPolygonLayerObject.selectFeatures(h,C.SELECTION_NEW,e.hitch(this,function(){this._currentFeatureDetails=d;this._add508SupportToATI();this._showLoadingIcon(!1)}),e.hitch(this,function(){this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.selectingFeatureInClonedLayerError)}))}),e.hitch(this,function(){this._saveAsNewProject=!1;
this._showLoadingIcon(!1);this._errorMessage(this.nls.addingFeatureInClonedLayerError)}))}),e.hitch(this,function(){this._saveAsNewProject=!1;this._showLoadingIcon(!1);this._errorMessage(this.nls.loadingClonedLayerErrorMessage)})))},_removeClonedProjectPolygonLayer:function(){this._clonedProjectPolygonLayerObject&&null!==this._clonedProjectPolygonLayerObject&&(this._clonedProjectPolygonLayerObject.clearSelection(),this._clonedProjectPolygonLayerObject.clear(),this.map.removeLayer(this._clonedProjectPolygonLayerObject),
this._clonedProjectPolygonLayerObject=null)},_clearProjectPolygonLayerFromMap:function(){var a=this.map.getLayer(this.config.projectSettings.polygonLayerId);a&&(a.clearSelection(),a.refresh())},_cloneProjectPolygonLayer:function(a){var b=Y.getFeatureLayerDefinition(a);this._mandateNameField(b);this._filterFields(b);b.id="clonedProjectLayer"+this.id;b.name=a.name+this.id;b={layerDefinition:b};var d=a.fields.map(function(h){return h.name});b=new C(b,{outFields:d});b.visible=!0;b.renderer=a.renderer;
b.originalLayerId=a.id;b._wabProperties={isTemporaryLayer:!0};this.map.addLayer(b);return b},_processLayerFields:function(a){q.forEach(a,function(b){void 0!==b.domain&&null!==b.domain&&void 0!==b.domain.type&&null!==b.domain.type&&"range"===b.domain.type&&!1===b.domain.hasOwnProperty("range")&&(b.domain.range=[b.domain.minValue,b.domain.maxValue])});return a},_createAttributeInspector:function(){var a=this._createFieldInfos();f.empty(this.attributeInspectorContainer);this._attributeInspector=new (P([c],
{constructor:function(){this._aiConnects=[];this._selection=[];this._toolTips=[]}}))({layerInfos:[{featureLayer:this._clonedProjectPolygonLayerObject,fieldInfos:a}]},f.create("div",{"class":"esriCTAttributeInspectorWidgetContainer"}));this.own(D(this._attributeInspector,"attribute-change",e.hitch(this,function(b){this._currentFeatureDetails&&(this._currentFeatureDetails.attributes[b.fieldName]=b.fieldValue)})));this._attributeInspector.startup();this.attributeInspectorContainer.appendChild(this._attributeInspector.domNode)},
_displayAttributeInspector:function(){this._hideEntireMainScreen();this._hideFlagsList(!1);this._hideBarrierList(!1);this._hideSkipLocationList(!1);p.remove(this.editAttributeContainer,"esriCTHidden")},_getProjectNameTextBox:function(){var a,b;this._attributeInspector&&this._attributeInspector.domNode&&(a=y("td[data-fieldname\x3d'"+this._polygonLayerFields.name+"']",this._attributeInspector.domNode))&&a[0]&&a[0].parentNode&&(a=a[0].parentNode,a.childNodes&&a.childNodes[1]&&a.childNodes[1].childNodes&&
a.childNodes[1].childNodes[0]&&(a=a.childNodes[1].childNodes[0],(a=g.get(a,"widgetid"))&&(b=dijit.byId(a))));return b},_clearSelectionOnBackBtnClk:function(){var a;this.animatedLayer.clear();(a=y(".esriCTHighlightedGraphic",this._widgetTopNode))&&0<a.length&&p.remove(a[0],"esriCTHighlightedGraphic")},_getZoomToText:function(a,b){var d=e.clone(a.displayText);b=e.clone(b.attributes);a={};for(var h in b)b.hasOwnProperty(h)&&(a[h.toLowerCase()]=b[h]);h=d.match(/({.*?})/ig);q.forEach(h,e.hitch(this,function(G){d=
d.replace(G,G.toLowerCase())}));d=e.replace(d,a);return d=d.replace(/undefined/gi,null)},onReceiveData:function(a,b,d,h){d.hasOwnProperty("networkTraceOriginalTemplateAttributes")&&(this._originalTemplateAttributes=d.networkTraceOriginalTemplateAttributes)},_loadWidgetInProjectMode:function(){this._showLoadingIcon(!0);this.config.projectSettings&&this.config.projectSettings.polygonLayerId&&this.config.projectSettings.pointLayerId&&this.config.projectSettings.outputParamName?this._layerInfosObj.getLayerInfoById(this.config.projectSettings.polygonLayerId)&&
this._layerInfosObj.getLayerInfoById(this.config.projectSettings.pointLayerId)?(p.remove(this.loadProjectParentContainer,"esriCTHidden"),this._isWidgetLoadedInProjectMode=!0,this._setFirstLastNodeOnMainScreen(),this._displaySaveAndExportButton(),this._resetInputOutputTabParentContainer(),this._loadProject()):(this._displaySaveAndExportButton(),this._resetInputOutputTabParentContainer(),this._fetchUrlParameters(),this._errorMessage(this.nls.projectLayersNotFound)):(this._displaySaveAndExportButton(),
this._resetInputOutputTabParentContainer(),this._fetchUrlParameters());this._showLoadingIcon(!1)},_filterFields:function(a){var b=this._createFieldInfos(),d=[];q.forEach(b,e.hitch(this,function(h){q.forEach(a.fields,e.hitch(this,function(G){G.hasOwnProperty("name")&&h.hasOwnProperty("fieldName")&&G.name===h.fieldName&&d.push(G)}))}));a.fields=d},_mandateNameField:function(a){q.forEach(a.fields,e.hitch(this,function(b,d){b.name===this._polygonLayerFields.name&&(a.fields[d].nullable=!1)}));return a},
onDeActive:function(){this._disableFlagTool();this._disableBarrierTool();this._disconnectAllAttributeInspectorEvents();this._loadProjectDropdown.set("disabled",!0)},_disableFlagTool:function(){this.enableWebMapPopup();this.flagBtnClicked=!1;p.remove(this.btnFlag,"flagButtonselected");p.add(this.btnFlag,"flagbutton");g.set(this.btnFlag,"aria-pressed","false");null!==this.toolbar&&(this.toolbar.deactivate(),this.toolbar=null)},_disableBarrierTool:function(){this.enableWebMapPopup();this.barrierBtnClicked=
!1;p.remove(this.btnBarrier,"barrierButtonselected");p.add(this.btnBarrier,"barrierButton");g.set(this.btnBarrier,"aria-pressed","false");null!==this.toolbar&&(this.toolbar.deactivate(),this.toolbar=null)},_disconnectAllAttributeInspectorEvents:function(){this._attributeInspector&&this._attributeInspector._aiConnects&&q.forEach(this._attributeInspector._aiConnects,e.hitch(this,function(a){a.remove()}))},_addDefaultOptionInDropdown:function(){this._loadProjectDropdown.addOption({value:"newproject",
label:this.nls.newProjectOptionText})},onActive:function(){this._showLoadingIcon(!0);var a=this.map.getLayer(this.config.projectSettings.polygonLayerId);a?this._isWidgetStartup?(this._isWidgetStartup=!1,a=a.getDefinitionExpression(),this._lastDefinitionExpression!==a?this._refreshProjectNames():(this._loadProjectDropdown.set("disabled",!1),this._showLoadingIcon(!1))):this._refreshProjectNames():(this._loadProjectDropdown.set("disabled",!1),this._showLoadingIcon(!1))},_pauseAllClickEvents:function(){q.forEach(this._clickEventHandlerArr,
e.hitch(this,function(a){0<a.length&&a[0].pause()}))},_resumeAllClickEvents:function(){q.forEach(this._clickEventHandlerArr,e.hitch(this,function(a){0<a.length&&a[0].resume()}))},_fetchLastDefinitionExpression:function(){var a=this.map.getLayer(this.config.projectSettings.polygonLayerId);a&&(this._lastDefinitionExpression=a.getDefinitionExpression())},_refreshProjectNames:function(){this._pauseAllClickEvents();var a=this._loadProjectDropdown.getValue();this._loadProjectDropdown.closeDropDown();this._loadProjectDropdown.set("disabled",
!0);this._loadProjectDropdownEvtHandle.pause();this._loadProjectDropdown.removeOption(this._loadProjectDropdown.getOptions());this._addDefaultOptionInDropdown();this._loadProject(!0,a)},unSkipFromTrace:function(a,b){(a=y("[layerid\x3d"+b.id+"][oid\x3d"+a[0].attributes[b.oid]+"]",this.domNode))&&0<a.length&&(a=a[0]);p.contains(a,"alreadySkippedLocation")?(a.click(),this._errorMessage(this.nls.removedFromSkipLocations)):this._errorMessage(this.nls.alreadyRemovedFromSkipLocations)},skipFromTrace:function(a,
b){(a=y("[layerid\x3d"+b.id+"][oid\x3d"+a[0].attributes[b.oid]+"]",this.domNode))&&0<a.length&&(a=a[0]);p.contains(a,"alreadySkippedLocation")?this._errorMessage(this.nls.locationAlreadySkippedMessage):(a.click(),this._errorMessage(this.nls.locationSkipped))},_setProjectDropdownNameWidth:function(){if(""!==this.loadProjectDropdownContainer&&null!==this.loadProjectDropdownContainer&&void 0!==this.loadProjectDropdownContainer){var a=L.getComputedStyle(this.loadProjectDropdownContainer);if(""!==a&&null!==
a&&void 0!==a){a=parseFloat(a.width);a-=56;var b=y(".dijitSelectLabel",this.loadProjectDropdownContainer);""!==b&&null!==b&&void 0!==b&&0<b.length&&(L.set(b[0],"width",a+"px"),this._setProjectDropdownTooltip(b[0]))}}},_setProjectDropdownTooltip:function(a){var b=g.get(a,"innerHTML");g.set(a,"title",b)},_setInputTabSummaryText:function(){""!==this.inputTabSummaryTextContainer&&null!==this.inputTabSummaryTextContainer&&void 0!==this.inputTabSummaryTextContainer&&this.config.hasOwnProperty("inputSummaryText")&&
""!==this.config.inputSummaryText&&null!==this.config.inputSummaryText&&void 0!==this.config.inputSummaryText&&(p.add(this.inputTabSummaryTextContainer,"esriCTInputTabSummaryTextContainer"),p.remove(this.inputTabSummaryTextContainer,"esriCTHidden"),g.set(this.inputTabSummaryTextContainer,"innerHTML",this.editorXssFilter.sanitize(this.config.inputSummaryText)),g.set(this.inputTabSummaryTextContainer,"aria-label",Y.stripHTML(this.config.inputSummaryText)))}})});