// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred jimu/BaseFeatureAction jimu/Role jimu/LayerInfos/LayerInfos jimu/WidgetManager".split(" "),function(l,m,h,k,n,p,q,r){return l(n,{map:null,iconClass:"icon-edit",isFeatureSupported:function(a,b){var c=new k,d=b||h.getObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",!1,this.map.infoWindow);if(!d)return c.resolve(!1),c;var e=q.getInstanceSync().getLayerInfoByTopLayerId(d&&d.id);a=new k;e&&(e.isTable||e.isShowInMap())?
a=e.isEditable():a.resolve(!1);a.then(h.hitch(this,function(t){var g=!1,f=this.appConfig.getConfigElementById(this.widgetId).config;f.editor.layerInfos?0===f.editor.layerInfos.length||f.editor.honorSettingOfWebmap?g=!0:m.forEach(f.editor.layerInfos.concat(f.editor.tableInfos||[]),function(u){d.id===u.featureLayer.id&&(g=!0)}):g=!1;g&&e&&e.getUrl()&&t?c.resolve(!0):c.resolve(!1)}));return c},onExecute:function(a,b){var c=b||h.getObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",!1,
this.map.infoWindow);b=new k;r.getInstance().triggerWidgetOpen(this.widgetId).then(function(d){d.beginEditingByFeatures(a.features,c)});return b.promise},_checkEditPrivilege:function(a){var b=!0;a&&(b=new p({id:a.roleId?a.roleId:a.role,role:a.role}),a.privileges&&b.setPrivileges(a.privileges),b=b.canEditFeatures());return b}})});