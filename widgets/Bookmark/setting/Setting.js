// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
/*
 Sortable 1.8.4 - MIT | git://github.com/SortableJS/Sortable.git */
require({cache:{"widgets/Bookmark/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojox/html/entities jimu/utils ./ItemNode libs/storejs/store jimu/LayerInfos/LayerInfos".split(" "),function(F,B,v,x,u,p,z,C){var y={_uID:0,getUID:function(){return y._uID++},findBookMark:function(m,g){var d=-1,f=null;B.some(g,function(c,w){if(parseInt(c._uID,10)===parseInt(m._uID,10))return d=w,f=c,!0},this);return-1!==d?{bookmark:f,idx:d}:null},findBookMarkByUID:function(m,g){var d=-1,f=
null;B.some(g,function(c,w){if(parseInt(c._uID,10)===parseInt(m,10))return d=w,f=c,!0},this);return-1!==d?{bookmark:f,idx:d}:null},findNextBookMarkByIdx:function(m,g){var d=null;m+1<=g.length-1&&(d=g[m+1]);return d},findBookMarkByNameAndExtent:function(m,g){var d=-1,f=null;B.some(g,function(c,w){if(c.name===m.name&&c.extent&&m.extent&&c.extent.xmax===m.extent.xmax&&c.extent.xmin===m.extent.xmin&&c.extent.ymax===m.extent.ymax&&c.extent.ymin===m.extent.ymin)return d=w,f=c,!0},this);return-1!==d?{bookmark:f,
idx:d}:null},isBookmarksDataEmpty:function(m){return Array.isArray(m)&&0===m.length?!0:!1},empty:function(m,g){var d=m;B.forEach(m,function(f){f&&f.itemNode&&f.itemNode.destroy()},this);m=[];m=d;g&&v.empty(g)},createBookMarkNode:function(m,g,d,f,c){if(m.thumbnail||"undefined"!==typeof m.thumbnail&&""!==m.thumbnail){var w=m.thumbnail;m.thumbnail&&m.thumbnail.url&&(w=m.thumbnail.url);d=u.processUrlInWidgetConfig(w,d)}else d=u.processUrlInWidgetConfig("images/thumbnail_default.png",d);w=y.getUID();m._uID=
w;return new p({dataId:w,img:d,label:m.displayName||m.name,display:f,nls:g,a11y:c})},cloneBookmarksDataWithOutDom:function(m){var g=[];if("undefined"===typeof m)return g;m.forEach(F.hitch(this,function(d){d.itemNode&&d.itemNode.domNode&&(d=F.clone(d),delete d.itemNode,g.push(d))}));return g},readBookmarksInWebmap:function(m){var g=[];if(!m.itemInfo||!m.itemInfo.itemData||!m.itemInfo.itemData.bookmarks)return g;B.forEach(m.itemInfo.itemData.bookmarks,function(d){d=F.mixin({},d);d.isInWebmap=!0;d.name=
x.decode(d.name);g.push(d)},this);return g},filterBookmarkFromTarget:function(m,g){for(var d=[],f=0,c=m.length;f<c;f++){var w=m[f];y.findBookmarkByNameOrExtent(w,g)||d.push(w)}return d},findBookmarkByNameOrExtent:function(m,g){var d=-1,f=null;B.some(g,function(c,w){if((c.displayName||c.name)===(m.displayName||m.name)||c.extent&&m.extent&&c.extent.xmax===m.extent.xmax&&c.extent.xmin===m.extent.xmin&&c.extent.ymax===m.extent.ymax&&c.extent.ymin===m.extent.ymin)return d=w,f=c,!0},this);return-1!==d?
{bookmark:f,idx:d}:null},filter:function(m,g){g.forEach(function(d){"undefined"!==typeof m&&""!==m?-1!==(d.displayName||d.name).indexOf(m)?p.show(d):p.hide(d):p.show(d)})},getKeysKey:function(){return this.appConfig.map["3D"]?this.name+".3D":this.name+".2D"},getAutoRenameBeforeAdd:function(m,g,d){var f=0,c=new RegExp(/\((\d+)\){1}$/g);B.forEach(g,function(w){w&&"undefined"!==typeof w.name&&-1!==w.name.indexOf(m)&&("undefined"===typeof d||!0===d&&m.length===w.name.length)&&(w=c.exec(w.displayName),
null===w&&0===f?f=1:w&&"undefined"!==typeof w[1]&&w[1]>=f&&(f=parseInt(w[1],10)+1))});return 0===f?m:m+"("+f+")"},processDuplicateName:function(m){for(var g=[],d={},f=m.length-1;0<=f;f--){var c=m[f];if(!c||"undefined"===typeof c.name)return;var w=c.name;w in d?d[w]++:d[w]=0;if(0<d[w]){var G=w+"("+d[w]+")";G in d?(d[G]++,d[w]++):d[G]=0;c.displayName=0<d[G]?w+"("+d[w]+")":G;c._autoRename=!0}else c.displayName=w;g.push(c)}m=g},toogleCheckboxChecked:function(m){m&&m.setValue&&m.setValue(!m.checked)},
setCheckboxWithoutEvent:function(m,g){m&&m.check&&m.uncheck&&(!0===g?m.check(!0):m.uncheck(!0))},layerInfosRestoreState:function(m,g){var d=C.getInstanceSync(),f={};if(g&&m){for(var c in g)if(g.hasOwnProperty(c)){m=g[c];var w=!1;w="undefined"===typeof m.visible?m.selected:m.visible;f[c]={visible:w}}d.restoreState({layerOptions:f})}},getlayerInfos:function(){var m={},g=C.getInstanceSync();g&&g.traversal&&g.traversal(F.hitch(this,function(d){m[d.id]={visible:d.isVisible()}}));return m},isWithLayerInfos:function(m){return m.layerOptions&&
!1!==m.isSaveLayers?!0:!1},stringifyBookmarks:function(m){var g=[];B.forEach(m,function(d){d=F.mixin({},d);d.itemNode&&delete d.itemNode;g.push(d)},this);return g},parseBookmarks:function(m){return F.clone(m)},getKey:function(m){return"Bookmark.2D."+encodeURIComponent(u.getAppIdFromUrl())+"."+m},isConfigBefore5_3:function(m){return"undefined"===typeof m.syncMode||!0===m.needToUpdateFlag?!0:!1},getUpdateCacheKey:function(m){return"bookmark_cache_updated_"+encodeURIComponent(y.getKey(m))},setUpdateCacheKey:function(m){z.set(y.getUpdateCacheKey(m),
!0)},isCacheKeyUpdatedy:function(m){return z.get(y.getUpdateCacheKey(m))},setDefaultConfigForUpdate:function(m){m.needToUpdateFlag=!0;m.layout={cards:!0,list:!1,defaultMode:"cards"};m.editable=!0;Array.isArray(m.bookmarks2D)&&0<m.bookmarks2D.length?m.syncMode={webmap:!1,custom:!0}:m.syncMode={webmap:!0,custom:!0}},completeUpdateConfig:function(m){m.needToUpdateFlag&&delete m.needToUpdateFlag},updateBookmarks:function(m){for(var g=0;g<m.length;g++)"undefined"===typeof m[g]&&(m.splice(g,1),g--);var d=
RegExp("/widgets/Bookmark/images/thumbnail_default.png$");B.forEach(m,function(f){"undefined"===typeof f.isSaveExtent&&(f.isSaveExtent=!0);f.thumbnail&&d.test(f.thumbnail)&&delete f.thumbnail},this)},getLayoutRecorderKey:function(){return"bookMarkLayout_"+encodeURIComponent(u.getAppIdFromUrl())},cleanLayoutRecorder:function(m){z.remove(y.getLayoutRecorderKey(m))},setLastLayout:function(m){z.set(y.getLayoutRecorderKey(),m)},getLastLayout:function(){return z.get(y.getLayoutRecorderKey())},oldBookmarksBackup:'[{"displayName":"Greater Manchester or Greater Lincolnshire HAHAHAHA","name":"Greater Manchester or Greater Lincolnshire HAHAHAHA","extent":{"type":"extent","xmin":8997982.70263581,"ymin":2110475.6293307655,"xmax":14672667.682525788,"ymax":6024051.4775307495,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"Peterborough and Cambridgeshire HEHEHEHEHEH","name":"Peterborough and Cambridgeshire HEHEHEHEHEH","extent":{"type":"extent","xmin":9055621.33977054,"ymin":445965.34674161975,"xmax":14730306.319660518,"ymax":4359541.194941604,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"mentougou biejing china","name":"mentougou biejing china","extent":{"type":"extent","xmin":9502343.119353313,"ymin":3151483.465165457,"xmax":15177028.09924329,"ymax":7065059.313365442,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u51e4\u51f0\u7f6e\u5730\u4e09\u5143\u6865\u5317\u4eac\u4e2d\u56fd\u4e16\u754c\u592a\u9633\u7cfb\u5b87\u5b99","name":"\u51e4\u51f0\u7f6e\u5730\u4e09\u5143\u6865\u5317\u4eac\u4e2d\u56fd\u4e16\u754c\u592a\u9633\u7cfb\u5b87\u5b99","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u77ed\u4e2d\u6587","name":"\u77ed\u4e2d\u6587","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"short","name":"short","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u4e2d\u6587 English","name":"\u4e2d\u6587 English","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"Underneath the icons","name":"Underneath the icons","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u4e2d\u6587\u4e2d\u6587 \u5475\u5475","name":"\u4e2d\u6587\u4e2d\u6587 \u5475\u5475","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"eee RTL","name":"eee RTL","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false}]',
_testUpdateOldConfig:function(){return{bookmarks2D:[{extent:{spatialReference:{wkid:102100},xmax:-1656069.6628128502,xmin:-1.0861390956860503E7,ymax:1.510258315961978E7,ymin:-1119447.7364922247},name:"bm1",isInWebmap:!0,displayName:"bm1"},{extent:{spatialReference:{wkid:102100},xmax:-1656069.6628128502,xmin:-1.0861390956860503E7,ymax:1.510258315961978E7,ymin:-1119447.7364922247},name:"bm1",isInWebmap:!0,displayName:"bm1(1)"},{extent:{spatialReference:{wkid:102100},xmax:-3197863.7584074493,xmin:-1.3112899816301128E7,
ymax:1.1466459916526379E7,ymin:-4859686.568575533},name:"bm2",isInWebmap:!0,displayName:"bm2"},{extent:{spatialReference:{wkid:102100},xmax:-3767577.3201611056,xmin:-1.430429896767071E7,ymax:1.5120033300894285E7,ymin:-4622246.062418217},name:"Untitled",isInWebmap:!0,displayName:"Untitled"},{extent:{spatialReference:{wkid:102100},xmax:-4334684.982862408,xmin:-1.6556089386187213E7,ymax:1.6750523655935397E7,ymin:-5666212.383958025},name:"Untitled",isInWebmap:!0,displayName:"Untitled(1)"}],bookmarks3D:[],
flyTime:3E3}},_testSetOldCache:function(m){var g=[];B.forEach(m,function(d){var f="Bookmark.2D."+d.displayName;g.push(f);d=F.mixin({},d);d.itemNode&&delete d.itemNode;d._uID&&delete d._uID;try{z.set(f,d)}catch(c){alert("store error\x3d\x3d\x3e")}},this);z.set("Bookmark.2D",g)},_testSetOldCacheBookmark:function(){return JSON.parse('[{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-8273877.24778316,"xmin":-14295892.084200885,"ymax":6466269.8495007465,"ymin":2983187.344602761},"name":"bm1","isInWebmap":true,"displayName":"bm1"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-8004818.908219411,"xmin":-11015826.326428276,"ymax":5527011.645932751,"ymin":3785470.393483758},"name":"bm1","isInWebmap":true,"displayName":"bm1(1)"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-12874774.854323175,"xmin":-13627526.708875552,"ymax":4655629.523482032,"ymin":4220244.210369689},"name":"bm2","isInWebmap":true,"displayName":"bm2"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-11618761.605541585,"xmin":-14629769.023750449,"ymax":6691911.956998556,"ymin":4950370.704549563},"name":"bm3","isInWebmap":true,"displayName":"bm3"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-4317189.3003047705,"xmin":-16361218.973140221,"ymax":10449906.504800193,"ymin":3483741.495004222},"name":"bm4","isInWebmap":true,"displayName":"bm4"},{"name":"add-inRT-1","displayName":"add-inRT-1","extent":{"xmin":-14714155.502977258,"ymin":2694561.125798012,"xmax":-7855613.8290067855,"ymax":6754896.068305495,"spatialReference":{"wkid":102100,"latestWkid":3857}}},{"name":"add-inRT-2","displayName":"add-inRT-2","extent":{"xmin":-14714155.502977258,"ymin":2694561.125798012,"xmax":-7855613.8290067855,"ymax":6754896.068305495,"spatialReference":{"wkid":102100,"latestWkid":3857}}}]')}};
return y})},"widgets/Bookmark/ItemNode":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/a11yclick jimu/BaseWidget dijit/_WidgetsInTemplateMixin ./a11y/ItemNode dojo/on dojo/query jimu/utils dojo/text!./ItemNode.html dojo/mouse dijit/form/ValidationTextBox".split(" "),function(F,B,v,x,u,p,z,C,y,m,g,d){var f={};f=B([p,z,F],{templateString:d,isSelected:!1,postMixInProperties:function(){this.nls=v.mixin(this.nls,window.jimuNls.common)},postCreate:function(){x.setAttr(this.domNode,
"data-id",g.sanitizeHTML(this.dataId));this.img&&x.setAttr(this.thumbnail,"src",this.img);this.nls&&(x.setAttr(this.deleteBtn,"title",this.nls.deleteBtnTip),x.setAttr(this.editBtn,"title",this.nls.editBtnTip),x.setAttr(this.changeImgBtn,"title",this.nls.changeThumbnailTip),x.setAttr(this.renameBtn,"title",this.nls.editBtnTip),x.setAttr(this.thumbnail,"title",this.nls.dragReorderTip),x.setAttr(this.layerInfosIcon,"title",this.nls.withVisibility));this.display&&(!1===this.display.selectedBtn&&x.addClass(this.selectedBtn,
"hide"),!1===this.display.editBtn&&x.addClass(this.editBtn,"hide"),!1===this.display.deleteBtn&&x.addClass(this.deleteBtn,"hide"),!1===this.display.renameBtn&&x.addClass(this.renameBtn,"hide"),!0===this.display.selectedBtn&&x.removeClass(this.selectedBtn,"hide"),!0===this.display.changeImgBtn&&x.removeClass(this.changeImgBtn,"hide"),!0===this.display.layerInfosIcon&&(x.removeClass(this.layerInfosIcon,"hide"),x.addClass(this.nodeBox,"with-layer-visibility")));this.a11y_display();this.nodeLabel.setValue(this.label);
this._updateLabelTooltips(this.label);this.own(y(this.selectedBtn,u,v.hitch(this,this.onSelected)));this.own(y(this.deleteBtn,u,v.hitch(this,this.onDelete)));this.own(y(this.editBtn,u,v.hitch(this,this.onEdit)));this.own(y(this.changeImgBtn,u,v.hitch(this,this.onChangeImg)));this.own(y(this.renameBtn,u,v.hitch(this,this.onRenameClick)));this.own(y(this.nodeBox,u,v.hitch(this,this.onNodeBoxClick)));this.own(y(this.dragMasker,"click",v.hitch(this,this.onNodeBoxClick)));!0===this.display.enableEditLabel?
(this.own(y(this.nodeLabel,u,v.hitch(this,this.onLabelClick))),this.own(y(this.nodeLabel,"change",v.hitch(this,this.onLabelChange))),this.own(y(this.nodeLabel,"blur",v.hitch(this,this.onLabelBlur)))):this.nodeLabel.setDisabled(!0);this.own(y(this.nodeLabel,"contextmenu",v.hitch(this,function(c){c.preventDefault()})));this.own(y(this.nodeBox,"contextmenu",v.hitch(this,function(c){c.preventDefault()})));this.a11y_initEvents()},onClick:function(){m(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");
m(this.domNode).addClass("jimu-state-selected");this.emit("click")},onNodeBoxClick:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("thumbnail-click")},onLabelClick:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("label-click")},onLabelChange:function(c){this._updateLabelTooltips(c)},onLabelBlur:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());c=
this.nodeLabel.get("value");this._updateLabelTooltips(c);this.emit("label-blur")},onSelected:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());x.hasClass(this.domNode,"selected")?(x.removeClass(this.domNode,"selected"),this.isSelected=!1,!1!==c&&this.emit("unselected")):(x.addClass(this.domNode,"selected"),this.isSelected=!0,!1!==c&&this.emit("selected"))},onDelete:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());
this.emit("delete")},onEdit:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("edit")},onChangeImg:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("change-img")},changeImg:function(c){x.setAttr(this.thumbnail,"src",c)},onRenameClick:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("rename")},highLight:function(){m(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");
m(this.domNode).addClass("jimu-state-selected")},startup:function(){this.inherited(arguments)},destroy:function(){this.inherited(arguments);x.destroy(this.domNode)},_updateLabelTooltips:function(c){c&&(x.setAttr(this.nodeLabel,"title",c),this.dragMasker&&x.setAttr(this.dragMasker,"title",c),this.a11y_updateItemLabel(c))}});f.addFloatLeading=function(c){c.itemNode&&c.itemNode.domNode&&(m(".selected-btn",c.itemNode.domNode).forEach(function(w){x.addClass(w,"jimu-float-leading")}),m(".node-box",c.itemNode.domNode).forEach(function(w){x.addClass(w,
"jimu-float-leading")}),m(".node-label",c.itemNode.domNode).forEach(function(w){x.addClass(w,"jimu-float-leading")}),m(".close-btn",c.itemNode.domNode).forEach(function(w){x.addClass(w,"jimu-float-leading")}))};f.removeFloatLeading=function(c){c.itemNode&&c.itemNode.domNode&&(m(".selected-btn",c.itemNode.domNode).forEach(function(w){x.removeClass(w,"jimu-float-leading")}),m(".node-box",c.itemNode.domNode).forEach(function(w){x.removeClass(w,"jimu-float-leading")}),m(".node-label",c.itemNode.domNode).forEach(function(w){x.removeClass(w,
"jimu-float-leading")}),m(".close-btn",c.itemNode.domNode).forEach(function(w){x.removeClass(w,"jimu-float-leading")}))};f.toggleEditable=function(c){c.itemNode&&c.itemNode.nodeLabel&&(c.itemNode.nodeLabel.disabled?f.enableEditable(c):f.disableEditable(c))};f.disableEditable=function(){};f.enableEditable=function(){};f.focusLabel=function(c){c.itemNode&&c.itemNode.nodeLabel&&(c.itemNode.nodeLabel.focus(),c.itemNode.domNode&&x.addClass(c.itemNode.domNode,"a11y_hover"))};f.focusItem=function(c){c&&
c.itemNode&&c.itemNode.domNode&&c.itemNode.domNode.focus()};f.unSelected=function(c){c.itemNode&&c.itemNode&&(c=c.itemNode,x.removeClass(c.domNode,"selected"),c.isSelected=!1)};f.show=function(c){c&&c.itemNode&&(c=c.itemNode,x.removeClass(c.domNode,"hide"),c.isShow=!0)};f.hide=function(c){c&&c.itemNode&&(c=c.itemNode,x.addClass(c.domNode,"hide"),c.isShow=!1)};f.extend(C);return f})},"widgets/Bookmark/a11y/ItemNode":function(){define(["dojo/_base/lang","dojo/on","dojo/_base/html","dojo/keys"],function(F,
B,v,x){return{a11y_removeTabindex:function(u){v.removeAttr(u,"tabindex")},a11y_setTabindex:function(u,p){v.setAttr(u,"tabindex",p||0)},a11y_display:function(){this.a11y&&(!1===this.a11y.selectedBtn&&this.a11y_removeTabindex(this.selectedBtn),!1===this.a11y.editBtn&&this.a11y_removeTabindex(this.editBtn),!1===this.a11y.deleteBtn&&this.a11y_removeTabindex(this.deleteBtn),!1===this.a11y.renameBtn&&this.a11y_removeTabindex(this.renameBtn),!1===this.a11y.changeImgBtn&&this.a11y_removeTabindex(this.changeImgBtn))},
a11y_updateItemLabel:function(u){v.setAttr(this.domNode,"aria-label",u)},a11y_initEvents:function(){this.own(B(this.domNode,"keydown",F.hitch(this,function(u){var p=v.hasClass(u.target,"jimu-img-node");if(u.keyCode===x.ENTER&&p)this.onNodeBoxClick();this.a11y_checkFocus()})));this.own(B(this.domNode,"mouseout",F.hitch(this,function(){v.removeClass(this.domNode,"a11y_hover")})));this.own(B(this.domNode,"focus",F.hitch(this,function(){v.addClass(this.domNode,"a11y_hover")})))},a11y_focusToLabel:function(u){setTimeout(function(){u.focus()},
0)},a11y_focusToBtns:function(u){setTimeout(function(){u.focus()},0)},a11y_checkFocus:function(){setTimeout(F.hitch(this,function(){v.isDescendant(document.activeElement,this.domNode)||v.removeClass(this.domNode,"a11y_hover")}),50)}}})},"widgets/Bookmark/setting/Layout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/on dojo/text!./Layout.html ../utils".split(" "),function(F,B,v,x,u,p,z,C){return F([x,u],{templateString:z,
startup:function(){this.own(p(this.layoutCards_checkBox,"change",B.hitch(this,function(){this._fixLayoutModeByCheckBoxChanged("cards");this._keepLayoutSelected(this.layoutCards_checkBox)})));this.own(p(this.layoutList_checkBox,"change",B.hitch(this,function(){this._fixLayoutModeByCheckBoxChanged("list");this._keepLayoutSelected(this.layoutList_checkBox)})));this.own(p(this.layoutCards,"click",B.hitch(this,function(){C.toogleCheckboxChecked(this.layoutCards_checkBox);this._keepLayoutSelected(this.layoutCards_checkBox)})));
this.own(p(this.layoutList,"click",B.hitch(this,function(){C.toogleCheckboxChecked(this.layoutList_checkBox);this._keepLayoutSelected(this.layoutList_checkBox)})));this.own(p(this.layoutCards,"mouseover",B.hitch(this,function(){this._isCardAndListChecked()&&v.removeClass(this.cardsDefaultSetting,"transparent")})));this.own(p(this.layoutCards,"mouseout",B.hitch(this,function(){"list"===this.config.layout.defaultMode&&v.addClass(this.cardsDefaultSetting,"transparent")})));this.own(p(this.layoutList,
"mouseover",B.hitch(this,function(){this._isCardAndListChecked()&&v.removeClass(this.listDefaultSetting,"transparent")})));this.own(p(this.layoutList,"mouseout",B.hitch(this,function(){"cards"===this.config.layout.defaultMode&&v.addClass(this.listDefaultSetting,"transparent")})));this.own(p(this.cardsDefaultSetting,"click",B.hitch(this,function(y){y&&y.stopPropagation&&y.preventDefault&&(y.stopPropagation(),y.preventDefault());this._whetherToggleDefaultLayout("cards")&&(this.config.layout.defaultMode=
"cards",this._setDefault("cards"))})));this.own(p(this.listDefaultSetting,"click",B.hitch(this,function(y){y&&y.stopPropagation&&y.preventDefault&&(y.stopPropagation(),y.preventDefault());this._whetherToggleDefaultLayout("list")&&(this.config.layout.defaultMode="list",this._setDefault("list"))})));this.inherited(arguments)},setConfig:function(y){this.config.layout=y.layout;this.config.layout&&(!0===this.config.layout.cards&&this.layoutCards_checkBox.setValue(!0),!0===this.config.layout.list&&this.layoutList_checkBox.setValue(!0));
this._setDefault(this.config.layout.defaultMode)},getConfig:function(){this.config.layout.cards=!0===this.layoutCards_checkBox.checked?!0:!1;this.config.layout.list=!0===this.layoutList_checkBox.checked?!0:!1;return this.config.layout},_keepLayoutSelected:function(y){!1===this.layoutCards_checkBox.checked&&!1===this.layoutList_checkBox.checked&&C.toogleCheckboxChecked(y)},_setDefault:function(y){var m="";m="cards"===y?"list":"cards";v.removeClass(this[y+"DefaultSetting"],"transparent");var g=this[y+
"_makeAsDefault"];g&&v.addClass(g,"hide");(g=this[y+"_default"])&&v.removeClass(g,"hide");v.addClass(this[m+"DefaultSetting"],"transparent");(g=this[m+"_makeAsDefault"])&&v.removeClass(g,"hide");(g=this[m+"_default"])&&v.addClass(g,"hide");this._isCardAndListChecked()||(v.addClass(this[y+"DefaultSetting"],"transparent"),v.addClass(this[m+"DefaultSetting"],"transparent"))},_whetherToggleDefaultLayout:function(y){var m="cards"===y?this.layoutCards_checkBox:this.layoutList_checkBox;return("cards"===
y?"list":"cards")===this.config.layout.defaultMode&&!0===m.checked?!0:!1},_fixLayoutModeByCheckBoxChanged:function(y){this._isCardAndListChecked()?"list"===this.config.layout.defaultMode?v.removeClass(this.listDefaultSetting,"transparent"):v.removeClass(this.cardsDefaultSetting,"transparent"):(v.addClass(this.listDefaultSetting,"transparent"),v.addClass(this.cardsDefaultSetting,"transparent"));"cards"===y?!1===this.layoutCards_checkBox.checked&&!0===this.layoutList_checkBox.checked&&"cards"===this.config.layout.defaultMode&&
(this.config.layout.defaultMode="list",this._setDefault("list")):!1===this.layoutList_checkBox.checked&&!0===this.layoutCards_checkBox.checked&&"list"===this.config.layout.defaultMode&&(this.config.layout.defaultMode="cards",this._setDefault("cards"))},_isCardAndListChecked:function(){return!0===this.layoutCards_checkBox.getValue()&&!0===this.layoutList_checkBox.getValue()?!0:!1}})})},"widgets/Bookmark/setting/Sync":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/keys jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/on dojo/_base/html jimu/dijit/Popup jimu/dijit/Message ./Edit ./Import dojo/text!./Sync.html ../utils jimu/dijit/CheckBox libs/Sortable".split(" "),
function(F,B,v,x,u,p,z,C,y,m,g,d,f,c,w,G){return F([u,p],{templateString:f,map:null,edit:null,popup:null,popupState:"",editIndex:null,startup:function(){this.webMapBookmarksNodes=G.create(this.webMapBookMarkerContainer,{sort:!1,disabled:!0,animation:100});this.sortableBookMarkerNodes=G.create(this.custombookMarkerContainer,{handle:".drag-masker",sort:!0,disabled:!1,animation:100,onSort:B.hitch(this,function(){this.saveBookMarkersBySortable()})});this.isSyncWebmapCheckBox=new w({label:this.nls.alwaysSync,
checked:!1},this.isSyncWebmapNode);this.isSyncWebmapCheckBox.startup();this.isSyncCustomCheckBox=new w({label:this.nls.configCustom,checked:!1},this.isSyncCustomNode);this.isSyncCustomCheckBox.startup();this.own(z(this.isSyncWebmapCheckBox,"change",B.hitch(this,function(){!0===this.isSyncWebmapCheckBox.getValue()?this.showWebmapBookmarks():this.hideWebmapBookmarks()})));this.own(z(this.isSyncCustomCheckBox,"change",B.hitch(this,function(){!0===this.isSyncCustomCheckBox.getValue()?this.showCustomBookmarks():
this.hideCustomBookmarks()})));this.own(z(this.createNewBtn,"click",B.hitch(this,function(){this.onAddBookmarkClick()})));this.hideWebmapBookmarks();this.hideCustomBookmarks();this.inherited(arguments)},showWebmapBookmarks:function(){C.removeClass(this.webMapBookMarkerContainer,"hide");c.empty(this._bookmarksInWebmap);this._bookmarksInWebmap=c.readBookmarksInWebmap(this.map);this._bookmarksInWebmap=this.displayBookmarks({bookmarks:this._bookmarksInWebmap,syncMode:"webmap",bookmarksContainerNode:this.webMapBookMarkerContainer})},
hideWebmapBookmarks:function(){C.addClass(this.webMapBookMarkerContainer,"hide")},showCustomBookmarks:function(){C.removeClass(this.customBtns,"hide");C.removeClass(this.custombookMarkerContainer,"hide");"undefined"===typeof this._customBookmarks&&(c.empty(this._customBookmarks),this._customBookmarks=this.config.bookmarks2D,this._customBookmarks=this.displayBookmarks({bookmarks:this._customBookmarks,syncMode:"custom",bookmarksContainerNode:this.custombookMarkerContainer}))},hideCustomBookmarks:function(){C.addClass(this.customBtns,
"hide");C.addClass(this.custombookMarkerContainer,"hide")},destroy:function(){this.webMapBookmarksNodes&&this.webMapBookmarksNodes.destroy&&(this.webMapBookmarksNodes.destroy(),this.webMapBookmarksNodes=null);this.sortableBookMarkerNodes&&(this.sortableBookMarkerNodes.destroy(),this.sortableBookMarkerNodes=null);v.forEach(this._bookmarksInWebmap,function(L){L.itemNode&&L.itemNode.destroy()},this);this._bookmarksInWebmap=[];v.forEach(this._customBookmarks,function(L){L.itemNode&&L.itemNode.destroy()},
this);this._customBookmarks=[];this.inherited(arguments)},setConfig:function(L){this.config=L;!0===this.config.syncMode.webmap&&this.isSyncWebmapCheckBox.setValue(!0);!0===this.config.syncMode.custom&&this.isSyncCustomCheckBox.setValue(!0)},getConfig:function(){!0===this.isSyncWebmapCheckBox.getValue()?this.config.syncMode.webmap=!0:this.config.syncMode.webmap=!1;!0===this.isSyncCustomCheckBox.getValue()?this.config.syncMode.custom=!0:this.config.syncMode.custom=!1;var L=[];L=L.concat(this._customBookmarks);
return{syncMode:this.config.syncMode,bookmarks:L}},displayBookmarks:function(L){var A=L.bookmarks,O=L.syncMode,D=L.bookmarksContainerNode||this.custombookMarkerContainer;c.empty(A);var I={};I="webmap"===O?{editBtn:!1,selectedBtn:!1,deleteBtn:!1,renameBtn:!1}:{editBtn:!0,selectedBtn:!1,deleteBtn:!0,renameBtn:!1};v.forEach(A,function(M){if(M){I.layerInfosIcon=c.isWithLayerInfos(M);var T=c.createBookMarkNode(M,this.nls,this.folderUrl,I);M.itemNode=T;this.own(z(T,"thumbnail-click",B.hitch(this,B.partial(this._onBookmarkClick,
M))));this.own(z(T,"delete",B.hitch(this,B.partial(this._onBookmarkDeleteImmediately,M))));this.own(z(T,"edit",B.hitch(this,B.partial(this._onBookmarkEdit,M))))}},this);A.forEach(B.hitch(this,function(M){M&&M.itemNode&&M.itemNode.domNode&&C.place(M.itemNode.domNode,D,"last")}));return A},saveBookMarkersBySortable:function(){for(var L=this.sortableBookMarkerNodes.toArray(),A=[],O=0,D=L.length;O<D;O++){var I=c.findBookMarkByUID(L[O],this._customBookmarks);I&&A.push(I.bookmark)}this._customBookmarks=
A;this.displayBookmarks({bookmarks:this._customBookmarks,syncMode:"custom"})},getBookmarkByName:function(L){for(var A=this._customBookmarks.length,O=0;O<A;O++)if(this._customBookmarks[O].displayName===L)return this.editIndex=O,this._customBookmarks[O]},onAddBookmarkClick:function(){this.popupState="ADD";this._openEdit(this.nls.addBookmark,{name:"",thumbnail:"",extent:this.map.extent.toJson()})},_onBookmarkEdit:function(L){this.popupState="EDIT";this._openEdit(this.nls.edit,L)},_onBookmarkDeleteImmediately:function(L){(L=
c.findBookMark(L,this._customBookmarks))&&L.bookmark&&(L.bookmark.itemNode&&L.bookmark.itemNode.destroy(),this._customBookmarks.splice(L.idx,1))},_openEdit:function(L,A){this.edit=new g({nls:this.nls,folderUrl:this.folderUrl,portalUrl:this.appConfig.map.portalUrl,itemId:this.appConfig.map.itemId,mapOptions:this.appConfig.map.mapOptions});this.edit.setConfig(A||{});this.popup=new y({titleLabel:L,autoHeight:!0,content:this.edit,container:"main-page",width:600,buttons:[{label:this.nls.ok,key:x.ENTER,
disable:!0,onClick:B.hitch(this,"_onEditOk",A)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:x.ESCAPE}],onClose:B.hitch(this,"_onEditClose")});C.addClass(this.popup.domNode,"widget-setting-popup");this.edit.startup()},_onEditOk:function(L){var A=this.edit.getConfig(),O=null;if(A.name&&A.extent){"EDIT"===this.popupState&&(L=B.mixin(L,A));L=A.name;var D=c.getAutoRenameBeforeAdd(L,this._customBookmarks,!0);A.name=L;A.displayName=D;"ADD"===this.popupState?(this.addBookmark(A),O=!0):"EDIT"===
this.popupState&&(this.saveBookMarkersBySortable(),O=!0);O?(this.popup.close(),this.popupState="",this.editIndex=null,O=!1):(A=v.mark(O.repeatFields,B.hitch(this,function(I){return I&&I.name})),new m({message:this.nls[O.errorCode]+A.toString()}))}else new m({message:this.nls.warning})},_onEditClose:function(){this.popup=this.edit=null},addBookmark:function(L){var A=c.createBookMarkNode(L,this.nls,this.folderUrl,{editBtn:!0,changeImgBtn:!1});L.itemNode=A;this._customBookmarks.unshift(L);L.itemNode&&
L.itemNode.domNode&&C.place(L.itemNode.domNode,this.custombookMarkerContainer,"last");this.saveBookMarkersBySortable()},onImport:function(){this.importWidget=new d({nls:this.nls,map:this.map,folderUrl:this.folderUrl});this.popup=new y({titleLabel:this.nls.importTitle,autoHeight:!0,content:this.importWidget,container:"main-page",width:640,buttons:[{label:this.nls.ok,key:x.ENTER,disable:!0,onClick:B.hitch(this,"_onImportOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:x.ESCAPE}],onClose:B.hitch(this,
"_onImportClose")});C.addClass(this.popup.domNode,"widget-setting-popup");this.importWidget.startup()},_onImportOk:function(){var L=this.importWidget.getConfig();v.forEach(L,function(A){this.addBookmark(A)},this);this.popup.close()},_onImportClose:function(){this.importWidget.destroy()}})})},"widgets/Bookmark/setting/Edit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting esri/geometry/Extent jimu/dijit/ImageChooser ./ExtentAndLayersChooser jimu/dijit/LayerChooserFromMapLite jimu/utils ../utils dojo/text!./Edit.html jimu/dijit/CheckBox".split(" "),
function(F,B,v,x,u,p,z,C,y,m,g,d,f,c){return F([p,u],{baseClass:"jimu-Bookmark-Edit",ImageChooser:null,templateString:f,extent:{},portalUrl:null,itemId:null,isInWebmap:!1,mapOptions:null,layerOptions:null,postCreate:function(){this.inherited(arguments);this.imageChooser=new C({cropImage:!0,defaultSelfSrc:this.folderUrl+"images/thumbnail_default.png",showSelfImg:!0,format:[C.GIF,C.JPEG,C.PNG],goldenWidth:100,goldenHeight:60});this.saveLayers=new c({label:this.nls.savelayers,checked:!1},this.saveLayers);
this.own(x(this.saveLayers,"change",B.hitch(this,"_changeSetBtnStyle")));this.own(x(this.displayName,"change",B.hitch(this,"_onNameChange")));this.own(x(this.displayName,"keyUp",B.hitch(this,"_onNameChange")));v.addClass(this.imageChooser.domNode,"img-chooser");v.place(this.imageChooser.domNode,this.imageChooserBase,"replace")},startup:function(){this.displayName&&this.displayName.focusNode&&this.displayName.focusNode.focus&&this.displayName.focusNode.focus();this.inherited(arguments)},_changeSetBtnStyle:function(){this.saveLayers.getValue()?
v.removeClass(this.layerChooserContainer,"hide"):v.addClass(this.layerChooserContainer,"hide")},setConfig:function(w){w.displayName&&this.displayName.set("value",w.displayName);if(w.thumbnail){var G=g.processUrlInWidgetConfig(w.thumbnail,this.folderUrl);this.imageChooser.setDefaultSelfSrc(G)}w.isInWebmap&&(this.isInWebmap=!0);"undefined"===typeof w.isSaveExtent&&(w.isSaveExtent=!0);"undefined"===typeof w.isSaveLayers&&(w.isSaveLayers=!1);d.setCheckboxWithoutEvent(this.saveLayers,w.isSaveLayers);this._changeSetBtnStyle();
w.layerOptions&&(this.layerOptions=w.layerOptions);this.extentChooser||(G={portalUrl:this.portalUrl,itemId:this.itemId},this.config&&this.config.bookmark.extent&&(G.initExtent=new z(w.extent)),this.mapOptions&&this.mapOptions.lods&&(G.lods=this.mapOptions.lods),this.extentChooser=new y(G,this.extentChooserNode),this.extentChooser.createMap().then(B.hitch(this,function(L){this.layersChooser=new m({map:L,layerState:this.layerOptions,layerStateController:m.layerVisibilityStateController},this.layerChooser)})))},
getConfig:function(){var w=this.layersChooser.getState();return{displayName:this.displayName.get("value"),name:this.displayName.get("value"),extent:this.extentChooser.getExtent(),thumbnail:this.imageChooser.imageData,isInWebmap:this.isInWebmap,isSaveLayers:this.saveLayers.getValue(),layerOptions:w}},_onNameChange:function(){this._checkRequiredField()},_onExtentChange:function(w){this.currentExtent=w},_checkRequiredField:function(){this.displayName.get("value")?this.popup&&this.popup.enableButton(0):
this.popup&&this.popup.disableButton(0)}})})},"widgets/Bookmark/setting/ExtentAndLayersChooser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Deferred dijit/_WidgetBase dojo/Evented esri/geometry/Extent jimu/portalUrlUtils esri/dijit/Search jimu/dijit/LoadingShelter jimu/utils".split(" "),function(F,B,v,x,u,p,z,C,y,m,g,d){return F([p,z],{baseClass:"bookmark-extent-chooser",declaredClass:"bookmark.ExtentChooser",portalUrl:null,itemId:null,initExtent:null,bingMapsKey:"",
geometryServiceURL:null,shelter:null,postCreate:function(){this.inherited(arguments);!this.geometryServiceURL&&esriConfig.defaults.geometryService&&(this.geometryServiceURL=esriConfig.defaults.geometryService.url);this.geometryServiceURL||(this.geometryServiceURL=d.getServices().geometryService);this.shelter=new g({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.mapNode=v.create("div",{style:{width:"100%",height:"100%"}},this.domNode);this.search=v.create("div",
{style:{position:"absolute",right:0,top:0}},this.mapNode);this.portalUrl&&this.itemId&&(this.portalUrl=y.getStandardPortalUrl(this.portalUrl))},createMap:function(){var f=new u,c={geometryServiceURL:this.geometryServiceURL,bingMapsKey:this.bingMapsKey};this.initExtent&&("esri.geometry.Extent"!==this.initExtent.declaredClass&&(this.initExtent=new C(this.initExtent)),c.mapOptions={extent:this.initExtent});this.lods&&("object"===typeof c.mapOptions?c.mapOptions.lods=this.lods:c.mapOptions={lods:this.lods});
d.createWebMap(this.portalUrl,this.itemId,this.mapNode,c).then(B.hitch(this,function(w){this.map=w.map;this.map.itemInfo=w.itemInfo;this.own(x(this.map,"extent-change",B.hitch(this,function(G){this.onExtentChange(G.extent)})));w=new m({map:this.map,enableLabel:!1,enableHighlight:!1,enableInfoWindow:!1},this.search);w.startup();this.own(x(w,"search-results",B.hitch(this,function(G){if(G&&G.results&&G.results[0]&&G.results[0][0]&&G.results[0][0].extent)this.onExtentChange(G.results[0][0].extent)})));
if(this.initExtent)this.onExtentChange(this.initExtent);else this.onExtentChange(this.map.extent);this.shelter.hide();this.emit("map-load",this.map);f.resolve(this.map)}),B.hitch(this,function(w){f.resolve(null);console.error(w)}));return f},getExtent:function(){return this.map&&this.map.extent},setExtent:function(f){if(this.map)return this.map.setExtent(f);var c=new u;setTimeout(B.hitch(this,function(){c.reject("map is null.")}),0);return c},restoreToDefaultWebMapExtent:function(){d.restoreToDefaultWebMapExtent(this.map,
this.map.webMapResponse,this.geometryServiceURL)},onExtentChange:function(f){this.emit("extent-change",f)}})})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(F,B,v,x,u,p,z,C,y,m,g,d,f,c,w,G,L,A,O,D,I,M,T,ba,E,ka,U,da,Z,ra,Ma,Ra,Wa,$a,ua,oa,Fa,qa,l,r,S,V,ca,Ga){function ma(a,e){return x.map(x.filter(a.trim().split(" "),function(h){return!!h.trim()}),function(h){return{onFields:e,searchTerm:h,searchType:"prefix"}})}function ya(a,e){a=a&&a.indexes;if(!a||!e||!e.length)return!1;a=x.filter(a,function(h){return"FullText"===h.indexType});return x.some(a,function(h){var k=h.fields&&x.map(h.fields.split(","),function(t){return t.trim().toLowerCase()})||
[];return x.every(e,function(t){return k.includes(t.toLowerCase())})})}function ta(a){return!!(a&&a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsFullTextSearch)}function za(a,e){a&&e&&(a._layer=e,a._sourceLayer=e)}B=B([D,I,M,u],{declaredClass:"esri.dijit.Search",templateString:O,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(a,e){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",
searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",
hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",
searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new S("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),
singleLineFieldName:"SingleLine",outFields:["Addr_type","Match_addr","StAddr","City"],name:A.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:A.widgets.Search.main.placeholder,highlightSymbol:(new Ma(F.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:350,enableSourcesMenu:!0,enableSuggestionsMenu:!0,
enableInfoWindow:!0,showInfoWindowOnSelect:!0,enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new ua).setColor(new ca([181,56,46,.9])).setFont(new oa("14px",oa.STYLE_NORMAL,oa.VARIANT_NORMAL,oa.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new ka(A.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:3,enableSearchingAll:!0};a=v.mixin({},this.options,a);this.set(a);this._updateActiveSource();this._i18n=A;this._defaultSR=new da(4326);this.domNode=e},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(v.hitch(this,this._init))},postCreate:function(){var a=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(C(this.submitNode,T,v.hitch(this,this._searchButton)));this.own(C(this.sourcesBtnNode,T,v.hitch(this,this._toggleSourcesMenu)));this.own(C(this.inputNode,T,v.hitch(this,this._inputClick)));this.own(C(this.clearNode,T,v.hitch(this,this._clearButton)));this.own(C(this.formNode,"submit",v.hitch(this,function(e){e.preventDefault();this._cancelSuggest();this.search()})));this.own(C(this.inputNode,"keyup",v.hitch(this,function(e){this._inputKey(e)})));
this.own(C(this.sourcesBtnNode,"keyup",v.hitch(this,function(e){this._sourceBtnKey(e)})));this.own(C(this.suggestionsNode,"li:click, li:keyup",function(e){a._suggestionsEvent(e,this)}));this.own(C(this.sourcesNode,"li:click, li:keyup",function(e){a._sourcesEvent(e,this)}));this.own(C(this.inputNode,"input, paste",v.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(C(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",v.hitch(this,function(e){this._showMoreResultsClick(e)}))),this.own(C(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",v.hitch(this,function(e){this._moreResultsClick(e)}))),this.own(C(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",v.hitch(this,function(e){this._switchCoordinatesClick(e)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();G.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();f.get(this.inputNode,"value")&&f.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);c.remove(this.containerNode,this.css.hasValue);f.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){w.set(this.domNode,"display","block")},hide:function(){w.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(c.add(this.containerNode,this.css.searchExpanded),c.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(c.remove(this.containerNode,this.css.searchExpanded),c.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(a){this.enableButtonMode&&("undefined"===typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(a){var e=new p;this._mapLoaded().then(v.hitch(this,function(){this._searchDeferred(a).then(v.hitch(this,function(h){var k=h.results;this.set("searchResults",k);0===h.numResults&&(this._noResults(h.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",h);this._selectFirstResult(k,
h.activeSourceIndex);e.resolve(k)}),v.hitch(this,function(h){e.reject(h)}))}));return e.promise},suggest:function(a){var e=new p;this._mapLoaded().then(v.hitch(this,function(){this._suggestDeferred(a).then(v.hitch(this,function(h){if(h){var k=h.results;this.set("suggestResults",k);this._insertSuggestions(k,h.value);this.emit("suggest-results",h);e.resolve(k)}}),v.hitch(this,function(h){e.reject(h)}))}));return e.promise},select:function(a){var e=this._getDefaultSymbol(a),h=this.labelSymbol,k=this.sources,
t=this.activeSourceIndex,N=this.enableHighlight,W=this.enableLabel,ja=this.autoNavigate,ea=this.showInfoWindowOnSelect,ha=this.enableInfoWindow,Q=this.infoTemplate,aa=a.feature?new Z(a.feature.toJson()):null,la=aa?a.feature._sourceLayer:null;za(aa,la);if(t===this._allIndex){var R=this._getSourceIndexOfResult(a);if(null!==R){var ia=k[R];t=R}}else ia=k[t];ia&&(ia.hasOwnProperty("highlightSymbol")&&(e=ia.highlightSymbol),ia.hasOwnProperty("labelSymbol")&&(h=ia.labelSymbol),ia.hasOwnProperty("enableHighlight")&&
(N=ia.enableHighlight),ia.hasOwnProperty("enableLabel")&&(W=ia.enableLabel),ia.hasOwnProperty("autoNavigate")&&(ja=ia.autoNavigate),ia.hasOwnProperty("showInfoWindowOnSelect")&&(ea=ia.showInfoWindowOnSelect),ia.hasOwnProperty("enableInfoWindow")&&(ha=ia.enableInfoWindow),ia.hasOwnProperty("infoTemplate")?Q=ia.infoTemplate:ia.featureLayer&&ia.featureLayer.infoTemplate&&(Q=ia.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(aa){k=this.highlightGraphic;var sa=this.graphicsLayer;R=
this.labelGraphic;var Ha=v.mixin({},aa.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(a),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(a)}),ab=null;ha&&(ab=Q);R?(R.setGeometry(aa.geometry),R.setAttributes(Ha),R.setSymbol(h),h&&"textsymbol"===h.type&&R.symbol.setText(a.name)):(R=new Z(aa.geometry,h,Ha),za(R,la),h&&"textsymbol"===h.type&&R.symbol.setText(a.name),
W&&(sa?sa.add(R):this.map&&this.map.graphics&&this.map.graphics.add(R)));k?(k.setGeometry(aa.geometry),k.setAttributes(Ha),k.setInfoTemplate(ab),k.setSymbol(e)):(k=new Z(aa.geometry,e,Ha,ab),za(k,la),N&&(sa?sa.add(k):this.map&&this.map.graphics&&this.map.graphics.add(k)));k&&k.symbol&&"textsymbol"===k.symbol.type&&k.symbol.setText(a.name);this.map&&this.map.infoWindow&&ha&&ea&&(this.map.infoWindow.setFeatures([k]),e=this._getPointFromGeometry(k.geometry),this.map.infoWindow.show(e));this.map&&ja&&
a&&a.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&this.map.setExtent(a.extent,!0);this.set("highlightGraphic",k);this.set("labelGraphic",R)}this.set("selectedResult",a);this.emit("select-result",{result:a,source:ia,sourceIndex:t})},focus:function(){ba.focus(this.inputNode)},blur:function(){this.inputNode.blur();ba.curNode&&ba.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,e=this.graphicsLayer,h=this.labelGraphic;a&&(e?e.remove(a):this.map&&this.map.graphics&&
this.map.graphics.remove(a));h&&(e?e.remove(h):this.map&&this.map.graphics&&this.map.graphics.remove(h));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var a=new p;if(this.map)if(this.map.loaded)a.resolve();else C.once(this.map,"load",v.hitch(this,function(){a.resolve()}));else a.resolve();return a.promise},_init:function(){this._getMapLayers().then(v.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();ba.focus(this.inputNode)},
_error:function(a){return Error(this.declaredClass+" "+a)},_searchDeferred:function(a){var e=new p,h=this.value,k=this.activeSourceIndex;a&&a.hasOwnProperty("index")&&(k=a.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var t={magicKey:this.magicKey,text:h};a?"string"===typeof a?(t.text=a,a=this._searchQueries(t)):a="object"===typeof a&&a.hasOwnProperty("magicKey")?this._searchQueries(a):"object"===typeof a&&a.hasOwnProperty("geometry")?this._searchQueries({geometry:a}):
"object"===typeof a&&a.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(a):"object"===typeof a&&"point"===a.type?this._searchQueries({point:a}):a instanceof Array&&2===a.length?this._searchQueries({latlon:a}):this._searchQueries(t):a=this._searchQueries(t);a.always(v.hitch(this,function(N){N=this._formatResults(N,k,h);e.resolve(N)}));return e.promise},_suggestDeferred:function(a){var e=new p;this._deferreds.push(e);a||(a=this.value);var h=this.activeSourceIndex;this._suggestQueries({text:a}).always(v.hitch(this,
function(k){var t;if(k)for(var N=0;N<k.length;N++)k[N]&&(t=!0);t?(k=this._formatResults(k,h,a),e.resolve(k)):e.resolve()}));return e.promise},_getDefaultSymbol:function(a){var e;this.map&&(e=this.map.getBasemap());e||(e="topo");if(a&&a.feature&&a.feature.geometry)var h=a.feature.geometry.type;"polyline"===h?h="line":"circle"===h||"extent"===h?h="polygon":"multipoint"===h&&(h="point");if(h){if(a=Ga.getSchemes({theme:"default",basemap:e,geometryType:h}))var k=a.primaryScheme;if(k){k.color&&k.hasOwnProperty("opacity")&&
(k.color.a=k.opacity);var t=k;a=k.color;k=k.size;switch(h){case "point":var N=new Ra;N.setColor(a);N.setSize(null!==k?k:t.size);h=new Wa;h.setColor(t.outline.color);h.setWidth(t.outline.width);N.setOutline(h);break;case "line":N=new Wa;N.setColor(a);N.setWidth(null!==k?k:t.width);break;case "polygon":N=new $a,N.setColor(a),h=new Wa,h.setColor(t.outline.color),h.setWidth(t.outline.width),N.setOutline(h)}t=N}}return t},_selectFirstResult:function(a,e){if(this.autoSelect&&a){var h;e===this._allIndex?
h=this._getFirstResult(a):a[e]&&a[e][0]&&(h=a[e][0]);h&&this.select(h)}},_getSourceIndexOfResult:function(a){var e=this.searchResults;if(e)for(var h in e)if(e[h]&&e[h].length)for(var k=0;k<e[h].length;k++)if(e[h][k]===a)return parseInt(h,10);return null},_getFirstResult:function(a){if(a)for(var e in a)if(a[e]&&a[e][0])return a[e][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},
_onBlur:function(){this._hideMenus();this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var a=new p;if(this.addLayersFromMap&&this.map){var e=[],h=this.map.graphicsLayerIds;if(h&&h.length){for(var k=0;k<h.length;k++){var t=this.map.getLayer(h[k]);t&&e.push(this._featureLayerLoaded(t))}ra(e).always(v.hitch(this,function(N){for(var W,
ja=this.sources,ea=0;ea<N.length;ea++)N[ea]&&N[ea].loaded&&"Feature Layer"===N[ea].type&&(ja.push({featureLayer:N[ea],enableSuggestions:!0}),W=!0);W&&this.set("sources",ja);a.resolve()}))}else a.resolve()}else a.resolve();return a.promise},_switchCoordinatesClick:function(a){a.preventDefault();if(a=f.get(a.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",a),this.search()},_moreResultsClick:function(a){a.preventDefault();var e=a.target;a=parseInt(f.get(e,"data-source-index"),
10);e=parseInt(f.get(e,"data-index"),10);var h=this.searchResults;h&&h[a]&&(a=h[a][e])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=d.byId(this._moreResultsId)){c.toggle(a,this.css.searchShowMoreResults);var e=d.byId(this._moreResultsId+"_show");e&&(c.contains(a,this.css.searchShowMoreResults)?f.set(e,"textContent",A.widgets.Search.main.hideMoreResults):f.set(e,"textContent",A.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(a){var e=new p;if(a.loaded)e.resolve(a);
else if(a.loadError)e.reject(this._error("Layer failed to load."));else{var h=C.once(a,"load",v.hitch(this,function(){k.remove();e.resolve(a)}));var k=C.once(a,"error",v.hitch(this,function(){h.remove();e.reject(this._error("Layer could not be loaded."))}))}return e.promise},_getObjectSize:function(a){var e=0,h;for(h in a)a.hasOwnProperty(h)&&e++;return e},_sourcesEvent:function(a,e){var h=f.get(e,"data-index"),k=y("li",this.sourcesNode);e=x.indexOf(k,e);h!==this._allIndex&&(h=parseInt(h,10));"click"===
a.type||a.keyCode===z.ENTER?(this.set("activeSourceIndex",h),ba.focus(this.inputNode),this._hideSourcesMenu()):a.keyCode===z.UP_ARROW?(a.stopPropagation(),a.preventDefault(),a=e-1,0>a?ba.focus(this.sourcesBtnNode):ba.focus(k[a])):a.keyCode===z.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),a=e+1,a>=k.length?ba.focus(this.sourcesBtnNode):ba.focus(k[a])):a.keyCode===z.ESCAPE&&(this._hideSourcesMenu(),ba.focus(this.inputNode))},_suggestionsEvent:function(a,e){var h=f.get(e,"data-source-index"),k=
parseInt(f.get(e,"data-index"),10),t=y("li",this.suggestionsNode),N=this.sources;e=x.indexOf(t,e);h!==this._allIndex&&(h=parseInt(h,10));var W;this._clearQueryTimeout();"click"===a.type||a.keyCode===z.ENTER?((t=this.suggestResults)&&t[h]&&t[h][k]&&(W=t[h][k]),W&&(W.index=h,N[h].featureLayer?(h=N[h].featureLayer.objectIdField,W[this._objectIdIdentifier]=W.feature.attributes[h],this.set("value",this._getSuggestionName(W)),this.set("selectedFeatureId",W.feature.attributes[h])):W.magicKey&&W.text&&(this.set("value",
W.text),this.set("magicKey",W.magicKey)),this.search(W),ba.focus(this.inputNode))):a.keyCode===z.BACKSPACE||a.keyCode===z.DELETE?ba.focus(this.inputNode):a.keyCode===z.UP_ARROW?(a.stopPropagation(),a.preventDefault(),W=e-1,0>W?ba.focus(this.inputNode):ba.focus(t[W])):a.keyCode===z.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),W=e+1,W>=t.length?ba.focus(this.inputNode):ba.focus(t[W])):a.keyCode===z.ESCAPE&&(this._hideMenus(),ba.focus(this.inputNode))},_getResultName:function(a){var e;a.hasOwnProperty("name")&&
null!==a.name&&(e=a.name.toString());e||(e=A.widgets.Search.main.untitledResult);return e},_getSuggestionName:function(a){var e;a.hasOwnProperty("name")&&null!==a.name&&(e=a.name.toString());a=a.text||e;a||(a=A.widgets.Search.main.untitledResult);return a},_searchResultHTML:function(a){var e="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var h=a.name.split(" ");if(2===h.length){var k=h[0];var t=h[1]}t&&k?(a=parseFloat(k),t=parseFloat(t),
h=t+", "+a,e+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',e+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+A.widgets.Search.main.lonlat+"\x3c/div\x3e",e=e+(a+", "+t)+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsItem+'"\x3e'),a===t||90<a||-90>a||180<t||-180>t||(e+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+A.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",e+='\x3ca data-switch-coordinates\x3d"'+h+'" tabindex\x3d"0" href\x3d"#"\x3e'+h+"\x3c/a\x3e\x3c/div\x3e")):
e=a.name}else e=a.name;return e},_moreResultsHTML:function(a){var e="",h="",k=this.searchResults,t=this.sources,N=0;if(k){h+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e';h+='\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+A.widgets.Search.main.showMoreResults+"\x3c/a\x3e";h=h+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsList+'"\x3e');h+='\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e';for(var W in k)if(k[W]){var ja=k[W].length;if(ja){var ea=1===ja&&k[W][0]===
a;if(1<this._getObjectSize(k)&&!ea){var ha=this._getSourceName(W);h+='\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+ha+"\x3c/div\x3e"}if(ja&&!ea){h+="\x3cul\x3e";ha=t[W].maxResults||this.maxResults;for(ea=0;ea<ja&&ea<ha;++ea)if(k[W][ea]!==a){var Q=this._getResultName(k[W][ea]);h+='\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+ea+'" data-source-index\x3d"'+W+'" href\x3d"#"\x3e'+Q+"\x3c/a\x3e\x3c/li\x3e";N++}h+="\x3c/ul\x3e"}}}h+="\x3c/div\x3e\x3c/div\x3e"}N&&(e+=h);return e},
_validField:function(a,e){return a.getField(e)},_validFields:function(a,e){if(a&&e&&e.length){for(var h=0;h<e.length;h++)if(!this._validField(a,e[h]))return!1;return!0}return!1},_getCodedName:function(a,e){if(a&&a.length)for(var h=0,k=a.length;h<k;h++){var t=a[h];if(t.code===e)return t.name}},_getCodedValue:function(a,e,h){if(a&&a.length)for(var k=0,t=a.length;k<t;k++){var N=a[k],W=N.name,ja=e;h||(W=W.toLowerCase(),ja=ja.toLowerCase());if(W===ja)return N.code}return!1},_whereClause:function(a,e,h,
k,t){var N=null;if(a){var W="",ja=this.reHostedFS.test(e.url);ja&&this._containsNonLatinCharacter(a)&&(W="N");if(h&&h.length)for(var ea=0,ha=h.length;ea<ha;ea++){var Q="";Q=a.replace(/'/g,"''");var aa=h[ea],la=e.getField(aa),R=e.getDomain(aa);R&&"codedValue"===R.type&&(Q=this._getCodedValue(R.codedValues,Q,k));!1!==Q&&(la=la.type,"esriFieldTypeString"===la||"esriFieldTypeDate"===la?k&&"search"===t?Q=aa+" \x3d "+W+"'"+Q+"'":(aa=ja?aa:"LOWER("+aa+")",Q=(ja?Q:Q.toLowerCase())+"%",Q=aa+" LIKE "+W+"'"+
Q+"'"):"esriFieldTypeOID"===la||"esriFieldTypeSmallInteger"===la||"esriFieldTypeInteger"===la||"esriFieldTypeSingle"===la||"esriFieldTypeDouble"===la?(Q=parseFloat(Q),Q=isNaN(Q)?!1:aa+" \x3d "+Q):Q=aa+" \x3d "+Q,Q&&(N=N?N+" or ":"",N+=Q))}}return N},_suggest:function(a){a||(a={index:this.activeSourceIndex,text:this.value});var e=new p,h=a.index,k=this.sources[h],t=this.enableSuggestions;k.hasOwnProperty("enableSuggestions")&&(t=k.enableSuggestions);var N=0;if(a.hasOwnProperty("text")&&a.text){var W=
v.trim(a.text);N=a.text.length}a=k.minCharacters||this.minCharacters;if(t&&W&&N>=a&&this._supportsPagination(k)){var ja="";k.prefix&&(ja+=k.prefix);ja+=W;k.suffix&&(ja+=k.suffix);var ea=this._defaultSR;this.map&&(ea=this.map.spatialReference);t={};k.locator?(k.categories&&(t.categories=k.categories),k.locator.outSpatialReference=ea,this.map&&k.localSearchOptions&&k.localSearchOptions.hasOwnProperty("distance")&&k.localSearchOptions.hasOwnProperty("minScale")&&(N=this._getScale(),!k.localSearchOptions.minScale||
N&&N<=parseFloat(k.localSearchOptions.minScale))&&(t.location=this.map.extent.getCenter(),t.distance=k.localSearchOptions.distance),t.text=ja,k.useMapExtent&&this.map&&this.map.extent&&(t.searchExtent=this.map.extent),k.searchExtent&&(t.searchExtent=k.searchExtent),t.maxSuggestions=k.maxSuggestions||this.maxSuggestions,k.sourceCountry&&(t.countryCode=k.sourceCountry),k.countryCode&&(t.countryCode=k.countryCode),k.locator.suggestLocations(t).then(v.hitch(this,function(ha){e.resolve(ha)}),v.hitch(this,
function(ha){ha||(ha=this._error("Locator suggestLocations could not be performed."));e.reject(ha)}))):k.featureLayer?this._featureLayerLoaded(k.featureLayer).then(v.hitch(this,function(){var ha=this._getDisplayField(k),Q=k.searchFields||[ha],aa=[];k.suggestionTemplate?k.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(sa,Ha){aa.push(Ha)}):aa=[ha];-1===x.indexOf(aa,k.featureLayer.objectIdField)&&aa.push(k.featureLayer.objectIdField);ha=this._validField(k.featureLayer,ha);var la=this._validFields(k.featureLayer,
aa),R=this._validFields(k.featureLayer,Q);if(ha&&la&&R){ha=new V;k.hasOwnProperty("suggestQueryParams")&&v.mixin(ha,k.suggestQueryParams);ha.outSpatialReference=ea;ha.returnGeometry=!1;ha.num=k.maxSuggestions||this.maxSuggestions;ha.outFields=aa;k.useMapExtent&&this.map&&this.map.extent&&(ha.geometry=this.map.extent);k.searchExtent&&(ha.geometry=k.searchExtent);ta(k.featureLayer)&&ya(k.featureLayer,Q)&&!k.exactMatch&&ja?ha.fullText=ma(ja,Q):ha.where=this._whereClause(ja,k.featureLayer,Q,k.exactMatch,
"suggest");if(ha.fullText||ha.where)var ia=!0;ia?k.featureLayer.queryFeatures(ha,v.hitch(this,function(sa){var Ha;(sa=sa.features)&&(Ha=this._hydrateResults(sa,h,!0));e.resolve(Ha)}),v.hitch(this,function(sa){sa||(sa=this._error("FeatureLayer queryFeatures errored with suggestions"));e.reject(sa)})):e.resolve()}else e.reject(this._error("Invalid FeatureLayer field"))})):e.reject(this._error("Invalid source"))}else e.resolve();return e.promise},_supportsPagination:function(a){var e;a.locator?e=!0:
a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&(e=!0);return e},_suggestQueries:function(a){var e=this.sources,h=this.activeSourceIndex,k=[];if(h===this._allIndex)for(h=0;h<e.length;h++){var t=a;t.index=h;t=this._suggest(t);k.push(t)}else a.index=h,t=this._suggest(a),k.push(t);return ra(k)},_getPointFromGeometry:function(a){switch(a.type){case "extent":var e=a.getCenter();break;case "multipoint":e=a.getPoint(0);break;case "point":e=
a;break;case "polygon":e=a.getCentroid();break;case "polyline":e=a.getPoint(0,0)}return e},_searchQueries:function(a){a.hasOwnProperty("index")||(a.index=this.activeSourceIndex);var e=[];if(a.index===this._allIndex)for(var h=this.sources,k=0;k<h.length;k++){var t=a;t.index=k;t=this._search(t);e.push(t)}else a=this._search(a),e.push(a);return ra(e)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),ba.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(a){a||
(a={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(a.text=null,a[this._objectIdIdentifier]=this.selectedFeatureId);var e,h=new p,k=a.index,t=this.sources[k],N;a.hasOwnProperty("text")&&a.text&&(N=v.trim(a.text));if(t){var W="";t.prefix&&!a.magicKey&&(W+=t.prefix);W+=N;t.suffix&&!a.magicKey&&(W+=t.suffix);var ja=this._defaultSR;this.map&&(ja=this.map.spatialReference);if(t.locator)if(a.hasOwnProperty("text")&&N){var ea={};
t.categories&&(ea.categories=t.categories);t.locationType&&(ea.locationType=t.locationType);ja&&(t.locator.outSpatialReference=ja);if(this.map&&t.localSearchOptions&&t.localSearchOptions.hasOwnProperty("distance")&&t.localSearchOptions.hasOwnProperty("minScale")){var ha=this._getScale();if(!t.localSearchOptions.minScale||ha&&ha<=parseFloat(t.localSearchOptions.minScale))ea.location=this.map.extent.getCenter(),ea.distance=t.localSearchOptions.distance}ea.address={};ea.maxLocations=t.maxResults||this.maxResults;
t.useMapExtent&&this.map&&this.map.extent&&(ea.searchExtent=this.map.extent);t.searchExtent&&(ea.searchExtent=t.searchExtent);t.sourceCountry&&(ea.countryCode=t.sourceCountry);t.countryCode&&(ea.countryCode=t.countryCode);a.magicKey&&(ea.magicKey=a.magicKey);t.singleLineFieldName?ea.address[t.singleLineFieldName]=W:ea.address["Single Line Input"]=W;t.outFields&&(ea.outFields=t.outFields);t.locator.addressToLocations(ea).then(v.hitch(this,function(Q){Q=this._hydrateResults(Q,k,!1);h.resolve(Q)}),v.hitch(this,
function(Q){Q||(Q=this._error("Locator addressToLocations could not be performed"));h.reject(Q)}))}else a.geometry?(e=this._getPointFromGeometry(a.geometry.geometry))?this._reverseGeocodePoint(k,e).then(function(Q){h.resolve(Q)},function(Q){h.reject(Q)}):h.reject(this._error("Invalid point to reverse geocode")):a.point?this._reverseGeocodePoint(k,a.point).then(function(Q){h.resolve(Q)},function(Q){h.reject(Q)}):a.latlon?(ea=new Fa(a.latlon,this._defaultSR),this._reverseGeocodePoint(k,ea).then(function(Q){h.resolve(Q)},
function(Q){h.reject(Q)})):a.hasOwnProperty("text")&&!N?h.resolve([]):h.reject(this._error("Invalid query type for Locator"));else t.featureLayer?this._featureLayerLoaded(t.featureLayer).then(v.hitch(this,function(){var Q=this._getDisplayField(t),aa=t.searchFields||[Q];Q=this._validField(t.featureLayer,Q);var la=this._validFields(t.featureLayer,aa);if(Q&&la){Q=new V;t.hasOwnProperty("searchQueryParams")&&v.mixin(Q,t.searchQueryParams);ja&&(Q.outSpatialReference=ja,la=this.map&&this.map.getMaxResolution()||
1/r.getUnitValueForSR(ja))&&(Q.maxAllowableOffset=la);Q.returnGeometry=!0;t.outFields&&(Q.outFields=t.outFields);if(!a.hasOwnProperty(this._objectIdIdentifier)){this._supportsPagination(t)&&(Q.num=t.maxResults||this.maxResults);t.useMapExtent&&this.map&&this.map.extent&&(Q.geometry=this.map.extent);t.searchExtent&&(Q.geometry=t.searchExtent);var R=t.exactMatch}a.hasOwnProperty("text")&&N?(ta(t.featureLayer)&&ya(t.featureLayer,aa)&&!R&&W?Q.fullText=ma(W,aa):Q.where=this._whereClause(W,t.featureLayer,
aa,R,"search"),aa=Q.fullText||Q.where?!0:!1):a.hasOwnProperty(this._objectIdIdentifier)?(Q.objectIds=[a[this._objectIdIdentifier]],aa=!0):a.geometry?(Q.geometry=a.geometry,aa=!0):a.point?(Q.geometry=a.point,aa=!0):a.latlon?(e=new Fa(a.latlon,this._defaultSR),Q.geometry=e,aa=!0):(a.hasOwnProperty("text")&&!N?h.resolve([]):h.reject(this._error("Invalid query type for FeatureLayer")),aa=!1);aa?t.featureLayer.queryFeatures(Q,v.hitch(this,function(ia){ia=ia.features;var sa;ia&&(sa=this._hydrateResults(ia,
k,!1));h.resolve(sa)}),v.hitch(this,function(ia){ia||(ia=this._error("FeatureLayer queryFeatures could not be performed"));h.reject(ia)})):h.resolve()}else h.reject(this._error("Invalid FeatureLayer field"))})):h.reject(this._error("Invalid source"))}else h.reject(this._error("Source is undefined"));return h.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,e,h){h={activeSourceIndex:e,value:h,numResults:0,numErrors:0,errors:null,results:null};
var k={},t={};if(a)if(e===this._allIndex)for(e=0;e<a.length;e++)a[e]&&(a[e]instanceof Error?(k[e]=a[e],h.numErrors++):(t[e]=a[e],h.numResults+=a[e].length));else a[0]&&(a[0]instanceof Error?(k[e]=a[0],h.numErrors++):(t[e]=a[0],h.numResults+=a[0].length));h.numErrors&&(h.errors=k);h.numResults&&(h.results=t);return h},_reverseGeocodePoint:function(a,e){var h=new p,k=this.sources[a];if(e&&k){var t=k.locationToAddressDistance||this.locationToAddressDistance;k.locator.outSpatialReference=this._defaultSR;
this.map&&(k.locator.outSpatialReference=this.map.spatialReference);k.locator.locationToAddress(e,t,v.hitch(this,function(N){N=this._hydrateResults([N],a,!1);h.resolve(N)}),v.hitch(this,function(N){N||(N=this._error("Locator locationToAddress could not be performed"));h.reject(N)}))}else h.reject(this._error("No point or source defined for reverse geocoding"));return h.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+
" cancelling request");this._deferreds=[]},_sourceBtnKey:function(a){if(a){var e=y("li",this.sourcesNode);a.keyCode===z.UP_ARROW?(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),(a=e.length)&&ba.focus(e[a-1])):a.keyCode===z.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),e[0]&&ba.focus(e[0]))}},_inputKey:function(a){if(a){var e=y("li",this.suggestionsNode),h=this.suggestResults;if(a.keyCode===z.TAB||a.keyCode===z.ESCAPE)this._cancelSuggest(),this._hideMenus();
else if(a.keyCode===z.UP_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),h&&this._showSuggestionsMenu(),(a=e.length)&&ba.focus(e[a-1]);else if(a.keyCode===z.DOWN_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),h&&this._showSuggestionsMenu(),e[0]&&ba.focus(e[0]);else{if(a.ctrlKey||a.metaKey||a.keyCode===z.copyKey||a.keyCode===z.LEFT_ARROW||a.keyCode===z.RIGHT_ARROW||a.keyCode===z.ENTER)return a;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();
this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(v.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){return this._sourceNames[a]},_loadSources:function(a){a=
x.filter(a,function(e){return!!e.featureLayer});a=x.map(a,function(e){return this._featureLayerLoaded(e.featureLayer)},this);return ra(a)},_createSourceNameMap:function(a){return this._loadSources(a).then(v.hitch(this,function(){var e=x.map(a,function(h){return h.name||h.featureLayer&&h.featureLayer.name||A.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(a,e);return e}))},_getDuplicateSourceNameIndexes:function(a){var e={},h=[];x.forEach(a,function(k,t){e.hasOwnProperty(k)?
(-1===h.indexOf(e[k])&&h.push(e[k]),h.push(t)):a.lastIndexOf(k)!==t&&(e[k]=t)});return h},_preventDuplicateSourceNames:function(a,e){if(e&&1<e.length){var h=this._getDuplicateSourceNameIndexes(e);x.forEach(h,function(k){e[k]+=this._getFieldsString(a[k])},this)}},_getFieldsString:function(a){var e="",h=a.featureLayer;if(h){a=a.searchFields||[this._getDisplayField(a)];for(var k=0;k<a.length;k++){e=0===k?e+": ":e+", ";var t=a[k],N=h.getFieldLabel(t);e+=N||t}}return e},_splitResult:function(a,e){e=g.escapeString(e);
return a.replace(new RegExp("(^|)("+e+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(a,e){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var h=this.sources;if(a){var k=G.create("div");for(var t in a)if(a[t]&&a[t].length){var N=this._getSourceName(t);1<h.length&&this.activeSourceIndex===this._allIndex&&G.create("div",{className:this.css.searchMenuHeader,textContent:N},k);N=G.create("ul",{role:"menu"},k);for(var W=h[t].maxSuggestions||
this.maxSuggestions,ja=0;ja<a[t].length&&ja<W;++ja){var ea=G.create("li",{"data-index":ja,"data-source-index":t,role:"menuitem",tabindex:0},N),ha=this._getSuggestionName(a[t][ja]);ha=this._splitResult(ha,e);for(var Q=ha.length,aa=0;aa<Q;aa++){var la=ha[aa];la.toLowerCase()===e.toLowerCase()?G.create("strong",{textContent:la},ea):(la=document.createTextNode(la),G.place(la,ea))}}}}k?(G.place(k,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(G.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},
_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var e,h=this.activeSourceIndex,k=G.create("ul",{role:"menu"});if(this.enableSearchingAll){var t="";h===this._allIndex&&(t="active");G.create("li",{"data-index":this._allIndex,role:"menuitem",className:t,tabIndex:0,textContent:A.widgets.Search.main.all},k)}for(e=0;e<a.length;e++){t="";e===h&&(t=this.css.activeSource);var N=this._getSourceName(e);G.create("li",{"data-index":e,role:"menuitem",className:t,tabIndex:0,textContent:N},k)}c.add(this.containerNode,
this.css.hasMultipleSources);G.place(k,this.sourcesNode,"only")}else c.remove(this.containerNode,this.css.hasMultipleSources),G.empty(this.sourcesNode)},_showLoading:function(){c.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){c.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(c.add(this.containerNode,this.css.hasValue),f.set(this.clearNode,"title",A.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&
this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(a){var e;a&&(e=v.trim(a));var h=G.create("div",{className:this.css.searchNoResultsBody});a&&e?(G.create("div",{className:this.css.searchNoResultsHeader,textContent:A.widgets.Search.main.noResults},h),G.create("div",{className:this.css.searchNoResultsText,textContent:E.substitute({value:'"'+a+'"'},A.widgets.Search.main.noResultsFound)},h)):(a=G.create("div",{},h),G.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},
a),G.create("span",{className:this.css.searchNoValueText,textContent:A.widgets.Search.main.emptyValue},a));G.place(h,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){c.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();c.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){c.remove(this.containerNode,
this.css.showSources)},_hideSuggestionsMenu:function(){c.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();c.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();c.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();c.toggle(this.containerNode,this.css.showSources)},
_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var e=0;e<a.length;e++){var h=a[e];if("esriFieldTypeString"===h.type)return h.name}return""},_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validLocation:function(a){return a&&"number"===typeof a.x&&"number"===typeof a.y},_validExtent:function(a){return a&&"number"===typeof a.xmin&&"number"===typeof a.ymin&&"number"===typeof a.xmax&&"number"===typeof a.ymax},
_hydrateResult:function(a,e,h){var k={},t=this._defaultSR;e=this.sources[e];this.map&&(t=this.map.spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("geometry")){var N=new Z(a.toJson());k.feature=N;(N=k.feature.geometry)&&N.setSpatialReference(t)}else if(a.hasOwnProperty("location")&&this._validLocation(a.location)){var W=new Fa(a.location.x,a.location.y,t);N={};a.hasOwnProperty("attributes")&&(N=a.attributes);a.hasOwnProperty("address")&&"object"===
typeof a.address&&v.mixin(N,a.address);a.hasOwnProperty("score")&&(N.score=a.score);k.feature=new Z(W,null,N,null)}!k.feature&&h&&(N={},a.hasOwnProperty("attributes")&&(N=a.attributes),a.hasOwnProperty("score")&&(N.score=a.score),k.feature=new Z(null,null,N,null));if(k.feature){if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))k.extent=new qa(a.extent),k.extent.setSpatialReference(t);else if(k.feature&&k.feature.geometry)switch(k.feature.geometry.type){case "extent":k.extent=k.feature.geometry;
break;case "multipoint":k.extent=l.getDenormalizedExtent(k.feature.geometry);break;case "polygon":k.extent=l.getDenormalizedExtent(k.feature.geometry);break;case "polyline":k.extent=l.getDenormalizedExtent(k.feature.geometry);break;case "point":this.map?(t=this.zoomScale,e&&e.zoomScale&&(t=e.zoomScale),this._getScale()>t?k.extent=r.getExtentForScale(this.map,t).centerAt(k.feature.geometry):k.extent=this.map.extent.centerAt(k.feature.geometry)):k.extent=new qa({xmin:k.feature.geometry.x-.25,ymin:k.feature.geometry.y-
.25,xmax:k.feature.geometry.x+.25,ymax:k.feature.geometry.y+.25,spatialReference:this._defaultSR})}else k.extent=null;k.name="";e.featureLayer?e.suggestionTemplate&&h?k.name=E.substitute(a.attributes,e.suggestionTemplate):e.searchTemplate?k.name=E.substitute(a.attributes,e.searchTemplate):(N=this._getDisplayField(e),h=e.featureLayer.getField(N),t=e.featureLayer.getDomain(N),N&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(N)&&(a=a.attributes[N],t&&"codedValue"===t.type?k.name=this._getCodedName(t.codedValues,
a):h&&"esriFieldTypeDate"===h.type&&!isNaN(a)?k.name=L.format(new Date(a)):k.name=a)):a.address&&e.searchTemplate?k.name=E.substitute(a.address,e.searchTemplate):a.hasOwnProperty("name")?k.name=a.name:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.LongLabel?k.name=a.attributes.LongLabel:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.Match_addr?(k.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&
a.attributes.City?k.name+=" - "+a.attributes.StAddr+", "+a.attributes.City:a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.City&&(k.name+=" - "+a.attributes.City)):a.hasOwnProperty("address")&&"string"===typeof a.address?k.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?a.address.hasOwnProperty("Match_addr")?k.name=a.address.Match_addr:a.address.hasOwnProperty("Address")&&(k.name=a.address.Address):k.feature&&k.feature.geometry&&
(k.name=k.feature.geometry.x+","+k.feature.geometry.y);e.featureLayer&&k.feature&&za(k.feature,e.featureLayer);return k}},_getScale:function(){var a;this.map&&"function"===typeof this.map.getScale&&(a=this.map.getScale());return a},_hydrateResults:function(a,e,h){var k=[],t=0;if(a&&a.length)for(t;t<a.length;t++){var N=this._hydrateResult(a[t],e,h);N&&k.push(N)}return k},_containsNonLatinCharacter:function(a){for(var e=0;e<a.length;e++)if(255<a.charCodeAt(e))return!0;return!1},_setPlaceholder:function(a){var e=
"",h=this.sources[a];a===this._allIndex?e=this.allPlaceholder||A.widgets.Search.main.allPlaceholder:h&&h.placeholder&&(e=h.placeholder);var k=A.widgets.Search.main.all;h&&(k=this._getSourceName(a));f.set(this.sourceNameNode,"textContent",k);f.set(this.inputNode,"placeholder",e);f.set(this.inputNode,"title",e)},_updateActiveSource:function(){var a=this.sources,e=this.activeSourceIndex,h;a&&a[e]&&(h=a[e]);h?this.set("activeSource",h):this.set("activeSource",null)},_updateVisible:function(){this.visible?
this.show():this.hide()},_updateButtonMode:function(a){a?(c.toggle(this.containerNode,this.css.searchExpanded,this.expanded),c.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),c.add(this.containerNode,this.css.hasButtonMode)):(c.remove(this.containerNode,this.css.searchExpanded),c.remove(this.containerNode,this.css.searchCollapsed),c.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(a){a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",
0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(a){this._createSourceNameMap(a).then(v.hitch(this,function(e){this._sourceNames=e;this._created&&(this._setDefaultActiveSourceIndex(a),
this._hideMenus(),this._insertSources(a))}));this._set("sources",a)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&f.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",
null);this.set("selectedFeatureId",null);this._set("value",a);this._created&&(f.set(this.inputNode,"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(c.remove(this.domNode,this.theme),c.add(this.domNode,a));this._set("theme",a)}});m("extend-esri")&&v.setObject("dijit.Search",B,
U);return B})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(F,B,v,x,u,p,z,C,y,m,g){F=F(m,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(d){this._geocodeHandler=
B.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=B.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=B.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(d){this.outSpatialReference=d},_geocodeHandler:function(d,f,c,w,G){try{var L=d.candidates;f=[];var A,O=L.length,D=d.spatialReference,I;for(A=0;A<O;A++){var M=L[A];if(I=M.location)I.spatialReference=D;f[A]=new g(M)}this._successHandler([f],
"onAddressToLocationsComplete",c,G)}catch(T){this._errorHandler(T,w,G)}},_geocodeAddressesHandler:function(d,f,c,w,G){try{var L=d.locations;f=[];var A,O=L.length,D=d.spatialReference,I;for(A=0;A<O;A++){if(I=L[A].location)I.spatialReference=D;f[A]=new g(L[A])}this._successHandler([f],"onAddressesToLocationsComplete",c,G)}catch(M){this._errorHandler(M,w,G)}},addressToLocations:function(d,f,c,w,G){var L;if(d.address){w=c;c=f;f=d.outFields;G=d.searchExtent;var A=d.countryCode;var O=d.magicKey;var D=d.distance;
var I=d.categories;d.location&&this.normalization&&(L=d.location.normalize());var M=d.locationType;var T=d.maxLocations;var ba=d.forStorage;d=d.address}G&&(G=G.shiftCentralMeridian());var E=this.outSpatialReference;d=this._encode(B.mixin({},this._url.query,d,{f:"json",outSR:E&&u.toJson(E.toJson()),outFields:f&&f.join(",")||null,searchExtent:G&&u.toJson(G.toJson()),category:I&&I.join(",")||null,countryCode:A||null,magicKey:O||null,distance:D||null,location:L||null,locationType:M||null,maxLocations:T||
null,forStorage:ba||null}));var ka=this._geocodeHandler,U=this._errorHandler,da=new x(y._dfdCanceller);da._pendingDfd=C({url:this._url.path+"/findAddressCandidates",content:d,callbackParamName:"callback",load:function(Z,ra){ka(Z,ra,c,w,da)},error:function(Z){U(Z,w,da)}});return da},suggestLocations:function(d){var f=new x(y._dfdCanceller);d.hasOwnProperty("location")&&this.normalization&&(d.location=d.location.normalize());d.searchExtent&&(d.searchExtent=d.searchExtent.shiftCentralMeridian());d=this._encode(B.mixin({},
this._url.query,{f:"json",text:d.text,maxSuggestions:d.maxSuggestions,searchExtent:d.searchExtent&&u.toJson(d.searchExtent.toJson()),category:d.categories&&d.categories.join(",")||null,countryCode:d.countryCode||null,location:d.location||null,distance:d.distance||null},{f:"json"}));d=C({url:this._url.path+"/suggest",content:d,callbackParamName:"callback"});f._pendingDfd=d;d.then(B.hitch(this,function(c){c=c.suggestions||[];this.onSuggestLocationsComplete(c);f.resolve(c)}),B.hitch(this,function(c){this._errorHandler(c);
f.reject(c)}));return f},addressesToLocations:function(d,f,c){var w=this.outSpatialReference,G=[],L=d.categories,A=d.locationType,O=d.countryCode;v.forEach(d.addresses,function(T,ba){G.push({attributes:T})});d=this._encode(B.mixin({},this._url.query,{category:L&&L.join(",")||null,locationType:A||null,sourceCountry:O||null},{addresses:u.toJson({records:G})},{f:"json",outSR:w&&u.toJson(w.toJson())}));var D=this._geocodeAddressesHandler,I=this._errorHandler,M=new x(y._dfdCanceller);M._pendingDfd=C({url:this._url.path+
"/geocodeAddresses",content:d,callbackParamName:"callback",load:function(T,ba){D(T,ba,f,c,M)},error:function(T){I(T,c,M)}});return M},_reverseGeocodeHandler:function(d,f,c,w,G){try{var L=new g({address:d.address,location:d.location,score:100});this._successHandler([L],"onLocationToAddressComplete",c,G)}catch(A){this._errorHandler(A,w,G)}},locationToAddress:function(d,f,c,w){d&&this.normalization&&(d=d.normalize());var G=this.outSpatialReference;d=this._encode(B.mixin({},this._url.query,{outSR:G&&
u.toJson(G.toJson()),location:d&&u.toJson(d.toJson()),distance:f,f:"json"}));var L=this._reverseGeocodeHandler,A=this._errorHandler,O=new x(y._dfdCanceller);O._pendingDfd=C({url:this._url.path+"/reverseGeocode",content:d,callbackParamName:"callback",load:function(D,I){L(D,I,c,w,O)},error:function(D){A(D,w,O)}});return O},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});p("extend-esri")&&
B.setObject("tasks.Locator",F,z);return F})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(F,B,v,x,u){F=F(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(p){B.mixin(this,p);this.location=new u(this.location)}});v("extend-esri")&&B.setObject("tasks.AddressCandidate",F,x);return F})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has","../kernel","../Color"],
function(F,B,v,x,u){function p(g,d){if(g){var f={};f.color=new u(g.color);f.opacity=g.opacity||1;switch(d){case "point":f.outline={color:new u(g.outline.color),width:g.outline.width};f.size=g.size;break;case "line":f.width=g.width;break;case "polygon":f.outline={color:new u(g.outline.color),width:g.outline.width}}}return f}function z(g){if("esriGeometryPoint"===g||"esriGeometryMultipoint"===g)g="point";else if("esriGeometryPolyline"===g)g="line";else if("esriGeometryPolygon"===g||"esriGeometryMultiPatch"===
g)g="polygon";return g}var C={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,.25],width:1},size:8},secondary:[{color:[226,
119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},
dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},secondary:[{color:[178,
178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},y={};(function(){var g,d,f;for(g in C){var c=C[g];var w=c.basemapGroups;var G=y[g]={basemaps:[].concat(w.light).concat(w.dark),point:{},line:{},polygon:{}};for(d in w){var L=w[d];for(f=0;f<L.length;f++){var A=L[f];c.pointSchemes&&(G.point[A]=c.pointSchemes[d]);c.lineSchemes&&(G.line[A]=c.lineSchemes[d]);c.polygonSchemes&&(G.polygon[A]=c.polygonSchemes[d])}}}})();
var m={getAvailableThemes:function(g){var d=[],f;for(f in C){var c=C[f];var w=y[f];g&&-1===F.indexOf(w.basemaps,g)||d.push({name:c.name,label:c.label,description:c.description,basemaps:w.basemaps.slice(0)})}return d},getSchemes:function(g){var d=g.theme,f=g.basemap,c=z(g.geometryType);g=y[d];var w;(g=(g=g&&g[c])&&g[f])&&(w={primaryScheme:p(g.primary,c),secondarySchemes:F.map(g.secondary,function(G){return p(G,c)})});return w},cloneScheme:function(g){if(g){var d=B.mixin({},g);d.color&&(d.color=new u(d.color));
d.outline&&(d.outline={color:d.outline.color&&new u(d.outline.color),width:d.outline.width})}return d}};v("extend-esri")&&B.setObject("styles.basic",m,x);return m})},"jimu/dijit/LayerChooserFromMapLite":function(){define("dojo/on dojo/_base/declare dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/dijit/CheckBox jimu/dijit/LayerChooserFromMap jimu/LayerStructure".split(" "),function(F,B,v,x,u,p,z,C,y){var m=B([C],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"treeSection" class\x3d"tree-section"\x3e\x3cul data-dojo-attach-point\x3d"treeUl" class\x3d"tree-ul tree-root-ul"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e',
map:null,layerStateController:null,layerState:null,customFilter:null,onlySelectLeafLayer:!1,displayLayerTypeIcon:!0,showTables:!0,viewMode:!1,onlyShowWebMapLayers:!1,layerStructure:null,_layerDatas:null,_eventHandles:null,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map-lite");this._layerDatas={};this._eventHandles=[];this.layerStructure=
this.map?y.createInstance(this.map):y.getInstance();this.layerInfosObj=this.layerStructure._layerInfos;this.layerState=this._clearLayerState(this.layerState)||{};this.layerStateController||(this.layerStateController=new m.LayerStateController);var g=this.customFilter?x.hitch(this,this.customFilter):x.hitch(this,this.filter);this.filter=C.andCombineFilters([this.basicFilter,g]);this._createTree()},_createTree:function(){if(this.onlyShowWebMapLayers){var g=this.layerStructure.getWebmapLayerNodes();
var d=this.layerStructure.getWebmapTableNodes()}else g=this.layerStructure.getLayerNodes(),d=this.layerStructure.getTableNodes();0<this._createLayerNodes(g.concat(this.showTables?d:[]),this.treeUl)&&(u.setStyle(this.errorTipSection,"display","none"),this.layerStateController.restoreState(this.layerState,this.layerStructure))},_createLayerNodes:function(g,d){var f=p.map(g,function(w){return this.filter(w._layerInfo)},this),c=0;v(f).then(x.hitch(this,function(w){p.forEach(w,function(G,L){G&&(this._createLayerNode(g[L],
d),c++)},this)}));return c},_createLayerNode:function(g,d){var f=u.create("li",{"class":"tree-node-li",id:"layerchooserlite-tree-node-li-"+g.id},d),c=u.create("div",{"class":"tree-node-div"},f);d=u.create("span",{"class":"tree-node-column-span collapse-span"},c);var w=u.create("span",{"class":"tree-node-column-span check-box-span"},c);w=u.create("div",{"class":"tree-node-column-div check-box-div"},w);var G=u.create("span",{"class":"tree-node-column-span icon-span "+(this.displayLayerTypeIcon?"display":
"")},c);var L=(L=this.layerState[g.id])?L.selected:this.layerStateController.getState(g);L=new z({checked:L},w);var A=u.create("span",{"class":"tree-node-column-span title-span",innerHTML:g.title},c),O=u.create("ul",{"class":"tree-ul tree-subnode-ul",style:"display:none; "},f);f={layerNode:g,layerNodeLi:f,layerNodeDiv:c,collapseSpan:d,iconSpan:G,checkBox:L,subLayerNodeUl:O,hasBeenOpened:!1};this._layerDatas[g.id]=f;g.isLeaf()||(u.addClass(d,"is-leaf"),u.addClass(A,"is-leaf"),g=F(d,"click",x.hitch(this,
this._onCollapse,f)),this._eventHandles.push(g),g=F(A,"click",x.hitch(this,this._onCollapse,f)),this._eventHandles.push(g),this.onlySelectLeafLayer&&(L.setStatus(!1),u.setStyle(w,"display","none")));!0===this.viewMode&&L.setStatus(!1);g=F(L.domNode,"click",x.hitch(this,this._onCheckBoxChange,f));this._eventHandles.push(g);this._setIconImage(f,!1);return f},_setIconImage:function(g,d){if(this.displayLayerTypeIcon){var f=g.layerNode,c=f.getLayerType(),w=f.getLayerObject();v({layerType:c,layerObject:w}).then(x.hitch(this,
function(G){if(G.layerType&&G.layerObject){var L={type:G.layerType,layerInfo:f._layerInfo};G=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");(L=this._getIconInfo(L,d).imageName)&&u.setStyle(g.iconSpan,"background-image","url("+G+"/css/images/"+L+")")}}))}},_getCheckBoxValue:function(g){return g.getStatus()?g.getValue():!1},_clearLayerState:function(g){var d={};g&&this.layerStructure.traversal(x.hitch(this,function(f){g[f.id]&&(d[f.id]={selected:g[f.id].selected})}));return d},
_selectOrDeselectLayer:function(g,d){if(g=this._layerDatas[g])g.checkBox.setValue(d),this._onCheckBoxChange(g)},selectLayer:function(g){this._selectOrDeselectLayer(g,!0)},deselectLayer:function(g){this._selectOrDeselectLayer(g,!1)},getState:function(){var g=x.clone(this.layerState),d;for(d in this._layerDatas)this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]&&(this._getCheckBoxValue(this._layerDatas[d].checkBox)?g[d]={selected:!0}:g[d]={selected:!1});return g},restoreState:function(g){this.layerState=
this._clearLayerState(g);for(var d in this._layerDatas)if(this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]){var f=(g=this._layerDatas[d])&&g.checkBox,c=this.layerState[d];c?f.setValue(c.selected):f.setValue(this.layerStateController.getState(g.layerNode))}this.layerStateController.restoreState(this.layerState,this.layerStructure)},setViewMode:function(g){for(var d in this._layerDatas)if(this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]){var f=this._layerDatas[d];
f=f&&f.checkBox;!0===g?(this.viewMode=!0,f.setStatus(!1)):(this.viewMode=!1,f.setStatus(!0))}},getSelectedLayerNodes:function(){var g=[],d=this.getState(),f;for(f in d)if(d.hasOwnProperty(f)&&"function"!==typeof d[f]&&d[f].selected){var c=this.layerStructure.getNodeById(f);c&&g.push(c)}return g},getLoadedLayerNodes:function(){var g=[],d;for(d in this._layerDatas)if(this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]){var f=this.layerStructure.getNodeById(d);f&&g.push(f)}return g},
getLayerAssociateDomNodesById:function(g){var d=null;(g=this._layerDatas[g])&&(d={collapseIcon:g.collapseSpan,checkBox:g.checkBox.domNode,layerTypeIcon:g.iconSpan});return d},getSelectedItems:function(){var g=[];return g=p.map(this.getSelectedLayerNodes(),function(d){return{name:d.title,url:d.getUrl(),layerInfo:d._layerInfo}},this)},getAllItems:function(){return[]},_clear:function(){this._layerDatas={};p.forEach(this._eventHandles,function(g){g.remove()},this);this._eventHandles=[];u.empty(this.treeUl)},
destroy:function(){this._clear();this.map&&this.layerStructure.destroy();this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)},_onCollapse:function(g){var d="none"===u.getStyle(g.subLayerNodeUl,"display")?!0:!1;d?(u.setStyle(g.subLayerNodeUl,"display","block"),u.addClass(g.collapseSpan,"opened")):(u.setStyle(g.subLayerNodeUl,"display","none"),u.removeClass(g.collapseSpan,"opened"));this._setIconImage(g,d);g.hasBeenOpened||(this._createLayerNodes(g.layerNode.getSubNodes(),
g.subLayerNodeUl),g.hasBeenOpened=!0)},_onCheckBoxChange:function(g,d){this.layerStateController.setState(g.layerNode,this._getCheckBoxValue(g.checkBox));this.emit("selection-change",g.layerNode,this._getCheckBoxValue(g.checkBox));this._onTreeClick(g,d)},_onLayerInfosChanged:function(){this._createTree();this.emit("update")},_onLayerInfosIsShowInMapChanged:function(){this._createTree();this.emit("update")},_onTreeClick:function(g,d){g={name:g.layerNode.title||"",parent:null,layerInfo:g.layerNode._layerInfo,
type:null,layerClass:null,id:null,isLeaf:g.layerNode.isLeaf(),hasChildren:g.layerNode.isLeaf()?!1:!0};this.emit("tree-click",g,null,d)}});m.LayerStateController=B(null,{getState:function(g){return!0},setState:function(g,d){return this},restoreState:function(g,d){return this}});m.LayerVisibilityStateController=B(m.LayerStateController,{getState:function(g){return g.isToggledOn()},setState:function(g,d){g.toggle();return this},restoreState:function(g,d){var f={layerOptions:{}},c;for(c in g)g.hasOwnProperty(c)&&
"function"!==typeof g[c]&&(f.layerOptions[c]={visible:g[c].selected});d.restoreState(f);return this}});m.layerVisibilityStateController=new m.LayerVisibilityStateController;m.LayerLegendStateController=B(m.LayerStateController,{getState:function(g){return g.isShowLegend()}});m.layerLegendStateController=new m.LayerLegendStateController;return m})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(F,B,v,x,u,p,z,C,y,m,g,d,f,c,w,G,L,A){var O=v([x,u,p,B],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,onlyFilterCurrentLayerWhenAddItem:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new A({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=d.hitch(this,this.basicFilter);
this.filter=O.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(D){var I=new C;this.onlyShowVisible?I.resolve(D.isShowInMap()):I.resolve(!0);return I},filter:function(D){D=new C;D.resolve(!0);return D},getSelectedItems:function(){var D=this.tree.getSelectedItems();return c.map(D,d.hitch(this,function(I){return this.getHandledItem(I)}))},getAllItems:function(){var D=this.tree.getAllItems(),I=[];c.forEach(D,
d.hitch(this,function(M){"root"!==M.id&&(M=this.getHandledItem(M),I.push(M))}));return I},getHandledItem:function(D){return{name:D.name,layerInfo:D.layerInfo}},_isLeafItem:function(D){return D.isLeaf},setCreateMapResponse:function(D){this.createMapResponse=D;L.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(d.hitch(this,function(I){this.layerInfosObj=I;this.own(F(this.layerInfosObj,"layerInfosChanged",d.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&
this.own(F(this.layerInfosObj,"layerInfosIsShowInMapChanged",d.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(D,I){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(D){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(D){this._clear();f.setStyle(this.errorTipSection,"display","block");var I=[];this.onlyShowWebMapLayers?(I=D.getLayerInfoArrayOfWebmap(),
I=I.concat(D.getTableInfoArrayOfWebmap())):(I=D.getLayerInfoArray(),I=I.concat(D.getTableInfoArray()));0!==I.length&&(f.setStyle(this.errorTipSection,"display","none"),c.forEach(I,d.hitch(this,function(M){this._addDirectLayerInfo(M)})))},_addDirectLayerInfo:function(D){D&&D.getLayerObject().then(d.hitch(this,function(){this._addItem("root",D)}),d.hitch(this,function(I){console.error(I)}))},_clear:function(){var D=this._store.query({parent:"root"});c.forEach(D,d.hitch(this,function(I){I&&"root"!==
I.id&&this._store.remove(I.id)}))},_addItem:function(D,I){var M=null,T=I.getLayerType(),ba=this.filter(I);g({layerType:T,valid:ba}).then(d.hitch(this,function(E){if(E.valid){var ka=d.hitch(this,function(ra,Ma){this._id++;M={name:I.title||"",parent:D,layerInfo:I,type:E.layerType,layerClass:I.layerObject.declaredClass,id:this._id.toString(),isLeaf:ra,hasChildren:Ma};this._store.add(M)}),U=I.getSubLayers(),da=0===U.length,Z=!0;this.onlyFilterCurrentLayerWhenAddItem?(da&&(Z=!1),ka(da,Z)):da?ka(da,!1):
(U=c.map(U,d.hitch(this,function(ra){return this.filter(ra)})),g(U).then(d.hitch(this,function(ra){(ra=c.some(ra,function(Ma){return Ma}))&&ka(da,ra)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var D=this._getRootItem();D=new z({data:[D],getChildren:function(I){return this.query({parent:I.id})}});this._store=new y(D);D=new m({store:this._store,query:{id:"root"},mayHaveChildren:d.hitch(this,this._mayHaveChildren)});
this.tree=new G({multiple:this.multiple,model:D,showRoot:!1,isLeafItem:d.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:d.hitch(this,function(I,M){"root"!==I.id&&this._onTreeOpen(I,M)}),onClick:d.hitch(this,function(I,M,T){this._onTreeClick(I,M,T);this.emit("tree-click",I,M,T)}),getIconStyle:d.hitch(this,function(I,M){var T=null;if(!I||"root"===I.id)return null;var ba={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},E=window.location.protocol+
"//"+window.location.host+require.toUrl("jimu");if(I=this._getIconInfo(I,M).imageName)ba.backgroundImage="url("+E+"/css/images/"+I+")",T=ba;return T}),getIconClass:d.hitch(this,function(I,M){return this._getIconInfo(I,M).className}),getTooltip:d.hitch(this,function(I){return this.displayTooltipForTreeNode?I.layerInfo.title:""})});f.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(D){return D.hasChildren},_getIconInfo:function(D,
I){var M="",T="";"ArcGISDynamicMapServiceLayer"===D.type||"ArcGISTiledMapServiceLayer"===D.type?I?(M="mapserver_open.png",T="mapservice-layer-icon open"):(M="mapserver_close.png",T="mapservice-layer-icon close"):"GroupLayer"===D.type?I?(M="group_layer2.png",T="group-layer-icon open"):(M="group_layer1.png",T="group-layer-icon close"):"FeatureLayer"===D.type?(D=w.getTypeByGeometryType(D.layerInfo.layerObject.geometryType),"point"===D?(M="point_layer1.png",T="point-layer-icon"):"polyline"===D?(M="line_layer1.png",
T="line-layer-icon"):"polygon"===D&&(M="polygon_layer1.png",T="polygon-layer-icon")):"Table"===D.type?(M="table.png",T="table-icon"):"ArcGISImageServiceLayer"===D.type||"ArcGISImageServiceVectorLayer"===D.type?(M="image_layer.png",T="iamge-layer-icon"):I?(M="mapserver_open.png",T="mapservice-layer-icon open"):(M="mapserver_close.png",T="mapservice-layer-icon close");return{imageName:M,className:T}},_onTreeOpen:function(D,I){if("root"!==D.id){var M=[];I=[];M=D.layerInfo.getSubLayers();D.checked||(this.shelter.show(),
I=c.map(M,d.hitch(this,function(T){return T.getLayerObject()})),g(I).then(d.hitch(this,function(){this.domNode&&(c.forEach(M,d.hitch(this,function(T){this._addItem(D.id,T)})),D.checked=!0,this.shelter.hide())}),d.hitch(this,function(T){console.error(T);this.shelter.hide()})))}},_onTreeClick:function(D,I,M){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});O.createFilterByLayerType=function(D){d.isArrayLike(D)||
(D=[]);return function(I){var M=new C;if(0===D.length)M.resolve(!0);else{var T=[];I.traversal(function(ba){T.push(ba.getLayerType())});g(T).then(function(ba){for(var E=0;E<ba.length;E++)for(var ka=0;ka<D.length;ka++)if(ba[E]===D[ka]){M.resolve(!0);return}M.resolve(!1)},function(ba){console.error(ba);M.reject(ba)})}return M}};O.createFeaturelayerFilter=function(D,I,M,T){var ba=["point","polyline","polygon"];D&&0<D.length?(D=c.filter(D,function(E){return 0<=ba.indexOf(E)}),0===D.length&&(D=ba)):D=ba;
return function(E){var ka=E.getLayerType();E=E.getLayerObject();return g({layerType:ka,layerObject:E}).then(function(U){var da=U.layerType;U=U.layerObject;if("ArcGISDynamicMapServiceLayer"===da||"ArcGISTiledMapServiceLayer"===da||"GroupLayer"===da||"FeatureCollection"===da)return!0;if("FeatureLayer"===da){da=w.getTypeByGeometryType(U.geometryType);da=0<=c.indexOf(D,da);var Z=O._shouldPassStatisticsCheck(T,U);return U.url?(U=w.isFeaturelayerUrlSupportQuery(U.url,U.capabilities),da&&U&&Z):I&&da}return"Table"===
da?(da=w.isFeaturelayerUrlSupportQuery(U.url,U.capabilities),U=O._shouldPassStatisticsCheck(T,U),M&&da&&U):!1})}};O.createImageServiceLayerFilter=function(D,I){return function(M){var T=M.getLayerType();M=M.getLayerObject();return g({layerType:T,layerObject:M}).then(function(ba){var E=ba.layerType,ka=ba.layerObject;return"ArcGISImageServiceLayer"===E||"ArcGISImageServiceVectorLayer"===E?D?w.isImageServiceSupportQuery(ba.layerObject.capabilities)?I?O._shouldPassStatisticsCheck(I,ka):!0:!1:!0:!1})}};
O._shouldPassStatisticsCheck=function(D,I){return D?(D=!1,D=I.advancedQueryCapabilities?!!I.advancedQueryCapabilities.supportsStatistics:!!I.supportsStatistics):!0};O.createQueryableLayerFilter=function(D){var I=O.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,D);D=O.createImageServiceLayerFilter(!0,D);return O.orCombineFilters([I,D])};O.andCombineFilters=function(D){return O._combineFilters(D,!0)};O.orCombineFilters=function(D){return O._combineFilters(D,!1)};O._combineFilters=function(D,
I){return function(M){var T=new C,ba=c.map(D,function(E){return E(M)});g(ba).then(function(E){var ka=!1;ka=I?c.every(E,function(U){return U}):c.some(E,function(U){return U});T.resolve(ka)},function(E){console.error(E);T.reject(E)});return T}};return O})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(F,B,v,x,u,p,z){return v("dijit.tree.ObjectStoreModel",z,{store:null,labelAttr:"name",
labelType:"text",root:null,query:null,constructor:function(C){u.mixin(this,C);this.childrenCache={}},getRoot:function(C,y){if(this.root)C(this.root);else{var m=this.store.query(this.query);m.then&&this.own(m);p(m,u.hitch(this,function(g){if(1!=g.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+g.length+" items, but must return exactly one");this.root=g[0];C(this.root);m.observe&&m.observe(u.hitch(this,function(d){this.onChange(d)}),!0)}),y)}},mayHaveChildren:function(){return!0},
getChildren:function(C,y,m){var g=this.store.getIdentity(C);if(this.childrenCache[g])p(this.childrenCache[g],y,m);else{var d=this.childrenCache[g]=this.store.getChildren(C);d.then&&this.own(d);d.observe&&this.own(d.observe(u.hitch(this,function(f,c,w){this.onChange(f);c!=w&&p(d,u.hitch(this,"onChildrenChange",C))}),!0));p(d,y,m)}},isItem:function(){return!0},getIdentity:function(C){return this.store.getIdentity(C)},getLabel:function(C){return C[this.labelAttr]},newItem:function(C,y,m,g){return this.store.put(C,
{parent:y,before:g})},pasteItem:function(C,y,m,g,d,f){var c=new x;if(y===m&&!g&&!f)return c.resolve(!0),c;y&&!g?this.getChildren(y,u.hitch(this,function(w){w=[].concat(w);var G=F.indexOf(w,C);w.splice(G,1);this.onChildrenChange(y,w);c.resolve(this.store.put(C,{overwrite:!0,parent:m,oldParent:y,before:f,isCopy:!1}))})):c.resolve(this.store.put(C,{overwrite:!0,parent:m,oldParent:y,before:f,isCopy:!0}));return c},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(F,B,v,x,u,p,z,C,y,m,g,d,f,c,w,G){var L=F([w._TreeNode,f],{templateString:x,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=p.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=p.toDom('\x3cinput type\x3d"checkbox" /\x3e');p.addClass(this.checkNode,"jimu-tree-check-node");p.place(this.checkNode,this.contentNode,
"first");this.own(g(this.checkNode,"click",u.hitch(this,this._onClick)));this.own(g(this.rowNode,"keydown",u.hitch(this,function(A,O){O.target=A;O.keyCode!==d.ENTER&&O.keyCode!==d.SPACE||this._onClick(O)},this.checkNode)));this.isLeaf?this.groupId?p.setStyle(this.checkNode,"display","none"):p.setStyle(this.checkNode,"display","inline"):p.setStyle(this.checkNode,"display","none");this.isLeaf?p.addClass(this.domNode,"jimu-tree-leaf-node"):p.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,p.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,p.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(A){(A.target||A.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,A):this.tree._onClick(this,A)},_onChange:function(){this.isLeaf&&setTimeout(u.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return F([w,f],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+G.getRandomString()},postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-tree");this.own(m.before(this,"onClick",u.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&p.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;p.setAttr(this.domNode,"tabindex",0)},removeItem:function(A){this.model.store.remove(A)},getAllItems:function(){var A=this.getAllTreeNodeWidgets();return z.map(A,u.hitch(this,function(O){var D=O.item;D.selected=O.checkNode.checked;return D}))},getSelectedItems:function(){var A=this.getAllTreeNodeWidgets();A=z.filter(A,u.hitch(this,function(O){return O.checkNode.checked}));return z.map(A,
u.hitch(this,function(O){return O.item}))},getFilteredItems:function(A){var O=this.getAllTreeNodeWidgets();O=z.map(O,u.hitch(this,function(D){var I=D.item;I.selected=D.checkNode.checked;return I}));return z.filter(O,u.hitch(this,function(D){return A(D)}))},getTreeNodeByItemId:function(A){for(var O=this._getAllTreeNodeDoms(),D=0;D<O.length;D++){var I=c.byNode(O[D]);if(I.item.id.toString()===A.toString())return I}return null},selectItem:function(A){(A=this.getTreeNodeByItemId(A))&&A.isLeaf&&this.selectNodeWidget(A)},
unselectItem:function(A){(A=this.getTreeNodeByItemId(A))&&A.isLeaf&&A.unselect()},getAllLeafTreeNodeWidgets:function(){var A=this.getAllTreeNodeWidgets();return z.filter(A,u.hitch(this,function(O){return O.isLeaf}))},getAllTreeNodeWidgets:function(){var A=this._getAllTreeNodeDoms();return z.map(A,u.hitch(this,function(O){return c.byNode(O)}))},isLeafItem:function(A){return A&&A.isLeaf},_getAllTreeNodeDoms:function(){return y(".dijitTreeNode",this.domNode)},_createTreeNode:function(A){A.isLeaf=this.isLeafItem(A.item);
this.multiple||(A.groupId=this.uniqueId);return new L(A)},_onTreeNodeSelect:function(A){this.emit("item-select",{item:A.item,treeNode:A})},_onTreeNodeUnselect:function(A){this.emit("item-unselect",{item:A.item,treeNode:A})},selectNodeWidget:function(A){this.multiple||this.unselectAllLeafNodeWidgets();A.select()},_jimuBeforeClick:function(A,O,D){O.isLeaf&&(p.hasClass(D.target||D.srcElement,"jimu-tree-check-node")||(this.multiple?O.toggleSelect():this.selectNodeWidget(O)));return arguments},_onCheckNodeClick:function(A,
O,D){!this.multiple&&O&&this.unselectAllLeafNodeWidgets();C.stop(D);this.focusNode(A);setTimeout(u.hitch(this,function(){O?this.selectNodeWidget(A):A.unselect();this.onClick(A.item,A,D)}),0)},unselectAllLeafNodeWidgets:function(){var A=this.getAllLeafTreeNodeWidgets();z.forEach(A,u.hitch(this,function(O){O.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(F,B,v,x,u,p,z,C,y,m,g,d,f,c,w,G,L,A,O,D,I,M,T,ba,E,ka,U,da,Z,ra,Ma,Ra,Wa,$a,ua){function oa(l){return G.delegate(l.promise||l,{addCallback:function(r){this.then(r)},addErrback:function(r){this.otherwise(r)}})}var Fa=x("dijit._TreeNode",[E,ka,U,da,Z],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(l){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=l;this._set("label",l);f("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:Ma,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(l){var r=Math.max(l,0)*this.tree._nodePixelIndent+"px";m.set(this.domNode,
"backgroundPosition",r+" 0px");m.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",r);F.forEach(this.getChildren(),function(S){S.set("indent",l+1)});this._set("indent",l)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(l){var r=this.tree,S=r.model;r._v10Compat&&l===S.root&&(l=null);this._applyClassAndStyle(l,"icon","Icon");this._applyClassAndStyle(l,"label","Label");this._applyClassAndStyle(l,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(l,r,S){var V="_"+r+"Class";r+="Node";var ca=this[V];this[V]=this.tree["get"+S+"Class"](l,this.isExpanded);C.replace(this[r],this[V]||"",ca||"");m.set(this[r],this.tree["get"+S+"Style"](l,this.isExpanded)||{})},_updateLayout:function(){var l=this.getParent();l=!l||!l.rowNode||"none"==l.rowNode.style.display;C.toggle(this.domNode,"dijitTreeIsRoot",l);C.toggle(this.domNode,"dijitTreeIsLast",!l&&!this.getNextSibling())},_setExpando:function(l){var r=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];l=l?0:this.isExpandable?this.isExpanded?1:2:3;C.replace(this.expandoNode,r[l],r);this.expandoNodeText.innerHTML=["*","-","+","*"][l]},expand:function(){if(this._expandDeferred)return oa(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");C.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var l=d.wipeIn({node:this.containerNode,duration:ba.defaultDuration}),r=this._expandDeferred=new u(function(){l.stop()});B.after(l,"onEnd",function(){r.resolve(!0)},!0);l.play();return oa(r)},collapse:function(){if(this._collapseDeferred)return oa(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");C.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var l=d.wipeOut({node:this.containerNode,duration:ba.defaultDuration}),r=this._collapseDeferred=new u(function(){l.stop()});B.after(l,"onEnd",
function(){r.resolve(!0)},!0);l.play();return oa(r)},indent:0,setChildItems:function(l){var r=this.tree,S=r.model,V=[],ca=r.focusedChild,Ga=this.getChildren();F.forEach(Ga,function(ma){U.prototype.removeChild.call(this,ma)},this);this.defer(function(){F.forEach(Ga,function(ma){if(!ma._destroyed&&!ma.getParent()){r.dndController.removeTreeNode(ma);(function e(a){var h=S.getIdentity(a.item),k=r._itemNodesMap[h];1==k.length?delete r._itemNodesMap[h]:(h=F.indexOf(k,a),-1!=h&&k.splice(h,1));F.forEach(a.getChildren(),
e)})(ma);if(r.persist){var ya=F.map(ma.getTreePath(),function(a){return r.model.getIdentity(a)}).join("/"),ta;for(ta in r._openedNodes)ta.substr(0,ya.length)==ya&&delete r._openedNodes[ta];r._saveExpandedNodes()}r.lastFocusedChild&&!z.isDescendant(r.lastFocusedChild.domNode,r.domNode)&&delete r.lastFocusedChild;ca&&!z.isDescendant(ca.domNode,r.domNode)&&r.focus();ma.destroyRecursive()}})});this.state="Loaded";l&&0<l.length?(this.isExpandable=!0,F.forEach(l,function(ma){var ya=S.getIdentity(ma),ta=
r._itemNodesMap[ya];if(ta)for(var za=0;za<ta.length;za++)if(ta[za]&&!ta[za].getParent()){var a=ta[za];a.set("indent",this.indent+1);break}a||(a=this.tree._createTreeNode({item:ma,tree:r,isExpandable:S.mayHaveChildren(ma),label:r.getLabel(ma),labelType:r.model&&r.model.labelType||"text",tooltip:r.getTooltip(ma),ownerDocument:r.ownerDocument,dir:r.dir,lang:r.lang,textDir:r.textDir,indent:this.indent+1}),ta?ta.push(a):r._itemNodesMap[ya]=[a]);this.addChild(a);(this.tree.autoExpand||this.tree._state(a))&&
V.push(r._expandNode(a))},this),F.forEach(this.getChildren(),function(ma){ma._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);l=p(V);this.tree._startPaint(l);return oa(l)},getTreePath:function(){for(var l=this,r=[];l&&l!==this.tree.rootNode;)r.unshift(l.item),l=l.getParent();r.unshift(this.tree.rootNode.item);return r},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(l){this.inherited(arguments);
var r=this.getChildren();0==r.length&&(this.isExpandable=!1,this.collapse());F.forEach(r,function(S){S._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(l){this.labelNode.setAttribute("aria-selected",l?"true":"false");C.toggle(this.rowNode,"dijitTreeRowSelected",l)},focus:function(){M.focus(this.focusNode)}});f("dojo-bidi")&&Fa.extend({_setTextDirAttr:function(l){!l||this.textDir==l&&this._created||(this._set("textDir",l),this.applyTextDir(this.labelNode),
F.forEach(this.getChildren(),function(r){r.set("textDir",l)},this))}});var qa=x("dijit.Tree",[E,ra,ka,Z],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:Ra,persist:!1,autoExpand:!1,dndController:ua,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,
onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(l,r){A.publish(this.id,G.mixin({tree:this,event:l},r||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new u;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();
var l=this;this.own(L(this.containerNode,L.selector(".dijitTreeNode",O.enter),function(V){l._onNodeMouseEnter(T.byNode(this),V)}),L(this.containerNode,L.selector(".dijitTreeNode",O.leave),function(V){l._onNodeMouseLeave(T.byNode(this),V)}),L(this.containerNode,L.selector(".dijitTreeRow",I.press),function(V){l._onNodePress(T.getEnclosingWidget(this),V)}),L(this.containerNode,L.selector(".dijitTreeRow",I),function(V){l._onClick(T.getEnclosingWidget(this),V)}),L(this.containerNode,L.selector(".dijitTreeRow",
"dblclick"),function(V){l._onDblClick(T.getEnclosingWidget(this),V)}));this.model||this._store2model();this.own(B.after(this.model,"onChange",G.hitch(this,"_onItemChange"),!0),B.after(this.model,"onChildrenChange",G.hitch(this,"_onItemChildrenChange"),!0),B.after(this.model,"onDelete",G.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){G.isString(this.dndController)&&(this.dndController=G.getObject(this.dndController));for(var r={},S=0;S<this.dndParams.length;S++)this[this.dndParams[S]]&&
(r[this.dndParams[S]]=this[this.dndParams[S]]);this.dndController=new this.dndController(this,r)}this._load();this.onLoadDeferred=oa(this.pendingCommandsPromise);this.onLoadDeferred.then(G.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;c.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var l={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(l.mayHaveChildren=
G.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&(l.getChildren=G.hitch(this,function(r,S,V){this.getItemChildren(this._v10Compat&&r===this.model.root?null:r,S,V)}));this.model=new $a(l);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(G.hitch(this,function(l){var r=this.rootNode=this.tree._createTreeNode({item:l,tree:this,isExpandable:!0,label:this.label||this.getLabel(l),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?
0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(r.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(r.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(r.containerNode.setAttribute("aria-labelledby",
this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),r.labelNode.setAttribute("role","presentation"),r.labelNode.removeAttribute("aria-selected"),r.containerNode.setAttribute("role","tree"),r.containerNode.setAttribute("aria-expanded","true"),r.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(r.domNode);l=this.model.getIdentity(l);this._itemNodesMap[l]?this._itemNodesMap[l].push(r):this._itemNodesMap[l]=[r];r._updateLayout();
this._expandNode(r).then(G.hitch(this,function(){this._destroyed||(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),G.hitch(this,function(l){console.error(this,": error loading root: ",l)}))},getNodesByItem:function(l){if(!l)return[];l=G.isString(l)?l:this.model.getIdentity(l);return[].concat(this._itemNodesMap[l])},_setSelectedItemAttr:function(l){this.set("selectedItems",[l])},_setSelectedItemsAttr:function(l){var r=this;return this.pendingCommandsPromise=
this.pendingCommandsPromise.always(G.hitch(this,function(){var S=F.map(l,function(ca){return!ca||G.isString(ca)?ca:r.model.getIdentity(ca)}),V=[];F.forEach(S,function(ca){V=V.concat(r._itemNodesMap[ca]||[])});this.set("selectedNodes",V)}))},_setPathAttr:function(l){return l.length?oa(this.set("paths",[l]).then(function(r){return r[0]})):oa(this.set("paths",[]).then(function(r){return r[0]}))},_setPathsAttr:function(l){function r(V,ca){var Ga=V.shift(),ma=F.filter(ca,function(ya){return ya.getIdentity()==
Ga})[0];if(ma)return V.length?S._expandNode(ma).then(function(){return r(V,ma.getChildren())}):ma;throw new qa.PathError("Could not expand path at "+Ga);}var S=this;return oa(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return p(F.map(l,function(V){V=F.map(V,function(ca){return ca&&G.isObject(ca)?S.model.getIdentity(ca):ca});if(V.length)return r(V,[S.rootNode]);throw new qa.PathError("Empty path");}))}).then(function(V){S.set("selectedNodes",V);return S.paths}))},_setSelectedNodeAttr:function(l){this.set("selectedNodes",
[l])},_setSelectedNodesAttr:function(l){this.dndController.setSelection(l)},expandAll:function(){function l(S){return r._expandNode(S).then(function(){var V=F.filter(S.getChildren()||[],function(ca){return ca.isExpandable});return p(F.map(V,l))})}var r=this;return oa(l(this.rootNode))},collapseAll:function(){function l(S){var V=F.filter(S.getChildren()||[],function(ca){return ca.isExpandable});V=p(F.map(V,l));return!S.isExpanded||S==r.rootNode&&!r.showRoot?V:V.then(function(){return r._collapseNode(S)})}
var r=this;return oa(l(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(l){return this.model.getLabel(l)},getIconClass:function(l,r){return!l||this.model.mayHaveChildren(l)?r?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(l,r){(l=this._getNext(r))&&l.isTreeNode&&this.focusNode(l)},
_onUpArrow:function(l,r){if(l=r.getPreviousSibling())for(r=l;r.isExpandable&&r.isExpanded&&r.hasChildren();)r=r.getChildren(),r=r[r.length-1];else if(l=r.getParent(),this.showRoot||l!==this.rootNode)r=l;r&&r.isTreeNode&&this.focusNode(r)},_onRightArrow:function(l,r){r.isExpandable&&!r.isExpanded?this._expandNode(r):r.hasChildren()&&(r=r.getChildren()[0])&&r.isTreeNode&&this.focusNode(r)},_onLeftArrow:function(l,r){r.isExpandable&&r.isExpanded?this._collapseNode(r):(l=r.getParent())&&l.isTreeNode&&
(this.showRoot||l!==this.rootNode)&&this.focusNode(l)},focusLastChild:function(){var l=this._getLast();l&&l.isTreeNode&&this.focusNode(l)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var l=this.rootNode;l.isExpanded;){var r=l.getChildren();if(!r.length)break;l=r[r.length-1]}return l},_getNext:function(l){if(l.isExpandable&&l.isExpanded&&l.hasChildren())return l.getChildren()[0];for(;l&&l.isTreeNode;){var r=l.getNextSibling();if(r)return r;
l=l.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(l,r){return z.isDescendant(l,r.expandoNode)||z.isDescendant(l,r.expandoNodeText)},_onNodePress:function(l,r){this.focusNode(l)},__click:function(l,r,S,V){var ca=this.isExpandoNode(r.target,l);l.isExpandable&&(S||ca)?this._onExpandoClick({node:l}):(this._publish("execute",{item:l.item,node:l,evt:r}),this[V](l.item,l,r),this.focusNode(l));r.stopPropagation();r.preventDefault()},_onClick:function(l,r){this.__click(l,r,
this.openOnClick,"onClick")},_onDblClick:function(l,r){this.__click(l,r,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(l){l=l.node;this.focusNode(l);l.isExpanded?this._collapseNode(l):this._expandNode(l)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(l){c.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(l)},_getRootOrFirstNode:function(){c.deprecated(this.declaredClass+
"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(l){l._expandNodeDeferred&&delete l._expandNodeDeferred;if("Loading"!=l.state&&l.isExpanded){var r=l.collapse();this.onClose(l.item,l);this._state(l,!1);this._startPaint(r);return r}},_expandNode:function(l){if(l._expandNodeDeferred)return l._expandNodeDeferred;var r=this.model,S=l.item,V=this;l._loadDeferred||(l.markProcessing(),l._loadDeferred=new u,r.getChildren(S,function(ca){l.unmarkProcessing();
l.setChildItems(ca).then(function(){l._loadDeferred.resolve(ca)})},function(ca){console.error(V,": error loading "+l.label+" children: ",ca);l._loadDeferred.reject(ca)}));r=l._loadDeferred.then(G.hitch(this,function(){var ca=l.expand();this.onOpen(l.item,l);this._state(l,!0);return ca}));this._startPaint(r);return r},focusNode:function(l){for(var r=[],S=this.domNode;S&&S.tagName&&"IFRAME"!==S.tagName.toUpperCase();S=S.parentNode)r.push({domNode:S.contentWindow||S,scrollLeft:S.scrollLeft||0,scrollTop:S.scrollTop||
0});this.focusChild(l);this.defer(function(){for(var V=0,ca=r.length;V<ca;V++)r[V].domNode.scrollLeft=r[V].scrollLeft,r[V].domNode.scrollTop=r[V].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(l){var r=this.model.getIdentity(l);if(r=this._itemNodesMap[r]){var S=this.getLabel(l),V=this.getTooltip(l);F.forEach(r,function(ca){ca.set({item:l,label:S,tooltip:V});ca._updateItemClasses(l)})}},_onItemChildrenChange:function(l,r){l=this.model.getIdentity(l);
(l=this._itemNodesMap[l])&&F.forEach(l,function(S){S.setChildItems(r)})},_onItemDelete:function(l){l=this.model.getIdentity(l);var r=this._itemNodesMap[l];r&&(F.forEach(r,function(S){this.dndController.removeTreeNode(S);var V=S.getParent();V&&V.removeChild(S);this.lastFocusedChild&&!z.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!z.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();S.destroyRecursive()},this),delete this._itemNodesMap[l])},
_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var l=v(this.cookieName);l&&F.forEach(l.split(","),function(r){this._openedNodes[r]=!0},this)}},_state:function(l,r){if(!this.persist)return!1;var S=F.map(l.getTreePath(),function(V){return this.model.getIdentity(V)},this).join("/");if(1===arguments.length)return this._openedNodes[S];r?this._openedNodes[S]=!0:delete this._openedNodes[S];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var l=
[],r;for(r in this._openedNodes)l.push(r);v(this.cookieName,l.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!G.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(l){l&&y.setMarginBox(this.domNode,l);this._nodePixelIndent=y.position(this.tree.indentDetector).w||
this._nodePixelIndent;this.expandChildrenDeferred.then(G.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(l){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var r=G.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});
D(l,r,r)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(l){return new Fa(l)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});f("dojo-bidi")&&qa.extend({_setTextDirAttr:function(l){l&&this.textDir!=l&&(this._set("textDir",
l),this.rootNode.set("textDir",l))}});qa.PathError=g("TreePathError");qa._TreeNode=Fa;return qa})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(F,B,v,x){return v("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(u){x.mixin(this,u);this.connects=[];u=this.store;if(!u.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");
u.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([B.after(u,"onNew",x.hitch(this,"onNewItem"),!0),B.after(u,"onDelete",x.hitch(this,"onDeleteItem"),!0),B.after(u,"onSet",x.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var u;u=this.connects.pop();)u.remove()},getRoot:function(u,p){this.root?u(this.root):this.store.fetch({query:this.query,onComplete:x.hitch(this,function(z){if(1!=z.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+z.length+
" items, but must return exactly one");this.root=z[0];u(this.root)}),onError:p})},mayHaveChildren:function(u){return F.some(this.childrenAttrs,function(p){return this.store.hasAttribute(u,p)},this)},getChildren:function(u,p,z){var C=this.store;if(C.isItemLoaded(u)){for(var y=[],m=0;m<this.childrenAttrs.length;m++){var g=C.getValues(u,this.childrenAttrs[m]);y=y.concat(g)}var d=0;this.deferItemLoadingUntilExpand||F.forEach(y,function(c){C.isItemLoaded(c)||d++});0==d?p(y):F.forEach(y,function(c,w){C.isItemLoaded(c)||
C.loadItem({item:c,onItem:function(G){y[w]=G;0==--d&&p(y)},onError:z})})}else{var f=x.hitch(this,arguments.callee);C.loadItem({item:u,onItem:function(c){f(c,p,z)},onError:z})}},isItem:function(u){return this.store.isItem(u)},fetchItemByIdentity:function(u){this.store.fetchItemByIdentity(u)},getIdentity:function(u){return this.store.getIdentity(u)},getLabel:function(u){return this.labelAttr?this.store.getValue(u,this.labelAttr):this.store.getLabel(u)},newItem:function(u,p,z){var C={parent:p,attribute:this.childrenAttrs[0]},
y;this.newItemIdAttr&&u[this.newItemIdAttr]?this.fetchItemByIdentity({identity:u[this.newItemIdAttr],scope:this,onItem:function(m){m?this.pasteItem(m,null,p,!0,z):(y=this.store.newItem(u,C))&&void 0!=z&&this.pasteItem(y,p,p,!1,z)}}):(y=this.store.newItem(u,C))&&void 0!=z&&this.pasteItem(y,p,p,!1,z)},pasteItem:function(u,p,z,C,y){var m=this.store,g=this.childrenAttrs[0];p&&F.forEach(this.childrenAttrs,function(f){if(m.containsValue(p,f,u)){if(!C){var c=F.filter(m.getValues(p,f),function(w){return w!=
u});m.setValues(p,f,c)}g=f}});if(z)if("number"==typeof y){var d=m.getValues(z,g).slice();d.splice(y,0,u);m.setValues(z,g,d)}else m.setValues(z,g,m.getValues(z,g).concat(u))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(u,p){p&&this.getChildren(p.item,x.hitch(this,function(z){this.onChildrenChange(p.item,z)}))},onDeleteItem:function(u){this.onDelete(u)},onSetItem:function(u,p){if(-1!=F.indexOf(this.childrenAttrs,p))this.getChildren(u,x.hitch(this,function(z){this.onChildrenChange(u,
z)}));else this.onChange(u)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(F,B,v,x,u){return B("dijit.tree.ForestStoreModel",u,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(p){this.root={store:this,root:!0,id:p.rootId,label:p.rootLabel,children:p.rootChildren}},mayHaveChildren:function(p){return p===this.root||this.inherited(arguments)},getChildren:function(p,z,C){p===
this.root?this.root.children?z(this.root.children):this.store.fetch({query:this.query,onComplete:x.hitch(this,function(y){this.root.children=y;z(y)}),onError:C}):this.inherited(arguments)},isItem:function(p){return p===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(p){if(p.identity==this.root.id){var z=p.scope||v.global;p.onItem&&p.onItem.call(z,this.root)}else this.inherited(arguments)},getIdentity:function(p){return p===this.root?this.root.id:this.inherited(arguments)},getLabel:function(p){return p===
this.root?this.root.label:this.inherited(arguments)},newItem:function(p,z,C){return z===this.root?(this.onNewRootItem(p),this.store.newItem(p)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(p,z,C,y,m){if(z===this.root&&!y)this.onLeaveRoot(p);this.inherited(arguments,[p,z===this.root?null:z,C===this.root?null:C,y,m]);if(C===this.root)this.onAddToRoot(p)},onAddToRoot:function(p){console.log(this,": item ",p," added to root")},onLeaveRoot:function(p){console.log(this,": item ",
p," removed from root")},_requeryTop:function(){var p=this.root.children||[];this.store.fetch({query:this.query,onComplete:x.hitch(this,function(z){this.root.children=z;if(p.length!=z.length||F.some(p,function(C,y){return z[y]!=C}))this.onChildrenChange(this.root,z)})})},onNewItem:function(p,z){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(p){-1!=F.indexOf(this.root.children,p)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(p,z,C,y){this._requeryTop();this.inherited(arguments)}})})},
"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(F,B,v,x,u,p,z,C,y,m,g){return B("dijit.tree._dndSelector",g,{constructor:function(){this.selection={};this.anchor=null;this.events.push(C(this.tree.domNode,y.press,x.hitch(this,"onMouseDown")),C(this.tree.domNode,y.release,x.hitch(this,"onMouseUp")),C(this.tree.domNode,y.move,x.hitch(this,
"onMouseMove")),C(this.tree.domNode,m.press,x.hitch(this,"onClickPress")),C(this.tree.domNode,m.release,x.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var d=[],f=this.selection,c;for(c in f)d.push(f[c]);return d},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(d,f){this.setSelection(this.getSelectedTreeNodes().concat([d]));f&&(this.anchor=d);return d},removeTreeNode:function(d){var f=
F.filter(this.getSelectedTreeNodes(),function(c){return!p.isDescendant(c.domNode,d.domNode)});this.setSelection(f);return d},isTreeNodeSelected:function(d){return d.id&&!!this.selection[d.id]},setSelection:function(d){var f=this.getSelectedTreeNodes();F.forEach(this._setDifference(f,d),x.hitch(this,function(c){c.setSelected(!1);this.anchor==c&&delete this.anchor;delete this.selection[c.id]}));F.forEach(this._setDifference(d,f),x.hitch(this,function(c){c.setSelected(!0);this.selection[c.id]=c}));this._updateSelectionProperties()},
_setDifference:function(d,f){F.forEach(f,function(c){c.__exclude__=!0});d=F.filter(d,function(c){return!c.__exclude__});F.forEach(f,function(c){delete c.__exclude__});return d},_updateSelectionProperties:function(){var d=this.getSelectedTreeNodes(),f=[],c=[];F.forEach(d,function(w){var G=w.getTreePath();c.push(w);f.push(G)},this);d=F.map(c,function(w){return w.item});this.tree._set("paths",f);this.tree._set("path",f[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);
this.tree._set("selectedItems",d);this.tree._set("selectedItem",d[0]||null)},onClickPress:function(d){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(d.target,this.current))){"mousedown"==d.type&&z.isLeft(d)&&d.preventDefault();var f="keydown"==d.type?this.tree.focusedChild:this.current;if(f){var c=u.getCopyKeyState(d),w=f.id;this.singular||d.shiftKey||!this.selection[w]?(this._doDeselect=!1,this.userSelect(f,c,d.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(d){this._doDeselect&&
(this._doDeselect=!1,this.userSelect("keyup"==d.type?this.tree.focusedChild:this.current,u.getCopyKeyState(d),d.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(d,f){if(d===f)return 0;if("sourceIndex"in document.documentElement)return d.sourceIndex-f.sourceIndex;if("compareDocumentPosition"in document.documentElement)return d.compareDocumentPosition(f)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(d);
d=doc.createRange();d.setStartBefore(f);return c.compareBoundaryPoints(c.END_TO_END,d)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(d,f,c){if(this.singular)this.anchor==d&&f?this.selectNone():(this.setSelection([d]),this.anchor=d);else if(c&&this.anchor){f=this._compareNodes(this.anchor.rowNode,d.rowNode);c=this.anchor;0>f?f=c:(f=d,d=c);for(c=[];f!=d;)c.push(f),f=this.tree._getNext(f);c.push(d);this.setSelection(c)}else this.selection[d.id]&&
f?this.removeTreeNode(d):f?this.addTreeNode(d,!0):(this.setSelection([d]),this.anchor=d)},getItem:function(d){return{data:this.selection[d],type:["treeNode"]}},forInSelectedItems:function(d,f){f=f||v.global;for(var c in this.selection)d.call(f,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(F,B,v,x,u,p){return B("dijit.tree._dndContainer",null,{constructor:function(z,C){this.tree=
z;this.node=z.domNode;x.mixin(this,C);this.containerState="";v.add(this.node,"dojoDndContainer");this.events=[u(this.node,p.enter,x.hitch(this,"onOverEvent")),u(this.node,p.leave,x.hitch(this,"onOutEvent")),F.after(this.tree,"_onNodeMouseEnter",x.hitch(this,"onMouseOver"),!0),F.after(this.tree,"_onNodeMouseLeave",x.hitch(this,"onMouseOut"),!0),u(this.node,"dragstart, selectstart",function(y){y.preventDefault()})]},destroy:function(){for(var z;z=this.events.pop();)z.remove();this.node=this.parent=
null},onMouseOver:function(z){this.current=z},onMouseOut:function(){this.current=null},_changeState:function(z,C){var y="dojoDnd"+z;z=z.toLowerCase()+"State";v.replace(this.node,y+C,y+this[z]);this[z]=C},_addItemClass:function(z,C){v.add(z,"dojoDndItem"+C)},_removeItemClass:function(z,C){v.remove(z,"dojoDndItem"+C)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"widgets/Bookmark/setting/Import":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/utils ../utils ../ItemNode dojo/text!./Import.html libs/Sortable".split(" "),
function(F,B,v,x,u,p,z,C,y,m,g,d){return F([z,p],{baseClass:"jimu-Bookmark-Import",templateString:g,bookmarks:[],_selectedBookMarksNumber:0,postCreate:function(){this.inherited(arguments);this.sortableBookMarkerNodes=d.create(this.bookMarkerContainer,{handle:".drag-masker",sort:!1,disabled:!this._init_editing,animation:100});this.bookmarks=y.readBookmarksInWebmap(this.map);this.displayBookmarks(this.bookmarks);this.bookmarks&&0===this.bookmarks.length?v.addClass(this.bookmarksInWebmap,"hide"):v.addClass(this.noBookmark,
"hide");this.own(u(this.all,"change",B.hitch(this,function(){this._selectOrUnselectAll()})))},startup:function(){this.bookmarksInSetting&&this.bookmarksInSetting.forEach(B.hitch(this,function(f){if((f=y.findBookMarkByNameAndExtent(f,this.bookmarks))&&f.bookmark)f.bookmark.itemNode.onSelected()}))},getConfig:function(){var f=[];this.bookmarks.forEach(B.hitch(this,function(c){c.itemNode&&c.itemNode.domNode&&v.hasClass(c.itemNode.domNode,"selected")&&(delete c.itemNode,c=B.clone(c),f.push(c))}));return f},
_isSelectedAll:function(){return this.bookmarks.length===this._selectedBookMarksNumber},_selectOrUnselectAll:function(){this._isSelectedAll()?(this.bookmarks.forEach(B.hitch(this,function(f){f.itemNode&&f.itemNode.domNode&&v.hasClass(f.itemNode.domNode,"selected")&&v.removeClass(f.itemNode.domNode,"selected")})),this._selectedBookMarksNumber=0):this.bookmarks.forEach(B.hitch(this,function(f){f.itemNode&&f.itemNode.domNode&&!1===v.hasClass(f.itemNode.domNode,"selected")&&(v.addClass(f.itemNode.domNode,
"selected"),this._selectedBookMarksNumber++)}))},destroy:function(){x.forEach(this.bookmarks,function(f){f.itemNode&&f.itemNode.destroy()},this);this.bookmarks=[];this.sortableBookMarkerNodes&&(this.sortableBookMarkerNodes.destroy(),this.sortableBookMarkerNodes=null);this.inherited(arguments)},displayBookmarks:function(f){f.reverse();x.forEach(f,function(c,w){w=this._createBookMarkNode(c,w);c.itemNode=w},this);f.forEach(B.hitch(this,function(c){c.itemNode&&c.itemNode.domNode&&v.place(c.itemNode.domNode,
this.bookMarkerContainer,"first")}))},_createBookMarkNode:function(f,c){var w=f.thumbnail||"undefined"!==typeof f.thumbnail&&""!==f.thumbnail?C.processUrlInWidgetConfig(f.thumbnail,this.folderUrl):this.folderUrl+"images/thumbnail_default.png";f=new m({dataId:c,img:w,label:f.displayName||f.name,display:{selectedBtn:!0,editBtn:!1,deleteBtn:!1},nls:this.nls});this.own(u(f,"click",B.hitch(this,B.partial(this._onBookmarkClick,f))));this.own(u(f,"selected",B.hitch(this,B.partial(this._onBookmarkSelected,
f))));this.own(u(f,"unselected",B.hitch(this,B.partial(this._onBookmarkUnSelected,f))));return f},_onBookmarkClick:function(f){f.onSelected()},_onBookmarkSelected:function(){this._selectedBookMarksNumber++;this._isDisableOK()},_onBookmarkUnSelected:function(){this._selectedBookMarksNumber--;this._isDisableOK()},_isDisableOK:function(){this.popup&&(0<this._selectedBookMarksNumber?this.popup.enableButton(0):this.popup.disableButton(0),y.setCheckboxWithoutEvent(this.all,this._isSelectedAll()))}})})},
"libs/Sortable":function(){!function(F){"function"==typeof define&&define.amd?define(F):"undefined"!=typeof module&&void 0!==module.exports?module.exports=F():window.Sortable=F()}(function(){function F(b,n){if(!b||!b.nodeType||1!==b.nodeType)throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(b);this.el=b;this.options=n=O({},n);b[aa]=this;var q={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(b.nodeName)?
"\x3eli":"\x3e*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return yb(b,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(K,P){K.setData("Text",P.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:ia(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",
fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==F.supportPointer&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5},J;for(J in q)J in n||(n[J]=q[J]);for(var H in zb(n),this)"_"===H.charAt(0)&&"function"==typeof this[H]&&(this[H]=this[H].bind(this));(this.nativeDraggable=!n.forceFallback&&Lb)&&(this.options.touchStartThreshold=1);n.supportPointer?v(b,"pointerdown",this._onTapStart):(v(b,"mousedown",this._onTapStart),
v(b,"touchstart",this._onTapStart));this.nativeDraggable&&(v(b,"dragover",this),v(b,"dragenter",this));W.push(this.el);n.store&&n.store.get&&this.sort(n.store.get(this)||[])}function B(b,n,q,J){if(b){q=q||R;do{if(null!=n&&("\x3e"===n[0]&&b.parentNode===q&&L(b,n.substring(1))||L(b,n))||J&&b===q)return b;if(b===q)break}while(b=(H=b).host&&H!==R&&H.host.nodeType?H.host:H.parentNode)}var H;return null}function v(b,n,q){b.addEventListener(n,q,Ab)}function x(b,n,q){b.removeEventListener(n,q,Ab)}function u(b,
n,q){if(b&&n)if(b.classList)b.classList[q?"add":"remove"](n);else{var J=(" "+b.className+" ").replace(Q," ").replace(" "+n+" "," ");b.className=(J+(q?" "+n:"")).replace(Q," ")}}function p(b,n,q){var J=b&&b.style;if(J){if(void 0===q)return R.defaultView&&R.defaultView.getComputedStyle?q=R.defaultView.getComputedStyle(b,""):b.currentStyle&&(q=b.currentStyle),void 0===n?q:q[n];n in J||-1!==n.indexOf("webkit")||(n="-webkit-"+n);J[n]=q+("string"==typeof q?"":"px")}}function z(b){var n="";do{var q=p(b,
"transform");q&&"none"!==q&&(n=q+" "+n)}while(b=b.parentNode);return window.DOMMatrix?new DOMMatrix(n):window.WebKitCSSMatrix?new WebKitCSSMatrix(n):window.CSSMatrix?new CSSMatrix(n):void 0}function C(b,n,q){if(b){b=b.getElementsByTagName(n);n=0;var J=b.length;if(q)for(;n<J;n++)q(b[n],n);return b}return[]}function y(b,n,q,J,H,K,P,Y,X){var fa,na=(b=b||n[aa]).options,pa="on"+q.charAt(0).toUpperCase()+q.substr(1);!window.CustomEvent||Ia||db?(fa=R.createEvent("Event")).initEvent(q,!0,!0):fa=new CustomEvent(q,
{bubbles:!0,cancelable:!0});fa.to=H||n;fa.from=K||n;fa.item=J||n;fa.clone=da;fa.oldIndex=P;fa.newIndex=Y;fa.originalEvent=X;fa.pullMode=qa?qa.lastPutMode:void 0;n&&n.dispatchEvent(fa);na[pa]&&na[pa].call(b,fa)}function m(b,n,q,J,H,K,P,Y){var X,fa,na=b[aa],pa=na.options.onMove;return!window.CustomEvent||Ia||db?(X=R.createEvent("Event")).initEvent("move",!0,!0):X=new CustomEvent("move",{bubbles:!0,cancelable:!0}),X.to=n,X.from=b,X.dragged=q,X.draggedRect=J,X.related=H||n,X.relatedRect=K||M(n),X.willInsertAfter=
Y,X.originalEvent=P,b.dispatchEvent(X),pa&&(fa=pa.call(na,X,P)),fa}function g(b){b.draggable=!1}function d(){pb=!1}function f(b,n,q){for(var J=0,H=0,K=b.children;H<K.length;){if("none"!==K[H].style.display&&K[H]!==U&&K[H]!==E&&B(K[H],q.draggable,b,!1)){if(J===n)return K[H];J++}H++}return null}function c(b){for(b=b.lastElementChild;b&&(b===U||"none"===b.style.display);)b=b.previousElementSibling;return b||null}function w(b){return G(E)<G(b)?1:-1}function G(b,n){n=0;if(!b||!b.parentNode)return-1;for(;b&&
(b=b.previousElementSibling);)"TEMPLATE"!==b.nodeName.toUpperCase()&&b!==da&&n++;return n}function L(b,n){if(b)try{if(b.matches)return b.matches(n);if(b.msMatchesSelector)return b.msMatchesSelector(n);if(b.webkitMatchesSelector)return b.webkitMatchesSelector(n)}catch(q){}return!1}function A(b,n){return function(){if(!eb){var q=arguments,J=this;eb=sa(function(){1===q.length?b.call(J,q[0]):b.apply(J,q);eb=void 0},n)}}}function O(b,n){if(b&&n)for(var q in n)n.hasOwnProperty(q)&&(b[q]=n[q]);return b}
function D(b){return ab&&ab.dom?ab.dom(b).cloneNode(!0):Ha?Ha(b).clone(!0)[0]:b.cloneNode(!0)}function I(b){return sa(b,0)}function M(b,n,q,J){if(b.getBoundingClientRect||b===la){var H,K,P,Y,X,fa,na;if(na=b!==la&&b!==Ta()?(K=(H=b.getBoundingClientRect()).top,P=H.left,Y=H.bottom,X=H.right,fa=H.height,H.width):(P=K=0,Y=window.innerHeight,X=window.innerWidth,fa=window.innerHeight,window.innerWidth),J&&b!==la&&(q=q||b.parentNode,!Ia)){do if(q&&q.getBoundingClientRect&&"none"!==p(q,"transform")){Y=q.getBoundingClientRect();
K-=Y.top+ia(p(q,"border-top-width"));P-=Y.left+ia(p(q,"border-left-width"));Y=K+H.height;X=P+H.width;break}while(q=q.parentNode)}n&&b!==la&&(n=(b=z(q||b))&&b.a,q=b&&b.d,b&&(Y=(K/=q)+(fa/=q),X=(P/=n)+(na/=n)));return{top:K,left:P,bottom:Y,right:X,width:na,height:fa}}}function T(b,n){var q=Xa(b,!0);for(b=M(b)[n];q;){var J=M(q)[n];if(!("top"===n||"left"===n?J<=b:b<=J))return q;if(q===Ta())break;q=Xa(q,!1)}return!1}function ba(b){var n=0,q=0,J=Ta();if(b){do{var H=z(b),K=H.d;n+=b.scrollLeft*H.a;q+=b.scrollTop*
K}while(b!==J&&(b=b.parentNode))}return[n,q]}if("undefined"==typeof window||!window.document)return function(){throw Error("Sortable.js requires a window with a document");};var E,ka,U,da,Z,ra,Ma,Ra,Wa,$a,ua,oa,Fa,qa,l,r,S,V,ca,Ga,ma,ya,ta,za,a,e,h=[],k=!1,t=!1,N=!1,W=[],ja=!1,ea=!1,ha=[],Q=/\s+/g,aa="Sortable"+(new Date).getTime(),la=window,R=la.document,ia=la.parseInt,sa=la.setTimeout,Ha=la.jQuery||la.Zepto,ab=la.Polymer,Ab={capture:!1,passive:!1},Ia=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),
db=!!navigator.userAgent.match(/Edge/i),Bb=!!navigator.userAgent.match(/firefox/i),qb=!(!navigator.userAgent.match(/safari/i)||navigator.userAgent.match(/chrome/i)||navigator.userAgent.match(/android/i)),hb=!!navigator.userAgent.match(/iP(ad|od|hone)/i),Cb=db||Ia?"cssFloat":"float",Lb="draggable"in R.createElement("div"),rb=function(){if(Ia)return!1;var b=R.createElement("x");return b.style.cssText="pointer-events:auto","auto"===b.style.pointerEvents}(),pb=!1,sb=!1,Ua=Math.abs,Mb=Math.min,Nb=Math.max,
ib=[],yb=function(b,n){var q=p(b),J=ia(q.width)-ia(q.paddingLeft)-ia(q.paddingRight)-ia(q.borderLeftWidth)-ia(q.borderRightWidth),H=f(b,0,n);b=f(b,1,n);var K=H&&p(H);n=b&&p(b);var P=K&&ia(K.marginLeft)+ia(K.marginRight)+M(H).width,Y=n&&ia(n.marginLeft)+ia(n.marginRight)+M(b).width;return"flex"===q.display?"column"===q.flexDirection||"column-reverse"===q.flexDirection?"vertical":"horizontal":"grid"===q.display?1>=q.gridTemplateColumns.split(" ").length?"vertical":"horizontal":H&&"none"!==K.float?(q=
"left"===K.float?"left":"right",!b||"both"!==n.clear&&n.clear!==q?"horizontal":"vertical"):H&&("block"===K.display||"flex"===K.display||"table"===K.display||"grid"===K.display||J<=P&&"none"===q[Cb]||b&&"none"===q[Cb]&&J<P+Y)?"vertical":"horizontal"},Xa=function(b,n){if(!b||!b.getBoundingClientRect)return Ta();var q=!1;do if(b.clientWidth<b.scrollWidth||b.clientHeight<b.scrollHeight){var J=p(b);if(b.clientWidth<b.scrollWidth&&("auto"==J.overflowX||"scroll"==J.overflowX)||b.clientHeight<b.scrollHeight&&
("auto"==J.overflowY||"scroll"==J.overflowY)){if(!b||!b.getBoundingClientRect||b===R.body)break;if(q||n)return b;q=!0}}while(b=b.parentNode);return Ta()},Ta=function(){return Ia?R.documentElement:R.scrollingElement},Db=function(b,n,q){b.scrollLeft+=n;b.scrollTop+=q},tb=A(function(b,n,q,J){if(n.scroll){var H=q?q[aa]:window,K=n.scrollSensitivity,P=n.scrollSpeed,Y=b.clientX,X=b.clientY,fa=Ta(),na=!1;Wa!==q&&(jb(),Ra=n.scroll,$a=n.scrollFn,!0===Ra&&(Ra=Xa(q,!0),Wa=Ra));q=0;var pa=Ra;do{var va,Na,wa,Sa,
Ja,Aa,Oa,Pa,Ba=pa;var Da=M(Ba);var Va=Da.top,fb=Da.bottom,kb=Da.left,lb=Da.right,Ka=Da.width,xa=Da.height;if(va=Ba.scrollWidth,Na=Ba.scrollHeight,wa=p(Ba),Oa=Ba.scrollLeft,Pa=Ba.scrollTop,Aa=Ba===fa?(Ja=Ka<va&&("auto"===wa.overflowX||"scroll"===wa.overflowX||"visible"===wa.overflowX),xa<Na&&("auto"===wa.overflowY||"scroll"===wa.overflowY||"visible"===wa.overflowY)):(Ja=Ka<va&&("auto"===wa.overflowX||"scroll"===wa.overflowX),xa<Na&&("auto"===wa.overflowY||"scroll"===wa.overflowY)),Da=Ja&&(Ua(lb-Y)<=
K&&Oa+Ka<va)-(Ua(kb-Y)<=K&&!!Oa),Sa=Aa&&(Ua(fb-X)<=K&&Pa+xa<Na)-(Ua(Va-X)<=K&&!!Pa),!h[q])for(Va=0;Va<=q;Va++)h[Va]||(h[Va]={});h[q].vx==Da&&h[q].vy==Sa&&h[q].el===Ba||(h[q].el=Ba,h[q].vx=Da,h[q].vy=Sa,clearInterval(h[q].pid),!Ba||0==Da&&0==Sa||(na=!0,h[q].pid=setInterval(function(){J&&0===this.layer&&(F.active._emulateDragOver(!0),F.active._onTouchMove(ca,!0));var La=h[this.layer].vy?h[this.layer].vy*P:0,Ea=h[this.layer].vx?h[this.layer].vx*P:0;"function"==typeof $a&&"continue"!==$a.call(H,Ea,La,
b,ca,h[this.layer].el)||Db(h[this.layer].el,Ea,La)}.bind({layer:q}),24)));q++}while(n.bubbleScroll&&pa!==fa&&(pa=Xa(pa,!1)));k=na}},30),jb=function(){h.forEach(function(b){clearInterval(b.pid)});h=[]},zb=function(b){function n(H,K){return function(P,Y,X,fa){var na=P.options.group.name&&Y.options.group.name&&P.options.group.name===Y.options.group.name;if(null==H&&(K||na))return!0;if(null==H||!1===H)return!1;if(K&&"clone"===H)return H;if("function"==typeof H)return n(H(P,Y,X,fa),K)(P,Y,X,fa);P=(K?P:
Y).options.group.name;return!0===H||"string"==typeof H&&H===P||H.join&&-1<H.indexOf(P)}}var q={},J=b.group;J&&"object"==typeof J||(J={name:J});q.name=J.name;q.checkPull=n(J.pull,!0);q.checkPut=n(J.put);q.revertClone=J.revertClone;b.group=q},Eb=function(b){E&&E.parentNode&&E.parentNode[aa]&&E.parentNode[aa]._computeIsAligned(b)},Fb=function(b,n){for(;!n[aa];)n=n.parentNode;return b===n},Gb=function(b,n,q){for(b=b.parentNode;b&&!b[aa];)b=b.parentNode;b&&b[aa][q](O(n,{artificialBubble:!0}))},Hb=function(){!rb&&
U&&p(U,"display","none")},Ib=function(){!rb&&U&&p(U,"display","")};R.addEventListener("click",function(b){if(N)return b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.stopImmediatePropagation&&b.stopImmediatePropagation(),N=!1},!0);var eb,ub=function(b){if(b=b.touches?b.touches[0]:b,E){a:{var n=b.clientX;for(var q=b.clientY,J=0;J<W.length;J++)if(!c(W[J])){var H=M(W[J]),K=W[J][aa].options.emptyInsertThreshold,P=q>=H.top-K&&q<=H.bottom+K;if(n>=H.left-K&&n<=H.right+K&&P){n=W[J];break a}}n=
void 0}n&&n[aa]._onDragOver({clientX:b.clientX,clientY:b.clientY,target:n,rootEl:n})}};return v(R,"dragover",ub),v(R,"mousemove",ub),v(R,"touchmove",ub),F.prototype={constructor:F,_computeIsAligned:function(b){var n;if(U&&!rb?(Hb(),n=R.elementFromPoint(b.clientX,b.clientY),Ib()):n=b.target,n=B(n,this.options.draggable,this.el,!1),!sb&&E&&E.parentNode===this.el){for(var q,J,H,K,P,Y,X,fa,na=this.el.children,pa=0;pa<na.length;pa++)B(na[pa],this.options.draggable,this.el,!1)&&na[pa]!==n&&(na[pa].sortableMouseAligned=
(q=b.clientX,J=b.clientY,H=na[pa],K=this._getDirection(b,null),this.options,void 0,P=M(H),Y="vertical"===K?P.left:P.top,X="vertical"===K?P.right:P.bottom,Y<(fa="vertical"===K?q:J)&&fa<X));B(n,this.options.draggable,this.el,!0)||(ma=null);sb=!0;sa(function(){sb=!1},30)}},_getDirection:function(b,n){return"function"==typeof this.options.direction?this.options.direction.call(this,b,n,E):this.options.direction},_onTapStart:function(b){if(b.cancelable){var n,q=this,J=this.el,H=this.options,K=H.preventOnFilter,
P=b.type,Y=b.touches&&b.touches[0],X=(Y||b).target,fa=b.target.shadowRoot&&(b.path&&b.path[0]||b.composedPath&&b.composedPath()[0])||X,na=H.filter;if(function(pa){ib.length=0;pa=pa.getElementsByTagName("input");for(var va=pa.length;va--;){var Na=pa[va];Na.checked&&ib.push(Na)}}(J),!(Ia&&!b.artificialBubble&&!Fb(J,X)||E||/mousedown|pointerdown/.test(P)&&0!==b.button||H.disabled||fa.isContentEditable))if(X=B(X,H.draggable,J,!1)){if(Ma!==X){if(n=G(X,H.draggable),"function"==typeof na){if(na.call(this,
b,X,this))return y(q,fa,"filter",X,J,J,n),void(K&&b.cancelable&&b.preventDefault())}else if(na&&(na=na.split(",").some(function(pa){if(pa=B(fa,pa.trim(),J,!1))return y(q,pa,"filter",X,J,J,n),!0})))return void(K&&b.cancelable&&b.preventDefault());H.handle&&!B(fa,H.handle,J,!1)||this._prepareDragStart(b,Y,X,n)}}else Ia&&Gb(J,b,"_onTapStart")}},_handleAutoScroll:function(b,n){if(E&&this.options.scroll){var q=b.clientX,J=b.clientY,H=R.elementFromPoint(q,J),K=this;if(n||db||Ia||qb){tb(b,K.options,H,n);
var P=Xa(H,!0);!k||l&&q===r&&J===S||(l&&clearInterval(l),l=setInterval(function(){if(E){var Y=Xa(R.elementFromPoint(q,J),!0);Y!==P&&(P=Y,jb(),tb(b,K.options,P,n))}},10),r=q,S=J)}else{if(!K.options.bubbleScroll||Xa(H,!0)===Ta())return void jb();tb(b,K.options,Xa(H,!1),!1)}}},_prepareDragStart:function(b,n,q,J){var H,K=this,P=K.el,Y=K.options,X=P.ownerDocument;q&&!E&&q.parentNode===P&&(Z=P,ka=(E=q).parentNode,ra=E.nextSibling,Ma=q,Fa=Y.group,ua=J,V={target:E,clientX:(n||b).clientX,clientY:(n||b).clientY},
this._lastX=(n||b).clientX,this._lastY=(n||b).clientY,E.style["will-change"]="all",E.style.transition="",E.style.transform="",H=function(){K._disableDelayedDragEvents();!Bb&&K.nativeDraggable&&(E.draggable=!0);K._triggerDragStart(b,n);y(K,Z,"choose",E,Z,Z,ua);u(E,Y.chosenClass,!0)},Y.ignore.split(",").forEach(function(fa){C(E,fa.trim(),g)}),Y.supportPointer?v(X,"pointerup",K._onDrop):(v(X,"mouseup",K._onDrop),v(X,"touchend",K._onDrop),v(X,"touchcancel",K._onDrop)),Bb&&this.nativeDraggable&&(this.options.touchStartThreshold=
4,E.draggable=!0),!Y.delay||this.nativeDraggable&&(db||Ia)?H():(v(X,"mouseup",K._disableDelayedDrag),v(X,"touchend",K._disableDelayedDrag),v(X,"touchcancel",K._disableDelayedDrag),v(X,"mousemove",K._delayedDragTouchMoveHandler),v(X,"touchmove",K._delayedDragTouchMoveHandler),Y.supportPointer&&v(X,"pointermove",K._delayedDragTouchMoveHandler),K._dragStartTimer=sa(H,Y.delay)))},_delayedDragTouchMoveHandler:function(b){b=b.touches?b.touches[0]:b;Nb(Ua(b.clientX-this._lastX),Ua(b.clientY-this._lastY))>=
Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){E&&g(E);clearTimeout(this._dragStartTimer);this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var b=this.el.ownerDocument;x(b,"mouseup",this._disableDelayedDrag);x(b,"touchend",this._disableDelayedDrag);x(b,"touchcancel",this._disableDelayedDrag);x(b,"mousemove",this._delayedDragTouchMoveHandler);x(b,"touchmove",this._delayedDragTouchMoveHandler);
x(b,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(b,n){n=n||("touch"==b.pointerType?b:null);!this.nativeDraggable||n?this.options.supportPointer?v(R,"pointermove",this._onTouchMove):v(R,n?"touchmove":"mousemove",this._onTouchMove):(v(E,"dragend",this),v(Z,"dragstart",this._onDragStart));try{R.selection?I(function(){R.selection.empty()}):window.getSelection().removeAllRanges()}catch(q){}},_dragStarted:function(b,n){if(t=!1,Z&&E){this.nativeDraggable&&(v(R,"dragover",
this._handleAutoScroll),v(R,"dragover",Eb));var q=this.options;!b&&u(E,q.dragClass,!1);u(E,q.ghostClass,!0);p(E,"transform","");F.active=this;b&&this._appendGhost();y(this,Z,"start",E,Z,Z,ua,void 0,n)}else this._nulling()},_emulateDragOver:function(b){if(ca&&(this._lastX!==ca.clientX||this._lastY!==ca.clientY||b)){this._lastX=ca.clientX;this._lastY=ca.clientY;Hb();for(var n=b=R.elementFromPoint(ca.clientX,ca.clientY);b&&b.shadowRoot;)n=b=b.shadowRoot.elementFromPoint(ca.clientX,ca.clientY);if(n){do{if(n[aa]&&
n[aa]._onDragOver({clientX:ca.clientX,clientY:ca.clientY,target:b,rootEl:n})&&!this.options.dragoverBubble)break;b=n}while(n=n.parentNode)}E.parentNode[aa]._computeIsAligned(ca);Ib()}},_onTouchMove:function(b,n){if(V){var q=this.options,J=q.fallbackTolerance,H=q.fallbackOffset;q=b.touches?b.touches[0]:b;var K=U&&z(U),P=U&&K&&K.a;K=U&&K&&K.d;var Y=hb&&a&&ba(a);P=(q.clientX-V.clientX+H.x)/(P||1)+(Y?Y[0]-ha[0]:0)/(P||1);H=(q.clientY-V.clientY+H.y)/(K||1)+(Y?Y[1]-ha[1]:0)/(K||1);H=b.touches?"translate3d("+
P+"px,"+H+"px,0)":"translate("+P+"px,"+H+"px)";if(!F.active&&!t){if(J&&Mb(Ua(q.clientX-this._lastX),Ua(q.clientY-this._lastY))<J)return;this._onDragStart(b,!0)}!n&&this._handleAutoScroll(q,!0);Ga=!0;ca=q;p(U,"webkitTransform",H);p(U,"mozTransform",H);p(U,"msTransform",H);p(U,"transform",H);b.cancelable&&b.preventDefault()}},_appendGhost:function(){if(!U){var b=this.options.fallbackOnBody?R.body:Z,n=M(E,!0,b,!hb),q=(p(E),this.options);if(hb){for(a=b;"static"===p(a,"position")&&"none"===p(a,"transform")&&
a!==R;)a=a.parentNode;if(a!==R){var J=M(a,!0);n.top-=J.top;n.left-=J.left}a!==R.body&&a!==R.documentElement?(a===R&&(a=Ta()),n.top+=a.scrollTop,n.left+=a.scrollLeft):a=Ta();ha=ba(a)}u(U=E.cloneNode(!0),q.ghostClass,!1);u(U,q.fallbackClass,!0);u(U,q.dragClass,!0);p(U,"box-sizing","border-box");p(U,"margin",0);p(U,"top",n.top);p(U,"left",n.left);p(U,"width",n.width);p(U,"height",n.height);p(U,"opacity","0.8");p(U,"position",hb?"absolute":"fixed");p(U,"zIndex","100000");p(U,"pointerEvents","none");b.appendChild(U)}},
_onDragStart:function(b,n){var q=this,J=b.dataTransfer,H=q.options;(da=D(E)).draggable=!1;da.style["will-change"]="";this._hideClone();u(da,q.options.chosenClass,!1);q._cloneId=I(function(){q.options.removeCloneOnHide||Z.insertBefore(da,E);y(q,Z,"clone",E)});!n&&u(E,H.dragClass,!0);n?(N=!0,q._loopId=setInterval(q._emulateDragOver,50)):(x(R,"mouseup",q._onDrop),x(R,"touchend",q._onDrop),x(R,"touchcancel",q._onDrop),J&&(J.effectAllowed="move",H.setData&&H.setData.call(q,J,E)),v(R,"drop",q),p(E,"transform",
"translateZ(0)"));t=!0;q._dragStartId=I(q._dragStarted.bind(q,n,b));v(R,"selectstart",q);qb&&p(R.body,"user-select","none")},_onDragOver:function(b){function n(Ca){return Ca&&(na?fa._hideClone():fa._showClone(va),fa&&(u(E,qa?qa.options.ghostClass:fa.options.ghostClass,!1),u(E,Y.ghostClass,!0)),qa!==va&&va!==F.active?qa=va:va===F.active&&(qa=null),J&&va._animate(J,E),P&&wa&&va._animate(wa,P)),(P===E&&!E.animated||P===K&&!P.animated)&&(ma=null),Y.dragoverBubble||b.rootEl||P===R||(va._handleAutoScroll(b),
E.parentNode[aa]._computeIsAligned(b)),!Y.dragoverBubble&&b.stopPropagation&&b.stopPropagation(),!0}function q(){y(va,Z,"change",P,K,Z,ua,G(E,Y.draggable),b)}var J,H,K=this.el,P=b.target,Y=this.options,X=Y.group,fa=F.active,na=Fa===X,pa=Y.sort,va=this;if(!pb&&(!Ia||b.rootEl||b.artificialBubble||Fb(K,P))){if(void 0!==b.preventDefault&&b.cancelable&&b.preventDefault(),Ga=!0,P=B(P,Y.draggable,K,!0),B(b.target,null,E,!0)||P.animated)return n(!1);if(P!==E&&(N=!1),fa&&!Y.disabled&&(na?pa||(H=!Z.contains(E)):
qa===this||(this.lastPutMode=Fa.checkPull(this,fa,E,b))&&X.checkPut(this,fa,E,b))){X=this._getDirection(b,P);if(J=M(E),H)return this._hideClone(),ka=Z,ra?Z.insertBefore(E,ra):Z.appendChild(E),n(!0);if((H=c(K))&&(Ka=b,xa=X,La=M(c(K)),Ea="vertical"===xa?Ka.clientY:Ka.clientX,Ya="vertical"===xa?Ka.clientX:Ka.clientY,bb="vertical"===xa?La.bottom:La.right,vb="vertical"===xa?La.left:La.top,mb="vertical"===xa?La.right:La.bottom,!("vertical"===xa?mb+10<Ya||Ya<=mb&&bb<Ea&&vb<=Ya:bb<Ea&&vb<Ya||Ea<=bb&&mb+10<
Ya)||H.animated)){if(P&&P!==E&&P.parentNode===K){var Na;Ea=0;Ya=P.sortableMouseAligned;bb=E.parentNode!==K;Ka="vertical"===X?"top":"left";La=(xa=T(P,"top")||T(E,"top"))?xa.scrollTop:void 0;if(ma!==P&&(ta=null,Na=M(P)[Ka],ja=!1),Ja=P,Aa=X,Oa=(Sa=E)===E&&e||M(Sa),Pa=Ja===E&&e||M(Ja),Ba="vertical"===Aa?Oa.left:Oa.top,Da="vertical"===Aa?Oa.right:Oa.bottom,Va="vertical"===Aa?Oa.width:Oa.height,fb="vertical"===Aa?Pa.left:Pa.top,kb="vertical"===Aa?Pa.right:Pa.bottom,lb="vertical"===Aa?Pa.width:Pa.height,
ta=(Ba===fb||Da===kb||Ba+Va/2===fb+lb/2)&&Ya||bb||xa||Y.invertSwap||"insert"===ta||"swap"===ta?("swap"!==ta&&(ea=Y.invertSwap||bb),Ea=function(Ca,Jb,cb,wb,nb,Kb,Ob){var Qa=M(Jb);Ca="vertical"===cb?Ca.clientY:Ca.clientX;var Za="vertical"===cb?Qa.height:Qa.width,gb="vertical"===cb?Qa.top:Qa.left;Qa="vertical"===cb?Qa.bottom:Qa.right;var ob=M(E),xb=!1;if(!Kb)if(Ob&&za<Za*wb)if(!ja&&(1===ya?gb+Za*nb/2<Ca:Ca<Qa-Za*nb/2)&&(ja=!0),ja)xb=!0;else{if("vertical"===cb?ob.top:ob.left,"vertical"===cb?ob.bottom:
ob.right,1===ya?Ca<gb+za:Qa-za<Ca)return-1*ya}else if(gb+Za*(1-wb)/2<Ca&&Ca<Qa-Za*(1-wb)/2)return w(Jb);return(xb=xb||Kb)&&(Ca<gb+Za*nb/2||Qa-Za*nb/2<Ca)?gb+Za/2<Ca?1:-1:0}(b,P,X,Y.swapThreshold,null==Y.invertedSwapThreshold?Y.swapThreshold:Y.invertedSwapThreshold,ea,ma===P),"swap"):(Ea=w(P),"insert"),0===Ea)return n(!1);e=null;ya=Ea;var wa=M(ma=P);Sa=P.nextElementSibling;Ja=!1;Aa=m(Z,K,E,J,P,wa,b,Ja=1===Ea);if(!1!==Aa)return 1!==Aa&&-1!==Aa||(Ja=1===Aa),pb=!0,sa(d,30),na?fa._hideClone():fa._showClone(this),
Ja&&!Sa?K.appendChild(E):P.parentNode.insertBefore(E,Ja?Sa:P),xa&&Db(xa,0,La-xa.scrollTop),ka=E.parentNode,void 0===Na||ea||(za=Ua(Na-M(P)[Ka])),q(),n(!0)}}else if(H&&K===b.target&&(P=H),P&&(wa=M(P)),na?fa._hideClone():fa._showClone(this),!1!==m(Z,K,E,J,P,wa,b,!!P))return K.appendChild(E),ka=K,e=null,q(),n(!0);if(K.contains(E))return n(!1)}var Sa,Ja,Aa,Oa,Pa,Ba,Da,Va,fb,kb,lb,Ka,xa,La,Ea,Ya,bb,vb,mb;return Ia&&!b.rootEl&&Gb(K,b,"_onDragOver"),!1}},_animate:function(b,n){var q=this.options.animation;
if(q){var J=M(n);if(n===E&&(e=J),1===b.nodeType&&(b=M(b)),b.left+b.width/2!==J.left+J.width/2||b.top+b.height/2!==J.top+J.height/2){var H=z(this.el),K=H&&H.a;H=H&&H.d;p(n,"transition","none");p(n,"transform","translate3d("+(b.left-J.left)/(K||1)+"px,"+(b.top-J.top)/(H||1)+"px,0)");n.offsetWidth;p(n,"transition","transform "+q+"ms"+(this.options.easing?" "+this.options.easing:""));p(n,"transform","translate3d(0,0,0)")}"number"==typeof n.animated&&clearTimeout(n.animated);n.animated=sa(function(){p(n,
"transition","");p(n,"transform","");n.animated=!1},q)}},_offUpEvents:function(){var b=this.el.ownerDocument;x(R,"touchmove",this._onTouchMove);x(R,"pointermove",this._onTouchMove);x(b,"mouseup",this._onDrop);x(b,"touchend",this._onDrop);x(b,"pointerup",this._onDrop);x(b,"touchcancel",this._onDrop);x(R,"selectstart",this)},_onDrop:function(b){var n=this.el,q=this.options;ja=ea=k=t=!1;clearInterval(this._loopId);clearInterval(l);jb();clearTimeout(eb);eb=void 0;clearTimeout(this._dragStartTimer);clearTimeout(this._cloneId);
clearTimeout(this._dragStartId);x(R,"mousemove",this._onTouchMove);this.nativeDraggable&&(x(R,"drop",this),x(n,"dragstart",this._onDragStart),x(R,"dragover",this._handleAutoScroll),x(R,"dragover",Eb));qb&&p(R.body,"user-select","");this._offUpEvents();b&&(Ga&&(b.cancelable&&b.preventDefault(),!q.dropBubble&&b.stopPropagation()),U&&U.parentNode&&U.parentNode.removeChild(U),(Z===ka||qa&&"clone"!==qa.lastPutMode)&&da&&da.parentNode&&da.parentNode.removeChild(da),E&&(this.nativeDraggable&&x(E,"dragend",
this),g(E),E.style["will-change"]="",u(E,qa?qa.options.ghostClass:this.options.ghostClass,!1),u(E,this.options.chosenClass,!1),y(this,Z,"unchoose",E,ka,Z,ua,null,b),Z!==ka?(0<=(oa=G(E,q.draggable))&&(y(null,ka,"add",E,ka,Z,ua,oa,b),y(this,Z,"remove",E,ka,Z,ua,oa,b),y(null,ka,"sort",E,ka,Z,ua,oa,b),y(this,Z,"sort",E,ka,Z,ua,oa,b)),qa&&qa.save()):E.nextSibling!==ra&&0<=(oa=G(E,q.draggable))&&(y(this,Z,"update",E,ka,Z,ua,oa,b),y(this,Z,"sort",E,ka,Z,ua,oa,b)),F.active&&(null!=oa&&-1!==oa||(oa=ua),y(this,
Z,"end",E,ka,Z,ua,oa,b),this.save())));this._nulling()},_nulling:function(){Z=E=ka=U=ra=da=Ma=Ra=Wa=h.length=l=r=S=V=ca=Ga=oa=ua=ma=ya=e=qa=Fa=F.active=null;ib.forEach(function(b){b.checked=!0});ib.length=0},handleEvent:function(b){switch(b.type){case "drop":case "dragend":this._onDrop(b);break;case "dragenter":case "dragover":E&&(this._onDragOver(b),b.dataTransfer&&(b.dataTransfer.dropEffect="move"),b.cancelable&&b.preventDefault());break;case "selectstart":b.preventDefault()}},toArray:function(){for(var b,
n=[],q=this.el.children,J=0,H=q.length,K=this.options;J<H;J++)if(B(b=q[J],K.draggable,this.el,!1)){var P=n,Y=P.push,X;if(!(X=b.getAttribute(K.dataIdAttr))){b=b.tagName+b.className+b.src+b.href+b.textContent;X=b.length;for(var fa=0;X--;)fa+=b.charCodeAt(X);X=fa.toString(36)}Y.call(P,X)}return n},sort:function(b){var n={},q=this.el;this.toArray().forEach(function(J,H){H=q.children[H];B(H,this.options.draggable,q,!1)&&(n[J]=H)},this);b.forEach(function(J){n[J]&&(q.removeChild(n[J]),q.appendChild(n[J]))})},
save:function(){var b=this.options.store;b&&b.set&&b.set(this)},closest:function(b,n){return B(b,n||this.options.draggable,this.el,!1)},option:function(b,n){var q=this.options;if(void 0===n)return q[b];q[b]=n;"group"===b&&zb(q)},destroy:function(){var b=this.el;b[aa]=null;x(b,"mousedown",this._onTapStart);x(b,"touchstart",this._onTapStart);x(b,"pointerdown",this._onTapStart);this.nativeDraggable&&(x(b,"dragover",this),x(b,"dragenter",this));Array.prototype.forEach.call(b.querySelectorAll("[draggable]"),
function(n){n.removeAttribute("draggable")});this._onDrop();W.splice(W.indexOf(this.el),1);this.el=b=null},_hideClone:function(){da.cloneHidden||(p(da,"display","none"),da.cloneHidden=!0,da.parentNode&&this.options.removeCloneOnHide&&da.parentNode.removeChild(da))},_showClone:function(b){"clone"===b.lastPutMode?da.cloneHidden&&(Z.contains(E)&&!this.options.group.revertClone?Z.insertBefore(da,E):ra?Z.insertBefore(da,ra):Z.appendChild(da),this.options.group.revertClone&&this._animate(E,da),p(da,"display",
""),da.cloneHidden=!1):this._hideClone()}},v(R,"touchmove",function(b){(F.active||t)&&b.cancelable&&b.preventDefault()}),F.utils={on:v,off:x,css:p,find:C,is:function(b,n){return!!B(b,n,b,!1)},extend:O,throttle:A,closest:B,toggleClass:u,clone:D,index:G,nextTick:I,cancelNextTick:function(b){return clearTimeout(b)},detectDirection:yb,getChild:f},F.create=function(b,n){return new F(b,n)},F.version="1.8.4",F})},"widgets/Bookmark/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Bookmark/ItemNode.html":'\x3cdiv class\x3d"jimu-img-node jimu-float-leading clearFix" data-id\x3d"" tabindex\x3d"0" aria-label\x3d"" role\x3d"button"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"nodeBox" class\x3d"node-box verticalCenter no-user-select"\x3e\r\n\t\t\x3cimg data-dojo-attach-point\x3d"thumbnail" class\x3d"thumbnail" src\x3d""\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"nodeLabel" data-dojo-type\x3d"dijit/form/ValidationTextBox" required\x3d"true" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"changeImgBtn" class\x3d"change-img-btn oper-btns no-user-select hide" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"editBtn" class\x3d"edit-btn oper-btns no-user-select" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"renameBtn" class\x3d"rename-btn oper-btns no-user-select" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"deleteBtn" class\x3d"delete-btn oper-btns no-user-select" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"dragMasker" class\x3d"drag-masker" tabindex\x3d"-1"\x3e\x3c/div\x3e\x3c!--for different browsers drag behavior--\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"layerInfosIcon" class\x3d"layer-info-icon icons no-user-select hide"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"selectedBtn" class\x3d"selected-btn oper-btns no-user-select hide"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Layout.html":'\x3cdiv class\x3d"layout"\x3e\r\n  \x3cdiv class\x3d"title"\x3e${nls.displayBookmarksAs}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"content verticalCenter"\x3e\r\n    \x3cdiv type\x3d"checkbox" checked\x3d"false" class\x3d"checkbox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"layoutCards_checkBox"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"label verticalCenter" data-dojo-attach-point\x3d"layoutCards" title\x3d"${nls.cardsTips}"\x3e\r\n      \x3cdiv class\x3d"layout-btns"\x3e\r\n        \x3cdiv class\x3d"cards"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      ${nls.cards}\r\n      \x3cdiv data-dojo-attach-point\x3d"cardsDefaultSetting" class\x3d"default-setting transparent"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"cards_makeAsDefault" class\x3d"set-default hide" title\x3d"${nls.makeAsDefault}"\x3e${nls.makeAsDefault}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"cards_default" class\x3d"default hide" title\x3d"${nls.default}"\x3e${nls.default}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv type\x3d"checkbox" checked\x3d"false" class\x3d"checkbox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"layoutList_checkBox"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"label verticalCenter" data-dojo-attach-point\x3d"layoutList" title\x3d"${nls.listTips}"\x3e\r\n      \x3cdiv class\x3d"layout-btns"\x3e\r\n        \x3cdiv class\x3d"list"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      ${nls.list}\r\n      \x3cdiv data-dojo-attach-point\x3d"listDefaultSetting" class\x3d"default-setting transparent"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"list_makeAsDefault" class\x3d"set-default hide" title\x3d"${nls.makeAsDefault}"\x3e${nls.makeAsDefault}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"list_default" class\x3d"default hide" title\x3d"${nls.default}"\x3e${nls.default}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Bookmark/setting/Edit.html":'\x3cdiv class\x3d"edit-page jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"info"\x3e\r\n    \x3cdiv class\x3d"image"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"text"\x3e\r\n      \x3cdiv class\x3d"lebel"\x3e\r\n        \x3cspan\x3e${nls.title}\x3c/span\x3e\x3cspan class\x3d"start"\x3e*\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"displayName" required\x3d"true" placeHolder\x3d${nls.title} data-dojo-props\x3d\'style:{width:"100%"}\' class\x3d"title"/\x3e\r\n      \x3cdiv class\x3d"tips"\x3e(${nls.thumbnailHint})\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"options"\x3e\r\n    \x3cdiv class\x3d"tips"\x3e${nls.extent}\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"extent-chooser" data-dojo-attach-point\x3d"extentChooserNode"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"itmes btns"\x3e\r\n      \x3cdiv class\x3d"" data-dojo-attach-point\x3d"saveLayers"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"layerChooserContainer" class\x3d"layer-chooser-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"layerChooser"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Import.html":'\x3cdiv class\x3d"import jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"import-tips"\x3e${nls.importFromWeb}\x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"bookmarksInWebmap" class\x3d"bookmarks-in-webmap"\x3e\r\n    \x3cdiv class\x3d"select-all-cb"\x3e\r\n      \x3cdiv type\x3d"checkbox" checked\x3d"false" id\x3d"all" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"all"\x3e\x3c/div\x3e\r\n      \x3clabel class\x3d"all-label" for\x3d"all"\x3e${nls.selectAll}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"bookMarkerContainer" class\x3d"bookmarker-container editing"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"noBookmark" class\x3d"no-bookmark"\x3e${nls.noBookmarkInWebMap}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Sync.html":'\x3cdiv class\x3d"sync"\x3e\r\n  \x3cdiv class\x3d"sync-setting-item"\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isSyncWebmapNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"marks-table-div web-map" data-dojo-attach-point\x3d"webMapBookMarkerContainer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"sync-setting-item"\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isSyncCustomNode"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"customBtns" class\x3d"verticalCenter"\x3e\r\n      \x3c!--\x3cdiv class\x3d"custom-btns" data-dojo-attach-point\x3d"importBtn"\x3e${nls.import}\x3c/div\x3e--\x3e\r\n      \x3cdiv class\x3d"custom-btns create" data-dojo-attach-point\x3d"createNewBtn"\x3e${nls.create}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"marks-table-div custom editing" data-dojo-attach-point\x3d"custombookMarkerContainer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Setting.html":'\x3cdiv class\x3d"jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"layout" data-dojo-attach-point\x3d"layoutContainer"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"editable"\x3e\r\n    \x3c!--\x3cdiv class\x3d"title"\x3e${nls.bookmark}\x3c/div\x3e--\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isEditableNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"editable"\x3e\r\n    \x3cdiv class\x3d"check save-layer" data-dojo-attach-point\x3d"isSaveLayers"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"" data-dojo-attach-point\x3d"syncContainer"\x3e\x3c/div\x3e\r\n  \x3c!--\r\n    \x3cdiv class\x3d\'bookmark-add jimu-float-leading jimu-leading-margin2\' data-dojo-attach-event\x3d"onclick: onAddBookmarkClick"\x3e\r\n      \x3cdiv class\x3d"add_mark_image"\x3e\x3c/div\x3e\u200b\r\n      \x3cdiv title\x3d"${nls.add}" class\x3d"add_mark_text"\x3e${nls.add}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    --\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/css/style.css":'.jimu-img-node{font-size: 12px; position: relative; float: left; color: #666; overflow: hidden;}.jimu-img-node .node-box{position: relative; border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{height: 30px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxDisabled{opacity: 1;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner {color: #000; opacity: 0.9;}.jimu-widget-bookmark .no-user-select{user-select: none; -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none;}.jimu-widget-bookmark .hide {display: none !important;}.jimu-widget-bookmark .clearFix {*overflow: hidden; *zoom: 1;}.jimu-widget-bookmark .clearFix:after {display: table; content: ""; width: 0; clear: both;}.jimu-widget-bookmark .verticalCenter{display: flex; align-items: center;}.jimu-widget-bookmark .jimu-img-node .node-box{margin: 0 auto; width: 100px; height: 60px;}.jimu-widget-bookmark .cards .jimu-img-node .drag-masker{width: 100px; height: 60px;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox {border: none; width: 100%; background-color: transparent;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxDisabled,.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputField{background-color: transparent; width: 100%; overflow: hidden;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner{white-space: nowrap; text-overflow: ellipsis; text-align: center;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitFocused{border:none !important; box-shadow: none; background-image: none;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitValidationTextBoxFocused{background-image: none;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitFocused .dijitInputInner{box-shadow: none; background: rgba(36, 181, 204, 0.2) !important;}.jimu-img-node .oper-btns{display: none; position: absolute; z-index: 10;}.jimu-img-node .icons{position: absolute; width: 20px; height: 20px; z-index: 10; background-color: #FFF;}.list .jimu-img-node .icons{display: none;}.editing .jimu-img-node .thumbnail{}.jimu-img-node .drag-masker{position: absolute; z-index: 5; top: 0; width: 100%; height: 60px; cursor: pointer;}.jimu-img-node .drag-masker:hover{background-color: transparent}.editing .jimu-img-node .oper-btns{width:20px; height:20px; cursor: pointer; background-color: rgba(0,0,0,0.5);}.editing .jimu-img-node .oper-btns:hover{background-color: rgba(0,0,0,0.7);}.editing .jimu-img-node .selected-btn{background: url("../../images/btns/unselected.svg") no-repeat; left:0; top:0;}.editing .jimu-img-node.selected .selected-btn{background: url("../../images/btns/selected.svg") no-repeat;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .delete-btn{cursor: pointer; top:0;}.jimu-rtl .jimu-widget-bookmark:not(.mobile) .jimu-img-node .delete-btn{right: auto;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .delete-btn::before{position: absolute; background-image: url("../../images/btns/x.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.editing .jimu-img-node .edit-btn{right: 0; bottom: 30px;}.jimu-rtl .jimu-img-node .edit-btn{right: auto; left: 0;}.editing .jimu-img-node .edit-btn::before{position: absolute; display: block; background-image: url("images/btns/edit.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .rename-btn{display: none; top: 0px; left: 0px;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .rename-btn::before{position: absolute; display: block; background-image: url("images/btns/edit.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.editing .jimu-img-node .change-img-btn{right: calc((100% - 100px)/2); bottom: 30px;}.jimu-rtl .jimu-img-node .change-img-btn{right: auto; left: calc((100% - 100px)/2);}.editing .jimu-img-node .change-img-btn::before{position: absolute; background-image: url("../../images/btns/change.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-img-node .layer-info-icon{left: calc((100% - 100px)/2); bottom: 30px;}.jimu-rtl .jimu-img-node .layer-info-icon{right: auto; right: calc((100% - 100px)/2);}.jimu-img-node .layer-info-icon::before{position: absolute; background-image: url("../../images/btns/layer_infos.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-widget-bookmark .header {display: flex; align-items: center; justify-content: space-between; height: 30px; margin: 2px; margin-bottom: 15px;}.jimu-widget-bookmark .header .editable-btns,.jimu-widget-bookmark .header .common-fun-btns,.jimu-widget-bookmark .header .edit-btns,.jimu-widget-bookmark .header .common-fun-btns .display-mode{display: flex; align-items: center;}.jimu-widget-bookmark .header .common-fun-btns .display-mode {margin: 0 5px;}.jimu-widget-bookmark .header .two-modes .list{background: url("../../images/btns/list.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .list:hover{background: url("../../images/btns/list_selected.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .cards{background: url("../../images/btns/cards.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .cards:hover{background: url("../../images/btns/cards_selected.svg") no-repeat;}.jimu-widget-bookmark .adding .header .add{background: url("../../images/btns/add_selected.svg") no-repeat;}.jimu-widget-bookmark .header .edit{background: url("../../images/btns/edit.svg") no-repeat;}.jimu-widget-bookmark .editing .header .edit{background: url("../../images/btns/edit_selected.svg") no-repeat;}.jimu-widget-bookmark .header .sync-btn{background: url("../../images/btns/sync.svg") no-repeat;}.jimu-widget-bookmark .header .sync-btn.marked{background: url("../../images/btns/sync.svg") no-repeat; background-color: red;}.jimu-widget-bookmark .header .back-to-init{background: url("../../images/btns/backtoinit.svg") no-repeat;}.jimu-widget-bookmark .header .back-to-init.marked{background: url("../../images/btns/backtoinit_selected.svg") no-repeat;}.jimu-widget-bookmark .header .rename{background: url("../../images/btns/rename_selected.svg") no-repeat;}.jimu-widget-bookmark .header .rename.disable{background: url("../../images/btns/rename.svg") no-repeat;}.jimu-widget-bookmark .header .delete{background: url("../../images/btns/delete_selected.svg") no-repeat;}.jimu-widget-bookmark .header .delete.disable{background: url("../../images/btns/delete.svg") no-repeat;}.jimu-widget-bookmark .header .edit-btns{display: none;}.jimu-widget-bookmark .editing .header .edit-btns{display: flex;}.jimu-widget-bookmark .header .common-fun-btns{display: flex;}.jimu-widget-bookmark .editing .header .common-fun-btns{display: none;}.bookmark-notice-popup{font-family: "Avenir Medium"; font-size: 12px;}.bookmark-notice-popup .tips{color: #000000; letter-spacing: 0;}.bookmark-notice-popup .check-box{position: absolute; bottom: 20px;}.bookmark-notice-popup .check-box .jimu-checkbox .label{font-size: 12px; color: #353535; letter-spacing: 0.3px;}.DartTheme .jimu-widget-bookmark .dijitTextBox{border: none !important;}.DartTheme .jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner {color: #FFF !important;}.jimu-widget-bookmark-setting {height: 100%;}.jimu-widget-bookmark-setting .layout,.jimu-widget-bookmark-setting .editable{margin-bottom: 15px;}.jimu-widget-bookmark-setting .editable .tips{font-family: "Avenir Light"; font-size: 12px; color: #898989;}.jimu-widget-bookmark-setting .layout .title,.jimu-widget-bookmark-setting .editable .title{margin-bottom: 15px; font-size: 14px; color: #000000;}.jimu-widget-bookmark-setting .editable .save-layer{margin-left: 20px;}.jimu-rtl .jimu-widget-bookmark-setting .editable .save-layer{margin-right: 20px; margin-left: 0;}.jimu-widget-bookmark-setting .layout .content{}.jimu-widget-bookmark-setting .layout .label{margin-right: 40px; cursor: pointer;}.jimu-rtl .jimu-widget-bookmark-setting .layout .label{margin-left: 40px; margin-right: 0;}.jimu-widget-bookmark-setting .transparent{visibility: hidden;}.jimu-widget-bookmark-setting .default-setting{display: flex; align-items: center; justify-content: center; min-width: 100px; height: 20px; margin: 0 5px; cursor: pointer; background-color: #F3F3F3; font-size: 12px; text-align: center;}.jimu-widget-bookmark-setting .default-setting .default{color: #9B9B9B; padding: 2px 6px; cursor: default;}.jimu-widget-bookmark-setting .default-setting .set-default {width: 100%; height: 100%; padding: 0 10px; display: flex; align-items: center; justify-content: center; background-color: #24B5CC; color: #ffffff; cursor: pointer;}.jimu-widget-bookmark-setting .layout .content .checkbox{}.jimu-widget-bookmark-setting .layout .layout-btns{width:30px; height:30px; font-size: 14px; border: 1px solid #E2E2E2; margin:0 10px;}.jimu-widget-bookmark-setting .layout .layout-btns .cards{width: 16px; height: 16px; margin: 6px; background: url(../../images/btns/cards.svg) no-repeat;}.jimu-widget-bookmark-setting .layout .layout-btns .list{width: 16px; height: 16px; margin: 6px; background: url(../../images/btns/list.svg) no-repeat;}.jimu-widget-bookmark-setting .sync .check{margin-bottom: 15px;}.jimu-widget-bookmark-setting .sync label{font-family: "Avenir Medium"; font-size: 12px; color: #000000; letter-spacing: 0.3px;}.jimu-widget-bookmark-setting .sync .custom-btns{font-size: 14px; border: 1px solid #D6D6D6; height: 30px; width: 80px; text-align: center; line-height: 30px; cursor: pointer;}.jimu-widget-bookmark-setting .sync .custom-btns:hover{color: #FFF; background-color: #24B5CC;}.jimu-widget-bookmark-setting .sync .custom-btns.create{margin: 0 20px; margin-bottom: 15px;}.jimu-widget-bookmark-setting .bookmark-list{height: 100%; width: 100%; overflow: auto;}.jimu-widget-bookmark-setting .marks-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto; margin: 0 10px;}.jimu-widget-bookmark-setting .marks-table-div.editing{margin-top: 0;}.jimu-widget-bookmark-setting .bookmark-add{position:relative; width:100px; height:60px; padding:3px; text-align:center; color:#999999; font-size:10px; border:1px dotted gray; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover; margin-top: 5px; margin-left: 20px\\9;}.jimu-widget-bookmark-setting .bookmark-add .add_mark_image{display: block; position: absolute; left: 43px; top: 5px; width:14px; height:14px; background-position:center center; background-image:url(images/add_mark.png);}.jimu-widget-bookmark-setting .bookmark-add .add_mark_text{display: block; position: absolute; top: 25px; width: 100%; font-size: 12px; white-space: normal; height: 30px; width: 94px; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark-setting .bookmark-add:hover{cursor: pointer;}.jimu-widget-bookmark-setting .mark-item-div{position:relative; width:100px; height: 90px; font-size: 10px; margin-top: 5px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg{position:relative; width:100%; height:60px; line-height:28px; text-align:center; color:#999999; font-size:13px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-thumbnail{width:100%; height:100%;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg.selected .mark-item-thumbnail{-webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{display: none; position:absolute; width:20px; height:20px; background-color:rgba(0, 0, 0, 0.3); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:2px; bottom:2px; background-repeat:no-repeat; background-position:center center; background-image:url(images/edit_mark.png);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon:hover,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon:hover{background-color:rgba(0, 0, 0, 0.6);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-detail-icon,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-delete-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:2px; top:2px; background-repeat:no-repeat; background-position:center center; background-image:url(images/delete_mark.png);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-title-wapper{width:100%; text-align:center; color:#333333; font-size:12px; margin-bottom: 25px; overflow: hidden; height: 2.7em; line-height: 16px; padding: 0 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;}.jimu-Bookmark-Edit{height: 100%; overflow-y: auto;}.jimu-Bookmark-Edit .setting-table {margin: 5px 20px; border-spacing: 10px; border-collapse: separate;}.jimu-Bookmark-Edit .setting-table .img-chooser{width: 100px; height: 60px;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .first{width:auto; text-align: left; padding-right:15px; white-space: nowrap; max-width: 108px; overflow: hidden; text-overflow: ellipsis;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .second{width:660px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .bookmark-add{margin-left: auto; margin-right: 20px\\9;}.bookmark-extent-chooser .map{position: relative;}.jimu-widget-bookmark.import {min-height: 300px;}.jimu-widget-bookmark.import .import-tips{font-family: "Avenir Medium"; font-size: 14px; color: #161616;}.jimu-widget-bookmark.import .select-all-cb {margin: 10px 0; display: flex; align-items: center;}.jimu-widget-bookmark.import .all-label {font-size: 12px; color: #000000; letter-spacing: 0.3px; padding: 0 10px;}.jimu-widget-bookmark.import .bookmarker-container{overflow: auto;}.jimu-widget-bookmark.import .no-bookmark{font-size: 12px; color: #000000; letter-spacing: 0.3px; display: flex; min-height: 300px; align-items: center; justify-content: center;}.bookmark-extent-chooser .arcgisSearch{position: absolute; z-index: 1001; right: 5px; top: 5px;}.jimu-rtl .bookmark-extent-chooser .arcgisSearch{right: auto; left: 5px;}.jimu-widget-bookmark-setting .jimu-img-node,.import .jimu-img-node{width: 120px;}.jimu-widget-bookmark-setting .web-map .jimu-img-node .drag-masker{cursor: pointer;}.jimu-widget-bookmark-setting .custom .jimu-img-node .drag-masker{cursor: move;}.jimu-widget-bookmark-setting .jimu-img-node .drag-masker{left: 50%; transform: translate(-50%, 0%);}.jimu-widget-bookmark-setting .jimu-img-node .thumbnail{max-width: 100px; max-height: 60px;}.jimu-widget-bookmark-setting .editing .jimu-img-node .oper-btns{display: none;}.jimu-widget-bookmark-setting .editing .jimu-img-node:hover .oper-btns{display: flex; justify-content: center; align-items: center;}.jimu-widget-bookmark-setting .jimu-img-node .delete-btn{right:calc((100% - 100px)/2); top:0;}.jimu-rtl .jimu-widget-bookmark-setting .jimu-img-node .delete-btn{right: auto; left: calc((100% - 100px)/2);}.jimu-widget-bookmark-setting .jimu-img-node .edit-btn{right: calc((100% - 100px)/2); bottom: 31px;}.jimu-rtl .jimu-widget-bookmark-setting .jimu-img-node .edit-btn{right: auto; left: calc((100% - 100px)/2);}.jimu-widget-bookmark.edit-page {}.jimu-widget-bookmark.edit-page .info{display: flex;}.jimu-widget-bookmark.edit-page .info .image{width: 135px; height: 90px;}.jimu-widget-bookmark.edit-page .info .text{width:400px; margin-left: 10px;}.jimu-rtl .jimu-widget-bookmark.edit-page .info .text{margin-left: auto; margin-right: 10px;}.jimu-widget-bookmark.edit-page .info .text .lebel{font-family: "Avenir Medium"; font-size: 14px; color: #161616;}.jimu-widget-bookmark.edit-page .info .text .start{color: red; padding: 0 10px;}.jimu-widget-bookmark.edit-page .info .text .tips{font-size: 12px; color: #999999;}.jimu-widget-bookmark.edit-page .info .title{margin: 10px 0;}.jimu-widget-bookmark.edit-page .image .jimu-image-chooser{width: 135px; height: 80px;}.jimu-widget-bookmark.edit-page .jimu-image-chooser .hint .display-image{top: auto; left: auto; transform: none; width: 100% !important; height: 100% !important;}.jimu-widget-bookmark.edit-page .options{margin: 20px 0;}.jimu-widget-bookmark.edit-page .options .tips{margin-bottom: 10px;}.jimu-widget-bookmark.edit-page .options .itmes{display: flex; align-items: center; margin-top: 10px; margin-bottom: 10px;}.jimu-widget-bookmark.edit-page .options .itmes.btns{justify-content: space-between;}.jimu-widget-bookmark.edit-page .options .extent-chooser{height: 300px;}.jimu-widget-bookmark.edit-page .options .layer-chooser-container{max-height: 150px; overflow-y: scroll; border: 1px solid #d9dde0;}.jimu-widget-bookmark.edit-page .options .layer-chooser-container .jimu-basic-layer-chooser-from-map-lite {min-height: 24px;}.jimu-widget-bookmark.edit-page .options .layer-chooser-container .jimu-basic-layer-chooser-from-map-lite .tree-root-ul{border:none; -webkit-margin-before: 0; -webkit-margin-after: 0;}.layers-chooser-container .meun-box {position: absolute; z-index: 500; background-color: #fff; border: 1px solid #24B5CC; box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.50);}.layers-chooser-container .label {font-family: Avenir-Medium; font-size: 12px; color: #898989; letter-spacing: 0.33px;}.layers-chooser-container .label.enable {color: #FFF; background-color: #24B5CC;}.layers-chooser-container .selected {background-color: greenyellow;}',
"*now":function(F){F(['dojo/i18n!*preload*widgets/Bookmark/setting/nls/Setting*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/on ../utils ./Layout ./Sync jimu/dijit/CheckBox".split(" "),function(F,B,v,x,u,p,z,C,y){return F([B,v],{baseClass:"jimu-widget-bookmark-setting",startup:function(){this.inherited(arguments);this.layout=new z({nls:this.nls,config:this.config},this.layoutContainer);this.layout.startup();"undefined"===typeof this.config.editable&&(this.config.editable=!1);this.isEditableCheckBox=new y({label:this.nls.editable},
this.isEditableNode);this.isEditableCheckBox.startup();this.own(u(this.isEditableCheckBox,"change",x.hitch(this,"_onEditableChange")));this.isSaveLayersCheckBox=new y({label:this.nls.savelayers,checked:!1},this.isSaveLayers);this.isSaveLayersCheckBox.startup();this.sync=new C({nls:this.nls,folderUrl:this.folderUrl,appConfig:this.appConfig,map:this.map,config:this.config},this.syncContainer);this.sync.startup();this.setConfig(this.config)},_onEditableChange:function(m){m?this.isSaveLayersCheckBox.setStatus(!0):
(this.isSaveLayersCheckBox.setValue(!1),this.isSaveLayersCheckBox.setStatus(!1))},setConfig:function(m){this.config=m;this.updateConfigs();this.layout.setConfig(this.config);this.isEditableCheckBox.setValue(m.editable);this.isSaveLayersCheckBox.setValue(m.isSaveLayerVisibility);this._onEditableChange(m.editable);this.sync.setConfig(this.config)},getConfig:function(){var m=this.sync.getConfig();this.config.syncMode=m.syncMode;this.config.layout=this.layout.getConfig();this.config.editable=this.isEditableCheckBox.checked;
this.config.isSaveLayerVisibility=this.isSaveLayersCheckBox.checked;this.config.bookmarks2D=p.stringifyBookmarks(m.bookmarks);this.completeUpdateConfig();return this.config},destroy:function(){this.layout&&this.layout.destroy&&this.layout.destroy();this.sync&&this.layout.destroy&&this.sync.destroy();this.inherited(arguments)},updateConfigs:function(){p.isConfigBefore5_3(this.config)&&p.setDefaultConfigForUpdate(this.config);p.updateBookmarks(this.config.bookmarks2D)},completeUpdateConfig:function(){p.completeUpdateConfig(this.config)}})});