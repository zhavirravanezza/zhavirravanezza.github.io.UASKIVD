// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/RelatedTableCharts/Search":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/Evented dojo/_base/lang dojo/_base/array esri/dijit/Search dojo/dom-construct esri/tasks/locator esri/layers/FeatureLayer jimu/utils jimu/LayerInfos/LayerInfos ./searchSourceUtils dojo/when dojo/Deferred dojo/promise/all dojo/on esri/InfoTemplate dojo/query dojo/keys dojo/_base/event".split(" "),function(G,K,m,y,x,h,l,g,a,b,e,f,d,k,n,p,E,t,q,B){return G([K,m],{config:null,map:null,searchOptions:null,
layerInfosObj:null,_urlParams:{},constructor:function(r){y.mixin(this,r)},postCreate:function(){this._urlParams={}},startup:function(){this.inherited(arguments);e.getInstance(this.map,this.map.itemInfo).then(y.hitch(this,function(r){this.layerInfosObj=r;this.own(this.layerInfosObj.on("layerInfosFilterChanged",y.hitch(this,this.onLayerInfosFilterChanged)));f.setMap(this.map);f.setLayerInfosObj(this.layerInfosObj);f.setAppConfig(this.appConfig);d(f.getConfigInfo(this.config.searchSourceSettings)).then(y.hitch(this,
function(A){this.config.searchSourceSettings||(this.config.searchSourceSettings=A);return n(this._convertConfig(A)).then(function(H){return x.filter(H,function(J){return J})})})).then(y.hitch(this,function(A){this.domNode&&this._init(A)}))}))},_convertConfig:function(r){return x.map(r.sources,y.hitch(this,function(A){var H=new k;if(A&&A.url&&"locator"===A.type){var J={locator:new g(A.url||""),outFields:["*"],singleLineFieldName:A.singleLineFieldName||"",name:b.stripHTML(A.name||""),placeholder:b.stripHTML(A.placeholder||
""),countryCode:A.countryCode||"",maxSuggestions:A.maxSuggestions,maxResults:A.maxResults||6,zoomScale:A.zoomScale||5E4,useMapExtent:!!A.searchInCurrentMapExtent};A.enableLocalSearch&&(J.localSearchOptions={minScale:A.localSearchMinScale,distance:A.localSearchDistance});H.resolve(J)}else A&&A.url&&"query"===A.type?(J=new a(A.url||null,{outFields:["*"]}),this.own(p(J,"load",y.hitch(this,function(L){var M=L.layer;var T=this._getInfoTemplate(M,A,A.displayField);var W=null;A.searchFields&&0<A.searchFields.length?
W=A.searchFields:(W=[],x.forEach(M.fields,function(C){"esriFieldTypeOID"!==C.type&&C.name!==M.objectIdField&&"esriFieldTypeGeometry"!==C.type&&W.push(C.name)}));L={featureLayer:M,outFields:["*"],searchFields:W,displayField:A.displayField||"",exactMatch:!!A.exactMatch,name:b.stripHTML(A.name||""),placeholder:b.stripHTML(A.placeholder||""),maxSuggestions:A.maxSuggestions||6,maxResults:A.maxResults||6,zoomScale:A.zoomScale||5E4,infoTemplate:T,useMapExtent:!!A.searchInCurrentMapExtent,_featureLayerId:A.layerId};
T||delete L.infoTemplate;L._featureLayerId&&(T=this.layerInfosObj.getLayerInfoById(L._featureLayerId),M.setDefinitionExpression(T.getFilter()));H.resolve(L)}))),this.own(p(J,"error",function(){H.resolve(null)}))):H.resolve(null);return H}))},_getInfoTemplate:function(r,A,H){var J;var L=(J=this.layerInfosObj.getLayerInfoById(A.layerId))&&J.getInfoTemplate();var M=J&&L;if(J&&!M)return null;M||(L=new E,L.setTitle("\x26nbsp;"),L.setContent(y.hitch(this,"_formatContent",A.name,r,H)));return L},_init:function(r){var A=
1===r.length?0:"all";r={map:this.map,addLayersFromMap:!1,autoNavigate:!1,autoComplete:!0,minCharacters:0,searchDelay:100,enableInfoWindow:!0,enableHighlight:this.config.searchSourceSettings.showInfoWindowOnSelect,showInfoWindowOnSelect:this.config.searchSourceSettings.showInfoWindowOnSelect,allPlaceholder:b.stripHTML(this.config.searchSourceSettings.allPlaceholder),sources:r,activeSourceIndex:A};y.mixin(r,this.searchOptions);this._urlParams=this._getUrlParams();this.search=new h(r,l.create("div",
{"class":"searchControl"},this.domNode));this.own(this.search.on("load",y.hitch(this,this._load)));this.own(this.search.on("select-result",y.hitch(this,this._selectResult)));this.own(this.search.on("clear-search",y.hitch(this,this._clear)));this.own(this.search.on("search-results",y.hitch(this,this._results)));this.own(this.search.on("suggest-results",y.hitch(this,this._results)));this.search.startup()},_getUrlParams:function(){var r=b.urlToObject(document.location.href);r.query=r.query||{};return r.query},
setSearchText:function(r){this.search.set("value",r)},getSearchText:function(){return this.search.get("value")},getActiveSource:function(){return this.search.activeSource},clearSearchText:function(){this.search&&this.search.clear()},_setSearchString:function(){this._urlParams.find&&(this.search.set("value",this._urlParams.find),setTimeout(y.hitch(this,function(){this.search.search()}),1E3))},onLayerInfosFilterChanged:function(r){x.some(r,y.hitch(this,function(A){this.search&&this.search.sources&&
0<this.search.sources.length&&x.forEach(this.search.sources,function(H){H._featureLayerId===A.id&&H.featureLayer.setDefinitionExpression(A.getFilter())})}))},_load:function(r){this.emit("search-loaded",r);this._setSearchString()},_results:function(r){this.emit("search-results",r)},_clear:function(r){this.emit("clear-search",r)},_selectResult:function(r){this.search.blur();this.emit("select-result",r)},attachTabEventToSearchMenuItems:function(){if(this.search){var r=t(".sourcesMenu",this.search.domNode);
if(r&&0<r.length&&0<r[0].children.length&&(r=r[0].children[0])){var A=r.children;x.forEach(A,y.hitch(this,function(H,J){this.own(p(H,"keydown",y.hitch(this,function(L){L.keyCode===q.TAB&&J===A.length-1&&(B.stop(L),this.emit("setFirstFocusNode"))})))}))}}}})})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e,f,d,k,n,p,E,t,q,B,r,A,H,J,L,M,T,W,C,I,O,S,Q,N,ba,V,ha,ka,ma,ea,da,ia,oa,qa){function z(c,u){return y.map(y.filter(c.trim().split(" "),function(v){return!!v.trim()}),function(v){return{onFields:u,searchTerm:v,searchType:"prefix"}})}function F(c,u){c=c&&c.indexes;if(!c||!u||!u.length)return!1;c=y.filter(c,function(v){return"FullText"===v.indexType});return y.some(c,function(v){var w=v.fields&&y.map(v.fields.split(","),function(D){return D.trim().toLowerCase()})||[];return y.every(u,
function(D){return w.includes(D.toLowerCase())})})}function R(c){return!!(c&&c.advancedQueryCapabilities&&c.advancedQueryCapabilities.supportsFullTextSearch)}function X(c,u){c&&u&&(c._layer=u,c._sourceLayer=u)}K=K([B,r,A,x],{declaredClass:"esri.dijit.Search",templateString:q,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(c,u){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",
searchButtonText:"searchButtonText",searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",
showSuggestions:"showSuggestions",showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new da("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:t.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:t.widgets.Search.main.placeholder,highlightSymbol:(new O(G.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:350,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new ba).setColor(new oa([181,56,46,.9])).setFont(new V("14px",V.STYLE_NORMAL,V.VARIANT_NORMAL,V.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new M(t.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:3,enableSearchingAll:!0};c=m.mixin({},this.options,c);this.set(c);this._updateActiveSource();this._i18n=t;this._defaultSR=new W(4326);this.domNode=u},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(m.hitch(this,this._init))},postCreate:function(){var c=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(g(this.submitNode,H,m.hitch(this,this._searchButton)));this.own(g(this.sourcesBtnNode,H,m.hitch(this,this._toggleSourcesMenu)));this.own(g(this.inputNode,H,m.hitch(this,this._inputClick)));this.own(g(this.clearNode,H,m.hitch(this,this._clearButton)));this.own(g(this.formNode,"submit",m.hitch(this,function(u){u.preventDefault();this._cancelSuggest();this.search()})));this.own(g(this.inputNode,"keyup",m.hitch(this,function(u){this._inputKey(u)})));
this.own(g(this.sourcesBtnNode,"keyup",m.hitch(this,function(u){this._sourceBtnKey(u)})));this.own(g(this.suggestionsNode,"li:click, li:keyup",function(u){c._suggestionsEvent(u,this)}));this.own(g(this.sourcesNode,"li:click, li:keyup",function(u){c._sourcesEvent(u,this)}));this.own(g(this.inputNode,"input, paste",m.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(g(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",m.hitch(this,function(u){this._showMoreResultsClick(u)}))),this.own(g(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",m.hitch(this,function(u){this._moreResultsClick(u)}))),this.own(g(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",m.hitch(this,function(u){this._switchCoordinatesClick(u)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();p.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();d.get(this.inputNode,"value")&&d.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);k.remove(this.containerNode,this.css.hasValue);d.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){n.set(this.domNode,"display","block")},hide:function(){n.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(k.add(this.containerNode,this.css.searchExpanded),k.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(k.remove(this.containerNode,this.css.searchExpanded),k.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(c){this.enableButtonMode&&("undefined"===typeof c&&(c=!this.expanded),c?this.expand():this.collapse())},search:function(c){var u=new h;this._mapLoaded().then(m.hitch(this,function(){this._searchDeferred(c).then(m.hitch(this,function(v){var w=v.results;this.set("searchResults",w);0===v.numResults&&(this._noResults(v.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",v);this._selectFirstResult(w,
v.activeSourceIndex);u.resolve(w)}),m.hitch(this,function(v){u.reject(v)}))}));return u.promise},suggest:function(c){var u=new h;this._mapLoaded().then(m.hitch(this,function(){this._suggestDeferred(c).then(m.hitch(this,function(v){if(v){var w=v.results;this.set("suggestResults",w);this._insertSuggestions(w,v.value);this.emit("suggest-results",v);u.resolve(w)}}),m.hitch(this,function(v){u.reject(v)}))}));return u.promise},select:function(c){var u=this._getDefaultSymbol(c),v=this.labelSymbol,w=this.sources,
D=this.activeSourceIndex,P=this.enableHighlight,Y=this.enableLabel,aa=this.autoNavigate,Z=this.showInfoWindowOnSelect,ca=this.enableInfoWindow,U=this.infoTemplate,fa=c.feature?new C(c.feature.toJson()):null,la=fa?c.feature._sourceLayer:null;X(fa,la);if(D===this._allIndex){var ja=this._getSourceIndexOfResult(c);if(null!==ja){var na=w[ja];D=ja}}else na=w[D];na&&(na.hasOwnProperty("highlightSymbol")&&(u=na.highlightSymbol),na.hasOwnProperty("labelSymbol")&&(v=na.labelSymbol),na.hasOwnProperty("enableHighlight")&&
(P=na.enableHighlight),na.hasOwnProperty("enableLabel")&&(Y=na.enableLabel),na.hasOwnProperty("autoNavigate")&&(aa=na.autoNavigate),na.hasOwnProperty("showInfoWindowOnSelect")&&(Z=na.showInfoWindowOnSelect),na.hasOwnProperty("enableInfoWindow")&&(ca=na.enableInfoWindow),na.hasOwnProperty("infoTemplate")?U=na.infoTemplate:na.featureLayer&&na.featureLayer.infoTemplate&&(U=na.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(fa){w=this.highlightGraphic;var pa=this.graphicsLayer;ja=
this.labelGraphic;var ra=m.mixin({},fa.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(c),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(c)}),sa=null;ca&&(sa=U);ja?(ja.setGeometry(fa.geometry),ja.setAttributes(ra),ja.setSymbol(v),v&&"textsymbol"===v.type&&ja.symbol.setText(c.name)):(ja=new C(fa.geometry,v,ra),X(ja,la),v&&"textsymbol"===v.type&&
ja.symbol.setText(c.name),Y&&(pa?pa.add(ja):this.map&&this.map.graphics&&this.map.graphics.add(ja)));w?(w.setGeometry(fa.geometry),w.setAttributes(ra),w.setInfoTemplate(sa),w.setSymbol(u)):(w=new C(fa.geometry,u,ra,sa),X(w,la),P&&(pa?pa.add(w):this.map&&this.map.graphics&&this.map.graphics.add(w)));w&&w.symbol&&"textsymbol"===w.symbol.type&&w.symbol.setText(c.name);this.map&&this.map.infoWindow&&ca&&Z&&(this.map.infoWindow.setFeatures([w]),u=this._getPointFromGeometry(w.geometry),this.map.infoWindow.show(u));
this.map&&aa&&c&&c.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&this.map.setExtent(c.extent,!0);this.set("highlightGraphic",w);this.set("labelGraphic",ja)}this.set("selectedResult",c);this.emit("select-result",{result:c,source:na,sourceIndex:D})},focus:function(){J.focus(this.inputNode)},blur:function(){this.inputNode.blur();J.curNode&&J.curNode.blur()},clearGraphics:function(){var c=this.highlightGraphic,u=this.graphicsLayer,v=this.labelGraphic;c&&(u?u.remove(c):this.map&&this.map.graphics&&
this.map.graphics.remove(c));v&&(u?u.remove(v):this.map&&this.map.graphics&&this.map.graphics.remove(v));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var c=new h;if(this.map)if(this.map.loaded)c.resolve();else g.once(this.map,"load",m.hitch(this,function(){c.resolve()}));else c.resolve();return c.promise},_init:function(){this._getMapLayers().then(m.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();J.focus(this.inputNode)},
_error:function(c){return Error(this.declaredClass+" "+c)},_searchDeferred:function(c){var u=new h,v=this.value,w=this.activeSourceIndex;c&&c.hasOwnProperty("index")&&(w=c.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var D={magicKey:this.magicKey,text:v};c?"string"===typeof c?(D.text=c,c=this._searchQueries(D)):c="object"===typeof c&&c.hasOwnProperty("magicKey")?this._searchQueries(c):"object"===typeof c&&c.hasOwnProperty("geometry")?this._searchQueries({geometry:c}):
"object"===typeof c&&c.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(c):"object"===typeof c&&"point"===c.type?this._searchQueries({point:c}):c instanceof Array&&2===c.length?this._searchQueries({latlon:c}):this._searchQueries(D):c=this._searchQueries(D);c.always(m.hitch(this,function(P){P=this._formatResults(P,w,v);u.resolve(P)}));return u.promise},_suggestDeferred:function(c){var u=new h;this._deferreds.push(u);c||(c=this.value);var v=this.activeSourceIndex;this._suggestQueries({text:c}).always(m.hitch(this,
function(w){var D;if(w)for(var P=0;P<w.length;P++)w[P]&&(D=!0);D?(w=this._formatResults(w,v,c),u.resolve(w)):u.resolve()}));return u.promise},_getDefaultSymbol:function(c){var u;this.map&&(u=this.map.getBasemap());u||(u="topo");if(c&&c.feature&&c.feature.geometry)var v=c.feature.geometry.type;"polyline"===v?v="line":"circle"===v||"extent"===v?v="polygon":"multipoint"===v&&(v="point");if(v){if(c=qa.getSchemes({theme:"default",basemap:u,geometryType:v}))var w=c.primaryScheme;if(w){w.color&&w.hasOwnProperty("opacity")&&
(w.color.a=w.opacity);var D=w;c=w.color;w=w.size;switch(v){case "point":var P=new S;P.setColor(c);P.setSize(null!==w?w:D.size);v=new Q;v.setColor(D.outline.color);v.setWidth(D.outline.width);P.setOutline(v);break;case "line":P=new Q;P.setColor(c);P.setWidth(null!==w?w:D.width);break;case "polygon":P=new N,P.setColor(c),v=new Q,v.setColor(D.outline.color),v.setWidth(D.outline.width),P.setOutline(v)}D=P}}return D},_selectFirstResult:function(c,u){if(this.autoSelect&&c){var v;u===this._allIndex?v=this._getFirstResult(c):
c[u]&&c[u][0]&&(v=c[u][0]);v&&this.select(v)}},_getSourceIndexOfResult:function(c){var u=this.searchResults;if(u)for(var v in u)if(u[v]&&u[v].length)for(var w=0;w<u[v].length;w++)if(u[v][w]===c)return parseInt(v,10);return null},_getFirstResult:function(c){if(c)for(var u in c)if(c[u]&&c[u][0])return c[u][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();
this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var c=new h;if(this.addLayersFromMap&&this.map){var u=[],v=this.map.graphicsLayerIds;if(v&&v.length){for(var w=0;w<v.length;w++){var D=this.map.getLayer(v[w]);D&&u.push(this._featureLayerLoaded(D))}I(u).always(m.hitch(this,function(P){for(var Y,aa=this.sources,Z=0;Z<P.length;Z++)P[Z]&&
P[Z].loaded&&"Feature Layer"===P[Z].type&&(aa.push({featureLayer:P[Z],enableSuggestions:!0}),Y=!0);Y&&this.set("sources",aa);c.resolve()}))}else c.resolve()}else c.resolve();return c.promise},_switchCoordinatesClick:function(c){c.preventDefault();if(c=d.get(c.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",c),this.search()},_moreResultsClick:function(c){c.preventDefault();var u=c.target;c=parseInt(d.get(u,"data-source-index"),10);u=parseInt(d.get(u,"data-index"),10);var v=
this.searchResults;v&&v[c]&&(c=v[c][u])&&this.select(c)},_showMoreResultsClick:function(c){c.preventDefault();if(c=f.byId(this._moreResultsId)){k.toggle(c,this.css.searchShowMoreResults);var u=f.byId(this._moreResultsId+"_show");u&&(k.contains(c,this.css.searchShowMoreResults)?d.set(u,"textContent",t.widgets.Search.main.hideMoreResults):d.set(u,"textContent",t.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(c){var u=new h;if(c.loaded)u.resolve(c);else if(c.loadError)u.reject(this._error("Layer failed to load."));
else{var v=g.once(c,"load",m.hitch(this,function(){w.remove();u.resolve(c)}));var w=g.once(c,"error",m.hitch(this,function(){v.remove();u.reject(this._error("Layer could not be loaded."))}))}return u.promise},_getObjectSize:function(c){var u=0,v;for(v in c)c.hasOwnProperty(v)&&u++;return u},_sourcesEvent:function(c,u){var v=d.get(u,"data-index"),w=a("li",this.sourcesNode);u=y.indexOf(w,u);v!==this._allIndex&&(v=parseInt(v,10));"click"===c.type||c.keyCode===l.ENTER?(this.set("activeSourceIndex",v),
J.focus(this.inputNode),this._hideSourcesMenu()):c.keyCode===l.UP_ARROW?(c.stopPropagation(),c.preventDefault(),c=u-1,0>c?J.focus(this.sourcesBtnNode):J.focus(w[c])):c.keyCode===l.DOWN_ARROW?(c.stopPropagation(),c.preventDefault(),c=u+1,c>=w.length?J.focus(this.sourcesBtnNode):J.focus(w[c])):c.keyCode===l.ESCAPE&&(this._hideSourcesMenu(),J.focus(this.inputNode))},_suggestionsEvent:function(c,u){var v=d.get(u,"data-source-index"),w=parseInt(d.get(u,"data-index"),10),D=a("li",this.suggestionsNode),
P=this.sources;u=y.indexOf(D,u);v!==this._allIndex&&(v=parseInt(v,10));var Y;this._clearQueryTimeout();"click"===c.type||c.keyCode===l.ENTER?((D=this.suggestResults)&&D[v]&&D[v][w]&&(Y=D[v][w]),Y&&(Y.index=v,P[v].featureLayer?(v=P[v].featureLayer.objectIdField,Y[this._objectIdIdentifier]=Y.feature.attributes[v],this.set("value",this._getSuggestionName(Y)),this.set("selectedFeatureId",Y.feature.attributes[v])):Y.magicKey&&Y.text&&(this.set("value",Y.text),this.set("magicKey",Y.magicKey)),this.search(Y),
J.focus(this.inputNode))):c.keyCode===l.BACKSPACE||c.keyCode===l.DELETE?J.focus(this.inputNode):c.keyCode===l.UP_ARROW?(c.stopPropagation(),c.preventDefault(),Y=u-1,0>Y?J.focus(this.inputNode):J.focus(D[Y])):c.keyCode===l.DOWN_ARROW?(c.stopPropagation(),c.preventDefault(),Y=u+1,Y>=D.length?J.focus(this.inputNode):J.focus(D[Y])):c.keyCode===l.ESCAPE&&(this._hideMenus(),J.focus(this.inputNode))},_getResultName:function(c){var u;c.hasOwnProperty("name")&&null!==c.name&&(u=c.name.toString());u||(u=t.widgets.Search.main.untitledResult);
return u},_getSuggestionName:function(c){var u;c.hasOwnProperty("name")&&null!==c.name&&(u=c.name.toString());c=c.text||u;c||(c=t.widgets.Search.main.untitledResult);return c},_searchResultHTML:function(c){var u="";if(c.feature&&c.feature.attributes&&c.feature.attributes.Addr_type&&"LatLong"===c.feature.attributes.Addr_type){var v=c.name.split(" ");if(2===v.length){var w=v[0];var D=v[1]}D&&w?(c=parseFloat(w),D=parseFloat(D),v=D+", "+c,u+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',
u+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+t.widgets.Search.main.lonlat+"\x3c/div\x3e",u=u+(c+", "+D)+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsItem+'"\x3e'),c===D||90<c||-90>c||180<D||-180>D||(u+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+t.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",u+='\x3ca data-switch-coordinates\x3d"'+v+'" tabindex\x3d"0" href\x3d"#"\x3e'+v+"\x3c/a\x3e\x3c/div\x3e")):u=c.name}else u=c.name;return u},_moreResultsHTML:function(c){var u=
"",v="",w=this.searchResults,D=this.sources,P=0;if(w){v+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e';v+='\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+t.widgets.Search.main.showMoreResults+"\x3c/a\x3e";v=v+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsList+'"\x3e');v+='\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e';for(var Y in w)if(w[Y]){var aa=w[Y].length;if(aa){var Z=1===aa&&w[Y][0]===c;if(1<this._getObjectSize(w)&&!Z){var ca=this._getSourceName(Y);
v+='\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+ca+"\x3c/div\x3e"}if(aa&&!Z){v+="\x3cul\x3e";ca=D[Y].maxResults||this.maxResults;for(Z=0;Z<aa&&Z<ca;++Z)if(w[Y][Z]!==c){var U=this._getResultName(w[Y][Z]);v+='\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+Z+'" data-source-index\x3d"'+Y+'" href\x3d"#"\x3e'+U+"\x3c/a\x3e\x3c/li\x3e";P++}v+="\x3c/ul\x3e"}}}v+="\x3c/div\x3e\x3c/div\x3e"}P&&(u+=v);return u},_validField:function(c,u){return c.getField(u)},_validFields:function(c,u){if(c&&
u&&u.length){for(var v=0;v<u.length;v++)if(!this._validField(c,u[v]))return!1;return!0}return!1},_getCodedName:function(c,u){if(c&&c.length)for(var v=0,w=c.length;v<w;v++){var D=c[v];if(D.code===u)return D.name}},_getCodedValue:function(c,u,v){if(c&&c.length)for(var w=0,D=c.length;w<D;w++){var P=c[w],Y=P.name,aa=u;v||(Y=Y.toLowerCase(),aa=aa.toLowerCase());if(Y===aa)return P.code}return!1},_whereClause:function(c,u,v,w,D){var P=null;if(c){var Y="",aa=this.reHostedFS.test(u.url);aa&&this._containsNonLatinCharacter(c)&&
(Y="N");if(v&&v.length)for(var Z=0,ca=v.length;Z<ca;Z++){var U="";U=c.replace(/'/g,"''");var fa=v[Z],la=u.getField(fa),ja=u.getDomain(fa);ja&&"codedValue"===ja.type&&(U=this._getCodedValue(ja.codedValues,U,w));!1!==U&&(la=la.type,"esriFieldTypeString"===la||"esriFieldTypeDate"===la?w&&"search"===D?U=fa+" \x3d "+Y+"'"+U+"'":(fa=aa?fa:"LOWER("+fa+")",U=(aa?U:U.toLowerCase())+"%",U=fa+" LIKE "+Y+"'"+U+"'"):"esriFieldTypeOID"===la||"esriFieldTypeSmallInteger"===la||"esriFieldTypeInteger"===la||"esriFieldTypeSingle"===
la||"esriFieldTypeDouble"===la?(U=parseFloat(U),U=isNaN(U)?!1:fa+" \x3d "+U):U=fa+" \x3d "+U,U&&(P=P?P+" or ":"",P+=U))}}return P},_suggest:function(c){c||(c={index:this.activeSourceIndex,text:this.value});var u=new h,v=c.index,w=this.sources[v],D=this.enableSuggestions;w.hasOwnProperty("enableSuggestions")&&(D=w.enableSuggestions);var P=0;if(c.hasOwnProperty("text")&&c.text){var Y=m.trim(c.text);P=c.text.length}c=w.minCharacters||this.minCharacters;if(D&&Y&&P>=c&&this._supportsPagination(w)){var aa=
"";w.prefix&&(aa+=w.prefix);aa+=Y;w.suffix&&(aa+=w.suffix);var Z=this._defaultSR;this.map&&(Z=this.map.spatialReference);D={};w.locator?(w.categories&&(D.categories=w.categories),w.locator.outSpatialReference=Z,this.map&&w.localSearchOptions&&w.localSearchOptions.hasOwnProperty("distance")&&w.localSearchOptions.hasOwnProperty("minScale")&&(P=this._getScale(),!w.localSearchOptions.minScale||P&&P<=parseFloat(w.localSearchOptions.minScale))&&(D.location=this.map.extent.getCenter(),D.distance=w.localSearchOptions.distance),
D.text=aa,w.useMapExtent&&this.map&&this.map.extent&&(D.searchExtent=this.map.extent),w.searchExtent&&(D.searchExtent=w.searchExtent),D.maxSuggestions=w.maxSuggestions||this.maxSuggestions,w.sourceCountry&&(D.countryCode=w.sourceCountry),w.countryCode&&(D.countryCode=w.countryCode),w.locator.suggestLocations(D).then(m.hitch(this,function(ca){u.resolve(ca)}),m.hitch(this,function(ca){ca||(ca=this._error("Locator suggestLocations could not be performed."));u.reject(ca)}))):w.featureLayer?this._featureLayerLoaded(w.featureLayer).then(m.hitch(this,
function(){var ca=this._getDisplayField(w),U=w.searchFields||[ca],fa=[];w.suggestionTemplate?w.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(pa,ra){fa.push(ra)}):fa=[ca];-1===y.indexOf(fa,w.featureLayer.objectIdField)&&fa.push(w.featureLayer.objectIdField);ca=this._validField(w.featureLayer,ca);var la=this._validFields(w.featureLayer,fa),ja=this._validFields(w.featureLayer,U);if(ca&&la&&ja){ca=new ia;w.hasOwnProperty("suggestQueryParams")&&m.mixin(ca,w.suggestQueryParams);ca.outSpatialReference=
Z;ca.returnGeometry=!1;ca.num=w.maxSuggestions||this.maxSuggestions;ca.outFields=fa;w.useMapExtent&&this.map&&this.map.extent&&(ca.geometry=this.map.extent);w.searchExtent&&(ca.geometry=w.searchExtent);R(w.featureLayer)&&F(w.featureLayer,U)&&!w.exactMatch&&aa?ca.fullText=z(aa,U):ca.where=this._whereClause(aa,w.featureLayer,U,w.exactMatch,"suggest");if(ca.fullText||ca.where)var na=!0;na?w.featureLayer.queryFeatures(ca,m.hitch(this,function(pa){var ra;(pa=pa.features)&&(ra=this._hydrateResults(pa,v,
!0));u.resolve(ra)}),m.hitch(this,function(pa){pa||(pa=this._error("FeatureLayer queryFeatures errored with suggestions"));u.reject(pa)})):u.resolve()}else u.reject(this._error("Invalid FeatureLayer field"))})):u.reject(this._error("Invalid source"))}else u.resolve();return u.promise},_supportsPagination:function(c){var u;c.locator?u=!0:c.featureLayer&&c.featureLayer.advancedQueryCapabilities&&c.featureLayer.advancedQueryCapabilities.supportsPagination&&(u=!0);return u},_suggestQueries:function(c){var u=
this.sources,v=this.activeSourceIndex,w=[];if(v===this._allIndex)for(v=0;v<u.length;v++){var D=c;D.index=v;D=this._suggest(D);w.push(D)}else c.index=v,D=this._suggest(c),w.push(D);return I(w)},_getPointFromGeometry:function(c){switch(c.type){case "extent":var u=c.getCenter();break;case "multipoint":u=c.getPoint(0);break;case "point":u=c;break;case "polygon":u=c.getCentroid();break;case "polyline":u=c.getPoint(0,0)}return u},_searchQueries:function(c){c.hasOwnProperty("index")||(c.index=this.activeSourceIndex);
var u=[];if(c.index===this._allIndex)for(var v=this.sources,w=0;w<v.length;w++){var D=c;D.index=w;D=this._search(D);u.push(D)}else c=this._search(c),u.push(c);return I(u)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),J.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(c){c||(c={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(c.text=null,c[this._objectIdIdentifier]=
this.selectedFeatureId);var u,v=new h,w=c.index,D=this.sources[w],P;c.hasOwnProperty("text")&&c.text&&(P=m.trim(c.text));if(D){var Y="";D.prefix&&!c.magicKey&&(Y+=D.prefix);Y+=P;D.suffix&&!c.magicKey&&(Y+=D.suffix);var aa=this._defaultSR;this.map&&(aa=this.map.spatialReference);if(D.locator)if(c.hasOwnProperty("text")&&P){var Z={};D.categories&&(Z.categories=D.categories);D.locationType&&(Z.locationType=D.locationType);aa&&(D.locator.outSpatialReference=aa);if(this.map&&D.localSearchOptions&&D.localSearchOptions.hasOwnProperty("distance")&&
D.localSearchOptions.hasOwnProperty("minScale")){var ca=this._getScale();if(!D.localSearchOptions.minScale||ca&&ca<=parseFloat(D.localSearchOptions.minScale))Z.location=this.map.extent.getCenter(),Z.distance=D.localSearchOptions.distance}Z.address={};Z.maxLocations=D.maxResults||this.maxResults;D.useMapExtent&&this.map&&this.map.extent&&(Z.searchExtent=this.map.extent);D.searchExtent&&(Z.searchExtent=D.searchExtent);D.sourceCountry&&(Z.countryCode=D.sourceCountry);D.countryCode&&(Z.countryCode=D.countryCode);
c.magicKey&&(Z.magicKey=c.magicKey);D.singleLineFieldName?Z.address[D.singleLineFieldName]=Y:Z.address["Single Line Input"]=Y;D.outFields&&(Z.outFields=D.outFields);D.locator.addressToLocations(Z).then(m.hitch(this,function(U){U=this._hydrateResults(U,w,!1);v.resolve(U)}),m.hitch(this,function(U){U||(U=this._error("Locator addressToLocations could not be performed"));v.reject(U)}))}else c.geometry?(u=this._getPointFromGeometry(c.geometry.geometry))?this._reverseGeocodePoint(w,u).then(function(U){v.resolve(U)},
function(U){v.reject(U)}):v.reject(this._error("Invalid point to reverse geocode")):c.point?this._reverseGeocodePoint(w,c.point).then(function(U){v.resolve(U)},function(U){v.reject(U)}):c.latlon?(Z=new ha(c.latlon,this._defaultSR),this._reverseGeocodePoint(w,Z).then(function(U){v.resolve(U)},function(U){v.reject(U)})):c.hasOwnProperty("text")&&!P?v.resolve([]):v.reject(this._error("Invalid query type for Locator"));else D.featureLayer?this._featureLayerLoaded(D.featureLayer).then(m.hitch(this,function(){var U=
this._getDisplayField(D),fa=D.searchFields||[U];U=this._validField(D.featureLayer,U);var la=this._validFields(D.featureLayer,fa);if(U&&la){U=new ia;D.hasOwnProperty("searchQueryParams")&&m.mixin(U,D.searchQueryParams);aa&&(U.outSpatialReference=aa,la=this.map&&this.map.getMaxResolution()||1/ea.getUnitValueForSR(aa))&&(U.maxAllowableOffset=la);U.returnGeometry=!0;D.outFields&&(U.outFields=D.outFields);if(!c.hasOwnProperty(this._objectIdIdentifier)){this._supportsPagination(D)&&(U.num=D.maxResults||
this.maxResults);D.useMapExtent&&this.map&&this.map.extent&&(U.geometry=this.map.extent);D.searchExtent&&(U.geometry=D.searchExtent);var ja=D.exactMatch}c.hasOwnProperty("text")&&P?(R(D.featureLayer)&&F(D.featureLayer,fa)&&!ja&&Y?U.fullText=z(Y,fa):U.where=this._whereClause(Y,D.featureLayer,fa,ja,"search"),fa=U.fullText||U.where?!0:!1):c.hasOwnProperty(this._objectIdIdentifier)?(U.objectIds=[c[this._objectIdIdentifier]],fa=!0):c.geometry?(U.geometry=c.geometry,fa=!0):c.point?(U.geometry=c.point,fa=
!0):c.latlon?(u=new ha(c.latlon,this._defaultSR),U.geometry=u,fa=!0):(c.hasOwnProperty("text")&&!P?v.resolve([]):v.reject(this._error("Invalid query type for FeatureLayer")),fa=!1);fa?D.featureLayer.queryFeatures(U,m.hitch(this,function(na){na=na.features;var pa;na&&(pa=this._hydrateResults(na,w,!1));v.resolve(pa)}),m.hitch(this,function(na){na||(na=this._error("FeatureLayer queryFeatures could not be performed"));v.reject(na)})):v.resolve()}else v.reject(this._error("Invalid FeatureLayer field"))})):
v.reject(this._error("Invalid source"))}else v.reject(this._error("Source is undefined"));return v.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(c,u,v){v={activeSourceIndex:u,value:v,numResults:0,numErrors:0,errors:null,results:null};var w={},D={};if(c)if(u===this._allIndex)for(u=0;u<c.length;u++)c[u]&&(c[u]instanceof Error?(w[u]=c[u],v.numErrors++):(D[u]=c[u],v.numResults+=c[u].length));else c[0]&&(c[0]instanceof Error?(w[u]=c[0],
v.numErrors++):(D[u]=c[0],v.numResults+=c[0].length));v.numErrors&&(v.errors=w);v.numResults&&(v.results=D);return v},_reverseGeocodePoint:function(c,u){var v=new h,w=this.sources[c];if(u&&w){var D=w.locationToAddressDistance||this.locationToAddressDistance;w.locator.outSpatialReference=this._defaultSR;this.map&&(w.locator.outSpatialReference=this.map.spatialReference);w.locator.locationToAddress(u,D,m.hitch(this,function(P){P=this._hydrateResults([P],c,!1);v.resolve(P)}),m.hitch(this,function(P){P||
(P=this._error("Locator locationToAddress could not be performed"));v.reject(P)}))}else v.reject(this._error("No point or source defined for reverse geocoding"));return v.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var c=0;c<this._deferreds.length;c++)this._deferreds[c].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(c){if(c){var u=a("li",this.sourcesNode);c.keyCode===l.UP_ARROW?(c.stopPropagation(),c.preventDefault(),
this._showSourcesMenu(),(c=u.length)&&J.focus(u[c-1])):c.keyCode===l.DOWN_ARROW&&(c.stopPropagation(),c.preventDefault(),this._showSourcesMenu(),u[0]&&J.focus(u[0]))}},_inputKey:function(c){if(c){var u=a("li",this.suggestionsNode),v=this.suggestResults;if(c.keyCode===l.TAB||c.keyCode===l.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(c.keyCode===l.UP_ARROW)c.stopPropagation(),c.preventDefault(),this._cancelSuggest(),v&&this._showSuggestionsMenu(),(c=u.length)&&J.focus(u[c-1]);else if(c.keyCode===
l.DOWN_ARROW)c.stopPropagation(),c.preventDefault(),this._cancelSuggest(),v&&this._showSuggestionsMenu(),u[0]&&J.focus(u[0]);else{if(c.ctrlKey||c.metaKey||c.keyCode===l.copyKey||c.keyCode===l.LEFT_ARROW||c.keyCode===l.RIGHT_ARROW||c.keyCode===l.ENTER)return c;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(m.hitch(this,function(){this.suggest()}),this.suggestionDelay)},
_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(c){return this._sourceNames[c]},_loadSources:function(c){c=y.filter(c,function(u){return!!u.featureLayer});c=y.map(c,function(u){return this._featureLayerLoaded(u.featureLayer)},this);return I(c)},_createSourceNameMap:function(c){return this._loadSources(c).then(m.hitch(this,
function(){var u=y.map(c,function(v){return v.name||v.featureLayer&&v.featureLayer.name||t.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(c,u);return u}))},_getDuplicateSourceNameIndexes:function(c){var u={},v=[];y.forEach(c,function(w,D){u.hasOwnProperty(w)?(-1===v.indexOf(u[w])&&v.push(u[w]),v.push(D)):c.lastIndexOf(w)!==D&&(u[w]=D)});return v},_preventDuplicateSourceNames:function(c,u){if(u&&1<u.length){var v=this._getDuplicateSourceNameIndexes(u);y.forEach(v,function(w){u[w]+=
this._getFieldsString(c[w])},this)}},_getFieldsString:function(c){var u="",v=c.featureLayer;if(v){c=c.searchFields||[this._getDisplayField(c)];for(var w=0;w<c.length;w++){u=0===w?u+": ":u+", ";var D=c[w],P=v.getFieldLabel(D);u+=P||D}}return u},_splitResult:function(c,u){u=e.escapeString(u);return c.replace(new RegExp("(^|)("+u+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(c,u){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();
var v=this.sources;if(c){var w=p.create("div");for(var D in c)if(c[D]&&c[D].length){var P=this._getSourceName(D);1<v.length&&this.activeSourceIndex===this._allIndex&&p.create("div",{className:this.css.searchMenuHeader,textContent:P},w);P=p.create("ul",{role:"menu"},w);for(var Y=v[D].maxSuggestions||this.maxSuggestions,aa=0;aa<c[D].length&&aa<Y;++aa){var Z=p.create("li",{"data-index":aa,"data-source-index":D,role:"menuitem",tabindex:0},P),ca=this._getSuggestionName(c[D][aa]);ca=this._splitResult(ca,
u);for(var U=ca.length,fa=0;fa<U;fa++){var la=ca[fa];la.toLowerCase()===u.toLowerCase()?p.create("strong",{textContent:la},Z):(la=document.createTextNode(la),p.place(la,Z))}}}}w?(p.place(w,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(p.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(c){if(this.enableSourcesMenu&&c&&1<c.length){var u,v=this.activeSourceIndex,w=p.create("ul",{role:"menu"});if(this.enableSearchingAll){var D="";v===this._allIndex&&(D="active");
p.create("li",{"data-index":this._allIndex,role:"menuitem",className:D,tabIndex:0,textContent:t.widgets.Search.main.all},w)}for(u=0;u<c.length;u++){D="";u===v&&(D=this.css.activeSource);var P=this._getSourceName(u);p.create("li",{"data-index":u,role:"menuitem",className:D,tabIndex:0,textContent:P},w)}k.add(this.containerNode,this.css.hasMultipleSources);p.place(w,this.sourcesNode,"only")}else k.remove(this.containerNode,this.css.hasMultipleSources),p.empty(this.sourcesNode)},_showLoading:function(){k.add(this.containerNode,
this.css.searchLoading)},_hideLoading:function(){k.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(k.add(this.containerNode,this.css.hasValue),d.set(this.clearNode,"title",t.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(c){var u;c&&(u=m.trim(c));var v=p.create("div",{className:this.css.searchNoResultsBody});c&&u?(p.create("div",
{className:this.css.searchNoResultsHeader,textContent:t.widgets.Search.main.noResults},v),p.create("div",{className:this.css.searchNoResultsText,textContent:L.substitute({value:'"'+c+'"'},t.widgets.Search.main.noResultsFound)},v)):(c=p.create("div",{},v),p.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},c),p.create("span",{className:this.css.searchNoValueText,textContent:t.widgets.Search.main.emptyValue},c));p.place(v,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();
this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){k.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();k.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){k.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){k.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();
k.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();k.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();k.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(c){if(c&&(c=c.fields)&&c.length)for(var u=0;u<c.length;u++){var v=c[u];if("esriFieldTypeString"===v.type)return v.name}return""},_getDisplayField:function(c){return c.displayField||
c.featureLayer.displayField||this._getFirstStringField(c.featureLayer)},_validLocation:function(c){return c&&"number"===typeof c.x&&"number"===typeof c.y},_validExtent:function(c){return c&&"number"===typeof c.xmin&&"number"===typeof c.ymin&&"number"===typeof c.xmax&&"number"===typeof c.ymax},_hydrateResult:function(c,u,v){var w={},D=this._defaultSR;u=this.sources[u];this.map&&(D=this.map.spatialReference);if(c.hasOwnProperty("text")&&c.hasOwnProperty("magicKey"))return c;if(c.hasOwnProperty("geometry")){var P=
new C(c.toJson());w.feature=P;(P=w.feature.geometry)&&P.setSpatialReference(D)}else if(c.hasOwnProperty("location")&&this._validLocation(c.location)){var Y=new ha(c.location.x,c.location.y,D);P={};c.hasOwnProperty("attributes")&&(P=c.attributes);c.hasOwnProperty("address")&&"object"===typeof c.address&&m.mixin(P,c.address);c.hasOwnProperty("score")&&(P.score=c.score);w.feature=new C(Y,null,P,null)}!w.feature&&v&&(P={},c.hasOwnProperty("attributes")&&(P=c.attributes),c.hasOwnProperty("score")&&(P.score=
c.score),w.feature=new C(null,null,P,null));if(w.feature){if(c.hasOwnProperty("extent")&&this._validExtent(c.extent))w.extent=new ka(c.extent),w.extent.setSpatialReference(D);else if(w.feature&&w.feature.geometry)switch(w.feature.geometry.type){case "extent":w.extent=w.feature.geometry;break;case "multipoint":w.extent=ma.getDenormalizedExtent(w.feature.geometry);break;case "polygon":w.extent=ma.getDenormalizedExtent(w.feature.geometry);break;case "polyline":w.extent=ma.getDenormalizedExtent(w.feature.geometry);
break;case "point":this.map?(D=this.zoomScale,u&&u.zoomScale&&(D=u.zoomScale),this._getScale()>D?w.extent=ea.getExtentForScale(this.map,D).centerAt(w.feature.geometry):w.extent=this.map.extent.centerAt(w.feature.geometry)):w.extent=new ka({xmin:w.feature.geometry.x-.25,ymin:w.feature.geometry.y-.25,xmax:w.feature.geometry.x+.25,ymax:w.feature.geometry.y+.25,spatialReference:this._defaultSR})}else w.extent=null;w.name="";u.featureLayer?u.suggestionTemplate&&v?w.name=L.substitute(c.attributes,u.suggestionTemplate):
u.searchTemplate?w.name=L.substitute(c.attributes,u.searchTemplate):(P=this._getDisplayField(u),v=u.featureLayer.getField(P),D=u.featureLayer.getDomain(P),P&&c.hasOwnProperty("attributes")&&c.attributes.hasOwnProperty(P)&&(c=c.attributes[P],D&&"codedValue"===D.type?w.name=this._getCodedName(D.codedValues,c):v&&"esriFieldTypeDate"===v.type&&!isNaN(c)?w.name=E.format(new Date(c)):w.name=c)):c.address&&u.searchTemplate?w.name=L.substitute(c.address,u.searchTemplate):c.hasOwnProperty("name")?w.name=c.name:
c.hasOwnProperty("attributes")&&"object"===typeof c.attributes&&c.attributes.LongLabel?w.name=c.attributes.LongLabel:c.hasOwnProperty("attributes")&&"object"===typeof c.attributes&&c.attributes.Match_addr?(w.name=c.attributes.Match_addr,c.attributes.Addr_type&&"POI"===c.attributes.Addr_type&&c.attributes.StAddr&&c.attributes.City?w.name+=" - "+c.attributes.StAddr+", "+c.attributes.City:c.attributes.Addr_type&&"POI"===c.attributes.Addr_type&&c.attributes.City&&(w.name+=" - "+c.attributes.City)):c.hasOwnProperty("address")&&
"string"===typeof c.address?w.name=c.address:c.hasOwnProperty("address")&&"object"===typeof c.address&&c.address.hasOwnProperty("Address")?c.address.hasOwnProperty("Match_addr")?w.name=c.address.Match_addr:c.address.hasOwnProperty("Address")&&(w.name=c.address.Address):w.feature&&w.feature.geometry&&(w.name=w.feature.geometry.x+","+w.feature.geometry.y);u.featureLayer&&w.feature&&X(w.feature,u.featureLayer);return w}},_getScale:function(){var c;this.map&&"function"===typeof this.map.getScale&&(c=
this.map.getScale());return c},_hydrateResults:function(c,u,v){var w=[],D=0;if(c&&c.length)for(D;D<c.length;D++){var P=this._hydrateResult(c[D],u,v);P&&w.push(P)}return w},_containsNonLatinCharacter:function(c){for(var u=0;u<c.length;u++)if(255<c.charCodeAt(u))return!0;return!1},_setPlaceholder:function(c){var u="",v=this.sources[c];c===this._allIndex?u=this.allPlaceholder||t.widgets.Search.main.allPlaceholder:v&&v.placeholder&&(u=v.placeholder);var w=t.widgets.Search.main.all;v&&(w=this._getSourceName(c));
d.set(this.sourceNameNode,"textContent",w);d.set(this.inputNode,"placeholder",u);d.set(this.inputNode,"title",u)},_updateActiveSource:function(){var c=this.sources,u=this.activeSourceIndex,v;c&&c[u]&&(v=c[u]);v?this.set("activeSource",v):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(c){c?(k.toggle(this.containerNode,this.css.searchExpanded,this.expanded),k.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),
k.add(this.containerNode,this.css.hasButtonMode)):(k.remove(this.containerNode,this.css.searchExpanded),k.remove(this.containerNode,this.css.searchCollapsed),k.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(c){c&&1===c.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(c){this._set("enableSourcesMenu",c);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(c){this._set("enableSearchingAll",
c);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(c){this._createSourceNameMap(c).then(m.hitch(this,function(u){this._sourceNames=u;this._created&&(this._setDefaultActiveSourceIndex(c),this._hideMenus(),this._insertSources(c))}));this._set("sources",c)},_setAllPlaceholderAttr:function(c){this._set("allPlaceholder",c);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(c){this._set("activeSourceIndex",
c);this._updateActiveSource();this._created&&(this._setPlaceholder(c),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(c){this._set("maxLength",c);this._created&&d.set(this.inputNode,"maxLength",c)},_setValueAttr:function(c){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",c);this._created&&(d.set(this.inputNode,"value",c),this._checkStatus())},_setVisibleAttr:function(c){this._set("visible",c);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(c){this._set("enableButtonMode",
c);this._created&&this._updateButtonMode(c)},_setThemeAttr:function(c){this._created&&(k.remove(this.domNode,this.theme),k.add(this.domNode,c));this._set("theme",c)}});b("extend-esri")&&m.setObject("dijit.Search",K,T);return K})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(G,K,m,y,x,h,l,g,a,b,e){G=G(b,{declaredClass:"esri.tasks.Locator",
_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(f){this._geocodeHandler=K.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=K.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=K.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(f){this.outSpatialReference=
f},_geocodeHandler:function(f,d,k,n,p){try{var E=f.candidates;d=[];var t,q=E.length,B=f.spatialReference,r;for(t=0;t<q;t++){var A=E[t];if(r=A.location)r.spatialReference=B;d[t]=new e(A)}this._successHandler([d],"onAddressToLocationsComplete",k,p)}catch(H){this._errorHandler(H,n,p)}},_geocodeAddressesHandler:function(f,d,k,n,p){try{var E=f.locations;d=[];var t,q=E.length,B=f.spatialReference,r;for(t=0;t<q;t++){if(r=E[t].location)r.spatialReference=B;d[t]=new e(E[t])}this._successHandler([d],"onAddressesToLocationsComplete",
k,p)}catch(A){this._errorHandler(A,n,p)}},addressToLocations:function(f,d,k,n,p){var E;if(f.address){n=k;k=d;d=f.outFields;p=f.searchExtent;var t=f.countryCode;var q=f.magicKey;var B=f.distance;var r=f.categories;f.location&&this.normalization&&(E=f.location.normalize());var A=f.locationType;var H=f.maxLocations;var J=f.forStorage;f=f.address}p&&(p=p.shiftCentralMeridian());var L=this.outSpatialReference;f=this._encode(K.mixin({},this._url.query,f,{f:"json",outSR:L&&x.toJson(L.toJson()),outFields:d&&
d.join(",")||null,searchExtent:p&&x.toJson(p.toJson()),category:r&&r.join(",")||null,countryCode:t||null,magicKey:q||null,distance:B||null,location:E||null,locationType:A||null,maxLocations:H||null,forStorage:J||null}));var M=this._geocodeHandler,T=this._errorHandler,W=new y(a._dfdCanceller);W._pendingDfd=g({url:this._url.path+"/findAddressCandidates",content:f,callbackParamName:"callback",load:function(C,I){M(C,I,k,n,W)},error:function(C){T(C,n,W)}});return W},suggestLocations:function(f){var d=
new y(a._dfdCanceller);f.hasOwnProperty("location")&&this.normalization&&(f.location=f.location.normalize());f.searchExtent&&(f.searchExtent=f.searchExtent.shiftCentralMeridian());f=this._encode(K.mixin({},this._url.query,{f:"json",text:f.text,maxSuggestions:f.maxSuggestions,searchExtent:f.searchExtent&&x.toJson(f.searchExtent.toJson()),category:f.categories&&f.categories.join(",")||null,countryCode:f.countryCode||null,location:f.location||null,distance:f.distance||null},{f:"json"}));f=g({url:this._url.path+
"/suggest",content:f,callbackParamName:"callback"});d._pendingDfd=f;f.then(K.hitch(this,function(k){k=k.suggestions||[];this.onSuggestLocationsComplete(k);d.resolve(k)}),K.hitch(this,function(k){this._errorHandler(k);d.reject(k)}));return d},addressesToLocations:function(f,d,k){var n=this.outSpatialReference,p=[],E=f.categories,t=f.locationType,q=f.countryCode;m.forEach(f.addresses,function(H,J){p.push({attributes:H})});f=this._encode(K.mixin({},this._url.query,{category:E&&E.join(",")||null,locationType:t||
null,sourceCountry:q||null},{addresses:x.toJson({records:p})},{f:"json",outSR:n&&x.toJson(n.toJson())}));var B=this._geocodeAddressesHandler,r=this._errorHandler,A=new y(a._dfdCanceller);A._pendingDfd=g({url:this._url.path+"/geocodeAddresses",content:f,callbackParamName:"callback",load:function(H,J){B(H,J,d,k,A)},error:function(H){r(H,k,A)}});return A},_reverseGeocodeHandler:function(f,d,k,n,p){try{var E=new e({address:f.address,location:f.location,score:100});this._successHandler([E],"onLocationToAddressComplete",
k,p)}catch(t){this._errorHandler(t,n,p)}},locationToAddress:function(f,d,k,n){f&&this.normalization&&(f=f.normalize());var p=this.outSpatialReference;f=this._encode(K.mixin({},this._url.query,{outSR:p&&x.toJson(p.toJson()),location:f&&x.toJson(f.toJson()),distance:d,f:"json"}));var E=this._reverseGeocodeHandler,t=this._errorHandler,q=new y(a._dfdCanceller);q._pendingDfd=g({url:this._url.path+"/reverseGeocode",content:f,callbackParamName:"callback",load:function(B,r){E(B,r,k,n,q)},error:function(B){t(B,
n,q)}});return q},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});h("extend-esri")&&K.setObject("tasks.Locator",G,l);return G})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(G,K,m,y,x){G=G(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(h){K.mixin(this,h);this.location=
new x(this.location)}});m("extend-esri")&&K.setObject("tasks.AddressCandidate",G,y);return G})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has","../kernel","../Color"],function(G,K,m,y,x){function h(e,f){if(e){var d={};d.color=new x(e.color);d.opacity=e.opacity||1;switch(f){case "point":d.outline={color:new x(e.outline.color),width:e.outline.width};d.size=e.size;break;case "line":d.width=e.width;break;case "polygon":d.outline={color:new x(e.outline.color),width:e.outline.width}}}return d}
function l(e){if("esriGeometryPoint"===e||"esriGeometryMultipoint"===e)e="point";else if("esriGeometryPolyline"===e)e="line";else if("esriGeometryPolygon"===e||"esriGeometryMultiPatch"===e)e="polygon";return e}var g={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),
dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},
{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},
opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},a={};(function(){var e,f,d;for(e in g){var k=g[e];var n=k.basemapGroups;var p=a[e]={basemaps:[].concat(n.light).concat(n.dark),point:{},line:{},polygon:{}};for(f in n){var E=
n[f];for(d=0;d<E.length;d++){var t=E[d];k.pointSchemes&&(p.point[t]=k.pointSchemes[f]);k.lineSchemes&&(p.line[t]=k.lineSchemes[f]);k.polygonSchemes&&(p.polygon[t]=k.polygonSchemes[f])}}}})();var b={getAvailableThemes:function(e){var f=[],d;for(d in g){var k=g[d];var n=a[d];e&&-1===G.indexOf(n.basemaps,e)||f.push({name:k.name,label:k.label,description:k.description,basemaps:n.basemaps.slice(0)})}return f},getSchemes:function(e){var f=e.theme,d=e.basemap,k=l(e.geometryType);e=a[f];var n;(e=(e=e&&e[k])&&
e[d])&&(n={primaryScheme:h(e.primary,k),secondarySchemes:G.map(e.secondary,function(p){return h(p,k)})});return n},cloneScheme:function(e){if(e){var f=K.mixin({},e);f.color&&(f.color=new x(f.color));f.outline&&(f.outline={color:f.outline.color&&new x(f.outline.color),width:f.outline.width})}return f}};m("extend-esri")&&K.setObject("styles.basic",b,y);return b})},"widgets/RelatedTableCharts/searchSourceUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils esri/lang esri/request".split(" "),
function(G,K,m,y,x,h,l,g){return{map:null,layerInfosObj:null,appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,setMap:function(a){this.map=a},setLayerInfosObj:function(a){this.layerInfosObj=a},setAppConfig:function(a){this.appConfig=a},getConfigInfo:function(a){if(a&&a.sources&&0<a.sources.length){var b=null;return this.searchLayer(this.map)&&a.upgradeFromGeocoder?(b=this.map.itemInfo.itemData.applicationProperties.viewing.search,b=K.map(b.layers,
G.hitch(this,function(e,f){f.hintText=e;return this._getQueryTypeGeocoder(f)},b.hintText)),x(b).then(G.hitch(this,function(e){a.sources=[].concat(e).concat(a.sources);return a}))):a}return y(this._getSoucesFromPortalAndWebmap()).then(G.hitch(this,function(e){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:e}}))},_getSoucesFromPortalAndWebmap:function(){var a=[],b=null;this.searchLayer(this.map)&&(b=this.map.itemInfo.itemData.applicationProperties.viewing.search,K.forEach(b.layers,G.hitch(this,
function(e,f){f.hintText=e;a.push(this._getQueryTypeGeocoder(f))},b.hintText)));return h.getPortalSelfInfo(this.appConfig.portalUrl).then(G.hitch(this,function(e){if((e=e.helperServices&&e.helperServices.geocode)&&0<e.length)for(var f=0,d=e.length;f<d;f++){var k=e[f];k&&a.push(this._processSingleLine(k))}return x(a).then(G.hitch(this,function(n){for(var p=[],E=0;E<n.length;E++){var t=n[E];t&&(t&&"query"===t.type?p.push(t):(t={name:t.name||this._getGeocodeName(t.url),url:t.url,singleLineFieldName:t.singleLineFieldName,
placeholder:t.placeholder||t.name||this._getGeocodeName(t.url),maxResults:6,searchInCurrentMapExtent:!1,type:"locator"},t.enableLocalSearch=this._isEsriLocator(t.url),t.localSearchMinScale=3E5,t.localSearchDistance=5E4,p.push(t)))}return p}))}))},_getQueryTypeGeocoder:function(a){var b=this.map.getLayer(a.id),e=null,f=null,d=null;d=l.isDefined(a.subLayer)?a.id+"_"+a.subLayer:a.id;e=this.layerInfosObj.traversal(function(k){return k.id===d?(f=k,!0):!1});return b&&e&&f?(e=l.isDefined(a.subLayer)?f.url||
b.url+"/"+a.subLayer:f.url||b.url,{name:f.title,layerId:d,url:e,placeholder:a.hintText,searchFields:[a.field.name],displayField:a.field.name,exactMatch:a.field.exactMatch||!1,maxResults:6,searchInCurrentMapExtent:!1,type:"query"}):null},_isEsriLocator:function(a){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(a)},_processSingleLine:function(a){if(a.singleLineFieldName)return a;if(this._isEsriLocator(a.url))return a.singleLineFieldName="SingleLine",a;var b=new m;g({url:a.url,
content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(G.hitch(this,function(e){e.singleLineAddressField&&e.singleLineAddressField.name?(a.singleLineFieldName=e.singleLineAddressField.name,b.resolve(a)):(console.warn(a.url+"has no singleLineFieldName"),b.resolve(null))}),G.hitch(this,function(e){console.error(e);b.resolve(null)}));return b.promise},_getGeocodeName:function(a){if("string"!==typeof a)return"geocoder";a=a.split("/");return a[a.length-2]||"geocoder"},getGeocoderName:function(a){return this._getGeocodeName(a)},
hasAppSearchInfo:function(a){return a.itemInfo&&a.itemInfo.itemData&&a.itemInfo.itemData.applicationProperties&&a.itemInfo.itemData.applicationProperties.viewing&&a.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(a){if(!this.hasAppSearchInfo(a))return!1;a=a.itemInfo.itemData.applicationProperties.viewing.search;return a.enabled&&0!==a.layers.length?!0:!1}}})},"widgets/RelatedTableCharts/Accordion":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/Evented dojo/_base/array dojo/_base/lang dojo/on dojo/query dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-attr ./ChartLayout jimu/utils dojo/keys dijit/focus".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e,f,d,k,n){return K([G,m],{openPanels:[],chartArray:[],constructor:function(){},postCreate:function(){this.inherited(arguments)},initAccordionPane:function(){var p,E;(this.config.charts.highlightedChartIndex||0===this.config.charts.highlightedChartIndex)&&-1===y.indexOf(this.openPanels,"Chart"+this.config.charts.highlightedChartIndex)&&this.openPanels.push("Chart"+this.config.charts.highlightedChartIndex);var t=g.create("div",{"class":"esriCTAccordionWrapper"},this.node);
this.chartArray=[];y.forEach(this.config.charts,x.hitch(this,function(B,r){var A="Chart"+r;var H=g.create("div",{"class":"esriCTChartRow",chartIndex:A},t);var J=d.sanitizeHTML(B.chartConfig.sectionTitle);J=g.create("div",{"class":"esriCTChartTitle",innerHTML:J,title:J,role:"button",tabindex:0,"aria-label":J,"aria-expanded":"false"},H);var L=g.create("div",{"class":"esriCTChartContent"},H);B.chartData&&B.selectedFeature?(p=new f({nls:this.nls,config:B},g.create("div",{},L)),this.own(h(p,"setFocusNodes",
x.hitch(this,function(){this.emit("setFocusNodes")}))),p.onChartCreated=x.hitch(this,function(){this.openPanels.length?-1===this.openPanels.indexOf(A)&&a.add(L,"esriCTHidden"):0!==r&&a.add(L,"esriCTHidden")}),p.onChartResize=x.hitch(this,function(){this.openPanels.length&&this._setFocusOnChart()}),this.chartArray.push(p),p.startup(),h(J,"click",x.hitch(this,function(M){this._expandChart(M,r)})),h(J,"keydown",x.hitch(this,function(M){M.keyCode!==k.ENTER&&M.keyCode!==k.SPACE||this._expandChart(M,r)}))):
(this.chartArray.push(null),a.add(H,"esriCTDisabledRow"),a.add(L,"esriCTHidden"));-1!==this.openPanels.indexOf(A)&&this._toggleSelectedChart(J,!1);0!==r||this.openPanels.length||(this.config.charts.highlightedChartIndex=r,this._toggleSelectedChart(J,!1))}));var q=l(".esriCTChartTitle",this.node);0<q.length&&(E=q[0]);""!==E&&null!==E&&void 0!==E&&n.focus(E)},_setFocusOnChart:function(){var p=this.config.charts.highlightedChartIndex;p=l(".esriCTChartRow",this.node)[p];var E=l(".esriCTResultsPanel")[0];
p&&E&&(E.scrollTop=p.offsetTop-81);this.emit("setFocusNodes")},_toggleSelectedChart:function(p,E){var t=l(".esriCTChartContent",p.parentElement)[0];var q=e.get(p.parentElement,"chartIndex");var B=q.split("Chart")[1];E?(a.add(t,"esriCTHidden"),a.remove(p,"esriCTChartSelected"),-1!==this.openPanels.indexOf(q)&&this.openPanels.splice(this.openPanels.indexOf(q),1),e.set(p,"aria-expanded","false")):(this.config.charts[B].chartData&&(a.remove(t,"esriCTHidden"),a.add(p,"esriCTChartSelected"),this.chartArray[B]&&
this.chartArray[B].resizeChart(0),this.config.charts.highlightedChartIndex===parseInt(B,10)&&this._highlightChart(p,B),e.set(p,"aria-expanded","true")),-1===this.openPanels.indexOf(q)&&this.openPanels.push(q));this.emit("setFocusNodes")},_highlightChart:function(p,E){this.emit("chartSelected",E);l(".esriCTChartHighlighted").length&&(a.remove(l(".esriCTChartHighlighted")[0],"esriCTSelectedChartBorder"),a.remove(l(".esriCTChartHighlighted")[0],"esriCTChartHighlighted"));a.add(p,"esriCTChartHighlighted");
a.add(p,"esriCTSelectedChartBorder");b.set(p,"border-color",this.config.selectedThemeColor)},resizeContents:function(){y.forEach(this.chartArray,x.hitch(this,function(p,E){p&&p.config.chartData&&-1!==this.openPanels.indexOf("Chart"+E)&&p.resizeChart(300)}))},_expandChart:function(p,E){a.contains(p.currentTarget,"esriCTChartSelected")?a.contains(p.currentTarget,"esriCTChartHighlighted")?this._toggleSelectedChart(p.currentTarget,!0):(this.config.charts.highlightedChartIndex=E,this._highlightChart(p.currentTarget,
E)):(this.config.charts.highlightedChartIndex=E,this._toggleSelectedChart(p.currentTarget,!1))}})})},"widgets/RelatedTableCharts/ChartLayout":function(){define("jimu/BaseWidgetSetting jimu/utils dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/_base/declare dojo/_base/lang dijit/_WidgetsInTemplateMixin dojo/text!./ChartLayout.html dojox/charting/Chart dojox/charting/plot2d/Pie dojox/charting/action2d/Tooltip dojox/charting/action2d/Highlight dojox/charting/action2d/MoveSlice dojox/charting/plot2d/Spider dojox/charting/widget/SelectableLegend dojox/charting/action2d/Magnify dojo/_base/array dojox/charting/Theme dojo/Evented dojox/charting/plot2d/Bars dojox/charting/axis2d/Default dojox/charting/plot2d/Lines".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e,f,d,k,n,p,E,t,q,B){return h([G,g,B],{baseClass:"jimu-widget-RelatedTableCharts-layout",templateString:a,postCreate:function(){this.inherited(arguments)},startup:function(){this._createChartLayout()},_createChartLayout:function(){this._setNodeValue(this.layoutHeaderTitle,this.config.chartConfig.chartTitle,!0);this._setNodeValue(this.chartDescription,this.config.chartConfig.description,!1);this._initChart()},resizeChart:function(r){this.chart&&setTimeout(l.hitch(this,
function(){"PieChart"!==this.config.chartConfig.chartType?this.chart.resize():this._initChart();this.onChartResize()}),r)},_setNodeValue:function(r,A,H){var J=A;this.config.isPreview||(J=this._getFieldValues(A,this.config.selectedFeature.attributes));J?(J=K.sanitizeHTML(J),m.set(r,"innerHTML",J),H&&m.set(r,"title",J)):x.set(r,"display","none")},_initChart:function(){switch(this.config.chartConfig.chartType){case "BarChart":this._createBarChart();break;case "PieChart":this._createPieChart();break;
case "PolarChart":this._createPolarChart();break;case "LineChart":this._createLineChart();break;default:m.set(this.chartContainer,"innerHTML",this.nls.errMsgNoFeaturesFound)}},_getBarChartContainerHeight:function(){var r=30;0<this.config.chartData.chartSeries.length&&(r=30*this.config.chartData.chartSeries.length);this.config.isPreview?150>=r&&(r+=150):150>=r&&(r+=100);return r+"px"},_createBarChart:function(){var r={},A={};r=40;var H={};y.empty(this.chartContainer);r=this._getBarChartContainerHeight();
var J=new b(y.create("div",{style:"overflow:hidden; width:100%; height:"+r},this.chartContainer));J.addPlot("default",{type:"Bars",gap:4,minBarSize:10,maxBarSize:15});A=x.get(this.chartDescription,"fontFamily");var L=x.get(this.chartDescription,"fontSize");var M=x.get(this.chartDescription,"color");r={labels:this.config.chartData.chartLabels,maxLabelCharCount:35,trailingSymbol:"...",natural:!0,majorTickStep:1,minorTicks:!1,fixUpper:!0,includeZero:!1,vertical:!0,titleFontColor:M,titleFont:"normal normal normal "+
L+" "+A,font:"normal normal normal 9px "+A};window.isRTL&&(r.leftBottom=!1,J.setDir("rtl"));A={fixLower:"major",fixUpper:"major",minorTicks:!1,includeZero:!0,titleFontColor:M,titleFont:"normal normal normal "+L+" "+A,font:"normal normal normal 9px "+A};this.config.isPreview?(A.titleGap=5,r.majorTick={length:0},A.majorTick={length:0},r.majorLabels=!1,A.majorLabels=!1,r.minorLabels=!1,A.minorLabels=!1,r.title=this.config.chartConfig.labelYAxis,A.title=this.config.chartConfig.labelXAxis,H.stroke={width:0}):
(new f(J,"default"),r.title=this._getFieldValues(this.config.chartConfig.labelYAxis,this.config.selectedFeature.attributes),A.title=this._getFieldValues(this.config.chartConfig.labelXAxis,this.config.selectedFeature.attributes),H.stroke={width:1});A.titleOrientation="away";J.addAxis("y",r);J.addAxis("x",A);this.config.chartData.selectedTheme&&J.setTheme(this.config.chartData.selectedTheme);this.config.chartData.fill&&(H.fill=this.config.chartData.fill);t.forEach(this.config.chartData.chartSeries,
function(T,W){T.x=W+1;T.y=T.y;J.addSeries(W+1,[T],H,{plot:"default"})},this);new d(J,"default");J.render();this.chart=J;this.onChartCreated()},_createLineChart:function(){var r={};r.marker=q.defaultMarkers.CIRCLE;r.markerStroke={width:1};y.empty(this.chartContainer);var A=new b(y.create("div",{style:"overflow:hidden; width:100%; height:"+(this.config.isPreview?"300px":"270px")},this.chartContainer));var H=x.get(this.chartDescription,"fontFamily");var J=x.get(this.chartDescription,"fontSize");var L=
x.get(this.chartDescription,"color");var M={maxLabelCharCount:30,trailingSymbol:"...",natural:!0,vertical:!0,titleGap:0,titleFontColor:L,titleFont:"normal normal normal "+J+" "+H,max:this._calculateMajorTickStep(!0,!0),majorLabels:!0,minorTicks:!0,minorLabels:!0,microTicks:!1,fixLower:"major",fixUpper:"major",majorTickStep:this._calculateMajorTickStep(!0,!1)};this._setLineChartYaxisMin(M);this.config.isPreview||(M.font="normal normal bold 9px "+H);window.isRTL&&(M.leftBottom=!1,A.setDir("rtl"));H=
{labels:this.config.chartData.chartLabels[0],maxLabelCharCount:35,trailingSymbol:"...",titleGap:0,titleFontColor:L,titleFont:"normal normal normal "+J+" "+H,font:"normal normal bold "+this._calculateXAxisLabelFontSize(this.config.chartData.chartLabels[0].length)+"px "+H,titleOrientation:"away",rotation:-90,minorLabels:!0,majorLabels:!0,minorTicks:!0,microTicks:!1,max:this.config.chartData.chartLabels[0].length+.5,min:.5};this.config.isPreview?(M.minorLabels=!1,M.majorLabels=!0,M.title=this.config.chartConfig.labelYAxis,
H.minorLabels=!0,H.majorLabels=!0,H.title=this.config.chartConfig.labelXAxis,H.max=11):(M.title=this._getFieldValues(this.config.chartConfig.labelYAxis,this.config.selectedFeature.attributes),H.title=this._getFieldValues(this.config.chartConfig.labelXAxis,this.config.selectedFeature.attributes));r.stroke={width:1};A.addPlot("default",{type:"Lines",markers:!0,styleFunc:l.hitch(this,function(C){return this.config.chartConfig.chartColor&&"ColorByFieldValue"===this.config.chartConfig.chartColor.colorType?
(C=this.config.chartConfig.chartColor.colorInfo.layerFieldValues[C])?{fill:C}:{fill:"#000000"}:this.config.isPreview?{fill:"#0000ff"}:{fill:"#000000"}})});A.addAxis("y",M);A.addAxis("x",H);this.config.chartData.selectedTheme&&A.setTheme(this.config.chartData.selectedTheme);this.config.chartData.fill&&(r.stroke.color=this.config.chartData.fill);var T=Object.keys(q.defaultMarkers);T[3]&&T[5]&&this.swap(T,3,5);T[4]&&T[6]&&this.swap(T,4,6);var W=T.length;t.forEach(this.config.chartData.chartSeries,l.hitch(this,
function(C,I){var O=C[0]&&C[0].seriesName?C[0].seriesName:this.nls.ChartSetting.layoutSeriesLabel+" "+I;if(this.config.chartConfig.chartColor&&"ColorByFieldValue"===this.config.chartConfig.chartColor.colorType||this.config.isPreview)r.stroke.color="#"+Math.floor(16777215*Math.random()).toString(16);this.config.chartData.fill&&(I<W?r.marker=q.defaultMarkers[T[I]]:(I%=W,r.marker=q.defaultMarkers[T[I]]));A.addSeries(O,C,l.clone(r))}));new f(A,"default");new d(A,"default");new E(A,"default");A.render();
this.chart=A;x.set(this.legendContainer,"display","block");1<this.config.chartData.chartSeries.length&&this._createChartLegend(A,!0);this.onChartCreated()},swap:function(r,A,H){var J=r[A];r[A]=r[H];r[H]=J},_calculateXAxisLabelFontSize:function(r){switch(!0){case 20>r:return 9;case 20<=r:return 9;default:return 9}},_calculateMajorTickStep:function(r,A){var H=[];r&&this.config.chartData.chartSeries.forEach(l.hitch(this,function(J){J.forEach(l.hitch(this,function(L){A?H.push(L.y):H.push(Math.abs(L.y))}))}));
if(0<H.length){r=Math.max.apply(null,H);if(A)return r+1;r/=20;r=Math.round(r)?Math.round(r):r}else r=null;return Math.abs(r)},_createPieChart:function(){var r={};y.empty(this.chartContainer);var A=y.create("div",{style:"width:100%; height:100%; overflow:auto"},this.chartContainer);A=new b(A);r={type:e,labels:!0,ticks:!0,fixed:!0,precision:0,labelWiring:"#ccc",labelStyle:"columns",htmlLabels:!0,startAngle:-10,maxLabelCharCount:20,trailingSymbol:"..."};"esriCTEmptyOption"===this.config.chartConfig.labelField&&
(r.labels=!1);A.addPlot("default",r);this.config.isPreview||new f(A,"default");this.config.chartData.fill?A.addSeries(this.config.chartConfig.dataSeriesField,this.config.chartData.chartSeries,{fill:this.config.chartData.fill},{plot:"default"}):A.addSeries(this.config.dataSeriesField,this.config.chartData.chartSeries,{plot:"default"});this.config.chartData.selectedTheme&&A.setTheme(this.config.chartData.selectedTheme);new k(A,"default");new d(A,"default");A.render();this.chart=A;this.onChartCreated()},
_createPolarChart:function(){var r,A=.2,H=!1;this.chart&&this.chart.destroy();y.empty(this.chartContainer);x.set(this.chartContainer,"direction","inherit");var J=y.create("div",{style:"width:100%; height:100%; overflow:hidden"},this.chartContainer);var L=x.get(this.chartDescription,"fontFamily");J=new b(J);this.config.chartConfig.showPolygonFill||(A=0);J.addPlot("default",{type:n,labelOffset:-10,divisions:5,seriesFillAlpha:A,markerSize:3,precision:0,spiderType:"polygon",axisFont:"normal normal normal 9px/25px "+
L});this.config.chartData.selectedTheme?J.setTheme(this.config.chartData.selectedTheme):this.config.chartConfig.chartColor.colorInfo&&this.config.chartConfig.chartColor.colorInfo.layerField&&(H=!0);for(A=0;A<this.config.chartData.chartSeries.length;A++)for(r in L=this.config.chartData.chartSeries[A],L)L.hasOwnProperty(r)&&(this.config.chartData.fill?J.addSeries(r,L[r],{fill:this.config.chartData.fill}):L[r].fill?J.addSeries(r,L[r],{fill:L[r].fill,legend:L[r].legendLabel}):J.addSeries(r,L[r]));this.config.isPreview||
new f(J,"default");new d(J,"default");new E(J,"default",{duration:800,scale:1.5});J.render();this.chart=J;!this.config.isPreview&&H&&(x.set(this.legendContainer,"display","block"),this._createChartLegend(J,!0));this.onChartCreated()},_createChartLegend:function(r,A){setTimeout(l.hitch(this,function(){this.legend&&(this.legend.destroy(),this.legend=null);y.empty(this.legendNode);this.legend=new p({chart:r,horizontal:A},y.create("div",{},this.legendNode));this.emit("setFocusNodes")}),1500)},onChartCreated:function(){},
onChartResize:function(){},_getFieldValues:function(r,A){var H="",J,L;r=r.replace(/(\n|\r|\r\n)/g,"\x3cbr\x3e");var M=r.split("{");for(J=0;J<M.length;J++)if(0===J)H+=M[J];else if(-1!==M[J].indexOf("}"))for(r=M[J].split("}"),L=0;L<r.length;L++)if(0===L){if(A[r[L]]||0===A[r[L]])H+=A[r[L]]}else H=1===L?H+r[L]:H+("}"+r[L]);else H+="{";return H},_setLineChartYaxisMin:function(r){var A=[];var H=[];t.forEach(this.config.chartData.chartSeries,l.hitch(this,function(L){t.forEach(L,l.hitch(this,function(M){0<=
M.y&&A.push(M.y);H.push(M.y)}))}));if(A.length===H.length)r.min=0;else{var J=Math.min.apply(null,H);r.min=J-1}}})})},"dojox/charting/Chart":function(){define("../main dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/dom-style dojo/dom dojo/dom-geometry dojo/dom-construct dojo/_base/Color dojo/sniff ./Element ./SimpleTheme ./Series ./axis2d/common ./plot2d/common dojox/gfx/shape dojox/gfx dojo/has!dojo-bidi?./bidi/Chart dojox/lang/functional dojox/lang/functional/fold dojox/lang/functional/reversed".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e,f,d,k,n,p,E,t,q){function B(C){return C.clear()}function r(C){return C.destroy()}function A(C){return C.dirty=!1}function H(C){return C.dirty=!0}function J(C){return C.name}function L(C,I){C&&I&&(C.min=Math.min(C.min,I.min),C.max=Math.max(C.max,I.max));return C||I}function M(C,I){var O={},S={};m.forEach(C,function(Q){var N=O[Q.name]=Q.getSeriesStats();Q.hAxis&&(S[Q.hAxis]=L(S[Q.hAxis],{min:N.hmin,max:N.hmax}));Q.vAxis&&(S[Q.vAxis]=L(S[Q.vAxis],{min:N.vmin,max:N.vmax}))});
m.forEach(C,function(Q){var N=O[Q.name];if(Q.hAxis){var ba=S[Q.hAxis];N.hmin=ba.min;N.hmax=ba.max}Q.vAxis&&(ba=S[Q.vAxis],N.vmin=ba.min,N.vmax=ba.max);Q.initializeScalers(I,N)})}var T=K.getObject("charting",!0,G),W={l:10,t:10,r:10,b:10};G=y(b("dojo-bidi")?"dojox.charting.NonBidiChart":"dojox.charting.Chart",null,{constructor:function(C,I){I||(I={});this.margins=I.margins||W;this._customMargins=!!I.margins;this.stroke=I.stroke;this.fill=I.fill;this.delayInMs=I.delayInMs||200;this.title=I.title;this.titleGap=
I.titleGap;this.titlePos=I.titlePos;this.titleFont=I.titleFont;this.titleFontColor=I.titleFontColor;this.titleAlign=I.titleAlign;this.chartTitle=null;this.htmlLabels=!0;"htmlLabels"in I&&(this.htmlLabels=I.htmlLabels);this.theme=null;this.axes={};this.stack=[];this.plots={};this.series=[];this.runs={};this.dirty=!0;this.node=h.byId(C);C=l.getMarginBox(C);this.surface=E.createSurface(this.node,C.w||400,C.h||300);-1==this.surface.declaredClass.indexOf("vml")&&(this._nativeClip=!0)},destroy:function(){m.forEach(this.series,
r);m.forEach(this.stack,r);q.forIn(this.axes,r);this.surface.destroy();this.chartTitle&&this.chartTitle.tagName&&g.destroy(this.chartTitle)},getCoords:function(){var C=this.node,I=x.getComputedStyle(C);I=l.getMarginBox(C,I);C=l.position(C,!0);I.x=C.x;I.y=C.y;return I},setTheme:function(C){this.theme=C.clone();this._customMargins||(this.margins=this.theme.chart.margins||W);this.dirty=!0;return this},addAxis:function(C,I){var O=I&&I.type||"Default";if("string"==typeof O){if(!T.axis2d||!T.axis2d[O])throw Error("Can't find axis: "+
O+" - Check require() dependencies.");I=new T.axis2d[O](this,I)}else I=new O(this,I);I.name=C;I.dirty=!0;C in this.axes&&this.axes[C].destroy();this.axes[C]=I;this.dirty=!0;return this},getAxis:function(C){return this.axes[C]},removeAxis:function(C){C in this.axes&&(this.axes[C].destroy(),delete this.axes[C],this.dirty=!0);return this},addPlot:function(C,I){var O=I&&I.type||"Default";if("string"==typeof O){if(!T.plot2d||!T.plot2d[O])throw Error("Can't find plot: "+O+" - didn't you forget to dojo.require() it?");
I=new T.plot2d[O](this,I)}else I=new O(this,I);I.name=C;I.dirty=!0;C in this.plots?(this.stack[this.plots[C]].destroy(),this.stack[this.plots[C]]=I):(this.plots[C]=this.stack.length,this.stack.push(I));this.dirty=!0;return this},getPlot:function(C){return this.stack[this.plots[C]]},removePlot:function(C){if(C in this.plots){var I=this.plots[C];delete this.plots[C];this.stack[I].destroy();this.stack.splice(I,1);q.forIn(this.plots,function(S,Q,N){S>I&&(N[Q]=S-1)});var O=m.filter(this.series,function(S){return S.plot!=
C});O.length<this.series.length&&(m.forEach(this.series,function(S){S.plot==C&&S.destroy()}),this.runs={},m.forEach(O,function(S,Q){this.runs[S.plot]=Q},this),this.series=O);this.dirty=!0}return this},getPlotOrder:function(){return q.map(this.stack,J)},setPlotOrder:function(C){var I={},O=q.filter(C,function(S){if(!(S in this.plots)||S in I)return!1;I[S]=1;return!0},this);O.length<this.stack.length&&q.forEach(this.stack,function(S){S=S.name;S in I||O.push(S)});C=q.map(O,function(S){return this.stack[this.plots[S]]},
this);q.forEach(C,function(S,Q){this.plots[S.name]=Q},this);this.stack=C;this.dirty=!0;return this},movePlotToFront:function(C){if(C in this.plots){var I=this.plots[C];if(I){var O=this.getPlotOrder();O.splice(I,1);O.unshift(C);return this.setPlotOrder(O)}}return this},movePlotToBack:function(C){if(C in this.plots){var I=this.plots[C];if(I<this.stack.length-1){var O=this.getPlotOrder();O.splice(I,1);O.push(C);return this.setPlotOrder(O)}}return this},addSeries:function(C,I,O){I=new d(this,I,O);I.name=
C;C in this.runs?(this.series[this.runs[C]].destroy(),this.series[this.runs[C]]=I):(this.runs[C]=this.series.length,this.series.push(I));this.dirty=!0;!("ymin"in I)&&"min"in I&&(I.ymin=I.min);!("ymax"in I)&&"max"in I&&(I.ymax=I.max);return this},getSeries:function(C){return this.series[this.runs[C]]},removeSeries:function(C){if(C in this.runs){var I=this.runs[C];delete this.runs[C];this.series[I].destroy();this.series.splice(I,1);q.forIn(this.runs,function(O,S,Q){O>I&&(Q[S]=O-1)});this.dirty=!0}return this},
updateSeries:function(C,I,O){C in this.runs&&(C=this.series[this.runs[C]],C.update(I),O?this.dirty=!0:(this._invalidateDependentPlots(C.plot,!1),this._invalidateDependentPlots(C.plot,!0)));return this},getSeriesOrder:function(C){return q.map(q.filter(this.series,function(I){return I.plot==C}),J)},setSeriesOrder:function(C){var I,O={},S=q.filter(C,function(Q){if(!(Q in this.runs)||Q in O)return!1;var N=this.series[this.runs[Q]];if(I){if(N.plot!=I)return!1}else I=N.plot;O[Q]=1;return!0},this);q.forEach(this.series,
function(Q){var N=Q.name;N in O||Q.plot!=I||S.push(N)});this.series=q.map(S,function(Q){return this.series[this.runs[Q]]},this).concat(q.filter(this.series,function(Q){return Q.plot!=I}));q.forEach(this.series,function(Q,N){this.runs[Q.name]=N},this);this.dirty=!0;return this},moveSeriesToFront:function(C){if(C in this.runs){var I=this.runs[C],O=this.getSeriesOrder(this.series[I].plot);if(C!=O[0])return O.splice(I,1),O.unshift(C),this.setSeriesOrder(O)}return this},moveSeriesToBack:function(C){if(C in
this.runs){var I=this.runs[C],O=this.getSeriesOrder(this.series[I].plot);if(C!=O[O.length-1])return O.splice(I,1),O.push(C),this.setSeriesOrder(O)}return this},resize:function(C,I){switch(arguments.length){case 1:l.setMarginBox(this.node,C);break;case 2:l.setMarginBox(this.node,{w:C,h:I})}var O=l.getMarginBox(this.node),S=this.surface.getDimensions();return S.width!=O.w||S.height!=O.h?(this.surface.setDimensions(O.w,O.h),this.dirty=!0,this.render()):this},getGeometry:function(){var C={};q.forIn(this.axes,
function(I){I.initialized()&&(C[I.name]={name:I.name,vertical:I.vertical,scaler:I.scaler,ticks:I.ticks})});return C},setAxisWindow:function(C,I,O,S){var Q=this.axes[C];Q&&(Q.setWindow(I,O),m.forEach(this.stack,function(N){if(N.hAxis==C||N.vAxis==C)N.zoom=S}));return this},setWindow:function(C,I,O,S,Q){"plotArea"in this||this.calculateGeometry();q.forIn(this.axes,function(N){var ba=N.getScaler().bounds;var V=ba.span/(ba.upper-ba.lower);N.vertical?(ba=I,V=S/V/ba):(ba=C,V=O/V/ba);N.setWindow(ba,V)});
m.forEach(this.stack,function(N){N.zoom=Q});return this},zoomIn:function(C,I,O){var S=this.axes[C];if(S){S=S.getScaler().bounds;var Q=Math.min(I[0],I[1]),N=Math.max(I[0],I[1]);Q=I[0]<S.lower?S.lower:Q;N=I[1]>S.upper?S.upper:N;this.setAxisWindow(C,(S.upper-S.lower)/(N-Q),Q-S.lower);O?this.delayedRender():this.render()}},calculateGeometry:function(){if(this.dirty)return this.fullGeometry();var C=m.filter(this.stack,function(I){return I.dirty||I.hAxis&&this.axes[I.hAxis].dirty||I.vAxis&&this.axes[I.vAxis].dirty},
this);M(C,this.plotArea);return this},fullGeometry:function(){this._makeDirty();m.forEach(this.stack,B);this.theme||this.setTheme(new f);m.forEach(this.series,function(Q){if(!(Q.plot in this.plots)){if(!T.plot2d||!T.plot2d.Default)throw Error("Can't find plot: Default - didn't you forget to dojo.require() it?");var N=new T.plot2d.Default(this,{});N.name=Q.plot;this.plots[Q.plot]=this.stack.length;this.stack.push(N)}this.stack[this.plots[Q.plot]].addSeries(Q)},this);m.forEach(this.stack,function(Q){Q.assignAxes&&
Q.assignAxes(this.axes)},this);var C=this.dim=this.surface.getDimensions();C.width=E.normalizedLength(C.width);C.height=E.normalizedLength(C.height);q.forIn(this.axes,B);M(this.stack,C);var I=this.offsets={l:0,r:0,t:0,b:0},O=this;q.forIn(this.axes,function(Q){b("dojo-bidi")&&O._resetLeftBottom(Q);q.forIn(Q.getOffsets(),function(N,ba){I[ba]=Math.max(N,I[ba])})});if(this.title){this.titleGap=0==this.titleGap?0:this.titleGap||this.theme.chart.titleGap||20;this.titlePos=this.titlePos||this.theme.chart.titlePos||
"top";this.titleFont=this.titleFont||this.theme.chart.titleFont;this.titleFontColor=this.titleFontColor||this.theme.chart.titleFontColor||"black";this.titleAlign=this.titleAlign||this.theme&&this.theme.chart&&this.theme.chart.titleAlign||"middle";var S=E.normalizedLength(E.splitFontString(this.titleFont).size);I["top"==this.titlePos?"t":"b"]+=S+this.titleGap}q.forIn(this.margins,function(Q,N){I[N]+=Q});this.plotArea={width:C.width-I.l-I.r,height:C.height-I.t-I.b};q.forIn(this.axes,B);M(this.stack,
this.plotArea);return this},render:function(){this._delayedRenderHandle&&(clearTimeout(this._delayedRenderHandle),this._delayedRenderHandle=null);this.theme&&this.theme.clear();if(this.dirty)return this.fullRender();this.calculateGeometry();q.forEachRev(this.stack,function(C){C.render(this.dim,this.offsets)},this);q.forIn(this.axes,function(C){C.render(this.dim,this.offsets)},this);this._makeClean();return this},fullRender:function(){this.fullGeometry();var C=this.offsets,I=this.dim,O=Math.max(0,
I.width-C.l-C.r),S=Math.max(0,I.height-C.t-C.b);m.forEach(this.series,n.purgeGroup);q.forIn(this.axes,n.purgeGroup);m.forEach(this.stack,n.purgeGroup);var Q=this.surface.children;if(p.dispose)for(var N=0;N<Q.length;++N)p.dispose(Q[N]);this.chartTitle&&this.chartTitle.tagName&&g.destroy(this.chartTitle);this.surface.clear();this.chartTitle=null;this._renderChartBackground(I,C);this._renderPlotBackground(I,C,O,S);q.foldr(this.stack,function(ba,V){return V.render(I,C),0},0);this._nativeClip||this._renderChartBackground(I,
C);this.title&&this._renderTitle(I,C);q.forIn(this.axes,function(ba){ba.render(I,C)});this._makeClean();return this},_renderTitle:function(C,I){var O="canvas"==E.renderer&&this.htmlLabels||!b("ie")&&!b("opera")&&this.htmlLabels?"html":"gfx",S=E.normalizedLength(E.splitFontString(this.titleFont).size),Q=E._base._getTextBox(this.title,{font:this.titleFont}),N=this.titleAlign,ba=b("dojo-bidi")&&this.isRightToLeft(),V=C.width/2;"edge"===N?(N="left",V=ba?C.width-(I.r+Q.w):I.l):"middle"!=N&&(ba&&(N="left"===
N?"right":"left"),"left"===N?V=this.margins.l:"right"===N&&(N="left",V=C.width-(this.margins.l+Q.w)));this.chartTitle=k.createText[O](this,this.surface,V,"top"==this.titlePos?S+this.margins.t:C.height-this.margins.b,N,this.title,this.titleFont,this.titleFontColor)},_renderChartBackground:function(C,I){var O=this.theme,S=void 0!==this.fill?this.fill:O.chart&&O.chart.fill;O=void 0!==this.stroke?this.stroke:O.chart&&O.chart.stroke;if("inherit"==S){var Q=this.node;for(S=new a(x.get(Q,"backgroundColor"));0==
S.a&&Q!=document.documentElement;)S=new a(x.get(Q,"backgroundColor")),Q=Q.parentNode}S&&(this._nativeClip?(S=e.prototype._shapeFill(e.prototype._plotFill(S,C),{x:0,y:0,width:C.width+1,height:C.height+1}),this.surface.createRect({width:C.width+1,height:C.height+1}).setFill(S)):(S=e.prototype._plotFill(S,C,I),I.l&&(Q={x:0,y:0,width:I.l,height:C.height+1},this.surface.createRect(Q).setFill(e.prototype._shapeFill(S,Q))),I.r&&(Q={x:C.width-I.r,y:0,width:I.r+1,height:C.height+2},this.surface.createRect(Q).setFill(e.prototype._shapeFill(S,
Q))),I.t&&(Q={x:0,y:0,width:C.width+1,height:I.t},this.surface.createRect(Q).setFill(e.prototype._shapeFill(S,Q))),I.b&&(Q={x:0,y:C.height-I.b,width:C.width+1,height:I.b+2},this.surface.createRect(Q).setFill(e.prototype._shapeFill(S,Q)))));O&&this.surface.createRect({width:C.width-1,height:C.height-1}).setStroke(O)},_renderPlotBackground:function(C,I,O,S){var Q=this.theme,N=Q.plotarea&&Q.plotarea.fill;Q=Q.plotarea&&Q.plotarea.stroke;var ba={x:I.l-1,y:I.t-1,width:O+2,height:S+2};N&&(N=e.prototype._shapeFill(e.prototype._plotFill(N,
C,I),ba),this.surface.createRect(ba).setFill(N));Q&&this.surface.createRect({x:I.l,y:I.t,width:O+1,height:S+1}).setStroke(Q)},delayedRender:function(){this._delayedRenderHandle||(this._delayedRenderHandle=setTimeout(K.hitch(this,function(){this.render()}),this.delayInMs));return this},connectToPlot:function(C,I,O){return C in this.plots?this.stack[this.plots[C]].connect(I,O):null},fireEvent:function(C,I,O){if(C in this.runs){var S=this.series[this.runs[C]].plot;S in this.plots&&(S=this.stack[this.plots[S]])&&
S.fireEvent(C,I,O)}return this},_makeClean:function(){m.forEach(this.axes,A);m.forEach(this.stack,A);m.forEach(this.series,A);this.dirty=!1},_makeDirty:function(){m.forEach(this.axes,H);m.forEach(this.stack,H);m.forEach(this.series,H);this.dirty=!0},_invalidateDependentPlots:function(C,I){if(C in this.plots){var O=this.stack[this.plots[C]],S=I?"vAxis":"hAxis";O[S]?(C=this.axes[O[S]])&&C.dependOnData()&&(C.dirty=!0,m.forEach(this.stack,function(Q){Q[S]&&Q[S]==O[S]&&(Q.dirty=!0)})):O.dirty=!0}},setDir:function(C){return this},
_resetLeftBottom:function(C){},formatTruncatedLabel:function(C,I,O){}});return b("dojo-bidi")?y("dojox.charting.Chart",[G,t]):G})},"dojox/charting/Element":function(){define(["dojo/_base/array","dojo/dom-construct","dojo/_base/declare","dojox/gfx","dojox/gfx/shape"],function(G,K,m,y,x){return m("dojox.charting.Element",null,{chart:null,group:null,htmlElements:null,dirty:!0,renderingOptions:null,constructor:function(h,l){this.chart=h;this.group=null;this.htmlElements=[];this.dirty=!0;this.trailingSymbol=
"...";this._events=[];l&&l.renderingOptions&&(this.renderingOptions=l.renderingOptions)},purgeGroup:function(){this.destroyHtmlElements();if(this.group){this.getGroup().removeShape();var h=this.getGroup().children;if(x.dispose)for(var l=0;l<h.length;++l)x.dispose(h[l],!0);this.getGroup().rawNode&&K.empty(this.getGroup().rawNode);this.getGroup().clear();x.dispose&&x.dispose(this.getGroup(),!0);this.getGroup()!=this.group&&(this.group.rawNode&&K.empty(this.group.rawNode),this.group.clear(),x.dispose&&
x.dispose(this.group,!0));this.group=null}this.dirty=!0;this._events.length&&(G.forEach(this._events,function(g){g.shape.disconnect(g.handle)}),this._events=[]);return this},cleanGroup:function(h){this.destroyHtmlElements();h||(h=this.chart.surface);if(this.group){h=this.getGroup().children;if(x.dispose)for(var l=0;l<h.length;++l)x.dispose(h[l],!0);if(this.getGroup().rawNode){var g=this.getGroup().bgNode;K.empty(this.getGroup().rawNode)}this.getGroup().clear();g&&this.getGroup().rawNode.appendChild(g)}else if(this.group=
h.createGroup(),this.renderingOptions&&this.group.rawNode&&"http://www.w3.org/2000/svg"==this.group.rawNode.namespaceURI)for(l in this.renderingOptions)this.group.rawNode.setAttribute(l,this.renderingOptions[l]);this.dirty=!0;return this},getGroup:function(){return this.group},destroyHtmlElements:function(){this.htmlElements.length&&(G.forEach(this.htmlElements,K.destroy),this.htmlElements=[])},destroy:function(){this.purgeGroup()},overrideShape:function(h,l){},getTextWidth:function(h,l){return y._base._getTextBox(h,
{font:l}).w||0},getTextWithLimitLength:function(h,l,g,a){if(!h||0>=h.length)return{text:"",truncated:a||!1};if(!g||0>=g)return{text:h,truncated:a||!1};var b=h.substring(0,1)+this.trailingSymbol,e=this.getTextWidth(b,l);if(g<=e)return{text:b,truncated:!0};if(this.getTextWidth(h,l)<=g)return{text:h,truncated:a||!1};a=0;for(b=h.length;a<b;){if(2>=b-a){for(;this.getTextWidth(h.substring(0,a)+this.trailingSymbol,l)>g;)--a;return{text:h.substring(0,a)+this.trailingSymbol,truncated:!0}}e=a+Math.round(.618*
(b-a));this.getTextWidth(h.substring(0,e),l)<g?a=e:b=e}},getTextWithLimitCharCount:function(h,l,g,a){return!h||0>=h.length?{text:"",truncated:a||!1}:!g||0>=g||h.length<=g?{text:h,truncated:a||!1}:{text:h.substring(0,g)+this.trailingSymbol,truncated:!0}},_plotFill:function(h,l,g){if(!h||!h.type||!h.space)return h;var a=h.space;switch(h.type){case "linear":if("plot"===a||"shapeX"===a||"shapeY"===a){h=y.makeParameters(y.defaultLinearGradient,h);h.space=a;if("plot"===a||"shapeX"===a){var b=l.height-g.t-
g.b;h.y1=g.t+b*h.y1/100;h.y2=g.t+b*h.y2/100}if("plot"===a||"shapeY"===a)b=l.width-g.l-g.r,h.x1=g.l+b*h.x1/100,h.x2=g.l+b*h.x2/100}break;case "radial":"plot"===a&&(h=y.makeParameters(y.defaultRadialGradient,h),h.space=a,a=l.width-g.l-g.r,l=l.height-g.t-g.b,h.cx=g.l+a*h.cx/100,h.cy=g.t+l*h.cy/100,h.r=h.r*Math.sqrt(a*a+l*l)/200);break;case "pattern":if("plot"===a||"shapeX"===a||"shapeY"===a){h=y.makeParameters(y.defaultPattern,h);h.space=a;if("plot"===a||"shapeX"===a)b=l.height-g.t-g.b,h.y=g.t+b*h.y/
100,h.height=b*h.height/100;if("plot"===a||"shapeY"===a)b=l.width-g.l-g.r,h.x=g.l+b*h.x/100,h.width=b*h.width/100}}return h},_shapeFill:function(h,l){if(!h||!h.space)return h;var g=h.space;switch(h.type){case "linear":if("shape"===g||"shapeX"===g||"shapeY"===g){h=y.makeParameters(y.defaultLinearGradient,h);h.space=g;if("shape"===g||"shapeX"===g){var a=l.width;h.x1=l.x+a*h.x1/100;h.x2=l.x+a*h.x2/100}if("shape"===g||"shapeY"===g)a=l.height,h.y1=l.y+a*h.y1/100,h.y2=l.y+a*h.y2/100}break;case "radial":"shape"===
g&&(h=y.makeParameters(y.defaultRadialGradient,h),h.space=g,h.cx=l.x+l.width/2,h.cy=l.y+l.height/2,h.r=h.r*l.width/200);break;case "pattern":if("shape"===g||"shapeX"===g||"shapeY"===g){h=y.makeParameters(y.defaultPattern,h);h.space=g;if("shape"===g||"shapeX"===g)a=l.width,h.x=l.x+a*h.x/100,h.width=a*h.width/100;if("shape"===g||"shapeY"===g)a=l.height,h.y=l.y+a*h.y/100,h.height=a*h.height/100}}return h},_pseudoRadialFill:function(h,l,g,a,b){if(!h||"radial"!==h.type||"shape"!==h.space)return h;var e=
h.space;h=y.makeParameters(y.defaultRadialGradient,h);h.space=e;if(4>arguments.length)return h.cx=l.x,h.cy=l.y,h.r=h.r*g/100,h;e=5>arguments.length?a:(b+a)/2;return{type:"linear",x1:l.x,y1:l.y,x2:l.x+h.r*g*Math.cos(e)/100,y2:l.y+h.r*g*Math.sin(e)/100,colors:h.colors}}})})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(G,K,m,y,x,h,l,g,a,b){function e(d,
k){for(var n=d.length-1;k<n;)d[k]=d[++k];d.length=n}var f=G.shape={};f.Shape=m("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(x("gfxRegistry")){var d=f.register(this);this.getUID=function(){return d}}},destroy:function(){x("gfxRegistry")&&f.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},
getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var d=this.getBoundingBox();if(!d)return null;var k=this._getRealMatrix();return[b.multiplyPoint(k,d.x,d.y),b.multiplyPoint(k,d.x+d.width,d.y),b.multiplyPoint(k,d.x+d.width,d.y+d.height),b.multiplyPoint(k,d.x,
d.y+d.height)]},getEventSource:function(){return this.rawNode},setClip:function(d){this.clip=d},getClip:function(){return this.clip},setShape:function(d){this.shape=G.makeParameters(this.shape,d);this.bbox=null;return this},setFill:function(d){if(!d)return this.fillStyle=null,this;var k=null;if("object"==typeof d&&"type"in d)switch(d.type){case "linear":k=G.makeParameters(G.defaultLinearGradient,d);break;case "radial":k=G.makeParameters(G.defaultRadialGradient,d);break;case "pattern":k=G.makeParameters(G.defaultPattern,
d)}else k=G.normalizeColor(d);this.fillStyle=k;return this},setStroke:function(d){if(!d)return this.strokeStyle=null,this;if("string"==typeof d||K.isArray(d)||d instanceof a)d={color:d};d=this.strokeStyle=G.makeParameters(G.defaultStroke,d);d.color=G.normalizeColor(d.color);return this},setTransform:function(d){this.matrix=b.clone(d?b.normalize(d):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var d=this.getParent();d&&(d._moveChildToFront(this),
this._moveToFront());return this},moveToBack:function(){var d=this.getParent();d&&(d._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(d){return d?this.setTransform([this.matrix,d]):this},applyLeftTransform:function(d){return d?this.setTransform([d,this.matrix]):this},applyTransform:function(d){return d?this.setTransform([this.matrix,d]):this},removeShape:function(d){this.parent&&this.parent.remove(this,d);return this},
_setParent:function(d,k){this.parent=d;return this._updateParentMatrix(k)},_updateParentMatrix:function(d){this.parentMatrix=d?b.clone(d):null;return this._applyTransform()},_getRealMatrix:function(){for(var d=this.matrix,k=this.parent;k;)k.matrix&&(d=b.multiply(k.matrix,d)),k=k.parent;return d}});f._eventsProcessing={on:function(d,k){return h(this.getEventSource(),d,f.fixCallback(this,G.fixTarget,k))},connect:function(d,k,n){"on"==d.substring(0,2)&&(d=d.substring(2));return this.on(d,n?K.hitch(k,
n):k)},disconnect:function(d){return d.remove()}};f.fixCallback=function(d,k,n,p){p||(p=n,n=null);if(K.isString(p)){n=n||y.global;if(!n[p])throw['dojox.gfx.shape.fixCallback: scope["',p,'"] is null (scope\x3d"',n,'")'].join("");return function(E){return k(E,d)?n[p].apply(n,arguments||[]):void 0}}return n?function(E){return k(E,d)?p.apply(n,arguments||[]):void 0}:function(E){return k(E,d)?p.apply(n,arguments):void 0}};K.extend(f.Shape,f._eventsProcessing);f.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(d){var k=d.getParent();k&&k.remove(d,!0);this.children.push(d);return d._setParent(this,this._getRealMatrix())},remove:function(d,k){for(var n=0;n<this.children.length;++n)if(this.children[n]==d){k||(d.parent=null,d.parentMatrix=null);e(this.children,n);break}return this},clear:function(d){for(var k,n=0;n<this.children.length;++n)k=this.children[n],k.parent=null,k.parentMatrix=null,d&&k.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var d=null;l.forEach(this.children,function(k){var n=k.getBoundingBox();n&&((k=k.getTransform())&&(n=b.multiplyRectangle(k,n)),d?(d.x=Math.min(d.x,n.x),d.y=Math.min(d.y,n.y),d.endX=Math.max(d.endX,n.x+n.width),d.endY=Math.max(d.endY,n.y+n.height)):d={x:n.x,y:n.y,endX:n.x+n.width,endY:n.y+n.height})});d&&(d.width=d.endX-d.x,d.height=d.endY-d.y);return d}return null},_moveChildToFront:function(d){for(var k=0;k<this.children.length;++k)if(this.children[k]==
d){e(this.children,k);this.children.push(d);break}return this},_moveChildToBack:function(d){for(var k=0;k<this.children.length;++k)if(this.children[k]==d){e(this.children,k);this.children.unshift(d);break}return this}};f.Surface=m("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){l.forEach(this._nodes,g.destroy);this._nodes=[];l.forEach(this._events,function(d){d&&d.remove()});this._events=[];this.rawNode=null;
if(x("ie"))for(;this._parent.lastChild;)g.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(d){},whenLoaded:function(d,k){var n=K.hitch(d,k);if(this.isLoaded)n(this);else h.once(this,"load",function(p){n(p)})}});K.extend(f.Surface,f._eventsProcessing);f.Rect=m("dojox.gfx.shape.Rect",f.Shape,{constructor:function(d){this.shape=G.getDefault("Rect");this.rawNode=
d},getBoundingBox:function(){return this.shape}});f.Ellipse=m("dojox.gfx.shape.Ellipse",f.Shape,{constructor:function(d){this.shape=G.getDefault("Ellipse");this.rawNode=d},getBoundingBox:function(){if(!this.bbox){var d=this.shape;this.bbox={x:d.cx-d.rx,y:d.cy-d.ry,width:2*d.rx,height:2*d.ry}}return this.bbox}});f.Circle=m("dojox.gfx.shape.Circle",f.Shape,{constructor:function(d){this.shape=G.getDefault("Circle");this.rawNode=d},getBoundingBox:function(){if(!this.bbox){var d=this.shape;this.bbox={x:d.cx-
d.r,y:d.cy-d.r,width:2*d.r,height:2*d.r}}return this.bbox}});f.Line=m("dojox.gfx.shape.Line",f.Shape,{constructor:function(d){this.shape=G.getDefault("Line");this.rawNode=d},getBoundingBox:function(){if(!this.bbox){var d=this.shape;this.bbox={x:Math.min(d.x1,d.x2),y:Math.min(d.y1,d.y2),width:Math.abs(d.x2-d.x1),height:Math.abs(d.y2-d.y1)}}return this.bbox}});f.Polyline=m("dojox.gfx.shape.Polyline",f.Shape,{constructor:function(d){this.shape=G.getDefault("Polyline");this.rawNode=d},setShape:function(d,
k){d&&d instanceof Array?(this.inherited(arguments,[{points:d}]),k&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[d]);return this},_normalizePoints:function(){var d=this.shape.points,k=d&&d.length;if(k&&"number"==typeof d[0]){for(var n=[],p=0;p<k;p+=2)n.push({x:d[p],y:d[p+1]});this.shape.points=n}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var d=this.shape.points,k=d.length,n=d[0],p=n.x,E=n.y,t=n.x,q=n.y,B=1;B<k;++B)n=
d[B],p>n.x&&(p=n.x),t<n.x&&(t=n.x),E>n.y&&(E=n.y),q<n.y&&(q=n.y);this.bbox={x:p,y:E,width:t-p,height:q-E}}return this.bbox}});f.Image=m("dojox.gfx.shape.Image",f.Shape,{constructor:function(d){this.shape=G.getDefault("Image");this.rawNode=d},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});f.Text=m(f.Shape,{constructor:function(d){this.fontStyle=null;this.shape=G.getDefault("Text");this.rawNode=d},getFont:function(){return this.fontStyle},
setFont:function(d){this.fontStyle="string"==typeof d?G.splitFontString(d):G.makeParameters(G.defaultFont,d);this._setFont();return this},getBoundingBox:function(){var d=null;this.getShape().text&&(d=G._base._computeTextBoundingBox(this));return d}});f.Creator={createShape:function(d){switch(d.type){case G.defaultPath.type:return this.createPath(d);case G.defaultRect.type:return this.createRect(d);case G.defaultCircle.type:return this.createCircle(d);case G.defaultEllipse.type:return this.createEllipse(d);
case G.defaultLine.type:return this.createLine(d);case G.defaultPolyline.type:return this.createPolyline(d);case G.defaultImage.type:return this.createImage(d);case G.defaultText.type:return this.createText(d);case G.defaultTextPath.type:return this.createTextPath(d)}return null},createGroup:function(){return this.createObject(G.Group)},createRect:function(d){return this.createObject(G.Rect,d)},createEllipse:function(d){return this.createObject(G.Ellipse,d)},createCircle:function(d){return this.createObject(G.Circle,
d)},createLine:function(d){return this.createObject(G.Line,d)},createPolyline:function(d){return this.createObject(G.Polyline,d)},createImage:function(d){return this.createObject(G.Image,d)},createText:function(d){return this.createObject(G.Text,d)},createPath:function(d){return this.createObject(G.Path,d)},createTextPath:function(d){return this.createObject(G.TextPath,{}).setText(d)},createObject:function(d,k){return null}};return f})},"dojox/charting/SimpleTheme":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/Color dojox/lang/utils dojox/gfx/gradutils".split(" "),
function(G,K,m,y,x,h){var l=m("dojox.charting.SimpleTheme",null,{shapeSpaces:{shape:1,shapeX:1,shapeY:1},constructor:function(g){g=g||{};var a=l.defaultTheme;K.forEach("chart plotarea axis grid series marker indicator".split(" "),function(b){this[b]=G.delegate(a[b],g[b])},this);g.seriesThemes&&g.seriesThemes.length?(this.colors=null,this.seriesThemes=g.seriesThemes.slice(0)):(this.seriesThemes=null,this.colors=(g.colors||l.defaultColors).slice(0));this.markerThemes=null;g.markerThemes&&g.markerThemes.length&&
(this.markerThemes=g.markerThemes.slice(0));this.markers=g.markers?G.clone(g.markers):G.delegate(l.defaultMarkers);this.noGradConv=g.noGradConv;this.noRadialConv=g.noRadialConv;g.reverseFills&&this.reverseFills();this._current=0;this._buildMarkerArray()},clone:function(){var g=new this.constructor({chart:this.chart,plotarea:this.plotarea,axis:this.axis,grid:this.grid,series:this.series,marker:this.marker,colors:this.colors,markers:this.markers,indicator:this.indicator,seriesThemes:this.seriesThemes,
markerThemes:this.markerThemes,noGradConv:this.noGradConv,noRadialConv:this.noRadialConv,pieInnerRadius:this.pieInnerRadius});K.forEach("clone clear next skip addMixin post getTick".split(" "),function(a){this.hasOwnProperty(a)&&(g[a]=this[a])},this);return g},clear:function(){this._current=0},next:function(g,a,b){var e=x.merge;if(this.colors){var f=G.delegate(this.series);e=G.delegate(this.marker);var d=new y(this.colors[this._current%this.colors.length]);if(f.stroke&&f.stroke.color){f.stroke=G.delegate(f.stroke);
var k=new y(f.stroke.color);f.stroke.color=new y(d);f.stroke.color.a=k.a}else f.stroke={color:d};e.stroke&&e.stroke.color?(e.stroke=G.delegate(e.stroke),k=new y(e.stroke.color),e.stroke.color=new y(d),e.stroke.color.a=k.a):e.stroke={color:d};!f.fill||f.fill.type?f.fill=d:(k=new y(f.fill),f.fill=new y(d),f.fill.a=k.a);!e.fill||e.fill.type?e.fill=d:(k=new y(e.fill),e.fill=new y(d),e.fill.a=k.a)}else f=this.seriesThemes?e(this.series,this.seriesThemes[this._current%this.seriesThemes.length]):this.series,
e=this.markerThemes?e(this.marker,this.markerThemes[this._current%this.markerThemes.length]):f;f={series:f,marker:e,symbol:e&&e.symbol||this._markers[this._current%this._markers.length]};++this._current;a&&(f=this.addMixin(f,g,a));b&&(f=this.post(f,g));return f},skip:function(){++this._current},addMixin:function(g,a,b,e){if(G.isArray(b))K.forEach(b,function(d){g=this.addMixin(g,a,d)},this);else{var f={};"color"in b&&("line"==a||"area"==a?(G.setObject("series.stroke.color",b.color,f),G.setObject("marker.stroke.color",
b.color,f)):G.setObject("series.fill",b.color,f));K.forEach("stroke outline shadow fill filter font fontColor labelWiring".split(" "),function(d){var k="marker"+d.charAt(0).toUpperCase()+d.substr(1),n=k in b;d in b&&(G.setObject("series."+d,b[d],f),n||G.setObject("marker."+d,b[d],f));n&&G.setObject("marker."+d,b[k],f)});"marker"in b&&(f.symbol=b.marker,f.symbol=b.marker);g=x.merge(g,f)}e&&(g=this.post(g,a));return g},post:function(g,a){var b=g.series.fill,e;return!this.noGradConv&&this.shapeSpaces[b.space]&&
"linear"==b.type&&("bar"==a?e={x1:b.y1,y1:b.x1,x2:b.y2,y2:b.x2}:this.noRadialConv||"shape"!=b.space||"slice"!=a&&"circle"!=a||(e={type:"radial",cx:0,cy:0,r:100}),e)?x.merge(g,{series:{fill:e}}):g},getTick:function(g,a){var b=this.axis.tick;g+="Tick";var e=x.merge;b?this.axis[g]&&(b=e(b,this.axis[g])):b=this.axis[g];a&&(b?a[g]&&(b=e(b,a[g])):b=a[g]);return b},inspectObjects:function(g){K.forEach("chart plotarea axis grid series marker indicator".split(" "),function(a){g(this[a])},this);this.seriesThemes&&
K.forEach(this.seriesThemes,g);this.markerThemes&&K.forEach(this.markerThemes,g)},reverseFills:function(){this.inspectObjects(function(g){g&&g.fill&&(g.fill=h.reverse(g.fill))})},addMarker:function(g,a){this.markers[g]=a;this._buildMarkerArray()},setMarkers:function(g){this.markers=g;this._buildMarkerArray()},_buildMarkerArray:function(){this._markers=[];for(var g in this.markers)this._markers.push(this.markers[g])}});G.mixin(l,{defaultMarkers:{CIRCLE:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",SQUARE:"m-3,-3 l0,6 6,0 0,-6 z",
DIAMOND:"m0,-3 l3,3 -3,3 -3,-3 z",CROSS:"m0,-3 l0,6 m-3,-3 l6,0",X:"m-3,-3 l6,6 m0,-6 l-6,6",TRIANGLE:"m-3,3 l3,-6 3,6 z",TRIANGLE_INVERTED:"m-3,-3 l3,6 3,-6 z"},defaultColors:["#54544c","#858e94","#6e767a","#948585","#474747"],defaultTheme:{chart:{stroke:null,fill:"white",pageStyle:null,titleGap:20,titlePos:"top",titleFont:"normal normal bold 14pt Tahoma",titleFontColor:"#333",titleAlign:"middle"},plotarea:{stroke:null,fill:"white"},axis:{stroke:{color:"#333",width:1},tick:{color:"#666",position:"center",
font:"normal normal normal 7pt Tahoma",fontColor:"#333",labelGap:4},majorTick:{width:1,length:6},minorTick:{width:.8,length:3},microTick:{width:.5,length:1},title:{gap:15,font:"normal normal normal 11pt Tahoma",fontColor:"#333",orientation:"axis"}},series:{stroke:{width:1.5,color:"#333"},outline:{width:.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000",labelWiring:{width:1,color:"#ccc"}},marker:{stroke:{width:1.5,color:"#333"},outline:{width:.1,color:"#ccc"},
shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000"},indicator:{lineStroke:{width:1.5,color:"#333"},lineOutline:{width:.1,color:"#ccc"},lineShadow:null,lineFill:null,stroke:{width:1.5,color:"#333"},outline:{width:.1,color:"#ccc"},shadow:null,fill:"#ccc",radius:3,font:"normal normal normal 10pt Tahoma",fontColor:"#000",markerFill:"#ccc",markerSymbol:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",markerStroke:{width:1.5,color:"#333"},markerOutline:{width:.1,color:"#ccc"},markerShadow:null}}});
return l})},"dojox/lang/utils":function(){define(["..","dojo/_base/lang"],function(G,K){var m=K.getObject("lang.utils",!0,G),y={},x=Object.prototype.toString,h=function(l){if(l)switch(x.call(l)){case "[object Array]":return l.slice(0);case "[object Object]":return K.delegate(l)}return l};K.mixin(m,{coerceType:function(l,g){switch(typeof l){case "number":return Number(eval("("+g+")"));case "string":return String(g);case "boolean":return!!eval("("+g+")")}return eval("("+g+")")},updateWithObject:function(l,
g,a){if(!g)return l;for(var b in l)if(b in g&&!(b in y)){var e=l[b];e&&"object"==typeof e?m.updateWithObject(e,g[b],a):l[b]=a?m.coerceType(e,g[b]):h(g[b])}return l},updateWithPattern:function(l,g,a,b){if(!g||!a)return l;for(var e in a)e in g&&!(e in y)&&(l[e]=b?m.coerceType(a[e],g[e]):h(g[e]));return l},merge:function(l,g){if(g){var a=x.call(l),b=x.call(g);switch(b){case "[object Array]":if(b==a){a=Array(Math.max(l.length,g.length));var e=0;for(b=a.length;e<b;++e)a[e]=m.merge(l[e],g[e]);return a}return g.slice(0);
case "[object Object]":if(b==a&&l){a=K.delegate(l);for(e in g)if(e in l){b=l[e];var f=g[e];f!==b&&(a[e]=m.merge(b,f))}else a[e]=K.clone(g[e]);return a}return K.clone(g)}}return g}});return m})},"dojox/gfx/gradutils":function(){define(["./_base","dojo/_base/lang","./matrix","dojo/_base/Color"],function(G,K,m,y){function x(h,l){if(0>=h)return l[0].color;var g=l.length;if(1<=h)return l[g-1].color;for(var a=0;a<g;++a){var b=l[a];if(b.offset>=h)return a?(l=l[a-1],y.blendColors(new y(l.color),new y(b.color),
(h-l.offset)/(b.offset-l.offset))):b.color}return l[g-1].color}G=G.gradutils={};G.getColor=function(h,l){if(h){switch(h.type){case "linear":var g=m.rotate(-Math.atan2(h.y2-h.y1,h.x2-h.x1));var a=m.project(h.x2-h.x1,h.y2-h.y1);l=m.multiplyPoint(a,l);var b=m.multiplyPoint(a,h.x1,h.y1);a=m.multiplyPoint(a,h.x2,h.y2);a=m.multiplyPoint(g,a.x-b.x,a.y-b.y).x;g=m.multiplyPoint(g,l.x-b.x,l.y-b.y).x/a;break;case "radial":g=l.x-h.cx,l=l.y-h.cy,g=Math.sqrt(g*g+l*l)/h.r}return x(g,h.colors)}return new y(h||[0,
0,0,0])};G.reverse=function(h){if(h)switch(h.type){case "linear":case "radial":if(h=K.delegate(h),h.colors){for(var l=h.colors,g=l.length,a=0,b,e=h.colors=Array(l.length);a<g;++a)b=l[a],e[a]={offset:1-b.offset,color:b.color};e.sort(function(f,d){return f.offset-d.offset})}}return h};return G})},"dojox/charting/Series":function(){define(["dojo/_base/lang","dojo/_base/declare","./Element"],function(G,K,m){return K("dojox.charting.Series",m,{constructor:function(y,x,h){G.mixin(this,h);"string"!=typeof this.plot&&
(this.plot="default");this.update(x)},clear:function(){this.dyn={}},update:function(y){G.isArray(y)?this.data=y:(this.source=y,this.data=this.source.data,this.source.setSeriesObject&&this.source.setSeriesObject(this));this.dirty=!0;this.clear()}})})},"dojox/charting/axis2d/common":function(){define(["dojo/_base/lang","dojo/_base/window","dojo/dom-geometry","dojox/gfx","dojo/has"],function(G,K,m,y,x){var h=G.getObject("dojox.charting.axis2d.common",!0),l=function(g){g.marginLeft="0px";g.marginTop=
"0px";g.marginRight="0px";g.marginBottom="0px";g.paddingLeft="0px";g.paddingTop="0px";g.paddingRight="0px";g.paddingBottom="0px";g.borderLeftWidth="0px";g.borderTopWidth="0px";g.borderRightWidth="0px";g.borderBottomWidth="0px"};return G.mixin(h,{createText:{gfx:function(g,a,b,e,f,d,k,n){return a.createText({x:b,y:e,text:d,align:f}).setFont(k).setFill(n)},html:function(g,a,b,e,f,d,k,n,p){a=K.doc.createElement("div");var E=a.style;g.getTextDir&&(a.dir=g.getTextDir(d));l(E);E.font=k;a.innerHTML=String(d).replace(/\s/g,
"\x26nbsp;");E.color=n;E.position="absolute";E.left="-10000px";K.body().appendChild(a);var t=y.normalizedLength(y.splitFontString(k).size);if(!p)if(a.getBoundingClientRect){var q=a.getBoundingClientRect();q=q.width||q.right-q.left}else q=m.getMarginBox(a).w;"rtl"==a.dir&&(b+=p?p:q);K.body().removeChild(a);E.position="relative";if(p)switch(E.width=p+"px",f){case "middle":E.textAlign="center";E.left=b-p/2+"px";break;case "end":E.textAlign="right";E.left=b-p+"px";break;default:E.left=b+"px",E.textAlign=
"left"}else switch(f){case "middle":E.left=Math.floor(b-q/2)+"px";break;case "end":E.left=Math.floor(b-q)+"px";break;default:E.left=Math.floor(b)+"px"}E.top=Math.floor(e-t)+"px";E.whiteSpace="nowrap";p=K.doc.createElement("div");E=p.style;l(E);E.width="0px";E.height="0px";p.appendChild(a);g.node.insertBefore(p,g.node.firstChild);x("dojo-bidi")&&g.htmlElementsRegistry.push([p,b,e,f,d,k,n]);return p}}})})},"dojox/charting/plot2d/common":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Color dojox/gfx dojox/lang/functional ../scaler/common".split(" "),
function(G,K,m,y,x,h){var l=G.getObject("dojox.charting.plot2d.common",!0);return G.mixin(l,{doIfLoaded:h.doIfLoaded,makeStroke:function(g){if(!g)return g;if("string"==typeof g||g instanceof m)g={color:g};return y.makeParameters(y.defaultStroke,g)},augmentColor:function(g,a){g=new m(g);a=new m(a);a.a=g.a;return a},augmentStroke:function(g,a){if(g=l.makeStroke(g))g.color=l.augmentColor(g.color,a);return g},augmentFill:function(g,a){new m(a);return"string"==typeof g||g instanceof m?l.augmentColor(g,
a):g},defaultStats:{vmin:Number.POSITIVE_INFINITY,vmax:Number.NEGATIVE_INFINITY,hmin:Number.POSITIVE_INFINITY,hmax:Number.NEGATIVE_INFINITY},collectSimpleStats:function(g,a){for(var b=G.delegate(l.defaultStats),e=0;e<g.length;++e)for(var f=g[e],d=0;d<f.data.length;d++)if(!a(f.data[d])){if("number"==typeof f.data[d]){d=b.vmin;var k=b.vmax;K.forEach(f.data,function(E,t){a(E)||(t+=1,isNaN(E)&&(E=0),b.hmin=Math.min(b.hmin,t),b.hmax=Math.max(b.hmax,t),b.vmin=Math.min(b.vmin,E),b.vmax=Math.max(b.vmax,E))})}else{var n=
b.hmin,p=b.hmax;d=b.vmin;k=b.vmax;"xmin"in f&&"xmax"in f&&"ymin"in f&&"ymax"in f||K.forEach(f.data,function(E,t){a(E)||(t="x"in E?E.x:t+1,E=E.y,isNaN(t)&&(t=0),isNaN(E)&&(E=0),b.hmin=Math.min(b.hmin,t),b.hmax=Math.max(b.hmax,t),b.vmin=Math.min(b.vmin,E),b.vmax=Math.max(b.vmax,E))});"xmin"in f&&(b.hmin=Math.min(n,f.xmin));"xmax"in f&&(b.hmax=Math.max(p,f.xmax))}"ymin"in f&&(b.vmin=Math.min(d,f.ymin));"ymax"in f&&(b.vmax=Math.max(k,f.ymax));break}return b},calculateBarSize:function(g,a,b){b||(b=1);
var e=(g-2*a.gap)/b;"minBarSize"in a&&(e=Math.max(e,a.minBarSize));"maxBarSize"in a&&(e=Math.min(e,a.maxBarSize));e=Math.max(e,1);return{size:e,gap:(g-e*b)/2}},collectStackedStats:function(g){var a=G.clone(l.defaultStats);if(g.length){a.hmin=Math.min(a.hmin,1);a.hmax=x.foldl(g,"seed, run -\x3e Math.max(seed, run.data.length)",a.hmax);for(var b=0;b<a.hmax;++b){var e=g[0].data[b];e=e&&("number"==typeof e?e:e.y);isNaN(e)&&(e=0);a.vmin=Math.min(a.vmin,e);for(var f=1;f<g.length;++f){var d=g[f].data[b];
d=d&&("number"==typeof d?d:d.y);isNaN(d)&&(d=0);e+=d}a.vmax=Math.max(a.vmax,e)}}return a},curve:function(g,a){var b=g.slice(0);"x"==a&&(b[b.length]=b[0]);return K.map(b,function(e,f){if(0==f)return"M"+e.x+","+e.y;if(!isNaN(a)){var d=e.x-b[f-1].x;return"C"+(e.x-d/a*(a-1))+","+b[f-1].y+" "+(e.x-d/a)+","+e.y+" "+e.x+","+e.y}if("X"==a||"x"==a||"S"==a){e=b[f-1];d=b[f];var k=1/6;if(1==f){var n="x"==a?b[b.length-2]:e;k=1/3}else n=b[f-2];f==b.length-1?(f="x"==a?b[1]:d,k=1/3):f=b[f+1];var p=Math.sqrt((d.x-
e.x)*(d.x-e.x)+(d.y-e.y)*(d.y-e.y));var E=Math.sqrt((d.x-n.x)*(d.x-n.x)+(d.y-n.y)*(d.y-n.y));var t=Math.sqrt((f.x-e.x)*(f.x-e.x)+(f.y-e.y)*(f.y-e.y));var q=E*k,B=t*k;q>p/2&&B>p/2?(q=p/2,B=p/2):q>p/2?(q=p/2,B=p/2*t/E):B>p/2&&(B=p/2,q=p/2*E/t);"S"==a&&(n==e&&(q=0),d==f&&(B=0));k=e.x+q*(d.x-n.x)/E;n=e.y+q*(d.y-n.y)/E;E=d.x-B*(f.x-e.x)/t;t=d.y-B*(f.y-e.y)/t}return"C"+(k+","+n+" "+E+","+t+" "+d.x+","+d.y)}).join(" ")},getLabel:function(g,a,b){return h.doIfLoaded("dojo/number",function(e){return(a?e.format(g,
{places:b}):e.format(g))||""},function(){return a?g.toFixed(b):g.toString()})},purgeGroup:function(g){return g.purgeGroup()}})})},"dojox/lang/functional":function(){define(["./functional/lambda","./functional/array","./functional/object"],function(G){return G})},"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],function(G,K,m){var y=K.getObject("lang.functional",!0,G),x={},h=1<"ab".split(/a*/).length?String.prototype.split:function(a){var b=this.split.call(this,
a);(a=a.exec(this))&&0==a.index&&b.unshift("");return b},l=function(a){var b=[],e=h.call(a,/\s*->\s*/m);if(1<e.length)for(;e.length;)a=e.pop(),b=e.pop().split(/\s*,\s*|\s+/m),e.length&&e.push("(function("+b.join(", ")+"){ return ("+a+"); })");else if(a.match(/\b_\b/))b=["_"];else{e=a.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m);var f=a.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(e||f)e&&(b.push("$1"),a="$1"+a),f&&(b.push("$2"),a+="$2");else{e=a.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,
"").match(/([a-z_$][a-z_$\d]*)/gi)||[];var d={};m.forEach(e,function(k){d.hasOwnProperty(k)||(b.push(k),d[k]=1)})}}return{args:b,body:a}},g=function(a){return a.length?function(){var b=a.length-1,e=y.lambda(a[b]).apply(this,arguments);for(--b;0<=b;--b)e=y.lambda(a[b]).call(this,e);return e}:function(b){return b}};K.mixin(y,{rawLambda:function(a){return l(a)},buildLambda:function(a){a=l(a);return"function("+a.args.join(",")+"){return ("+a.body+");}"},lambda:function(a){if("function"==typeof a)return a;
if(a instanceof Array)return g(a);if(x.hasOwnProperty(a))return x[a];var b=l(a);return x[a]=new Function(b.args,"return ("+b.body+");")},clearLambdaCache:function(){x={}}});return y})},"dojox/lang/functional/array":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","./lambda"],function(G,K,m,y){var x={};K.mixin(y,{filter:function(h,l,g){"string"==typeof h&&(h=h.split(""));g=g||G.global;l=y.lambda(l);var a=[],b;if(K.isArray(h)){var e=0;for(b=h.length;e<b;++e){var f=h[e];l.call(g,
f,e,h)&&a.push(f)}}else if("function"==typeof h.hasNext&&"function"==typeof h.next)for(e=0;h.hasNext();)f=h.next(),l.call(g,f,e++,h)&&a.push(f);else for(e in h)e in x||(f=h[e],l.call(g,f,e,h)&&a.push(f));return a},forEach:function(h,l,g){"string"==typeof h&&(h=h.split(""));g=g||G.global;l=y.lambda(l);var a;if(K.isArray(h)){var b=0;for(a=h.length;b<a;l.call(g,h[b],b,h),++b);}else if("function"==typeof h.hasNext&&"function"==typeof h.next)for(b=0;h.hasNext();l.call(g,h.next(),b++,h));else for(b in h)b in
x||l.call(g,h[b],b,h);return g},map:function(h,l,g){"string"==typeof h&&(h=h.split(""));g=g||G.global;l=y.lambda(l);var a,b;if(K.isArray(h)){var e=Array(a=h.length);for(b=0;b<a;e[b]=l.call(g,h[b],b,h),++b);}else if("function"==typeof h.hasNext&&"function"==typeof h.next)for(e=[],b=0;h.hasNext();e.push(l.call(g,h.next(),b++,h)));else for(b in e=[],h)b in x||e.push(l.call(g,h[b],b,h));return e},every:function(h,l,g){"string"==typeof h&&(h=h.split(""));g=g||G.global;l=y.lambda(l);var a;if(K.isArray(h)){var b=
0;for(a=h.length;b<a;++b)if(!l.call(g,h[b],b,h))return!1}else if("function"==typeof h.hasNext&&"function"==typeof h.next)for(b=0;h.hasNext();){if(!l.call(g,h.next(),b++,h))return!1}else for(b in h)if(!(b in x||l.call(g,h[b],b,h)))return!1;return!0},some:function(h,l,g){"string"==typeof h&&(h=h.split(""));g=g||G.global;l=y.lambda(l);var a;if(K.isArray(h)){var b=0;for(a=h.length;b<a;++b)if(l.call(g,h[b],b,h))return!0}else if("function"==typeof h.hasNext&&"function"==typeof h.next)for(b=0;h.hasNext();){if(l.call(g,
h.next(),b++,h))return!0}else for(b in h)if(!(b in x)&&l.call(g,h[b],b,h))return!0;return!1}});return y})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(G,K,m){var y={};K.mixin(m,{keys:function(x){var h=[],l;for(l in x)l in y||h.push(l);return h},values:function(x){var h=[],l;for(l in x)l in y||h.push(x[l]);return h},filterIn:function(x,h,l){l=l||G.global;h=m.lambda(h);var g={},a;for(a in x)if(!(a in y)){var b=x[a];h.call(l,b,a,x)&&(g[a]=
b)}return g},forIn:function(x,h,l){l=l||G.global;h=m.lambda(h);for(var g in x)g in y||h.call(l,x[g],g,x);return l},mapIn:function(x,h,l){l=l||G.global;h=m.lambda(h);var g={},a;for(a in x)a in y||(g[a]=h.call(l,x[a],a,x));return g}});return m})},"dojox/charting/scaler/common":function(){define(["dojo/_base/lang"],function(G){var K=function(x,h){return Math.abs(x-h)<=1E-6*(Math.abs(x)+Math.abs(h))},m=G.getObject("dojox.charting.scaler.common",!0),y={};return G.mixin(m,{doIfLoaded:function(x,h,l){if(void 0===
y[x])try{y[x]=require(x)}catch(g){y[x]=null}return y[x]?h(y[x]):l()},getNumericLabel:function(x,h,l){var g="";m.doIfLoaded("dojo/number",function(d){g=(l.fixed?d.format(x,{places:0>h?-h:0}):d.format(x))||""},function(){g=l.fixed?x.toFixed(0>h?-h:0):x.toString()});if(l.labelFunc){var a=l.labelFunc(g,x,h);if(a)return a}if(l.labels){a=l.labels;for(var b=0,e=a.length;b<e;){var f=Math.floor((b+e)/2);a[f].value<x?b=f+1:e=f}if(b<a.length&&K(a[b].value,x))return a[b].text;--b;if(0<=b&&b<a.length&&K(a[b].value,
x))return a[b].text;b+=2;if(b<a.length&&K(a[b].value,x))return a[b].text}return g}})})},"dojox/lang/functional/fold":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/kernel","./lambda"],function(G,K,m,y){var x={};G.mixin(y,{foldl:function(h,l,g,a){"string"==typeof h&&(h=h.split(""));a=a||m.global;l=y.lambda(l);var b;if(G.isArray(h)){var e=0;for(b=h.length;e<b;g=l.call(a,g,h[e],e,h),++e);}else if("function"==typeof h.hasNext&&"function"==typeof h.next)for(e=0;h.hasNext();g=l.call(a,
g,h.next(),e++,h));else for(e in h)e in x||(g=l.call(a,g,h[e],e,h));return g},foldl1:function(h,l,g){"string"==typeof h&&(h=h.split(""));g=g||m.global;l=y.lambda(l);var a;if(G.isArray(h)){var b=h[0];var e=1;for(a=h.length;e<a;b=l.call(g,b,h[e],e,h),++e);}else if("function"==typeof h.hasNext&&"function"==typeof h.next){if(h.hasNext())for(b=h.next(),e=1;h.hasNext();b=l.call(g,b,h.next(),e++,h));}else for(e in a=!0,h)e in x||(a?(b=h[e],a=!1):b=l.call(g,b,h[e],e,h));return b},foldr:function(h,l,g,a){"string"==
typeof h&&(h=h.split(""));a=a||m.global;l=y.lambda(l);for(var b=h.length;0<b;--b,g=l.call(a,g,h[b],b,h));return g},foldr1:function(h,l,g){"string"==typeof h&&(h=h.split(""));g=g||m.global;l=y.lambda(l);var a=h.length,b=h[a-1];for(--a;0<a;--a,b=l.call(g,b,h[a],a,h));return b},reduce:function(h,l,g){return 3>arguments.length?y.foldl1(h,l):y.foldl(h,l,g)},reduceRight:function(h,l,g){return 3>arguments.length?y.foldr1(h,l):y.foldr(h,l,g)},unfold:function(h,l,g,a,b){b=b||m.global;l=y.lambda(l);g=y.lambda(g);
h=y.lambda(h);for(var e=[];!h.call(b,a);e.push(l.call(b,a)),a=g.call(b,a));return e}})})},"dojox/lang/functional/reversed":function(){define(["dojo/_base/lang","dojo/_base/kernel","./lambda"],function(G,K,m){G.mixin(m,{filterRev:function(y,x,h){"string"==typeof y&&(y=y.split(""));h=h||K.global;x=m.lambda(x);for(var l=[],g,a=y.length-1;0<=a;--a)g=y[a],x.call(h,g,a,y)&&l.push(g);return l},forEachRev:function(y,x,h){"string"==typeof y&&(y=y.split(""));h=h||K.global;x=m.lambda(x);for(var l=y.length-1;0<=
l;x.call(h,y[l],l,y),--l);},mapRev:function(y,x,h){"string"==typeof y&&(y=y.split(""));h=h||K.global;x=m.lambda(x);var l=y.length,g=Array(l);--l;for(var a=0;0<=l;g[a++]=x.call(h,y[l],l,y),--l);return g},everyRev:function(y,x,h){"string"==typeof y&&(y=y.split(""));h=h||K.global;x=m.lambda(x);for(var l=y.length-1;0<=l;--l)if(!x.call(h,y[l],l,y))return!1;return!0},someRev:function(y,x,h){"string"==typeof y&&(y=y.split(""));h=h||K.global;x=m.lambda(x);for(var l=y.length-1;0<=l;--l)if(x.call(h,y[l],l,
y))return!0;return!1}});return m})},"dojox/charting/plot2d/Pie":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/dom-geometry dojo/_base/Color ./Base ./_PlotEvents ./common dojox/gfx dojox/gfx/matrix dojox/lang/functional dojox/lang/utils dojo/has".split(" "),function(G,K,m,y,x,h,l,g,a,b,e,f,d){return m("dojox.charting.plot2d.Pie",[h,l],{defaultParams:{labels:!0,ticks:!1,fixed:!0,precision:1,labelOffset:20,labelStyle:"default",htmlLabels:!0,radGrad:"native",fanSize:5,startAngle:0,
innerRadius:0,minWidth:0,zeroDataMessage:""},optionalParams:{radius:0,omitLabels:!1,stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",labelWiring:{}},constructor:function(k,n){this.opt=G.clone(this.defaultParams);f.updateWithObject(this.opt,n);f.updateWithPattern(this.opt,n,this.optionalParams);this.axes=[];this.run=null;this.dyn=[];this.runFilter=[];n&&n.hasOwnProperty("innerRadius")&&(this._plotSetInnerRadius=!0)},clear:function(){this.inherited(arguments);this.dyn=
[];this.run=null;return this},setAxis:function(k){return this},addSeries:function(k){this.run=k;return this},getSeriesStats:function(){return G.delegate(g.defaultStats)},getRequiredColors:function(){return this.run?this.run.data.length:0},render:function(k,n){if(!this.dirty)return this;this.resetEvents();this.dirty=!1;this._eventSeries={};this.cleanGroup();var p=this.group,E=this.chart.theme;!this._plotSetInnerRadius&&E&&E.pieInnerRadius&&(this.opt.innerRadius=E.pieInnerRadius);var t=(k.width-n.l-
n.r)/2,q=(k.height-n.t-n.b)/2,B=Math.min(t,q),r="font"in this.opt?this.opt.font:E.axis.tick.titleFont||"",A=r?a.normalizedLength(a.splitFontString(r).size):0,H=this.opt.hasOwnProperty("fontColor")?this.opt.fontColor:E.axis.tick.fontColor,J=b._degToRad(this.opt.startAngle),L=J,M,T=this.run.data,W=this.events(),C=G.hitch(this,function(){var v=E.clone(),w=e.map(T,function(aa){var Z=[this.opt,this.run];null!==aa&&"number"!=typeof aa&&Z.push(aa);this.opt.styleFunc&&Z.push(this.opt.styleFunc(aa));return v.next("slice",
Z,!0)},this);"radius"in this.opt&&(B=this.opt.radius<B?this.opt.radius:B);var D={cx:n.l+t,cy:n.t+q,r:B},P=new x(H);this.opt.innerRadius&&(P.a=.1);var Y=this._createRing(p,D).setStroke(P);this.opt.innerRadius&&Y.setFill(P);this.opt.zeroDataMessage&&this.renderLabel(p,D.cx,D.cy+A/3,this.opt.zeroDataMessage,{series:{font:r,fontColor:H}},null,"middle");this.dyn=[];K.forEach(T,function(aa,Z){this.dyn.push({fill:this._plotFill(w[Z].series.fill,k,n),stroke:w[Z].series.stroke})},this)});if(!this.run&&!this.run.data.ength)return C(),
this;if("number"==typeof T[0]){var I=e.map(T,"x ? Math.max(x, 0) : 0");if(e.every(I,"\x3c\x3d 0"))return C(),this;var O=e.map(I,"/this",e.foldl(I,"+",0));this.opt.labels&&(M=K.map(O,function(v){return 0<v?this._getLabel(100*v)+"%":""},this))}else{I=e.map(T,"x ? Math.max(x.y, 0) : 0");if(!I.length||e.every(I,"\x3c\x3d 0"))return C(),this;O=e.map(I,"/this",e.foldl(I,"+",0));this.opt.labels&&(M=K.map(O,function(v,w){if(0>v)return"";w=T[w];return w.hasOwnProperty("text")?w.text:this._getLabel(100*v)+
"%"},this))}var S=e.map(T,function(v){var w=[this.opt,this.run];null!==v&&"number"!=typeof v&&w.push(v);this.opt.styleFunc&&w.push(this.opt.styleFunc(v));return E.next("slice",w,!0)},this);this.opt.labels&&(I=e.foldl1(e.map(M,function(v,w){return a._base._getTextBox(v,{font:S[w].series.font}).w},this),"Math.max(a, b)")/2,0>this.opt.labelOffset&&(B=Math.min(t-2*I,q-A)+this.opt.labelOffset));this.opt.hasOwnProperty("radius")&&(B=this.opt.radius<.9*B?this.opt.radius:.9*B);!this.opt.radius&&this.opt.labels&&
"columns"==this.opt.labelStyle?(B/=2,t>q&&t>2*B&&(B*=t/(2*B)),B>=.8*q&&(B=.8*q)):B>=.9*q&&(B=.9*q);var Q=B-this.opt.labelOffset;var N={cx:n.l+t,cy:n.t+q,r:B};this.dyn=[];var ba=Array(O.length),V=[],ha=L,ka=this.opt.minWidth;K.forEach(O,function(v,w){if(0===v)V[w]={step:0,end:ha,start:ha,weak:!1};else{v=ha+2*v*Math.PI;w===O.length-1&&(v=J+2*Math.PI);var D=v-ha;V[w]={step:D,start:ha,end:v,weak:D*B<ka};ha=v}});if(0<ka){I=0;var ma=ka/B;C=0;var ea;for(ea=V.length-1;0<=ea;ea--)V[ea].weak&&(++I,C+=V[ea].step,
V[ea].step=ma);ma*=I;if(ma>Math.PI){ma=Math.PI/I;for(ea=0;ea<V.length;++ea)V[ea].weak&&(V[ea].step=ma);ma=Math.PI}if(0<I)for(ma=1-(ma-C)/2/Math.PI,ea=0;ea<V.length;++ea)V[ea].weak||(V[ea].step*=ma);for(ea=0;ea<V.length;++ea)V[ea].start=ea?V[ea].end:ha,V[ea].end=V[ea].start+V[ea].step;for(ea=V.length-1;0<=ea;--ea)if(0!==V[ea].step){V[ea].end=ha+2*Math.PI;break}}ha=L;var da,ia;K.some(O,function(v,w){var D=T[w],P=S[w];if(1<=v){ia=this._plotFill(P.series.fill,k,n);ia=this._shapeFill(ia,{x:N.cx-N.r,y:N.cy-
N.r,width:2*N.r,height:2*N.r});ia=this._pseudoRadialFill(ia,{x:N.cx,y:N.cy},N.r);var Y=this._createRing(p,N).setFill(ia).setStroke(P.series.stroke);this.dyn.push({fill:ia,stroke:P.series.stroke});W&&(da={element:"slice",index:w,run:this.run,shape:Y,x:w,y:"number"==typeof D?D:D.y,cx:N.cx,cy:N.cy,cr:B},this._connectEvents(da),ba[w]=da);for(w+=1;w<O.length;w++)P=S[w],this.dyn.push({fill:P.series.fill,stroke:P.series.stroke});return!0}if(0===V[w].step)return this.dyn.push({fill:P.series.fill,stroke:P.series.stroke}),
!1;v=V[w].step;Y=N.cx+B*Math.cos(ha);var aa=N.cy+B*Math.sin(ha),Z=N.cx+B*Math.cos(ha+v),ca=N.cy+B*Math.sin(ha+v),U=b._degToRad(this.opt.fanSize);if(P.series.fill&&"radial"===P.series.fill.type&&"fan"===this.opt.radGrad&&v>U){var fa=p.createGroup();U=Math.ceil(v/U);var la=v/U;ia=this._shapeFill(P.series.fill,{x:N.cx-N.r,y:N.cy-N.r,width:2*N.r,height:2*N.r});var ja;for(ja=0;ja<U;++ja){var na=ha+(ja-.2)*la;var pa=ha+(ja+1+.2)*la;var ra=0==ja?Y:N.cx+B*Math.cos(na);var sa=0==ja?aa:N.cy+B*Math.sin(na);
var ta=ja==U-1?Z:N.cx+B*Math.cos(pa);pa=ja==U-1?ca:N.cy+B*Math.sin(pa);this._createSlice(fa,N,B,ra,sa,ta,pa,na,la).setFill(this._pseudoRadialFill(ia,{x:N.cx,y:N.cy},B,ha+(ja+.5)*la,ha+(ja+.5)*la))}U=P.series.stroke;this._createSlice(fa,N,B,Y,aa,Z,ca,ha,v).setStroke(U);Y=fa}else{U=P.series.stroke;Y=this._createSlice(p,N,B,Y,aa,Z,ca,ha,v).setStroke(U);if((ia=P.series.fill)&&"radial"===ia.type)ia=this._shapeFill(ia,{x:N.cx-N.r,y:N.cy-N.r,width:2*N.r,height:2*N.r}),"linear"===this.opt.radGrad&&(ia=this._pseudoRadialFill(ia,
{x:N.cx,y:N.cy},B,ha,ha+v));else if(ia&&"linear"===ia.type){aa=G.clone(Y.getBoundingBox());if("svg"===a.renderer){Z={w:0,h:0};try{Z=y.position(Y.rawNode)}catch(ua){}Z.h>aa.height&&(aa.height=Z.h);Z.w>aa.width&&(aa.width=Z.w)}ia=this._plotFill(ia,k,n);ia=this._shapeFill(ia,aa)}Y.setFill(ia)}this.dyn.push({fill:ia,stroke:P.series.stroke});W&&(da={element:"slice",index:w,run:this.run,shape:Y,x:w,y:"number"==typeof D?D:D.y,cx:N.cx,cy:N.cy,cr:B},this._connectEvents(da),ba[w]=da);ha+=v;return!1},this);
if(this.opt.labels){var oa=d("dojo-bidi")&&this.chart.isRightToLeft();if("default"==this.opt.labelStyle)ha=L=J,K.some(O,function(v,w){if(0>=v&&!this.opt.minWidth)return!1;var D=S[w];if(1<=v)return this.renderLabel(p,N.cx,N.cy+A/2,M[w],D,0<this.opt.labelOffset),!0;v=L+2*v*Math.PI;w+1==O.length&&(v=J+2*Math.PI);if(this.opt.omitLabels&&.001>v-L)return!1;var P=ha+V[w].step/2,Y=N.cx+Q*Math.cos(P);this.renderLabel(p,oa?k.width-Y:Y,N.cy+Q*Math.sin(P)+A/2,M[w],D,0<this.opt.labelOffset);ha+=V[w].step;L=v;
return!1},this);else if("columns"==this.opt.labelStyle){var qa=this.opt.omitLabels;ha=L=J;var z=[],F=0;for(I=O.length-1;0<=I;--I)O[I]&&++F;K.forEach(O,function(v,w){v=L+2*v*Math.PI;w+1==O.length&&(v=J+2*Math.PI);if(0!==this.minWidth||.001<=v-L){var D=ha+V[w].step/2;1!==F||this.opt.minWidth||(D=(L+v)/2);z.push({angle:D,left:0>Math.cos(D),theme:S[w],index:w,omit:qa?.001>v-L:!1})}L=v;ha+=V[w].step},this);var R=a._base._getTextBox("a",{font:r,whiteSpace:"nowrap"}).h;this._getProperLabelRadius(z,R,1.1*
N.r);var X=N.cx-2*N.r,c=N.cx+2*N.r;K.forEach(z,function(v){if(!v.omit){var w=S[v.index],D=0;w&&w.axis&&w.axis.tick&&w.axis.tick.labelGap&&(D=w.axis.tick.labelGap);var P=a._base._getTextBox(M[v.index],{font:w.series.font,whiteSpace:"nowrap",paddingLeft:D+"px"}).w,Y=N.cx+v.labelR*Math.cos(v.angle),aa=N.cy+v.labelR*Math.sin(v.angle),Z=v.left?X+P:c-P;D=v.left?X:Z+D;var ca=N.r;ca=p.createPath().moveTo(N.cx+ca*Math.cos(v.angle),N.cy+ca*Math.sin(v.angle));Math.abs(v.labelR*Math.cos(v.angle))<2*N.r-P&&ca.lineTo(Y,
aa);ca.lineTo(Z,aa).setStroke(v.theme.series.labelWiring);ca.moveToBack();Y=this.renderLabel(p,D,R/3+aa||0,M[v.index],w,!1,"left");W&&!this.opt.htmlLabels&&(w=a._base._getTextBox(M[v.index],{font:v.theme.series.font}).w||0,P=a.normalizedLength(a.splitFontString(v.theme.series.font).size),da={element:"labels",index:v.index,run:this.run,shape:Y,x:D,y:aa,label:M[v.index]},D=Y.getShape(),aa=y.position(this.chart.node,!0),D=G.mixin({type:"rect"},{x:D.x,y:D.y-2*P}),D.x+=aa.x,D.y+=aa.y,D.x=Math.round(D.x),
D.y=Math.round(D.y),D.width=Math.ceil(w),D.height=Math.ceil(P),da.aroundRect=D,this._connectEvents(da),ba[O.length+v.index]=da)}},this)}}var u=0;this._eventSeries[this.run.name]=e.map(T,function(v){return 0>=v?null:ba[u++]});d("dojo-bidi")&&this._checkOrientation(this.group,k,n);return this},_getProperLabelRadius:function(k,n,p){if(1==k.length)k[0].labelR=p;else{var E={},t={},q=2,B=2,r;for(r=0;r<k.length;++r){var A=Math.abs(Math.sin(k[r].angle));k[r].left?q>A&&(q=A,E=k[r]):B>A&&(B=A,t=k[r])}E.labelR=
t.labelR=p;this._caculateLabelR(E,k,n);this._caculateLabelR(t,k,n)}},_caculateLabelR:function(k,n,p){var E,t=n.length,q=k.labelR,B=n[k.index].left?-p:p;var r=0;p=k.index;for(E=(p+1)%t;r<t&&n[p].left===n[E].left;++r)q=(Math.sin(n[p].angle)*q+B)/Math.sin(n[E].angle),q=Math.max(k.labelR,q),n[E].labelR=q,p=(p+1)%t,E=(E+1)%t;r>=t&&(n[0].labelR=k.labelR);r=0;p=k.index;for(E=(p||t)-1;r<t&&n[p].left===n[E].left;++r)q=(Math.sin(n[p].angle)*q-B)/Math.sin(n[E].angle),q=Math.max(k.labelR,q),n[E].labelR=q,p=(p||
t)-1,E=(E||t)-1},_createRing:function(k,n){var p=this.opt.innerRadius;0<p?p=p/100*n.r:0>p&&(p=-p);return p?k.createPath({}).setAbsoluteMode(!0).moveTo(n.cx,n.cy-n.r).arcTo(n.r,n.r,0,!1,!0,n.cx+n.r,n.cy).arcTo(n.r,n.r,0,!0,!0,n.cx,n.cy-n.r).closePath().moveTo(n.cx,n.cy-p).arcTo(p,p,0,!1,!0,n.cx+p,n.cy).arcTo(p,p,0,!0,!0,n.cx,n.cy-p).closePath():k.createCircle(n)},_createSlice:function(k,n,p,E,t,q,B,r,A){var H=this.opt.innerRadius;0<H?H=H/100*n.r:0>H&&(H=-H);if(H){var J=n.cx+H*Math.cos(r),L=n.cy+H*
Math.sin(r),M=n.cx+H*Math.cos(r+A);n=n.cy+H*Math.sin(r+A);return k.createPath({}).setAbsoluteMode(!0).moveTo(J,L).lineTo(E,t).arcTo(p,p,0,A>Math.PI,!0,q,B).lineTo(M,n).arcTo(H,H,0,A>Math.PI,!1,J,L).closePath()}return k.createPath({}).setAbsoluteMode(!0).moveTo(n.cx,n.cy).lineTo(E,t).arcTo(p,p,0,A>Math.PI,!0,q,B).lineTo(n.cx,n.cy).closePath()}})})},"dojox/charting/plot2d/Base":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojox/gfx ../Element ./common ../axis2d/common dojo/has".split(" "),
function(G,K,m,y,x,h,l,g){G=G("dojox.charting.plot2d.Base",x,{constructor:function(a,b){b&&b.tooltipFunc&&(this.tooltipFunc=b.tooltipFunc)},clear:function(){this.series=[];this.dirty=!0;return this},setAxis:function(a){return this},assignAxes:function(a){K.forEach(this.axes,function(b){this[b]&&this.setAxis(a[this[b]])},this)},addSeries:function(a){this.series.push(a);return this},getSeriesStats:function(){return h.collectSimpleStats(this.series,m.hitch(this,"isNullValue"))},calculateAxes:function(a){this.initializeScalers(a,
this.getSeriesStats());return this},initializeScalers:function(){return this},isDataDirty:function(){return K.some(this.series,function(a){return a.dirty})},render:function(a,b){return this},renderLabel:function(a,b,e,f,d,k,n){a=l.createText[this.opt.htmlLabels&&"vml"!=y.renderer?"html":"gfx"](this.chart,a,b,e,n?n:"middle",f,d.series.font,d.series.fontColor);k&&(this.opt.htmlLabels&&"vml"!=y.renderer?a.style.pointerEvents="none":a.rawNode&&(a.rawNode.style.pointerEvents="none"));this.opt.htmlLabels&&
"vml"!=y.renderer&&this.htmlElements.push(a);return a},getRequiredColors:function(){return this.series.length},_getLabel:function(a){return h.getLabel(a,this.opt.fixed,this.opt.precision)}});g("dojo-bidi")&&G.extend({_checkOrientation:function(a,b,e){this.chart.applyMirroring(this.group,b,e)}});return G})},"dojox/charting/plot2d/_PlotEvents":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect"],function(G,K,m,y){return m("dojox.charting.plot2d._PlotEvents",
null,{constructor:function(){this._shapeEvents=[];this._eventSeries={}},destroy:function(){this.resetEvents();this.inherited(arguments)},plotEvent:function(x){},raiseEvent:function(x){this.plotEvent(x);var h=G.delegate(x);h.originalEvent=x.type;h.originalPlot=x.plot;h.type="onindirect";K.forEach(this.chart.stack,function(l){l!==this&&l.plotEvent&&(h.plot=l,l.plotEvent(h))},this)},connect:function(x,h){this.dirty=!0;return y.connect(this,"plotEvent",x,h)},events:function(){return!!this.plotEvent.after},
resetEvents:function(){this._shapeEvents.length&&(K.forEach(this._shapeEvents,function(x){x.shape.disconnect(x.handle)}),this._shapeEvents=[]);this.raiseEvent({type:"onplotreset",plot:this})},_connectSingleEvent:function(x,h){this._shapeEvents.push({shape:x.eventMask,handle:x.eventMask.connect(h,this,function(l){x.type=h;x.event=l;this.raiseEvent(x);x.event=null})})},_connectEvents:function(x){x&&(x.chart=this.chart,x.plot=this,x.hAxis=this.hAxis||null,x.vAxis=this.vAxis||null,x.eventMask=x.eventMask||
x.shape,this._connectSingleEvent(x,"onmouseover"),this._connectSingleEvent(x,"onmouseout"),this._connectSingleEvent(x,"onclick"))},_reconnectEvents:function(x){(x=this._eventSeries[x])&&K.forEach(x,this._connectEvents,this)},fireEvent:function(x,h,l,g){(x=this._eventSeries[x])&&x.length&&l<x.length&&(l=x[l],l.type=h,l.event=g||null,this.raiseEvent(l),l.event=null)}})})},"dojox/charting/action2d/Tooltip":function(){define("dijit/Tooltip dojo/_base/lang dojo/_base/declare dojo/_base/window dojo/_base/connect dojo/dom-style ./PlotAction dojox/gfx/matrix dojo/has dojo/has!dojo-bidi?../bidi/action2d/Tooltip dojox/lang/functional dojox/lang/functional/scan dojox/lang/functional/fold".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e){var f=function(n,p){var E=n.run&&n.run.data&&n.run.data[n.index];return E&&"number"!=typeof E&&(E.tooltip||E.text)?E.tooltip||E.text:p.tooltipFunc?p.tooltipFunc(n):n.y},d=Math.PI/4,k=Math.PI/2;h=m(a("dojo-bidi")?"dojox.charting.action2d.NonBidiTooltip":"dojox.charting.action2d.Tooltip",l,{defaultParams:{text:f,mouseOver:!0,defaultPosition:["after-centered","before-centered"]},optionalParams:{},constructor:function(n,p,E){this.text=E&&E.text?E.text:f;this.mouseOver=
E&&void 0!=E.mouseOver?E.mouseOver:!0;this.defaultPosition=E&&void 0!=E.defaultPosition?E.defaultPosition:["after-centered","before-centered"];this.connect()},process:function(n){if("onplotreset"===n.type||"onmouseout"===n.type)G.hide(this.aroundRect),this.aroundRect=null,"onplotreset"===n.type&&delete this.angles;else if(!(!n.shape||this.mouseOver&&"onmouseover"!==n.type||!this.mouseOver&&"onclick"!==n.type)){var p={type:"rect"},E=this.defaultPosition;switch(n.element){case "marker":p.x=n.cx;p.y=
n.cy;p.w=p.h=1;break;case "circle":p.x=n.cx-n.cr;p.y=n.cy-n.cr;p.w=p.h=2*n.cr;break;case "spider_circle":p.x=n.cx;p.y=n.cy;p.w=p.h=1;break;case "spider_plot":return;case "column":E=["above-centered","below-centered"];case "bar":p=K.clone(n.shape.getShape());p.w=p.width;p.h=p.height;break;case "candlestick":p.x=n.x;p.y=n.y;p.w=n.width;p.h=n.height;break;default:if(!this.angles){var t="number"==typeof n.run.data[0]?e.map(n.run.data,"x ? Math.max(x, 0) : 0"):e.map(n.run.data,"x ? Math.max(x.y, 0) : 0");
this.angles=e.map(e.scanl(t,"+",0),"* 2 * Math.PI / this",e.foldl(t,"+",0))}t=g._degToRad(n.plot.opt.startAngle);var q=(this.angles[n.index]+this.angles[n.index+1])/2+t;p.x=n.cx+n.cr*Math.cos(q);p.y=n.cy+n.cr*Math.sin(q);p.w=p.h=1;t&&(0>q||q>2*Math.PI)&&(q=Math.abs(2*Math.PI-Math.abs(q)));q<d||(q<k+d?E=["below-centered","above-centered"]:q<Math.PI+d?E=["before-centered","after-centered"]:q<2*Math.PI-d&&(E=["above-centered","below-centered"]))}a("dojo-bidi")&&this._recheckPosition(n,p,E);t=this.chart.getCoords();
p.x+=t.x;p.y+=t.y;p.x=Math.round(p.x);p.y=Math.round(p.y);p.w=Math.ceil(p.w);p.h=Math.ceil(p.h);this.aroundRect=p;(n=this.text(n,this.plot))&&G.show(this._format(n),this.aroundRect,E);this.mouseOver||(this._handle=x.connect(y.doc,"onclick",this,"onClick"))}},onClick:function(){this.process({type:"onmouseout"})},_recheckPosition:function(n,p,E){},_format:function(n){return n}});return a("dojo-bidi")?m("dojox.charting.action2d.Tooltip",[h,b]):h})},"dojox/charting/action2d/PlotAction":function(){define(["dojo/_base/connect",
"dojo/_base/declare","./Base","dojo/fx/easing","dojox/lang/functional"],function(G,K,m,y,x){var h=y.backOut;return K("dojox.charting.action2d.PlotAction",m,{overOutEvents:{onmouseover:1,onmouseout:1},constructor:function(l,g,a){this.anim={};a||(a={});this.duration=a.duration?a.duration:400;this.easing=a.easing?a.easing:h},connect:function(){this.handle=this.chart.connectToPlot(this.plot.name,this,"process")},disconnect:function(){this.handle&&(G.disconnect(this.handle),this.handle=null)},reset:function(){},
destroy:function(){this.inherited(arguments);x.forIn(this.anim,function(l){x.forIn(l,function(g){g.action.stop(!0)})});this.anim={}}})})},"dojox/charting/action2d/Base":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/Evented"],function(G,K,m){return K("dojox.charting.action2d.Base",m,{constructor:function(y,x){this.chart=y;this.plot=x?G.isString(x)?this.chart.getPlot(x):x:this.chart.getPlot("default")},connect:function(){},disconnect:function(){},destroy:function(){this.disconnect()}})})},
"dojo/fx/easing":function(){define(["../_base/lang"],function(G){var K={linear:function(m){return m},quadIn:function(m){return Math.pow(m,2)},quadOut:function(m){return m*(m-2)*-1},quadInOut:function(m){m*=2;return 1>m?Math.pow(m,2)/2:-1*(--m*(m-2)-1)/2},cubicIn:function(m){return Math.pow(m,3)},cubicOut:function(m){return Math.pow(m-1,3)+1},cubicInOut:function(m){m*=2;return 1>m?Math.pow(m,3)/2:(Math.pow(m-2,3)+2)/2},quartIn:function(m){return Math.pow(m,4)},quartOut:function(m){return-1*(Math.pow(m-
1,4)-1)},quartInOut:function(m){m*=2;return 1>m?Math.pow(m,4)/2:-.5*(Math.pow(m-2,4)-2)},quintIn:function(m){return Math.pow(m,5)},quintOut:function(m){return Math.pow(m-1,5)+1},quintInOut:function(m){m*=2;return 1>m?Math.pow(m,5)/2:(Math.pow(m-2,5)+2)/2},sineIn:function(m){return-1*Math.cos(Math.PI/2*m)+1},sineOut:function(m){return Math.sin(Math.PI/2*m)},sineInOut:function(m){return-1*(Math.cos(Math.PI*m)-1)/2},expoIn:function(m){return 0==m?0:Math.pow(2,10*(m-1))},expoOut:function(m){return 1==
m?1:-1*Math.pow(2,-10*m)+1},expoInOut:function(m){if(0==m)return 0;if(1==m)return 1;m*=2;if(1>m)return Math.pow(2,10*(m-1))/2;--m;return(-1*Math.pow(2,-10*m)+2)/2},circIn:function(m){return-1*(Math.sqrt(1-Math.pow(m,2))-1)},circOut:function(m){return Math.sqrt(1-Math.pow(m-1,2))},circInOut:function(m){m*=2;return 1>m?-.5*(Math.sqrt(1-Math.pow(m,2))-1):.5*(Math.sqrt(1-Math.pow(m-2,2))+1)},backIn:function(m){return Math.pow(m,2)*(2.70158*m-1.70158)},backOut:function(m){--m;return Math.pow(m,2)*(2.70158*
m+1.70158)+1},backInOut:function(m){m*=2;if(1>m)return Math.pow(m,2)*(3.5949095*m-2.5949095)/2;m-=2;return(Math.pow(m,2)*(3.5949095*m+2.5949095)+2)/2},elasticIn:function(m){if(0==m||1==m)return m;--m;return-1*Math.pow(2,10*m)*Math.sin(2*(m-.075)*Math.PI/.3)},elasticOut:function(m){return 0==m||1==m?m:Math.pow(2,-10*m)*Math.sin(2*(m-.075)*Math.PI/.3)+1},elasticInOut:function(m){if(0==m)return 0;m*=2;if(2==m)return 1;var y=.3*1.5,x=y/4;if(1>m)return--m,-.5*Math.pow(2,10*m)*Math.sin(2*(m-x)*Math.PI/
y);--m;return.5*Math.pow(2,-10*m)*Math.sin(2*(m-x)*Math.PI/y)+1},bounceIn:function(m){return 1-K.bounceOut(1-m)},bounceOut:function(m){return m=m<1/2.75?7.5625*Math.pow(m,2):m<2/2.75?7.5625*Math.pow(m-1.5/2.75,2)+.75:m<2.5/2.75?7.5625*Math.pow(m-2.25/2.75,2)+.9375:7.5625*Math.pow(m-2.625/2.75,2)+.984375},bounceInOut:function(m){return.5>m?K.bounceIn(2*m)/2:K.bounceOut(2*m-1)/2+.5}};G.setObject("dojo.fx.easing",K);return K})},"dojox/lang/functional/scan":function(){define(["dojo/_base/kernel","dojo/_base/lang",
"./lambda"],function(G,K,m){var y={};K.mixin(m,{scanl:function(x,h,l,g){"string"==typeof x&&(x=x.split(""));g=g||G.global;h=m.lambda(h);var a,b;if(K.isArray(x)){var e=Array((a=x.length)+1);e[0]=l;for(b=0;b<a;l=h.call(g,l,x[b],b,x),e[++b]=l);}else if("function"==typeof x.hasNext&&"function"==typeof x.next)for(e=[l],b=0;x.hasNext();e.push(l=h.call(g,l,x.next(),b++,x)));else for(b in e=[l],x)b in y||e.push(l=h.call(g,l,x[b],b,x));return e},scanl1:function(x,h,l){"string"==typeof x&&(x=x.split(""));l=
l||G.global;h=m.lambda(h);var g;var a=!0;if(K.isArray(x)){var b=Array(a=x.length);b[0]=g=x[0];for(var e=1;e<a;b[e]=g=h.call(l,g,x[e],e,x),++e);}else if("function"==typeof x.hasNext&&"function"==typeof x.next){if(x.hasNext())for(b=[g=x.next()],e=1;x.hasNext();b.push(g=h.call(l,g,x.next(),e++,x)));}else for(e in x)e in y||(a?(b=[g=x[e]],a=!1):b.push(g=h.call(l,g,x[e],e,x)));return b},scanr:function(x,h,l,g){"string"==typeof x&&(x=x.split(""));g=g||G.global;h=m.lambda(h);var a=x.length,b=Array(a+1),
e=a;for(b[a]=l;0<e;--e,l=h.call(g,l,x[e],e,x),b[e]=l);return b},scanr1:function(x,h,l){"string"==typeof x&&(x=x.split(""));l=l||G.global;h=m.lambda(h);var g=x.length,a=Array(g),b=x[g-1];--g;for(a[g]=b;0<g;--g,b=h.call(l,b,x[g],g,x),a[g]=b);return a}})})},"dojox/charting/action2d/Highlight":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/Color dojo/_base/connect dojox/color/_base ./PlotAction dojo/fx/easing dojox/gfx/fx".split(" "),function(G,K,m,y,x,h,l,g){var a=function(f){return function(){return f}},
b=function(f){f=new x.Color(f);var d=f.toHsl();0==d.s?d.l=50>d.l?100:0:(d.s=100,d.l=50>d.l?75:75<d.l?50:d.l-50>75-d.l?50:75);d=x.fromHsl(d);d.a=f.a;return d},e=function(f){f=b(f);f.a=.7;return f};return K("dojox.charting.action2d.Highlight",h,{defaultParams:{duration:400,easing:l.backOut},optionalParams:{highlight:"red"},constructor:function(f,d,k){this.colorFunc=(f=k&&k.highlight)?G.isFunction(f)?f:a(f):b;this.connect()},process:function(f){if(f.shape&&f.type in this.overOutEvents&&"spider_circle"!=
f.element&&"spider_plot"!=f.element){"spider_poly"==f.element&&this.colorFunc==b&&(this.colorFunc=e);var d=f.run.name,k=f.index,n;d in this.anim?n=this.anim[d][k]:this.anim[d]={};if(n)n.action.stop(!0);else{n=f.shape.getFill();if(!(n&&n instanceof m))return;this.anim[d][k]=n={start:n,end:this.colorFunc(n)}}var p=n.start,E=n.end;if("onmouseout"==f.type){var t=p;p=E;E=t}n.action=g.animateFill({shape:f.shape,duration:this.duration,easing:this.easing,color:{start:p,end:E}});"onmouseout"==f.type&&y.connect(n.action,
"onEnd",this,function(){this.anim[d]&&delete this.anim[d][k]});n.action.play()}}})})},"dojox/gfx/fx":function(){define("dojo/_base/lang ./_base ./matrix dojo/_base/Color dojo/_base/array dojo/_base/fx dojo/_base/connect dojo/sniff".split(" "),function(G,K,m,y,x,h,l,g){function a(t,q){this.start=t;this.end=q}function b(t,q,B){this.start=t;this.end=q;this.units=B}function e(t,q){this.start=t;this.end=q;this.temp=new y}function f(t){this.values=t;this.length=t.length}function d(t,q){this.values=t;this.def=
q?q:{}}function k(t,q){this.stack=t;this.original=q}function n(t,q,B,r){if(t.values)return new f(t.values);var A;var H=t.start?K.normalizeColor(t.start):A=q?B?q[B]:q:r;t.end?t=K.normalizeColor(t.end):(A||(A=q?B?q[B]:q:r),t=A);return new e(H,t)}var p=K.fx={};a.prototype.getValue=function(t){return(this.end-this.start)*t+this.start};b.prototype.getValue=function(t){return(this.end-this.start)*t+this.start+this.units};e.prototype.getValue=function(t){return y.blendColors(this.start,this.end,t,this.temp)};
f.prototype.getValue=function(t){return this.values[Math.min(Math.floor(t*this.length),this.length-1)]};d.prototype.getValue=function(t){var q=G.clone(this.def),B;for(B in this.values)q[B]=this.values[B].getValue(t);return q};k.prototype.getValue=function(t){var q=[];x.forEach(this.stack,function(B){if(B instanceof m.Matrix2D)q.push(B);else if("original"==B.name&&this.original)q.push(this.original);else if("matrix"==B.name){if(B.start instanceof m.Matrix2D&&B.end instanceof m.Matrix2D){var r=new m.Matrix2D;
for(A in B.start)r[A]=(B.end[A]-B.start[A])*t+B.start[A];q.push(r)}}else if(B.name in m)if(r=m[B.name],"function"!=typeof r)q.push(r);else{var A=x.map(B.start,function(H,J){return(B.end[J]-H)*t+H});r=r.apply(m,A);r instanceof m.Matrix2D&&q.push(r)}},this);return q};var E=new y(0,0,0,0);p.animateStroke=function(t){t.easing||(t.easing=h._defaultEasing);var q=new h.Animation(t),B=t.shape,r;l.connect(q,"beforeBegin",q,function(){r=B.getStroke();var A=t.color,H={};A&&(H.color=n(A,r,"color",E));(A=t.style)&&
A.values&&(H.style=new f(A.values));if(A=t.width){var J=A,L=r;if(J.values)var M=new f(J.values);else A=J.start?J.start:M=L?L.width:1,J.end?M=J.end:"number"!=typeof M&&(M=L?L.width:1),M=new a(A,M);H.width=M}(A=t.cap)&&A.values&&(H.cap=new f(A.values));if(A=t.join)A.values?H.join=new f(A.values):(M=A.start?A.start:r&&r.join||0,A=A.end?A.end:r&&r.join||0,"number"==typeof M&&"number"==typeof A&&(H.join=new a(M,A)));this.curve=new d(H,r)});l.connect(q,"onAnimate",B,"setStroke");return q};p.animateFill=
function(t){t.easing||(t.easing=h._defaultEasing);var q=new h.Animation(t),B=t.shape,r;l.connect(q,"beforeBegin",q,function(){r=B.getFill();var A=t.color;A&&(this.curve=n(A,r,"",E))});l.connect(q,"onAnimate",B,"setFill");return q};p.animateFont=function(t){t.easing||(t.easing=h._defaultEasing);var q=new h.Animation(t),B=t.shape,r;l.connect(q,"beforeBegin",q,function(){r=B.getFont();var A=t.style,H={};A&&A.values&&(H.style=new f(A.values));(A=t.variant)&&A.values&&(H.variant=new f(A.values));(A=t.weight)&&
A.values&&(H.weight=new f(A.values));(A=t.family)&&A.values&&(H.family=new f(A.values));if((A=t.size)&&A.units){var J=parseFloat(A.start?A.start:B.font&&B.font.size||"0");var L=parseFloat(A.end?A.end:B.font&&B.font.size||"0");H.size=new b(J,L,A.units)}this.curve=new d(H,r)});l.connect(q,"onAnimate",B,"setFont");return q};p.animateTransform=function(t){t.easing||(t.easing=h._defaultEasing);var q=new h.Animation(t),B=t.shape,r;l.connect(q,"beforeBegin",q,function(){r=B.getTransform();this.curve=new k(t.transform,
r)});l.connect(q,"onAnimate",B,"setTransform");if("svg"===K.renderer&&(9<=g("ie")||g("ff")))var A=[l.connect(q,"onBegin",q,function(){for(var H=B.getParent();H&&H.getParent;)H=H.getParent();H&&(B.__svgContainer=H.rawNode.parentNode,B.__svgRoot=H.rawNode,B.__svgRoot&&B.__svgRoot.getAttribute&&(B.__svgWidth=parseInt(B.__svgRoot.getAttribute("width"),10),isNaN(B.__svgWidth)&&delete B.__svgWidth))}),l.connect(q,"onAnimate",q,function(){try{if(B.__svgContainer){var H=B.__svgContainer.style.visibility;
B.__svgContainer.style.visibility="visible";B.__svgContainer.style.visibility=H;var J=B.__svgWidth;if(!isNaN(J))try{B.__svgRoot.setAttribute("width",J-5E-6),B.__svgRoot.setAttribute("width",J)}catch(L){}}}catch(L){}}),l.connect(q,"onEnd",q,function(){x.forEach(A,l.disconnect);if(B.__svgContainer){var H=B.__svgContainer;if(null==H.getAttribute("__gotVis")){H.setAttribute("__gotVis",!0);var J=B.__svgContainer.style.visibility,L=B.__svgRoot,M=B.__svgWidth;H.style.visibility="visible";setTimeout(function(){try{H.style.visibility=
J;H.removeAttribute("__gotVis");H=null;try{isNaN(M)||(L.setAttribute("width",M-5E-6),L.setAttribute("width",M))}catch(T){}}catch(T){}},100)}}delete B.__svgContainer;delete B.__svgRoot;delete B.__svgWidth})];return q};return p})},"dojox/charting/action2d/MoveSlice":function(){define("dojo/_base/connect dojo/_base/declare dojo/_base/array ./PlotAction dojo/fx/easing dojox/gfx/matrix dojox/gfx/fx dojox/lang/functional dojox/lang/functional/scan dojox/lang/functional/fold".split(" "),function(G,K,m,y,
x,h,l,g){return K("dojox.charting.action2d.MoveSlice",y,{defaultParams:{duration:400,easing:x.backOut,scale:1.05,shift:7},optionalParams:{},constructor:function(a,b,e){e||(e={});this.scale="number"==typeof e.scale?e.scale:1.05;this.shift="number"==typeof e.shift?e.shift:7;this.connect()},process:function(a){if(a.shape&&"slice"==a.element&&a.type in this.overOutEvents){if(!this.angles){var b=h._degToRad(a.plot.opt.startAngle);this.angles="number"==typeof a.run.data[0]?g.map(g.scanl(a.run.data,"+",
0),"* 2 * Math.PI / this",g.foldl(a.run.data,"+",0)):g.map(g.scanl(a.run.data,"a + b.y",0),"* 2 * Math.PI / this",g.foldl(a.run.data,"a + b.y",0));this.angles=m.map(this.angles,function(q){return q+b})}var e=a.index;var f=(this.angles[e]+this.angles[e+1])/2;var d=h.rotateAt(-f,a.cx,a.cy),k=h.rotateAt(f,a.cx,a.cy);(f=this.anim[e])?f.action.stop(!0):this.anim[e]=f={};if("onmouseover"==a.type){var n=0;var p=this.shift;var E=1;var t=this.scale}else n=this.shift,p=0,E=this.scale,t=1;f.action=l.animateTransform({shape:a.shape,
duration:this.duration,easing:this.easing,transform:[k,{name:"translate",start:[n,0],end:[p,0]},{name:"scaleAt",start:[E,a.cx,a.cy],end:[t,a.cx,a.cy]},d]});"onmouseout"==a.type&&G.connect(f.action,"onEnd",this,function(){delete this.anim[e]});f.action.play()}},reset:function(){delete this.angles}})})},"dojox/charting/plot2d/Spider":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/dom-geometry dojo/_base/fx dojo/fx dojo/sniff ./Base ./_PlotEvents ./common ../axis2d/common dojox/gfx dojox/gfx/matrix dojox/gfx/fx dojox/lang/functional dojox/lang/utils dojo/fx/easing".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e,f,d,k,n,p,E,t){return K("dojox.charting.plot2d.Spider",[a,b],{defaultParams:{labels:!0,ticks:!1,fixed:!0,precision:1,labelOffset:-10,labelStyle:"default",htmlLabels:!0,startAngle:-90,divisions:3,axisColor:"",axisWidth:0,spiderColor:"",spiderWidth:0,seriesWidth:0,seriesFillAlpha:.2,spiderOrigin:.16,markerSize:3,spiderType:"polygon",animationType:t.backOut,animate:null,axisTickFont:"",axisTickFontColor:"",axisFont:"",axisFontColor:""},optionalParams:{radius:0,font:"",
fontColor:""},constructor:function(q,B){this.opt=G.clone(this.defaultParams);E.updateWithObject(this.opt,B);E.updateWithPattern(this.opt,B,this.optionalParams);this.dyn=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animate=null===this.opt.animate?{}:this.opt.animate;this.animations={}},clear:function(){this.inherited(arguments);this.dyn=[];this.axes=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};return this},setAxis:function(q){q&&(void 0!=q.opt.min&&(this.datas[q.name].min=
q.opt.min),void 0!=q.opt.max&&(this.datas[q.name].max=q.opt.max));return this},addSeries:function(q){this.series.push(q);for(var B in q.data){var r=q.data[B],A=this.datas[B];A?(A.vlist.push(r),A.min=Math.min(A.min,r),A.max=Math.max(A.max,r)):(A="__"+B,this.axes.push(A),this[A]=B,this.datas[B]={min:r,max:r,vlist:[r]})}if(0>=this.labelKey.length)for(B in q.data)this.labelKey.push(B);return this},getSeriesStats:function(){return e.collectSimpleStats(this.series,function(q){return null===q})},render:function(q,
B){if(!this.dirty)return this;this.dirty=!1;this.cleanGroup();var r=this.group,A=this.chart.theme;this.resetEvents();if(!this.series||!this.series.length)return this;var H=this.opt,J=A.axis,L=(q.width-B.l-B.r)/2,M=(q.height-B.t-B.b)/2,T=Math.min(L,M),W=H.font||J.majorTick&&J.majorTick.font||J.tick&&J.tick.font||"normal normal normal 7pt Tahoma",C=H.axisFont||J.tick&&J.tick.titleFont||"normal normal normal 11pt Tahoma",I=H.axisTickFontColor||J.majorTick&&J.majorTick.fontColor||J.tick&&J.tick.fontColor||
"silver",O=H.axisFontColor||J.tick&&J.tick.titleFontColor||"black",S=H.axisColor||J.tick&&J.tick.axisColor||"silver",Q=H.spiderColor||J.tick&&J.tick.spiderColor||"silver",N=H.axisWidth||J.stroke&&J.stroke.width||2,ba=H.spiderWidth||J.stroke&&J.stroke.width||2;J=H.seriesWidth||J.stroke&&J.stroke.width||2;var V=d.normalizedLength(d.splitFontString(C).size),ha=k._degToRad(H.startAngle),ka=H.spiderOrigin,ma=3<=H.divisions?H.divisions:3,ea=H.markerSize,da=H.spiderType,ia=H.animationType,oa=-10>H.labelOffset?
H.labelOffset:-10;if(H.labels){T=y.map(this.series,function(aa){return aa.name},this);T=p.foldl1(p.map(T,function(aa){return d._base._getTextBox(aa,{font:A.series.font}).w},this),"Math.max(a, b)")/2;T=Math.min(L-2*T,M-V)+oa;var qa=T-oa}"radius"in H&&(T=H.radius,qa=T-oa);T/=1.2;B={cx:B.l+L,cy:B.t+M,r:T};for(L=0;L<this.series.length;L++){var z=this.series[L];if(this.dirty||z.dirty){if(z.cleanGroup(),V=z.data,null!==V&&(M=this._getObjectLength(V),!F||0>=F.length)){var F=[];var R=[];var X=[];this._buildPoints(F,
M,B,T,ha,!0,q);this._buildPoints(R,M,B,T*ka,ha,!0,q);this._buildPoints(X,M,B,qa,ha,!1,q);if(2<ma){var c=[];var u=[];for(V=0;V<ma-2;V++)c[V]=[],this._buildPoints(c[V],M,B,T*(ka+(1-ka)*(V+1)/(ma-1)),ha,!0,q),u[V]=T*(ka+(1-ka)*(V+1)/(ma-1))}}}else A.skip()}M=r.createGroup();S={color:S,width:N};L={color:Q,width:ba};for(V=F.length-1;0<=V;--V)Q=F[V],ba={x:Q.x+.2*(Q.x-B.cx),y:Q.y+.2*(Q.y-B.cy)},Q={x:Q.x+.2*(Q.x-B.cx)/2,y:Q.y+.2*(Q.y-B.cy)/2},M.createLine({x1:B.cx,y1:B.cy,x2:ba.x,y2:ba.y}).setStroke(S),this._drawArrow(M,
ba,Q,S);M=r.createGroup();for(V=X.length-1;0<=V;--V)Q=X[V],ba=d._base._getTextBox(this.labelKey[V],{font:C}).w||0,S=this.opt.htmlLabels&&"vml"!=d.renderer?"html":"gfx",Q=f.createText[S](this.chart,M,x.isBodyLtr()||"html"!=S?Q.x:Q.x+ba-q.width,Q.y,"middle",this.labelKey[V],C,O),this.opt.htmlLabels&&this.htmlElements.push(Q);C=r.createGroup();if("polygon"==da){if(C.createPolyline(F).setStroke(L),C.createPolyline(R).setStroke(L),0<c.length)for(V=c.length-1;0<=V;--V)C.createPolyline(c[V]).setStroke(L)}else if(C.createCircle({cx:B.cx,
cy:B.cy,r:T}).setStroke(L),C.createCircle({cx:B.cx,cy:B.cy,r:T*ka}).setStroke(L),0<u.length)for(V=u.length-1;0<=V;--V)C.createCircle({cx:B.cx,cy:B.cy,r:u[V]}).setStroke(L);M=this._getObjectLength(this.datas);O=r.createGroup();c=0;for(var v in this.datas){u=this.datas[v];F=u.min;u=u.max;u-=F;C=ha+2*Math.PI*c/M;for(L=0;L<ma;L++)X=F+u*L/(ma-1),Q=this._getCoordinate(B,T*(ka+(1-ka)*L/(ma-1)),C,q),X=this._getLabel(X),ba=d._base._getTextBox(X,{font:W}).w||0,S=this.opt.htmlLabels&&"vml"!=d.renderer?"html":
"gfx",this.opt.htmlLabels&&this.htmlElements.push(f.createText[S](this.chart,O,x.isBodyLtr()||"html"!=S?Q.x:Q.x+ba-q.width,Q.y,"start",X,W,I));c++}this.chart.seriesShapes={};for(L=this.series.length-1;0<=L;L--)if(z=this.series[L],V=z.data,null!==V){W=A.next("spider",[H,z]);var w=d.normalizeColor(W.series.fill);W={color:W.series.fill,width:J};w.a=H.seriesFillAlpha;z.dyn={fill:w,stroke:W};if(!z.hidden){var D=[],P=[];c=0;for(v in V)u=this.datas[v],F=u.min,u=u.max,u-=F,I=V[v],C=ha+2*Math.PI*c/M,Q=this._getCoordinate(B,
T*(ka+(1-ka)*(I-F)/u),C,q),D.push(Q),P.push({sname:z.name,key:v,data:I}),c++;D[D.length]=D[0];P[P.length]=P[0];I=this._getBoundary(D);var Y=z.group;W=this._createSeriesEntry(Y,this.oldSeriePoints[z.name]||R,D,w,W,T,ka,ea,ia);this.chart.seriesShapes[z.name]=W;this.oldSeriePoints[z.name]=D;this._connectEvents({element:"spider_poly",index:L,id:"spider_poly_"+z.name,run:z,plot:this,shape:W.poly,parent:Y,brect:I,cx:B.cx,cy:B.cy,cr:T,f:w,s:r});this._connectEvents({element:"spider_plot",index:L,id:"spider_plot_"+
z.name,run:z,plot:this,shape:z.group});y.forEach(W.circles,function(aa,Z){this._connectEvents({element:"spider_circle",index:Z,id:"spider_circle_"+z.name+Z,run:z,plot:this,shape:aa,parent:Y,tdata:P[Z],cx:D[Z].x,cy:D[Z].y,f:w,s:r})},this)}}return this},_createSeriesEntry:function(q,B,r,A,H,J,L,M,T){J=this.animate?B:r;var W=q.createPolyline(J).setFill(A).setStroke(H),C=[];for(L=0;L<J.length;L++){var I=J[L];I=q.createCircle({cx:I.x,cy:I.y,r:M}).setFill(A).setStroke(H);C.push(I)}this.animate&&(A=y.map(r,
function(O,S){O=new h.Animation(G.delegate({duration:1E3,easing:T,curve:[B[S].y,O.y]},this.animate));var Q=C[S];m.connect(O,"onAnimate",function(N){var ba=W.getShape();ba.points[S].y=N;W.setShape(ba);ba=Q.getShape();ba.cy=N;Q.setShape(ba)});return O},this),r=y.map(r,function(O,S){O=new h.Animation(G.delegate({duration:1E3,easing:T,curve:[B[S].x,O.x]},this.animate));var Q=C[S];m.connect(O,"onAnimate",function(N){var ba=W.getShape();ba.points[S].x=N;W.setShape(ba);ba=Q.getShape();ba.cx=N;Q.setShape(ba)});
return O},this),l.combine(A.concat(r)).play());return{group:q,poly:W,circles:C}},plotEvent:function(q){"spider_plot"==q.element&&("onmouseover"!=q.type||g("ie")||q.shape.moveToFront())},tooltipFunc:function(q){return"spider_circle"==q.element?q.tdata.sname+"\x3cbr/\x3e"+q.tdata.key+"\x3cbr/\x3e"+q.tdata.data:null},_getBoundary:function(q){for(var B=q[0].x,r=q[0].x,A=q[0].y,H=q[0].y,J=0;J<q.length;J++){var L=q[J];B=Math.max(L.x,B);A=Math.max(L.y,A);r=Math.min(L.x,r);H=Math.min(L.y,H)}return{x:r,y:H,
width:B-r,height:A-H}},_drawArrow:function(q,B,r,A){var H=Math.sqrt(Math.pow(r.x-B.x,2)+Math.pow(r.y-B.y,2)),J=(r.y-B.y)/H,L=(r.x-B.x)/H;q.createPolyline([B,{x:r.x+H/3*-J,y:r.y+H/3*L},{x:r.x+H/3*J,y:r.y+H/3*-L}]).setFill(A.color).setStroke(A)},_buildPoints:function(q,B,r,A,H,J,L){for(var M=0;M<B;M++)q.push(this._getCoordinate(r,A,H+2*Math.PI*M/B,L));J&&q.push(this._getCoordinate(r,A,H+2*Math.PI,L))},_getCoordinate:function(q,B,r,A){var H=q.cx+B*Math.cos(r);g("dojo-bidi")&&this.chart.isRightToLeft()&&
A&&(H=A.width-H);return{x:H,y:q.cy+B*Math.sin(r)}},_getObjectLength:function(q){var B=0;if(G.isObject(q))for(var r in q)B++;return B},_getLabel:function(q){return e.getLabel(q,this.opt.fixed,this.opt.precision)}})})},"dojox/charting/widget/SelectableLegend":function(){define("dojo/_base/array dojo/_base/declare dojo/query dojo/_base/connect dojo/_base/Color ./Legend dijit/form/CheckBox ../action2d/Highlight dojox/lang/functional dojox/gfx/fx dojo/keys dojo/dom-construct dojo/dom-prop dijit/registry".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e,f,d,k){function n(t){return"mouseenter"==t?"onmouseover":"mouseleave"==t?"onmouseout":"on"+t}var p=K(null,{constructor:function(t){this.legend=t;this.index=0;this.horizontalLength=this._getHrizontalLength();G.forEach(t.legends,function(q,B){0<B&&m("input",q).attr("tabindex",-1)});this.firstLabel=m("input",t.legends[0])[0];y.connect(this.firstLabel,"focus",this,function(){this.legend.active=!0});y.connect(this.legend.domNode,"keydown",this,"_onKeyEvent")},_getHrizontalLength:function(){var t=
this.legend.horizontal;return"number"==typeof t?Math.min(t,this.legend.legends.length):t?this.legend.legends.length:1},_onKeyEvent:function(t){if(this.legend.active)if(t.keyCode==e.TAB)this.legend.active=!1;else{var q=this.legend.legends.length;switch(t.keyCode){case e.LEFT_ARROW:this.index--;0>this.index&&(this.index+=q);break;case e.RIGHT_ARROW:this.index++;this.index>=q&&(this.index-=q);break;case e.UP_ARROW:0<=this.index-this.horizontalLength&&(this.index-=this.horizontalLength);break;case e.DOWN_ARROW:this.index+
this.horizontalLength<q&&(this.index+=this.horizontalLength);break;default:return}this._moveToFocus();Event.stop(t)}},_moveToFocus:function(){m("input",this.legend.legends[this.index])[0].focus()}}),E=K(g,{connect:function(){}});return K("dojox.charting.widget.SelectableLegend",h,{outline:!1,transitionFill:null,transitionStroke:null,autoScale:!1,postCreate:function(){this.legends=[];this.legendAnim={};this._cbs=[];this.inherited(arguments)},refresh:function(){this.legends=[];this._clearLabels();this.inherited(arguments);
this._applyEvents();new p(this)},_clearLabels:function(){for(var t=this._cbs;t.length;)t.pop().destroyRecursive()},_addLabel:function(t,q){this.inherited(arguments);var B=m("td",this.legendBody),r=B[B.length-1];this.legends.push(r);B=new l({checked:!0});this._cbs.push(B);f.place(B.domNode,r,"first");r=m("label",r)[0];d.set(r,"for",B.id)},_applyEvents:function(){this.chart.dirty||G.forEach(this.legends,function(t,q){if(this._isPie()){var B=this.chart.stack[0];var r=B.name;var A=this.chart.series[0].name}else B=
this.chart.series[q],r=B.plot,A=B.name;var H=k.byNode(m(".dijitCheckBox",t)[0]);H.set("checked",!this._isHidden(r,q));y.connect(H,"onClick",this,function(M){this.toogle(r,q,!H.get("checked"));M.stopPropagation()});var J=m(".dojoxLegendIcon",t)[0],L=this._getFilledShape(this._surfaces[q].children);G.forEach(["onmouseenter","onmouseleave"],function(M){y.connect(J,M,this,function(T){this._highlight(T,L,q,!H.get("checked"),A,r)})},this)},this)},_isHidden:function(t,q){return this._isPie()?-1!=G.indexOf(this.chart.getPlot(t).runFilter,
q):this.chart.series[q].hidden},toogle:function(t,q,B){t=this.chart.getPlot(t);this._isPie()?-1!=G.indexOf(t.runFilter,q)?B||(t.runFilter=G.filter(t.runFilter,function(r){return r!=q})):B&&t.runFilter.push(q):this.chart.series[q].hidden=B;this.autoScale?this.chart.dirty=!0:t.dirty=!0;this.chart.render()},_highlight:function(t,q,B,r,A,H){if(!r){var J=this._getAnim(H),L=this._isPie(),M=n(t.type);J.process({shape:q,index:L?"legend"+B:"legend",run:{name:A},type:M});G.forEach(this._getShapes(B,H),function(T,
W){T={shape:T,index:L?B:W,run:{name:A},type:M};J.duration=100;J.process(T)})}},_getShapes:function(t,q){var B=[];if(this._isPie()){var r=0;G.forEach(this.chart.getPlot(q).runFilter,function(A){t>A&&r++});B.push(this.chart.stack[0].group.children[t-r])}else this._isCandleStick(q)?G.forEach(this.chart.series[t].group.children,function(A){G.forEach(A.children,function(H){G.forEach(H.children,function(J){"line"!=J.shape.type&&B.push(J)})})}):B=this.chart.series[t].group.children;return B},_getAnim:function(t){this.legendAnim[t]||
(this.legendAnim[t]=new E(this.chart,t));return this.legendAnim[t]},_getTransitionFill:function(t){return-1!=this.chart.stack[this.chart.plots[t]].declaredClass.indexOf("dojox.charting.plot2d.Stacked")?this.chart.theme.plotarea.fill:null},_getFilledShape:function(t){for(var q=0;t[q];){if(t[q].getFill())return t[q];q++}return null},_isPie:function(){return"dojox.charting.plot2d.Pie"==this.chart.stack[0].declaredClass},_isCandleStick:function(t){return"dojox.charting.plot2d.Candlesticks"==this.chart.stack[this.chart.plots[t]].declaredClass},
destroy:function(){this._clearLabels();this.inherited(arguments)}})})},"dojox/charting/widget/Legend":function(){define("dojo/_base/declare dijit/_WidgetBase dojox/gfx dojo/_base/array dojo/has dojo/has!dojo-bidi?../bidi/widget/Legend dojox/lang/functional dojo/dom dojo/dom-construct dojo/dom-class dijit/registry".split(" "),function(G,K,m,y,x,h,l,g,a,b,e){K=G(x("dojo-bidi")?"dojox.charting.widget.NonBidiLegend":"dojox.charting.widget.Legend",K,{chartRef:"",horizontal:!0,swatchSize:18,legendBody:null,
postCreate:function(){!this.chart&&this.chartRef&&((this.chart=e.byId(this.chartRef)||e.byNode(g.byId(this.chartRef)))||console.log("Could not find chart instance with id: "+this.chartRef));this.chart=this.chart.chart||this.chart;this.refresh()},buildRendering:function(){this.domNode=a.create("table",{role:"group","aria-label":"chart legend","class":"dojoxLegendNode"});this.legendBody=a.create("tbody",null,this.domNode);this.inherited(arguments)},destroy:function(){this._surfaces&&y.forEach(this._surfaces,
function(f){f.destroy()});this.inherited(arguments)},refresh:function(){this._surfaces&&y.forEach(this._surfaces,function(k){k.destroy()});for(this._surfaces=[];this.legendBody.lastChild;)a.destroy(this.legendBody.lastChild);this.horizontal&&(b.add(this.domNode,"dojoxLegendHorizontal"),this._tr=a.create("tr",null,this.legendBody),this._inrow=0);var f=this.series||this.chart.series;if(0!=f.length)if("dojox.charting.plot2d.Pie"==f[0].chart.stack[0].declaredClass){var d=f[0].chart.stack[0];"number"==
typeof d.run.data[0]?(f=l.map(d.run.data,"Math.max(x, 0)"),f=l.map(f,"/this",l.foldl(f,"+",0)),y.forEach(f,function(k,n){this._addLabel(d.dyn[n],d._getLabel(100*k)+"%")},this)):y.forEach(d.run.data,function(k,n){this._addLabel(d.dyn[n],k.legend||k.text||k.y)},this)}else y.forEach(f,function(k){this._addLabel(k.dyn,k.legend||k.name)},this)},_addLabel:function(f,d){var k=a.create("td"),n=a.create("div",null,k),p=a.create("label",null,k),E=a.create("div",{style:{width:this.swatchSize+"px",height:this.swatchSize+
"px","float":"left"}},n);b.add(n,"dojoxLegendIcon dijitInline");b.add(p,"dojoxLegendText");this._tr?(this._tr.appendChild(k),++this._inrow===this.horizontal&&(this._tr=a.create("tr",null,this.legendBody),this._inrow=0)):a.create("tr",null,this.legendBody).appendChild(k);this._makeIcon(E,f);p.innerHTML=String(d);x("dojo-bidi")&&(p.dir=this.getTextDir(d,p.dir))},_makeIcon:function(f,d){var k=this.swatchSize,n=this.swatchSize;f=m.createSurface(f,n,k);this._surfaces.push(f);if(d.fill)f.createRect({x:2,
y:2,width:n-4,height:k-4}).setFill(d.fill).setStroke(d.stroke);else if(d.stroke||d.marker){var p={x1:0,y1:k/2,x2:n,y2:k/2};d.stroke&&f.createLine(p).setStroke(d.stroke);d.marker&&f.createPath({path:"M"+n/2+" "+k/2+" "+d.marker}).setFill(d.markerFill).setStroke(d.markerStroke)}else f.createRect({x:2,y:2,width:n-4,height:k-4}).setStroke("black"),f.createLine({x1:2,y1:2,x2:n-2,y2:k-2}).setStroke("black"),f.createLine({x1:2,y1:k-2,x2:n-2,y2:2}).setStroke("black")}});return x("dojo-bidi")?G("dojox.charting.widget.Legend",
[K,h]):K})},"dojox/charting/action2d/Magnify":function(){define("dojo/_base/connect dojo/_base/declare ./PlotAction dojox/gfx/matrix dojox/gfx/fx dojo/fx dojo/fx/easing".split(" "),function(G,K,m,y,x,h,l){return K("dojox.charting.action2d.Magnify",m,{defaultParams:{duration:400,easing:l.backOut,scale:2},optionalParams:{},constructor:function(g,a,b){this.scale=b&&"number"==typeof b.scale?b.scale:2;this.connect()},process:function(g){if(g.shape&&g.type in this.overOutEvents&&"cx"in g&&"cy"in g&&"spider_plot"!=
g.element&&"spider_poly"!=g.element){var a=g.run.name,b=g.index,e=[],f;a in this.anim?f=this.anim[a][b]:this.anim[a]={};f?f.action.stop(!0):this.anim[a][b]=f={};if("onmouseover"==g.type){var d=y.identity;var k=this.scale}else d=y.scaleAt(this.scale,g.cx,g.cy),k=1/this.scale;d={shape:g.shape,duration:this.duration,easing:this.easing,transform:[{name:"scaleAt",start:[1,g.cx,g.cy],end:[k,g.cx,g.cy]},d]};g.shape&&e.push(x.animateTransform(d));g.outline&&(d.shape=g.outline,e.push(x.animateTransform(d)));
g.shadow&&(d.shape=g.shadow,e.push(x.animateTransform(d)));e.length?(f.action=h.combine(e),"onmouseout"==g.type&&G.connect(f.action,"onEnd",this,function(){this.anim[a]&&delete this.anim[a][b]}),f.action.play()):delete this.anim[a][b]}}})})},"dojox/charting/Theme":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/Color ./SimpleTheme dojox/color/_base dojox/color/Palette dojox/gfx/gradutils".split(" "),function(G,K,m,y,x,h){var l=K("dojox.charting.Theme",y,{});G.mixin(l,{defineColors:function(g){g=
g||{};var a=[],b=g.num||5;if(g.colors){var e=g.colors.length;for(var f=0;f<b;f++)a.push(g.colors[f%e]);return a}return g.hue?h.generate(x.fromHsv(g.hue,g.saturation||100,((g.high||90)+(g.low||30))/2),"monochromatic").colors:g.generator?x.Palette.generate(g.base,g.generator).colors:a},generateGradient:function(g,a,b){g=G.delegate(g);g.colors=[{offset:0,color:a},{offset:1,color:b}];return g},generateHslColor:function(g,a){g=new m(g);var b=g.toHsl();a=x.fromHsl(b.h,b.s,a);a.a=g.a;return a},generateHslGradient:function(g,
a,b,e){g=new m(g);var f=g.toHsl();b=x.fromHsl(f.h,f.s,b);e=x.fromHsl(f.h,f.s,e);b.a=e.a=g.a;return l.generateGradient(a,b,e)}});l.defaultMarkers=y.defaultMarkers;l.defaultColors=y.defaultColors;l.defaultTheme=y.defaultTheme;return l})},"dojox/color/Palette":function(){define(["dojo/_base/lang","dojo/_base/array","./_base"],function(G,K,m){function y(a,b,e){var f=new m.Palette;f.colors=[];K.forEach(a.colors,function(d){f.colors.push(new m.Color({r:Math.min(255,Math.max(0,"dr"==b?d.r+e:d.r)),g:Math.min(255,
Math.max(0,"dg"==b?d.g+e:d.g)),b:Math.min(255,Math.max(0,"db"==b?d.b+e:d.b)),a:Math.min(1,Math.max(0,"da"==b?d.a+e:d.a))}))});return f}function x(a,b,e){var f=new m.Palette;f.colors=[];K.forEach(a.colors,function(d){d=d.toCmy();f.colors.push(m.fromCmy(Math.min(100,Math.max(0,"dc"==b?d.c+e:d.c)),Math.min(100,Math.max(0,"dm"==b?d.m+e:d.m)),Math.min(100,Math.max(0,"dy"==b?d.y+e:d.y))))});return f}function h(a,b,e){var f=new m.Palette;f.colors=[];K.forEach(a.colors,function(d){d=d.toCmyk();f.colors.push(m.fromCmyk(Math.min(100,
Math.max(0,"dc"==b?d.c+e:d.c)),Math.min(100,Math.max(0,"dm"==b?d.m+e:d.m)),Math.min(100,Math.max(0,"dy"==b?d.y+e:d.y)),Math.min(100,Math.max(0,"dk"==b?d.b+e:d.b))))});return f}function l(a,b,e){var f=new m.Palette;f.colors=[];K.forEach(a.colors,function(d){d=d.toHsl();f.colors.push(m.fromHsl(("dh"==b?d.h+e:d.h)%360,Math.min(100,Math.max(0,"ds"==b?d.s+e:d.s)),Math.min(100,Math.max(0,"dl"==b?d.l+e:d.l))))});return f}function g(a,b,e){var f=new m.Palette;f.colors=[];K.forEach(a.colors,function(d){d=
d.toHsv();f.colors.push(m.fromHsv(("dh"==b?d.h+e:d.h)%360,Math.min(100,Math.max(0,"ds"==b?d.s+e:d.s)),Math.min(100,Math.max(0,"dv"==b?d.v+e:d.v))))});return f}m.Palette=function(a){this.colors=[];a instanceof m.Palette?this.colors=a.colors.slice(0):a instanceof m.Color?this.colors=[null,null,a,null,null]:G.isArray(a)?this.colors=K.map(a.slice(0),function(b){return G.isString(b)?new m.Color(b):b}):G.isString(a)&&(this.colors=[null,null,new m.Color(a),null,null])};G.extend(m.Palette,{transform:function(a){var b=
y;if(a.use){var e=a.use.toLowerCase();0==e.indexOf("hs")?b="l"==e.charAt(2)?l:g:0==e.indexOf("cmy")&&(b="k"==e.charAt(3)?h:x)}else if("dc"in a||"dm"in a||"dy"in a)b="dk"in a?h:x;else if("dh"in a||"ds"in a)b="dv"in a?g:l;e=this;for(var f in a)"use"!=f&&(e=b(e,f,a[f]));return e},clone:function(){return new m.Palette(this)}});G.mixin(m.Palette,{generators:{analogous:function(a){var b=a.high||60,e=a.low||18;a=(G.isString(a.base)?new m.Color(a.base):a.base).toHsv();var f=Math.max(10,95>=a.s?a.s+5:100-
(a.s-95)),d=92<=a.v?a.v-9:Math.max(a.v+9,20),k=90>=a.v?Math.max(a.v+5,20):95+Math.ceil((a.v-90)/2),n=[f,1<a.s?a.s-1:21-a.s,a.s,f,f],p=[d,k,a.v,d,k];return new m.Palette(K.map([(a.h+e+360)%360,(a.h+Math.round(e/2)+360)%360,a.h,(a.h-Math.round(b/2)+360)%360,(a.h-b+360)%360],function(E,t){return m.fromHsv(E,n[t],p[t])}))},monochromatic:function(a){a=G.isString(a.base)?new m.Color(a.base):a.base;var b=a.toHsv(),e=9<b.s-30?b.s-30:b.s+30,f=b.s,d=20<b.v-20?b.v-20:b.v+60,k=20<b.v-50?b.v-50:b.v+30;return new m.Palette([m.fromHsv(b.h,
e,100-.8*(100-b.v)),m.fromHsv(b.h,f,k),a,m.fromHsv(b.h,e,k),m.fromHsv(b.h,f,d)])},triadic:function(a){a=G.isString(a.base)?new m.Color(a.base):a.base;var b=a.toHsv(),e=(b.h-157+360)%360,f=90<b.s?b.s-10:b.s+10,d=95<b.s?b.s-5:b.s+5,k=20<b.v-20?b.v-20:b.v+20,n=20<b.v-30?b.v-30:b.v+30,p=70<b.v-30?b.v-30:b.v+30;return new m.Palette([m.fromHsv((b.h+57+360)%360,20<b.s?b.s-10:b.s+10,b.v),m.fromHsv(b.h,f,n),a,m.fromHsv(e,f,k),m.fromHsv(e,d,p)])},complementary:function(a){a=G.isString(a.base)?new m.Color(a.base):
a.base;var b=a.toHsv(),e=360>2*b.h+137?2*b.h+137:Math.floor(b.h/2)-137,f=100-.9*(100-b.s),d=Math.min(100,b.s+20),k=20<b.v?b.v-30:b.v+30;return new m.Palette([m.fromHsv(b.h,Math.max(b.s-10,0),Math.min(100,b.v+30)),m.fromHsv(b.h,f,k),a,m.fromHsv(e,d,k),m.fromHsv(e,b.s,b.v)])},splitComplementary:function(a){var b=G.isString(a.base)?new m.Color(a.base):a.base,e=a.da||30;a=b.toHsv();var f=360>2*a.h+137?2*a.h+137:Math.floor(a.h/2)-137,d=(f-e+360)%360;e=(f+e)%360;f=100-.9*(100-a.s);var k=Math.min(100,a.s+
20),n=20<a.v?a.v-30:a.v+30;return new m.Palette([m.fromHsv(d,Math.max(a.s-10,0),Math.min(100,a.v+30)),m.fromHsv(d,f,n),b,m.fromHsv(e,k,n),m.fromHsv(e,a.s,a.v)])},compound:function(a){a=G.isString(a.base)?new m.Color(a.base):a.base;var b=a.toHsv(),e=360>2*b.h+18?2*b.h+18:Math.floor(b.h/2)-18,f=360>2*b.h+120?2*b.h+120:Math.floor(b.h/2)-120,d=360>2*b.h+99?2*b.h+99:Math.floor(b.h/2)-99,k=80<b.s-10?b.s-10:b.s+10,n=10<b.s-25?b.s-25:b.s+25,p=80<b.v-20?b.v-20:b.v+20,E=Math.max(b.v,20);return new m.Palette([m.fromHsv(e,
10<b.s-40?b.s-40:b.s+40,10<b.v-40?b.v-40:b.v+40),m.fromHsv(e,k,p),a,m.fromHsv(f,n,E),m.fromHsv(d,k,p)])},shades:function(a){a=G.isString(a.base)?new m.Color(a.base):a.base;var b=a.toHsv(),e=100==b.s&&0==b.v?0:b.s,f=20<=b.v-25?b.v-25:b.v+55,d=20<=b.v-75?b.v-75:b.v+5,k=Math.max(b.v-10,20);return new m.Palette([new m.fromHsv(b.h,e,20<b.v-50?b.v-50:b.v+30),new m.fromHsv(b.h,e,f),a,new m.fromHsv(b.h,e,d),new m.fromHsv(b.h,e,k)])}},generate:function(a,b){if(G.isFunction(b))return b({base:a});if(m.Palette.generators[b])return m.Palette.generators[b]({base:a});
throw Error("dojox.color.Palette.generate: the specified generator ('"+b+"') does not exist.");}});return m.Palette})},"dojox/charting/plot2d/Bars":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has ./CartesianBase ./_PlotEvents ./common dojox/gfx/fx dojox/lang/utils dojox/lang/functional".split(" "),function(G,K,m,y,x,h,l,g,a,b){var e=function(){return!1};return m("dojox.charting.plot2d.Bars",[x,h],{defaultParams:{gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,
maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:""},constructor:function(f,d){this.opt=G.clone(G.mixin(this.opt,this.defaultParams));a.updateWithObject(this.opt,d);a.updateWithPattern(this.opt,d,this.optionalParams);this.animate=this.opt.animate;this.renderingOptions={"shape-rendering":"crispEdges"}},getSeriesStats:function(){var f=l.collectSimpleStats(this.series,G.hitch(this,"isNullValue"));f.hmin-=.5;f.hmax+=.5;var d=f.hmin;f.hmin=f.vmin;f.vmin=d;
d=f.hmax;f.hmax=f.vmax;f.vmax=d;return f},createRect:function(f,d,k){if(this.opt.enableCache&&0<f._rectFreePool.length){var n=f._rectFreePool.pop();n.setShape(k);d.add(n)}else n=d.createRect(k);this.opt.enableCache&&f._rectUsePool.push(n);return n},createLabel:function(f,d,k,n){this.opt.labels&&"outside"==this.opt.labelStyle?this.renderLabel(f,k.x+k.width+this.opt.labelOffset,k.y+k.height/2,this._getLabel(isNaN(d.y)?d:d.y),n,"start"):this.inherited(arguments)},render:function(f,d){if(this.zoom&&!this.isDataDirty())return this.performZoom(f,
d);this.dirty=this.isDirty();this.resetEvents();if(this.dirty){K.forEach(this.series,l.purgeGroup);this._eventSeries={};this.cleanGroup();var k=this.getGroup();b.forEachRev(this.series,function(ea){ea.cleanGroup(k)})}var n=this.chart.theme,p=this._hScaler.scaler.getTransformerFromModel(this._hScaler),E=this._vScaler.scaler.getTransformerFromModel(this._vScaler),t=Math.max(this._hScaler.bounds.lower,this._hAxis?this._hAxis.naturalBaseline:0),q=p(t),B=this.events(),r=this.getBarProperties(),A=this.series.length;
K.forEach(this.series,function(ea){ea.hidden&&A--});var H=A,J=this.extractValues(this._vScaler);J=this.rearrangeValues(J,p,q);for(var L=0;L<this.series.length;L++){var M=this.series[L];if(this.dirty||M.dirty){M.cleanGroup();this.opt.enableCache&&(M._rectFreePool=(M._rectFreePool?M._rectFreePool:[]).concat(M._rectUsePool?M._rectUsePool:[]),M._rectUsePool=[]);var T=n.next("bar",[this.opt,M]);if(M.hidden)M.dyn.fill=T.series.fill,M.dyn.stroke=T.series.stroke;else{H--;var W=Array(M.data.length);k=M.group;
for(var C=K.some(M.data,function(ea){return"number"==typeof ea||ea&&!ea.hasOwnProperty("x")}),I=C?Math.min(M.data.length,Math.ceil(this._vScaler.bounds.to)):M.data.length,O=C?Math.max(0,Math.floor(this._vScaler.bounds.from-1)):0;O<I;++O){var S=M.data[O];if(!this.isNullValue(S)){var Q=this.getValue(S,O,L,C),N=J[L][O];if(this.opt.styleFunc||"number"!=typeof S){var ba="number"!=typeof S?[S]:[];this.opt.styleFunc&&ba.push(this.opt.styleFunc(S));ba=n.addMixin(T,"bar",ba,!0)}else ba=n.post(T,"bar");if(N&&
1<=r.height){var V={x:d.l+q+Math.min(N,0),y:f.height-d.b-E(Q.x+1.5)+r.gap+r.thickness*(A-H-1),width:Math.abs(N),height:r.height};if(ba.series.shadow){var ha=G.clone(V);ha.x+=ba.series.shadow.dx;ha.y+=ba.series.shadow.dy;ha=this.createRect(M,k,ha).setFill(ba.series.shadow.color).setStroke(ba.series.shadow);this.animate&&this._animateBar(ha,d.l+q,-N)}var ka=this._plotFill(ba.series.fill,f,d);ka=this._shapeFill(ka,V);ka=this.createRect(M,k,V).setFill(ka).setStroke(ba.series.stroke);ka.setFilter&&ba.series.filter&&
ka.setFilter(ba.series.filter);M.dyn.fill=ka.getFill();M.dyn.stroke=ka.getStroke();if(B){var ma={element:"bar",index:O,run:M,shape:ka,shadow:ha,cx:Q.y,cy:Q.x+1.5,x:C?O:M.data[O].x,y:C?M.data[O]:M.data[O].y};this._connectEvents(ma);W[O]=ma}!isNaN(Q.py)&&Q.py>t&&(V.x+=p(Q.py),V.width-=p(Q.py));this.createLabel(k,S,V,ba);this.animate&&this._animateBar(ka,d.l+q,-Math.abs(N))}}}this._eventSeries[M.name]=W;M.dirty=!1}}else n.skip(),this._reconnectEvents(M.name)}this.dirty=!1;y("dojo-bidi")&&this._checkOrientation(this.group,
f,d);return this},getValue:function(f,d,k,n){n?(k="number"==typeof f?f:f.y,f=d):(k=f.y,f=f.x-1);return{y:k,x:f}},extractValues:function(f){for(var d=[],k=this.series.length-1;0<=k;--k){var n=this.series[k];if(this.dirty||n.dirty){var p=K.some(n.data,function(B){return"number"==typeof B||B&&!B.hasOwnProperty("x")}),E=p?Math.max(0,Math.floor(f.bounds.from-1)):0;p=p?Math.min(n.data.length,Math.ceil(f.bounds.to)):n.data.length;var t=d[k]=[];t.min=E;for(t.max=p;E<p;++E){var q=n.data[E];t[E]=this.isNullValue(q)?
0:"number"==typeof q?q:q.y}}}return d},rearrangeValues:function(f,d,k){for(var n=0,p=f.length;n<p;++n){var E=f[n];if(E)for(var t=E.min,q=E.max;t<q;++t){var B=E[t];E[t]=this.isNullValue(B)?0:d(B)-k}}return f},isNullValue:function(f){if(null===f||"undefined"==typeof f)return!0;var d=this._hAxis?this._hAxis.isNullValue:e,k=this._vAxis?this._vAxis.isNullValue:e;return"number"==typeof f?k(.5)||d(f):k(isNaN(f.x)?.5:f.x+.5)||null===f.y||d(f.y)},getBarProperties:function(){var f=l.calculateBarSize(this._vScaler.bounds.scale,
this.opt);return{gap:f.gap,height:f.size,thickness:0}},_animateBar:function(f,d,k){0==k&&(k=1);g.animateTransform(G.delegate({shape:f,duration:1200,transform:[{name:"translate",start:[d-d/k,0],end:[0,0]},{name:"scale",start:[1/k,1],end:[1,1]},{name:"original"}]},this.animate)).play()}})})},"dojox/charting/plot2d/CartesianBase":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/connect dojo/has ./Base ../scaler/primitive dojox/gfx dojox/gfx/fx dojox/lang/utils".split(" "),function(G,
K,m,y,x,h,l,g,a){var b=function(){return!1};return K("dojox.charting.plot2d.CartesianBase",x,{baseParams:{hAxis:"x",vAxis:"y",labels:!1,labelOffset:10,fixed:!0,precision:1,labelStyle:"inside",htmlLabels:!0,omitLabels:!0,labelFunc:null},constructor:function(e,f){this.axes=["hAxis","vAxis"];this.zoom=null;this.zoomQueue=[];this.lastWindow={vscale:1,hscale:1,xoffset:0,yoffset:0};this.hAxis=f&&f.hAxis||"x";this.vAxis=f&&f.vAxis||"y";this.series=[];this.opt=G.clone(this.baseParams);a.updateWithObject(this.opt,
f)},clear:function(){this.inherited(arguments);this._vAxis=this._hAxis=null;return this},cleanGroup:function(e,f){this.inherited(arguments);if(!f&&this.chart._nativeClip){var d=this.chart.offsets,k=this.chart.dim;this.group.setClip({x:d.l,y:d.t,width:Math.max(0,k.width-d.l-d.r),height:Math.max(0,k.height-d.t-d.b)});this._clippedGroup||(this._clippedGroup=this.group.createGroup())}},purgeGroup:function(){this.inherited(arguments);this._clippedGroup=null},getGroup:function(){return this._clippedGroup||
this.group},setAxis:function(e){e&&(this[e.vertical?"_vAxis":"_hAxis"]=e);return this},toPage:function(e){var f=this._hAxis,d=this._vAxis,k=f.getScaler(),n=d.getScaler(),p=k.scaler.getTransformerFromModel(k),E=n.scaler.getTransformerFromModel(n),t=this.chart.getCoords(),q=this.chart.offsets,B=this.chart.dim;k=function(r){var A={};A.x=p(r[f.name])+t.x+q.l;A.y=t.y+B.height-q.b-E(r[d.name]);return A};return e?k(e):k},toData:function(e){var f=this._hAxis,d=this._vAxis,k=f.getScaler(),n=d.getScaler(),
p=k.scaler.getTransformerFromPlot(k),E=n.scaler.getTransformerFromPlot(n),t=this.chart.getCoords(),q=this.chart.offsets,B=this.chart.dim;k=function(r){var A={};A[f.name]=p(r.x-t.x-q.l);A[d.name]=E(t.y+B.height-r.y-q.b);return A};return e?k(e):k},isDirty:function(){return this.dirty||this._hAxis&&this._hAxis.dirty||this._vAxis&&this._vAxis.dirty},createLabel:function(e,f,d,k){if(this.opt.labels){var n=this.opt.labelFunc?this.opt.labelFunc.apply(this,[f,this.opt.fixed,this.opt.precision]):this._getLabel(isNaN(f.y)?
f:f.y);if("inside"==this.opt.labelStyle){var p=l._base._getTextBox(n,{font:k.series.font});f=d.x+d.width/2;var E=d.y+d.height/2+p.h/4;if(p.w>d.width||p.h>d.height)return}else f=d.x+d.width/2,E=d.y-this.opt.labelOffset;this.renderLabel(e,f,E,n,k,"inside"==this.opt.labelStyle)}},performZoom:function(e,f){var d=this._vAxis.scale||1,k=this._hAxis.scale||1;e=e.height-f.b;var n=this._hScaler.bounds;n=(n.from-n.lower)*n.scale;var p=this._vScaler.bounds;p=(p.from-p.lower)*p.scale;var E=d/this.lastWindow.vscale,
t=k/this.lastWindow.hscale,q=(this.lastWindow.xoffset-n)/(1==this.lastWindow.hscale?k:this.lastWindow.hscale),B=(p-this.lastWindow.yoffset)/(1==this.lastWindow.vscale?d:this.lastWindow.vscale),r=this.getGroup();f=g.animateTransform(G.delegate({shape:r,duration:1200,transform:[{name:"translate",start:[0,0],end:[f.l*(1-t),e*(1-E)]},{name:"scale",start:[1,1],end:[t,E]},{name:"original"},{name:"translate",start:[0,0],end:[q,B]}]},this.zoom));G.mixin(this.lastWindow,{vscale:d,hscale:k,xoffset:n,yoffset:p});
this.zoomQueue.push(f);m.connect(f,"onEnd",this,function(){this.zoom=null;this.zoomQueue.shift();0<this.zoomQueue.length&&this.zoomQueue[0].play()});1==this.zoomQueue.length&&this.zoomQueue[0].play();return this},initializeScalers:function(e,f){this._hAxis?(this._hAxis.initialized()||this._hAxis.calculate(f.hmin,f.hmax,e.width),this._hScaler=this._hAxis.getScaler()):this._hScaler=h.buildScaler(f.hmin,f.hmax,e.width);this._vAxis?(this._vAxis.initialized()||this._vAxis.calculate(f.vmin,f.vmax,e.height),
this._vScaler=this._vAxis.getScaler()):this._vScaler=h.buildScaler(f.vmin,f.vmax,e.height);return this},isNullValue:function(e){if(null===e||"undefined"==typeof e)return!0;var f=this._hAxis?this._hAxis.isNullValue:b,d=this._vAxis?this._vAxis.isNullValue:b;return"number"==typeof e?f(1)||d(e):f(isNaN(e.x)?1:e.x)||null===e.y||d(e.y)}})})},"dojox/charting/scaler/primitive":function(){define(["dojo/_base/lang"],function(G){var K=G.getObject("dojox.charting.scaler.primitive",!0);return G.mixin(K,{buildScaler:function(m,
y,x,h){m==y&&(m-=.5,y+=.5);return{bounds:{lower:m,upper:y,from:m,to:y,scale:x/(y-m),span:x},scaler:K}},buildTicks:function(m,y){return{major:[],minor:[],micro:[]}},getTransformerFromModel:function(m){var y=m.bounds.from,x=m.bounds.scale;return function(h){return(h-y)*x}},getTransformerFromPlot:function(m){var y=m.bounds.from,x=m.bounds.scale;return function(h){return h/x+y}}})})},"dojox/charting/axis2d/Default":function(){define("dojo/_base/lang dojo/_base/array dojo/sniff dojo/_base/declare dojo/_base/connect dojo/dom-geometry ./Invisible ../scaler/linear ./common dojox/gfx dojox/lang/utils dojox/lang/functional dojo/has!dojo-bidi?../bidi/axis2d/Default".split(" "),
function(G,K,m,y,x,h,l,g,a,b,e,f,d){l=y(m("dojo-bidi")?"dojox.charting.axis2d.NonBidiDefault":"dojox.charting.axis2d.Default",l,{defaultParams:{vertical:!1,fixUpper:"none",fixLower:"none",natural:!1,leftBottom:!0,includeZero:!1,fixed:!0,majorLabels:!0,minorTicks:!0,minorLabels:!0,microTicks:!1,rotation:0,htmlLabels:!0,enableCache:!1,dropLabels:!0,labelSizeChange:!1,position:"leftOrBottom"},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,
maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null,stroke:{},majorTick:{},minorTick:{},microTick:{},tick:{},font:"",fontColor:"",title:"",titleGap:0,titleFont:"",titleFontColor:"",titleOrientation:""},constructor:function(k,n){this.opt=G.clone(this.defaultParams);e.updateWithObject(this.opt,n);e.updateWithPattern(this.opt,n,this.optionalParams);this.opt.enableCache&&(this._textFreePool=[],this._lineFreePool=[],this._textUsePool=[],this._lineUsePool=[]);this._invalidMaxLabelSize=!0;n&&"position"in
n||(this.opt.position=this.opt.leftBottom?"leftOrBottom":"rightOrTop");this.renderingOptions={"shape-rendering":"crispEdges"}},setWindow:function(k,n){k!=this.scale&&(this._invalidMaxLabelSize=!0);return this.inherited(arguments)},_groupLabelWidth:function(k,n,p){if(!k.length)return 0;50<k.length&&(k.length=50);G.isObject(k[0])&&(k=f.map(k,function(E){return E.text}));p&&(k=f.map(k,function(E){return 0==G.trim(E).length?"":E.substring(0,p)+this.trailingSymbol},this));k=k.join("\x3cbr\x3e");return b._base._getTextBox(k,
{font:n}).w||0},_getMaxLabelSize:function(k,n,p,E,t,q){if(null==this._maxLabelSize&&6==arguments.length){var B=this.opt;this.scaler.minMinorStep=this._prevMinMinorStep=0;var r=G.clone(B);delete r.to;delete r.from;var A=g.buildScaler(k,n,p,r,B.to-B.from);A.minMinorStep=0;this._majorStart=A.major.start;B=g.buildTicks(A,B);if(q&&B){var H=A=0,J=function(M){M.label&&this.push(M.label)},L=[];this.opt.majorLabels&&(K.forEach(B.major,J,L),A=this._groupLabelWidth(L,t,r.maxLabelCharCount),r.maxLabelSize&&(A=
Math.min(r.maxLabelSize,A)));L=[];this.opt.dropLabels&&this.opt.minorLabels&&(K.forEach(B.minor,J,L),H=this._groupLabelWidth(L,t,r.maxLabelCharCount),r.maxLabelSize&&(H=Math.min(r.maxLabelSize,H)));this._maxLabelSize={majLabelW:A,minLabelW:H,majLabelH:q,minLabelH:q}}else this._maxLabelSize=null}return this._maxLabelSize},calculate:function(k,n,p){this.inherited(arguments);this.scaler.minMinorStep=this._prevMinMinorStep;if((this._invalidMaxLabelSize||p!=this._oldSpan)&&Infinity!=k&&-Infinity!=n){this._invalidMaxLabelSize=
!1;this.opt.labelSizeChange&&(this._maxLabelSize=null);this._oldSpan=p;var E=this.opt,t=this.chart.theme.axis,q=E.rotation%360,B=this.chart.theme.axis.tick.labelGap,r=E.font||t.majorTick&&t.majorTick.font||t.tick&&t.tick.font;t=r?b.normalizedLength(b.splitFontString(r).size):0;r=this._getMaxLabelSize(k,n,p,q,r,t);"number"!=typeof B&&(B=4);if(r&&E.dropLabels){E=Math.abs(Math.cos(q*Math.PI/180));var A=Math.abs(Math.sin(q*Math.PI/180));0>q&&(q+=360);switch(q){case 0:case 180:this.vertical?q=t:(q=r.majLabelW,
t=r.minLabelW);break;case 90:case 270:this.vertical?(q=r.majLabelW,t=r.minLabelW):q=t;break;default:q=this.vertical?Math.min(r.majLabelW,t/E):Math.min(r.majLabelW,t/A),t=Math.min(Math.sqrt(r.minLabelW*r.minLabelW+t*t),this.vertical?t*E+r.minLabelW*A:r.minLabelW*E+t*A)}this.scaler.minMinorStep=this._prevMinMinorStep=Math.max(q,t)+B;this._skipInterval=this.scaler.minMinorStep<=this.scaler.minor.tick*this.scaler.bounds.scale?0:Math.floor((q+B)/(this.scaler.major.tick*this.scaler.bounds.scale))}else this._skipInterval=
0}this.ticks=g.buildTicks(this.scaler,this.opt);return this},getOffsets:function(){var k={l:0,r:0,t:0,b:0};if(!this.scaler)return k;var n=this.opt,p=this.chart.theme.axis,E=this.chart.theme.axis.tick.labelGap,t=n.titleFont||p.title&&p.title.font;p=0==n.titleGap?0:n.titleGap||p.title&&p.title.gap;var q=this.chart.theme.getTick("major",n),B=this.chart.theme.getTick("minor",n);t=t?b.normalizedLength(b.splitFontString(t).size):0;var r=n.rotation%360,A=n.position,H="rightOrTop"!==A,J=Math.abs(Math.cos(r*
Math.PI/180)),L=Math.abs(Math.sin(r*Math.PI/180));this.trailingSymbol=void 0===n.trailingSymbol||null===n.trailingSymbol?this.trailingSymbol:n.trailingSymbol;"number"!=typeof E&&(E=4);0>r&&(r+=360);var M=this._getMaxLabelSize();if(M){var T=Math.ceil(Math.max(M.majLabelW,M.minLabelW))+1,W=Math.ceil(Math.max(M.majLabelH,M.minLabelH))+1;if(this.vertical)switch(M=H?"l":"r",r){case 0:case 180:k[M]="center"===A?0:T;k.t=k.b=W/2;break;case 90:case 270:k[M]=W;k.t=k.b=T/2;break;default:45>=r||180<r&&225>=r?
(k[M]=W*L/2+T*J,k[H?"t":"b"]=W*J/2+T*L,k[H?"b":"t"]=W*J/2):315<r||180>r&&135<r?(k[M]=W*L/2+T*J,k[H?"b":"t"]=W*J/2+T*L,k[H?"t":"b"]=W*J/2):90>r||180<r&&270>r?(k[M]=W*L+T*J,k[H?"t":"b"]=W*J+T*L):(k[M]=W*L+T*J,k[H?"b":"t"]=W*J+T*L)}else switch(M=H?"b":"t",r){case 0:case 180:k[M]="center"===A?0:W;k.l=k.r=T/2;break;case 90:case 270:k[M]=T;k.l=k.r=W/2;break;default:45<=r&&90>=r||225<=r&&270>=r?(k[M]=W*J/2+T*L,k[H?"r":"l"]=W*L/2+T*J,k[H?"l":"r"]=W*L/2):90<=r&&135>=r||270<=r&&315>=r?(k[M]=W*J/2+T*L,k[H?"l":
"r"]=W*L/2+T*J,k[H?"r":"l"]=W*L/2):45>r||180<r&&225>r?(k[M]=W*J+T*L,k[H?"r":"l"]=W*L+T*J):(k[M]=W*J+T*L,k[H?"l":"r"]=W*L+T*J)}k[M]="center"===A?0:k[M]+(E+Math.max(0<q.length?q.length:0,0<B.length?B.length:0)+(n.title?t+p:0))}return k},cleanGroup:function(k){this.opt.enableCache&&this.group&&(this._lineFreePool=this._lineFreePool.concat(this._lineUsePool),this._lineUsePool=[],this._textFreePool=this._textFreePool.concat(this._textUsePool),this._textUsePool=[]);this.inherited(arguments)},createText:function(k,
n,p,E,t,q,B,r,A){if(!this.opt.enableCache||"html"==k)return a.createText[k](this.chart,n,p,E,t,q,B,r,A);0<this._textFreePool.length?(k=this._textFreePool.pop(),k.setShape({x:p,y:E,text:q,align:t}),n.add(k)):k=a.createText[k](this.chart,n,p,E,t,q,B,r);this._textUsePool.push(k);return k},createLine:function(k,n){if(this.opt.enableCache&&0<this._lineFreePool.length){var p=this._lineFreePool.pop();p.setShape(n);k.add(p)}else p=k.createLine(n);this.opt.enableCache&&this._lineUsePool.push(p);return p},
render:function(k,n){var p,E=this._isRtl();if(!this.dirty||!this.scaler)return this;var t=this.opt;var q=this.chart.theme.axis;var B=t.position,r="rightOrTop"!==B,A=t.rotation%360,H=0;H=this.chart.theme.axis.tick.labelGap;var J=t.font||q.majorTick&&q.majorTick.font||q.tick&&q.tick.font,L=t.titleFont||q.title&&q.title.font,M=t.fontColor||q.majorTick&&q.majorTick.fontColor||q.tick&&q.tick.fontColor||"black",T=t.titleFontColor||q.title&&q.title.fontColor||"black";var W=0==t.titleGap?0:t.titleGap||q.title&&
q.title.gap||15;var C=t.titleOrientation||q.title&&q.title.orientation||"axis",I=this.chart.theme.getTick("major",t),O=this.chart.theme.getTick("minor",t),S=this.chart.theme.getTick("micro",t),Q="stroke"in t?t.stroke:q.stroke,N=J?b.normalizedLength(b.splitFontString(J).size):0;var ba=Math.abs(Math.cos(A*Math.PI/180));var V=Math.abs(Math.sin(A*Math.PI/180));var ha=L?b.normalizedLength(b.splitFontString(L).size):0;"number"!=typeof H&&(H=4);0>A&&(A+=360);var ka=this._getMaxLabelSize();ka=ka&&ka.majLabelW;
if(this.vertical){var ma=k.height-n.b;var ea=void 0;var da=n.t;var ia=void 0;q=(k.height-n.b+n.t)/2;var oa=void 0;V=N*V+(ka||0)*ba+H+Math.max(0<I.length?I.length:0,0<O.length?O.length:0)+ha+W;var qa=0;var z=-1;var F=p=0;W=1;ba=0;var R=H;var X=0;switch(A){case 0:var c="end";F=.4*N;break;case 90:c="middle";p=-N;break;case 180:c="start";F=.4*-N;break;case 270:c="middle";break;default:45>A?(c="end",F=.4*N):90>A?(c="end",F=.4*N):135>A?c="start":225>A?(c="start",F=.4*-N):270>A?(c="start",p=r?0:.4*N):315>
A?(c="end",p=r?0:.4*N):(c="end",F=.4*N)}if(r)ea=ia="center"===B?k.width/2:n.l,H=C&&"away"==C?90:270,oa=n.l-V+(270==H?ha:0),W=-1,R=-R;else switch(ea=ia=k.width-n.r,H=C&&"axis"==C?90:270,oa=k.width-n.r+V-(270==H?0:ha),c){case "start":c="end";break;case "end":c="start";break;case "middle":p+=N}}else{ea=n.l;ma=void 0;ia=k.width-n.r;da=void 0;oa=(k.width-n.r+n.l)/2;q=void 0;V=N*ba+(ka||0)*V+H+Math.max(0<I.length?I.length:0,0<O.length?O.length:0)+ha+W;qa=E?-1:1;W=F=p=z=0;ba=1;R=0;X=H;switch(A){case 0:c=
"middle";F=N;break;case 90:c="start";p=.4*-N;break;case 180:c="middle";break;case 270:c="end";p=.4*N;break;default:45>A?(c="start",F=r?N:0):135>A?(c="start",p=.4*-N):180>A?(c="start",F=r?0:-N):225>A?(c="end",F=r?0:-N):315>A?(c="end",F=r?.4*N:0):(c="end",F=r?N:0)}if(r)ma=da="center"===B?k.height/2:k.height-n.b,H=C&&"axis"==C?180:0,q=k.height-n.b+V-(H?ha:0);else switch(ma=da=n.t,H=C&&"away"==C?180:0,q=n.t-V+(H?0:ha),ba=-1,X=-X,c){case "start":c="end";break;case "end":c="start";break;case "middle":F-=
N}}this.cleanGroup();var u=this.group;k=this.scaler;n=this.ticks;var v=g.getTransformerFromModel(this.scaler),w=t.title&&H||A||!this.opt.htmlLabels||m("ie")||m("opera")?"gfx":"html",D=W*I.length,P=ba*I.length,Y=this._skipInterval;u.createLine({x1:ea,y1:ma,x2:ia,y2:da}).setStroke(Q);t.title&&(L=a.createText[w](this.chart,u,oa,q,"middle",t.title,L,T),"html"==w?this.htmlElements.push(L):L.setTransform(b.matrix.rotategAt(H,oa,q)));if(null==n)return this.dirty=!1,this;var aa=0<n.major.length?(n.major[0].value-
this._majorStart)/k.major.tick:0,Z=this.opt.majorLabels;K.forEach(n.major,function(ca,U){var fa=v(ca.value),la=(E?ia:ea)+qa*fa;fa=ma+z*fa;U+=aa;this.createLine(u,{x1:la,y1:fa,x2:la+D,y2:fa+P}).setStroke(I);if(ca.label&&(!Y||0==(U-(1+Y))%(1+Y))){var ja=t.maxLabelCharCount?this.getTextWithLimitCharCount(ca.label,J,t.maxLabelCharCount):{text:ca.label,truncated:!1};ja=t.maxLabelSize?this.getTextWithLimitLength(ja.text,J,t.maxLabelSize,ja.truncated):ja;U=this.createText(w,u,la+(0<I.length?D:0)+R+(A?0:
p),fa+(0<I.length?P:0)+X+(A?0:F),c,ja.text,J,M);ja.truncated&&this.chart.formatTruncatedLabel(U,ca.label,w);ja.truncated&&this.labelTooltip(U,this.chart,ca.label,ja.text,J,w);"html"==w?this.htmlElements.push(U):A&&U.setTransform([{dx:p,dy:F},b.matrix.rotategAt(A,la+(0<I.length?D:0)+R,fa+(0<I.length?P:0)+X)])}},this);D=W*O.length;P=ba*O.length;Z=this.opt.minorLabels&&k.minMinorStep<=k.minor.tick*k.bounds.scale;K.forEach(n.minor,function(ca){var U=v(ca.value),fa=(E?ia:ea)+qa*U,la=ma+z*U;this.createLine(u,
{x1:fa,y1:la,x2:fa+D,y2:la+P}).setStroke(O);if(Z&&ca.label){var ja=t.maxLabelCharCount?this.getTextWithLimitCharCount(ca.label,J,t.maxLabelCharCount):{text:ca.label,truncated:!1};ja=t.maxLabelSize?this.getTextWithLimitLength(ja.text,J,t.maxLabelSize,ja.truncated):ja;U=this.createText(w,u,fa+(0<O.length?D:0)+R+(A?0:p),la+(0<O.length?P:0)+X+(A?0:F),c,ja.text,J,M);ja.truncated&&this.chart.formatTruncatedLabel(U,ca.label,w);ja.truncated&&this.labelTooltip(U,this.chart,ca.label,ja.text,J,w);"html"==w?
this.htmlElements.push(U):A&&U.setTransform([{dx:p,dy:F},b.matrix.rotategAt(A,fa+(0<O.length?D:0)+R,la+(0<O.length?P:0)+X)])}},this);D=W*S.length;P=ba*S.length;K.forEach(n.micro,function(ca){var U=v(ca.value);ca=ea+qa*U;U=ma+z*U;this.createLine(u,{x1:ca,y1:U,x2:ca+D,y2:U+P}).setStroke(S)},this);this.dirty=!1;return this},labelTooltip:function(k,n,p,E,t,q){var B=["dijit/Tooltip"],r={type:"rect"},A=["above","below"];E=b._base._getTextBox(E,{font:t}).w||0;t=t?b.normalizedLength(b.splitFontString(t).size):
0;"html"==q?(G.mixin(r,h.position(k.firstChild,!0)),r.width=Math.ceil(E),r.height=Math.ceil(t),this._events.push({shape:dojo,handle:x.connect(k.firstChild,"onmouseover",this,function(H){require(B,function(J){J.show(p,r,A)})})}),this._events.push({shape:dojo,handle:x.connect(k.firstChild,"onmouseout",this,function(H){require(B,function(J){J.hide(r)})})})):(q=k.getShape(),n=n.getCoords(),r=G.mixin(r,{x:q.x-E/2,y:q.y}),r.x+=n.x,r.y+=n.y,r.x=Math.round(r.x),r.y=Math.round(r.y),r.width=Math.ceil(E),r.height=
Math.ceil(t),this._events.push({shape:k,handle:k.connect("onmouseenter",this,function(H){require(B,function(J){J.show(p,r,A)})})}),this._events.push({shape:k,handle:k.connect("onmouseleave",this,function(H){require(B,function(J){J.hide(r)})})}))},_isRtl:function(){return!1}});return m("dojo-bidi")?y("dojox.charting.axis2d.Default",[l,d]):l})},"dojox/charting/axis2d/Invisible":function(){define(["dojo/_base/lang","dojo/_base/declare","./Base","../scaler/linear","dojox/lang/utils"],function(G,K,m,y,
x){return K("dojox.charting.axis2d.Invisible",m,{defaultParams:{vertical:!1,fixUpper:"none",fixLower:"none",natural:!1,leftBottom:!0,includeZero:!1,fixed:!0},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1},constructor:function(h,l){this.opt=G.clone(this.defaultParams);x.updateWithObject(this.opt,l);x.updateWithPattern(this.opt,l,this.optionalParams)},dependOnData:function(){return!("min"in this.opt)||!("max"in this.opt)},clear:function(){delete this.scaler;
delete this.ticks;this.dirty=!0;return this},initialized:function(){return"scaler"in this&&!(this.dirty&&this.dependOnData())},setWindow:function(h,l){this.scale=h;this.offset=l;return this.clear()},getWindowScale:function(){return"scale"in this?this.scale:1},getWindowOffset:function(){return"offset"in this?this.offset:0},calculate:function(h,l,g,a){if(this.initialized())return this;var b=this.opt;this.labels=b.labels;this.scaler=(a||y).buildScaler(h,l,g,b);var e=this.scaler.bounds;"scale"in this&&
(b.from=e.lower+this.offset,b.to=(e.upper-e.lower)/this.scale+b.from,!isFinite(b.from)||isNaN(b.from)||!isFinite(b.to)||isNaN(b.to)||b.to-b.from>=e.upper-e.lower?(delete b.from,delete b.to,delete this.scale,delete this.offset):(b.from<e.lower?(b.to+=e.lower-b.from,b.from=e.lower):b.to>e.upper&&(b.from+=e.upper-b.to,b.to=e.upper),this.offset=b.from-e.lower),this.scaler=(a||y).buildScaler(h,l,g,b),e=this.scaler.bounds,1==this.scale&&0==this.offset&&(delete this.scale,delete this.offset));return this},
getScaler:function(){return this.scaler},getTicks:function(){return this.ticks}})})},"dojox/charting/axis2d/Base":function(){define(["dojo/_base/declare","../Element"],function(G,K){return G("dojox.charting.axis2d.Base",K,{constructor:function(m,y){this.vertical=y&&y.vertical;this.opt={};this.opt.min=y&&y.min;this.opt.max=y&&y.max},clear:function(){return this},initialized:function(){return!1},calculate:function(m,y,x){return this},getScaler:function(){return null},getTicks:function(){return null},
getOffsets:function(){return{l:0,r:0,t:0,b:0}},render:function(m,y){this.dirty=!1;return this},isNullValue:function(m){return!1},naturalBaseline:0})})},"dojox/charting/scaler/linear":function(){define(["dojo/_base/lang","./common"],function(G,K){function m(l,g){l=l.toLowerCase();for(var a=g.length-1;0<=a;--a)if(l===g[a])return!0;return!1}var y=G.getObject("dojox.charting.scaler.linear",!0),x=K.getNumericLabel,h=function(l,g,a,b,e,f,d){a=G.delegate(a);b||("major"==a.fixUpper&&(a.fixUpper="minor"),
"major"==a.fixLower&&(a.fixLower="minor"));e||("minor"==a.fixUpper&&(a.fixUpper="micro"),"minor"==a.fixLower&&(a.fixLower="micro"));f||("micro"==a.fixUpper&&(a.fixUpper="none"),"micro"==a.fixLower&&(a.fixLower="none"));var k=m(a.fixLower,["major"])?Math.floor(a.min/b)*b:m(a.fixLower,["minor"])?Math.floor(a.min/e)*e:m(a.fixLower,["micro"])?Math.floor(a.min/f)*f:a.min,n=m(a.fixUpper,["major"])?Math.ceil(a.max/b)*b:m(a.fixUpper,["minor"])?Math.ceil(a.max/e)*e:m(a.fixUpper,["micro"])?Math.ceil(a.max/
f)*f:a.max;a.useMin&&(l=k);a.useMax&&(g=n);var p=!b||a.useMin&&m(a.fixLower,["major"])?l:Math.ceil(l/b)*b,E=!e||a.useMin&&m(a.fixLower,["major","minor"])?l:Math.ceil(l/e)*e,t=!f||a.useMin&&m(a.fixLower,["major","minor","micro"])?l:Math.ceil(l/f)*f,q=b?(a.useMax&&m(a.fixUpper,["major"])?Math.round((g-p)/b):Math.floor((g-p)/b))+1:0,B=e?(a.useMax&&m(a.fixUpper,["major","minor"])?Math.round((g-E)/e):Math.floor((g-E)/e))+1:0;a=f?(a.useMax&&m(a.fixUpper,["major","minor","micro"])?Math.round((g-t)/f):Math.floor((g-
t)/f))+1:0;var r=e?Math.round(b/e):0,A=f?Math.round(e/f):0,H=b?Math.floor(Math.log(b)/Math.LN10):0,J=e?Math.floor(Math.log(e)/Math.LN10):0,L=d/(g-l);isFinite(L)||(L=1);return{bounds:{lower:k,upper:n,from:l,to:g,scale:L,span:d},major:{tick:b,start:p,count:q,prec:H},minor:{tick:e,start:E,count:B,prec:J},micro:{tick:f,start:t,count:a,prec:0},minorPerMajor:r,microPerMinor:A,scaler:y}};return G.mixin(y,{buildScaler:function(l,g,a,b,e,f){var d={fixUpper:"none",fixLower:"none",natural:!1};b&&("fixUpper"in
b&&(d.fixUpper=String(b.fixUpper)),"fixLower"in b&&(d.fixLower=String(b.fixLower)),"natural"in b&&(d.natural=!!b.natural));f=!f||3>f?3:f;"min"in b&&(l=b.min);"max"in b&&(g=b.max);b.includeZero&&(0<l&&(l=0),0>g&&(g=0));d.min=l;d.useMin=!0;d.max=g;d.useMax=!0;"from"in b&&(l=b.from,d.useMin=!1);"to"in b&&(g=b.to,d.useMax=!1);if(g<=l)return h(l,g,d,0,0,0,a);e||(e=g-l);e=Math.floor(Math.log(e)/Math.LN10);e=b&&"majorTickStep"in b?b.majorTickStep:Math.pow(10,e);var k=0,n=0;if(b&&"minorTickStep"in b)k=b.minorTickStep;
else{do{k=e/10;if(!d.natural||.9<k){var p=h(l,g,d,e,k,0,a);if(p.bounds.scale*p.minor.tick>f)break}k=e/5;if(!d.natural||.9<k)if(p=h(l,g,d,e,k,0,a),p.bounds.scale*p.minor.tick>f)break;k=e/2;if(!d.natural||.9<k)if(p=h(l,g,d,e,k,0,a),p.bounds.scale*p.minor.tick>f)break;return h(l,g,d,e,0,0,a)}while(0)}if(b&&"microTickStep"in b)n=b.microTickStep,p=h(l,g,d,e,k,n,a);else{do{n=k/10;if(!d.natural||.9<n)if(p=h(l,g,d,e,k,n,a),3<p.bounds.scale*p.micro.tick)break;n=k/5;if(!d.natural||.9<n)if(p=h(l,g,d,e,k,n,a),
3<p.bounds.scale*p.micro.tick)break;n=k/2;if(!d.natural||.9<n)if(p=h(l,g,d,e,k,n,a),3<p.bounds.scale*p.micro.tick)break;n=0}while(0)}return n?p:h(l,g,d,e,k,0,a)},buildTicks:function(l,g){var a=l.major.start,b=l.minor.start,e=l.micro.start;if(g.microTicks&&l.micro.tick){var f=l.micro.tick;var d=e}else if(g.minorTicks&&l.minor.tick)f=l.minor.tick,d=b;else if(l.major.tick)f=l.major.tick,d=a;else return null;var k=1/l.bounds.scale;if(l.bounds.to<=l.bounds.from||isNaN(k)||!isFinite(k)||0>=f||isNaN(f)||
!isFinite(f))return null;for(var n=[],p=[],E=[];d<=l.bounds.to+k;){if(Math.abs(a-d)<f/2){var t={value:a};g.majorLabels&&(t.label=x(a,l.major.prec,g));n.push(t);a+=l.major.tick;b+=l.minor.tick}else Math.abs(b-d)<f/2?(g.minorTicks&&(t={value:b},g.minorLabels&&l.minMinorStep<=l.minor.tick*l.bounds.scale&&(t.label=x(b,l.minor.prec,g)),p.push(t)),b+=l.minor.tick):g.microTicks&&E.push({value:e});e+=l.micro.tick;d+=f}return{major:n,minor:p,micro:E}},getTransformerFromModel:function(l){var g=l.bounds.from,
a=l.bounds.scale;return function(b){return(b-g)*a}},getTransformerFromPlot:function(l){var g=l.bounds.from,a=l.bounds.scale;return function(b){return b/a+g}}})})},"dojox/charting/plot2d/Lines":function(){define(["dojo/_base/declare","./Default"],function(G,K){return G("dojox.charting.plot2d.Lines",K,{constructor:function(){this.opt.lines=!0}})})},"dojox/charting/plot2d/Default":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/utils dojox/gfx/fx".split(" "),
function(G,K,m,y,x,h,l,g,a,b){return K("dojox.charting.plot2d.Default",[x,h],{defaultParams:{lines:!0,areas:!1,markers:!1,tension:"",animate:!1,enableCache:!1,interpolate:!1},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",marker:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:"",zeroLine:0},constructor:function(e,f){this.opt=G.clone(G.mixin(this.opt,this.defaultParams));a.updateWithObject(this.opt,
f);a.updateWithPattern(this.opt,f,this.optionalParams);this.animate=this.opt.animate},createPath:function(e,f,d){if(this.opt.enableCache&&0<e._pathFreePool.length){var k=e._pathFreePool.pop();k.setShape(d);f.add(k)}else k=f.createPath(d);this.opt.enableCache&&e._pathUsePool.push(k);return k},buildSegments:function(e,f){e=this.series[e];for(var d=f?Math.min(e.data.length,Math.ceil(this._hScaler.bounds.to)):e.data.length,k=null,n=[],p=f?Math.max(0,Math.floor(this._hScaler.bounds.from-1)):0;p<d;p++)if(!this.isNullValue(e.data[p]))k||
(k=[],n.push({index:p,rseg:k})),k.push(f&&e.data[p].hasOwnProperty("y")?e.data[p].y:e.data[p]);else if(!this.opt.interpolate||f)k=null;return n},render:function(e,f){if(this.zoom&&!this.isDataDirty())return this.performZoom(e,f);this.resetEvents();this.dirty=this.isDirty();if(this.dirty){m.forEach(this.series,l.purgeGroup);this._eventSeries={};this.cleanGroup();this.getGroup().setTransform(null);var d=this.getGroup();g.forEachRev(this.series,function(da){da.cleanGroup(d)})}for(var k=this.chart.theme,
n,p,E=this.events(),t=0;t<this.series.length;t++){var q=this.series[t];if(this.dirty||q.dirty)if(q.cleanGroup(),this.opt.enableCache&&(q._pathFreePool=(q._pathFreePool?q._pathFreePool:[]).concat(q._pathUsePool?q._pathUsePool:[]),q._pathUsePool=[]),q.data.length){var B=k.next(this.opt.areas?"area":"line",[this.opt,q],!0),r=this._hScaler.scaler.getTransformerFromModel(this._hScaler),A=this._vScaler.scaler.getTransformerFromModel(this._vScaler),H=this._eventSeries[q.name]=Array(q.data.length);d=q.group;
if(q.hidden){this.opt.lines&&(q.dyn.stroke=B.series.stroke);if(q.markers||void 0===q.markers&&this.opt.markers)q.dyn.markerFill=B.marker.fill,q.dyn.markerStroke=B.marker.stroke,q.dyn.marker=B.symbol;this.opt.areas&&(q.dyn.fill=B.series.fill)}else{for(var J=m.some(q.data,function(da){return"number"==typeof da||da&&!da.hasOwnProperty("x")}),L=this.buildSegments(t,J),M=0;M<L.length;M++){var T=L[M];var W=J?m.map(T.rseg,function(da,ia){return{x:r(ia+T.index+1)+f.l,y:e.height-f.b-A(da),data:da}},this):
m.map(T.rseg,function(da){return{x:r(da.x)+f.l,y:e.height-f.b-A(da.y),data:da}},this);if(J&&this.opt.interpolate)for(;M<L.length;)M++,(T=L[M])&&(W=W.concat(m.map(T.rseg,function(da,ia){return{x:r(ia+T.index+1)+f.l,y:e.height-f.b-A(da),data:da}},this)));var C=this.opt.tension?l.curve(W,this.opt.tension):"";if(this.opt.areas&&1<W.length){var I=this._plotFill(B.series.fill,e,f),O=G.clone(W),S=e.height-f.b;isNaN(this.opt.zeroLine)||(S=Math.max(f.t,Math.min(e.height-f.b-A(this.opt.zeroLine),S)));this.opt.tension?
q.dyn.fill=d.createPath(C+" L"+(O[O.length-1].x+","+S+" L"+O[0].x+","+S+" L"+O[0].x+","+O[0].y)).setFill(I).getFill():(O.push({x:W[W.length-1].x,y:S}),O.push({x:W[0].x,y:S}),O.push(W[0]),q.dyn.fill=d.createPolyline(O).setFill(I).getFill())}if(this.opt.lines||this.opt.markers)n=B.series.stroke,B.series.outline&&(p=q.dyn.outline=l.makeStroke(B.series.outline),p.width=2*p.width+(n&&n.width||0));this.opt.markers&&(q.dyn.marker=B.symbol);var Q=null,N=null,ba=null;if(n&&B.series.shadow&&1<W.length){var V=
B.series.shadow;I=m.map(W,function(da){return{x:da.x+V.dx,y:da.y+V.dy}});this.opt.lines&&(q.dyn.shadow=this.opt.tension?d.createPath(l.curve(I,this.opt.tension)).setStroke(V).getStroke():d.createPolyline(I).setStroke(V).getStroke());this.opt.markers&&B.marker.shadow&&(V=B.marker.shadow,ba=m.map(I,function(da){return this.createPath(q,d,"M"+da.x+" "+da.y+" "+B.symbol).setStroke(V).setFill(V.color)},this))}if(this.opt.lines&&1<W.length){var ha;p&&(q.dyn.outline=this.opt.tension?d.createPath(C).setStroke(p).getStroke():
d.createPolyline(W).setStroke(p).getStroke());q.dyn.stroke=this.opt.tension?(ha=d.createPath(C)).setStroke(n).getStroke():(ha=d.createPolyline(W)).setStroke(n).getStroke();ha.setFilter&&B.series.filter&&ha.setFilter(B.series.filter)}C=null;if(this.opt.markers){var ka=B;Q=Array(W.length);N=Array(W.length);p=null;ka.marker.outline&&(p=l.makeStroke(ka.marker.outline),p.width=2*p.width+(ka.marker.stroke?ka.marker.stroke.width:0));m.forEach(W,function(da,ia){if(this.opt.styleFunc||"number"!=typeof da.data){var oa=
"number"!=typeof da.data?[da.data]:[];this.opt.styleFunc&&oa.push(this.opt.styleFunc(da.data));ka=k.addMixin(B,"marker",oa,!0)}else ka=k.post(B,"marker");da="M"+da.x+" "+da.y+" "+ka.symbol;p&&(N[ia]=this.createPath(q,d,da).setStroke(p));Q[ia]=this.createPath(q,d,da).setStroke(ka.marker.stroke).setFill(ka.marker.fill)},this);q.dyn.markerFill=ka.marker.fill;q.dyn.markerStroke=ka.marker.stroke;!C&&this.opt.labels&&(C=Q[0].getBoundingBox());E?m.forEach(Q,function(da,ia){da={element:"marker",index:ia+
T.index,run:q,shape:da,outline:N[ia]||null,shadow:ba&&ba[ia]||null,cx:W[ia].x,cy:W[ia].y};J?(da.x=ia+T.index+1,da.y=q.data[ia+T.index]):(da.x=T.rseg[ia].x,da.y=q.data[ia+T.index].y);this._connectEvents(da);H[ia+T.index]=da},this):delete this._eventSeries[q.name]}if(this.opt.labels){var ma=C?C.width:2,ea=C?C.height:2;m.forEach(W,function(da,ia){if(this.opt.styleFunc||"number"!=typeof da.data){var oa="number"!=typeof da.data?[da.data]:[];this.opt.styleFunc&&oa.push(this.opt.styleFunc(da.data));ka=k.addMixin(B,
"marker",oa,!0)}else ka=k.post(B,"marker");this.createLabel(d,T.rseg[ia],{x:da.x-ma/2,y:da.y-ea/2,width:ma,height:ea},ka)},this)}}q.dirty=!1}}else q.dirty=!1,k.skip();else k.skip(),this._reconnectEvents(q.name)}y("dojo-bidi")&&this._checkOrientation(this.group,e,f);this.animate&&(n=this.getGroup(),b.animateTransform(G.delegate({shape:n,duration:1200,transform:[{name:"translate",start:[0,e.height-f.b],end:[0,0]},{name:"scale",start:[1,0],end:[1,1]},{name:"original"}]},this.animate)).play());this.dirty=
!1;return this}})})},"widgets/RelatedTableCharts/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/RelatedTableCharts/ChartLayout.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"esriCTLayoutContent" tabindex\x3d"0" aria-labelledby\x3d"${id}title ${id}description"\x3e\r\n        \x3cdiv class\x3d"esriCTLabels"\x3e\r\n            \x3c!-- chart title --\x3e\r\n            \x3cdiv class\x3d"esriCTLayoutHeaderTitle" data-dojo-attach-point\x3d"layoutHeaderTitle" id\x3d"${id}title"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTChartContainer" data-dojo-attach-point\x3d"chartContainer"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTLegendContainer" data-dojo-attach-point\x3d"legendContainer"\x3e\r\n            \x3cdiv class\x3d"esriCTLegendNode" data-dojo-attach-point\x3d"legendNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- chart description --\x3e\r\n        \x3cdiv class\x3d"esriCTChartDescription" data-dojo-attach-point\x3d"chartDescription" id\x3d"${id}description"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/RelatedTableCharts/Widget.html":'\x3cdiv class\x3d"esriCTMainContainer esriCTFullHeight" data-dojo-attach-point\x3d"mainNode"\x3e\r\n    \x3cdiv class\x3d"esriCTFullHeight" data-dojo-attach-point\x3d"widgetMainNode"\x3e\r\n        \x3c!-- search panel --\x3e\r\n        \x3cdiv class\x3d"esriCTSearchOuterContainer"\x3e\r\n            \x3cdiv class\x3d"esriCTSearchHeader"\x3e\r\n                ${nls.searchHeaderText}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTSearchContainer"\x3e\r\n                \x3cdiv class\x3d"esriCTSearchDiv"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"searchDiv"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTSelectLocationDiv esriCTImgButtons esriCTSelectLocation esriCTHidden"\r\n                    data-dojo-attach-point\x3d"selectLocation" role\x3d"button" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.locationButtonAriaLabel}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- result panel --\x3e\r\n        \x3cdiv class\x3d"esriCTResultsPanel" data-dojo-attach-point\x3d"resultsPanel"\x3e\r\n            \x3cdiv class\x3d"esriCTResultContent"\x3e\r\n                \x3cdiv class\x3d"esriCTErrorNode esriCTHidden" data-dojo-attach-point\x3d"errorNode" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.errMsgNoResultsFound}"\x3e\r\n                    ${nls.errMsgNoResultsFound}\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"accordionContainer" class\x3d"esriCTHidden esriCTAccordionContainer"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/RelatedTableCharts/css/style.css":'.jimu-widget-RelatedTableCharts-layout .esriCTLabels {width: 100%; clear: both;}.jimu-widget-RelatedTableCharts-layout .esriCTLayoutHeaderTitle {font-weight: bold; text-align: center; margin: 5px 10px 0 10px; overflow-wrap: break-word;}.jimu-widget-RelatedTableCharts-layout .esriCTLayoutContent {width: calc(100% - 140px); border: 1px solid #d2dae2; margin: 20px auto;}.jimu-widget-RelatedTableCharts-layout .esriCTChartContainer {margin: 10px 50px; display: inline-block; direction: ltr;}.jimu-widget-RelatedTableCharts-layout .esriCTChartDescription {margin: 0 10px 10px 10px; word-break: break-word;}.jimu-widget-RelatedTableCharts-layout .esriCTLegendContainer {width: 100%; overflow-x: auto; margin-bottom: 10px; display: inline-block;}.jimu-widget-RelatedTableCharts-layout .esriCTLegendContainer .dijitCheckBox {margin: 1px;}.jimu-widget-RelatedTableCharts-layout .dojoxLegendNode td {padding: 6px 4px 6px 6px;}.jimu-widget-RelatedTableCharts-layout .dojoxLegendNode tr {display: table-cell;}.jimu-widget-RelatedTableCharts-layout .dojoxLegendNode {border-top: 1px solid #DDDDDD; margin: 0; padding: 0; width: 100%; white-space: nowrap;}.esriCTMainContainer {min-width: 222px; height: 100%; -webkit-overflow-scrolling: touch; overflow: hidden;}.esriCTResultsPanel {margin: 10px 0px; border-top: 1px solid #161616; overflow-y: auto; overflow-x: hidden; height: calc(100% - 65px);}.esriCTResultContent {margin: 10px 5px; width: calc(100% - 10px);}.esriCTOverridePanelStyle {padding: 14px 0px !important;}.jimu-widget-RelatedTableCharts .esriCTAccordionContainer {width: 100%; border: 1px solid #DDDDDD;}.jimu-widget-RelatedTableCharts .esriCTHidden {display: none;}.jimu-widget-RelatedTableCharts .esriCTWidgetErrorNode {color: Red;}.jimu-widget-RelatedTableCharts .esriCTFullHeight {height: 100%;}.jimu-widget-RelatedTableCharts .esriCTChartRow {background-color: #FCFCFC; position: relative; border-bottom: 1px solid #DDDDDD; color: black; cursor: pointer;}.jimu-widget-RelatedTableCharts .esriCTChartTitle {line-height: 40px; padding-left: 10px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; font-size: 14px; color: #3e3e3e;}.jimu-widget-RelatedTableCharts .esriCTChartContent {background-color: #FFF;}.jimu-widget-RelatedTableCharts .esriCTChartSelected {font-weight: bold; background-color: #DDDDDD;}.jimu-widget-RelatedTableCharts .esriCTChartHighlighted {padding-left: 5px; font-weight: bold;}.jimu-widget-RelatedTableCharts .esriCTSelectedChartBorder {border-left: 5px solid;}.jimu-widget-RelatedTableCharts .esriCTSearchOuterContainer {width: calc(100% - 40px); margin: 0 auto;}.jimu-widget-RelatedTableCharts .esriCTSearchHeader {padding: 3px 0px 7px 0px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #000000;}.jimu-widget-RelatedTableCharts .esriCTImgButtons {cursor: pointer; width: 32px; height: 34px; border: 1px solid #57585A; border-radius: 4px; background-size: 20px; background-position: center center; background-repeat: no-repeat;}.jimu-widget-RelatedTableCharts .esriCTOrDiv {float: left; line-height: 30px; margin-left: 10px;}.jimu-widget-RelatedTableCharts .esriCTSearchDiv {float: left;}.jimu-widget-RelatedTableCharts .esriCTSearchDiv .arcgisSearch {float: left; width: 100% !important;}.esriRtl .jimu-widget-RelatedTableCharts .esriCTSearchDiv {float: right;}.jimu-widget-RelatedTableCharts .esriCTSearchContainer {width: 100%; height: 35px;}.jimu-widget-RelatedTableCharts .arcgisSearch .searchGroup .searchInput {width: 170px;}.jimu-widget-RelatedTableCharts .arcgisSearch .searchBtn {padding: 6px;}.jimu-widget-search .arcgisSearch .searchGroup .searchInputGroup .searchInput {width: auto;}.jimu-widget-RelatedTableCharts .esriCTSelectLocationDiv {margin: 0px 0px 0px 10px; float: right;}.esriRtl .jimu-widget-RelatedTableCharts .esriCTSelectLocationDiv {margin: 0px 0px 10px 0px; float: left;}.jimu-widget-RelatedTableCharts .esriCTSelectLocation {background-image: url("../images/select-location.png");}.jimu-widget-RelatedTableCharts .esriCTSelectLocationActive {background-image: url("../images/select-location-active.png"); background-color: #57585A;}.jimu-widget-RelatedTableCharts .esriCTImgButtons {cursor: pointer; width: 32px; height: 34px; border: 1px solid #57585A; border-radius: 4px; background-size: 20px; background-position: center center; background-repeat: no-repeat;}.jimu-widget-RelatedTableCharts-layout .esriCTLayoutContent {width: 100%; background-color: #FFF; margin: 0px; border: none;}.jimu-widget-RelatedTableCharts-layout .esriCTChartContainer {width: calc(100% - 2px); margin: 5px 1px;}.esriCTDisabledRow {cursor: not-allowed !important; color: #838383 !important;}.esriRtl .jimu-widget-RelatedTableCharts .esriCTSelectedChartBorder {border-right: 5px solid; border-left: 0px;}.esriRtl .jimu-widget-RelatedTableCharts .esriCTChartTitle {padding-right: 10px;}.esriCTMapTooltip {width: 100px; word-wrap: break-word; border: 1px solid #7EABCD; background-color: white; padding: 5px; font-size: 9pt; z-index: 9999; -o-border-radius: 4px; -moz-border-radius: 4px; -webkit-border-radius: 4px; border-radius: 4px;}.esriCTErrorNode:focus {outline: 2px solid #24B5CC !important;}',
"*now":function(G){G(['dojo/i18n!*preload*widgets/RelatedTableCharts/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget dojo/on dojo/_base/lang dojo/_base/array ./Search jimu/portalUtils dojo/query dojo/dom-class dojo/dom-attr dojo/dom-style dojo/dom-construct esri/graphic esri/symbols/jsonUtils esri/layers/GraphicsLayer esri/geometry/webMercatorUtils esri/tasks/locator esri/InfoTemplate esri/tasks/query dojo/dom-geometry esri/tasks/RelationshipQuery dojo/Deferred dojo/promise/all esri/layers/FeatureLayer ./Accordion esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleMarkerSymbol esri/geometry/Point esri/geometry/Polyline esri/geometry/Polygon esri/SpatialReference esri/Color esri/geometry/Extent esri/geometry/scaleUtils jimu/dijit/LoadingIndicator esri/request esri/renderers/jsonUtils jimu/LayerInfos/LayerInfos jimu/utils dijit/focus dojo/keys dijit/registry dojo/_base/event".split(" "),function(G,
K,m,y,x,h,l,g,a,b,e,f,d,k,n,p,E,t,q,B,r,A,H,J,L,M,T,W,C,I,O,S,Q,N,ba,V,ha,ka,ma,ea,da,ia,oa,qa){return G([K],{baseClass:"jimu-widget-RelatedTableCharts",_loading:null,_mapTooltip:null,_highlightGraphicsLayer:null,_locatorInstance:null,_selectedLocation:null,_operationalLayers:[],_autoRefreshInterval:null,_refreshElapsedTime:null,_layerInfosObj:null,_searchInstance:null,_hasMulitpleSourcesInSearch:!0,_setFocusOnFirstNode:!1,openPanels:[],_prevFeature:null,_isSearchResultSelected:null,_isMapClicked:null,
postCreate:function(){this.inherited(arguments);this.openAtStartAysn=!0;this._selectedLocation=this._locatorInstance=this._highlightGraphicsLayer=this._mapTooltip=this._loading=null;this._operationalLayers=[];this._searchInstance=this._layerInfosObj=this._refreshElapsedTime=this._autoRefreshInterval=null;this._hasMulitpleSourcesInSearch=!0;this._setFocusOnFirstNode=!1;this.openPanels=[];this._isMapClicked=this._isSearchResultSelected=this._prevFeature=null;ma.getInstance(this.map,this.map.itemInfo).then(y.hitch(this,
function(z){this._layerInfosObj=z;this._getSelectedThemeColor();this._updateConfig();this._loadFeatureLayers();this._operationalLayers.length||(a.add(this.accordionContainer,"esriCTHidden"),a.remove(this.errorNode,"esriCTHidden"),b.set(this.errorNode,"innerHTML",this.nls.noChatsConfigured),b.set(this.errorNode,"aria-label",this.nls.noChatsConfigured),this._createWidgetAccessible());this._initWidgetComponents()}))},startup:function(){this.inherited(arguments);a.add(this.domNode.parentElement,"esriCTOverridePanelStyle");
this._removeDartThemeCss();this.config.generalSettings.showLocationTool?a.remove(this.selectLocation,"esriCTHidden"):this._mapClickHandler||this._connectMapEventHandler()},onOpen:function(){this._setFocusOnFirstNode=!0;this._onWindowResize();this._autoRefresh();this.config.generalSettings.showLocationTool||this._connectMapEventHandler()},resize:function(){this._onWindowResize()},onDeActive:function(){this.config.generalSettings.showLocationTool&&this._disconnectMapEventHandler()},onClose:function(){this._disconnectMapEventHandler();
this._searchInstance&&this._searchInstance.clearSearchText();this._clearResults();this._autoRefreshInterval&&clearInterval(this._autoRefreshInterval)},_initWidgetComponents:function(){this.config.response=this.map.webMapResponse;this._initLoading();this.appConfig.portalUrl&&""!==y.trim(this.appConfig.portalUrl)&&(l.getPortalSelfInfo(this.appConfig.portalUrl).then(y.hitch(this,function(z){this.config.helperServices=z.helperServices;this._createSearchInstance()}),y.hitch(this,function(){this._createSearchInstance()})),
this.config.generalSettings.showLocationTool&&this._connectSelectLocationHandler());this._highlightGraphicsLayer=new n;this.map.addLayer(this._highlightGraphicsLayer);this._mapTooltip=f.create("div",{"class":"esriCTMapTooltip",innerHTML:this.nls.mouseOverTooltip},this.map.container);e.set(this._mapTooltip,"position","fixed");e.set(this._mapTooltip,"display","none");m(window,"resize",y.hitch(this,this._onWindowResize))},_initLoading:function(){this._loading=new V({hidden:!0});this._loading.placeAt(this.domNode);
this._loading.startup()},_createSearchInstance:function(){this._searchInstance=new h({searchOptions:{addLayersFromMap:!1,autoNavigate:!1,autoComplete:!0,minCharacters:0,maxLocations:5,searchDelay:100,enableHighlight:!1},config:this.config,appConfig:this.appConfig,map:this.map},f.create("div",{},this.searchDiv));this._searchInstance.on("select-result",y.hitch(this,function(z){this._clearResults();var F=this._getSelectedFeatureFromResult(z);this._prevFeature={feature:F,isFeatureFromMapClick:!1};z&&
z.source&&z.source.zoomScale&&(this._prevFeature.zoomScale=z.source.zoomScale);var R={feature:F,isFeatureFromMapClick:!1};this._selectedLocation=F;this._zoomToFeature().then(y.hitch(this,function(){this._refreshAllFeatureLayers();this._initWorkflow(R)}))}));this._searchInstance.on("clear-search",y.hitch(this,this._clearResults));this._searchInstance.on("search-results",y.hitch(this,this._clearResults));this._searchInstance.on("search-loaded",y.hitch(this,function(){setTimeout(y.hitch(this,function(){this._initReverseGeocoder();
this.searchContainerNodeElement=g(".jimu-widget-RelatedTableCharts .arcgisSearch .searchGroup .searchInput")[0];2>this._searchInstance.search.sources.length&&(this._hasMulitpleSourcesInSearch=!1);window.appInfo.isRunInMobile&&this._searchInstance.search&&this._searchInstance.search.suggestionsNode&&e.set(this._searchInstance.search.suggestionsNode,"height","110px");this._onWindowResize();this.setTheme();this._createWidgetAccessible()}),1E3)}));this._searchInstance.startup();this.own(m(this._searchInstance,
"setFirstFocusNode",y.hitch(this,function(){this._setFocusOnFirstNode=!0;this._setFirstFocusNode()})))},_removeDartThemeCss:function(){var z,F;if((z=g('link[href\x3d"'+this.folderUrl+'/css/DartTheme.css"]'))&&0<z.length)for(F=0;F<z.length;F++)b.get(z[F],"StyleSheetID")===this.baseClass+"-dartThemeStyle"&&z[F].parentNode.removeChild(z[0])},setTheme:function(){if("DartTheme"===this.appConfig.theme.name){var z=g("head")[0];var F=f.create("link");F.rel="stylesheet";F.type="text/css";F.href=this.folderUrl+
"/css/DartTheme.css";F.media="all";b.set(F,"StyleSheetID",this.baseClass+"-dartThemeStyle");z.appendChild(F)}},_connectMapEventHandler:function(){this._mapClickHandler||(this._disableWebMapPopup(),this._mapClickHandler=this.map.on("click",y.hitch(this,this._onMapClick)),"ontouchstart"in document.documentElement?e.set(this._mapTooltip,"display","none"):(this._mapMoveHandler=this.map.on("mouse-move",y.hitch(this,this._onMapMouseMove)),this.map.on("mouse-out",y.hitch(this,function(){e.set(this._mapTooltip,
"display","none")}))),this._extentChangeHandler=this.map.on("extent-change",y.hitch(this,this._onExtentChange)))},_onMapClick:function(z){this._isMapClicked=!0;this._clearResults();var F=this._getSelectedFeatureFromResult(z);this._prevFeature={feature:new d(z.mapPoint),isFeatureFromMapClick:!0};z&&z.source&&z.source.zoomScale&&(this._prevFeature.zoomScale=z.source.zoomScale);this._selectedLocation=F;this._zoomToFeature().then(y.hitch(this,function(){this._refreshAllFeatureLayers();this.config.generalSettings.showLocationTool&&
this._disconnectMapEventHandler();this.map.infoWindow.hide();this._searchInstance&&this._searchInstance.clearSearchText();var R={feature:new d(z.mapPoint),isFeatureFromMapClick:!0};this._initWorkflow(R)}))},_onMapMouseMove:function(z){if(z.clientX||z.pageY){var F=z.clientX;z=z.clientY}else F=z.clientX+document.body.scrollLeft-document.body.clientLeft,z=z.clientY+document.body.scrollTop-document.body.clientTop;e.set(this._mapTooltip,"display","none");e.set(this._mapTooltip,{left:F+15+"px",top:z+"px"});
e.set(this._mapTooltip,"display","")},_onExtentChange:function(){if(this._selectedLocation&&this.map.infoWindow&&this.map.infoWindow.isShowing){var z=this.map.toScreen(this._selectedLocation.geometry);this.map.infoWindow.show(z,this.map.getInfoWindowAnchor(z))}},_disconnectMapEventHandler:function(){this._enableWebMapPopup();a.replace(this.selectLocation,"esriCTSelectLocation","esriCTSelectLocationActive");this._mapClickHandler&&(this._mapClickHandler.remove(),this._mapClickHandler=null);this._mapMoveHandler&&
(this._mapMoveHandler.remove(),this._mapMoveHandler=null,this._mapTooltip.style.display="none");this._extentChangeHandler&&this._extentChangeHandler.remove()},_enableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!0)},_disableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!1)},_onWindowResize:function(){this._windowResizeTimer&&clearTimeout(this._windowResizeTimer);this._windowResizeTimer=setTimeout(y.hitch(this,this._resetComponents),500)},_resetComponents:function(){var z;
var F=g(".jimu-widget-RelatedTableCharts .arcgisSearch .searchGroup")[0];this.searchContainerNodeElement||(this.searchContainerNodeElement=g(".jimu-widget-RelatedTableCharts .arcgisSearch .searchGroup .searchInput")[0]);this.widgetMainNode&&this.searchContainerNodeElement&&(z=B.position(this.widgetMainNode))&&z.w&&(z=z.w-144,this._hasMulitpleSourcesInSearch||(z+=32),0<z&&(this.config.generalSettings.showLocationTool&&(z-=45),this.searchContainerNodeElement.style.setProperty("width",z+"px","important"),
F&&F.style.setProperty("max-width","100%","important")));this.accordionPanel&&this.accordionPanel.resizeContents()},_initReverseGeocoder:function(){var z;this.config.searchSourceSettings&&this.config.searchSourceSettings.sources&&(x.some(this.config.searchSourceSettings.sources,y.hitch(this,function(F){if(F&&F.url&&"locator"===F.type)return z=F.url,!0})),z&&(this._locatorInstance=new E(z),this.own(this._locatorInstance.on("location-to-address-complete",y.hitch(this,this._onLocationToAddressComplete)))))},
_onLocationToAddressComplete:function(z){if(z.address&&z.address.address){if(z.address.address.Match_addr)var F=z.address.address.Match_addr;else{F="";for(var R in z.address.address)"Loc_name"!==R&&z.address.address[R]&&(F+=z.address.address[R]+" ");F=y.trim(F)}this._searchInstance&&this._searchInstance.setSearchText(F);z=new t;z.setContent("${Match_addr}");z.setTitle(this.nls.addressInfowindowTitle);this.map.infoWindow.clearFeatures();this.map.infoWindow.setTitle(this.nls.addressInfowindowTitle);
this.map.infoWindow.setContent(F);F=this.map.toScreen(this._selectedLocation.geometry);this.map.infoWindow.show(F,this.map.getInfoWindowAnchor(F));this.map.infoWindow.isShowing=!0}},_updateConfig:function(){x.forEach(this.config.charts,y.hitch(this,function(z){y.mixin(z.layerDetails.polygonLayerInfo,this._getLayerDetailsFromMap(z.layerDetails.polygonLayerInfo.baseURL,z.layerDetails.polygonLayerInfo.layerId));var F=this._getTableDetailsFromMap(z.layerDetails.relatedLayerInfo.baseURL,z.layerDetails.relatedLayerInfo.layerId);
0===Object.keys(F).length&&(F=this._getLayerDetailsFromMap(z.layerDetails.relatedLayerInfo.baseURL,z.layerDetails.relatedLayerInfo.layerId));y.mixin(z.layerDetails.relatedLayerInfo,F)}))},_loadFeatureLayers:function(){var z;this._operationalLayers=[];this.openPanels=[];for(z=this.config.charts.highlightedChartIndex=0;z<this.config.charts.length;z++)if(this.config.charts[z].layerDetails.polygonLayerInfo.url){var F=new J(this.config.charts[z].layerDetails.polygonLayerInfo.url);F.title=this.config.charts[z].layerDetails.polygonLayerInfo.title;
this.config.charts[z].layerDetails.polygonLayerInfo.definitionExpression&&F.setDefinitionExpression(this.config.charts[z].layerDetails.polygonLayerInfo.definitionExpression);this.config.charts[z].layerDetails.polygonLayerInfo.renderer&&F.setRenderer(ka.fromJson(this.config.charts[z].layerDetails.polygonLayerInfo.renderer));this._operationalLayers.push(F)}},_getSelectedFeatureFromResult:function(z){if(z)if(z.feature)var F=z.feature;else z.result&&z.result.feature&&(F=z.result.feature);return F},_getSelectedGeocoder:function(z){if(z.source&&
z.source.featureLayer)var F=z.source.featureLayer.url;return F},destroy:function(){this._clearResults();this.inherited(arguments)},pointToExtent:function(z,F,R){var X=z.extent.getWidth()/z.width;R*=X;return new N(F.x-R,F.y-R,F.x+R,F.y+R,z.spatialReference)},_updateOpenPanels:function(z){var F;this.openPanels=[];x.forEach(this._operationalLayers,y.hitch(this,function(R,X){z===R.url&&(this.openPanels.push("Chart"+X),F=!0)}));return F},_clearResults:function(){this._highlightGraphicsLayer&&this._highlightGraphicsLayer.clear();
this._selectedLocation=null;this.accordionContainer&&(a.add(this.accordionContainer,"esriCTHidden"),f.empty(this.accordionContainer));this.errorNode.innerHTML.trim()===this.nls.errMsgNoResultsFound&&a.add(this.errorNode,"esriCTHidden");this._clearTimer();this._createWidgetAccessible()},_loadFeatures:function(z){var F=[],R=!1;this._loading.show();x.forEach(this.config.charts,y.hitch(this,function(X,c){var u=new A;this._getIntersectingFeatures(z,c,u).then(y.hitch(this,function(v){X.chartData=v;!R&&
v&&(R=!0);v||(X.selectedFeature=null)}));F.push(u)}));H(F).then(y.hitch(this,y.hitch(this,function(){R?(a.add(this.errorNode,"esriCTHidden"),a.remove(this.accordionContainer,"esriCTHidden"),this._initAccordionPane(),this._resetTimer()):(this.accordionPanel&&(this.accordionPanel.chartArray=[]),a.add(this.accordionContainer,"esriCTHidden"),a.remove(this.errorNode,"esriCTHidden"),this._createWidgetAccessible());this._loading.hide()})))},_initAccordionPane:function(){f.empty(this.accordionContainer);
this.accordionPanel=new L({nls:this.nls,config:this.config,openPanels:this.openPanels,node:this.accordionContainer});m(this.accordionPanel,"chartSelected",y.hitch(this,function(z){this._hideAllChartLayers();this._operationalLayers[z]&&this._showHideChartLayer(this._operationalLayers[z].url,!0);this.config.charts[z].selectedFeature&&("point"===this.config.charts[z].selectedFeature.geometry.type?this._isSearchResultSelected?this._isSearchResultSelected=!1:this._isMapClicked?this._isMapClicked=!1:this.map.centerAndZoom(this.config.charts[z].selectedFeature.geometry,
this.map.getLevel()).then(y.hitch(this,function(){this._refreshAllFeatureLayers()})):this._isSearchResultSelected?this._isSearchResultSelected=!1:this._isMapClicked?this._isMapClicked=!1:this.map.setExtent(this.config.charts[z].selectedFeature.geometry.getExtent().expand(1.5)).then(y.hitch(this,function(){this._refreshAllFeatureLayers()})),this._highlightGraphicsLayer.clear(),this._highlightSelectedLocation(this._selectedLocation,!1),this._highlightSelectedChartFeature(z))}));m(this.accordionPanel,
"setFocusNodes",y.hitch(this,function(){this._createWidgetAccessible()}));this.accordionPanel.initAccordionPane()},_hideAllChartLayers:function(){var z;for(z=0;z<this._operationalLayers.length;z++)this._showHideChartLayer(this._operationalLayers[z].url,!1)},_matchURLS:function(z,F){z&&0!==z.indexOf("https")&&(z=z.replace("http","https"));F&&0!==F.indexOf("https")&&(F=F.replace("http","https"));return z===F},_showHideChartLayer:function(z,F){var R;var X=z.split("/");X=X[X.length-1];for(R in this.map._layers)if(this.map._layers.hasOwnProperty(R))if(this._matchURLS(this.map._layers[R].url,
z))this.map._layers[R].setVisibility(F);else if(this.map._layers[R].visibleLayers){var c=this.map._layers[R].url[this.map._layers[R].url.length-1];c="/"===c?this.map._layers[R].url+X:this.map._layers[R].url+"/"+X;if(this._matchURLS(c,z)){c=this.map._layers[R].visibleLayers;var u=x.indexOf(c,parseInt(X,10));F?-1===u&&c.push(parseInt(X,10)):-1!==u&&c.splice(u,1);this.map._layers[R].setVisibleLayers(c)}}},_getIntersectingFeatures:function(z,F,R){var X;var c=this._operationalLayers[F];this.config.charts[F].selectedFeature=
null;(X="point"===z.geometry.type&&"esriGeometryPoint"===c.geometryType?this._extentFromPoint(z.geometry).centerAt(z.geometry):"polygon"===z.geometry.type?z.geometry.getCentroid():z.geometry)?(z=new q,z.outFields=["*"],z.returnGeometry=!0,z.geometry=X,c.queryFeatures(z,y.hitch(this,function(u){u&&u.features&&0<u.features.length?u.features[0].attributes?(this.config.charts[F].selectedFeature=u.features[0],u=u.features[0].attributes[c.objectIdField],this._getRelatedRecords(R,F,u)):R.resolve():R.resolve()}),
y.hitch(this,function(){R.resolve()}))):R.resolve();return R},_extentFromPoint:function(z){new C(z.x,z.y,this.map.spatialReference);z=20*(this.map.extent.getWidth()/this.map.width);return new N(1,1,z,z,this.map.spatialReference)},_getRelatedRecords:function(z,F,R){var X=!1;var c=this.config.charts[F];var u=new r;u.outFields=["*"];u.objectIds=[R];u.returnGeometry=!1;u.relationshipId=c.layerDetails.relatedLayerInfo.relationShipId;this.config.charts[F].layerDetails.relatedLayerInfo.definitionExpression&&
(u.where=this.config.charts[F].layerDetails.relatedLayerInfo.definitionExpression);"esriCTEmptyOption"!==c.chartConfig.labelField&&(X=x.some(this.config.charts[F].layerDetails.relatedLayerInfo.fields,y.hitch(this,function(v){if(v.name===c.chartConfig.labelField&&"esriFieldTypeDate"===v.type)return!0})));this._operationalLayers[F].queryRelatedFeatures(u,y.hitch(this,function(v){v=(v=v[R])?v.features:[];0<v.length?"PolarChart"!==c.chartConfig.chartType?"LineChart"===c.chartConfig.chartType?this._createLineChartData(c,
v,X,z):this._createChartData(c,v,X,z):this._createPolarChartData(c,v,F,z):z.resolve()}),function(){z.resolve()})},_createChartData:function(z,F,R,X){var c={chartSeries:[],chartLabels:[]};x.forEach(F,y.hitch(this,function(u,v){var w={},D={},P="",Y;var aa=!0;D.y=u.attributes[z.chartConfig.dataSeriesField];D.tooltip=u.attributes[z.chartConfig.dataSeriesField]+"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;";w={value:v+1,y:u.attributes[z.chartConfig.dataSeriesField]};"esriCTEmptyOption"===z.chartConfig.labelField?
P="":(0===u.attributes[z.chartConfig.labelField]?P=0:R?(v=z.layerDetails.relatedLayerInfo.popupInfo.fieldInfos,ea.has("ie")||ea.has("edge")?x.forEach(v,y.hitch(this,function(Z){Z.fieldName===z.chartConfig.labelField&&(Y=Z)})):Y=v.find(function(Z){return Z.fieldName===z.chartConfig.labelField}),v=!1,-1<Y.format.dateFormat.toLowerCase().indexOf("time")&&(v=!0),P=this._getLocaleFormatedDate(u.attributes[z.chartConfig.labelField],v)):P=u.attributes[z.chartConfig.labelField]||"",w.sortValue=u.attributes[z.chartConfig.labelField]||
"",D.sortValue=u.attributes[z.chartConfig.labelField]||"");w.text=P;D.text=P;w.text+="";"ColorByFieldValue"===z.chartConfig.chartColor.colorType&&(D.fill=this._getColorForFieldValue(u.attributes[z.chartConfig.chartColor.colorInfo.layerField],z));"PieChart"===z.chartConfig.chartType&&0>=D.y&&(aa=!1);aa&&(c.chartLabels.push(w),c.chartSeries.push(D))}));if("esriCTEmptyOption"!==z.chartConfig.labelField)for(c.chartLabels.sort(this._sortChartData),c.chartSeries.sort(this._sortChartData),F=0;F<c.chartLabels.length;F++)c.chartLabels[F].value=
F+1;this._setChartColorSettings(X,c,z)},_createLineChartData:function(z,F,R,X){var c={chartSeries:[],chartLabels:[]};var u=this._getDataSeriesAlias(z);var v=z.chartConfig.dataSeriesField.split(",");x.forEach(v,y.hitch(this,function(w,D){var P=[];var Y=[];x.forEach(F,y.hitch(this,function(aa,Z){var ca;var U={};var fa={};var la="";fa.y=aa.attributes[w];fa.tooltip=aa.attributes[w]+"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;";fa.seriesName=u[D];U={value:Z+1,text:aa.attributes[w]};"esriCTEmptyOption"===z.chartConfig.labelField?
la="":(0===aa.attributes[z.chartConfig.labelField]?la=0:R?(Z=z.layerDetails.relatedLayerInfo.popupInfo.fieldInfos,ea.has("ie")||ea.has("edge")?x.forEach(Z,y.hitch(this,function(ja){ja.fieldName===z.chartConfig.labelField&&(ca=ja)})):ca=Z.find(function(ja){return ja.fieldName===z.chartConfig.labelField}),Z=!1,-1<ca.format.dateFormat.toLowerCase().indexOf("time")&&(Z=!0),la=this._getLocaleFormatedDate(aa.attributes[z.chartConfig.labelField],Z)):la=aa.attributes[z.chartConfig.labelField]||"",U.sortValue=
aa.attributes[z.chartConfig.labelField]||"",fa.sortValue=aa.attributes[z.chartConfig.labelField]||"");U.text=la;fa.text=la;U.text+="";P.push(U);Y.push(fa)}));0<Y.length&&c.chartSeries.push(Y);0===c.chartLabels.length&&c.chartLabels.push(P)}));if("esriCTEmptyOption"!==z.chartConfig.labelField)for(c.chartLabels[0].sort(this._sortChartData),c.chartLabels[0].reverse(),x.forEach(c.chartSeries,y.hitch(this,function(w,D){c.chartSeries[D]=w.sort(this._sortChartData);c.chartSeries[D].reverse()})),v=0;v<c.chartLabels[0].length;v++)c.chartLabels[0][v].value=
v+1;this._setChartColorSettings(X,c,z)},_createPolarChartData:function(z,F,R,X){var c={chartSeries:[],chartLabels:[]};if("ColorByFieldValue"===z.chartConfig.chartColor.colorType){var u=z.chartConfig.chartColor.colorInfo.layerField;F.sort(function(D,P){return P.attributes[u]>D.attributes[u]?-1:P.attributes[u]<D.attributes[u]?1:0})}var v=z.chartConfig.polarChartConfig;var w=this._operationalLayers[R].objectIdField;x.forEach(F,y.hitch(this,function(D){var P={},Y={},aa={},Z={};for(P in v)Y[v[P].alias]=
D.attributes[v[P].fieldName];aa={data:Y};"ColorByFieldValue"===z.chartConfig.chartColor.colorType&&(aa.fill=this._getColorForFieldValue(D.attributes[z.chartConfig.chartColor.colorInfo.layerField],z),aa.legendLabel=D.attributes[u]);Z[D.attributes[w]]=aa;c.chartSeries.push(Z)}));this._setChartColorSettings(X,c,z)},_sortChartData:function(z,F){return z.sortValue>F.sortValue?-1:z.sortValue<F.sortValue?1:0},_getLocaleFormatedDate:function(z,F){z=new Date(z);return F?z.toLocaleString():z.toLocaleDateString()},
_getColorForFieldValue:function(z,F){var R="#000000";F.chartConfig.chartColor.colorInfo.layerFieldValues&&F.chartConfig.chartColor.colorInfo.layerFieldValues.hasOwnProperty(z)&&(R=F.chartConfig.chartColor.colorInfo.layerFieldValues[z]);return R},_setChartColorSettings:function(z,F,R){"ColorByTheme"===R.chartConfig.chartColor.colorType?this._loadSelectedTheme(z,F,R):"SingleColor"===R.chartConfig.chartColor.colorType?(F.fill=R.chartConfig.chartColor.colorInfo,z.resolve(F)):"ColorByFieldValue"===R.chartConfig.chartColor.colorType&&
z.resolve(F)},_loadSelectedTheme:function(z,F,R){require([R.chartConfig.chartColor.colorInfo.className],y.hitch(this,function(X){F.selectedTheme=X;z.resolve(F)}))},_highlightSelectedLocation:function(z,F){if(z){var R=k.fromJson(this.config.generalSettings.symbol.graphicLocationSymbol);F&&(this._selectedLocation=new d(z.geometry,R));this._highlightGraphicsLayer.add(this._selectedLocation)}},_highlightSelectedChartFeature:function(z){var F=this.config.charts[z].selectedFeature;z=this._operationalLayers[z];
if(""!==F&&null!==F&&void 0!==F){switch(F.geometry.type){case "point":var R=this._getPointSymbol(F,z);break;case "polyline":R=this._getPolyLineSymbol(F,z);break;case "polygon":R=this._getPolygonSymbol(F)}this._highlightGraphicsLayer.add(R)}},_getPolygonSymbol:function(z){var F=new M(M.STYLE_SOLID,new T(T.STYLE_SOLID,new Q([0,255,255,1]),4),new Q([0,0,0,0]));var R=new O(new S({wkid:z.geometry.spatialReference.wkid}));z.geometry.rings&&(R.rings=y.clone(z.geometry.rings));return new d(R,F,z.attributes)},
_getPolyLineSymbol:function(z,F){var R,X;var c=5;if(F&&F.renderer)if(F.renderer.symbol&&F.renderer.symbol.hasOwnProperty("width"))c=F.renderer.symbol.width;else if(F.renderer.infos&&0<F.renderer.infos.length)for(X=0;X<F.renderer.infos.length;X++){F.typeIdField?R=z.attributes[F.typeIdField]:F.renderer.attributeField&&(R=z.attributes[F.renderer.attributeField]);var u=F.renderer.infos[X].value;void 0!==R&&null!==R&&""!==R&&void 0!==u&&null!==u&&""!==u&&R.toString()===u.toString()&&F.renderer.infos[X].symbol.hasOwnProperty("width")&&
(c=F.renderer.infos[X].symbol.width)}else F.renderer.defaultSymbol&&F.renderer.defaultSymbol.hasOwnProperty("width")&&(c=F.renderer.defaultSymbol.width);F=new T(T.STYLE_SOLID,new Q([0,255,255,1]),c);c=new I(new S({wkid:z.geometry.spatialReference.wkid}));z.geometry.paths&&0<z.geometry.paths.length&&c.addPath(z.geometry.paths[0]);return new d(c,F,z.attributes)},_getPointSymbol:function(z,F){var R,X;var c=!1;var u=new W(W.STYLE_SQUARE,null,new T(T.STYLE_SOLID,new Q([0,255,255,1]),3));u.setColor(null);
u.size=30;if(F&&F.renderer)if(F.renderer.symbol)c=!0,u=this._updatePointSymbolProperties(u,F.renderer.symbol);else if(F.renderer.infos&&0<F.renderer.infos.length){for(X=0;X<F.renderer.infos.length;X++){F.typeIdField?R=z.attributes[F.typeIdField]:F.renderer.attributeField&&(R=z.attributes[F.renderer.attributeField]);var v=F.renderer.infos[X].value;void 0!==R&&null!==R&&""!==R&&void 0!==v&&null!==v&&""!==v&&R.toString()===v.toString()&&(c=!0,u=this._updatePointSymbolProperties(u,F.renderer.infos[X].symbol))}!c&&
F.renderer.defaultSymbol&&(c=!0,u=this._updatePointSymbolProperties(u,F.renderer.defaultSymbol))}F=new C(z.geometry.x,z.geometry.y,new S({wkid:z.geometry.spatialReference.wkid}));return new d(F,u,z.attributes)},_updatePointSymbolProperties:function(z,F){if(F.hasOwnProperty("height")&&F.hasOwnProperty("width")){var R=F.height;var X=F.width;R=(R>X?R:X)+10;z.size=R}F.hasOwnProperty("size")&&(!R||R<F.size)&&(z.size=F.size+10);F.hasOwnProperty("xoffset")&&(z.xoffset=F.xoffset);F.hasOwnProperty("yoffset")&&
(z.yoffset=F.yoffset);return z},_resetTimer:function(){0<this.config.generalSettings.refreshInterval&&(this._autoRefreshInterval&&clearInterval(this._autoRefreshInterval),this._autoRefreshInterval=setInterval(y.hitch(this,function(){this._autoRefresh()}),6E4*this.config.generalSettings.refreshInterval),this._refreshElapsedTime=new Date)},_clearTimer:function(){clearInterval(this._autoRefreshInterval);this._autoRefreshInterval=this._refreshElapsedTime=null},_getElapsedTimeInMinutes:function(){var z=
new Date,F=new Date;this._refreshElapsedTime&&(F=this._refreshElapsedTime);z=Math.floor((z-F)/1E3/60);return Math.round(z%60)},_autoRefresh:function(){this._autoRefreshInterval&&this._refreshElapsedTime&&this._selectedLocation&&parseInt(this._getElapsedTimeInMinutes(),10)>=parseInt(this.config.generalSettings.refreshInterval,10)&&(this._resetTimer(),this._loadFeatures(this._selectedLocation))},_getLayerDetailsFromMap:function(z,F){var R={};this.map&&this.map.webMapResponse&&this.map.webMapResponse.itemInfo&&
this.map.webMapResponse.itemInfo.itemData&&this.map.webMapResponse.itemInfo.itemData.operationalLayers&&x.forEach(this.map.webMapResponse.itemInfo.itemData.operationalLayers,y.hitch(this,function(X){X.layerObject&&("ArcGISMapServiceLayer"===X.layerType||"ArcGISTiledMapServiceLayer"===X.layerType?z.substring(0,z.length-1)===X.url&&(x.forEach(X.resourceInfo.layers,y.hitch(this,function(c){c.id===parseInt(F,10)&&(R.title=c.name)})),x.forEach(X.layers,y.hitch(this,function(c){c.id===parseInt(F,10)&&(c.name&&
(R.title=c.name),R.popupInfo=c.popupInfo,R.definitionExpression=null,c.layerDefinition&&(c.layerDefinition.definitionExpression&&(R.definitionExpression=c.layerDefinition.definitionExpression),c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer&&(R.renderer=c.layerDefinition.drawingInfo.renderer)))}))):X.url.replace(/.*?:\/\//g,"")===(z+F).replace(/.*?:\/\//g,"")&&(R.title=X.title,R.popupInfo=X.popupInfo,R.definitionExpression=null,X.layerDefinition&&(X.layerDefinition.definitionExpression&&
(R.definitionExpression=X.layerDefinition.definitionExpression),X.layerDefinition.drawingInfo&&X.layerDefinition.drawingInfo.renderer&&(R.renderer=X.layerDefinition.drawingInfo.renderer))))}));return R},_getTableDetailsFromMap:function(z,F){var R={};this.map&&this.map.webMapResponse&&this.map.webMapResponse.itemInfo&&this.map.webMapResponse.itemInfo.itemData&&this.map.webMapResponse.itemInfo.itemData.tables&&x.forEach(this.map.webMapResponse.itemInfo.itemData.tables,y.hitch(this,function(X){X.layerObject&&
X.url.replace(/.*?:\/\//g,"")===(z+F).replace(/.*?:\/\//g,"")&&(R.popupInfo=X.popupInfo,R.definitionExpression=null,X.layerDefinition&&X.layerDefinition.definitionExpression&&(R.definitionExpression=X.layerDefinition.definitionExpression))}));return R},_getSelectedThemeColor:function(){var z=this.appConfig.theme.name;if(this.appConfig&&this.appConfig.theme&&this.appConfig.theme.customStyles)this.config.selectedThemeColor=this.appConfig.theme.customStyles.mainBackgroundColor;else{var F=this.appConfig&&
this.appConfig.theme&&this.appConfig.theme.styles?this.appConfig.theme.styles[0]:"default";ha({url:"./themes/"+z+"/manifest.json",content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(y.hitch(this,function(R){var X;if(R&&R.styles&&0<R.styles.length)for(X=0;X<R.styles.length;X++){var c=R.styles[X];if(c.name===F){this.config.selectedThemeColor=c.styleColor;break}}this.config.selectedThemeColor||(this.config.selectedThemeColor="#000000")}),y.hitch(this,function(){this.config.selectedThemeColor=
"#000000"}))}},_connectSelectLocationHandler:function(){m(this.selectLocation,"click",y.hitch(this,function(){this._onSelectLocationClick()}));m(this.selectLocation,"keydown",y.hitch(this,function(z){z.keyCode!==ia.ENTER&&z.keyCode!==ia.SPACE||this._onSelectLocationClick()}))},_onSelectLocationClick:function(){a.contains(this.selectLocation,"esriCTSelectLocationActive")?this._disconnectMapEventHandler():(a.replace(this.selectLocation,"esriCTSelectLocationActive","esriCTSelectLocation"),this._connectMapEventHandler())},
_getDataSeriesAlias:function(z){var F;var R=z.chartConfig.dataSeriesField.split(",");if(z.layerDetails.relatedLayerInfo&&z.layerDetails.relatedLayerInfo.fields&&0<z.layerDetails.relatedLayerInfo.fields.length){z=z.layerDetails.relatedLayerInfo.fields;var X=x.map(z,function(w){return w&&w.name});var c=[];var u=R.length;for(F=0;F<u;F++){var v=X.indexOf(R[F]);-1<v&&(z[v].alias?c.push(z[v].alias):c.push(z[v].name))}return c}},_createWidgetAccessible:function(){this._setFirstFocusNode();this._setLastFocusNode();
this._searchInstance&&this._searchInstance.attachTabEventToSearchMenuItems()},_setFirstFocusNode:function(){if(this._hasMulitpleSourcesInSearch){if(this._searchInstance&&this._searchInstance.search&&this._searchInstance.search.sourcesBtnNode&&(ea.initFirstFocusNode(this.domNode,this._searchInstance.search.sourcesBtnNode),this._setFocusOnFirstNode)){this._setFocusOnFirstNode=!1;var z=this._searchInstance.search.sourcesBtnNode}}else this._searchInstance&&this._searchInstance.search&&this._searchInstance.search.inputNode&&
(ea.initFirstFocusNode(this.domNode,this._searchInstance.search.inputNode),this._setFocusOnFirstNode&&(this._setFocusOnFirstNode=!1,z=this._searchInstance.search.inputNode));ea.isAutoFocusFirstNodeWidget(this)&&da.focus(z)},_setLastFocusNode:function(){if(a.contains(this.errorNode,"esriCTHidden")){var z=g(".esriCTChartTitle",this.domNode);if(z=z[z.length-1]){if(a.contains(z,"esriCTChartSelected")){var F=g(".esriCTLayoutContent",z.parentNode);if(0<F.length){z=F[F.length-1];F=g(".dijitCheckBox",z);
0<F.length&&x.forEach(F,y.hitch(this,function(R){R=oa.getEnclosingWidget(R);""!==R&&null!==R&&void 0!==R&&this._attachTabEventToCheckbox(R)}));if(F&&0<F.length&&F[0].childNodes&&0<F[0].childNodes.length){ea.initLastFocusNode(this.domNode,F[0].childNodes[0]);return}ea.initLastFocusNode(this.domNode,z);return}}ea.initLastFocusNode(this.domNode,z)}else this.config.generalSettings.showLocationTool&&this.selectLocation?ea.initLastFocusNode(this.domNode,this.selectLocation):this._searchInstance&&this._searchInstance.search&&
this._searchInstance.search.submitNode&&ea.initLastFocusNode(this.domNode,this._searchInstance.search.submitNode)}else ea.initLastFocusNode(this.domNode,this.errorNode),da.focus(this.errorNode)},_attachTabEventToCheckbox:function(z){this.own(m(z,"keydown",y.hitch(this,function(F){F.keyCode!==ia.TAB||F.shiftKey||(qa.stop(F),this._setFocusOnFirstNode=!0,this._setFirstFocusNode())})))},_initWorkflow:function(z){var F=this._getSelectedGeocoder(z);z.isFeatureFromMapClick&&this._selectedLocation&&this._selectedLocation.geometry&&
this._locatorInstance&&this._locatorInstance.locationToAddress(p.webMercatorToGeographic(this._selectedLocation.geometry),100);z&&z.feature&&z.feature.geometry&&("point"===z.feature.geometry.type&&this._highlightSelectedLocation(z.feature,!0),F&&this._updateOpenPanels(F),this._loadFeatures(this._selectedLocation))},_zoomToFeature:function(){var z=new A;var F=this._prevFeature.feature.geometry;if("point"===F.type){if(this._prevFeature.hasOwnProperty("zoomScale"))var R=this._prevFeature.zoomScale;R&&
this.map.getScale()>R?R=ba.getExtentForScale(this.map,this._prevFeature.zoomScale).centerAt(F):(R=this.map.extent.centerAt(F))||(R=this.pointToExtent(this.map,F,20))}else R=F.getExtent().expand(1.5);R&&this.map.setExtent(R).then(y.hitch(this,function(){z.resolve()}));return z.promise},_refreshAllFeatureLayers:function(){var z=this._layerInfosObj.getLayerInfoArray();x.forEach(z,y.hitch(this,function(F){this.map.getLayer(F.id).refresh()}))}})});