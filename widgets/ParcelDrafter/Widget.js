// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/ParcelDrafter/PlanSettings":function(){define("dojo/_base/declare dojo/_base/array jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./PlanSettings.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/query ./utils jimu/utils libs/storejs/store jimu/dijit/formSelect".split(" "),function(H,d,h,l,n,g,p,e,x,D,y,k){return H([h,l,p],{baseClass:"jimu-widget-ParcelDrafter-PlanSettings",templateString:n,selectedPlanSettings:{},planSettingsOptions:g.clone(D.planSettingsOptions),
planSettingsKey:null,constructor:function(r){g.mixin(this,r)},startup:function(){var r=this._retriveFromLocalCache();r||(r={areaUnits:this.planSettingsOptions.areaUnits[1],circularCurveParameters:this.planSettingsOptions.circularCurveParameters[0],directionOrAngleType:this.planSettingsOptions.directionOrAngleType[0],directionOrAngleUnits:this.planSettingsOptions.directionOrAngleUnits[0],distanceAndLengthUnits:this.planSettingsOptions.distanceAndLengthUnits[1]});this._loadOptionsForDropDown(this.directionOrAngleType,
this.planSettingsOptions.directionOrAngleType,r.directionOrAngleType);this._loadOptionsForDropDown(this.directionOrAngleUnits,this.planSettingsOptions.directionOrAngleUnits,r.directionOrAngleUnits);this._loadOptionsForDropDown(this.distanceAndLengthUnits,this.planSettingsOptions.distanceAndLengthUnits,r.distanceAndLengthUnits);this._loadOptionsForDropDown(this.areaUnits,this.planSettingsOptions.areaUnits,r.areaUnits);this._loadOptionsForDropDown(this.circularCurveParameters,this.planSettingsOptions.circularCurveParameters,
r.circularCurveParameters);this.onPlansettingsChanged()},postCreate:function(){this.inherited(arguments);this.planSettingsKey=this.getKey();this.selectedPlanSettings={};this.planSettingsOptions=g.clone(D.planSettingsOptions);e.add(this.domNode,"esriCTPlanSettingsContainer esriCTFullWidth");setTimeout(g.hitch(this,this._setBackgroundColorForDartTheme),500)},postMixInProperties:function(){this.inherited(arguments);this.isRenderIdForAttrs=!0},_setBackgroundColorForDartTheme:function(){var r;if("DartTheme"===
this.appConfig.theme.name){var O=x(".dijitSelect .dijitButtonContents",this.planSettingsNode);var B=x(".dijitSelect .dijitArrowButton",this.planSettingsNode);for(r=0;r<O.length&&r<B.length;r++)e.add(O[r],"dijitButtonContentsDartTheme"),e.add(B[r],"dijitArrowButtonDartTheme")}},_loadOptionsForDropDown:function(r,O,B){var t=[],v;d.forEach(O,g.hitch(this,function(C){v={value:C,label:this.nls.planSettings[C]||window.jimuNls.units[C]};B===C&&(v.selected=!0);t.push(v)}));r.addOption(t)},_isSettingsChanged:function(){var r=
!1;this.selectedPlanSettings.directionOrAngleType!==this.directionOrAngleType.get("value")?r=!0:this.selectedPlanSettings.directionOrAngleUnits!==this.directionOrAngleUnits.get("value")?r=!0:this.selectedPlanSettings.distanceAndLengthUnits!==this.distanceAndLengthUnits.get("value")?r=!0:this.selectedPlanSettings.areaUnits!==this.areaUnits.get("value")?r=!0:this.selectedPlanSettings.circularCurveParameters!==this.circularCurveParameters.get("value")&&(r=!0);return r},onClose:function(){if(this._isSettingsChanged())this.onPlansettingsChanged()},
onPlansettingsChanged:function(){this.selectedPlanSettings={directionOrAngleType:this.directionOrAngleType.get("value"),directionOrAngleUnits:this.directionOrAngleUnits.get("value"),distanceAndLengthUnits:this.distanceAndLengthUnits.get("value"),areaUnits:this.areaUnits.get("value"),circularCurveParameters:this.circularCurveParameters.get("value")};this._saveToLocalCache(this.selectedPlanSettings);this.emit("planSettingsChanged",this.selectedPlanSettings)},_saveToLocalCache:function(r){try{k.set(this.planSettingsKey,
r)}catch(O){console.log("ParcelDrafter: Error in storeing settings to local cache.")}},_retriveFromLocalCache:function(){var r=null;try{r=k.get(this.planSettingsKey)}catch(O){console.log("ParcelDrafter: Error in retriving settings from local cache.")}return r},getKey:function(){return"ParcelDrafterPlanSettings."+encodeURIComponent(y.getAppIdFromUrl())+"."+this.widgetId},updateLastNodeInPlanSetting:function(){y.initLastFocusNode(this.widgetDomNode,this.circularCurveParameters.domNode)}})})},"widgets/ParcelDrafter/utils":function(){define([],
function(){var H={bearingFieldPlaces:2,planSettingsOptions:{directionOrAngleType:["northAzimuth","southAzimuth","quadrantBearing"],directionOrAngleUnits:["decimalDegree","degreeMinuteSeconds"],distanceAndLengthUnits:["uSSurveyFeet","feet","meters"],areaUnits:["squareUSSurveyFeet","squareFeet","acres","squareMeters"],circularCurveParameters:["radiusAndChordLength","radiusAndArcLength"]},getQuadrant:function(d){return{"-1":"NE","-2":"SE","-3":"SW","-4":"NW"}[d]},getQuadrantShortcut:function(d){d=d.toUpperCase();
return{NE:"-1",SE:"-2",SW:"-3",NW:"-4"}[d]},getQuadrantShortcutFromDD:function(d){var h;0<=d&&90>=d?h="-1":90<d&&180>=d?h="-2":180<d&&270>d?h="-3":270<=d&&360>d&&(h="-4");return h},getQuadrantAngleFromNADD:function(d){d=H.getQuadrantAngleAndShortcut(d);return d.quadrant.charAt(0)+d.quadrantAngle+d.quadrant.charAt(1)},getSouthAzimuthFromNorthAzimuth:function(d){var h;180<d?h=d-180:180>d?h=d+180:180===d&&(h=0);return h},DMStoDD:function(d){var h=Math.abs(parseFloat(d.degree));var l=parseFloat(d.minutes);
var n=parseFloat(d.seconds);h=h+l/60+n/3600;d.isNegative&&(h*=-1);return h},DDtoDMS:function(d){var h=3600*d.angle;d=Math.round(h%60);d=60==d?0:d;var l=(h-d)/60;h=Math.round(l%60);h=60==h?0:h;return{degree:Math.round((l-h)/60),minutes:h,seconds:d}},getBearingObjForFormat0:function(d){var h;var l={};l.degree=parseInt(d[1],10);l.minutes=parseInt(d[2]||0,10);l.seconds=parseInt(d[3]||0,10);l.quadrant=H.getQuadrant("-"+d[4]);l.quadrantShortcut="-"+d[4];"string"===typeof d[1]&&(h="-"===d[1].charAt(0));
l.decimalDegrees=H.DMStoDD({degree:l.degree,minutes:l.minutes,seconds:l.seconds,isNegative:h});return l},getBearingObjForFormat1:function(d){var h;var l={};l.degree=parseInt(d[2],10);l.minutes=parseInt(d[3]||0,10);l.seconds=parseInt(d[4]||0,10);l.quadrant=d[1]+d[5];l.quadrantShortcut=H.getQuadrantShortcut(d[1]+d[5]);"string"===typeof d[2]&&(h="-"===d[2].charAt(0));l.decimalDegrees=H.DMStoDD({degree:l.degree,minutes:l.minutes,seconds:l.seconds,isNegative:h});return l},getBearingObjForFormat2:function(d){var h;
var l={};l.degree=parseInt(d[2],10);l.minutes=parseInt(d[3]||0,10);l.seconds=parseInt(d[4]||0,10);l.quadrant=d[1]+d[5];l.quadrantShortcut=H.getQuadrantShortcut(d[1]+d[5]);"string"===typeof d[2]&&(h="-"===d[2].charAt(0));l.decimalDegrees=H.DMStoDD({degree:l.degree,minutes:l.minutes,seconds:l.seconds,isNegative:h});return l},getBearingObjForFormat3:function(d){var h;var l={};l.degree=parseInt(d[1],10);l.minutes=parseInt(d[2]||0,10);l.seconds=parseInt(d[3]||0,10);"string"===typeof d[1]&&(h="-"===d[1].charAt(0));
l.decimalDegrees=H.DMStoDD({degree:l.degree,minutes:l.minutes,seconds:l.seconds,isNegative:h});l.quadrantShortcut=H.getQuadrantShortcutFromDD(l.decimalDegrees);l.quadrant=H.getQuadrant(l.quadrantShortcut);return l},getBearingObjForFormat4:function(d){var h=H.DDtoDMS({angle:d[1]});var l={};l.degree=h.degree;l.minutes=h.minutes;l.seconds=h.seconds;l.decimalDegrees=d[1];l.quadrantShortcut=H.getQuadrantShortcutFromDD(l.decimalDegrees);l.quadrant=H.getQuadrant(l.quadrantShortcut);return l},getBearingObjForFormat5:function(d){var h;
var l={};l.degree=parseInt(d[1],10);l.minutes=parseInt(d[2]||0,10);l.seconds=parseInt(d[3]||0,10);"string"===typeof d[1]&&(h="-"===d[1].charAt(0));l.decimalDegrees=H.DMStoDD({degree:l.degree,minutes:l.minutes,seconds:l.seconds,isNegative:h});l.quadrantShortcut=H.getQuadrantShortcutFromDD(l.decimalDegrees);l.quadrant=H.getQuadrant(l.quadrantShortcut);return l},getBearingObjForFormat6:function(d){var h;var l={};l.degree=parseInt(d[1],10);l.minutes=parseInt(d[2]||0,10);l.seconds=parseInt(d[3]||0,10);
l.quadrantShortcut=d[4];l.quadrant=H.getQuadrant(l.quadrantShortcut);"string"===typeof d[1]&&(h="-"===d[1].charAt(0));l.decimalDegrees=H.DMStoDD({degree:l.degree,minutes:l.minutes,seconds:l.seconds,isNegative:h});return l},getBearingObjForFormat7:function(d){var h={};h.decimalDegrees=d[2];var l=H.DDtoDMS({angle:h.decimalDegrees});h.degree=parseInt(l.degree,10);h.minutes=parseInt(l.minutes||0,10);h.seconds=parseInt(l.seconds||0,10);h.quadrant=d[1]+d[3];h.quadrantShortcut=H.getQuadrantShortcut(h.quadrant);
return h},getBearingObjForFormat8:function(d){var h={};h.decimalDegrees=d[1];var l=H.DDtoDMS({angle:h.decimalDegrees});h.degree=parseInt(l.degree,10);h.minutes=parseInt(l.minutes||0,10);h.seconds=parseInt(l.seconds||0,10);h.quadrantShortcut=d[2];h.quadrant=H.getQuadrant(h.quadrantShortcut);return h},getQuadrantAngleAndShortcut:function(d){var h={};0<=d&&90>=d?(h.quadrantAngle=d,h.quadrant="NE"):90<d&&180>=d?(h.quadrantAngle=180-d,h.quadrant="SE"):180<d&&270>d?(h.quadrantAngle=d-180,h.quadrant="SW"):
270<=d&&360>d&&(h.quadrantAngle=360-d,h.quadrant="NW");return h},roundSeconds:function(d){d=Number(d);return 10>d?"0"+d:d},showFixedPlacesAfterDecimal:function(d,h){var l=0;h||(h=2);d=d.toString();l=d.indexOf(".");0<l&&(d=d.slice(0,l+h+1));return Number(d)},honourPopupRounding:function(d,h){if(isNaN(d)||null===d)d=4;var l=Math.pow(10,d);h=Math.round(h*l)/l;return h=h.toFixed(d)},convertBearingToOutputFormats:function(d){var h={};var l={};360===d.degree&&(d.degree=0);h=d.decimalDegrees;360===h&&(h=
0);l.naDD=h;l.naDDRound=H.honourPopupRounding(H.bearingFieldPlaces,h);360===Number(l.naDDRound)&&(l.naDDRound=0);var n=10>d.minutes?"0"+d.minutes:d.minutes;var g=d.seconds;0<Number(n)&&0<Number(H.roundSeconds(g))?l.naDMS=d.degree+"-"+n+"-"+H.roundSeconds(g):0===Number(n)&&0<Number(H.roundSeconds(g))?l.naDMS=d.degree+"-"+n+"-"+H.roundSeconds(g):0<Number(n)&&0===Number(H.roundSeconds(g))?l.naDMS=d.degree+"-"+n+"-00":0===Number(n)&&0===Number(H.roundSeconds(g))&&(l.naDMS=d.degree+"-00-00");d=H.getQuadrantAngleAndShortcut(h);
l.qb3DD=d.quadrant.charAt(0)+d.quadrantAngle+d.quadrant.charAt(1);l.qb3DDRound=d.quadrant.charAt(0)+H.honourPopupRounding(H.bearingFieldPlaces,d.quadrantAngle)+d.quadrant.charAt(1);n=H.DDtoDMS({angle:d.quadrantAngle});g=10>n.minutes?"0"+n.minutes:n.minutes;var p=n.seconds;0<Number(g)&&0<Number(H.roundSeconds(p))?l.qb3DMS=d.quadrant.charAt(0)+n.degree+"-"+g+"-"+H.roundSeconds(p)+d.quadrant.charAt(1):0===Number(g)&&0<Number(H.roundSeconds(p))?l.qb3DMS=d.quadrant.charAt(0)+n.degree+"-"+g+"-"+H.roundSeconds(p)+
d.quadrant.charAt(1):0<Number(g)&&0===Number(H.roundSeconds(p))?l.qb3DMS=d.quadrant.charAt(0)+n.degree+"-"+g+"-00"+d.quadrant.charAt(1):0===Number(g)&&0===Number(H.roundSeconds(p))&&(l.qb3DMS=d.quadrant.charAt(0)+n.degree+"-00-00"+d.quadrant.charAt(1));h=H.getSouthAzimuthFromNorthAzimuth(h);360===h&&(h=0);l.saDD=h;l.saDDRound=H.honourPopupRounding(H.bearingFieldPlaces,h);360===Number(l.saDDRound)&&(l.saDDRound=0);h=H.DDtoDMS({angle:h});360===h.degree&&(h.degree=0);d=10>h.minutes?"0"+h.minutes:h.minutes;
n=h.seconds;0<Number(d)&&0<Number(H.roundSeconds(n))?l.saDMS=h.degree+"-"+d+"-"+H.roundSeconds(n):0===Number(d)&&0<Number(H.roundSeconds(n))?l.saDMS=h.degree+"-"+d+"-"+H.roundSeconds(n):0<Number(d)&&0===Number(H.roundSeconds(n))?l.saDMS=h.degree+"-"+d+"-00":0===Number(d)&&0===Number(H.roundSeconds(n))&&(l.saDMS=h.degree+"-00-00");return l},getBearingDetailsOfRequiredFormat:function(d,h){var l={};switch(h){case 0:l=H.getBearingObjForFormat0(d);break;case 1:l=H.getBearingObjForFormat1(d);break;case 2:l=
H.getBearingObjForFormat2(d);break;case 3:l=H.getBearingObjForFormat3(d);break;case 4:l=H.getBearingObjForFormat4(d);break;case 5:l=H.getBearingObjForFormat5(d);break;case 6:l=H.getBearingObjForFormat6(d);break;case 7:l=H.getBearingObjForFormat7(d);break;case 8:l=H.getBearingObjForFormat8(d)}return H.convertBearingToOutputFormats(l)},getBearingFormatArr:function(){var d=[];d.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\-(0|[0-5]?\d)\-(0|[0-5]\d))?\-([1-4])$/,type:"degreeMinuteSeconds"});
d.push({regex:/^([nNsS])((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\-(0|[0-5]?\d)\-(0|[0-5]\d))?([eEwW])$/,type:"degreeMinuteSeconds"});d.push({regex:/^([nNsS])((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?([eEwW])$/,type:"degreeMinuteSeconds"});d.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?$/,type:"degreeMinuteSeconds"});d.push({regex:/^((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))$/,type:"decimalDegree"});
d.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\-(0|[0-5]?\d)\-((?:[0-5]\d)))?$/,type:"degreeMinuteSeconds"});d.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?(\-[1-4])$/,type:"degreeMinuteSeconds"});d.push({regex:/^([nNsS])((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))([eEwW])$/,type:"decimalDegree"});d.push({regex:/^((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))(\-[1-4])$/,type:"decimalDegree"});
return d},getNorthAzimuthAngle:function(d,h){h=h.toUpperCase();d=Number(d);switch(h){case "-1":case "NE":return(d+360)%360;case "-2":case "SE":return(540-d)%360;case "-3":case "SW":return(540+d)%360;case "-4":case "NW":return(360-d)%360}},convertBearingToNorthAzimuth:function(d,h,l){switch(h){case 0:h=H.getBearingObjForFormat0(d);h=H.getNorthAzimuthAngle(h.decimalDegrees,"-"+d[4]);h=H.DDtoDMS({angle:h});d[1]=h.degree;d[2]=h.minutes;d[3]=h.seconds;break;case 1:h=H.getBearingObjForFormat1(d);h=H.getNorthAzimuthAngle(h.decimalDegrees,
d[1]+d[5]);h=H.DDtoDMS({angle:h});d[2]=h.degree;d[3]=h.minutes;d[4]=h.seconds;break;case 2:h=H.getBearingObjForFormat2(d);h=H.getNorthAzimuthAngle(h.decimalDegrees,d[1]+d[5]);h=H.DDtoDMS({angle:h});d[2]=h.degree;d[3]=h.minutes;d[4]=h.seconds;break;case 3:"northAzimuth"===l.directionOrAngleType||"quadrantBearing"===l.directionOrAngleType?(h=H.getBearingObjForFormat3(d),h=H.getNorthAzimuthAngle(h.decimalDegrees,"-1"),h=H.DDtoDMS({angle:h}),d[1]=h.degree,d[2]=h.minutes,d[3]=h.seconds):"southAzimuth"===
l.directionOrAngleType&&(h=H.getBearingObjForFormat3(d),h=H.getNorthAzimuthAngle(h.decimalDegrees,"-3"),h=H.DDtoDMS({angle:h}),d[1]=h.degree,d[2]=h.minutes,d[3]=h.seconds);break;case 4:"northAzimuth"===l.directionOrAngleType||"quadrantBearing"===l.directionOrAngleType?d[1]=H.getNorthAzimuthAngle(d[1],"-1"):"southAzimuth"===l.directionOrAngleType&&(d[1]=H.getNorthAzimuthAngle(d[1],"-3"));break;case 5:"northAzimuth"===l.directionOrAngleType?(h=H.getBearingObjForFormat5(d),h=H.getNorthAzimuthAngle(h.decimalDegrees,
"-1"),h=H.DDtoDMS({angle:h}),d[1]=h.degree,d[2]=h.minutes,d[3]=h.seconds):"southAzimuth"===l.directionOrAngleType?(h=H.getBearingObjForFormat5(d),h=H.getNorthAzimuthAngle(h.decimalDegrees,"-3"),h=H.DDtoDMS({angle:h}),d[1]=h.degree,d[2]=h.minutes,d[3]=h.seconds):"quadrantBearing"===l.directionOrAngleType&&(d=null);break;case 6:h=H.getBearingObjForFormat6(d);h=H.getNorthAzimuthAngle(h.decimalDegrees,d[4]);h=H.DDtoDMS({angle:h});d[1]=h.degree;d[2]=h.minutes;d[3]=h.seconds;break;case 7:d[2]=H.getNorthAzimuthAngle(d[2],
d[1]+d[3]);break;case 8:d[1]=H.getNorthAzimuthAngle(d[1],d[2])}return d},categorizeBearingFormat:function(d,h){var l,n;d=d.toString();var g=H.getBearingFormatArr();for(n=0;n<g.length;n++)if(g[n].type===h.directionOrAngleUnits&&(l=g[n].regex.exec(d.trim()))&&0<l.length){l=H.convertBearingToNorthAzimuth(l,n,h);break}if(!l)for(n=0;n<g.length;n++)if(g[n].type!==h.directionOrAngleUnits&&(l=g[n].regex.exec(d.trim()))&&0<l.length){l=H.convertBearingToNorthAzimuth(l,n,h);break}return l?H.getBearingDetailsOfRequiredFormat(l,
n):null},metersToUSSurveyFeet:function(d){d=Number(d);return 3.28083333333*d},usSurveyFeetToMeters:function(d){d=Number(d);return.304800609601*d},feetToUSSurveyFeet:function(d){d=Number(d);return H.metersToUSSurveyFeet(.3048*d)},feetToMeters:function(d){d=Number(d);return.3048*d},usSurveyFeetToFeet:function(d){d=Number(d);return 1.000001999999281*d},metersToFeet:function(d){d=Number(d);return 3.280839895*d},getLengthObjForFormat0:function(d,h){var l={};"feet"===h?(l.feet=Number(d[0]),l.feetRound=
Math.round(1E4*l.feet)/1E4,l.uSSurveyFeet=H.feetToUSSurveyFeet(d[0]),l.uSSurveyFeetRound=Math.round(1E4*l.uSSurveyFeet)/1E4,l.meters=H.feetToMeters(d[0]),l.metersRound=Math.round(1E4*l.meters)/1E4):"uSSurveyFeet"===h?(l.uSSurveyFeet=Number(d[0]),l.uSSurveyFeetRound=Math.round(1E4*l.uSSurveyFeet)/1E4,l.meters=H.usSurveyFeetToMeters(d[0]),l.metersRound=Math.round(1E4*l.meters)/1E4,l.feet=H.usSurveyFeetToFeet(l.uSSurveyFeet),l.feetRound=Math.round(1E4*l.feet)/1E4):"meters"===h&&(l.uSSurveyFeet=H.metersToUSSurveyFeet(d[0]),
l.uSSurveyFeetRound=Math.round(1E4*l.uSSurveyFeet)/1E4,l.meters=Number(d[0]),l.metersRound=Math.round(1E4*l.meters)/1E4,l.feet=H.metersToFeet(l.meters),l.feetRound=Math.round(1E4*l.feet)/1E4);return l},getLengthObjForFormat3:function(d){var h={};h.uSSurveyFeet=Number(d[2]);h.uSSurveyFeetRound=Math.round(1E4*h.uSSurveyFeet)/1E4;h.meters=H.usSurveyFeetToMeters(d[2]);h.metersRound=Math.round(1E4*h.meters)/1E4;h.feet=H.usSurveyFeetToFeet(h.uSSurveyFeet);h.feetRound=Math.round(1E4*h.feet)/1E4;return h},
getLengthObjForFormat2:function(d){var h={};h.uSSurveyFeet=H.metersToUSSurveyFeet(d[2]);h.uSSurveyFeetRound=Math.round(1E4*h.uSSurveyFeet)/1E4;h.meters=Number(d[2]);h.metersRound=Math.round(1E4*h.meters)/1E4;h.feet=H.metersToFeet(h.meters);h.feetRound=Math.round(1E4*h.feet)/1E4;return h},getLengthObjForFormat1:function(d){var h={};h.feet=Number(d[2]);h.feetRound=Math.round(1E4*h.feet)/1E4;h.uSSurveyFeet=H.feetToUSSurveyFeet(d[2]);h.uSSurveyFeetRound=Math.round(1E4*h.uSSurveyFeet)/1E4;h.meters=H.feetToMeters(d[2]);
h.metersRound=Math.round(1E4*h.meters)/1E4;return h},categorizeLengthFormat:function(d,h){var l,n;var g=[];d=d.toString();g.push(/^((\-?)((0?|([1-9]\d*))(\.\d+)?))$/);g.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(ft|FT|fT|Ft))$/);g.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(m|M))$/);g.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(FTUS|FTUs|FTuS|FTus|FtUS|FtUs|FtuS|Ftus|fTUS|fTUs|fTuS|fTus|ftUS|ftUs|ftuS|ftus))$/);for(n=0;n<g.length&&!((l=g[n].exec(d.trim()))&&0<l.length);n++);l?(d=H.getLengthOfRequiredFormat(l,
n,h))&&isNaN(d.meters)&&(d=null):d=null;return d},getLengthOfRequiredFormat:function(d,h,l){var n={};switch(h){case 0:n=H.getLengthObjForFormat0(d,l);break;case 1:n=H.getLengthObjForFormat1(d);break;case 2:n=H.getLengthObjForFormat2(d);break;case 3:n=H.getLengthObjForFormat3(d)}return n}};return H})},"widgets/ParcelDrafter/XYInput":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./XYInput.html dojo/on dojo/_base/lang dojo/Evented esri/geometry/Point dojo/keys jimu/utils dojo/dom-attr dojo/dom-class dijit/form/ValidationTextBox".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y,k){return H([d,h,p],{baseClass:"jimu-widget-ParcelDrafter-XYInput",templateString:l,constructor:function(r){g.mixin(this,r)},postCreate:function(){this.inherited(arguments);this.spatialReference=this.map.getLayer(this.config.polygonLayer.id).spatialReference;this.xRowWrapper.title=this.nls.xyInput.explanation;this.yRowWrapper.title=this.nls.xyInput.explanation;y.set(this.newTraverseX,"aria-label","x"+this.xRowWrapper.title);y.set(this.newTraverseY,"aria-label","y"+this.yRowWrapper.title);
this.own(n(this.newTraverseX,"change",g.hitch(this,function(){this._onTextBoxValueChanged()})));this.own(n(this.newTraverseY,"change",g.hitch(this,function(){this._onTextBoxValueChanged()})));this.own(n(this.xyStartButton,"click",g.hitch(this,function(){k.contains(this.xyStartButton,"jimu-state-disabled")||this.emit("newPoint",this.project(this.newTraverseX.value,this.newTraverseY.value))})));this.own(n(this.xyStartButton,"keydown",g.hitch(this,function(r){if(r.keyCode===x.ENTER||r.keyCode===x.SPACE)k.contains(this.xyStartButton,
"jimu-state-disabled")||this.emit("newPoint",this.project(this.newTraverseX.value,this.newTraverseY.value))})))},project:function(r,O){return new e(r,O,this.spatialReference)},_updateLastFocusNode:function(){k.contains(this.xyStartButton,"jimu-state-disabled")?(k.add(this.xyStartButton,"jimu-state-disabled"),y.set(this.xyStartButton,"tabIndex","-1"),D.initLastFocusNode(this.widgetDomNode,this.newTraverseY.domNode)):(k.remove(this.xyStartButton,"jimu-state-disabled"),y.set(this.xyStartButton,"tabIndex",
"0"),D.initLastFocusNode(this.widgetDomNode,this.xyStartButton))},_onTextBoxValueChanged:function(){this.newTraverseX.isValid()&&this.newTraverseY.isValid()?k.remove(this.xyStartButton,"jimu-state-disabled"):k.add(this.xyStartButton,"jimu-state-disabled");this._updateLastFocusNode()},resetXYTextBoxes:function(){this.newTraverseX.reset();this.newTraverseY.reset()}})})},"widgets/ParcelDrafter/NewTraverse":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./NewTraverse.html dojo/_base/lang dojo/_base/array dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dnd/Source dojo/on dijit/form/ValidationTextBox ./SymbolSelector ./MiscloseDetails ./ParcelTools ./PlanInfo ./geometryUtils ./utils esri/graphic esri/symbols/jsonUtils esri/layers/GraphicsLayer esri/graphicsUtils dojo/dom-attr dojo/query esri/SpatialReference dojo/keys dijit/focus dijit/TooltipDialog dijit/popup dojo/Deferred esri/geometry/Extent esri/geometry/Point dojo/dom-geometry jimu/utils".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v,C,Q,N,T,U,m,u,M,I,S,E,W,A,a,f,z,J,K){return H([d,h,l],{baseClass:"jimu-widget-ParcelDrafter",templateString:n,parcelLinesGraphicsLayer:null,parcelPointsGraphicsLayer:null,parcelPolygonGraphicsLayer:null,lineLayerSpatialReference:null,polygonLayerSpatialReference:null,_itemList:[],_nodes:[],_dndContainer:null,startPoint:null,_startPointForNextLine:null,_planSettings:null,_arrayOfAllBoundaryLines:[],_rotationAngle:0,_scaleValue:1,polygonDeleteArr:[],polylineDeleteArr:[],
_popupDialog:null,_popupCoords:null,_setExtentTimer:null,numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],lengthFieldPlaces:2,radiusFieldPlaces:2,miscloseDistanceFieldPlaces:2,postCreate:function(){this.rotationPointsGraphicsLayer=this.parcelPointsGraphicsLayer=this.parcelLinesGraphicsLayer=this.parcelPolygonGraphicsLayer=null;this.numberFieldTypes=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];
this.polygonDeleteArr=[];this.polylineDeleteArr=[];this._arrayOfAllBoundaryLines=[];this._nodes=[];this._itemList=[];this._setExtentTimer=null;e.add(this.domNode,"esriCTNewTraverseGrid");this._addGraphicsLayer();this._createTraverseGrid();this._setValidatorForInitialRow();this._handleEventsOnInitialRow();this._symbolSelector=this._createLineSelector(this.lineSymbolNode,null);this.own(k(this.screenDigitizationNode,"click",g.hitch(this,this._onDigitizationButtonClicked)));this.own(k(this.screenDigitizationNode,
"keydown",g.hitch(this,function(b){if(b.keyCode===S.ENTER||b.keyCode===S.SPACE)b.preventDefault(),this._onDigitizationButtonClicked()})));this.own(k(this.updateRotationPointNode,"click",g.hitch(this,this._onUpdateRotationPointButtonClicked)));this.own(k(this.updateRotationPointNode,"keydown",g.hitch(this,function(b){if(b.keyCode===S.ENTER||b.keyCode===S.SPACE)b.preventDefault(),this._onUpdateRotationPointButtonClicked()})));this.own(k(this.zoomToNode,"click",g.hitch(this,this._onZoomButtonClicked)));
this.own(k(this.zoomToNode,"keydown",g.hitch(this,function(b){if(b.keyCode===S.ENTER||b.keyCode===S.SPACE)b.preventDefault(),this._onZoomButtonClicked()})));this.own(k(this.expandCollapseNode,"click",g.hitch(this,this._onExpandCollapseClicked)));this.own(k(this.expandCollapseNode,"keydown",g.hitch(this,function(b){if(b.keyCode===S.ENTER||b.keyCode===S.SPACE)b.preventDefault(),this._onExpandCollapseClicked()})));this.own(k(this.addButton,"click",g.hitch(this,function(){this._addNewItem(!1)})));this.own(k(this.addButton,
"keydown",g.hitch(this,function(b){b.keyCode!==S.ENTER&&b.keyCode!==S.SPACE||this._addNewItem(!1)})));this._createMiscloseDetails();this._createParcelTools();this._createPlanInfo();this._createTooltip();this.config.polylineLayer&&this.config.polylineLayer.popupInfo&&this.config.polylineLayer.popupInfo.fieldInfos&&p.forEach(this.config.polylineLayer.popupInfo.fieldInfos,g.hitch(this,function(b){b.fieldName===this.config.polylineLayer.bearing.name&&b.format&&(Q.bearingFieldPlaces=b.format.places);b.fieldName===
this.config.polylineLayer.distance.name&&b.format&&(this.lengthFieldPlaces=b.format.places);b.fieldName===this.config.polylineLayer.radius.name&&b.format&&(this.radiusFieldPlaces=b.format.places)}));this.config.polygonLayer&&this.config.polygonLayer.popupInfo&&this.config.polygonLayer.popupInfo.fieldInfos&&p.forEach(this.config.polygonLayer.popupInfo.fieldInfos,g.hitch(this,function(b){b.fieldName===this.config.polygonLayer.miscloseDistance.name&&b.format&&(this.miscloseDistanceFieldPlaces=b.format.places)}))},
destroy:function(){this.parcelPolygonGraphicsLayer&&this.map.removeLayer(this.parcelPolygonGraphicsLayer);this.parcelLinesGraphicsLayer&&this.map.removeLayer(this.parcelLinesGraphicsLayer);this.parcelPointsGraphicsLayer&&this.map.removeLayer(this.parcelPointsGraphicsLayer);this.rotationPointsGraphicsLayer&&this.map.removeLayer(this.rotationPointsGraphicsLayer)},_addGraphicsLayer:function(){this.parcelPolygonGraphicsLayer=new U;this.parcelLinesGraphicsLayer=new U;this.parcelPointsGraphicsLayer=new U;
this.rotationPointsGraphicsLayer=new U;this.own(k(this.parcelPointsGraphicsLayer,"click",g.hitch(this,function(b){e.contains(this.updateRotationPointNode,"esriCTEnableButton")&&(this._setRotationPoint(b.graphic.attributes.rowIndex,b.graphic.geometry),this._showRotationPoint())})));this.map.addLayer(this.parcelPolygonGraphicsLayer);this.map.addLayer(this.parcelLinesGraphicsLayer);this.map.addLayer(this.parcelPointsGraphicsLayer);this.map.addLayer(this.rotationPointsGraphicsLayer)},_setValidatorForInitialRow:function(){this.bearingNode.validator=
g.hitch(this,function(b){return this._bearingValidator(b,["*","*tb"])});this.bearingNode.invalidMessage=this.nls.newTraverse.invalidBearingMessage;this.lengthNode.validator=g.hitch(this,function(b){if("*"===b&&this._itemList&&0<this._itemList.length)return!0;if(""===this.radiusNode.get("value")&&0>parseFloat(b))return this.lengthNode.invalidMessage=this.nls.newTraverse.negativeLengthMessage,!1;this.lengthNode.invalidMessage=this.nls.newTraverse.invalidLengthMessage;return this._lengthValidator(b)});
this.lengthNode.invalidMessage=this.nls.newTraverse.invalidLengthMessage;this.radiusNode.validator=g.hitch(this,function(b){if("*"===b&&this._itemList&&0<this._itemList.length)return!0;var c=this._radiusValidator(b);if(""!==b)if((b=this.lengthNode.isValid())&&c){if(!this._validateLengthRadiusProportion(c,b))return null;c&&(b=this.lengthNode.value,this.lengthNode.reset(),this.lengthNode.set("value",b))}else c=null;return c});this.radiusNode.invalidMessage=this.nls.newTraverse.invalidRadiusMessage},
_bearingValidator:function(b,c){return-1!==c.indexOf(b)&&this._itemList&&0<this._itemList.length?!0:this._validateBearing(b,c)},_lengthValidator:function(b,c){return""===b||"0"===b||0===b?!1:this._validateLength(b,c)},_radiusValidator:function(b,c){return""===b?!0:this._validateLength(b,c)},_handleEventsOnInitialRow:function(){this.own(k(this.bearingNode,"keypress",g.hitch(this,this._bearingValueEntered)));this.own(k(this.lengthNode,"keypress",g.hitch(this,this._lengthValueEntered)));this.own(k(this.radiusNode,
"keypress",g.hitch(this,this._radiusValueEntered)))},_copyPrevValue:function(b){switch(b){case "Bearing":b=this.bearingNode.get("value");"*"===b&&0<this._itemList.length&&(b=this._itemList[this._itemList.length-1].BearingConversions?this._getBearingAccordingToPlanSettings(this._itemList[this._itemList.length-1].BearingConversions):this._itemList[this._itemList.length-1].Bearing,this.bearingNode.set("value",b));break;case "Length":b=this.lengthNode.get("value");"*"===b&&0<this._itemList.length&&(b=
"radiusAndArcLength"===this._planSettings.circularCurveParameters&&this._itemList[this._itemList.length-1].ArcLengthConversions?this._itemList[this._itemList.length-1].ArcLengthConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-1].LengthConversions?this._itemList[this._itemList.length-1].LengthConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-1].Length,this.lengthNode.set("value",b));break;case "Radius":b=this.radiusNode.get("value"),
"*"===b&&0<this._itemList.length&&(b=this._itemList[this._itemList.length-1].RadiusConversions?this._itemList[this._itemList.length-1].RadiusConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-1].Radius,this.radiusNode.set("value",b))}},_bearingValueEntered:function(b){b=b.charCode||b.keyCode;b===S.ENTER||b===S.TAB?(this.bearingNode.get("value"),this._copyPrevValue("Bearing"),b===S.ENTER&&this.bearingNode.isValid()?E.focus(this.lengthNode.focusNode):this.bearingNode.validate(!1)):
setTimeout(g.hitch(this,function(){this.bearingNode.validate(!1)}),100)},_lengthValueEntered:function(b){b=b.charCode||b.keyCode;b===S.ENTER||b===S.TAB?(this.lengthNode.get("value"),this._copyPrevValue("Length"),b===S.ENTER&&this.lengthNode.isValid()?E.focus(this.radiusNode.focusNode):this.lengthNode.validate(!1)):setTimeout(g.hitch(this,function(){this.lengthNode.validate(!1)}),100)},_radiusValueEntered:function(b){(b.charCode||b.keyCode)===S.ENTER?(b=this.radiusNode.get("value"),this._copyPrevValue("Radius"),
""===b||this.radiusNode.isValid()?this.bearingNode.isValid()?this.lengthNode.isValid()?(this._addNewItem(),E.focus(this.bearingNode.focusNode)):(this.lengthNode.validate(!1),E.focus(this.lengthNode.focusNode)):(this.bearingNode.validate(!1),E.focus(this.bearingNode.focusNode)):this.radiusNode.validate(!1)):setTimeout(g.hitch(this,function(){this.radiusNode.validate(!1)}),100)},_validateBearing:function(b){return(b=Q.categorizeBearingFormat(b,this._planSettings))?b:null},_validateLength:function(b,
c){switch(c){case "feet":b=Q.categorizeLengthFormat(b,"feet");break;case "meters":b=Q.categorizeLengthFormat(b,"meters");break;case "uSSurveyFeet":b=Q.categorizeLengthFormat(b,"uSSurveyFeet");break;default:b=Q.categorizeLengthFormat(b,this._planSettings.distanceAndLengthUnits)}return b?b:null},_validateLengthRadiusProportion:function(b,c){return b&&c&&(b=b[this._planSettings.distanceAndLengthUnits],c=c[this._planSettings.distanceAndLengthUnits],0!==b&&(b=2*parseFloat(Math.abs(b)),"radiusAndArcLength"===
this._planSettings.circularCurveParameters&&(b*=Math.PI),b<parseFloat(Math.abs(c))))?null:!0},_getValidatedValues:function(b,c,q){var w={},L;b?(w=b,c&&("Bearing"!==c&&w.BearingConversions&&(w.Bearing=this._getBearingAccordingToPlanSettings(w.BearingConversions)),"Length"!==c&&w.LengthConversions&&(w.Length=w.LengthConversions[this._planSettings.distanceAndLengthUnits]),"Radius"!==c&&w.RadiusConversions&&(w.Radius=w.RadiusConversions[this._planSettings.distanceAndLengthUnits]),"Bearing"===c&&"*tb"===
w.Bearing.toString().toLowerCase()&&0<this._itemList.length&&0!==q&&(w.isTB=!0))):(this._copyPrevValue("Bearing"),this._copyPrevValue("Length"),this._copyPrevValue("Radius"),w.LineSymbol=this._symbolSelector.selectedSymbol,w.Bearing=this.bearingNode.get("value"),w.Length=this.lengthNode.get("value"),w.Radius=this.radiusNode.get("value"),"*tb"===w.Bearing.toString().toLowerCase()&&0<this._itemList.length?w.isTB=!0:w.isTB=!1);if(""!==g.trim(w.Bearing.toString())&&""!==g.trim(w.Length.toString())&&((c=
this._validateBearing(w.Bearing))||w.isTB)){w.BearingConversions=c;if(""===g.trim(w.Length.toString())&&""===g.trim(w.Radius.toString()))return null;if(""!==g.trim(w.Length.toString()))if((c=this._validateLength(w.Length))&&0!==c.meters){if(""!==g.trim(w.Radius.toString()))if(L=this._validateLength(w.Radius)){if(!this._validateLengthRadiusProportion(L,c))return null;w.RadiusConversions=L}else return null;else{if(0>parseInt(c.meters,10))return null;w.RadiusConversions=null}w.LengthConversions=c}else return null;
w.RadiusConversions&&(w=this._createValuesForArc(w));w.isTB&&(b=b&&!isNaN(q)?this._itemList[q-1]:this._itemList[this._itemList.length-1],w=this._setTangentBearing(w,b))}else return null;return w},_setTangentBearing:function(b,c){var q=g.clone(this._planSettings);q.directionOrAngleType="northAzimuth";q.directionOrAngleUnits="decimalDegree";var w=c.BearingConversions.naDD;c.RadiusConversions&&0!==c.RadiusConversions.meters&&(w=C.chordBearingToTangentBearing(w,c.RadiusConversions.meters,c.ChordLengthConversions.meters));
b.RadiusConversions&&0!==b.RadiusConversions.meters?(w=C.tangentBearingToChordBearing(w,b.RadiusConversions.meters,b.ChordLengthConversions.meters),b.Bearing=w,b.BearingConversions=Q.categorizeBearingFormat(b.Bearing,q)):c.RadiusConversions&&0!==c.RadiusConversions.meters?(b.Bearing=w,b.BearingConversions=Q.categorizeBearingFormat(b.Bearing,q)):(b.Bearing=c.Bearing,b.BearingConversions=g.clone(c.BearingConversions));return b},_updateTBFromIndex:function(b){var c;for(c=!1;b<this._itemList.length;b++)if(this._itemList[b]&&
this._itemList[b].isTB)this._itemList[b]=this._setTangentBearing(this._itemList[b],this._itemList[b-1]),c=!0;else break;return c},_onZoomButtonClicked:function(){this._setExtentToLayer(this.parcelLinesGraphicsLayer,!0)},_onExpandCollapseClicked:function(){e.toggle(this.traverseGrid,"esriCTHidden");e.contains(this.expandCollapseNode,"esriCTExpand")?(u.set(this.expandCollapseNode,"title",this.nls.planSettings.collapseGridTooltipText),e.replace(this.expandCollapseNode,"esriCTCollapse","esriCTExpand"),
u.set(this.expandCollapseNode,"aria-expanded",!0)):(u.set(this.expandCollapseNode,"title",this.nls.planSettings.expandGridTooltipText),e.replace(this.expandCollapseNode,"esriCTExpand","esriCTCollapse"),u.set(this.expandCollapseNode,"aria-expanded",!1))},setRotation:function(b){var c,q;var w=this.startPoint;this._rotationPointInfo&&this._rotationPointInfo.rotationPoint&&(w=this._rotationPointInfo.rotationPoint);var L=new I(4326);C.getProjectedGeometry(b,L,this.geometryService).then(g.hitch(this,function(R){c=
C.getRotationAngleBetweenPoints(w,R);0<this._itemList.length&&(q=0,this._rotationPointInfo&&this._rotationPointInfo.rotationPointIndex<this._itemList.length&&(q=this._rotationPointInfo.rotationPointIndex),c-=this._itemList[q].BearingConversions.naDDRound);360===c&&(c=0);this._parcelToolInstance.setRotation(c)}))},setScaling:function(b){b=C.getScaleDistanceBetweenPoints(this.startPoint,b);this.distance?(b/=this.distance,.1>b&&(b=.1),this._parcelToolInstance.setScale(b)):this.distance=b},_addNewItem:function(b){var c;
if(c=this._getValidatedValues()){if(b&&this._rotationAngle){var q=c.BearingConversions.naDD-this._rotationAngle;q=this.getAngleFromDDTOQB(360<=q?q%360:q);c.Bearing=q;c.BearingConversions=this._validateBearing(q)}q=g.trim(c.Radius.toString());c.rowIndex=this._itemList.length;this._itemList.push(c);this._createRow(c,this._itemList.length-1);E.focus(this.bearingNode.focusNode);this._resetEntryRow(b);""===q||"0"===q||0===q?this._drawStraightLine(c,!0):this._drawArc(c,!0);this._showHideTraverseTools();
this.appliedCompassRule&&this.setParcelClosure()}else this.bearingNode.isValid()?""!==this.lengthNode.get("value")&&this.lengthNode.isValid()?""===this.radiusNode.get("value")||this.radiusNode.isValid()||(E.focus(this.radiusNode.focusNode),this.radiusNode.validate(!1)):(E.focus(this.lengthNode.focusNode),this.lengthNode.validate(!1)):(E.focus(this.bearingNode.focusNode),this.bearingNode.validate(!1))},_createValuesForArc:function(b){if(b.RadiusConversions){var c=b.RadiusConversions.meters;"radiusAndArcLength"===
this._planSettings.circularCurveParameters?(b.ArcLength=b.LengthConversions.meters,b.ArcLengthConversions=g.clone(b.LengthConversions),b.ChordLength=C.getChordLengthFromArcLength(b.ArcLength,c),b.ChordLengthConversions=this._validateLength(b.ChordLength,"meters")):(b.ChordLength=b.LengthConversions.meters,b.ChordLengthConversions=g.clone(b.LengthConversions),b.ArcLength=C.getArcLengthFromChordLength(b.ChordLength,c),b.ArcLengthConversions=this._validateLength(b.ArcLength,"meters"))}else"radiusAndArcLength"===
this._planSettings.circularCurveParameters&&b.ArcLengthConversions&&(b.Length=b.ArcLength,b.LengthConversions=g.clone(b.ArcLengthConversions)),b.ChordLength=0,b.ChordLengthConversions=null,b.ArcLength=0,b.ArcLengthConversions=null;return b},_onDigitizationButtonClicked:function(){e.toggle(this.screenDigitizationNode,"esriCTEnableButton");e.contains(this.screenDigitizationNode,"esriCTEnableButton")?(u.set(this.screenDigitizationNode,"aria-pressed","true"),this.emit("activateDigitizationTool"),this.deActivateUpdateRotationPointTool()):
(u.set(this.screenDigitizationNode,"aria-pressed","false"),this.emit("deActivateDigitizationTool"))},_onUpdateRotationPointButtonClicked:function(){e.toggle(this.updateRotationPointNode,"esriCTEnableButton");e.contains(this.updateRotationPointNode,"esriCTEnableButton")?(u.set(this.updateRotationPointNode,"aria-pressed","true"),this.emit("activateUpdateRotationPointTool"),this.deActivateDigitizationTool()):(u.set(this.updateRotationPointNode,"aria-pressed","false"),this.emit("deActivateUpdateRotationPointTool"))},
_createMiscloseDetails:function(){this._misCloseDetailsInstance=new B({nls:this.nls,config:this.config,appConfig:this.appConfig,numberFieldTypes:this.numberFieldTypes,validateNumericField:this.validateNumericField},x.create("div",{},this.misCloseDetailsNode));this._misCloseDetailsInstance.setMiscloseDetails(null)},_createParcelTools:function(){this._parcelToolInstance=new t({nls:this.nls,config:this.config,canProjectLocally:C.canProjectLocally(this.map.spatialReference)},x.create("div",{},this.parcelToolsNode));
this.own(this._parcelToolInstance.on("rotateGeometries",g.hitch(this,function(b){b!==this._rotationAngle&&(this._rotationAngle=b,this._rotationPointInfo&&this._rotationPointInfo.rotationPoint?this._updateStartPointFromRotationPoint():this._itemList&&0<this._itemList.length&&this.setStartPoint(this.startPoint))})));this.own(this._parcelToolInstance.on("scaleGeometries",g.hitch(this,function(b){b!==this._scaleValue&&(this._scaleValue=b,this._rotationPointInfo&&this._rotationPointInfo.rotationPoint?
this._updateStartPointFromRotationPoint():this._itemList&&0<this._itemList.length&&this.setStartPoint(this.startPoint))})));this.own(this._parcelToolInstance.on("toggleRotating",g.hitch(this,function(b){this.emit("toggleRotating",b)})));this.own(this._parcelToolInstance.on("toggleScaling",g.hitch(this,function(b){this.emit("toggleScaling",b)})))},_createPlanInfo:function(){this._planInfoInstance=new v({map:this.map,nls:this.nls,config:this.config,loading:this.loading,numberFieldTypes:this.numberFieldTypes,
validateNumericField:this.validateNumericField,geometryService:this.geometryService,parcelPolygonGraphicsLayer:this.parcelPolygonGraphicsLayer,parcelLinesGraphicsLayer:this.parcelLinesGraphicsLayer,polylineLayerUnit:C.getUnitValueForSR(this.lineLayerSpatialReference),polygonLayerUnit:C.getUnitValueForSR(this.polygonLayerSpatialReference),widgetDomNode:this.widgetDomNode},x.create("div",{},this.planInfoNode));this.own(this._planInfoInstance.on("cancelTraversedParcel",g.hitch(this,function(){this.emit("cancelTraverse")})));
this.own(this._planInfoInstance.on("showMessage",g.hitch(this,function(b){this._showMessage(b)})));this.own(this._planInfoInstance.on("showParcelSavedAndDeleteMsg",g.hitch(this,function(b){this._showParcelSavedAndDeleteMsg(b)})));this.own(this._planInfoInstance.on("saveTraversedParcel",g.hitch(this,function(){this.closePopup();if(this._itemList&&0<this._itemList.length){var b=this._misCloseDetailsInstance.traverseStatedArea.get("value").trim();var c=this._planInfoInstance.validateParcelDetails(b);
c.status?(""===this._misCloseDetailsInstance.traverseStatedArea.get("value")&&(b=null),c={},c.itemList=this._itemList,c.statedArea=b,c.rotation=this._rotationAngle,c.scale=this._scaleValue,c.appliedCompassRule=this.appliedCompassRule,c.miscloseDetails=this._misCloseDetailsInstance.getMiscloseDetails(),c.polygonDeleteArr=this.polygonDeleteArr,c.polylineDeleteArr=this.polylineDeleteArr,c.planSettings=this._planSettings,this._planInfoInstance.saveData(c)):c.message&&this._showMessage(c.message)}else this._showMessage(this.nls.newTraverse.enterValidParcelInfoMessage)})));
this.own(this._planInfoInstance.on("displayMainPageAfterSave",g.hitch(this,function(){this.emit("displayMainPageAfterSave",!1)})))},_createTraverseGrid:function(){var b;this._nodes=[];x.empty(this.traverseGrid);this._dndContainer=new y(this.traverseGrid,{skipForm:!0,singular:!0});this._dndContainer.copyState=function(){return!1};for(b=0;b<this._itemList.length;b++)this._createRow(this._itemList[b],b);this.own(this._dndContainer.on("DndDrop",g.hitch(this,this._onDndDrop)));this._dndContainer.insertNodes(!1,
this._nodes)},_createFieldInputs:function(b,c,q,w){var L=new r({value:c,"class":q?q:""});L.placeAt(b);"esriCTBearingRow"===q?(u.set(L,"aria-label",this.nls.traverseSettings.bearingLabel),L.validator=g.hitch(this,function(R){"*tb"!==R&&"*"===R.charAt(0)&&(R=R.slice(1));return this._bearingValidator(R,["*tb"])}),L.invalidMessage=this.nls.newTraverse.invalidBearingMessage):"esriCTLengthRow"===q?(u.set(L,"aria-label",this.nls.traverseSettings.lengthLabel),L.validator=g.hitch(this,this._lengthValidator),
L.invalidMessage=this.nls.newTraverse.invalidLengthMessage):"esriCTRadiusRow"===q&&(u.set(L,"aria-label",this.nls.traverseSettings.radiusLabel),L.validator=g.hitch(this,this._radiusValidator),L.invalidMessage=this.nls.newTraverse.invalidRadiusMessage);this.own(k(L,"blur",g.hitch(this,function(){var R=parseInt(u.get(b,"rowIndex"),10);this._updateParcelValues(L,R,w)})));this.own(k(L,"keypress",g.hitch(this,function(R){(R.charCode||R.keyCode)===S.ENTER&&(R=parseInt(u.get(b,"rowIndex"),10),this._updateParcelValues(L,
R,w));setTimeout(g.hitch(this,function(){L.validate(!1)}),100)})))},_createRow:function(b,c){var q=x.create("div",{"class":"dojoDndItem esriCTRow",rowIndex:c});var w=x.create("div",{rowIndex:c},q);this._createLineSelector(w,b.LineSymbol,c);w=this._getBearingAccordingToPlanSettings(b.BearingConversions);b.isTB&&(w="*"+w);this._createFieldInputs(q,w,"esriCTBearingRow");b.RadiusConversions?(w=this._getRoundedValue(b.RadiusConversions,"Radius"),b="radiusAndArcLength"===this._planSettings.circularCurveParameters?
this._getRoundedValue(b.ArcLengthConversions,"Length"):this._getRoundedValue(b.ChordLengthConversions,"Length")):(w="",b=this._getRoundedValue(b.LengthConversions,"Length"));this._createFieldInputs(q,b,"esriCTLengthRow");this._createFieldInputs(q,w,"esriCTRadiusRow");this._createDeleteButton(q,c);this._nodes.push(q);this._dndContainer.clearItems();this._dndContainer.insertNodes(!1,this._nodes)},_createLineSelector:function(b,c,q){var w=new O({hideOnSelect:!0,symbolData:this.config.lineTypes,tabindex:"0",
"aria-label":this.nls.newTraverse.lineTypeLabel,role:"button","aria-haspopup":"true"},b);e.add(w.domNode,"esriCTSymbolContainer");c?(w.selectSymbol(c),u.set(w.domNode,"rowIndex",q),w.onSelect=g.hitch(this,function(L){var R=parseInt(u.get(w.domNode,"rowIndex"),10);this._itemList[R].LineSymbol=L;this.setStartPoint(this.startPoint)})):w.setDefault();return w},_createDeleteButton:function(b,c){var q=x.create("div",{"class":"esriCTDeleteRow"},b);c=x.create("div",{"class":"esriCTDeleteIcon",rowIndex:c,
title:this.nls.traverseSettings.deleteButtonTitle,tabindex:"0",role:"button","aria-label":this.nls.traverseSettings.deleteButtonTitle},q);this.own(k(c,"click",g.hitch(this,function(w){w=parseInt(u.get(w.currentTarget,"rowIndex"),10);this._deleteRow(b,w)})));this.own(k(c,"keydown",g.hitch(this,function(w){if(w.keyCode===S.ENTER||w.keyCode===S.SPACE)w=parseInt(u.get(w.currentTarget,"rowIndex"),10),this._deleteRow(b,w),E.focus(this.bearingNode.focusNode)})))},_deleteRow:function(b,c){var q;if(this._itemList.length){this._dndContainer.delItem(b.id);
x.destroy(b);this._nodes.splice(c,1);this._itemList.splice(c,1);this._dndContainer.sync();this._updateRowIndexes();if(this._itemList[c]&&this._itemList[c].isTB){if(1===this._itemList.length||0===c)this._itemList[0].isTB=!1,c++;1<this._itemList.length&&(q=this._updateTBFromIndex(c))}this.appliedCompassRule?this.setParcelClosure(!0,!0):this.setStartPoint(this.startPoint,!0);q&&this._reGenerateTraverseGrid();this._showHideTraverseTools()}},_updateRowIndexes:function(){var b=M(".esriCTRow",this.traverseGrid);
p.forEach(b,g.hitch(this,function(c,q){var w;this._itemList[q].rowIndex=q;u.set(c,"rowIndex",q);(w=M(".esriCTDeleteIcon",c)[0])&&u.set(w,"rowIndex",q);(c=M(".esriCTSymbolContainer",c)[0])&&u.set(c,"rowIndex",q)}))},_onDndDrop:function(){var b=[];this._dndContainer.sync();var c=this._dndContainer.getAllNodes();c.forEach(g.hitch(this,function(w,L){w=parseInt(u.get(w,"rowIndex"),10);b.push(this._itemList[w])}));this._nodes=c;this._itemList=[];this._itemList=b;this._updateRowIndexes();for(c=0;c<this._itemList.length;c++){if(0===
c&&this._itemList[c].isTB){this._itemList[c].isTB=!1;var q=!0}this._itemList[c]&&this._itemList[c].isTB&&(this._itemList[c]=this._setTangentBearing(this._itemList[c],this._itemList[c-1]),q=!0)}this.setStartPoint(this.startPoint,!0);q&&this._reGenerateTraverseGrid()},_updateParcelValues:function(b,c,q){var w,L=!1;if(w=this._itemList[c]){var R=(R=b.get("value"))?g.trim(R.toString()):"";if(e.contains(b.domNode,"esriCTBearingRow")&&String(this._getBearingAccordingToPlanSettings(w.BearingConversions))!==
R){var X="Bearing";w.Bearing=R;L=!0;-1===R.indexOf("*")&&(w.isTB=!1)}else e.contains(b.domNode,"esriCTLengthRow")&&String(this._getRoundedValue(w.LengthConversions,"Length"))!==R?(X="Length",w.Length=R,L=!0):e.contains(b.domNode,"esriCTRadiusRow")&&String(w.Radius)!==R&&(w.RadiusConversions?String(this._getRoundedValue(w.RadiusConversions,"Radius"))!==R&&(X="Radius",w.Radius=R,L=!0):(X="Radius",w.Radius=R,L=!0));if(L)if(R=this._getValidatedValues(w,X,c)){if("Bearing"===X){X=this._getBearingAccordingToPlanSettings(R.BearingConversions);
w.Bearing=this._getBearingAccordingToPlanSettings(R.BearingConversions,!0);w.isTB&&(X="*"+X);b.set("value",X);var da=this._updateTBFromIndex(c+1)}else"Length"===X?(X=this._getRoundedValue(w.LengthConversions,"Length"),w.Length=w.LengthConversions[this._planSettings.distanceAndLengthUnits],w.RadiusConversions&&(w=this._createValuesForArc(w)),b.set("value",X),da=this._updateTBFromIndex(c)):"Radius"===X&&(w.RadiusConversions?(w.Radius=w.RadiusConversions[this._planSettings.distanceAndLengthUnits],X=
this._getRoundedValue(w.RadiusConversions,"Radius")):X=w.Radius="",w=this._createValuesForArc(w),b.set("value",X),da=this._updateTBFromIndex(c));this.appliedCompassRule?this.setParcelClosure(!0,!0):this.setStartPoint(this.startPoint,!0);if(da||q)this._reGenerateTraverseGrid(),q&&this._popupCoords&&this._openPopup(this._popupCoords)}else this._updateValues(w,X,b)}},_updateValues:function(b,c,q){if("Bearing"===c){b.Bearing=this._getBearingAccordingToPlanSettings(b.BearingConversions,!0);var w=this._getBearingAccordingToPlanSettings(b.BearingConversions)}else"Length"===
c?(b.Length=b.LengthConversions[this._planSettings.distanceAndLengthUnits],w=this._getRoundedValue(b.LengthConversions,"Length")):"Radius"===c&&(b.RadiusConversions?(b.Radius=b.RadiusConversions[this._planSettings.distanceAndLengthUnits],w=this._getRoundedValue(b.RadiusConversions,"Radius")):w=b.Radius="");q.set("value",w)},_showHideTraverseTools:function(){this._itemList&&0<this._itemList.length?(e.remove(this.expandCollapseNode,"esriCTHidden"),e.remove(this.zoomToNode,"esriCTHidden")):(e.add(this.expandCollapseNode,
"esriCTHidden"),e.add(this.zoomToNode,"esriCTHidden"))},_getBearingAccordingToPlanSettings:function(b,c){if("northAzimuth"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return c?b.naDD:b.naDDRound;if("northAzimuth"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return b.naDMS;if("southAzimuth"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return c?
b.saDD:b.saDDRound;if("southAzimuth"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return b.saDMS;if("quadrantBearing"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return c?b.qb3DD:b.qb3DDRound;if("quadrantBearing"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return b.qb3DMS},_getRoundedValue:function(b,c){b=b[this._planSettings.distanceAndLengthUnits];
switch(c){case "Length":var q=this.lengthFieldPlaces;break;case "Radius":q=this.radiusFieldPlaces;break;case "MiscloseDistance":q=this.miscloseDistanceFieldPlaces}return Q.honourPopupRounding(q,b)},_resetEntryRow:function(b){this.bearingNode.set("value","");this.lengthNode.set("value","");this.radiusNode.set("value","");this.bearingNode.reset();this.lengthNode.reset();this.radiusNode.reset();0<this._itemList.length&&(b=this._itemList[this._itemList.length-1].isTB?"*tb":b?this._getBearingAccordingToPlanSettings(this._itemList[this._itemList.length-
1].BearingConversions):this._itemList[this._itemList.length-1].Bearing,this.bearingNode.set("value",b),this.bearingNode.textbox.setSelectionRange(0,b.length))},_reGenerateTraverseGrid:function(){this._dndContainer&&(this._dndContainer.destroy(),this._dndContainer=null);x.empty(this.traverseGrid);this._createTraverseGrid()},_showRotationPoint:function(){var b=this.startPoint;if(this.config.startOrRotaionSymbol)var c=T.fromJson(this.config.startOrRotaionSymbol);else{var q={color:[136,136,136,255],size:11.25,
angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[29,29,53,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}};c=T.fromJson(q)}this._rotationPointInfo&&this._rotationPointInfo.rotationPoint&&(b=this._rotationPointInfo.rotationPoint);4326!==this.map.spatialReference.wkid?C.getProjectedGeometry(b,this.map.spatialReference,this.geometryService).then(g.hitch(this,function(w){w&&(w=new N(w),w.setSymbol(c),this.rotationPointsGraphicsLayer.clear(),this.rotationPointsGraphicsLayer.add(w))})):
(q=new N(b),q.setSymbol(c),this.rotationPointsGraphicsLayer.clear(),this.rotationPointsGraphicsLayer.add(q))},resetRotationPoint:function(b){this._setRotationPoint(0,b)},_setRotationPoint:function(b,c){var q=c;c=new I(4326);C.getProjectedGeometry(q,c,this.geometryService).then(g.hitch(this,function(w){q=w;this._rotationPointInfo={rotationPointIndex:b,rotationPoint:q}}))},_updateStartPointFromRotationPoint:function(){var b=this._rotationPointInfo.rotationPoint,c=this._rotationPointInfo.rotationPointIndex;
if(null!==this._rotationAngle){for(--c;0<=c;c--){var q=this._itemList[c];var w=Number(q.BearingConversions.naDD)+this._rotationAngle;var L=q.LengthConversions.meters;this._scaleValue&&(L*=this._scaleValue);w=Q.getSouthAzimuthFromNorthAzimuth(w);""===q.Radius||"0"===q.Radius||0===q.Radius?b=C.getDestinationPoint(b,w,L):(L=q.RadiusConversions.meters,q=q.ChordLengthConversions.meters,this._scaleValue&&(L*=this._scaleValue,q*=this._scaleValue),b=this.getArcInfo(b,w,L,q),b=b.endPoint)}this.setStartPoint(b)}},
_reDrawParcel:function(){this.parcelLinesGraphicsLayer.clear();this.parcelPointsGraphicsLayer.clear();this._arrayOfAllBoundaryLines=[];this._drawPoint(this.startPoint);p.forEach(this._itemList,g.hitch(this,function(b){""===b.Radius||"0"===b.Radius||0===b.Radius?this._drawStraightLine(b,!1):this._drawArc(b,!1)}));this._setExtentToLayer(this.parcelLinesGraphicsLayer);this.setParcelClosure()},setStartPoint:function(b,c,q,w){var L=new I(4326);C.getProjectedGeometry(b,L,this.geometryService).then(g.hitch(this,
function(R){q&&this._rotationPointInfo?(this._setRotationPoint(this._rotationPointInfo.rotationPointIndex,R),this._updateStartPointFromRotationPoint()):(this.startPoint=R,c&&this.resetRotationPoint(this.startPoint),this._showRotationPoint(),this._startPointForNextLine=g.clone(R),this._orgStartPointForNextLine=g.clone(R),this.appliedCompassRule=!1,0<this._itemList.length?this._reDrawParcel():(this.parcelPointsGraphicsLayer.clear(),this.parcelLinesGraphicsLayer.clear(),this._arrayOfAllBoundaryLines=
[],this._drawPoint(b,w)))}))},_addProjectedGraphic:function(b,c,q,w){var L,R={},X=q.setExtentToLayer,da=q.setParcelClosure,F=q.startNewTraverseBtnClick;R.rowIndex=w?w.rowIndex:b.graphics.length;c.attributes=R;4326!==this.map.spatialReference.wkid?C.getProjectedGeometry(c.geometry,this.map.spatialReference,this.geometryService).then(g.hitch(this,function(G){G&&(L=new N(G),L.setAttributes(R),L.setSymbol(c.symbol),b.add(L),w&&(w.graphic=L),F&&b.graphics&&0<b.graphics.length&&this.map.centerAt(b.graphics[0].geometry),
X&&(this._setExtentToLayer(b),da&&this.setParcelClosure()))})):(b.add(c),F&&b.graphics&&0<b.graphics.length&&this.map.centerAt(b.graphics[0].geometry),X&&(this._setExtentToLayer(b),da&&this.setParcelClosure()))},_drawPoint:function(b,c){b=new N(b,T.fromJson(this.config.pointSymbol));this._addProjectedGraphic(this.parcelPointsGraphicsLayer,b,{setExtentToLayer:!1,setParcelClosure:!1,startNewTraverseBtnClick:c})},_drawLineAndEndPoint:function(b,c,q,w){var L=!0;b?(c=C.getLineBetweenPoints(c))?(c=new N(c,
T.fromJson(q.LineSymbol.symbol)),this._addProjectedGraphic(this.parcelLinesGraphicsLayer,c,{setExtentToLayer:w,setParcelClosure:!0,startNewTraverseBtnClick:!1},q),this._startPointForNextLine=g.clone(b),this.appliedCompassRule&&this.parcelLinesGraphicsLayer.graphics.length===this._itemList.length&&(L=!1),L&&this._drawPoint(b)):this._showMessage(this.nls.newTraverse.unableToDrawLineMessage):this._showMessage(this.nls.newTraverse.invalidEndPointMessage)},setInfoForCalculatingMisclose:function(b,c,q){b.startPoint=
g.clone(this._orgStartPointForNextLine);b.endpoint=g.clone(c);q=C.getLineBetweenPoints(q);if(b.LineSymbol.type===this.config.BoundaryLineType)for(var w=0;w<q.paths.length;w++)this._arrayOfAllBoundaryLines.push(q.paths[w]);this._orgStartPointForNextLine=g.clone(c);return b},getArcInfo:function(b,c,q,w){var L=C.getDestinationPoint(b,c,Math.abs(w));var R=Math.abs(w)/2;var X=C.getDestinationPoint(b,c,R);b={distance:w,radius:q,initBearing:c,chordMidPoint:X,centerAndChordDistance:Math.sqrt(Math.abs(q*q-
R*R)),chordEndPoint:L,chordStartPoint:b};c=C.getArcParam(b);c.startAngle=c.startAngle>c.endAngle?c.startAngle-360:c.startAngle;c=C.getPointsForArc(c.startAngle,c.endAngle,c.centerPoint,q);0===c.length&&(c.push(b.chordStartPoint),c.push(b.chordEndPoint));0>q&&c.reverse();return{endPoint:L,arcGeometryPointsArray:c}},_drawStraightLine:function(b,c){var q=b.BearingConversions.naDD;var w=b.LengthConversions.meters;if(b.adjustedValues&&this.adjustPoints){q=b.adjustedValues.adjustedBearing;if("S"===b.BearingConversions.qb3DDRound.charAt(0)||
0>b.adjustedValues.lat)q=b.adjustedValues.adjustedBearingNADD;w=b.adjustedValues.adjustedLength;this.appliedCompassRule=!0}this._rotationAngle&&(q=Number(q)+this._rotationAngle);this._scaleValue&&(w*=this._scaleValue);var L=C.getDestinationPoint(this._orgStartPointForNextLine,b.BearingConversions.naDD,b.LengthConversions.meters);q=C.getDestinationPoint(this._startPointForNextLine,q,w);b=this.setInfoForCalculatingMisclose(b,L,[this._orgStartPointForNextLine,L]);this._drawLineAndEndPoint(q,[this._startPointForNextLine,
q],b,c)},_drawArc:function(b,c){var q=b.BearingConversions.naDD;var w=b.RadiusConversions.meters;var L=b.ChordLengthConversions.meters;if(b.adjustedValues&&this.adjustPoints){q=b.adjustedValues.adjustedBearing;if("S"===b.BearingConversions.qb3DDRound.charAt(0)||0>b.adjustedValues.lat)q=b.adjustedValues.adjustedBearingNADD;L=b.adjustedValues.adjustedLength;0>b.ChordLengthConversions.meters&&(L*=-1);this.appliedCompassRule=!0}this._rotationAngle&&(q=Number(q)+this._rotationAngle);this._scaleValue&&
(L*=this._scaleValue,w*=this._scaleValue);var R=this.getArcInfo(this._orgStartPointForNextLine,b.BearingConversions.naDD,b.RadiusConversions.meters,b.ChordLengthConversions.meters);b=this.setInfoForCalculatingMisclose(b,R.endPoint,R.arcGeometryPointsArray);w=this.getArcInfo(this._startPointForNextLine,q,w,L);this._drawLineAndEndPoint(w.endPoint,w.arcGeometryPointsArray,b,c)},_setExtentToLayer:function(b,c){this._setExtentTimer&&clearTimeout(this._setExtentTimer);this._setExtentTimer=setTimeout(g.hitch(this,
function(){if(0<b.graphics.length){var q=m.graphicsExtent(b.graphics);!c&&this.map.extent.contains(q)||this.map.setExtent(q.expand(1.5))}}),200)},_showMessage:function(b){this.emit("showMessage",b)},updateAccordingToPlanSettings:function(b){this._planSettings=b;this.bearingNode.set("placeHolder",this._getAbbreviatedUnits(b.directionOrAngleUnits));this.lengthNode.set("placeHolder",this._getAbbreviatedUnits(b.distanceAndLengthUnits));this.radiusNode.set("placeHolder",this._getAbbreviatedUnits(b.distanceAndLengthUnits));
this._reGenerateTraverseGrid();this._misCloseDetailsInstance&&(b=this._misCloseDetailsInstance.getMiscloseDetails())&&(b=this._getMiscloseDetailsAccordingToPlanSettings(b),this._misCloseDetailsInstance.updateAccordingToPlanSettings(b))},deActivateUpdateRotationPointTool:function(){e.remove(this.updateRotationPointNode,"esriCTEnableButton");u.set(this.updateRotationPointNode,"aria-pressed","false")},deActivateDigitizationTool:function(){e.remove(this.screenDigitizationNode,"esriCTEnableButton");u.set(this.screenDigitizationNode,
"aria-pressed","false")},pointAddedFromDigitization:function(b){var c,q,w;var L=new I(4326);C.getProjectedGeometry(b,L,this.geometryService).then(g.hitch(this,function(R){c=C.getAngleBetweenPoints(this._startPointForNextLine,R);360===c&&(c=0);q=C.getDistanceBetweenPoints(this._startPointForNextLine,R);w=this.getAngleFromDDTOQB(c);0===q&&(w="");this.bearingNode.set("value",w);"uSSurveyFeet"===this._planSettings.distanceAndLengthUnits?q=Q.metersToUSSurveyFeet(q):"feet"===this._planSettings.distanceAndLengthUnits&&
(q=Q.metersToFeet(q));0<this._scaleValue&&(q/=this._scaleValue);this.lengthNode.set("value",q);this.radiusNode.set("value","");this._addNewItem(!0)}))},getParcelCloseDetails:function(){var b,c,q,w;var L={isClosed:!1,compassStartPoint:null,compassEndPoint:null};var R=!0;var X=b=c=0;p.forEach(this._itemList,g.hitch(this,function(G,P){G.LineSymbol.type===this.config.BoundaryLineType?(P=G.ChordLengthConversions?G.ChordLengthConversions.meters:G.LengthConversions.meters,0===c?q=G.startPoint:w=G.endpoint,
c++,b+=Math.cos(G.BearingConversions.naDD/180*Math.PI)*P,X+=Math.sin(G.BearingConversions.naDD/180*Math.PI)*P):0<P&&0!==c&&(R=!1)}));if(1<c&&R){var da=Math.sqrt(b*b+X*X);da=C.removeNegativeExponents(da);q.x=Q.showFixedPlacesAfterDecimal(q.x,6);q.y=Q.showFixedPlacesAfterDecimal(q.y,6);w.x=Q.showFixedPlacesAfterDecimal(w.x,6);w.y=Q.showFixedPlacesAfterDecimal(w.y,6);var F=C.getAngleBetweenPoints(w,q);L.isClosed=!0;L.compassStartPoint=q;L.compassEndPoint=w;L.miscloseDistance=da;L.miscloseBearing=F}return L},
setParcelClosure:function(b,c){var q=this.getParcelCloseDetails();if(q.isClosed)q=this.getCalculatedMiscloseDetails(q),this._misCloseDetailsInstance.setMiscloseDetails(q),q.adjustPoints?((this.adjustPoints=this._applyCompassRule(q))&&!this.appliedCompassRule||b)&&this.setStartPoint(this.startPoint,c):(this.adjustPoints=!1,(this.appliedCompassRule||b)&&this.setStartPoint(this.startPoint,c));else if(this._misCloseDetailsInstance.setMiscloseDetails(null),this.adjustPoints=!1,this.appliedCompassRule||
b)this.appliedCompassRule=!1,this.setStartPoint(this.startPoint,c)},_getMiscloseDetailsAccordingToPlanSettings:function(b){var c={};b.BearingConversions&&(c.miscloseBearing=this._getBearingAccordingToPlanSettings(b.BearingConversions));var q=this._getRoundedValue(b.LengthConversions,"MiscloseDistance");c.miscloseDistance=K.localizeNumber(Number(q))+" "+this._getAbbreviatedUnits(this._planSettings.distanceAndLengthUnits);b.AreaConversions?(b=b.AreaConversions[this._planSettings.areaUnits],isNaN(parseFloat(b))||
(b=Q.honourPopupRounding(2,b.toFixed(1)))):b=0;b=K.localizeNumber(Number(b))+" "+this._getAbbreviatedUnits(this._planSettings.areaUnits);c.calculatedArea=b;return c},getCalculatedMiscloseDetails:function(b){var c,q={},w=c=0;w=0;var L=!1;c=b.compassStartPoint;if(b.compassEndPoint&&c){c=b.miscloseDistance;w=b.miscloseBearing;0===c&&(w=0);w=this.getAngleFromDDTOQB(w);if(b=Q.categorizeBearingFormat(w,this._planSettings))q.BearingConversions=b;q.AreaConversions=this._getCalculatedArea();b=this._getMiscloseRatioInfo(c);
w=b.miscloseRatio;q.miscloseValue=b.miscloseValue;c=Q.categorizeLengthFormat(c,"meters");q.LengthConversions=c;c=c[this.config.miscloseSnapDistanceUnit+"Round"];1E5<=w&&(L=!0);q.miscloseRatio=w;q.accuracy=L;q=g.mixin(q,this._getMiscloseDetailsAccordingToPlanSettings(q));if(0<c&&c<=this.config.miscloseSnapDistance||isFinite(w)&&w>=this.config.miscloseRatioSnap)q.adjustPoints=!0,q.compassCompleteLength=b.compassCompleteLength}return q},_getPolygonAtOrigin:function(){var b=new z(0,0,new I(4326)),c=[];
p.forEach(this._itemList,g.hitch(this,function(q){if(q.LineSymbol.type===this.config.BoundaryLineType){if(""===q.Radius||"0"===q.Radius||0===q.Radius){if(q.adjustedValues&&this.adjustPoints){var w=q.adjustedValues.adjustedBearing;if("S"===q.BearingConversions.qb3DDRound.charAt(0)||0>q.adjustedValues.lat)w=q.adjustedValues.adjustedBearingNADD;var L=q.adjustedValues.adjustedLength}else w=q.BearingConversions.naDD,L=q.LengthConversions.meters;q=C.getDestinationPoint(b,w,L);L=C.getLineBetweenPoints([b,
q])}else{if(q.adjustedValues&&this.adjustPoints){w=q.adjustedValues.adjustedBearing;if("S"===q.BearingConversions.qb3DDRound.charAt(0)||0>q.adjustedValues.lat)w=q.adjustedValues.adjustedBearingNADD;L=q.adjustedValues.adjustedLength;0>q.ChordLengthConversions.meters&&(L*=-1)}else w=q.BearingConversions.naDD,L=q.ChordLengthConversions.meters;L=this.getArcInfo(b,w,q.RadiusConversions.meters,L);q=L.endPoint;L=C.getLineBetweenPoints(L.arcGeometryPointsArray)}b=q;for(q=0;q<L.paths.length;q++)c.push(L.paths[q])}}));
return C.getPolygonFromPolyLines(c,!0)},_getCalculatedArea:function(){var b;if(this._arrayOfAllBoundaryLines&&0<this._arrayOfAllBoundaryLines.length&&(b=this._getPolygonAtOrigin())){var c=new N(b);this.parcelPolygonGraphicsLayer.clear();this.parcelPolygonGraphicsLayer.add(c);c=C.getAreaOfGeometry(b)}return c},_applyCompassRule:function(b){var c,q;var w=q=0;var L={};for(c=0;c<this._itemList.length;c++){var R=this._itemList[c];if(R.LineSymbol.type===this.config.BoundaryLineType){if(""===R.Radius||"0"===
R.Radius||0===R.Radius)var X=R.LengthConversions.meters;else R.ChordLengthConversions&&(X=R.ChordLengthConversions.meters);X=Math.abs(X);R.lat=X*Math.cos(Math.PI/180*R.BearingConversions.naDD);R.dep=X*Math.sin(Math.PI/180*R.BearingConversions.naDD);q+=R.lat;w+=R.dep}}L.sumOfLat=q;L.sumOfDep=w;L.sumOfAllLinesLength=b.compassCompleteLength;for(c=0;c<this._itemList.length;c++)R=this._itemList[c],""===R.Radius||"0"===R.Radius||0===R.Radius?X=R.LengthConversions.meters:R.ChordLengthConversions&&(X=R.ChordLengthConversions.meters),
X=Math.abs(X),R.LineSymbol.type===this.config.BoundaryLineType&&(R.adjustedValues=this._adjustBearingAndDistance(R.lat,R.dep,X,L));for(c=X=b=0;c<this._itemList.length;c++)R=this._itemList[c],R.LineSymbol.type===this.config.BoundaryLineType&&(b+=parseFloat(R.adjustedValues.lat.toFixed(2)),X+=parseFloat(R.adjustedValues.dep.toFixed(2)),b=parseFloat(b.toFixed(2)),X=parseFloat(X.toFixed(2)));return 0===parseInt(b,10)&&0===parseInt(X,10)?!0:!1},_adjustBearingAndDistance:function(b,c,q,w){var L={};b=parseFloat(b.toFixed(6));
c=parseFloat(c.toFixed(6));q=parseFloat(q.toFixed(6));var R=-w.sumOfLat/w.sumOfAllLinesLength*q;q*=-w.sumOfDep/w.sumOfAllLinesLength;R=parseFloat(R.toFixed(6));q=parseFloat(q.toFixed(6));c+=q;b=parseFloat((b+R).toFixed(6));c=parseFloat(c.toFixed(6));R=Math.sqrt(Math.pow(b,2)+Math.pow(c,2));q=Math.atan(c/b);q=parseFloat(q.toFixed(6));L.lat=b;L.dep=c;L.adjustedLength=R;L.adjustedBearing=180/Math.PI*q;b=Q.categorizeBearingFormat(L.adjustedBearing,{directionOrAngleType:"southAzimuth",directionOrAngleUnits:"decimalDegree"});
L.adjustedBearingNADD=b.naDD;return L},_getMiscloseRatioInfo:function(b){var c,q=c=0;var w=0;this._arrayOfAllBoundaryLines&&0<this._arrayOfAllBoundaryLines.length&&(c=C.getPolyLineFromPaths(this._arrayOfAllBoundaryLines),c=C.getLengthOfGeometry(c),0<c&&(q=1/(b/c),10>q?q=0:1E5>q&&(w=parseInt(q,10),q="1:"+parseInt(q,10))));return{miscloseRatio:q,miscloseValue:w,compassCompleteLength:c}},getAngleFromDDTOQB:function(b){var c;var q=g.clone(this._planSettings);q.directionOrAngleType="northAzimuth";q.directionOrAngleUnits=
"decimalDegree";(b=Q.categorizeBearingFormat(b,q))&&(c="degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits?b.qb3DMS:b.qb3DD);return c},initEditing:function(b,c,q){var w;this._planInfoInstance.setParcelInformation(this.polygonDeleteArr,c.features);var L=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.rotation.name];(w=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.scale.name])||(w=1);var R=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.statedArea.name];
this._parcelToolInstance.setRotation(L);this._parcelToolInstance.setScale(w);null!==R&&void 0!==R&&this._misCloseDetailsInstance.traverseStatedArea.set("value",R);w=[];var X=C.getUnitValueForSR(q);var da=g.clone(this._planSettings);da.directionOrAngleType="northAzimuth";da.directionOrAngleUnits="decimalDegree";for(q=0;q<c.features.length;q++)if(L={},L.Bearing=c.features[q].attributes[this.config.polylineLayer.bearing.name],null!==L.Bearing&&void 0!==L.Bearing&&""!==L.Bearing){L.BearingConversions=
Q.categorizeBearingFormat(L.Bearing,da);L.Bearing=this._getBearingAccordingToPlanSettings(L.BearingConversions,!0);L.Length=c.features[q].attributes[this.config.polylineLayer.distance.name];null!==L.Length&&""!==L.Length&&(L.LengthConversions=this._validateLength(L.Length,X),L.Length=L.LengthConversions[this._planSettings.distanceAndLengthUnits]);if(R=this.getLineSymbolForType(c.features[q].attributes[this.config.polylineLayer.lineType.name]))L.LineSymbol=R;L.Radius=c.features[q].attributes[this.config.polylineLayer.radius.name];
null!==L.Radius&&""!==L.Radius?(L.RadiusConversions=this._validateLength(L.Radius,X),L.Radius=L.RadiusConversions[this._planSettings.distanceAndLengthUnits],L.ArcLength=c.features[q].attributes[this.config.polylineLayer.arcLength.name],null!==L.ArcLength&&""!==L.ArcLength&&(L.ArcLengthConversions=this._validateLength(L.ArcLength,X),L.ArcLength=L.ArcLengthConversions[this._planSettings.distanceAndLengthUnits]),L.ChordLength=c.features[q].attributes[this.config.polylineLayer.chordLength.name],null!==
L.ChordLength&&""!==L.ChordLength&&(L.ChordLengthConversions=this._validateLength(L.ChordLength,X),L.ChordLength=L.ChordLengthConversions[this._planSettings.distanceAndLengthUnits]),"radiusAndArcLength"===this._planSettings.circularCurveParameters?(L.Length=L.ArcLength,L.LengthConversions=g.clone(L.ArcLengthConversions)):(L.Length=L.ChordLength,L.LengthConversions=g.clone(L.ChordLengthConversions))):(L.Radius="",L.RadiusConversions=null);L.rowIndex=w.length;w.push(L)}this._itemList=w;this._reGenerateTraverseGrid();
this._showHideTraverseTools();this.setStartPoint(b,!0);this.setBoundaryLineSymbol()},setBoundaryLineSymbol:function(){this._symbolSelector&&p.some(this.config.lineTypes,g.hitch(this,function(b){if(this.config.BoundaryLineType===b.type)return this._symbolSelector.selectSymbol(b),!1}))},getLineSymbolForType:function(b){var c;p.some(this.config.lineTypes,g.hitch(this,function(q){if(q.type===b)return c=g.clone(q),!0}));return c},deactivateParcelTools:function(){this._parcelToolInstance.disableRotating();
this._parcelToolInstance.disableScaling()},clearAll:function(){this.parcelLinesGraphicsLayer.clear();this.parcelPointsGraphicsLayer.clear();this.parcelPolygonGraphicsLayer.clear();this.rotationPointsGraphicsLayer.clear();this._resetEntryRow();this._dndContainer.clearItems();x.empty(this.traverseGrid);this._itemList=[];this._nodes=[];this._showHideTraverseTools();this._orgStartPointForNextLine=this._startPointForNextLine=this.startPoint=null;this._rotationAngle=0;this._scaleValue=1;this._symbolSelector.setDefault();
e.remove(this.screenDigitizationNode,"esriCTEnableButton");e.remove(this.updateRotationPointNode,"esriCTEnableButton");this._parcelToolInstance.resetTools();this.deactivateParcelTools();this._misCloseDetailsInstance.setMiscloseDetails(null);this._arrayOfAllBoundaryLines=[];this.polygonDeleteArr=[];this.polylineDeleteArr=[];this.domNode.scrollTop=0;this._planInfoInstance.resetValues();this._misCloseDetailsInstance.traverseStatedArea.set("value",null);this._rotationPointInfo=null;this.closePopup()},
_showParcelPopup:function(b){var c=[];var q=new a;var w=this._pointToExtent(b.mapPoint,8);c=p.filter(this.parcelLinesGraphicsLayer.graphics,function(L){return w.intersects(L.geometry)});c[0]?(this._createPopupContent(b,c[0]),q.resolve(!0)):(this.closePopup(),q.resolve(!1));return q},_getAbbreviatedUnits:function(b){return window.jimuNls.units[b+"Abbr"]},_pointToExtent:function(b,c){var q=this.map.extent.getWidth()/this.map.width;c*=q;return new f(b.x-c,b.y-c,b.x+c,b.y+c,this.map.spatialReference)},
_createPopupContent:function(b,c){var q;if(q=this._itemList[c.attributes.rowIndex]){var w=x.create("div",{"class":"esriCTParcelInfoPopup "+this.baseClass},null);var L=x.create("div",{"class":"esriCTLabelRows"},w);this._createFieldLabels(L,this.nls.traverseSettings.bearingLabel);this._createFieldLabels(L,this.nls.traverseSettings.lengthLabel);this._createFieldLabels(L,this.nls.traverseSettings.radiusLabel);c=x.create("div",{"class":"esriCTRowContainer esriCTRow",rowIndex:c.attributes.rowIndex},w);
this._createFieldInputs(c,this._getBearingAccordingToPlanSettings(q.BearingConversions),"esriCTBearingRow",!0);(L=q.RadiusConversions)?(L=this._getRoundedValue(q.RadiusConversions,"Radius"),q="radiusAndArcLength"===this._planSettings.circularCurveParameters?this._getRoundedValue(q.ArcLengthConversions,"Length"):this._getRoundedValue(q.ChordLengthConversions,"Length")):(L="",q=this._getRoundedValue(q.LengthConversions,"Length"));this._createFieldInputs(c,q,"esriCTLengthRow",!0);this._createFieldInputs(c,
L,"esriCTRadiusRow",!0);J.position(this.traverseEntryNode)&&J.position(this.traverseEntryNode).w&&(q=J.position(this.traverseEntryNode).w-42,D.set(this._popupDialog.domNode,"width",q+"px"));this._popupDialog.setContent(w);this._popupCoords={pageX:b.pageX,pageY:b.pageY};this._openPopup(b)}},_openPopup:function(b){D.set(this._popupDialog.domNode,"opacity",.9);A.open({popup:this._popupDialog,x:b.pageX,y:b.pageY})},closePopup:function(){this._popupDialog&&A.close(this._popupDialog)},_createFieldLabels:function(b,
c){x.create("div",{innerHTML:c,title:c,"class":"esriCTParcelInfoLabels"},b)},_createTooltip:function(){this._popupDialog=new W({"class":"esriCTEditParcelDialog"});this._popupDialog.startup()},validateNumericField:function(b,c){var q=/^[-+]?[0-9]+\.[0-9]+$/,w=/^[-+]?[0-9]+$/;b=g.trim(b);switch(c){case "esriFieldTypeSmallInteger":c=parseInt(b,10);var L=b.match(w)&&-32768<=c&&32767>=c&&0!==b.length?!0:!1;break;case "esriFieldTypeInteger":c=parseInt(b,10);L=b.match(w)&&-2147483648<=c&&2147483647>=c&&
0!==b.length?!0:!1;break;case "esriFieldTypeSingle":c=parseFloat(b);L=(b.match(w)||b.match(q))&&c>=-3.4*Math.pow(10,38)&&c<=1.2*Math.pow(10,38)&&0!==b.length?!0:!1;break;case "esriFieldTypeDouble":c=parseFloat(b),L=(b.match(w)||b.match(q))&&c>=-2.2*Math.pow(10,308)&&c<=1.8*Math.pow(10,38)&&0!==b.length?!0:!1}return L},updateLastNodeInTraversePanel:function(){this._planInfoInstance.setPlanInfoCancelBtnAsLastNode()},_showParcelSavedAndDeleteMsg:function(b){this.emit("showParcelSavedAndDeleteMsg",b)}})})},
"widgets/ParcelDrafter/SymbolSelector":function(){define("dojo/_base/declare jimu/BaseWidget dojo/_base/lang dojo/on dojo/dom-construct dojo/_base/array jimu/symbolUtils esri/symbols/jsonUtils dijit/popup dijit/TooltipDialog dojo/_base/html dojo/keys dojo/query dijit/focus".split(" "),function(H,d,h,l,n,g,p,e,x,D,y,k,r,O){return H([d],{_tooltipDialog:null,selectedSymbol:null,symbolData:[],constructor:function(B){h.mixin(this,B)},postCreate:function(){this.symbolData||(this.symbolData=[]);this._createSelectedSymbolNode();
this._hideTooltipDialog();this.symbolData&&0<this.symbolData.length&&(this._createTooltipDialog(),this.symbolData[1].isDefault?this.selectSymbol(this.symbolData[1]):this.selectSymbol(this.symbolData[0]));this.own(l(document.body,"click",h.hitch(this,function(B){this.isPartOfPopup(B.target||B.srcElement)||this._hideTooltipDialog()})))},setDefault:function(){this.symbolData&&1<this.symbolData.length&&this.symbolData[1].isDefault?this.selectSymbol(this.symbolData[1]):this.selectSymbol(this.symbolData[0])},
_createSelectedSymbolNode:function(){var B=n.create("div",{},this.domNode);this.selectedSymbolNode=n.create("div",{"class":"esriCTSelectedSymbol"},B)},_createTooltipDialog:function(){var B=this._createSymbolListMenu();this._tooltipDialog=new D({content:B,"class":"esriCTSymbolPopup"});this.own(l(this.domNode,"click",h.hitch(this,function(t){t.stopPropagation();t.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(l(this.domNode,"keydown",h.hitch(this,
function(t){if(t.keyCode===k.ENTER||t.keyCode===k.SPACE)this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(l(document.body,"click",h.hitch(this,function(t){this.isPartOfPopup(t.target||t.srcElement)||this._hideTooltipDialog()})))},_createSymbolListMenu:function(){var B=n.create("div",{"class":"esriCTSymbolListContainer"},null);var t=n.create("div",{"class":"esriCTSymbolListContent",role:"menu"},B);g.forEach(this.symbolData,h.hitch(this,function(v){var C=n.create("div",
{"class":"esriCTSymbolOption",title:v.label,tabindex:"0",role:"menuitem","aria-label":v.label},t);this._attachRowClick(C,v);var Q=n.create("div",{"class":"esriCTSymbolIcon"},C);n.create("div",{"class":"esriCTSymbolName",innerHTML:v.label},C);C=n.create("div",{},Q);this._createSymbol(v,C)}));return B},_attachRowClick:function(B,t){this.own(l(B,"click",h.hitch(this,function(){this.selectSymbol(t);this.hideOnSelect&&this._hideTooltipDialog()})));this.own(l(B,"keydown",h.hitch(this,function(v){if(v.keyCode===
k.ENTER||v.keyCode===k.SPACE||v.keyCode===k.ESCAPE)this.selectSymbol(t),this.hideOnSelect&&(this._hideTooltipDialog(),O.focus(this.domNode))})))},_createSymbol:function(B,t){B&&(B=e.fromJson(B.symbol),(B=p.createSymbolNode(B))||(B=n.create("div")),n.place(B,t))},selectSymbol:function(B){n.empty(this.selectedSymbolNode);this.selectedSymbol={label:B.label||B.type,type:B.type,symbol:B.symbol};this._createSymbol(this.selectedSymbol,this.selectedSymbolNode);this.onSelect(B)},destroy:function(){x.close(this._tooltipDialog);
this._tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(B){var t=this._tooltipDialog.domNode;return B===t||y.isDescendant(B,t)},onSelect:function(B){return B},_showTooltipDialog:function(){x.open({parent:this.getParent(),popup:this._tooltipDialog,around:this.domNode,"class":"esriCTSymbolPopup"});this._isTooltipDialogOpened=!0;this.focusFirstSymbolOption()},_hideTooltipDialog:function(){x.close(this._tooltipDialog);this._isTooltipDialogOpened=!1},focusFirstSymbolOption:function(){var B=
r(".esriCTSymbolOption",this._tooltipDialog.domNode);O.focus(B[0])}})})},"widgets/ParcelDrafter/MiscloseDetails":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./MiscloseDetails.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/dom-attr".split(" "),function(H,d,h,l,n,g,p,e){return H([d,h,g],{baseClass:"jimu-widget-ParcelDrafter-MisclosedDetails",templateString:l,details:null,constructor:function(x){n.mixin(this,x)},postCreate:function(){this.inherited(arguments);
p.add(this.domNode,"esriCTFullWidth");this.config.polygonLayer.statedArea&&this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(p.remove(this.traverseStatedAreaNode,"esriCTHidden"),this.traverseStatedArea.trim=!0,this.config.polygonLayer.statedArea.nullable||(this.traverseStatedArea.required=!0),0<=this.numberFieldTypes.indexOf(this.config.polygonLayer.statedArea.type)&&(this.traverseStatedArea.validator=n.hitch(this,function(x){return!this.config.polygonLayer.statedArea.nullable&&(null===
x||""===x)||""!==x&&!this.validateNumericField(x,this.config.polygonLayer.statedArea.type)?!1:!0})));this._setBackgroundColorForDartTheme()},_setBackgroundColorForDartTheme:function(){"DartTheme"===this.appConfig.theme.name&&p.add(this.traverseDetailsContainer,"esriCTMiscloseHeaderDiv")},getMiscloseDetails:function(){return this.details},updateAccordingToPlanSettings:function(x){e.set(this.miscloseBearingNode,"innerHTML",x.miscloseBearing);e.set(this.miscloseDistanceNode,"innerHTML",x.miscloseDistance);
e.set(this.calculatedAreaNode,"innerHTML",x.calculatedArea)},setMiscloseDetails:function(x){(this.details=x)?(e.set(this.miscloseBearingNode,"innerHTML",x.miscloseBearing),e.set(this.miscloseDistanceNode,"innerHTML",x.miscloseDistance),0!==x.miscloseRatio?(p.remove(this.traverseMiscloseRatioNode,"esriCTHidden"),e.set(this.miscloseRatioNode,"innerHTML",x.miscloseRatio)):p.add(this.traverseMiscloseRatioNode,"esriCTHidden"),x.accuracy?(p.add(this.traverseMiscloseRatioNode,"esriCTHidden"),p.remove(this.traverseAccuracyNode,
"esriCTHidden")):p.add(this.traverseAccuracyNode,"esriCTHidden"),x.calculatedArea?(e.set(this.calculatedAreaNode,"innerHTML",x.calculatedArea),p.remove(this.traverseCalculatedAreaNode,"esriCTHidden")):p.add(this.traverseCalculatedAreaNode,"esriCTHidden"),p.add(this.noMiscloseCalculated,"esriCTHidden"),p.remove(this.miscloseDetailsContainer,"esriCTHidden"),x.adjustPoints?p.remove(this.compassRuleAppliedHint,"esriCTHidden"):p.add(this.compassRuleAppliedHint,"esriCTHidden")):(p.add(this.miscloseDetailsContainer,
"esriCTHidden"),p.remove(this.noMiscloseCalculated,"esriCTHidden"))}})})},"widgets/ParcelDrafter/ParcelTools":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./ParcelTools.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/dom-attr dojo/on dojo/keys dijit/form/NumberTextBox".split(" "),function(H,d,h,l,n,g,p,e,x,D){return H([d,h,g],{baseClass:"jimu-widget-ParcelDrafter-ParcelTools",templateString:l,rotationAngle:0,scaledValue:1,constructor:function(y){n.mixin(this,
y)},postCreate:function(){this.inherited(arguments);p.add(this.domNode,"esriCTFullWidth");this.rotationTxt.constraints={min:-360,max:360,places:3};this.scaleTxt.constraints={min:.1,places:3};this.rotationTxt.set("value",this.rotationAngle);this.scaleTxt.set("value",this.scaledValue);this.own(x(this.rotationTxt,"blur",n.hitch(this,function(){this.setRotation(this.rotationTxt.displayedValue)})));this.own(x(this.scaleTxt,"blur",n.hitch(this,function(){this.setScale(this.scaleTxt.displayedValue)})));
this.canProjectLocally?(this.own(x(this.rotateButton,"click",n.hitch(this,function(){this._toggleRotating()}))),this.own(x(this.rotateButton,"keydown",n.hitch(this,function(y){if(y.keyCode===D.ENTER||y.keyCode===D.SPACE)y.preventDefault(),this._toggleRotating()}))),this.own(x(this.scaleButton,"click",n.hitch(this,function(){this._toggleScaling()}))),this.own(x(this.scaleButton,"keydown",n.hitch(this,function(y){if(y.keyCode===D.ENTER||y.keyCode===D.SPACE)y.preventDefault(),this._toggleScaling()})))):
(p.add(this.rotateButton,"esriCTDisabledParcelToolButton"),e.set(this.rotateButton,"tabindex","-1"),p.add(this.scaleButton,"esriCTDisabledParcelToolButton"),e.set(this.scaleButton,"tabindex","-1"));this.own(x(this.rotationTxt,"keypress",n.hitch(this,function(y){(y.charCode||y.keyCode)===D.ENTER&&this.setRotation(this.rotationTxt.displayedValue)})));this.own(x(this.scaleTxt,"keypress",n.hitch(this,function(y){(y.charCode||y.keyCode)===D.ENTER&&this.setScale(this.scaleTxt.displayedValue)})))},setScale:function(y){var k=
this.scaledValue;isNaN(Number(y))||this.scaleTxt.set("value",Number(y));this.scaleTxt.isValid()?this.scaleGeometries():this.scaleTxt.set("value",Number(k))},scaleGeometries:function(){var y=Number(this.scaleTxt.get("value"));isNaN(y)||(this.scaledValue=y,this.emit("scaleGeometries",y))},setRotation:function(y){var k=this.rotationAngle;isNaN(Number(y))||this.rotationTxt.set("value",Number(y));this.rotationTxt.isValid()?this.rotateGeometries():this.rotationTxt.set("value",Number(k))},rotateGeometries:function(){var y=
Number(this.rotationTxt.get("value"));isNaN(y)||(this.rotationAngle=y,this.emit("rotateGeometries",y))},resetTools:function(){this.rotationAngle=0;this.scaledValue=1;this.rotationTxt.set("value",Number(0));this.scaleTxt.set("value",Number(1))},_toggleRotating:function(){p.contains(this.rotateButton.parentElement,"esriCTDisableButton")?(p.remove(this.rotateButton.parentElement,"esriCTDisableButton"),e.set(this.rotateButton,"aria-pressed","true"),this.disableScaling(),this.emit("toggleRotating",!0)):
(this.disableRotating(),this.emit("toggleRotating",!1))},_toggleScaling:function(){p.contains(this.scaleButton.parentElement,"esriCTDisableButton")?(p.remove(this.scaleButton.parentElement,"esriCTDisableButton"),e.set(this.scaleButton,"aria-pressed","true"),this.disableRotating(),this.emit("toggleScaling",!0)):(this.disableScaling(),this.emit("toggleScaling",!1))},disableRotating:function(){p.add(this.rotateButton.parentElement,"esriCTDisableButton");e.set(this.rotateButton,"aria-pressed","false")},
disableScaling:function(){p.add(this.scaleButton.parentElement,"esriCTDisableButton");e.set(this.scaleButton,"aria-pressed","false")}})})},"widgets/ParcelDrafter/PlanInfo":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./PlanInfo.html dojo/_base/lang dojo/_base/array dojo/Evented dojo/dom-attr dojo/dom-construct dojo/dom-class dojo/dom-style dojo/query dijit/registry dijit/form/ValidationTextBox dojo/store/Memory dijit/form/ComboBox dojo/on esri/geometry/Polyline esri/graphic esri/tasks/query esri/tasks/QueryTask esri/dijit/AttributeInspector esri/layers/FeatureLayer jimu/dijit/Message ./geometryUtils jimu/utils jimu/LayerInfos/LayerInfos dojo/keys dojo/aspect".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v,C,Q,N,T,U,m,u,M,I,S,E,W){return H([d,h,p],{baseClass:"jimu-widget-ParcelDrafter-PlanInfo",templateString:l,_itemList:null,_polygonLayer:null,parcelNameTextBox:null,planNameTextBox:null,documentTypeControl:null,planSettings:null,_savedPolygonObjectId:null,_savedPolyLines:null,fieldInfosForPolygonLayer:null,constructor:function(A){n.mixin(this,A)},postCreate:function(){this.inherited(arguments);S.getInstance(this.map,this.map.itemInfo).then(n.hitch(this,function(A){this._layerInfosObj=
A;this._init()}))},_init:function(){if(0<this._getFieldInfosForPolygonLayer().length)if(this._addGraphicToLocalLayer(),this.config.polygonLayer.attributeListTitle){var A=I.sanitizeHTML(this.config.polygonLayer.attributeListTitle);e.set(this.attributeListTitle,"innerHTML",A)}else A=this._layerInfosObj.getLayerInfoById(this.config.polygonLayer.id),e.set(this.attributeListTitle,"innerHTML",A.layerObject.name);else D.add(this.expandCollapseParentNode,"esriCTHidden");D.add(this.domNode,"esriCTFullWidth");
this.own(v(this.planInfoCancelButton,"click",n.hitch(this,function(){this.emit("cancelTraversedParcel")})));this.own(v(this.planInfoCancelButton,"keydown",n.hitch(this,function(a){a.keyCode!==E.ENTER&&a.keyCode!==E.SPACE||this.emit("cancelTraversedParcel")})));this.own(v(this.planInfoSaveButton,"click",n.hitch(this,function(){this.emit("saveTraversedParcel")})));this.own(v(this.planInfoSaveButton,"keydown",n.hitch(this,function(a){a.keyCode!==E.ENTER&&a.keyCode!==E.SPACE||this.emit("saveTraversedParcel")})));
this.own(v(this.planInfoDeleteButton,"click",n.hitch(this,this.deleteParcel)));this.own(v(this.planInfoDeleteButton,"keydown",n.hitch(this,function(a){a.keyCode!==E.ENTER&&a.keyCode!==E.SPACE||this.deleteParcel()})));this.own(v(this.expandCollapseNode,"click",n.hitch(this,this._onExpandCollapseClicked)));this.own(v(this.expandCollapseNode,"keydown",n.hitch(this,function(a){if(a.keyCode===E.ENTER||a.keyCode===E.SPACE)a.preventDefault(),this._onExpandCollapseClicked()})))},_onExpandCollapseClicked:function(){D.toggle(this.expandCollapseNode,
"esriCTCollapsedParceLayer");D.toggle(this.attributeListNode,"esriCTHidden");var A=this.nls.planInfo.showAttributeList;D.contains(this.expandCollapseNode,"esriCTCollapsedParceLayer")&&(A=this.nls.planInfo.hideAttributeList);e.set(this.expandCollapseNode,"aria-label",A);e.set(this.expandCollapseNode,"title",A)},resetValues:function(){D.contains(this.expandCollapseNode,"esriCTCollapsedParceLayer")&&this._onExpandCollapseClicked();this._addGraphicToLocalLayer();this.parcelNameTextBox&&this.parcelNameTextBox.set("value",
"");this.planNameTextBox&&this.planNameTextBox.set("value","");this.documentTypeControl&&(this.config.polygonLayer.documentType.domain?this.documentTypeControl.set("item",null):this.documentTypeControl.set("value",""));D.add(this.planInfoDeleteButton,"esriCTHidden")},_showMessage:function(A){this.emit("showMessage",A)},_createDocumentTypeControl:function(){this.config.polygonLayer.documentType.domain?(this.documentTypeControl=this._createFieldSelect(this.config.polygonLayer.documentType,this.documentType,
this.nls.planInfo.parcelDocumentTypeText,!this.config.polygonLayer.documentType.nullable),this.own(v(this.documentTypeControl,"change",n.hitch(this,function(A){""===A||null===A||void 0===A||this.documentTypeControl.store.data.some(function(a){return a.name===A})||(this.documentTypeControl.set("item",null),this._showMessage(this.nls.planInfo.enterValidDocumentTypeMessage))})))):this.documentTypeControl=this._createFieldInputs(this.config.polygonLayer.documentType,this.documentType,this.nls.planInfo.parcelDocumentTypeText,
!this.config.polygonLayer.documentType.nullable)},_createFieldInputs:function(A,a,f,z){A.alias&&(f=A.alias);f=z?f+" "+this.nls.planInfo.requiredText:f+" "+this.nls.planInfo.optionalText;f=new O({placeHolder:f,"class":"esriCTFullWidth",required:z,"aria-label":f});0<=this.numberFieldTypes.indexOf(A.type)&&(f.validator=n.hitch(this,function(J){return""===J||this.validateNumericField(J,A.type)?!0:!1}));f.placeAt(a);return f},_createFieldSelect:function(A,a,f,z){var J=this._createDocTypeDataArr();J=new B({data:J});
A&&A.alias&&(f=A.alias);f=z?f+" "+this.nls.planInfo.requiredText:f+" "+this.nls.planInfo.optionalText;this.selectBox=new t({placeHolder:f,"class":"esriCTFullWidth",required:z,store:J},a);e.set(this.selectBox.domNode,"aria-label",f);e.set(this.selectBox.domNode,"role","combobox");e.set(this.selectBox.domNode,"aria-expanded","false");W.after(this.selectBox,"loadAndOpenDropDown",n.hitch(this,function(){e.set(this.selectBox.domNode,"aria-expanded","true")}));W.after(this.selectBox,"closeDropDown",n.hitch(this,
function(){e.set(this.selectBox.domNode,"aria-expanded","false")}));return this.selectBox},_createDocTypeDataArr:function(){var A=[];this.config.polygonLayer.documentType.domain.codedValues&&g.forEach(this.config.polygonLayer.documentType.domain.codedValues,n.hitch(this,function(a){A.push({name:a.name,id:a.code})}));return A},saveData:function(A){if(A.miscloseDetails&&(0===A.miscloseDetails.LengthConversions.meters||A.appliedCompassRule))this._saveParcel(A);else var a=new u({message:this.nls.planInfo.saveNonClosedParcelConfirmationMessage,
type:"question",buttons:[{label:this.nls.common.yes,onClick:n.hitch(this,function(){a.close();this._saveParcel(A)})},{label:this.nls.common.no}]})},_saveParcel:function(A){this._itemList=A.itemList;this.planSettings=A.planSettings;0===A.polygonDeleteArr.length?this._createPolygonData(A):this._deletePolygonBeforeSaving(A)},_createParcelPolygon:function(){var A,a,f;var z=[];var J=this.parcelLinesGraphicsLayer.graphics;for(A=0;A<this._itemList.length;A++)if(this._itemList[A].LineSymbol.type===this.config.BoundaryLineType)for(a=
0;a<this._itemList[A].graphic.geometry.paths.length;a++)z.push(this._itemList[A].graphic.geometry.paths[a]);0<z.length&&(f=M.getPolygonFromPolyLines(z,!1,!0,J[0].geometry.spatialReference))&&(this.parcelPolygonGraphicsLayer.clear(),A=new Q(f),this.parcelPolygonGraphicsLayer.add(A),f=this.parcelPolygonGraphicsLayer.graphics[0].geometry);return f},_createPolygonData:function(A){this.loading.show();var a=[];var f={};var z=this.polygonLayerUnit;this.documentTypeControl&&(this.config.polygonLayer.documentType.domain?
this.documentTypeControl.hasOwnProperty("item")&&this.documentTypeControl.item&&this.documentTypeControl.item.hasOwnProperty("id"):""!==this.documentTypeControl.get("value")&&this.documentTypeControl.get("value"));var J=!1;if(A.miscloseDetails&&(0===A.miscloseDetails.LengthConversions.meters||A.appliedCompassRule))var K=this._createParcelPolygon();else K={},J=!0;K?(J&&(K=null),this._currentFeatureDetails&&this._currentFeatureDetails.attributes&&(f=n.clone(this._currentFeatureDetails.attributes)),
f[this.config.polygonLayer.rotation.name]=A.rotation,f[this.config.polygonLayer.scale.name]=A.scale,A.miscloseDetails&&(f[this.config.polygonLayer.miscloseRatio.name]=A.miscloseDetails.miscloseValue,f[this.config.polygonLayer.miscloseDistance.name]=this._getValueAccToFeatureLayerUnit(z,A.miscloseDetails,"LengthConversions")),this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(f[this.config.polygonLayer.statedArea.name]=A.statedArea),A=new Q(K,null,f),a.push(A),this._saveParcelPolygon(a)):
this._showMessage(this.nls.planInfo.unableToCreatePolygonParcel)},setParcelInformation:function(A,a){var f=this.map.getLayer(this.config.polygonLayer.id).objectIdField;this._savedPolygonObjectId=A[0].attributes[f];var z=n.clone(A[0].attributes);z[f]=z[f]?z[f]:0;this._addGraphicToLocalLayer(z);this._savedPolyLines=a;D.remove(this.planInfoDeleteButton,"esriCTHidden");this.parcelNameTextBox&&this.parcelNameTextBox.set("value",A[0].attributes[this.config.polygonLayer.parcelName.name]);this.planNameTextBox&&
this.planNameTextBox.set("value",A[0].attributes[this.config.polygonLayer.planName.name]);this.documentTypeControl&&(A=A[0].attributes[this.config.polygonLayer.documentType.name],null!==A&&""!==A&&void 0!==A&&(this.config.polygonLayer.documentType.domain?this.documentTypeControl.set("item",this.documentTypeControl.store.get(A)):this.documentTypeControl.set("value",A)))},_rollbackSavedPolygon:function(){var A;var a={attributes:{}};if((A=this.map.getLayer(this.config.polygonLayer.id))&&null!==this._savedPolygonObjectId){a.attributes[A.objectIdField]=
this._savedPolygonObjectId;var f=A.applyEdits(null,null,[a])}return f},_rollbackSavedPolyLines:function(A){var a,f;var z=[];var J=this.map.getLayer(this.config.polylineLayer.id);g.forEach(A,n.hitch(this,function(K){a={attributes:{}};K.hasOwnProperty("objectId")?(a.attributes[J.objectIdField]=K.objectId,z.push(a)):K.attributes.hasOwnProperty(J.objectIdField)&&(a.attributes[J.objectIdField]=K.attributes[J.objectIdField],z.push(a))}));J&&0<z.length&&(f=J.applyEdits(null,null,z));return f},_deletePolygonBeforeSaving:function(A){(this._polygonLayer=
this.map.getLayer(this.config.polygonLayer.id))?this._polygonLayer.applyEdits(null,null,A.polygonDeleteArr,n.hitch(this,function(){this._deleteLinesBeforeSaving(A)}),n.hitch(this,function(){this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)})):this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)},_deleteLinesBeforeSaving:function(A){var a;(a=this.map.getLayer(this.config.polylineLayer.id))?a.applyEdits(null,null,A.polylineDeleteArr,n.hitch(this,function(){this._createPolygonData(A)}),
n.hitch(this,function(){this._showMessage(this.nls.planInfo.unableToUpdateParcelLines)})):this._showMessage(this.nls.planInfo.unableToUpdateParcelLines)},_saveParcelPolygon:function(A){(this._polygonLayer=this.map.getLayer(this.config.polygonLayer.id))?(this._savedPolygonObjectId=null,this._polygonLayer.applyEdits(A,null,null,n.hitch(this,function(a){a&&0<a.length&&a[0].success?(this._savedPolygonObjectId=a[0].objectId,this._polygonLayer.refresh(),a=new N,a.objectIds=[this._savedPolygonObjectId],
a.returnGeometry=!1,a.outFields=[this.config.polygonLayer.relatedGUID.name],(new T(this._polygonLayer.url)).execute(a,n.hitch(this,function(f){this.loading.hide();this._createPolylineData(f.features[0].attributes[this.config.polygonLayer.relatedGUID.name])}),n.hitch(this,function(){this.loading.hide();this._showMessage(this.nls.planInfo.unableToSaveParcelLines)}))):(this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSavePolygonParcel))}),n.hitch(this,function(){this.loading.hide();this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)}))):
(this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSavePolygonParcel))},_getValueAccToFeatureLayerUnit:function(A,a,f){if(a.hasOwnProperty(f)&&a[f])switch(A){case "meters":case "degrees":return a[f].meters;case "feet":return a[f].feet;case "uSSurveyFeet":return a[f].uSSurveyFeet;default:return null}else return null},_getCurrentLineFeatures:function(){for(var A=[],a=0;a<this._itemList.length;a++)A.push(this._itemList[a].graphic);return A},_createPolylineData:function(A){this.loading.show();
var a=this._getCurrentLineFeatures();var f=this.polylineLayerUnit;var z=this._itemList;var J=[];for(var K=0;K<a.length;K++){var b={};var c=z[K];b[this.config.polylineLayer.bearing.name]=c.BearingConversions.naDD;b[this.config.polylineLayer.distance.name]=this._getValueAccToFeatureLayerUnit(f,c,"LengthConversions");b[this.config.polylineLayer.lineType.name]=c.LineSymbol.type;b[this.config.polylineLayer.radius.name]=this._getValueAccToFeatureLayerUnit(f,c,"RadiusConversions");null!==b[this.config.polylineLayer.radius.name]&&
""!==b[this.config.polylineLayer.radius.name]&&void 0!==b[this.config.polylineLayer.radius.name]?(b[this.config.polylineLayer.arcLength.name]=this._getValueAccToFeatureLayerUnit(f,c,"ArcLengthConversions"),c=this._getValueAccToFeatureLayerUnit(f,c,"ChordLengthConversions"),b[this.config.polylineLayer.chordLength.name]=c,b[this.config.polylineLayer.distance.name]=c):(b[this.config.polylineLayer.arcLength.name]=null,b[this.config.polylineLayer.chordLength.name]=null);b[this.config.polylineLayer.relatedGUID.name]=
A;b[this.config.polylineLayer.sequenceId.name]=K;c=a[K].geometry.toJson();c=new C(c);b=new Q(c,null,b,null);J.push(b)}this._saveParcelLines(J)},_saveParcelLines:function(A){var a;(a=this.map.getLayer(this.config.polylineLayer.id))?a.applyEdits(A,null,null,n.hitch(this,function(f){var z=[],J=[];g.forEach(f,function(K){K.success?J.push(K):z.push(K)});0<z.length?(this._rollbackSavedPolygon(),0<J.length&&z.length!==A.length&&this._rollbackSavedPolyLines(J),this._showMessage(this.nls.planInfo.unableToSaveParcelLines)):
(this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelSavedSuccessMessage),this._savedPolygonObjectId=null,this.emit("displayMainPageAfterSave",!1));this.loading.hide()}),n.hitch(this,function(){this._rollbackSavedPolygon();this.loading.hide();this._showMessage(this.nls.planInfo.unableToSaveParcelLines)})):(this._rollbackSavedPolygon(),this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSaveParcelLines))},_validateRequiredFields:function(){var A=[],a=this._currentFeatureDetails;if(!a)return A;
var f=a.getLayer();f=g.filter(f.fields,n.hitch(this,function(z){return!1===z.nullable&&!0===z.editable}));g.forEach(f,n.hitch(this,function(z){if(a.attributes.hasOwnProperty(z.name))if("undefined"===a.attributes[z.name])A.push(z.name);else if(null===a.attributes[z.name])A.push(z.name);else switch(z.type){case "esriFieldTypeString":(""===a.attributes[z.name]||a.attributes[z.name]&&""===a.attributes[z.name].trim())&&A.push(z.name)}else A.push(z.name)}));return A},_validateAttributes:function(){var A=
[],a;A=this._validateRequiredFields();var f=k("td.atiLabel",this._attributeInspector.domNode),z=[];this._clonedProjectPolygonLayerObject.globalIdField&&z.push(this._clonedProjectPolygonLayerObject.globalIdField);this._clonedProjectPolygonLayerObject.objectIdField&&z.push(this._clonedProjectPolygonLayerObject.objectIdField);f&&g.forEach(f,n.hitch(this,function(J){var K=e.get(J,"data-fieldname");-1===z.indexOf(K)&&(K=this._getAttrInspectorRowInfo(J))&&(0>A.indexOf(K[1])?K[0].isValid&&!K[0].isValid()?
(A.push(K[1]),a||(a=K[0])):1<J.parentNode.childNodes[1].childNodes.length&&(J=J.parentNode.childNodes[1].childNodes[1],J=r.getEnclosingWidget(J),J.isValid&&!J.isValid()&&(A.push(K[1]),a||(a=J))):a||(a=K[0]))}));a&&(D.contains(this.expandCollapseNode,"esriCTCollapsedParceLayer")||this._onExpandCollapseClicked(),a.focus());return A},validateParcelDetails:function(A){var a={};if(this._attributeInspector){var f=this._validateAttributes();if(f&&0<f.length)return a.status=!1,a.message="",a}if(this.config.polygonLayer.statedArea&&
this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(!this.config.polygonLayer.statedArea.nullable&&(null===A||""===A)||null!==A&&""!==A&&-1<this.numberFieldTypes.indexOf(this.config.polygonLayer.statedArea.type)&&!this.validateNumericField(A,this.config.polygonLayer.statedArea.type)))return a.status=!1,a.message=this.nls.planInfo.enterValidStatedAreaNameMessage,a;a.status=!0;return a},deleteParcel:function(){this.loading.show();this._rollbackSavedPolygon().then(n.hitch(this,function(){this._rollbackSavedPolyLines(this._savedPolyLines).then(n.hitch(this,
function(){this.loading.hide();this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelDeletedSuccessMessage);this._savedPolygonObjectId=null;this.emit("displayMainPageAfterSave",!1)}),n.hitch(this,function(){this.loading.hide();this._savedPolygonObjectId=null;this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelDeleteErrorMessage);this.emit("displayMainPageAfterSave",!1)}))}),n.hitch(this,function(){this.loading.hide();this._savedPolygonObjectId=null;this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelDeleteErrorMessage);
this.emit("displayMainPageAfterSave",!1)}))},setPlanInfoCancelBtnAsLastNode:function(){I.initLastFocusNode(this.widgetDomNode,this.planInfoCancelButton)},_showParcelSavedAndDeleteMsg:function(A){this.emit("showParcelSavedAndDeleteMsg",A)},mergeFirstToLast:function(){for(var A={},a=arguments.length-1,f;0<=a;a--)for(f in arguments[a])arguments[a].hasOwnProperty(f)&&(A[f]=arguments[a][f]);return A},_getFieldInfosFromLayer:function(A){var a=[];A&&A.layerObject&&g.forEach(A.layerObject.fields,function(f){var z=
I.getDefaultPortalFieldInfo(f);z=this.mergeFirstToLast(z,f);z.format&&z.format.dateFormat&&z.format.dateFormat.toLowerCase()&&0<=z.format.dateFormat.toLowerCase().indexOf("time")&&(z.format.time=!0);z.visible=!0;a.push(z)},this);return a},_createFieldsDetailsObject:function(A){var a={};g.forEach(A,n.hitch(this,function(f){a[f.name]=f.type}));return a},getFieldInfoByFieldName:function(A,a){var f={};g.some(A,function(z){if(z.name===a)return n.mixin(f,z),!0});return f},_getFieldInfosForPolygonLayer:function(){if(this.fieldInfosForPolygonLayer)return this.fieldInfosForPolygonLayer;
var A=[],a=[this.config.polygonLayer.rotation.name,this.config.polygonLayer.scale.name,this.config.polygonLayer.miscloseRatio.name,this.config.polygonLayer.miscloseDistance.name,this.config.polygonLayer.statedArea.name],f=this._layerInfosObj.getLayerInfoById(this.config.polygonLayer.id),z=this._createFieldsDetailsObject(f.layerObject.fields);var J=this._getFieldInfosFromLayer(f);if(this.config.hasOwnProperty("useFieldInfosFromWebmap")&&this.config.useFieldInfosFromWebmap&&f.controlPopupInfo&&f.controlPopupInfo.enablePopup&&
f.controlPopupInfo.infoTemplate)J=n.clone(f.controlPopupInfo.infoTemplate.info.fieldInfos);else if(this.config.polygonLayer.hasOwnProperty("additionalFieldsInfo")&&0<this.config.polygonLayer.additionalFieldsInfo.length){var K=[];g.forEach(this.config.polygonLayer.additionalFieldsInfo,function(c){var q=this.getFieldInfoByFieldName(J,c.fieldName);q=n.mixin(q,c);!q.nullable&&q.editable&&(q.visible=!0,q.isEditable=!0);K.push(q)},this);J=K}else this.config.polygonLayer.documentType.hasOwnProperty("name")&&
A.push(this.config.polygonLayer.documentType.name),this.config.polygonLayer.parcelName.hasOwnProperty("name")&&A.push(this.config.polygonLayer.parcelName.name),this.config.polygonLayer.planName.hasOwnProperty("name")&&A.push(this.config.polygonLayer.planName.name);var b=[];g.forEach(J,n.hitch(this,function(c){A&&0<A.length&&0>A.indexOf(c.fieldName)&&(c.visible=!1);-1<a.indexOf(c.fieldName)&&(c.visible=!1);c.visible&&z[c.fieldName]&&"esriFieldTypeRaster"!==z[c.fieldName]&&"esriFieldTypeBlob"!==z[c.fieldName]&&
"esriFieldTypeXML"!==z[c.fieldName]&&(c.format&&c.format.dateFormat&&c.format.dateFormat.toLowerCase()&&0<=c.format.dateFormat.toLowerCase().indexOf("time")&&(c.format.time=!0),b.push(c))}));return this.fieldInfosForPolygonLayer=b},_clearAttributeInspectorData:function(){this._attributeInspector&&(this._attributeInspector.layerInfos&&g.forEach(this._attributeInspector.layerInfos,function(A){A=A.featureLayer;A.clearSelection();A.refresh()}),this._attributeInspector.destroy())},_add508SupportToATI:function(){var A;
this._attributeInspector&&this._attributeInspector.domNode&&(A=k("td.atiLabel",this._attributeInspector.domNode))&&g.forEach(A,n.hitch(this,function(a){var f=this._getAttrInspectorRowInfo(a);f&&(f[0].set("aria-label",f[1]),1<a.parentNode.childNodes[1].childNodes.length&&(a=a.parentNode.childNodes[1].childNodes[1],a=r.getEnclosingWidget(a),a.set("aria-label",f[1])))}))},_getAttrInspectorRowInfo:function(A){try{if(A&&A.parentNode){var a=A.parentNode.childNodes[1].childNodes[0];return[r.getEnclosingWidget(a),
A.childNodes[0].data,a]}return null}catch(f){return console.log(f),null}},_getCurrentFieldDijit:function(A){var a;g.some(this._attributeInspector._currentLInfo.fieldInfos,n.hitch(this,function(f){if(f.name===A||f.field&&f.field.name===A||f.fieldName===A)return a=f.dijit,!0}));return a},_addGraphicToLocalLayer:function(A){var a,f,z,J;if((J=this._getFieldInfosForPolygonLayer())&&0!=J.length){this._clearAttributeInspectorData();this._removeClonedProjectPolygonLayer();var K=this.map.getLayer(this.config.polygonLayer.id);
this._clonedProjectPolygonLayerObject=this._cloneProjectPolygonLayer(K,J);var b=this.own(v(this._clonedProjectPolygonLayerObject,"load",n.hitch(this,function(){b&&b[0]&&b[0].remove();a=this._layerInfosObj.getLayerInfoById(this._clonedProjectPolygonLayerObject.originalLayerId);a.featureLayer=this._clonedProjectPolygonLayerObject;this._createAttributeInspector(J);f=new Q(null,null,A?A:{},null);f.preEditAttrs=JSON.parse(JSON.stringify(f.attributes));this._clonedProjectPolygonLayerObject.applyEdits([f],
null,null,n.hitch(this,function(c){z=new N;z.objectIds=[c[0].objectId];this._clonedProjectPolygonLayerObject.selectFeatures(z,m.SELECTION_NEW,n.hitch(this,function(){var q=this._attributeInspector.attributeTable.childNodes[0];e.set(q,"cellspacing","5");e.set(q,"cellpadding","5");this._currentFeatureDetails=f;this._add508SupportToATI();this._attributeInspector.attachmentEditor&&y.set(this._attributeInspector.attachmentEditor,"display","none");this._attributeInspector.editorTrackingInfoDiv&&y.set(this._attributeInspector.editorTrackingInfoDiv,
"display","none");if(q=this._clonedProjectPolygonLayerObject.objectIdField){var w=this._getCurrentFieldDijit(q);w&&f.preEditAttrs[q]&&w.set("value",f.preEditAttrs[q])}}),n.hitch(this,function(){}))}),n.hitch(this,function(){}))}),n.hitch(this,function(){})))}},_removeClonedProjectPolygonLayer:function(){this._clonedProjectPolygonLayerObject&&null!==this._clonedProjectPolygonLayerObject&&(this._clonedProjectPolygonLayerObject.clearSelection(),this._clonedProjectPolygonLayerObject.clear(),this.map.removeLayer(this._clonedProjectPolygonLayerObject),
this._clonedProjectPolygonLayerObject=null)},_filterFields:function(A,a){var f=[];g.forEach(a,n.hitch(this,function(z){z.visible&&g.forEach(A.fields,n.hitch(this,function(J){J.hasOwnProperty("name")&&z.hasOwnProperty("fieldName")&&J.name===z.fieldName&&f.push(J)}))}));A.fields=f},_cloneProjectPolygonLayer:function(A,a){var f=I.getFeatureLayerDefinition(A);this._filterFields(f,a);f.id="clonedPolygonLayer"+this.id;f.name=A.name+this.id;a={layerDefinition:f};f=A.fields.map(function(z){return z.name});
a=new m(a,{outFields:f});a.visible=!0;a.renderer=A.renderer;a.originalLayerId=A.id;a._wabProperties={isTemporaryLayer:!0};this.map.addLayer(a);return a},_processLayerFields:function(A){g.forEach(A,function(a){void 0!==a.domain&&null!==a.domain&&void 0!==a.domain.type&&null!==a.domain.type&&"range"===a.domain.type&&!1===a.domain.hasOwnProperty("range")&&(a.domain.range=[a.domain.minValue,a.domain.maxValue])});return A},_createAttributeInspector:function(A){x.empty(this.attributeInspectorContainer);
this._attributeInspector=new (H([U],{constructor:function(){this._aiConnects=[];this._selection=[];this._toolTips=[]}}))({layerInfos:[{featureLayer:this._clonedProjectPolygonLayerObject,fieldInfos:A}]},x.create("div",{"class":"esriCTAttributeInspectorWidgetContainer"}));this.own(v(this._attributeInspector,"attribute-change",n.hitch(this,function(a){this._currentFeatureDetails&&(this._currentFeatureDetails.attributes[a.fieldName]=a.fieldValue)})));this._attributeInspector.startup();this.attributeInspectorContainer.appendChild(this._attributeInspector.domNode)}})})},
"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ./FeatureTable/dataUtils ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v,C,Q,N,T,U,m,u,M,I,S,E,W,A,a,f,z,J,K,b,c,q,w,L,R,X){var da=H([u,Q,N],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:X,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,
_currentFeature:null,_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},_defaultRichTextPlugins:"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),css:{label:"atiLabel",field:"atiField",textArea:"atiTextAreaField",richText:"atiRichTextField",attachmentEditor:"atiAttachmentEditor",
red:"atiRequiredField"},constructor:function(F,G){d.mixin(this,t.widgets.attributeInspector);F=F||{};F.featureLayer||F.layerInfos||console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(F);this._layerInfos=F.layerInfos||[{featureLayer:F.featureLayer,options:F.options||[]}];this._layerInfos=h.filter(this._layerInfos,function(P){return!P.disableAttributeUpdate});this._hideNavButtons=F.hideNavButtons||!1},postCreate:function(){if(h.every(this._layerInfos,
function(G){return G.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var F=this._layerInfos.length;h.forEach(this._layerInfos,function(G){G=G.featureLayer;if(G.loaded)F--;else var P=l.connect(G,"onLoad",this,function(V){l.disconnect(P);P=null;F--;F||(this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature())})},this)}},destroy:function(){this._destroyAttributeTable();h.forEach(this._aiConnects,l.disconnect);delete this._aiConnects;
this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},next:function(){this.onNextFeature()},previous:function(){this.onPreviousFeature()},showFeature:function(F,G){G&&(this._createOnlyFirstTime=!0);
this._updateSelection([F],G);this._updateUI()},onLayerSelectionChange:function(F,G,P){this._createOnlyFirstTime=!1;this._featureIdx=P===B.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){!this._selection||0>=this._selection.length||(this._featureIdx=this._numFeatures=0,this._selection=[],this._currentLInfo=this._currentFeature=null,this._updateUI())},onLayerUpdateEnd:function(F,G,P,V){},onLayerError:function(F,G,P,V){},onLayerEditsError:function(F,
G,P,V){},onLayerEditsComplete:function(F,G,P,V){V=V||[];if(V.length){var Y=this._selection,ca=F.featureLayer.objectIdField;h.forEach(V,d.hitch(this,function(ba){h.some(Y,d.hitch(this,function(aa,ea){if(aa.attributes[ca]!==ba.objectId)return!1;this._selection.splice(ea,1);return!0}))}))}G=G||[];G.length&&(this._selection=I.findFeatures(G,F.featureLayer),this._featureIdx=0);V=this._numFeatures=(this._selection=I.sortFeaturesById(this._layerInfos,this._selection))?this._selection.length:0;if(G.length){if(G=
V?this._selection[this._featureIdx]:null)V=G.getLayer().getEditCapabilities(),V.canCreate&&!V.canUpdate||this._showFeature(G);this._updateUI()}P=P||[];if(P.length){var Z=this._rollbackInfo;h.forEach(P,function(ba){var aa=I.findFeatures(P,F.featureLayer)[0];if(!ba.success&&aa.attributes[F.featureLayer.objectIdField]===ba.objectId&&Z){var ea=Z.field;ba=Z.graphic.attributes[ea.name];var fa=h.filter(this._currentLInfo.fieldInfos,function(ha){return ha.fieldName===ea.name},this)[0].dijit;aa.attributes[ea.name]=
ba;"esriFieldTypeDate"===ea.type&&(ba=new Date(ba));this._setValue(fa,ba)}},this)}this._rollbackInfo=null},onFieldValueChange:function(F,G){var P=F.field,V=F.dijit,Y=this._currentFeature,ca=this._currentLInfo,Z=P.name;F=this._isFieldRequired(P,F);if(""===V.displayedValue||"dijit.form.ValidationTextBox"!==V.declaredClass||V.isValid())if(""!==V.displayedValue&&V.displayedValue!==G&&V.isValid&&!V.isValid())this._setValue(V,Y.attributes[P.name]);else{var ba=!("esriFieldTypeInteger"!==P.type&&"esriFieldTypeSmallInteger"!==
P.type&&"esriFieldTypeSingle"!==P.type&&"esriFieldTypeDouble"!==P.type);if(F&&(null===G||""===G||"undefined"===typeof G||ba&&isNaN(G))){Z=Y.attributes[P.name];if("esriFieldTypeDate"===P.type&&(Z=new Date(Z),V instanceof Array)){this._setValue(V[0],Z);this._setValue(V[1],Z);return}this._setValue(V,Z)}else{if(ba){if(isNaN(G)||""===G)G=null;ba&&null!==G&&(G=Number(G))}"esriFieldTypeDate"===P.type&&(V instanceof Array?(G=V[0].getValue(),V=V[1].getValue(),G=G&&V?new Date(G.getFullYear(),G.getMonth(),G.getDate(),
V.getHours(),V.getMinutes(),V.getSeconds(),V.getMilliseconds()):G||V||null):(G=V.getValue(),P.domain&&(G=Number(G))),G=G&&G.getTime?G.getTime():G&&G.toGregorian?G.toGregorian().getTime():G);if(this._currentFeature.attributes[P.name]!==G){if(Z===ca.typeIdField){var aa=this._findFirst(ca.types,"id",G);h.forEach(ca.fieldInfos,function(ea){(P=ea.field)&&P.name!==ca.typeIdField&&(ea=ea.dijit,this._setFieldDomain(ea,aa,P)&&ea&&(this._setValue(ea,Y.attributes[P.name]+""),!1===ea.isValid()&&this._setValue(ea,
null)))},this)}this.onAttributeChange(Y,Z,G)}}}else this._setValue(V,Y.attributes[P.name])},onDeleteBtn:function(F){this._deleteFeature()},onNextFeature:function(F){this._onNextFeature(1)},onPreviousFeature:function(F){this._onNextFeature(-1)},onFirstFeature:function(F){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(F){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var F=this._layerInfos;this._editorTrackingInfos={};h.forEach(F,this._initLayerInfo,
this)},_initLayerInfo:function(F){var G=F.featureLayer,P;this._userIds={};var V=G.id;G.credential&&(this._userIds[V]=G.credential.userId);F.userId&&(this._userIds[V]=F.userId);this._connect(G,"onSelectionComplete",d.hitch(this,"onLayerSelectionChange",F));this._connect(G,"onSelectionClear",d.hitch(this,"onLayerSelectionClear",F));this._connect(G,"onEditsComplete",d.hitch(this,"onLayerEditsComplete",F));this._connect(G,"error",d.hitch(this,"onLayerError",F));this._connect(G,"onUpdateEnd",d.hitch(this,
"onLayerUpdateEnd",F));F.showAttachments=G.hasAttachments?k.isDefined(F.showAttachments)?F.showAttachments:!0:!1;F.hideFields=F.hideFields||[];F.htmlFields=F.htmlFields||[];F.isEditable=G.isEditable()?k.isDefined(F.isEditable)?F.isEditable:!0:!1;F.typeIdField=G.typeIdField;F.layerId=G.id;F.types=G.types;G.globalIdField&&((P=this._findFirst(F.fieldInfos,"fieldName",G.globalIdField))||F.showGlobalID||F.hideFields.push(G.globalIdField));(V=this._findFirst(F.fieldInfos,"fieldName",G.objectIdField))||
F.showObjectID||F.hideFields.push(G.objectIdField);var Y=this._getFields(F.featureLayer);if(Y){var ca=F.fieldInfos||[];ca=h.map(ca,function(Z){return d.mixin({},Z)});ca.length?F.fieldInfos=h.filter(h.map(ca,d.hitch(this,function(Z){var ba=Z.stringFieldOption||(this._isInFields(Z.fieldName,F.htmlFields)?da.STRING_FIELD_OPTION_RICHTEXT:da.STRING_FIELD_OPTION_TEXTBOX);return d.mixin(Z,{field:this._findFirst(Y,"name",Z.fieldName),stringFieldOption:ba})})),"return item.field;"):(Y=h.filter(Y,d.hitch(this,
function(Z){return!this._isInFields(Z.name,F.hideFields)})),F.fieldInfos=h.map(Y,d.hitch(this,function(Z){var ba=this._isInFields(Z.name,F.htmlFields)?da.STRING_FIELD_OPTION_RICHTEXT:da.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:Z.name,field:Z,stringFieldOption:ba}})));F.showGlobalID&&!P&&ca.push(this._findFirst(Y,"name",G.globalIdField));F.showObjectID&&!V&&ca.push(this._findFirst(Y,"name",G.objectIdField));P=[];G.editFieldsInfo&&(G.editFieldsInfo.creatorField&&P.push(G.editFieldsInfo.creatorField),
G.editFieldsInfo.creationDateField&&P.push(G.editFieldsInfo.creationDateField),G.editFieldsInfo.editorField&&P.push(G.editFieldsInfo.editorField),G.editFieldsInfo.editDateField&&P.push(G.editFieldsInfo.editDateField));this._editorTrackingInfos[G.id]=P}},_createAttachmentEditor:function(){this._attachmentEditor=null;var F=h.filter(this._layerInfos,function(G){return G.showAttachments});F&&F.length&&(this._attachmentEditor=new M({"class":this.css.attachmentEditor},this.attachmentEditor),this._attachmentEditor.startup())},
_setCurrentLInfo:function(F){var G=this._currentLInfo?this._currentLInfo.featureLayer:null,P=F.featureLayer;if(G&&G.id===P.id&&!G.ownershipBasedAccessControlForFeatures&&(G=P.getEditCapabilities(),!G.canCreate||G.canUpdate))return;this._currentLInfo=F;this._createTable()},_updateSelection:function(F,G){this._selection=F||[];h.forEach(this._layerInfos,this._getSelection,this);this._selection=I.sortFeaturesById(this._layerInfos,this._selection);this._numFeatures=this._selection.length;this._showFeature(this._numFeatures?
this._selection[this._featureIdx]:null,G)},_getSelection:function(F){F=F.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(F)},_updateUI:function(){var F=this._numFeatures,G=this._currentLInfo;this.layerName.innerHTML=G&&0!==F?G.featureLayer?G.featureLayer.name:"":this.NLS_noFeaturesSelected;e.set(this.attributeTable,"display",F?"":"none");e.set(this.editButtons,"display",F?"":"none");e.set(this.navButtons,"display",!this._hideNavButtons&&1<F?"":"none");this.navMessage.innerHTML=
k.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);this._attachmentEditor&&e.set(this._attachmentEditor.domNode,"display",G&&G.showAttachments&&F?"":"none");e.set(this.deleteBtn.domNode,"display",G&&!1===G.showDeleteButton||!this._canDelete?"none":"");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(F){this._featureIdx+=F;0>this._featureIdx?this._featureIdx=this._numFeatures-
1:this._featureIdx>=this._numFeatures&&(this._featureIdx=0);F=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(F);this._updateUI();this.onNext(F)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(F,G){if(F){this._currentFeature=F;G=G?G:F.getLayer();var P=G.getEditCapabilities({feature:F,userId:this._userIds[G.id]});this._canUpdate=P.canUpdate;this._canDelete=P.canDelete;if(P=this._getLInfoFromFeatureLayer(G)){this._setCurrentLInfo(P);
var V=F.attributes,Y=this._findFirst(P.types,"id",V[P.typeIdField]),ca=null;h.forEach(P.fieldInfos,function(Z){ca=Z.field;var ba=[];Z.dijit&&1<Z.dijit.length?h.forEach(Z.dijit,function(aa){ba.push(aa)}):ba.push(Z.dijit);h.forEach(ba,d.hitch(this,function(aa){if(aa){var ea=this._setFieldDomain(aa,Y,ca),fa=V[ca.name];fa=fa&&ea&&ea.codedValues&&ea.codedValues.length?ea.codedValues[fa]?ea.codedValues[fa].name:fa:fa;k.isDefined(fa)||(fa="");"dijit.form.DateTextBox"===aa.declaredClass||"dijit.form.TimeTextBox"===
aa.declaredClass?fa=""===fa?null:new Date(fa):"dijit.form.FilteringSelect"===aa.declaredClass&&(aa._lastValueReported=null,fa=V[ca.name]+"");try{this._setValue(aa,fa),"dijit.form.FilteringSelect"===aa.declaredClass&&!1===aa.isValid()&&this._setValue(aa,null)}catch(ha){aa.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&P.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,G);(F=G.getEditSummary(F))?(this.editorTrackingInfoDiv.innerHTML=F,
r.show(this.editorTrackingInfoDiv)):r.hide(this.editorTrackingInfoDiv)}}},_setFieldDomain:function(F,G,P){if(!F)return null;var V=P.domain;G&&G.domains&&G.domains[P.name]&&!1===G.domains[P.name]instanceof O&&(V=G.domains[P.name]);if(!V)return null;V.codedValues&&0<V.codedValues.length?(F.set("store",this._toStore(h.map(V.codedValues,function(Y){return{id:Y.code+"",name:Y.name}}))),this._setValue(F,V.codedValues[0].code+"")):(F.constraints={min:k.isDefined(V.minValue)?V.minValue:Number.MIN_VALUE,max:k.isDefined(V.maxValue)?
V.maxValue:Number.MAX_VALUE},this._setValue(F,F.constraints.min));return V},_setValue:function(F,G){F.set&&(F._onChangeActive=!1,F.set("value",G,!0),F._onChangeActive=!0)},_getFields:function(F){var G=F._getOutFields();if(!G)return null;F=F.fields;return"*"==G?F:h.filter(h.map(G,d.hitch(this,"_findFirst",F,"name")),k.isDefined)},_isInFields:function(F,G){return F&&(G||G.length)?h.some(G,function(P){return P.toLowerCase()===F.toLowerCase()}):!1},_isFieldNullable:function(F,G){return!(!1===F.nullable||
G.field&&!1===G.field.nullable)},_isFieldRequired:function(F,G){return!1!==F.editable&&!1!==G.isEditable&&!this._isFieldNullable(F,G)},_findFirst:function(F,G,P){return(F=h.filter(F,function(V){return V.hasOwnProperty(G)&&V[G]===P}))&&F.length?F[0]:null},_getLInfoFromFeatureLayer:function(F){return this._findFirst(this._layerInfos,"layerId",F?F.id:null)},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=x.create("table",{cellspacing:"0",cellpadding:"0"},
this.attributeTable);var F=x.create("tbody",null,this._attributes),G=this._currentLInfo,P=this._findFirst(G.types,"id",this._currentFeature.attributes[G.typeIdField]);h.forEach(G.fieldInfos,d.hitch(this,"_createField",P,F),this);this._createOnlyFirstTime=!1},_createField:function(F,G,P){var V=this._currentLInfo,Y=P.field;if(!this._isInFields(Y.name,V.hideFields)&&!this._isInFields(Y.name,this._editorTrackingInfos[V.featureLayer.id])){var ca=!1,Z;G=x.create("tr",null,G);var ba=P.label||Y.alias||Y.name;
ba=D.sanitizer?D.sanitizer.sanitize(ba):htmlEntities.encode(ba);ba=x.create("td",{innerHTML:ba,"class":this.css.label,"data-fieldname":Y.name},G);this._isFieldRequired(Y,P)&&x.create("span",{"class":this.css.red,innerHTML:" *"},ba);G=x.create("td",null,G);if(P.customField){x.place(P.customField.domNode||P.customField,x.create("div",null,G),"first");var aa=P.customField}else if(!1===V.isEditable||!1===Y.editable||!1===P.isEditable||"esriFieldTypeOID"===Y.type||"esriFieldTypeGlobalID"===Y.type||!this._canUpdate&&
!this._createOnlyFirstTime)ca=!0;V=V.typeIdField&&Y.name.toLowerCase()==V.typeIdField.toLowerCase();ba=!!this._getDomainForField(Y,F);!aa&&V?aa=this._createTypeField(Y,P,G):!aa&&ba&&(aa=this._createDomainField(Y,P,F,G));if(!aa)switch(Y.type){case "esriFieldTypeString":aa=this._createStringField(Y,P,G);break;case "esriFieldTypeDate":aa=this._createDateField(Y,P,G);P.format&&P.format.time&&(Z=this._createTimeField(Y,P,G));break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":aa=this._createIntField(Y,
P,G);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":aa=this._createFltField(Y,P,G);break;default:aa=this._createStringField(Y,P,G)}P.tooltip&&P.tooltip.length&&this._toolTips.push(new c({connectId:[aa.id],label:P.tooltip}));aa.onChange=d.hitch(this,"onFieldValueChange",P);aa.set("disabled",ca);Z?(P.dijit=[aa,Z],Z.onChange=d.hitch(this,"onFieldValueChange",P),Z.set("disabled",ca)):P.dijit=aa}},_createTypeField:function(F,G,P){P=x.create("div",null,P);var V=F.domain;return V&&"range"===
V.type&&V.minValue===V.maxValue?new K({"class":this.css.field,trim:!0,maxLength:F.length,name:F.alias||F.name,required:this._isFieldRequired(F,G)},P):new a({"class":this.css.field,name:F.alias||F.name,required:this._isFieldRequired(F,G),store:this._toStore(h.map(this._currentLInfo.types,function(Y){return{id:Y.id,name:Y.name}})),searchAttr:"name"},P)},_getDomainForField:function(F,G){var P=F.domain;(F=F.name)&&G&&G.domains&&G.domains[F]&&!1===G.domains[F]instanceof O&&(P=G.domains[F]);return P||null},
_createDomainField:function(F,G,P,V){P=this._getDomainForField(F,P);V=x.create("div",null,V);return P.codedValues?new a({"class":this.css.field,name:F.alias||F.name,searchAttr:"name",required:this._isFieldRequired(F,G)},V):new f({"class":this.css.field},V)},_createStringField:function(F,G,P){P=x.create("div",null,P);var V={trim:!0,maxLength:F.length,required:this._isFieldRequired(F,G)};if(G.stringFieldOption===da.STRING_FIELD_OPTION_TEXTAREA)return V["class"]=this.css.field+" "+this.css.textArea,
new J(V,P);if(G.stringFieldOption===da.STRING_FIELD_OPTION_RICHTEXT)return V["class"]=this.css.field+" "+this.css.richText,V.height="100%",V.width="100%",V.plugins=G.richTextPlugins||this._defaultRichTextPlugins,P=new T(V,P),P.startup(),P;var Y=this;V.validator=function(ca,Z){this._maskValidSubsetError=!1;this._hasBeenBlurred=!0;return Y._isFieldNullable(F,G)||!(""===ca||null===ca)};return new K(V,P)},_createTimeField:function(F,G,P){P=x.create("div",null,P);F={"class":this.css.field,trim:!0,required:this._isFieldRequired(F,
G),constraints:{formatLength:"medium"}};this._datePackage&&(F.datePackage=this._datePackage);return new b(F,P)},_createDateField:function(F,G,P){P=x.create("div",null,P);F={"class":this.css.field,trim:!0,required:this._isFieldRequired(F,G)};this._datePackage&&(F.datePackage=this._datePackage);return new E(F,P)},_createIntField:function(F,G,P){P=x.create("div",null,P);return new A({"class":this.css.field,constraints:"esriFieldTypeSmallInteger"===F.type?{min:-32768,max:32767,places:0}:{places:0},trim:!0,
invalidMessage:this.NLS_validationInt,required:this._isFieldRequired(F,G)},P)},_createFltField:function(F,G,P){P=x.create("div",null,P);return new A({"class":this.css.field,constraints:{max:Infinity,min:-Infinity,places:"0,20"},trim:!0,invalidMessage:this.NLS_validationFlt,required:this._isFieldRequired(F,G)},P)},_toStore:function(F){return new q({data:{identifier:"id",label:"name",items:F}})},_connect:function(F,G,P){this._aiConnects.push(l.connect(F,G,P))},_getDatePackage:function(F){return null===
F.datePackage?null:F.datePackage?F.datePackage:"ar"===g.locale?"dojox.date.islamic":null},_destroyAttributeTable:function(){h.forEach(this._layerInfos,function(F){h.forEach(F.fieldInfos,function(G){var P=G.dijit;if(P){P._onChangeHandle=null;if(G.customField)return;P instanceof Array?h.forEach(P,d.hitch(this,function(V){V.destroyRecursive?V.destroyRecursive():V.destroy&&V.destroy();V._onChangeHandle=null})):P.destroyRecursive?P.destroyRecursive():P.destroy&&P.destroy()}G.dijit=null},this)},this);h.forEach(this._toolTips,
function(F){F.destroy()});this._toolTips=[];this._attributes&&x.destroy(this._attributes)}});d.mixin(da,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});p("extend-esri")&&d.setObject("dijit.AttributeInspector",da,y);return da})},"esri/dijit/FeatureTable/dataUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/Deferred dojo/number dojo/string dojo/date/locale dojo/promise/all ../../libs/sanitizer/Sanitizer ../../config ../../graphic ../../numberUtils ../../request ../../ArcadeExpression ../../arcadeProfiles/popupProfile ../../layers/FeatureLayer ../../geometry/Extent ../../tasks/query ../../tasks/StatisticDefinition ../../tasks/QueryTask ../../tasks/RelationshipQuery dojo/i18n dojo/i18n!../../nls/jsapi".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v,C,Q,N,T,U){return{i18nStrings:U.widgets.FeatureTable,numericFieldTypes:["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeSmallInteger"],statisticDefinitions:[{type:"count",name:"countField"},{type:"sum",name:"sumField"},{type:"min",name:"minField"},{type:"max",name:"maxField"},{type:"avg",name:"avgField"},{type:"stddev",name:"stddevField"}],_reExprField:/^\s*expression\//i,sanitizer:new e({whiteList:{dd:[],dl:[],dt:[],h1:[],
h2:[],h3:[],h4:[],h5:[],h6:[],sub:[],sup:[],animate:[],animatetransform:[],circle:[],clippath:[],defs:[],ellipse:[],g:[],image:[],line:[],lineargradient:[],marker:[],mask:[],path:[],pattern:[],polygon:[],polyline:[],radialgradient:[],rect:[],stop:[],svg:[],"switch":[],symbol:[],text:[],textpath:[],tspan:[],use:[]}},!0),getOrderByString:function(m,u){return m+(u?" DESC":" ASC")},getWhereString:function(m,u){return m+"\x3d'"+u+"'"},getRelationshipWhereClause:function(m){var u=m.layer,M=m.originRelationship,
I=m.destinationRelationship,S=M.relationshipTableId||M.relatedTableId;M=M.keyFieldInRelationshipTable||M.keyField;var E=I.keyFieldInRelationshipTable||I.keyField,W=u.layerId==S?E:M;m=this.getWhereString(W,m.keyValue);M=u._url.path;M=M.substring(0,M.lastIndexOf("/")+1);return k({url:M+S+"/query",content:{f:"json",outFields:["*"],returnGeometry:!1,where:m},handleAs:"json",callbackParamName:"callback"}).then(d.hitch(this,function(A){if(A&&A.features&&A.features.length){var a=A.features,f=[],z="",J;H.forEach(a,
function(K,b){if(K.attributes&&K.attributes[E])J=K.attributes[E];else{var c=u.getField(W)?u.getField(W).name:null;if(this.isValueEmpty(c)){c=E.toUpperCase();var q=E.toLowerCase();J=K.attributes[c]||K.attributes[q]||null}else J=K.attributes[c]}-1===H.indexOf(f,J)&&(0<f.length&&b<a.length&&(z=z.concat(" OR ")),f.push(J),z=z.concat(this.getWhereString(I.keyField,J)))},this);return z}return null}))},isValueEmpty:function(m){return null===m||" "===m||""===m||"undefined"===typeof m},findFirst:function(m,
u,M){return H.filter(m,function(I){return I.hasOwnProperty(u)&&I[u]===M})[0]||null},compareIntArrays:function(m,u){m.sort();u.sort();var M=H.every(u,function(S){return-1!==H.indexOf(m,S)},this),I=H.every(m,function(S){return-1!==H.indexOf(u,S)},this);return M&&I},findFirstNumberColumn:function(m,u){var M;H.some(m,function(I,S){if(-1!==H.indexOf(this.numericFieldTypes,I.type)&&I.field!==u&&!I.hidden)return M=I,!0},this);return M},getRoundingPrecision:function(m){return 1E3<=m?0:10<=m?2:0<=m?4:6},generateLinkFromString:function(m){var u=
/^\s*(http?:\/\/([^\s]+))\s*$/i,M=/^\s*(https?:\/\/([^\s]+))\s*$/i;if("string"===typeof m){var I;u.test(m)?I=m.indexOf("http:"):M.test(m)&&(I=m.indexOf("https:"));-1<I&&-1===m.indexOf("href\x3d")?(u=m.indexOf(" ",I),-1===u&&(u=m.length),M=m.substring(I,u),m=m.substring(0,I)+"\x3ca href\x3d'"+M+"' target\x3d'_blank'\x3e"+M+"\x3c/a\x3e"+m.substring(u,m.length)):m=this.sanitizer.sanitize(m)}return this.isValueEmpty(m)?"":m},isNumericFieldType:function(m){return-1!==H.indexOf(this.numericFieldTypes,m)},
isIntegerFieldType:function(m){return"esriFieldTypeInteger"===m||"esriFieldTypeSmallInteger"===m},isFloatFieldType:function(m){return"esriFieldTypeDouble"===m||"esriFieldTypeSingle"===m},getDomainValueFromRow:function(m){var u=m.fieldInfo.name,M=m.fieldInfo.domain,I=m.row;if("range"===M.type)return I[u];m=H.filter(M.codedValues,function(S){return S.hasOwnProperty("code")&&S.code==I[u]});return m[0]&&!this.isValueEmpty(m[0].name)?m[0].name:I[u]},getTypeValueFromRow:function(m){var u=m.layerInfo[m.typesProperty],
M=m.typeIdProperty,I=m.fieldInfo,S=m.row;m=u&&u[0];if(m){var E=S[I.name];I=this.isNumericFieldType(I.type);I=(m="string"===typeof m[M])&&I?E.toString():E;E=(E=this.findFirst(u,M,I))?E.name:null}return E},getSubtypeDomainValue:function(m){var u=m.layerInfo,M=m.fieldInfo.name,I=m.row,S;m=(u=this.findFirst(u.types,"id",I[u.typeIdField]))?u.domains:null;if(!u||!m)return I[M];m[M]&&m[M].codedValues&&(S=H.filter(m[M].codedValues,function(E){return E.hasOwnProperty("code")&&E.code==I[M]}));return S&&S[0]&&
!this.isValueEmpty(S[0].name)?S[0].name:I[M]},mergeDictionaries:function(m,u){if(null===m||null===u)return m;for(var M in u){m[M]||(m[M]={});for(var I in u[M])m[M][I]=u[M][I]}return m},isCyclicalRelationship:function(m){return"esriRelCardinalityOneToOne"===m.cardinality||"esriRelCardinalityOneToMany"===m.cardinality&&"esriRelRoleDestination"===m.role},getColumnFromFieldName:function(m){return this.findFirst(m.grid.columns,"field",m.fieldName)},isDateFieldWithStringDataValue:function(m){return"esriFieldTypeDateOnly"===
m||"esriFieldTypeTimeOnly"===m||"esriFieldTypeTimestampOffset"===m},formatNumberForLocale:function(m,u){if(u){var M=T.getLocalization("dojo.cldr","number");if(u.digitSeparator||!M||this.isValueEmpty(m))return isNaN(m)||null===m?null:l.format(m,u);m=isNaN(m)||null===m?null:l.format(m,u);return m.replace(new RegExp("\\"+M.group,"g"),"")}return isNaN(m)||null===m?null:y.format(m,u)},getCombinedDateTime:function(m,u){return new Date(m.getFullYear(),m.getMonth(),m.getDate(),u.getHours(),u.getMinutes(),
u.getSeconds())},formatDateForLocale:function(m){var u=m.dateOptions||{},M=m.timestamp,I=m.fieldInfo,S=!1,E=!1;m={};u=(S=I&&I.dateOptions?I.dateOptions:!1)||u;S=S&&this.isValueEmpty(u.dateEnabled)?!0:!!u.dateEnabled;E=!!u.timeEnabled;this.isValueEmpty(u.datePattern)||(m.datePattern=u.datePattern);this.isValueEmpty(u.timeEnabled)||this.isValueEmpty(u.timePattern)||(m.timePattern=u.timePattern);m.selector=S&&E?"date and time":S&&!E?"date":!S&&E?"time":"date";return g.format(new Date(M),m)},calculateExtentFromFeatures:function(m){var u=
m[0].geometry,M;if(null===u&&1===m.length)return null;for(u=m.length-1;0<=u;u--)null===m[u].geometry&&m.splice(u,1);u=m[0].geometry;var I=u.getExtent();var S=m.length;null===I&&(I=new t(u.x,u.y,u.x,u.y,u.spatialReference));for(M=1;M<S;M++){u=m[M].geometry;var E=u.getExtent();null===E&&(E=new t(u.x,u.y,u.x,u.y,u.spatialReference));I=I.union(E)}return I},initFeatureLayer:function(m,u){m=m._url.path;m=m.substring(0,m.lastIndexOf("/")+1);return new B(m+u,{mode:B.MODE_ONDEMAND,outFields:["*"],visible:!0})},
applyEdits:function(m){var u=[],M=new h;if(!m||0>=m.length)return M.reject(),M;H.forEach(m,function(I){I.layer&&u.push(I.layer.applyEdits(I.adds,I.updates,I.deletes,function(S,E,W){M.resolve({adds:S,updates:E,deletes:W})},function(S){M.reject(S)}))});0<u.length?p(u):M.reject();return M},applyEditsFromRow:function(m){var u=m.layer,M=new D;M.setAttributes(m.row);return this.applyEdits([{layer:u,updates:[M]}],null)},queryLayer:function(m){var u=m.layer;m=m.ids||null;var M=new v;M.where="1\x3d1";M.returnGeometry=
!1;M.objectIds=m;return u.queryFeatures(M)},queryLayerForFeature:function(m){return this.queryLayerForFeatures({layer:m.layer,ids:[m.id]})},queryLayerForFeatures:function(m){var u=m.layer,M=u.advancedQueryCapabilities;M=M&&M.supportsQueryWithCacheHint;m=m.ids;var I=new v;I.objectIds=m;I.outFields=["*"];M&&(I.cacheHint=!0);return u.queryFeatures(I,function(S){return S.features})},queryLayerForCount:function(m){var u=m.layer,M=u.advancedQueryCapabilities;M=M&&M.supportsQueryWithCacheHint;if(u.queryCount){var I=
new v,S=m.layerInfo;m=m.where||"1\x3d1";I.returnGeometry=!1;I.returnCountOnly=!0;I.where=m;M&&(I.cacheHint=!0);return u.queryCount(I).then(function(E){return E}).otherwise(function(){return S.isFeatureCollection?u.graphics.length:2E3}).always(function(E){return E})}return this.queryLayerCustom({layer:u,returnCountOnly:!0,cacheHint:M}).then(function(E){return E&&E.features?E.features.length:0}).otherwise(function(){return u.maxRecordCount||2E3}).always(function(E){return E})},queryLayerCustom:function(m){var u=
new v,M=m.returnCountOnly||!1,I=m.where||"1\x3d1",S=m.returnGeometry||!1,E=m.outFields||["*"],W=m.cacheHint||!1;m=new Q(m.layer.url);u.returnGeometry=S;u.outFields=E;u.where=I;u.returnCountOnly=M;W&&(u.cacheHint=!0);return m.execute(u)},queryLayerForIds:function(m){var u=m.layer,M=u.advancedQueryCapabilities;M=M&&M.supportsQueryWithCacheHint;var I=m.idProperty;m=m.where||"1\x3d1";var S=new v;S.returnGeometry=!1;S.outFields=[I];S.where=m;S.returnIdsOnly=!0;M&&(S.cacheHint=!0);return u.queryIds(S)},
queryLayerForAttachments:function(m){return k({url:m.layer._url.path+"/queryAttachments",content:{f:"json",objectIds:m.ids},handleAs:"json",callbackParamName:"callback"})},queryLayerForAttachmentById:function(m){return m.layer.queryAttachmentInfos(m.id||0)},addAttachmentToLayer:function(m){return m.layer.addAttachment(m.featureId,m.formData)},deleteAttachmentFromLayer:function(m){return m.layer.deleteAttachments(m.featureId,[m.attachmentId])},queryLayerForRelatedRecords:function(m){var u=m.layer,
M=m.ids,I=m.outFields||["*"],S=m.relationship;m=m.returnCountOnly||!1;var E=new N;E.outFields=I;E.returnGeometry=!1;E.relationshipId=S.id;E.returnCountOnly=m;E.objectIds=M;return u.queryRelatedFeatures(E)},queryLayerForRelatedRecordCount:function(m){return k({url:m.layer._url.path+"/queryRelatedRecords",content:{f:"json",objectIds:m.objectIds.toString(),outFields:m.outFields,returnGeometry:!1,relationshipId:m.relationship.id,returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"})},getFieldStatistics:function(m){var u=
new h,M=m.layer,I=M.advancedQueryCapabilities;I=I&&I.supportsQueryWithCacheHint;var S=m.idProperty,E=m.where||"1\x3d1",W=m.filterIds,A=m.grid.columns[m.columnId].field;m=M.url;var a=[];var f=H.map(this.statisticDefinitions,function(J){var K=new C;K.onStatisticField=A;K.displayFieldName=A;K.outStatisticFieldName=J.name;K.statisticType=J.type;return K});var z=new v;z.outFields=[A];z.outStatistics=[];z.where=E;z.outStatistics=f;I&&(z.cacheHint=!0);W&&0<W.length&&(a=W);z.where&&0<a.length&&(z.where="("+
z.where+") AND ("+S+" IN ("+a.toString()+"))");M.source&&!this.isValueEmpty(M.source.mapLayerId)&&m.endsWith("/dynamicLayer")&&(m=m.slice(0,-13),m=m+"/"+M.source.mapLayerId);(new Q(m)).execute(z).then(function(J){u.resolve(J)}).otherwise(function(){u.reject()});return u},selectFeaturesById:function(m){var u=m.grid,M=u.layer;u=u.layerInfo;var I=m.map,S=m.ids;m=m.id;var E=new v;E.returnGeometry=!!I;E.objectIds=S||[m];u.isFeatureCollection||(E.where="1\x3d1");return M.selectFeatures(E,B.SELECTION_NEW)},
isFeatureEditable:function(m){var u=m.layerInfo;return!!m.layer.getEditCapabilities({userId:u.userIds[u.layerId]||null,feature:{attributes:m.attributes}}).canUpdate},isExpressionField:function(m){return this._reExprField.test(m)},getExpressionInfo:function(m,u){if(this.isExpressionField(u)){var M;u=u.replace(this._reExprField,"");u=u.toLowerCase();H.some(m,function(I){I.name.toLowerCase()===u&&(M=I);return!!M});return M}},compileExpressions:function(m){var u={};H.forEach(m,function(M){var I=M.returnType&&
M.returnType.toLowerCase();u[M.name]=new r({expression:M.expression,returnType:"number"===I?"number":"string",profile:O})});return u},getExpressionValue:function(m,u){var M=m.getLayer(),I=M&&M.getMap();return u?m.evaluateExpression(u,O.getEvalOptions({expression:u,feature:m,layer:M,map:I,spatialReference:I&&I.spatialReference})):null}}})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v,C,Q,N,T,U,m,u,M){function I(E){return new N({command:E.name})}function S(E){return new N({buttonClass:Q,command:E.name})}h=h("dijit.Editor",u,{plugins:null,extraPlugins:null,constructor:function(){y.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",T]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(k("ie")||k("trident")||k("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new l;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);y.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=n.getLocalization("dijit._editor",
"commands",this.lang);k("webkit")&&x.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new t({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));d.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);p.add(this.iframe.parentNode,"dijitEditorIFrameContainer");p.add(this.iframe,"dijitEditorIFrame");g.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){d.forEach(this._plugins,function(E){E&&E.destroy&&E.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(E,W){var A=y.isString(E)?{name:E}:y.isFunction(E)?{ctor:E}:E;if(!A.setEditor){var a={args:A,plugin:null,editor:this};A.name&&(N.registry[A.name]?a.plugin=N.registry[A.name](A):O.publish(M._scopeName+".Editor.getPlugin",a));if(!a.plugin)try{var f=
A.ctor||y.getObject(A.name)||H(A.name);f&&(a.plugin=new f(A))}catch(z){throw Error(this.id+": cannot find plugin ["+A.name+"]");}if(!a.plugin)throw Error(this.id+": cannot find plugin ["+A.name+"]");E=a.plugin}1<arguments.length?this._plugins[W]=E:this._plugins.push(E);E.setEditor(this);y.isFunction(E.setToolbar)&&E.setToolbar(this.toolbar)},resize:function(E){E&&C.prototype.resize.apply(this,arguments)},layout:function(){var E=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+e.getPadBorderExtents(this.iframe.parentNode).h+
e.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=E+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(E){var W,A=this.document.body,a=A.clientWidth,f=A.clientHeight,z=A.clientLeft,J=A.offsetWidth,K=A.offsetHeight,b=A.offsetLeft;/^rtl$/i.test(A.dir||"")?a<J&&E.x>a&&E.x<J&&(W=!0):E.x<z&&E.x>b&&(W=!0);W||f<K&&E.y>f&&E.y<K&&(W=!0);W||(delete this._cursorToStart,delete this._savedSelection,"BODY"==E.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(E){this.customUndo&&this.endEditing(!0);"BODY"!=E.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(E){this._inEditing||(this._inEditing=!0,this._beginEditing(E));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(E){if(!this.customUndo||
"undo"!=E&&"redo"!=E){this.customUndo&&(this.endEditing(),this._beginEditing());var W=this.inherited(arguments);this.customUndo&&this._endEditing();return W}return this[E]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(E){try{var W=this.document.execCommand(E,!1,null);if(k("webkit")&&!W)throw{};}catch(A){W=r.substitute,alert(W(this.commands.systemShortcut,
[this.commands[E],W(this.commands[k("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[E]])])),W=!1}return W},queryCommandEnabled:function(E){return!this.customUndo||"undo"!=E&&"redo"!=E?this.inherited(arguments):"undo"==E?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(E){var W=E.mark,A=E.mark;E=E.isCollapsed;var a;if(A)if(9>k("ie")||9===k("ie")&&k("quirks"))if(y.isArray(A))W=[],d.forEach(A,function(J){W.push(m.getNode(J,this.editNode))},this),this.selection.moveToBookmark({mark:W,
isCollapsed:E});else{if(A.startContainer&&A.endContainer&&(a=m.getSelection(this.window))&&a.removeAllRanges){a.removeAllRanges();E=m.create(this.window);var f=m.getNode(A.startContainer,this.editNode);var z=m.getNode(A.endContainer,this.editNode);f&&z&&(E.setStart(f,A.startOffset),E.setEnd(z,A.endOffset),a.addRange(E))}}else(a=m.getSelection(this.window))&&a.removeAllRanges&&(a.removeAllRanges(),E=m.create(this.window),f=m.getNode(A.startContainer,this.editNode),z=m.getNode(A.endContainer,this.editNode),
f&&z&&(E.setStart(f,A.startOffset),E.setEnd(z,A.endOffset),a.addRange(E)))},_changeToStep:function(E,W){this.setValue(W.text);(E=W.bookmark)&&this._moveToBookmark(E)},undo:function(){var E=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var W=this._steps.pop();W&&0<this._steps.length&&(this.focus(),this._changeToStep(W,this._steps[this._steps.length-1]),this._undoedSteps.push(W),this.onDisplayChanged(),delete this._undoRedoActive,E=!0);delete this._undoRedoActive}return E},
redo:function(){var E=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var W=this._undoedSteps.pop();W&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],W),this._steps.push(W),this.onDisplayChanged(),E=!0);delete this._undoRedoActive}return E},endEditing:function(E){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(E),this._inEditing=!1)},_getBookmark:function(){var E=this.selection.getBookmark(),
W=[];if(E&&E.mark){var A=E.mark;if(9>k("ie")||9===k("ie")&&k("quirks")){var a=m.getSelection(this.window);if(y.isArray(A))d.forEach(E.mark,function(z){W.push(m.getIndex(z,this.editNode).o)},this),E.mark=W;else if(a){var f;a.rangeCount&&(f=a.getRangeAt(0));E.mark=f?f.cloneRange():this.selection.getBookmark()}}try{E.mark&&E.mark.startContainer&&(W=m.getIndex(E.mark.startContainer,this.editNode).o,E.mark={startContainer:W,startOffset:E.mark.startOffset,endContainer:E.mark.endContainer===E.mark.startContainer?
W:m.getIndex(E.mark.endContainer,this.editNode).o,endOffset:E.mark.endOffset})}catch(z){E.mark=null}}return E},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:U.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var E=U.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:E,bookmark:this._getBookmark()})},onKeyDown:function(E){k("ie")||this.iframe||E.keyCode!=D.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var W=
E.keyCode;if(E.ctrlKey&&!E.shiftKey&&!E.altKey){if(90==W||122==W){E.stopPropagation();E.preventDefault();this.undo();return}if(89==W||121==W){E.stopPropagation();E.preventDefault();this.redo();return}}this.inherited(arguments);switch(W){case D.ENTER:case D.BACKSPACE:case D.DELETE:this.beginEditing();break;case 88:case 86:if(E.ctrlKey&&!E.altKey&&!E.metaKey){this.endEditing();88==E.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!E.ctrlKey&&!E.altKey&&
!E.metaKey&&(E.keyCode<D.F1||E.keyCode>D.F15)){this.beginEditing();break}case D.ALT:this.endEditing();break;case D.UP_ARROW:case D.DOWN_ARROW:case D.LEFT_ARROW:case D.RIGHT_ARROW:case D.HOME:case D.END:case D.PAGE_UP:case D.PAGE_DOWN:this.endEditing(!0);case D.CTRL:case D.SHIFT:case D.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(E){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(E){this.customUndo?this.isClosed?this.setValue(E):(this.beginEditing(),E||(E="\x26#160;"),this.setValue(E),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(E){this.setValueDeferred.then(y.hitch(this,function(){!this.disabled&&E||!this._buttonEnabledPlugins&&E?
d.forEach(this._plugins,function(W){W.set("disabled",!0)}):this.disabled&&!E&&d.forEach(this._plugins,function(W){W.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(x.set(this.document.body,"color",x.get(this.iframe,"color")),x.set(this.document.body,"background-color",x.get(this.iframe,"background-color")))}catch(E){}}});y.mixin(N.registry,{undo:I,redo:I,cut:I,copy:I,paste:I,insertOrderedList:I,insertUnorderedList:I,
indent:I,outdent:I,justifyCenter:I,justifyFull:I,justifyLeft:I,justifyRight:I,"delete":I,selectAll:I,removeFormat:I,unlink:I,insertHorizontalRule:I,bold:S,italic:S,underline:S,strikethrough:S,subscript:S,superscript:S,"|":function(){return new N({setEditor:function(E){this.editor=E;this.button=new v({ownerDocument:E.ownerDocument})}})}});return h})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(H,d,h,l,n,g,p,e){h("dijit-legacy-requires")&&n(0,function(){H(["dijit/ToolbarSeparator"])});return d("dijit.Toolbar",[g,e,p],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(H,d,h,l){return H("dijit.ToolbarSeparator",[h,l],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);d.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(H,d,h,l,n){d=d("dijit._editor._Plugin",l,{constructor:function(g){this.params=
g||{};h.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:n,disabled:!1,getLabel:function(g){return this.editor.commands[g]},_initButton:function(){if(this.command.length){var g=this.getLabel(this.command),p=this.editor,e=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(g=h.mixin({label:g,ownerDocument:p.ownerDocument,dir:p.dir,
lang:p.lang,showLabel:!1,iconClass:e,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete g.name,this.button=new this.buttonClass(g))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(g,p,e){this.own(H.connect(g,p,this,e))},updateState:function(){var g=this.editor,p=this.command;if(g&&g.isLoaded&&p.length){var e=this.get("disabled");if(this.button)try{var x=
g._implCommand(p);var D=!e&&(this[x]?this[x](p):g.queryCommandEnabled(p));this.enabled!==D&&(this.enabled=D,this.button.set("disabled",!D));if(D&&"boolean"==typeof this.button.checked){var y=g.queryCommandState(p);this.checked!==y&&(this.checked=y,this.button.set("checked",g.queryCommandState(p)))}}catch(k){console.log(k)}}},setEditor:function(g){this.editor=g;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",h.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",h.hitch(this,"updateState")))},setToolbar:function(g){this.button&&g.addChild(this.button)},set:function(g,p){if("object"===typeof g){for(var e in g)this.set(e,g[e]);return this}e=this._getAttrNames(g);if(this[e.s])var x=this[e.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(g,p);return x||this},get:function(g){var p=this._getAttrNames(g);
return this[p.g]?this[p.g]():this[g]},_setDisabledAttr:function(g){this._set("disabled",g);this.updateState()},_getAttrNames:function(g){var p=this._attrPairNames;if(p[g])return p[g];var e=g.charAt(0).toUpperCase()+g.substr(1);return p[g]={s:"_set"+e+"Attr",g:"_get"+e+"Attr"}},_set:function(g,p){this[g]=p}});d.registry={};return d})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y){return H("dijit._editor.plugins.EnterKeyHandling",x,{blockNodeForEnter:"BR",constructor:function(k){k&&("blockNodeForEnter"in k&&(k.blockNodeForEnter=k.blockNodeForEnter.toUpperCase()),l.mixin(this,k))},setEditor:function(k){if(this.editor!==k)if(this.editor=k,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,k.onLoadDeferred.then(l.hitch(this,function(O){this.own(n(k.document,"keydown",l.hitch(this,function(B){if(B.keyCode==h.ENTER){var t=l.mixin({},B);t.shiftKey=
!0;this.handleEnterKey(t)||(B.stopPropagation(),B.preventDefault())}})));9<=g("ie")&&10>=g("ie")&&this.own(n(k.document,"paste",l.hitch(this,function(B){setTimeout(l.hitch(this,function(){var t=this.editor.document.selection.createRange();t.move("character",-1);t.select();t.move("character",1);t.select()}),0)})));return O}));else if(this.blockNodeForEnter){var r=l.hitch(this,"handleEnterKey");k.addKeyHandler(13,0,0,r);k.addKeyHandler(13,0,1,r);this.own(this.editor.on("KeyPressed",l.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var k=this.editor.selection.getAncestorElement("LI");if(k){g("mozilla")&&"LI"==k.parentNode.parentNode.nodeName&&(k=k.parentNode.parentNode);var r=k.firstChild;!r||1!=r.nodeType||"UL"!=r.nodeName&&"OL"!=r.nodeName||(k.insertBefore(r.ownerDocument.createTextNode("\u00a0"),r),r=y.create(this.editor.window),r.setStart(k.firstChild,0),k=y.getSelection(this.editor.window,!0),k.removeAllRanges(),k.addRange(r))}else D.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(k=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(k.innerHTML=this.bogusHtmlContent,9>=g("ie")&&(k=this.editor.document.selection.createRange(),k.move("character",-1),k.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(k){var r,O=this.editor.document,B;if(k.shiftKey){k=this.editor.selection.getParentElement();if(r=y.getAncestor(k,this.blockNodes)){if("LI"==r.tagName)return!0;k=y.getSelection(this.editor.window);var t=k.getRangeAt(0);t.collapsed||(t.deleteContents(),k=y.getSelection(this.editor.window),t=k.getRangeAt(0));if(y.atBeginningOfContainer(r,t.startContainer,t.startOffset)){var v=O.createElement("br");t=y.create(this.editor.window);r.insertBefore(v,
r.firstChild);t.setStartAfter(v);k.removeAllRanges();k.addRange(t)}else if(y.atEndOfContainer(r,t.startContainer,t.startOffset))t=y.create(this.editor.window),v=O.createElement("br"),r.appendChild(v),r.appendChild(O.createTextNode("\u00a0")),t.setStart(r.lastChild,0),k.removeAllRanges(),k.addRange(t);else{if((B=t.startContainer)&&3==B.nodeType){var C=B.nodeValue;var Q=O.createTextNode(C.substring(0,t.startOffset));var N=O.createTextNode(C.substring(t.startOffset));r=O.createElement("br");""==N.nodeValue&&
g("webkit")&&(N=O.createTextNode("\u00a0"));d.place(Q,B,"after");d.place(r,Q,"after");d.place(N,r,"after");d.destroy(B);t=y.create(this.editor.window);t.setStart(N,0);k.removeAllRanges();k.addRange(t);return!1}return!0}}else k=y.getSelection(this.editor.window),k.rangeCount?(t=k.getRangeAt(0))&&t.startContainer&&(t.collapsed||(t.deleteContents(),k=y.getSelection(this.editor.window),t=k.getRangeAt(0)),(B=t.startContainer)&&3==B.nodeType?(r=t.startOffset,B.length<r&&(N=this._adjustNodeAndOffset(B,r),
B=N.node,r=N.offset),C=B.nodeValue,Q=O.createTextNode(C.substring(0,r)),N=O.createTextNode(C.substring(r)),r=O.createElement("br"),N.length||(N=O.createTextNode("\u00a0")),Q.length?d.place(Q,B,"after"):Q=B,d.place(r,Q,"after"),d.place(N,r,"after"),d.destroy(B)):(0<=t.startOffset&&(v=B.childNodes[t.startOffset]),r=O.createElement("br"),N=O.createTextNode("\u00a0"),v?(d.place(r,v,"before"),d.place(N,r,"after")):(B.appendChild(r),B.appendChild(N))),t=y.create(this.editor.window),t.setStart(N,0),t.setEnd(N,
N.length),k.removeAllRanges(),k.addRange(t),this.editor.selection.collapse(!0)):D.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var T=!0;k=y.getSelection(this.editor.window);t=k.getRangeAt(0);t.collapsed||(t.deleteContents(),k=y.getSelection(this.editor.window),t=k.getRangeAt(0));v=y.getBlockAncestor(t.endContainer,null,this.editor.editNode);var U=v.blockNode;if(this._checkListLater=U&&("LI"==U.nodeName||"LI"==U.parentNode.nodeName))return g("mozilla")&&(this._pressedEnterInBlock=
U),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(U.innerHTML)&&(U.innerHTML="",g("webkit")&&(t=y.create(this.editor.window),t.setStart(U,0),k.removeAllRanges(),k.addRange(t)),this._checkListLater=!1),!0;if(!v.blockNode||v.blockNode===this.editor.editNode){try{D.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(m){}v={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(v.blockNode){if(v.blockNode!=this.editor.editNode&&!(v.blockNode.textContent||v.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(v.blockNode),!1}else v.blockNode=this.editor.editNode;k=y.getSelection(this.editor.window);t=k.getRangeAt(0)}U=O.createElement(this.blockNodeForEnter);U.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(v.blockNode);N=t.endOffset;T=t.endContainer;T.length<N&&(N=this._adjustNodeAndOffset(T,N),T=
N.node,N=N.offset);if(y.atEndOfContainer(v.blockNode,T,N))v.blockNode===v.blockContainer?v.blockNode.appendChild(U):d.place(U,v.blockNode,"after"),T=!1,t=y.create(this.editor.window),t.setStart(U,0),k.removeAllRanges(),k.addRange(t),this.editor.height&&e.scrollIntoView(U);else if(y.atBeginningOfContainer(v.blockNode,t.startContainer,t.startOffset))d.place(U,v.blockNode,v.blockNode===v.blockContainer?"first":"before"),U.nextSibling&&this.editor.height&&(t=y.create(this.editor.window),t.setStart(U.nextSibling,
0),k.removeAllRanges(),k.addRange(t),e.scrollIntoView(U.nextSibling)),T=!1;else{v.blockNode===v.blockContainer?v.blockNode.appendChild(U):d.place(U,v.blockNode,"after");T=!1;v.blockNode.style&&U.style&&v.blockNode.style.cssText&&(U.style.cssText=v.blockNode.style.cssText);if((B=t.startContainer)&&3==B.nodeType){N=t.endOffset;B.length<N&&(N=this._adjustNodeAndOffset(B,N),B=N.node,N=N.offset);C=B.nodeValue;Q=O.createTextNode(C.substring(0,N));N=O.createTextNode(C.substring(N,C.length));d.place(Q,B,
"before");d.place(N,B,"after");d.destroy(B);for(t=Q.parentNode;t!==v.blockNode;){C=O.createElement(t.tagName);t.style&&C.style&&t.style.cssText&&(C.style.cssText=t.style.cssText);"FONT"===t.tagName&&(t.color&&(C.color=t.color),t.face&&(C.face=t.face),t.size&&(C.size=t.size));for(;N;)B=N.nextSibling,C.appendChild(N),N=B;d.place(C,t,"after");Q=t;N=C;t=t.parentNode}if(1==N.nodeType||3==N.nodeType&&N.nodeValue)U.innerHTML="";for(Q=N;N;)B=N.nextSibling,U.appendChild(N),N=B}t=y.create(this.editor.window);
O=Q;if("BR"!==this.blockNodeForEnter){for(;O;)r=O,O=B=O.firstChild;r&&r.parentNode?(U=r.parentNode,t.setStart(U,0),k.removeAllRanges(),k.addRange(t),this.editor.height&&e.scrollIntoView(U),g("mozilla")&&(this._pressedEnterInBlock=v.blockNode)):T=!0}else t.setStart(U,0),k.removeAllRanges(),k.addRange(t),this.editor.height&&e.scrollIntoView(U),g("mozilla")&&(this._pressedEnterInBlock=v.blockNode)}return T},_adjustNodeAndOffset:function(k,r){for(;k.length<r&&k.nextSibling&&3==k.nextSibling.nodeType;)r-=
k.length,k=k.nextSibling;return{node:k,offset:r}},removeTrailingBr:function(k){if(k=/P|DIV|LI/i.test(k.tagName)?k:this.editor.selection.getParentOfType(k,["P","DIV","LI"]))k.lastChild&&(1<k.childNodes.length&&3==k.lastChild.nodeType&&/^[\s\xAD]*$/.test(k.lastChild.nodeValue)||"BR"==k.lastChild.tagName)&&d.destroy(k.lastChild),k.childNodes.length||(k.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v,C,Q,N,T,U,m,u,M,I,S,E,W){var A=h("dijit._editor.RichText",[m,u],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&r.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new l},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[r.trim,r.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);v("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));v("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(v("ie")||v("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[r.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[r.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);Q.publish(W._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=r.hitch(this,function(J,K){return function(){return!this.execCommand(J,K)}}),f={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};v("ie")||(f.Z=a("redo"));for(var z in f)this.addKeyHandler(z,!0,!1,f[z])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(A._editorCommandsLocalized)this._local2NativeFormatNames=A._local2NativeFormatNames,this._native2LocalFormatNames=A._native2LocalFormatNames;else{A._editorCommandsLocalized=!0;A._local2NativeFormatNames={};
A._native2LocalFormatNames={};this._local2NativeFormatNames=A._local2NativeFormatNames;this._native2LocalFormatNames=A._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),f="",z,J=0;z=a[J++];)f="l"!==z.charAt(1)?f+("\x3c"+z+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+z+"\x3e\x3cbr/\x3e"):f+("\x3c"+z+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+z+"\x3e\x3cbr/\x3e");var K=e.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:f});this.ownerDocumentBody.appendChild(K);
a=r.hitch(this,function(){for(var b=K.firstChild;b;)try{this.selection.selectElement(b.firstChild);var c=b.tagName.toLowerCase();this._local2NativeFormatNames[c]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[c]]=c;b=b.nextSibling.nextSibling}catch(q){}e.destroy(K)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new l;this.isClosed||this.close();Q.publish(W._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var f=this.domNode;if(r.isString(this.value)){var z=this.value;f.innerHTML=""}else if(f.nodeName&&"textarea"==f.nodeName.toLowerCase()){var J=this.textarea=f;this.name=J.name;z=J.value;f=this.domNode=this.ownerDocument.createElement("div");f.setAttribute("widgetId",this.id);J.removeAttribute("widgetId");f.cssText=J.cssText;f.className+=" "+J.className;e.place(f,J,"before");var K=r.hitch(this,function(){D.set(J,{display:"block",position:"absolute",
top:"-1000px"});if(v("ie")){var w=J.style;this.__overflow=w.overflow;w.overflow="hidden"}});v("ie")?this.defer(K,10):K();if(J.form){var b=J.value;this.reset=function(){this.getValue()!==b&&this.replaceValue(b)};O(J.form,"submit",r.hitch(this,function(){g.set(J,"disabled",this.disabled);J.value=this.getValue()}))}}else z=S.getChildrenHtml(f),f.innerHTML="";this.value=z;f.nodeName&&"LI"===f.nodeName&&(f.innerHTML=" \x3cbr\x3e");this.header=f.ownerDocument.createElement("div");f.appendChild(this.header);
this.editingArea=f.ownerDocument.createElement("div");f.appendChild(this.editingArea);this.footer=f.ownerDocument.createElement("div");f.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!d.useXDomain||d.allowXdRichTextSave)){if((z=n.byId(W._scopeName+"._editor.RichText.value"))&&""!==z.value){K=z.value.split(this._SEPARATOR);for(var c=0,q;q=K[c++];)if(q=q.split(this._NAME_CONTENT_SEP),q[0]===this.name){this.value=q[1];K=K.splice(c,1);z.value=K.join(this._SEPARATOR);
break}}A._globalSaveHandler||(A._globalSaveHandler={},N.addOnUnload(function(){for(var w in A._globalSaveHandler){var L=A._globalSaveHandler[w];r.isFunction(L)&&L()}}));A._globalSaveHandler[this.id]=r.hitch(this,"_saveContent")}this.isClosed=!1;z=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");z.id=this.id+"_iframe";z.style.border="none";z.style.width="100%";this._layoutMode?z.style.height="100%":7<=v("ie")?(this.height&&(z.style.height=this.height),this.minHeight&&(z.style.minHeight=
this.minHeight)):z.style.height=this.height?this.height:this.minHeight;z.frameBorder=0;z._loadFunc=r.hitch(this,function(w){this.window=w;this.document=w.document;this.selection=new M.SelectionManager(w);v("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});K=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");K=11>v("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+K+"');document.close()":"javascript: '"+
K+"'";this.editingArea.appendChild(z);z.src=K;"LI"===f.nodeName&&(f.lastChild.style.marginTop="-1.2em");p.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=D.getComputedStyle(this.domNode);if(this["aria-label"])var f=this["aria-label"];else{var z=B('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||n.byId(this["aria-labelledby"],this.ownerDocument);z&&(f=z.textContent||z.innerHTML||"")}z="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(f?" aria-label\x3d'"+C.escape(f)+"'":"")+"\x3e\x3c/div\x3e";var J=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),K=a.lineHeight;K=0<=K.indexOf("px")?parseFloat(K)/parseFloat(a.fontSize):0<=K.indexOf("em")?parseFloat(K):"normal";var b="",c=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(q){q=q.replace(/^;/ig,"")+";";var w=q.split(":")[0];if(w){w=r.trim(w);w=w.toLowerCase();var L,R="";for(L=0;L<w.length;L++){var X=w.charAt(L);switch(X){case "-":L++,X=w.charAt(L).toUpperCase();default:R+=
X}}D.set(c.domNode,R,"")}b+=q+";"});this.iframe.setAttribute("title",f);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||y.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",f?"\x3ctitle\x3e"+C.escape(f)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",J,";\n",this.height||v("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",K,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",v("ie")||v("trident")||v("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",f?" aria-label\x3d'"+C.escape(f)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+b+"'\x3e",z,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var f="",z=0,J,K=U.get(this.ownerDocument);J=a[z++];)J=(new T(K.location,J)).toString(),this.editingAreaStyleSheets.push(J),f+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+J+'"/\x3e';return f},addStyleSheet:function(a){var f=a.toString(),z=U.get(this.ownerDocument);if("."===f.charAt(0)||"/"!==f.charAt(0)&&!a.host)f=(new T(z.location,f)).toString();-1<H.indexOf(this.editingAreaStyleSheets,f)||(this.editingAreaStyleSheets.push(f),
this.onLoadDeferred.then(r.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(f);else{var J=this.document.getElementsByTagName("head")[0],K=this.document.createElement("link");K.rel="stylesheet";K.type="text/css";K.href=f;J.appendChild(K)}})))},removeStyleSheet:function(a){var f=a.toString(),z=U.get(this.ownerDocument);if("."===f.charAt(0)||"/"!==f.charAt(0)&&!a.host)f=(new T(z.location,f)).toString();a=H.indexOf(this.editingAreaStyleSheets,f);-1!==a&&(delete this.editingAreaStyleSheets[a],
B('link[href\x3d"'+f+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var f=v("ie")&&(this.isLoaded||!this.focusOnLoad);f&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;f&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(v("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var z in a)if(a.hasOwnProperty(z))try{this.document.execCommand(z,
!1,a[z])}catch(J){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=E.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var f=this;this.beforeIframeNode=e.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=e.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){f.editNode.focus()};this.focusNode=
this.editNode;var z=this.events.concat(this.captureEvents),J=this.iframe?this.document:this.editNode;this.own.apply(this,H.map(z,function(K){var b=K.toLowerCase().replace(/^on/,"");return O(J,b,r.hitch(this,K))},this));this.own(O(J,"mouseup",r.hitch(this,"onClick")));v("ie")&&(this.own(O(this.document,"mousedown",r.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);v("webkit")&&(this._webkitListener=this.own(O(this.document,"mouseup",r.hitch(this,"onDisplayChanged")))[0],this.own(O(this.document,
"mousedown",r.hitch(this,function(K){K=K.target;!K||K!==this.document.body&&K!==this.document||this.defer("placeCursorAtEnd")}))));if(v("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(K){}this.isLoaded=!0;this.set("disabled",this.disabled);z=r.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&t(r.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(z):z()},onKeyDown:function(a){if(a.keyCode===k.SHIFT||a.keyCode===k.ALT||a.keyCode===k.META||a.keyCode===k.CTRL)return!0;a.keyCode===k.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")&&this.execCommand(a.shiftKey?"outdent":"indent"));if(a.keyCode==k.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>v("ie")&&a.keyCode===k.BACKSPACE&&"Control"===this.document.selection.type&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));v("ff")&&(a.keyCode===k.PAGE_UP||a.keyCode===k.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var f=this._keyHandlers[a.keyCode],z=arguments;f&&!a.altKey&&H.some(f,function(J){if(!(J.shift^a.shiftKey||J.ctrl^(a.ctrlKey||a.metaKey)))return J.handler.apply(this,z)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){y.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?g.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(r.hitch(this,function(){g.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,f,z,J){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));r.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:z||!1,ctrl:f||!1,handler:J})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(v("ie")||v("trident"))&&this.defer(function(){E.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var f=this.getValue(!0);if(f!==this.value)this.onChange(f);
this._set("value",f)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!v("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>v("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,f){a=a.toLowerCase();"formatblock"===a?v("safari")&&void 0===f&&(a="heading"):"hilitecolor"!==a||v("mozilla")||(a="backcolor");return a},_implCommand:function(a){return"_"+this._normalizeCommand(a)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(a){var f=this._qcaCache[a];return void 0!==f?f:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return v("ie")||v("trident")||v("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!v("webkit");default:return!1}},execCommand:function(a,f){this.focused&&this.focus();a=this._normalizeCommand(a,f);if(void 0!==f){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(v("ie")||v("trident"))&&(f="\x3c"+f+"\x3e")}var z="_"+a+"Impl";if(this[z])var J=this[z](f);else if((f=1<arguments.length?f:null)||"createlink"!==a)J=this.document.execCommand(a,!1,f);this.onDisplayChanged();return J},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var f=this._implCommand(a);return this[f]?this[f](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(f){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(v("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(v("mozilla")&&"hilitecolor"===a){try{var f=this.document.queryCommandValue("styleWithCSS")}catch(z){f=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,f)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,f){return this.selection[a].apply(this.selection,f)},placeCursorAtStart:function(){this.focus();var a=!1;if(v("mozilla"))for(var f=this.editNode.firstChild;f;){if(3===f.nodeType){if(0<f.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(f);break}}else if(1===f.nodeType){a=!0;var z=f.tagName?f.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(z)?this.selection.selectElement(f):
this.selection.selectElementChildren(f);break}f=f.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(v("mozilla"))for(var f=this.editNode.lastChild;f;){if(3===f.nodeType){if(0<f.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(f);break}}else if(1===f.nodeType){a=!0;this.selection.selectElement(f.lastChild||f);break}f=f.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var f=this.isClosed?this.domNode:this.editNode;f.innerHTML=a;this._preDomFilterContent(f)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(r.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!v("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var f=
a;H.forEach(this.contentPreFilters,function(z){z&&(f=z(f))});return f},_preDomFilterContent:function(a){a=a||this.editNode;H.forEach(this.contentDomPreFilters,function(f){f&&r.isFunction(f)&&f(a)},this)},_postFilterContent:function(a,f){if(r.isString(a))var z=a;else a=a||this.editNode,this.contentDomPostFilters.length&&(f&&(a=r.clone(a)),H.forEach(this.contentDomPostFilters,function(J){a=J(a)})),z=S.getChildrenHtml(a);r.trim(z.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(z="");H.forEach(this.contentPostFilters,
function(J){z=J(z)});return z},_saveContent:function(){var a=n.byId(W._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,f){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");f||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){y.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return S.getNodeHtml(a)},getNodeChildrenHtml:function(a){y.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return S.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);v("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var f=this.textarea.style;f.position="";f.left=f.top="";v("ie")&&(f.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;e.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;p.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);A._globalSaveHandler&&delete A._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset="utf-8" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ >])/gi,"\x3c$1b$2").replace(/<(\/)?em([ >])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
var f=9>v("ie")?this.document.selection.createRange():this.document;try{return f.queryCommandEnabled(a)}catch(z){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=v("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=v("mozilla")||v("webkit")?this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=
!0;return a=v("mozilla")||v("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;v("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;v("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");return a},_pasteEnabledImpl:function(){var a=!0;return v("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},
_inserthorizontalruleImpl:function(a){return v("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(v("mozilla")||v("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",!1,a)},_hilitecolorImpl:function(a){if(!this._handleTextColorOrProperties("hilitecolor",a))if(v("mozilla")){this.document.execCommand("styleWithCSS",
!1,!0);console.log("Executing color command.");var f=this.document.execCommand("hilitecolor",!1,a);this.document.execCommand("styleWithCSS",!1,!1)}else f=this.document.execCommand("hilitecolor",!1,a);return f},_backcolorImpl:function(a){v("ie")&&(a=a?a:null);var f=this._handleTextColorOrProperties("backcolor",a);f||(f=this.document.execCommand("backcolor",!1,a));return f},_forecolorImpl:function(a){v("ie")&&(a=a?a:null);var f=!1;(f=this._handleTextColorOrProperties("forecolor",a))||(f=this.document.execCommand("forecolor",
!1,a));return f},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var f=!0;if(9>v("ie")){var z=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var J=z.item(0);z.length;)z.remove(z.item(0));J.outerHTML=a}else z.pasteHTML(a);z.select()}else if(8>v("trident")){var K=I.getSelection(this.window);if(K&&K.rangeCount&&K.getRangeAt){z=K.getRangeAt(0);z.deleteContents();var b=e.create("div");b.innerHTML=a;for(J=this.document.createDocumentFragment();a=
b.firstChild;)var c=J.appendChild(a);z.insertNode(J);c&&(z=z.cloneRange(),z.setStartAfter(c),z.collapse(!1),K.removeAllRanges(),K.addRange(z))}}else v("mozilla")&&!a.length?this.selection.remove():f=this.document.execCommand("inserthtml",!1,a);return f},_boldImpl:function(a){var f=!1;if(v("ie")||v("trident"))this._adaptIESelection(),f=this._adaptIEFormatAreaAndExec("bold");f||(f=this.document.execCommand("bold",!1,a));return f},_italicImpl:function(a){var f=!1;if(v("ie")||v("trident"))this._adaptIESelection(),
f=this._adaptIEFormatAreaAndExec("italic");f||(f=this.document.execCommand("italic",!1,a));return f},_underlineImpl:function(a){var f=!1;if(v("ie")||v("trident"))this._adaptIESelection(),f=this._adaptIEFormatAreaAndExec("underline");f||(f=this.document.execCommand("underline",!1,a));return f},_strikethroughImpl:function(a){var f=!1;if(v("ie")||v("trident"))this._adaptIESelection(),f=this._adaptIEFormatAreaAndExec("strikethrough");f||(f=this.document.execCommand("strikethrough",!1,a));return f},_superscriptImpl:function(a){var f=
!1;if(v("ie")||v("trident"))this._adaptIESelection(),f=this._adaptIEFormatAreaAndExec("superscript");f||(f=this.document.execCommand("superscript",!1,a));return f},_subscriptImpl:function(a){var f=!1;if(v("ie")||v("trident"))this._adaptIESelection(),f=this._adaptIEFormatAreaAndExec("subscript");f||(f=this.document.execCommand("subscript",!1,a));return f},_fontnameImpl:function(a){if(v("ie")||v("trident"))var f=this._handleTextColorOrProperties("fontname",a);f||(f=this.document.execCommand("fontname",
!1,a));return f},_fontsizeImpl:function(a){if(v("ie")||v("trident"))var f=this._handleTextColorOrProperties("fontsize",a);f||(f=this.document.execCommand("fontsize",!1,a));return f},_insertorderedlistImpl:function(a){var f=!1;if(v("ie")||v("trident")||v("edge"))f=this._adaptIEList("insertorderedlist",a);f||(f=this.document.execCommand("insertorderedlist",!1,a));return f},_insertunorderedlistImpl:function(a){var f=!1;if(v("ie")||v("trident")||v("edge"))f=this._adaptIEList("insertunorderedlist",a);
f||(f=this.document.execCommand("insertunorderedlist",!1,a));return f},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var f=0;if(a&&a.childNodes){var z;for(z=0;z<a.childNodes.length;z++){var J=x.position(a.childNodes[z]);f+=J.h}}return f},_isNodeEmpty:function(a,f){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],f):!0:3===a.nodeType?
""===a.nodeValue.substring(f):!1},_removeStartingRangeFromRange:function(a,f){if(a.nextSibling)f.setStart(a.nextSibling,0);else{for(a=a.parentNode;a&&null==a.nextSibling;)a=a.parentNode;a&&f.setStart(a.nextSibling,0)}return f},_adaptIESelection:function(){var a=I.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var f=a.getRangeAt(0),z=f.startContainer,J=f.startOffset;3===z.nodeType&&J>=z.length&&z.nextSibling;)J-=z.length,z=z.nextSibling;for(var K=null;this._isNodeEmpty(z,J)&&z!==
K;)K=z,f=this._removeStartingRangeFromRange(z,f),z=f.startContainer,J=0;a.removeAllRanges();a.addRange(f)}},_adaptIEFormatAreaAndExec:function(a){var f=I.getSelection(this.window),z=this.document,J;if(a&&f&&f.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);var K=f.getRangeAt(0);var b=K.startContainer;if(3===b.nodeType){var c=K.endOffset;b.length<c&&(c=this._adjustNodeAndOffset(q,c),b=c.node,c=c.offset)}for(;b&&b!==this.editNode;){var q=b.tagName?b.tagName.toLowerCase():"";
if(-1<H.indexOf(a,q)){var w=b;break}b=b.parentNode}if(w&&(q=K.startContainer,a=z.createElement(w.tagName),e.place(a,w,"after"),q&&3===q.nodeType)){c=K.endOffset;q.length<c&&(c=this._adjustNodeAndOffset(q,c),q=c.node,c=c.offset);b=q.nodeValue;K=z.createTextNode(b.substring(0,c));var L=b.substring(c,b.length);L&&(J=z.createTextNode(L));e.place(K,q,"before");if(J){var R=z.createElement("span");R.className="ieFormatBreakerSpan";e.place(R,q,"after");e.place(J,R,"after");J=R}e.destroy(q);c=K.parentNode;
for(q=[];c!==w;){b=c.tagName;K={tagName:b};q.push(K);b=z.createElement(b);c.style&&b.style&&c.style.cssText&&(b.style.cssText=c.style.cssText,K.cssText=c.style.cssText);"FONT"===c.tagName&&(c.color&&(b.color=c.color,K.color=c.color),c.face&&(b.face=c.face,K.face=c.face),c.size&&(b.size=c.size,K.size=c.size));c.className&&(b.className=c.className,K.className=c.className);if(J)for(;J;)K=J.nextSibling,b.appendChild(J),J=K;b.tagName==c.tagName?(R=z.createElement("span"),R.className="ieFormatBreakerSpan",
e.place(R,c,"after"),e.place(b,R,"after")):e.place(b,c,"after");K=c;J=b;c=c.parentNode}if(J){if(1===J.nodeType||3===J.nodeType&&J.nodeValue)a.innerHTML="";for(;J;)K=J.nextSibling,a.appendChild(J),J=K}if(q.length){K=q.pop();J=z.createElement(K.tagName);K.cssText&&J.style&&(J.style.cssText=K.cssText);K.className&&(J.className=K.className);"FONT"===K.tagName&&(K.color&&(J.color=K.color),K.face&&(J.face=K.face),K.size&&(J.size=K.size));for(e.place(J,a,"before");q.length;)K=q.pop(),w=z.createElement(K.tagName),
K.cssText&&w.style&&(w.style.cssText=K.cssText),K.className&&(w.className=K.className),"FONT"===K.tagName&&(K.color&&(w.color=K.color),K.face&&(w.face=K.face),K.size&&(w.size=K.size)),J.appendChild(w),J=w;w=z.createTextNode(".");R.appendChild(w);J.appendChild(w)}else R=z.createElement("span"),R.className="ieFormatBreakerSpan",w=z.createTextNode("."),R.appendChild(w),e.place(R,a,"before");J=I.create(this.window);J.setStart(w,0);J.setEnd(w,w.length);f.removeAllRanges();f.addRange(J);this.selection.collapse(!1);
w.parentNode.innerHTML="";a.firstChild||e.destroy(a);return!0}return!1}K=f.getRangeAt(0);if((q=K.startContainer)&&3===q.nodeType)return c=K.startOffset,q.length<c&&(c=this._adjustNodeAndOffset(q,c),q=c.node,c=c.offset),b=q.nodeValue,K=z.createTextNode(b.substring(0,c)),L=b.substring(c),""!==L&&(J=z.createTextNode(b.substring(c))),R=z.createElement("span"),w=z.createTextNode("."),R.appendChild(w),K.length?e.place(K,q,"after"):K=q,e.place(R,K,"after"),J&&e.place(J,R,"after"),e.destroy(q),J=I.create(this.window),
J.setStart(w,0),J.setEnd(w,w.length),f.removeAllRanges(),f.addRange(J),z.execCommand(a),e.place(R.firstChild,R,"before"),e.destroy(R),J.setStart(w,0),J.setEnd(w,w.length),f.removeAllRanges(),f.addRange(J),this.selection.collapse(!1),w.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var f=I.getSelection(this.window);if(f.isCollapsed&&f.rangeCount&&!this.queryCommandValue(a)){var z=f.getRangeAt(0),J=z.startContainer;if(J&&3==J.nodeType&&!z.startOffset)return z="ul","insertorderedlist"===
a&&(z="ol"),a=this.document.createElement(z),z=e.create("li",null,a),e.place(a,J,"before"),z.appendChild(J),e.create("br",null,a,"after"),a=I.create(this.window),a.setStart(J,0),a.setEnd(J,J.length),f.removeAllRanges(),f.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,f){var z=I.getSelection(this.window),J=this.document,K,b;f=f||null;if(a&&z&&z.isCollapsed&&z.rangeCount){var c=z.getRangeAt(0);if((K=c.startContainer)&&3===K.nodeType){var q=c.startOffset;
K.length<q&&(c=this._adjustNodeAndOffset(K,q),K=c.node,q=c.offset);var w=K.nodeValue;c=J.createTextNode(w.substring(0,q));""!==w.substring(q)&&(b=J.createTextNode(w.substring(q)));w=J.createElement("span");q=J.createTextNode(".");w.appendChild(q);J=J.createElement("span");w.appendChild(J);c.length?e.place(c,K,"after"):c=K;e.place(w,c,"after");b&&e.place(b,w,"after");e.destroy(K);K=I.create(this.window);K.setStart(q,0);K.setEnd(q,q.length);z.removeAllRanges();z.addRange(K);if(v("webkit")){z="color";
if("hilitecolor"===a||"backcolor"===a)z="backgroundColor";D.set(w,z,f);this.selection.remove();e.destroy(J);w.innerHTML="\x26#160;";this.selection.selectElement(w);this.focus()}else this.execCommand(a,f),e.place(w.firstChild,w,"before"),e.destroy(w),K.setStart(q,0),K.setEnd(q,q.length),z.removeAllRanges(),z.addRange(K),this.selection.collapse(!1),q.parentNode.removeChild(q);return!0}}return!1},_adjustNodeAndOffset:function(a,f){for(;a.length<f&&a.nextSibling&&3===a.nextSibling.nodeType;)f-=a.length,
a=a.nextSibling;return{node:a,offset:f}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return B(".ieFormatBreakerSpan",a).forEach(function(f){for(;f.firstChild;)e.place(f.firstChild,f,"before");e.destroy(f)}),a},_stripTrailingEmptyNodes:function(a){function f(z){return/^(p|div|br)$/i.test(z.nodeName)&&
0==z.children.length&&/^[\s\xA0]*$/.test(z.textContent||z.innerText||"")||3===z.nodeType&&/^[\s\xA0]*$/.test(z.nodeValue)}for(;a.lastChild&&f(a.lastChild);)e.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(r.hitch(this,function(){this.editNode.dir=a}))}});return A})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(H,d,h){var l={getIndex:function(p,e){for(var x=[],D=[],y=p,k,r;p!=
e;){var O=0;for(k=p.parentNode;r=k.childNodes[O++];)if(r===p){--O;break}x.unshift(O);D.unshift(O-k.childNodes.length);p=k}if(0<x.length&&3==y.nodeType){for(r=y.previousSibling;r&&3==r.nodeType;)x[x.length-1]--,r=r.previousSibling;for(r=y.nextSibling;r&&3==r.nodeType;)D[D.length-1]++,r=r.nextSibling}return{o:x,r:D}},getNode:function(p,e){if(!h.isArray(p)||0==p.length)return e;var x=e;H.every(p,function(D){if(0<=D&&D<x.childNodes.length)x=x.childNodes[D];else return x=null,!1;return!0});return x},getCommonAncestor:function(p,
e,x){x=x||p.ownerDocument.body;var D=function(r){for(var O=[];r;)if(O.unshift(r),r!==x)r=r.parentNode;else break;return O};p=D(p);e=D(e);D=Math.min(p.length,e.length);for(var y=p[0],k=1;k<D;k++)if(p[k]===e[k])y=p[k];else break;return y},getAncestor:function(p,e,x){for(x=x||p.ownerDocument.body;p&&p!==x;){var D=p.nodeName.toUpperCase();if(e.test(D))return p;p=p.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(p,e,x){x=x||p.ownerDocument.body;
e=e||l.BlockTagNames;for(var D=null,y;p&&p!==x;){var k=p.nodeName.toUpperCase();!D&&e.test(k)&&(D=p);!y&&/^(?:BODY|TD|TH|CAPTION)$/.test(k)&&(y=p);p=p.parentNode}return{blockNode:D,blockContainer:y||p.ownerDocument.body}},atBeginningOfContainer:function(p,e,x){var D=!1,y=0==x;y||3!=e.nodeType||/^[\s\xA0]+$/.test(e.nodeValue.substr(0,x))&&(y=!0);if(y)for(D=!0;e&&e!==p;){if(e.previousSibling){D=!1;break}e=e.parentNode}return D},atEndOfContainer:function(p,e,x){var D=!1,y=x==(e.length||e.childNodes.length);
y||3!=e.nodeType||/^[\s\xA0]+$/.test(e.nodeValue.substr(x))&&(y=!0);if(y)for(D=!0;e&&e!==p;){if(e.nextSibling){D=!1;break}e=e.parentNode}return D},adjacentNoneTextNode:function(p,e){var x=p;p=0-p.length||0;for(e=e?"nextSibling":"previousSibling";x&&3==x.nodeType;)p+=x.length,x=x[e];return[x,p]},create:function(p){p=p||window;return p.getSelection?p.document.createRange():new g},getSelection:function(p,e){if(p.getSelection)return p.getSelection();p=new n.selection(p);e||p._getCurrentSelection();return p}};
if(!window.getSelection)var n=l.ie={cachedSelection:{},selection:function(p){this._ranges=[];this.addRange=function(e,x){this._ranges.push(e);x||e._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(e){return this._ranges[e]};this._getCurrentSelection=function(){this.removeAllRanges();var e=p.document.selection.createRange();e="CONTROL"==p.document.selection.type.toUpperCase()?new g(n.decomposeControlRange(e)):
new g(n.decomposeTextRange(e));this.addRange(e,!0),this.isCollapsed=e.collapsed}},decomposeControlRange:function(p){var e=p.item(0),x=p.item(p.length-1);p=e.parentNode;var D=x.parentNode;e=l.getIndex(e,p).o[0];x=l.getIndex(x,D).o[0]+1;return[p,e,D,x]},getEndPoint:function(p,e){var x=p.duplicate();x.collapse(!e);var D="EndTo"+(e?"End":"Start"),y=x.parentElement(),k;if(0<y.childNodes.length)H.every(y.childNodes,function(B,t){if(3!=B.nodeType)if(x.moveToElementText(B),0<x.compareEndPoints(D,p))if(k&&
3==k.nodeType){r=k;var v=!0}else return r=y,O=t,!1;else{if(t==y.childNodes.length-1)return r=y,O=y.childNodes.length,!1}else t==y.childNodes.length-1&&(r=B,v=!0);if(v&&r)return r=(B=l.adjacentNoneTextNode(r)[0])?B.nextSibling:y.firstChild,t=l.adjacentNoneTextNode(r),B=t[0],t=t[1],B?(x.moveToElementText(B),x.collapse(!1)):x.moveToElementText(y),x.setEndPoint(D,p),O=x.text.length-t,!1;k=B;return!0});else{var r=y;var O=0}e||1!=r.nodeType||O!=r.childNodes.length||(e=r.nextSibling)&&3==e.nodeType&&(r=
e,O=0);return[r,O]},setEndPoint:function(p,e,x){p=p.duplicate();var D;if(3!=e.nodeType)if(0<x){if(D=e.childNodes[x-1])if(3==D.nodeType)e=D,x=D.length;else if(D.nextSibling&&3==D.nextSibling.nodeType)e=D.nextSibling,x=0;else{p.moveToElementText(D.nextSibling?D:e);var y=D.parentNode;D=y.insertBefore(D.ownerDocument.createTextNode(" "),D.nextSibling);p.collapse(!1);y.removeChild(D)}}else p.moveToElementText(e),p.collapse(!0);3==e.nodeType&&(D=l.adjacentNoneTextNode(e),y=D[0],D=D[1],y?(p.moveToElementText(y),
p.collapse(!1),"inherit"!=y.contentEditable&&D++):(p.moveToElementText(e.parentNode),p.collapse(!0),p.move("character",1),p.move("character",-1)),x+=D,0<x&&p.move("character",x)!=x&&console.error("Error when moving!"));return p},decomposeTextRange:function(p){var e=n.getEndPoint(p),x=e[0],D=e[1],y=e[0];e=e[1];p.htmlText.length&&(p.htmlText==p.text?e=D+p.text.length:(e=n.getEndPoint(p,!0),y=e[0],e=e[1]));return[x,D,y,e]},setRange:function(p,e,x,D,y,k){e=n.setEndPoint(p,e,x);p.setEndPoint("StartToStart",
e);if(!k)var r=n.setEndPoint(p,D,y);p.setEndPoint("EndToEnd",r||e);return p}},g=l.W3CRange=d(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?l.getCommonAncestor(this.startContainer,
this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(p,e){e=parseInt(e);if(this.startContainer!==p||this.startOffset!=e)delete this._cachedBookmark,this.startContainer=p,this.startOffset=e,this.endContainer?this._updateInternal():this.setEnd(p,e)},setEnd:function(p,e){e=parseInt(e);if(this.endContainer!==p||this.endOffset!=e)delete this._cachedBookmark,this.endContainer=p,this.endOffset=e,this.startContainer?
this._updateInternal():this.setStart(p,e)},setStartAfter:function(p,e){this._setPoint("setStart",p,e,1)},setStartBefore:function(p,e){this._setPoint("setStart",p,e,0)},setEndAfter:function(p,e){this._setPoint("setEnd",p,e,1)},setEndBefore:function(p,e){this._setPoint("setEnd",p,e,0)},_setPoint:function(p,e,x,D){x=l.getIndex(e,e.parentNode).o;this[p](e.parentNode,x.pop()+D)},_getIERange:function(){var p=(this._body||this.endContainer.ownerDocument.body).createTextRange();n.setRange(p,this.startContainer,
this.startOffset,this.endContainer,this.endOffset,this.collapsed);return p},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var p=this.startContainer,e=this._getIERange();3!==p.nodeType||this.startOffset||this.setStartBefore(p);e.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var p=new g([this.startContainer,this.startOffset,
this.endContainer,this.endOffset]);p._body=this._body;return p},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});h.setObject("dijit.range",l);return l})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(H,d,h){var l={};d.setObject("dijit._editor.html",l);var n=l.escapeXml=function(g,p){g=g.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,
"\x26gt;").replace(/"/gm,"\x26quot;");p||(g=g.replace(/'/gm,"\x26#39;"));return g};l.getNodeHtml=function(g){var p=[];l.getNodeHtmlHelper(g,p);return p.join("")};l.getNodeHtmlHelper=function(g,p){switch(g.nodeType){case 1:var e=g.nodeName.toLowerCase();if(!e||"/"==e.charAt(0))return"";p.push("\x3c",e);var x=[],D={},y;if(h("dom-attributes-explicit")||h("dom-attributes-specified-flag"))for(var k=0;y=g.attributes[k++];){var r=y.name;"_dj"===r.substr(0,3)||h("dom-attributes-specified-flag")&&!y.specified||
r in D||(y=y.value,("src"==r||"href"==r)&&g.getAttribute("_djrealurl")&&(y=g.getAttribute("_djrealurl")),8===h("ie")&&"style"===r&&(y=y.replace("HEIGHT:","height:").replace("WIDTH:","width:")),x.push([r,y]),D[r]=y)}else{var O=(/^input$|^img$/i.test(g.nodeName)?g:g.cloneNode(!1)).outerHTML;D=O.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi);O=O.substr(0,O.indexOf("\x3e"));H.forEach(D,function(B){if(B){var t=B.indexOf("\x3d");if(0<t&&(B=B.substring(0,t),"_dj"!=B.substr(0,3)))if("src"!=B&&"href"!=B||!g.getAttribute("_djrealurl")){switch(B){case "style":var v=
g.style.cssText.toLowerCase();break;case "class":v=g.className;break;case "width":if("img"===e){(t=/width=(\S+)/i.exec(O))&&(v=t[1]);break}case "height":if("img"===e){(t=/height=(\S+)/i.exec(O))&&(v=t[1]);break}default:v=g.getAttribute(B)}null!=v&&x.push([B,v.toString()])}else x.push([B,g.getAttribute("_djrealurl")])}},this)}x.sort(function(B,t){return B[0]<t[0]?-1:B[0]==t[0]?0:1});for(D=0;y=x[D++];)p.push(" ",y[0],'\x3d"',"string"===typeof y[1]?n(y[1],!0):y[1],'"');switch(e){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":p.push(" /\x3e");
break;case "script":p.push("\x3e",g.innerHTML,"\x3c/",e,"\x3e");break;default:p.push("\x3e"),g.hasChildNodes()&&l.getChildrenHtmlHelper(g,p),p.push("\x3c/",e,"\x3e")}break;case 4:case 3:p.push(n(g.nodeValue,!0));break;case 8:p.push("\x3c!--",n(g.nodeValue,!0),"--\x3e");break;default:p.push("\x3c!-- Element not recognized - Type: ",g.nodeType," Name: ",g.nodeName,"--\x3e")}};l.getChildrenHtml=function(g){var p=[];l.getChildrenHtmlHelper(g,p);return p.join("")};l.getChildrenHtmlHelper=function(g,p){if(g)for(var e=
g.childNodes||g,x=!h("ie")||e!==g,D,y=0;D=e[y++];)x&&D.parentNode!=g||l.getNodeHtmlHelper(D,p)};return l})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(H,d,h,l,n,g,p,e,x,D,y,k,r){var O=h("dijit._editor.plugins.LinkDialog",y,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:k,useDefaultCommand:!1,
urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=g.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(t){H("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),g.hitch(this,function(v,C,Q){var N=this;this.tag="insertImage"==this.command?"img":"a";v=g.delegate(v.getLocalization("dijit","common",this.lang),v.getLocalization("dijit._editor",
"LinkDialog",this.lang));var T=this.dropDown=this.button.dropDown=new C({title:v[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:g.hitch(this,"setValue"),onOpen:function(){N._onOpenDialog();C.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(g.hitch(N,"_onCloseDialog"),0)}});v.urlRegExp=this.urlRegExp;v.id=Q.getUniqueId(this.editor.id);this._uniqueId=v.id;this._setContent(T.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
D.substitute(this.linkDialogTemplate,v));T.startup();this._urlInput=Q.byId(this._uniqueId+"_urlInput");this._textInput=Q.byId(this._uniqueId+"_textInput");this._setButton=Q.byId(this._uniqueId+"_setButton");this.own(Q.byId(this._uniqueId+"_cancelButton").on("click",g.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",g.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",g.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=g.hitch(this,function(){var U=this._urlInput.get("value");return this._urlRegExp.test(U)||this._emailRegExp.test(U)});this.own(p(T.domNode,"keydown",g.hitch(this,g.hitch(this,function(U){!U||U.keyCode!=n.ENTER||U.shiftKey||U.metaKey||U.ctrlKey||U.altKey||this._setButton.get("disabled")||(T.onExecute(),T.execute(T.get("value")))}))));t()}))},_checkAndFixInput:function(){var t=this,v=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var C=v,Q=!1,N=!1;C&&1<C.length&&(C=g.trim(C),0!==C.indexOf("mailto:")&&(0<C.indexOf("/")?-1===C.indexOf("://")&&"/"!==C.charAt(0)&&C.indexOf("./")&&0!==C.indexOf("../")&&t._hostRxp.test(C)&&(Q=!0):t._userAtRxp.test(C)&&(N=!0)));Q&&t._urlInput.set("value","http://"+C);N&&t._urlInput.set("value","mailto:"+C);t._setButton.set("disabled",!t._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(g.hitch(this,
function(){this.own(p(this.editor.editNode,"mouseup",g.hitch(this,"_onMouseUp")));this.own(p(this.editor.editNode,"dblclick",g.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(t){this.dropDown.set({parserScope:"dojo",content:t})},_checkValues:function(t){t&&t.urlInput&&(t.urlInput=t.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&t&&t.textInput&&("function"===typeof this.linkFilter?t.textInput=this.linkFilter(t.textInput):
d.forEach(this.linkFilter,function(v){t.textInput=t.textInput.replace(v[0],v[1])}));return t},_createlinkEnabledImpl:function(){return!0},setValue:function(t){this._onCloseDialog();if(9>e("ie")){var v=r.getSelection(this.editor.window).getRangeAt(0).endContainer;3===v.nodeType&&(v=v.parentNode);v&&v.nodeName&&v.nodeName.toLowerCase()!==this.tag&&(v=this.editor.selection.getSelectedElement(this.tag));v&&v.nodeName&&v.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(v),
this.editor.execCommand("unlink"))}t=this._checkValues(t);this.editor.execCommand("inserthtml",D.substitute(this.htmlTemplate,t));x("a",this.editor.document).forEach(function(C){C.innerHTML||l.has(C,"name")||C.parentNode.removeChild(C)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(t){if(t&&t.tagName.toLowerCase()===this.tag){var v=t.getAttribute("_djrealurl")||t.getAttribute("href");var C=t.getAttribute("target")||"_self";var Q=t.textContent||
t.innerText;this.editor.selection.selectElement(t,!0)}else Q=this.editor.selection.getSelectedText();return{urlInput:v||"",textInput:Q||"",targetSelect:C||""}},_onOpenDialog:function(){if(e("ie")){var t=r.getSelection(this.editor.window);if(t.rangeCount){var v=t.getRangeAt(0);var C=v.endContainer;3===C.nodeType&&(C=C.parentNode);C&&C.nodeName&&C.nodeName.toLowerCase()!==this.tag&&(C=this.editor.selection.getSelectedElement(this.tag));if(!C||C.nodeName&&C.nodeName.toLowerCase()!==this.tag)(t=this.editor.selection.getAncestorElement(this.tag))&&
t.nodeName&&t.nodeName.toLowerCase()==this.tag?(C=t,this.editor.selection.selectElement(C)):v.startContainer===v.endContainer&&(t=v.startContainer.firstChild)&&t.nodeName&&t.nodeName.toLowerCase()==this.tag&&(C=t,this.editor.selection.selectElement(C))}}else C=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(C))},_onDblClick:function(t){if(t&&t.target&&(t=t.target,(t.tagName?t.tagName.toLowerCase():
"")===this.tag&&l.get(t,"href"))){var v=this.editor;this.editor.selection.selectElement(t);v.onDisplayChanged();v._updateTimer&&(v._updateTimer.remove(),delete v._updateTimer);v.onNormalizedDisplayChanged();var C=this.button;setTimeout(function(){C.set("disabled",!1);C.loadAndOpenDropDown().then(function(){C.dropDown.focus&&C.dropDown.focus()})},10)}},_onMouseUp:function(){if(e("ff")){var t=this.editor.selection.getAncestorElement(this.tag);if(t){var v=r.getSelection(this.editor.window).getRangeAt(0);
if(v.collapsed&&t.childNodes.length){var C=v.cloneRange();C.selectNodeContents(t.childNodes[t.childNodes.length-1]);C.setStart(t.childNodes[0],0);1!==v.compareBoundaryPoints(C.START_TO_START,C)?v.setStartBefore(t):-1!==v.compareBoundaryPoints(C.END_TO_START,C)&&v.setStartAfter(t)}}}}}),B=h("dijit._editor.plugins.ImgLinkDialog",[O],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(t){if(t&&t.tagName.toLowerCase()===this.tag){var v=t.getAttribute("_djrealurl")||t.getAttribute("src");var C=t.getAttribute("alt");this.editor.selection.selectElement(t,!0)}else C=this.editor.selection.getSelectedText();return{urlInput:v||"",textInput:C||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(g.hitch(this,function(){this.own(p(this.editor.editNode,"mousedown",g.hitch(this,"_selectTag")))}))},_selectTag:function(t){t&&t.target&&(t=t.target,(t.tagName?t.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(t))},_checkValues:function(t){t&&t.urlInput&&(t.urlInput=t.urlInput.replace(/"/g,"\x26quot;"));t&&t.textInput&&(t.textInput=t.textInput.replace(/"/g,"\x26quot;"));return t},_onDblClick:function(t){if(t&&t.target&&(t=t.target,(t.tagName?
t.tagName.toLowerCase():"")===this.tag&&l.get(t,"src"))){var v=this.editor;this.editor.selection.selectElement(t);v.onDisplayChanged();v._updateTimer&&(v._updateTimer.remove(),delete v._updateTimer);v.onNormalizedDisplayChanged();var C=this.button;setTimeout(function(){C.set("disabled",!1);C.loadAndOpenDropDown().then(function(){C.dropDown.focus&&C.dropDown.focus()})},10)}}});y.registry.createLink=function(t){var v={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in t?t.allowUnsafeHtml:!1};
"linkFilter"in t&&(v.linkFilter=t.linkFilter);return new O(v)};y.registry.insertImage=function(){return new B({command:"insertImage"})};O.ImgLinkDialog=B;return O})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(H,d,h,l,n,g){var p=h("dijit._editor.plugins.TextColor",n,{buttonClass:g,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;
this.inherited(arguments);var e=this;this.button.loadDropDown=function(x){function D(y){e.button.dropDown=new y({dir:e.editor.dir,ownerDocument:e.editor.ownerDocument,value:e.value,onChange:function(k){e.editor.execCommand(e.command,k)},onExecute:function(){e.editor.execCommand(e.command,this.get("value"))}});x()}"string"==typeof e.colorPicker?H([e.colorPicker],D):D(e.colorPicker)}},updateState:function(){var e=this.editor,x=this.command;if(e&&e.isLoaded&&x.length){if(this.button){var D=this.get("disabled");
this.button.set("disabled",D);if(D)return;try{var y=e.queryCommandValue(x)||""}catch(k){y=""}}""==y&&(y="#000000");"transparent"==y&&(y="#ffffff");"string"==typeof y?-1<y.indexOf("rgb")&&(y=d.fromRgb(y).toHex()):(y=((y&255)<<16|y&65280|(y&16711680)>>>16).toString(16),y="#000000".slice(0,7-y.length)+y);this.value=y;(e=this.button.dropDown)&&e.get&&y!==e.get("value")&&e.set("value",y,!1)}}});n.registry.foreColor=function(e){return new p(e)};n.registry.hiliteColor=function(e){return new p(e)};return p})},
"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v){H=H([D,y],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,
templateString:t,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}' style\x3d'display: flex;'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;padding:0 2px;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},constructor:function(C,Q){d.mixin(this,v.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);
this._uploadField_connect=h.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=h.connect(this._uploadField,"onfocus",d.hitch(this,function(C){B.hide(this._attachmentError)}))},destroy:function(){l.forEach(this._aeConnects,h.disconnect);h.disconnect(this._uploadField_connect);h.disconnect(this._uploadFieldFocus_connect);this.inherited(arguments)},showAttachments:function(C,Q){this._attachmentList.innerHTML=this.NLS_none;
this._uploadField.value="";l.forEach(this.domNode.children,function(N,T){B.show(N)});B.hide(this._attachmentError);C&&(this._featureLayer=C.getLayer()||Q)&&("esri.layers.FeatureLayer"===this._featureLayer.declaredClass&&this._featureLayer.getEditCapabilities?(this._currentLayerId=this._featureLayer.id,this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0),this._featureCanUpdate=
this._featureLayer.getEditCapabilities({feature:C}).canUpdate,this._oid=C.attributes[this._featureLayer.objectIdField],this._getAttachments(C)):Q&&Q.getEditCapabilities()||(B.hide(this._uploadForm),l.forEach(this.domNode.children,function(N,T){B.hide(N)})))},_getAttachments:function(C){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&this._featureLayer.queryAttachmentInfos(this._oid,d.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){B.hide(this._attachmentError);
this._featureLayer&&this._featureLayer.addAttachment?(B.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,d.hitch(this,"_onAddAttachmentComplete"),d.hitch(this,"_onAddAttachmentError"))):this._tempUpload=this._uploadForm},_chainAttachment:function(C,Q){this._tempUpload&&(B.show(this._attachmentProgress),Q.addAttachment(C,this._tempUpload,d.hitch(this,"_onAddAttachmentComplete"),d.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(C,
Q){B.show(this._attachmentProgress);this._featureLayer.deleteAttachments(C,[Q],d.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(C){var Q=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate?(Q=this._listHtml+this._endHtml,this._uploadForm.style.display=
"none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(Q=this._listHtml+this._endHtml);var N=this._attachmentList;C=l.map(C,d.hitch(this,function(T){return O.substitute({href:T.url,name:T.name,oid:T.objectId,attid:T.id},Q)}));N.innerHTML=C.join("")||this.NLS_none;this._updateConnects()},_onAddAttachmentComplete:function(C){B.hide(this._attachmentProgress.domNode);var Q=this._attachmentList,N=this._uploadField,T=N.value,U=T.lastIndexOf("\\");
-1<U&&(T=T.substring(U+1,T.length));T=T.replace(/ /g,"_");U=e.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var m=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(m=this._listHtml+this._endHtml);C=O.substitute({href:this._featureLayer._url.path+"/"+C.objectId+"/attachments/"+C.attachmentId+(U?"?"+U:""),name:T,oid:C.objectId,attid:C.attachmentId},
m);Q.innerHTML=Q.innerHTML==this.NLS_none?C:Q.innerHTML+C;this._updateConnects();N.value=""},_onAddAttachmentError:function(C){B.hide(this._attachmentProgress.domNode);if(C){var Q=this.NLS_error,N=this._attachmentError;O.isDefined(C.code)&&400===C.code&&(Q=this.NLS_fileNotSupported);x.set(N,"innerHTML",Q);B.show(N)}},_onDeleteAttachmentComplete:function(C){B.hide(this._attachmentProgress.domNode);var Q=this._attachmentList;l.every(C,function(N){return N.success})&&(n.query("#node_"+C[0].objectId+
"_"+C[0].attachmentId).orphan(),Q.children&&Q.children.length||(Q.innerHTML=this.NLS_none))},_updateConnects:function(){l.forEach(this._aeConnects,h.disconnect);n.query(".deleteAttachment").forEach(function(C){this._aeConnects.push(h.connect(C,"onclick",d.hitch(this,"_deleteAttachment",this._oid,C.id)))},this)}});g("extend-esri")&&d.setObject("dijit.editing.AttachmentEditor",H,r);return H})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),
function(H,d,h,l,n,g,p,e){return d("dijit.ProgressBar",[g,p],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:e,_indeterminateHighContrastImagePath:H.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(x){var D="rtl"==x.toLowerCase();h.toggle(this.domNode,"dijitProgressBarRtl",D);h.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&D);this.inherited(arguments)},update:function(x){l.mixin(this,x||{});x=this.internalProgress;var D=this.domNode,y=1;this.indeterminate?D.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(y=Math.min(parseFloat(this.progress)/100,1),this.progress=y*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),y=this.maximum?this.progress/this.maximum:0),D.setAttribute("aria-valuenow",this.progress));D.setAttribute("aria-labelledby",this.labelNode.id);D.setAttribute("aria-valuemin",0);D.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(y);h.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);h.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());x.style.width=100*y+"%";this.onChange()},_setValueAttr:function(x){this._set("value",
x);Infinity==x?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:x})},_setLabelAttr:function(x){this._set("label",x);this.update()},_setIndeterminateAttr:function(x){this._set("indeterminate",x);this.update()},report:function(x){return this.label?this.label:this.indeterminate?"\x26#160;":n.format(x,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],
function(H,d,h,l){var n={};n={findFeatures:function(g,p,e){var x=p.objectIdField;p=d.filter(p.graphics,function(D){return d.some(g,function(y){return D.attributes[x]===y.objectId})});if(e)e(p);else return p},getSelection:function(g){var p=[];d.forEach(g,function(e){e=e.getSelectedFeatures();d.forEach(e,function(x){p.push(x)})});return p},sortFeaturesById:function(g,p){var e=d.map(g,function(x){return x.featureLayer});p.sort(function(x,D){var y=x.getLayer(),k=D.getLayer();if(!y)return-1;if(!k)return 1;
var r=d.indexOf(e,y);k=d.indexOf(e,k);r-=k;r||(y=y.objectIdField,r=x.attributes[y]-D.attributes[y]);return r});return p}};h("extend-esri")&&H.setObject("dijit.editing.Util.LayerHelper",n,l);return n})},"dojox/date/islamic":function(){define(["dojox/main","dojo/_base/lang","dojo/date","./islamic/Date"],function(H,d,h,l){var n=d.getObject("date.islamic",!0,H);n.getDaysInMonth=function(g){return g.getDaysInIslamicMonth(g.getMonth(),g.getFullYear())};n.compare=function(g,p,e){g instanceof l&&(g=g.toGregorian());
p instanceof l&&(p=p.toGregorian());return h.compare.apply(null,arguments)};n.add=function(g,p,e){var x=new l(g);switch(p){case "day":x.setDate(g.getDate()+e);break;case "weekday":var D=g.getDay();if(5>D+e&&0<D+e)x.setDate(g.getDate()+e);else{var y=p=0;5==D?(D=4,y=0<e?-1:1):6==D&&(D=4,y=0<e?-2:2);D=0<e?5-D-1:-D;var k=e-D,r=parseInt(k/5);0!=k%5&&(p=0<e?2:-2);p=p+7*r+k%5+D;x.setDate(g.getDate()+p+y)}break;case "year":x.setFullYear(g.getFullYear()+e);break;case "week":e*=7;x.setDate(g.getDate()+e);break;
case "month":g=g.getMonth();x.setMonth(g+e);break;case "hour":x.setHours(g.getHours()+e);break;case "minute":x._addMinutes(e);break;case "second":x._addSeconds(e);break;case "millisecond":x._addMilliseconds(e)}return x};n.difference=function(g,p,e){p=p||new l;e=e||"day";var x=p.getFullYear()-g.getFullYear(),D=1;switch(e){case "weekday":x=Math.round(n.difference(g,p,"day"));D=parseInt(n.difference(g,p,"week"));if(0==x%7)x=5*D;else{e=0;var y=g.getDay(),k=p.getDay();D=parseInt(x/7);p=x%7;g=new l(g);
g.setDate(g.getDate()+7*D);g=g.getDay();if(0<x)switch(!0){case 5==y:e=-1;break;case 6==y:e=0;break;case 5==k:e=-1;break;case 6==k:e=-2;break;case 5<g+p:e=-2}else if(0>x)switch(!0){case 5==y:e=0;break;case 6==y:e=1;break;case 5==k:e=2;break;case 6==k:e=1;break;case 0>g+p:e=2}x=x+e-2*D}D=x;break;case "year":D=x;break;case "month":e=p.toGregorian()>g.toGregorian()?p:g;y=p.toGregorian()>g.toGregorian()?g:p;D=e.getMonth();k=y.getMonth();if(0==x)D=e.getMonth()-y.getMonth();else for(D=12-k+D,x=y.getFullYear()+
1,e=e.getFullYear(),x;x<e;x++)D+=12;p.toGregorian()<g.toGregorian()&&(D=-D);break;case "week":D=parseInt(n.difference(g,p,"day")/7);break;case "day":D/=24;case "hour":D/=60;case "minute":D/=60;case "second":D/=1E3;case "millisecond":D*=p.toGregorian().getTime()-g.toGregorian().getTime()}return Math.round(D)};return n})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(H,d,h){var l=d("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,
_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var n=arguments.length;n?1==n?(n=arguments[0],"number"==typeof n&&(n=new Date(n)),n instanceof Date?this.fromGregorian(n):""==n?this._date=new Date(""):(this._year=n._year,this._month=n._month,this._date=n._date,this._hours=n._hours,this._minutes=n._minutes,this._seconds=n._seconds,this._milliseconds=n._milliseconds)):3<=n&&(this._year+=arguments[0],this._month+=arguments[1],this._date+=
arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},getMilliseconds:function(){return this._milliseconds},
setDate:function(n){n=parseInt(n);if(!(0<n&&n<=this.getDaysInIslamicMonth(this._month,this._year))){var g;if(0<n)for(g=this.getDaysInIslamicMonth(this._month,this._year);n>g;n-=g,g=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(g=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=n;g=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:
this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),n+=g}this._date=n;return this},setFullYear:function(n){this._year=+n},setMonth:function(n){this._year+=Math.floor(n/12);this._month=0<n?Math.floor(n%12):Math.floor((n%12+12)%12)},setHours:function(){var n=arguments.length,g=0;1<=n&&(g=parseInt(arguments[0]));2<=n&&(this._minutes=parseInt(arguments[1]));3<=n&&(this._seconds=parseInt(arguments[2]));4==n&&(this._milliseconds=parseInt(arguments[3]));for(;24<=g;)this._date++,n=this.getDaysInIslamicMonth(this._month,
this._year),this._date>n&&(this._month++,12<=this._month&&(this._year++,this._month-=12),this._date-=n),g-=24;this._hours=g},_addMinutes:function(n){n+=this._minutes;this.setMinutes(n);this.setHours(this._hours+parseInt(n/60));return this},_addSeconds:function(n){n+=this._seconds;this.setSeconds(n);this._addMinutes(parseInt(n/60));return this},_addMilliseconds:function(n){n+=this._milliseconds;this.setMilliseconds(n);this._addSeconds(parseInt(n/1E3));return this},setMinutes:function(n){this._minutes=
n%60;return this},setSeconds:function(n){this._seconds=n%60;return this},setMilliseconds:function(n){this._milliseconds=n%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var n=new Date;n.setHours(this._hours);n.setMinutes(this._minutes);n.setSeconds(this._seconds);n.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+n.toTimeString()},toGregorian:function(){var n=this._year;n=Math.floor(this._date+Math.ceil(29.5*this._month)+354*
(n-1)+Math.floor((3+11*n)/30)+this._ISLAMIC_EPOCH-1-.5)+.5;var g=n-this._GREGORIAN_EPOCH,p=Math.floor(g/146097),e=this._mod(g,146097);g=Math.floor(e/36524);var x=this._mod(e,36524);e=Math.floor(x/1461);x=this._mod(x,1461);x=Math.floor(x/365);p=400*p+100*g+4*e+x;4!=g&&4!=x&&p++;g=n-(this._GREGORIAN_EPOCH+365*(p-1)+Math.floor((p-1)/4)-Math.floor((p-1)/100)+Math.floor((p-1)/400));e=this._GREGORIAN_EPOCH-1+365*(p-1)+Math.floor((p-1)/4)-Math.floor((p-1)/100)+Math.floor((p-1)/400)+Math.floor(739/12+(h.isLeapYear(new Date(p,
3,1))?-1:-2)+1);e=n<e?0:h.isLeapYear(new Date(p,3,1))?1:2;g=Math.floor((12*(g+e)+373)/367);e=this._GREGORIAN_EPOCH-1+365*(p-1)+Math.floor((p-1)/4)-Math.floor((p-1)/100)+Math.floor((p-1)/400)+Math.floor((367*g-362)/12+(2>=g?0:h.isLeapYear(new Date(p,g-1,1))?-1:-2)+1);return new Date(p,g-1,n-e+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(n){n=new Date(n);var g=n.getFullYear(),p=n.getMonth(),e=n.getDate();g=this._GREGORIAN_EPOCH-1+365*(g-1)+Math.floor((g-1)/4)+
-Math.floor((g-1)/100)+Math.floor((g-1)/400)+Math.floor((367*(p+1)-362)/12+(2>=p+1?0:h.isLeapYear(n)?-1:-2)+e);g=Math.floor(g)+.5;g-=this._ISLAMIC_EPOCH;p=Math.floor((30*g+10646)/10631);e=Math.ceil((g-29-this._yearStart(p))/29.5);e=Math.min(e,11);this._date=Math.ceil(g-this._monthStart(p,e))+1;this._month=e;this._year=p;this._hours=n.getHours();this._minutes=n.getMinutes();this._seconds=n.getSeconds();this._milliseconds=n.getMilliseconds();this._day=n.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},
_yearStart:function(n){return 354*(n-1)+Math.floor((3+11*n)/30)},_monthStart:function(n,g){return Math.ceil(29.5*g)+354*(n-1)+Math.floor((3+11*n)/30)},_civilLeapYear:function(n){return 11>(14+11*n)%30},getDaysInIslamicMonth:function(n,g){var p=0;p=29+(n+1)%2;11==n&&this._civilLeapYear(g)&&p++;return p},_mod:function(n,g){return n-g*Math.floor(n/g)}});l.getDaysInIslamicMonth=function(n){return(new l).getDaysInIslamicMonth(n.getMonth(),n.getFullYear())};return l})},"dojox/date/islamic/locale":function(){define("dojox/main dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),
function(H,d,h,l,n,g,p,e,x){function D(B,t,v,C,Q){return Q.replace(/([a-z])\1*/ig,function(N){var T=N.charAt(0);N=N.length;var U=["abbr","wide","narrow"];switch(T){case "G":var m=t.eraAbbr[0];break;case "y":m=String(B.getFullYear());break;case "M":m=B.getMonth();if(3>N){m+=1;var u=!0}else T=["months-format",U[N-3]].join("-"),m=t[T][m];break;case "d":m=B.getDate(!0);u=!0;break;case "E":m=B.getDay();3>N?(m+=1,u=!0):(T=["days-format",U[N-3]].join("-"),m=t[T][m]);break;case "a":m=12>B.getHours()?"am":
"pm";m=t["dayPeriods-format-wide-"+m];break;case "h":case "H":case "K":case "k":u=B.getHours();switch(T){case "h":m=u%12||12;break;case "H":m=u;break;case "K":m=u%12;break;case "k":m=u||24}u=!0;break;case "m":m=B.getMinutes();u=!0;break;case "s":m=B.getSeconds();u=!0;break;case "S":m=Math.round(B.getMilliseconds()*Math.pow(10,N-3));u=!0;break;case "z":if(m=l.getTimezoneName(B.toGregorian()))break;N=4;case "Z":m=B.toGregorian().getTimezoneOffset();m=[0>=m?"+":"-",p.pad(Math.floor(Math.abs(m)/60),2),
p.pad(Math.abs(m)%60,2)];4==N&&(m.splice(0,0,"GMT"),m.splice(3,0,":"));m=m.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+Q);}u&&(m=p.pad(m,N));return m})}function y(B,t,v,C){var Q=function(U){return U};t=t||Q;v=v||Q;C=C||Q;var N=B.match(/(''|[^'])+/g),T="'"==B.charAt(0);h.forEach(N,function(U,m){U?(N[m]=(T?v:t)(U),T=!T):N[m]=""});return C(N.join(""))}function k(B,t,v,C){C=g.escapeString(C);n.normalizeLocale(v.locale);return C.replace(/([a-z])\1*/ig,
function(Q){var N=Q.charAt(0);var T=Q.length,U="";v.strict?1<T&&(U="0{"+(T-1)+"}"):U="0?";switch(N){case "y":N="\\d+";break;case "M":N=2<T?"\\S+ ?\\S+":U+"[1-9]|1[0-2]";break;case "d":N="[12]\\d|"+U+"[1-9]|3[01]";break;case "E":N="\\S+";break;case "h":N=U+"[1-9]|1[0-2]";break;case "k":N=U+"\\d|1[01]";break;case "H":N=U+"\\d|1\\d|2[0-3]";break;case "K":N=U+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":N=U+"\\d|[0-5]\\d";break;case "S":N="\\d{"+T+"}";break;case "a":T=v.am||t["dayPeriods-format-wide-am"];
U=v.pm||t["dayPeriods-format-wide-pm"];v.strict?N=T+"|"+U:(N=T+"|"+U,T!=T.toLowerCase()&&(N+="|"+T.toLowerCase()),U!=U.toLowerCase()&&(N+="|"+U.toLowerCase()));break;default:N=".*"}B&&B.push(Q);return"("+N+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var r=d.getObject("date.islamic.locale",!0,H);r.format=function(B,t){t=t||{};var v=n.normalizeLocale(t.locale),C=t.formatLength||"short",Q=r._getIslamicBundle(v),N=[];v=d.hitch(this,D,B,Q,v,t.fullYear);if("year"==t.selector)return B.getFullYear();"time"!=t.selector&&
(B=t.datePattern||Q["dateFormat-"+C])&&N.push(y(B,v));"date"!=t.selector&&(t=t.timePattern||Q["timeFormat-"+C])&&N.push(y(t,v));return N.join(" ")};r.regexp=function(B){return r._parseInfo(B).regexp};r._parseInfo=function(B){B=B||{};var t=n.normalizeLocale(B.locale);t=r._getIslamicBundle(t);var v=B.formatLength||"short",C=B.datePattern||t["dateFormat-"+v];v=B.timePattern||t["timeFormat-"+v];var Q=[];return{regexp:y("date"==B.selector?C:"time"==B.selector?v:"undefined"==typeof v?C:C+" "+v,d.hitch(this,
k,Q,t,B)),tokens:Q,bundle:t}};r.parse=function(B,t){B=B.replace(/[\u200E\u200F\u202A\u202E]/g,"");t||(t={});var v=r._parseInfo(t),C=v.tokens,Q=v.bundle;v=v.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");B=(new RegExp("^"+v+"$")).exec(B);n.normalizeLocale(t.locale);if(!B)return null;var N=[1389,0,1,0,0,0,0],T="",U=["abbr","wide","narrow"];h.every(B,function(m,u){if(!u)return!0;u=C[u-1];var M=u.length;switch(u.charAt(0)){case "y":N[0]=Number(m);break;case "M":if(2<M){if(u=Q["months-format-"+U[M-3]].concat(),
t.strict||(m=m.replace(".","").toLowerCase(),u=h.map(u,function(S){return S?S.replace(".","").toLowerCase():S})),m=h.indexOf(u,m),-1==m)return!1}else m--;N[1]=Number(m);break;case "D":N[1]=0;case "d":N[2]=Number(m);break;case "a":u=t.am||Q["dayPeriods-format-wide-am"];M=t.pm||Q["dayPeriods-format-wide-pm"];if(!t.strict){var I=/\./g;m=m.replace(I,"").toLowerCase();u=u.replace(I,"").toLowerCase();M=M.replace(I,"").toLowerCase()}if(t.strict&&m!=u&&m!=M)return!1;T=m==M?"p":m==u?"a":"";break;case "K":24==
m&&(m=0);case "h":case "H":case "k":N[3]=Number(m);break;case "m":N[4]=Number(m);break;case "s":N[5]=Number(m);break;case "S":N[6]=Number(m)}return!0});B=+N[3];"p"===T&&12>B?N[3]=B+12:"a"===T&&12==B&&(N[3]=0);return new e(N[0],N[1],N[2],N[3],N[4],N[5],N[6])};var O=[];r.addCustomFormats=function(B,t){O.push({pkg:B,name:t})};r._getIslamicBundle=function(B){var t={};h.forEach(O,function(v){v=n.getLocalization(v.pkg,v.name,B);t=d.mixin(t,v)},this);return t};r.addCustomFormats("dojo.cldr","islamic");r.getNames=
function(B,t,v,C,Q){C=r._getIslamicBundle(C);B=[B,v,t];if("standAlone"==v){v=B.join("-");var N=C[v];1==N[0]&&(N=void 0)}B[1]="format";return(N||C[B.join("-")]).concat()};r.weekDays=r.getNames("days","wide","format");r.months=r.getNames("months","wide","format");return r})},"widgets/ParcelDrafter/geometryUtils":function(){define("esri/geometry/Point esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils dojo/Deferred dojo/_base/array dojo/_base/lang esri/geometry/geometryEngine esri/SpatialReference esri/geometry/scaleUtils".split(" "),
function(H,d,h,l,n,g,p,e,x,D){var y={canProjectLocally:function(k){k=new H({x:0,y:0,spatialReference:k});return l.canProject(k,new x(4326))?!0:!1},getProjectedGeometry:function(k,r,O){var B=new n;if(l.canProject(k,r)){var t=l.project(k,r);B.resolve(t)}else O.project([k],r,function(v){t=v[0];B.resolve(t)});return B.promise},getDestinationPoint:function(k,r,O){var B=k.x*Math.PI/180,t=r*Math.PI/180;r=Math.sin(t);t=Math.cos(t);var v=.9966471893352243*Math.tan(k.y*Math.PI/180);k=1/Math.sqrt(1+v*v);var C=
v*k,Q=Math.atan2(v,t);v=k*r;var N=1-v*v,T=2.7233160610984375E11*N/4.040829998465916E13,U=1+T/16384*(4096+T*(-768+T*(320-175*T))),m=T/1024*(256+T*(-128+T*(74-47*T))),u=O/(6356752.314245*U),M=0;do{T=Math.cos(2*Q+u);var I=Math.sin(u);var S=Math.cos(u);var E=m*I*(T+m/4*(S*(-1+2*T*T)-m/6*T*(-3+4*I*I)*(-3+4*T*T)));var W=u;u=O/(6356752.314245*U)+E}while(1E-12<Math.abs(u-W)&&200>++M);if(200<=M)return console.log("Formula failed to converge"),null;O=C*I-k*S*t;O=Math.atan2(C*S+k*I*t,.9966471893352243*Math.sqrt(v*
v+O*O));N=2.0955066654848088E-4*N*(4+.003352810664775694*(4-3*N));B=(B+(Math.atan2(I*r,k*S-C*I*t)-.003352810664775694*(1-N)*v*(u+N*I*(T+N*S*(-1+2*T*T))))+3*Math.PI)%(2*Math.PI)-Math.PI;O=180*O/Math.PI;B=180*B/Math.PI;return new H(B,O,new x(4326))},getInverseCalculations:function(k,r){var O=r.x*Math.PI/180-k.x*Math.PI/180,B=.9966471893352243*Math.tan(k.y*Math.PI/180);k=1/Math.sqrt(1+B*B);B*=k;var t=.9966471893352243*Math.tan(r.y*Math.PI/180);r=1/Math.sqrt(1+t*t);t*=r;var v=O,C=0;do{var Q=Math.sin(v);
var N=Math.cos(v);var T=r*Q*r*Q+(k*t-B*r*N)*(k*t-B*r*N);T=Math.sqrt(T);if(0==T)return{distance:0,initialBearing:0,finalBearing:0};var U=B*t+k*r*N;var m=Math.atan2(T,U);var u=k*r*Q/T;var M=1-u*u;var I=U-2*B*t/M;isNaN(I)&&(I=0);var S=2.0955066654848088E-4*M*(4+.003352810664775694*(4-3*M));var E=v;v=O+.003352810664775694*(1-S)*u*(m+S*T*(I+S*U*(-1+2*I*I)))}while(1E-12<Math.abs(v-E)&&200>++C);if(200<=C)return null;v=2.7233160610984375E11*M/4.040829998465916E13;C=v/1024*(256+v*(-128+v*(74-47*v)));O=Math.atan2(r*
Q,k*t-B*r*N);k=Math.atan2(k*Q,-B*r+k*t*N);O=(O+2*Math.PI)%(2*Math.PI);k=(k+2*Math.PI)%(2*Math.PI);B=Number((6356752.314245*(1+v/16384*(4096+v*(-768+v*(320-175*v))))*(m-C*T*(I+C/4*(U*(-1+2*I*I)-C/6*I*(-3+4*T*T)*(-3+4*I*I))))).toFixed(3));O=180*O/Math.PI;k=180*k/Math.PI;return{distance:B,initialBearing:O,finalBearing:k}},getLineBetweenPoints:function(k){var r,O=[];g.forEach(k,p.hitch(this,function(B){O.push([y.removeNegativeExponents(B.x),y.removeNegativeExponents(B.y)])}));0<O.length&&(r=new d({paths:[O],
spatialReference:{wkid:4326}}));return r},getAngleBetweenPoints:function(k,r){k=y.getInverseCalculations(k,r);return null===k?0:k.initialBearing},getDistanceBetweenPoints:function(k,r){k=y.getInverseCalculations(k,r);return null===k?0:k.distance},getLengthOfGeometry:function(k){return(k=e.simplify(k))?e.geodesicLength(k,9001):0},getAreaOfGeometry:function(k){k=e.simplify(k);var r={};k?(r.acres=e.geodesicArea(k,109402),r.squareMeters=e.geodesicArea(k,109404),r.squareFeet=e.geodesicArea(k,109405),r.squareUSSurveyFeet=
e.geodesicArea(k,109406)):(r.acres=0,r.squareMeters=0,r.squareFeet=0,r.squareUSSurveyFeet=0);return r},getPolyLineFromPaths:function(k){var r;var O=new d(new x({wkid:4326}));for(r=0;r<k.length;r++)O.addPath(k[r]);return O},getPolygonFromPolyLines:function(k,r,O,B){var t,v;var C=[];B=B?new h(new x(B)):new h(new x({wkid:4326}));for(t=0;t<k.length;t++)for(v=0;v<k[t].length;v++)C.push(k[t][v]);r?C.push(p.clone(C[0])):O&&(C[C.length-1][0]=C[0][0],C[C.length-1][1]=C[0][1]);B.isClockwise(C)||C.reverse();
B.addRing(C);return B},getPointsForArc:function(k,r,O,B){var t=[];var v=r-k;r=parseInt(v,10);0>=r&&(r=1);var C=Math.abs(v)/Math.abs(r);if(0<C)for(v=0;v<Math.abs(r)+1;v++){var Q=k+C*v;(Q=y.getDestinationPoint(O,Q,Math.abs(B)))&&t.push(Q)}return t},getArcParam:function(k){var r={};0>k.distance?0>k.radius?(r.bearing=k.initBearing+90,r.centerPoint=y.getDestinationPoint(k.chordMidPoint,r.bearing,k.centerAndChordDistance),r.startAngle=y.getAngleBetweenPoints(r.centerPoint,k.chordEndPoint),r.endAngle=y.getAngleBetweenPoints(r.centerPoint,
k.chordStartPoint)):(r.bearing=k.initBearing-90,r.centerPoint=y.getDestinationPoint(k.chordMidPoint,r.bearing,k.centerAndChordDistance),r.startAngle=y.getAngleBetweenPoints(r.centerPoint,k.chordStartPoint),r.endAngle=y.getAngleBetweenPoints(r.centerPoint,k.chordEndPoint)):0<k.radius?(r.bearing=k.initBearing+90,r.centerPoint=y.getDestinationPoint(k.chordMidPoint,r.bearing,k.centerAndChordDistance),r.startAngle=y.getAngleBetweenPoints(r.centerPoint,k.chordStartPoint),r.endAngle=y.getAngleBetweenPoints(r.centerPoint,
k.chordEndPoint)):(r.bearing=k.initBearing-90,r.centerPoint=y.getDestinationPoint(k.chordMidPoint,r.bearing,k.centerAndChordDistance),r.startAngle=y.getAngleBetweenPoints(r.centerPoint,k.chordEndPoint),r.endAngle=y.getAngleBetweenPoints(r.centerPoint,k.chordStartPoint));return r},removeNegativeExponents:function(k){return 1<k.toString().toLowerCase().split("e-").length?0:k},getChordLengthFromArcLength:function(k,r){k=Math.abs(k);var O=Math.PI*Math.abs(r);r=Math.abs(r)*Math.sin(Math.abs(k)/Math.abs(r)/
2);return k<=O?2*r:-2*r},getArcLengthFromChordLength:function(k,r){var O=Math.abs(k);r=Math.abs(r);O=2*Math.asin(O/(2*r))*r;0>k&&(O=2*Math.PI*r-O);return O},chordBearingToTangentBearing:function(k,r,O){var B=180/Math.PI*Math.acos(Math.abs(O)/2/Math.abs(r));r/=Math.abs(r);k=k+90*r-O/Math.abs(O)*r*B;return y.removeNegativeExponents(0>k?k+360:360<=k?k%360:k)},tangentBearingToChordBearing:function(k,r,O){var B=180/Math.PI*Math.acos(Math.abs(O)/2/Math.abs(r));r/=Math.abs(r);k=k+90*r-O/Math.abs(O)*r*B;
return y.removeNegativeExponents(0>k?k+360:360<=k?k%360:k)},getUnitValueForSR:function(k){switch(D.getUnitValueForSR(k)){case 1:return"meters";case 111194.87428468118:return"meters";case .3048:return"feet";case .3048006096:case .3048006096012192:return"uSSurveyFeet"}},getRotationAngleBetweenPoints:function(k,r){k=l.project(k,new x(102100));r=l.project(r,new x(102100));var O=r.x-k.x;k=r.y-k.y;r=180*Math.atan2(Math.abs(O),Math.abs(k))/Math.PI;var B=180*Math.atan2(Math.abs(k),Math.abs(O))/Math.PI;O=
y.removeNegativeExponents(O);k=y.removeNegativeExponents(k);r=y.removeNegativeExponents(r);B=y.removeNegativeExponents(B);if(0===k){if(0===O)return 0;if(0<O)return 90;if(0>O)return 270}else if(0<k){if(0===O)return 0;if(0<O)return r;if(0>O)return 270+B}else if(0>k){if(0===O)return 180;if(0<O)return 90+B;if(0>O)return 180+r}},getScaleDistanceBetweenPoints:function(k,r){k=l.project(k,new x(102100));r=l.project(r,new x(102100));k=e.distance(k,r,9001);return y.removeNegativeExponents(k)}};return y})},
"widgets/ParcelDrafter/MapTooltipHandler":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/Evented dojo/dom-style dojo/dom-construct dojo/on".split(" "),function(H,d,h,l,n,g,p){return H([d,l],{baseClass:"jimu-widget-ParcelDrafter-MapTooltipHandler",map:null,handleClickFor:null,_mapTooltip:null,_mapMoveHandler:null,_mapClickHandler:null,_mouseDragHandler:null,constructor:function(e){h.mixin(this,e)},startup:function(){this.handleClickFor||(this.handleClickFor=this.map);
this._createTooltip()},connectEventHandler:function(e){e&&this.updateTooltip(e);this._disableWebMapPopup();this._mapClickHandler=this.own(p(this.handleClickFor,"click",h.hitch(this,function(x){this._clicked(x)})))[0];"ontouchstart"in document.documentElement?n.set(this._mapTooltip,"display","none"):(this._mapMoveHandler=this.own(this.map.on("mouse-move",h.hitch(this,this._onMapMouseMove)))[0],this.own(this.map.on("mouse-out",h.hitch(this,function(){n.set(this._mapTooltip,"display","none")}))))},disconnectEventHandler:function(){this._enableWebMapPopup();
this._mapClickHandler&&this._mapClickHandler.remove();this._mapMoveHandler&&(this._mapMoveHandler.remove(),this._mapTooltip.style.display="none");this.disconnectMouseDragHandler()},connectMouseDragHandler:function(e){e&&this.updateTooltip(e);this._disableWebMapPopup();this._mapClickHandler&&this._mapClickHandler.remove();this.map.disableMapNavigation();this._mouseDragHandler=this.own(this.map.on("mouse-drag",h.hitch(this,function(x){this._onDragging(x)})))[0]},disconnectMouseDragHandler:function(){this._mouseDragHandler&&
(this._mouseDragHandler.remove(),this._mapTooltip.style.display="none");this.map.enableMapNavigation()},_createTooltip:function(){this._mapTooltip=g.create("div",{"class":"esriCTMapTooltip",innerHTML:this.toolTipText},this.map.container);n.set(this._mapTooltip,"position","fixed");n.set(this._mapTooltip,"display","none")},_enableWebMapPopup:function(){this.map&&(this.map.infoWindow.hide(),this.map.setInfoWindowOnClick(!0))},_disableWebMapPopup:function(){this.map&&(this.map.infoWindow.hide(),this.map.setInfoWindowOnClick(!1))},
_onMapMouseMove:function(e){if(e.clientX||e.pageY){var x=e.clientX;var D=e.clientY}else x=e.clientX+document.body.scrollLeft-document.body.clientLeft,D=e.clientY+document.body.scrollTop-document.body.clientTop;n.set(this._mapTooltip,"display","none");n.set(this._mapTooltip,{left:x+15+"px",top:D+"px"});n.set(this._mapTooltip,"display","");this._onMoving(e)},_clicked:function(e){this.emit("clicked",e)},_onDragging:function(e){this.emit("dragging",e)},_onMoving:function(e){this.emit("moving",e)},updateTooltip:function(e){this.toolTipText=
e;this._mapTooltip.innerHTML=this.toolTipText}})})},"widgets/ParcelDrafter/layerUtils":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/array","dojo/_base/lang"],function(H,d,h,l){return H([d],{map:null,getPopupInfo:!0,getRenderer:!0,postCreate:function(){},getLayerDetailsFromMap:function(n,g,p){var e={},x;this.map&&this.map.webMapResponse&&this.map.webMapResponse.itemInfo&&this.map.webMapResponse.itemInfo.itemData&&this.map.webMapResponse.itemInfo.itemData.operationalLayers&&
h.forEach(this.map.webMapResponse.itemInfo.itemData.operationalLayers,l.hitch(this,function(D){D.layerObject&&("ArcGISMapServiceLayer"===D.layerType||"ArcGISTiledMapServiceLayer"===D.layerType?(x=p&&p.substring(0,p.lastIndexOf("_")),x&&D.id!==x||(e.isMapServer=!0,n.substring(0,n.length-1)===D.url&&(h.forEach(D.resourceInfo.layers,l.hitch(this,function(y){y.id===parseInt(g,10)&&(e.title=y.name)})),h.forEach(D.layers,l.hitch(this,function(y){y.id===parseInt(g,10)&&(y.name&&(e.title=y.name),this.getPopupInfo&&
(e.popupInfo=y.popupInfo),y.layerDefinition&&(y.layerDefinition.definitionExpression&&(e.definitionExpression=y.layerDefinition.definitionExpression),this.getRenderer&&y.layerDefinition.drawingInfo&&y.layerDefinition.drawingInfo.renderer&&(e.renderer=y.layerDefinition.drawingInfo.renderer)))}))))):p&&D.id!==p||D.url.replace(/.*?:\/\//g,"").toLowerCase()!==(n+g).replace(/.*?:\/\//g,"").toLowerCase()||D.id!==p||(e.isMapServer=!1,e.title=D.title,this.getPopupInfo&&(e.popupInfo=D.popupInfo),D.layerDefinition&&
(D.layerDefinition.definitionExpression&&(e.definitionExpression=D.layerDefinition.definitionExpression),this.getRenderer&&D.layerDefinition.drawingInfo&&D.layerDefinition.drawingInfo.renderer&&(e.renderer=D.layerDefinition.drawingInfo.renderer))))}));return e}})})},"widgets/ParcelDrafter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/ParcelDrafter/PlanSettings.html":'\x3cdiv\x3e\r\n    \x3c!-- Direction or Angle Type Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.directionOrAngleTypeLabel}"\r\n        data-a11y-label-id\x3d"directionOrAngleTypeLabel"\x3e\r\n            ${nls.planSettings.directionOrAngleTypeLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"directionOrAngleType" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"directionOrAngleTypeLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Direction or Angle Units Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.directionOrAngleUnitsLabel}"\r\n        data-a11y-label-id\x3d"directionOrAngleUnitsLabel"\x3e\r\n            ${nls.planSettings.directionOrAngleUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"directionOrAngleUnits" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"directionOrAngleUnitsLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Distance and Length Units Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.distanceAndLengthUnitsLabel}"\r\n        data-a11y-label-id\x3d"distanceAndLengthUnitsLabel"\x3e\r\n            ${nls.planSettings.distanceAndLengthUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"distanceAndLengthUnits" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"distanceAndLengthUnitsLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Area Units Selector--\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.areaUnitsLabel}"\r\n        data-a11y-label-id\x3d"areaUnitsLabel"\x3e\r\n            ${nls.planSettings.areaUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"areaUnits" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"areaUnitsLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Circular Curve Parameters Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis " title\x3d"${nls.planSettings.circularCurveParameters}"\r\n        data-a11y-label-id\x3d"circularCurveParameters"\x3e\r\n            ${nls.planSettings.circularCurveParameters}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"circularCurveParameters" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"circularCurveParameters"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/XYInput.html":'\x3cdiv class\x3d"esriCTAlignCenter" data-dojo-attach-point\x3d"newTraverseXYInputNode"\x3e\r\n  \x3cdiv class\x3d"xyRowWrapper" data-dojo-attach-point\x3d"xRowWrapper"\x3e\r\n    X:\r\n    \x3cdiv data-dojo-attach-point\x3d"newTraverseX" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n      data-dojo-props\x3d"intermediateChanges:true,regExp:\'^[+-]?\\\\d+(\\\\.\\\\d+)?$\'" trim\x3d"true" required\x3d"true"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"xyRowWrapper" data-dojo-attach-point\x3d"yRowWrapper"\x3e\r\n    Y:\r\n    \x3cdiv data-dojo-attach-point\x3d"newTraverseY" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n      data-dojo-props\x3d"intermediateChanges:true,regExp:\'^[+-]?\\\\d+(\\\\.\\\\d+)?$\'" trim\x3d"true" required\x3d"true"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-btn jimu-trailing-margin1 jimu-state-disabled" title\x3d"${nls.newTraverseButtonLabel}"\r\n    data-dojo-attach-point\x3d"xyStartButton" tabindex\x3d"-1" role\x3d"button" aria-label\x3d"${nls.newTraverseButtonLabel}"\x3e\r\n    ${nls.newTraverseButtonLabel}\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/NewTraverse.html":'\x3cdiv\x3e\r\n    \x3c!-- Traverse grid container--\x3e\r\n    \x3cdiv class\x3d"esriCTNewTraverseContainer"\x3e\r\n        \x3c!-- Traverse grid title--\x3e\r\n        \x3cdiv class\x3d"esriCTNewTraverseLabelDiv"\x3e\r\n            \x3cdiv class\x3d"esriCTGridEmptyLabel"\x3e\r\n                \x26nbsp\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis esriCTGridBearingLabel" title\x3d"${nls.traverseSettings.bearingLabel}"\x3e\r\n                ${nls.traverseSettings.bearingLabel}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis" title\x3d"${nls.traverseSettings.lengthLabel}"\x3e\r\n                ${nls.traverseSettings.lengthLabel}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis" title\x3d"${nls.traverseSettings.radiusLabel}"\x3e\r\n                ${nls.traverseSettings.radiusLabel}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid items--\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"traverseGrid" class\x3d"esriCTTraverseGrid"\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid initial entry row--\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"traverseEntryNode" class\x3d"esriCTEntrtyNodeContent esriCTRow"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"lineSymbolNode" class\x3d"esriCTSymbolContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"bearingNode" class\x3d"esriCTBearingRow" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.bearingLabel}"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"lengthNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.lengthLabel}"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"radiusNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.radiusLabel}"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTAddRow"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"addButton" class\x3d"esriCTAddIcon"\r\n                title\x3d"${nls.traverseSettings.addButtonTitle}" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.traverseSettings.addButtonTitle}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid tools container--\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseTool"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseToolContainer"\x3e\r\n                \x3c!-- Update rotation point tool--\x3e\r\n                \x3cdiv class\x3d"esriCTTraverseToolIcons ecriCTUpdateRotationPointIcon esriCTCursorPointer" title\x3d"${nls.planSettings.updateRotationPointTooltipText}"\r\n                    data-dojo-attach-point\x3d"updateRotationPointNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.updateRotationPointTooltipText}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Screen digitization tool--\x3e\r\n                \x3cdiv class\x3d"esriCTTraverseToolIcons ecriCTLocationIcon esriCTCursorPointer" title\x3d"${nls.planSettings.onScreenDigitizationTooltipText}"\r\n                    data-dojo-attach-point\x3d"screenDigitizationNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.onScreenDigitizationTooltipText}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Zoom tool--\x3e\r\n                \x3cdiv class\x3d"esriCTHidden esriCTTraverseToolIcons ecriCTZoomToIcon esriCTCursorPointer" title\x3d"${nls.planSettings.zoomToLocationTooltipText}"\r\n                    data-dojo-attach-point\x3d"zoomToNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.zoomToLocationTooltipText}"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Expand/Collapse grid tool--\x3e\r\n                \x3cdiv class\x3d"esriCTHidden  esriCTTraverseToolIcons esriCTCollapse esriCTCursorPointer" title\x3d"${nls.planSettings.collapseGridTooltipText}"\r\n                    data-dojo-attach-point\x3d"expandCollapseNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.collapseGridTooltipText}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Misclose details container--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"misCloseDetailsNode"\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Parcel tools (rotation/scale) container--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"parcelToolsNode"\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Parcel info (polygon layer fields) \x26 save/cancle button container--\x3e\r\n    \x3cdiv class\x3d"esriCTPlanInfoNode" data-dojo-attach-point\x3d"planInfoNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/MiscloseDetails.html":'\x3cdiv class\x3d"esriCTTraverseDetailContainer esriCTFullWidth" data-dojo-attach-point\x3d"traverseDetailsContainer"\x3e\r\n    \x3c!-- Message div shown when misclose is not calculated --\x3e\r\n    \x3cdiv class\x3d"esriCTTraverseResultContainer esriCTEllipsis"\r\n    data-dojo-attach-point\x3d"noMiscloseCalculated"\x3e\r\n        ${nls.traverseSettings.noMiscloseCalculated}\r\n    \x3c/div\x3e\r\n    \x3c!-- Misclose details container --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTHidden" data-dojo-attach-point\x3d"miscloseDetailsContainer"\x3e\r\n        \x3c!-- Misclose Bearing Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseMiscloseBearingNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseMiscloseBearing}"\x3e\r\n                ${nls.traverseSettings.traverseMiscloseBearing}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv  esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseBearingNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Misclose Distance Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseDistanceNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseDistance}"\x3e\r\n                ${nls.traverseSettings.traverseDistance}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv"\r\n                data-dojo-attach-point\x3d"miscloseDistanceNode"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTCompassRuleAppliedHintContainer esriCTHidden" tabindex\x3d"0" role\x3d"document" aria-label\x3d"${nls.traverseSettings.compassRuleAppliedHint}"  data-dojo-attach-point\x3d"compassRuleAppliedHint"\r\n                title\x3d"${nls.traverseSettings.compassRuleAppliedHint}"\x3e\r\n                \x3cdiv class\x3d"esriCTCompassRuleAppliedHintIcon"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Misclose Ratio Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseMiscloseRatioNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseMiscloseRatio}"\x3e\r\n                ${nls.traverseSettings.traverseMiscloseRatio}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseRatioNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Accuracy Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseAccuracyNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseAccuracy}"\x3e\r\n                ${nls.traverseSettings.traverseAccuracy}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"accuracyNode"\x3e\r\n                ${nls.traverseSettings.accuracyHigh}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Stated Area Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer esriCTHidden" data-dojo-attach-point\x3d"traverseStatedAreaNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseStatedArea}"\x3e\r\n                ${nls.traverseSettings.traverseStatedArea}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"traverseStatedArea" style\x3d"font-weight:normal; width: 100px; height: 25px;" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.traverseStatedArea}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Calculated Area Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseCalculatedAreaNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseCalculatedArea}"\x3e\r\n                ${nls.traverseSettings.traverseCalculatedArea}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"calculatedAreaNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c/div\x3e',
"url:widgets/ParcelDrafter/ParcelTools.html":'\x3cdiv class\x3d"esriCTFullWidth"\x3e\r\n    \x3c!-- Rotation tool container--\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n        \x3cdiv class\x3d"esriCTRotationButton esriCTButtonIcon esriCTParcelToolButtonIcon esriCTCursorPointer" title\x3d"${nls.parcelTools.rotationToolLabel}"\r\n            data-dojo-attach-point\x3d"rotateButton" tabindex\x3d"0" role\x3d"button"  aria-pressed\x3d"false" aria-label\x3d"${nls.parcelTools.rotationToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolButtonLabel esriCTEllipsis" title\x3d"${nls.parcelTools.rotationToolLabel}"\x3e\r\n            ${nls.parcelTools.rotationToolLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolInputNode" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true" required\x3d"true" data-dojo-attach-point\x3d"rotationTxt" aria-label\x3d"${nls.parcelTools.rotationToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Scale tool container--\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n        \x3cdiv class\x3d"esriCTScaleButton esriCTButtonIcon esriCTParcelToolButtonIcon esriCTCursorPointer" title\x3d"${nls.parcelTools.scaleToolLabel}"\r\n            data-dojo-attach-point\x3d"scaleButton" tabindex\x3d"0" role\x3d"button" aria-pressed\x3d"false" aria-label\x3d"${nls.parcelTools.scaleToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolButtonLabel esriCTEllipsis" title\x3d"${nls.parcelTools.scaleToolLabel}"\x3e\r\n            ${nls.parcelTools.scaleToolLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolInputNode" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true" required\x3d"true" data-dojo-attach-point\x3d"scaleTxt" aria-label\x3d"${nls.parcelTools.scaleToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/PlanInfo.html":'\x3cdiv class\x3d"esriCTFullWidth"\x3e\r\n    \x3c!-- Parcel Layer Attribute list Parent--\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"parcelLayerRowNode"\x3e\r\n        \x3c!-- Parcel layer attribute list toggle node --\x3e\r\n        \x3cdiv class\x3d"esriCTParcelLayerParent" data-dojo-attach-point\x3d"expandCollapseParentNode"\x3e\r\n            \x3cdiv class\x3d"esriCTParcelLayerContainer esriCTEllipsis" data-dojo-attach-point\x3d"attributeListTitle"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTExpandCollapseParceLayer" data-dojo-attach-point\x3d"expandCollapseNode" tabindex\x3d"0"\r\n                role\x3d"button" aria-label\x3d"${nls.planInfo.showAttributeList}" title\x3d"${nls.planInfo.showAttributeList}"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Parcel Layer Attribute List Section--\x3e\r\n        \x3cdiv class\x3d"esriCTParcelAttributeList esriCTHidden" data-dojo-attach-point\x3d"attributeListNode"\x3e\r\n            \x3c!-- Attribute Inspector --\x3e\r\n            \x3cdiv class\x3d"esriCTAttributeInspectorContainer" data-dojo-attach-point\x3d"attributeInspectorContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Parcel name input container --\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"parcelNameRow"\x3e\r\n                \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"parcelName"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- DocumentType input container --\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"documentTypeRow"\x3e\r\n                \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"documentType"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Plan name input container --\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"planNameRow"\x3e\r\n                \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"planName"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Save/Cancle button container --\x3e\r\n        \x3cdiv class\x3d"esriCTPlanInfoNode"\x3e\r\n            \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn jimu-trailing-margin1" title\x3d"${nls.common.save}"\r\n                data-dojo-attach-point\x3d"planInfoSaveButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.common.save}"\x3e\r\n                ${nls.common.save}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn jimu-trailing-margin1 esriCTHidden"\r\n                title\x3d"${nls.common.deleteText}" data-dojo-attach-point\x3d"planInfoDeleteButton" tabindex\x3d"0"\r\n                role\x3d"button" aria-label\x3d"${nls.common.deleteText}"\x3e\r\n                ${nls.common.deleteText}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn" title\x3d"${nls.common.cancel}"\r\n                data-dojo-attach-point\x3d"planInfoCancelButton" tabindex\x3d"0" role\x3d"button"\r\n                aria-label\x3d"${nls.common.cancel}"\x3e\r\n                ${nls.common.cancel}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv\x3e\r\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e        \r\n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e",
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\r\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\r\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\r\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\r\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/ParcelDrafter/Widget.html":'\x3cdiv style\x3d"height: calc(100% - 10px);" class\x3d"esriCTFullHeight" data-dojo-attach-point\x3d"mainNode"\x3e\r\n    \x3cdiv class\x3d"esriCTFullHeight esriCTFullWidth" data-dojo-attach-point\x3d"widgetMainNode"\x3e\r\n        \x3c!--Main Page Node--\x3e\r\n        \x3cdiv class\x3d"esirCTMainPage" data-dojo-attach-point\x3d"mainPageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n                \x3cdiv class\x3d"esriCTButtonLabel esriCTEllipsis" title\x3d"${nls.newTraverseButtonLabel}"\x3e\r\n                    ${nls.newTraverseButtonLabel}\x3c/div\x3e\r\n                    \x3c!-- code for accessibility --\x3e\r\n                \x3cdiv class\x3d"esriCTNewTraverseButton esriCTButtonIcon esriCTCursorPointer" title\x3d"${nls.newTraverseButtonLabel}" data-dojo-attach-point\x3d"newTraverseButton"\r\n                tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.newTraverseButtonLabel}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n                \x3cdiv class\x3d"esriCTButtonLabel esriCTEllipsis" title\x3d"${nls.editTraverseButtonLabel}"\x3e\r\n                    ${nls.editTraverseButtonLabel}\x3c/div\x3e\r\n                    \x3c!-- code for accessibility --\x3e\r\n                \x3cdiv class\x3d"esriCTEditTraverseButton esriCTButtonIcon esriCTCursorPointer" title\x3d"${nls.editTraverseButtonLabel}" data-dojo-attach-point\x3d"editTraverseButton"\r\n                tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.editTraverseButtonLabel}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"newTraverseSelectMessageNodeWrapper" class\x3d"esriCTHidden"\x3e\r\n              \x3cdiv class\x3d"esriCTMainPageRow esriCTAlignCenter" data-dojo-attach-point\x3d"newTraverseSelectMessageNode"\x3e\r\n              \x3c/div\x3e\r\n              \x3c!-- XYInput Widget get inserted here --\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--Traverse Page Node--\x3e\r\n        \x3cdiv class\x3d"esriCTFullHeight esriCTHidden" data-dojo-attach-point\x3d"traversePageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTNewTraverseHeader"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButton esriCTCursorPointer"\x3e\r\n                    \x3cdiv class\x3d"esriCTItemLeftArrow" title\x3d"${nls.common.back}" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.common.back}" data-dojo-attach-point\x3d"traversePanelBackButton"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.newTraverseTitle}"  data-dojo-attach-point\x3d"traverseTitleNode"\x3e\r\n                    ${nls.newTraverseTitle}\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTPlanSettingsIcon esriCTCursorPointer" title\x3d"${nls.planSettings.planSettingsTitle}" data-dojo-attach-point\x3d"planSettingsButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.planSettingsTitle}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseNode" data-dojo-attach-point\x3d"traverseNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--Plan Settings Node--\x3e\r\n        \x3cdiv class\x3d"esriCTHidden esriCTFullHeight" data-dojo-attach-point\x3d"planSettingsPageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingHeader"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButton esriCTCursorPointer"\x3e\r\n                    \x3cdiv class\x3d"esriCTItemLeftArrow" title\x3d"${nls.common.back}" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.common.back}" data-dojo-attach-point\x3d"planSettingsPanelBackButton"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.planSettings.planSettingsTitle}"\x3e\r\n                    ${nls.planSettings.planSettingsTitle}\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPlanSettingsNode" data-dojo-attach-point\x3d"planSettingsNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTWidgetErrorNode esriCTHidden" data-dojo-attach-point\x3d"widgetErrorNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/ParcelDrafter/css/style.css":".esriCTMainContainer{min-width: 222px; height: 100%; -webkit-overflow-scrolling: touch; overflow: hidden;}.esriCTOverridePanelStyle{padding: 15px 0 0 0 !important;}.esriCTMapTooltip{width: 100px; word-wrap: break-word; border: 1px solid #7EABCD; background-color: white; padding: 5px; font-size: 9pt; z-index: 9999; -o-border-radius: 4px; -moz-border-radius: 4px; -webkit-border-radius: 4px; border-radius: 4px;}.jimu-widget-ParcelDrafter .esriCTWidgetErrorNode{padding: 0px 20px;}.jimu-widget-ParcelDrafter .esriCTFullHeight{height: 100%;}.jimu-widget-ParcelDrafter .esriCTFullWidth{width: 100%;}.jimu-widget-ParcelDrafter .esriCTEllipsis{overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-ParcelDrafter .esriCTCursorPointer{cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTCursorDefault{cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTAlignCenter{text-align: center;}.jimu-widget-ParcelDrafter .esriCTMainPageRow{width: calc(100% - 40px); margin: 20px 20px 20px 20px; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTButtonLabel{float: left; width: calc(100% - 45px); line-height: 35px; padding: 5px 5px 5px 0;}.jimu-widget-ParcelDrafter .esriCTEditTraverseButton{background: url(\"../images/edit-traverse.png\") no-repeat;}.jimu-widget-ParcelDrafter .esriCTNewTraverseButton{background: url(\"../images/new-traverse.png\") no-repeat;}.jimu-widget-ParcelDrafter .esriCTNewTraverseActive{background: url(\"../images/new-traverse-selected.png\") no-repeat; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTEditTraverseActive{background: url(\"../images/edit-traverse-selected.png\") no-repeat; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTButtonIcon{height: 45px; width: 45px; float: right; background-size: 45px;}.jimu-widget-ParcelDrafter .esriCTParcelToolButtonIcon{height: 45px; width: 45px; float: left; background-size: 45px 45px; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTDisabledParcelToolButton{background-color: #e8e8e8 !important; cursor: not-allowed;}.esriRtl .jimu-widget-ParcelDrafter .esriCTButtonIcon{float: left;}.jimu-widget-ParcelDrafter .esriCTTraverseTool{float: left; padding: 5px 5px 0 0; width: calc(100% - 20px);}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseTool{float: right; padding: 5px 0 0 5px;}.jimu-widget-ParcelDrafter .esriCTTraverseToolContainer{float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseToolContainer {float: left;}.jimu-widget-ParcelDrafter .esriCTTraverseToolIcons{height: 24px; width: 24px; background-size: 24px; float: left; background-repeat: no-repeat; margin: 5px 0px 5px 20px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseToolIcons{float: right; margin: 5px 20px 5px 0px;}.jimu-widget-ParcelDrafter .ecriCTLocationIcon{background-image: url('../images/digitization.png');}.jimu-widget-ParcelDrafter .ecriCTUpdateRotationPointIcon{background-image: url('../images/update-rotation.png');}.jimu-widget-ParcelDrafter .ecriCTLocationIcon.esriCTEnableButton{background-image: url('../images/digitization-selected.png'); background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .ecriCTUpdateRotationPointIcon.esriCTEnableButton{background-image: url('../images/update-rotation-selected.png'); background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .ecriCTZoomToIcon{background-image: url('../images/zoom.png');}.jimu-widget-ParcelDrafter .esriCTCollapse{background-image: url('../images/collapse.png');}.jimu-widget-ParcelDrafter .esriCTExpand{background-image: url('../images/expand.png');}.jimu-widget-ParcelDrafter .esriCTNewTraverseHeader{float: left; height: 30px; border-bottom: 1px solid #464646; padding: 0px 10px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsIcon{background-image: url('../images/settings.png'); height: 20px; width: 20px; background-size: 20px; float: right; background-repeat: no-repeat;}.jimu-widget-ParcelDrafter .esriCTTraverseDetailContainer{float: left; border-top: 1px solid #464646; border-bottom: 1px solid #464646; margin-top: 20px; background-color: #E4E4ED;}.jimu-widget-ParcelDrafter .esriCTMiscloseHeaderDiv{background-color: rgba(0,0,0,0.5);}.jimu-widget-ParcelDrafter .esriCTTraverseResultContainer{width: 100%; height: 25px; line-height: 25px; padding: 0 10px; float: left; text-align: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseResultContainer{text-align: right;}.jimu-widget-ParcelDrafter .esriCTParcelLayerContainer {width: calc(100% - 40px); height: 40px; line-height: 40px; padding: 0 10px; float: left; text-align: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelLayerContainer {text-align: right; float: right;}.jimu-widget-ParcelDrafter .esriCTExpandCollapseParceLayer {background-image: url(../images/right-arrow.png); height: 40px; width: 40px; line-height: 40px; float: right; background-repeat: no-repeat; transform: rotate(90deg); background-position: center center; cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTCollapsedParceLayer {transform: rotate(-90deg);}.jimu-widget-ParcelDrafter .esriCTParcelLayerParent {width: 100%; height: 40px; border-top: 1px solid #464646; border-bottom: 1px solid #464646;}.jimu-widget-ParcelDrafter .esriCTParcelAttributeList {margin: 5px;}.jimu-widget-ParcelDrafter .esriCTGridEmptyLabel {width: 50px; float: left; text-align: left;}.jimu-widget-ParcelDrafter .esriCTGridLabels{width: 70px; float: left; text-align: left; padding-left: 4px;}.jimu-widget-ParcelDrafter .esriCTGridBearingLabel{width: calc(100% - 210px);}.esriRtl .jimu-widget-ParcelDrafter .esriCTGridEmptyLabel{float: right; text-align: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTGridLabels{float: right; text-align: right; padding-right: 4px; padding-left: 0px;}.jimu-widget-ParcelDrafter .dijitTextBox .dijitInputInner{height: 21px;}.jimu-widget-ParcelDrafter .dijitTextBoxFocused .dijitInputContainer{background: transparent;}.jimu-widget-ParcelDrafter .esriCTTraverseResultsDiv{max-width: 45%; float: left; padding-right: 5px;}.jimu-widget-ParcelDrafter .esriCTTraversedValueDiv{font-weight: bold;}.jimu-widget-ParcelDrafter .esriCTNewTraverseGrid{height: calc(100% - 40px); overflow: auto;}.jimu-widget-ParcelDrafter .esriCTNewTraverseContainer{padding: 10px; width: 100%; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTNewTraverseLabelDiv{display: inline-block; width: 100%;}.jimu-widget-ParcelDrafter .esriCTTraverseGrid{width: 100%; display: table; border-collapse: collapse;}.jimu-widget-ParcelDrafter .esriCTHidden{display: none !important;}::-ms-clear{display: none;}.jimu-widget-ParcelDrafter .esriCTRotationButton{background-image: url('../images/scale-rotation-active.png');}.jimu-widget-ParcelDrafter .esriCTScaleButton{background-image: url('../images/scale-active.png');}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTParcelToolButtonIcon{background-color: inherit;}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTRotationButton{background-image: url('../images/scale-rotation.png');}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTScaleButton{background-image: url('../images/scale.png');}.jimu-widget-ParcelDrafter .esriCTParcelToolButtonLabel{float: left; max-width: calc(100% - 145px); line-height: 35px; padding: 5px 20px;}.jimu-widget-ParcelDrafter .esriCTParcelToolInputNode{width: 100px; height: 25px; margin-top: 10px; float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolButtonIcon{float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolInputNode{float: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolButtonLabel{float: right;}.jimu-widget-ParcelDrafter .esriCTPlanInfoNode{margin: 0 4px; display: inline-block; width: calc(100% - 8px)}.jimu-widget-ParcelDrafter .esriCTPlanInfoButton{width: 80px; margin-top: 10px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsNode{width: 100%; height: calc(100% - 30px); display: inline-block; overflow-y: auto;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsContainer{margin: 20px; display: inline-block; width: calc(100% - 40px);}.jimu-widget-ParcelDrafter .esriCTPlanSettingRow{padding-bottom: 20px;}.jimu-widget-ParcelDrafter .esriCTDropdownLabel{padding-bottom: 5px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingHeader{float: left; height: 30px; border-bottom: 1px solid #464646; padding: 0px 10px;}.jimu-widget-ParcelDrafter .esriCTBackButton{width: 25%;}.jimu-widget-ParcelDrafter .esriCTTitleDiv{line-height: 10px; font-weight: bold; text-align: center; width: calc(100% - 50px); padding: 5px; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTItemLeftArrow{background-image: url('../images/left-arrow.png'); float: left; margin: 0px 5px 0px 0px; width: 15px; height: 20px; background-repeat: no-repeat; background-position: center center;}.jimu-widget-ParcelDrafter .dijitSelect .dijitButtonContents{border-style: none none none none; background-color: #fafafc;}.jimu-widget-ParcelDrafter .dijitSelect .dijitButtonContentsDartTheme {background-color: inherit;}.jimu-widget-ParcelDrafter .dijitSelect .dijitArrowButton{background-color: #fafafc; background-image: none; border-color: #fafafc;}.jimu-widget-ParcelDrafter .dijitSelect .dijitArrowButtonDartTheme {background-color: rgba(0, 0, 0, 0.5) !important;}.jimu-widget-ParcelDrafter .dijitMenuItem{color: #7989a0;}.jimu-widget-ParcelDrafter .dijitSelect .dijitInputField{margin-right: 8px;}input[type\x3dtext]::-ms-clear{display: none;}.jimu-widget-ParcelDrafter .esriCTRow {clear: both; display: table-row; width: 100%;}.jimu-widget-ParcelDrafter .esriCTNewTraverseGrid{float: left; width: 100%; position: relative; text-align: center; margin: 10px 0px;}.jimu-widget-ParcelDrafter .dijitTextBox .dijitPlaceHolder{font-size: 12px;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBox{margin: 0; width: 70px; display: table-cell;}.jimu-widget-ParcelDrafter .dijitTextBoxError {border-color: #d9dde0 !important; box-shadow: inset 0 0 0 2px #d46464;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBoxHover{border-color: #d9dde0;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBoxFocused{border-color: #d9dde0 !important; box-shadow: none; outline: none;}.jimu-widget-ParcelDrafter .esriCTBearingRow{width: calc(100% - 210px) !important;}.jimu-widget-ParcelDrafter .dojoDndItemAfter .esriCTSymbolContainer, .jimu-widget-ParcelDrafter .dojoDndItemBefore .esriCTSymbolContainer{background: #E4E4ED !important;}.jimu-widget-ParcelDrafter .dojoDndItem, .jimu-widget-demo .dojoDndItemAnchor, .jimu-widget-demo .dojoDndItemSelected, .dojoDndContainerOver, .dojoDndItemOver{background: none; border: none; padding: 0; cursor: move;}.jimu-widget-ParcelDrafter .esriCTDeleteRow, .jimu-widget-ParcelDrafter .esriCTAddRow{color: #CCC; display: table-cell; vertical-align: middle; font-size: 18px; width: 15px;}.jimu-widget-ParcelDrafter .esriCTDeleteIcon, .jimu-widget-ParcelDrafter .esriCTAddIcon{cursor: pointer; height: 30px; width: 15px; margin-left: 5px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTDeleteIcon,.esriRtl .jimu-widget-ParcelDrafter .esriCTAddIcon{margin-right: 5px; margin-left: 0;}.jimu-widget-ParcelDrafter .esriCTDeleteIcon{background: url('../images/delete.png') no-repeat center center;}.jimu-widget-ParcelDrafter .esriCTAddIcon{background: url('../images/add.png') no-repeat center center;}.jimu-widget-ParcelDrafter .esriCTEntryNodeContainer{float: left; width: 100%;}.jimu-widget-ParcelDrafter .esriCTEntrtyNodeContent{width: 100%; display: table; border-collapse: collapse;}.esriCTSymbolContainer{border: 1px solid #dedede; width: 50px; height: 30px; padding: 0px 5px; vertical-align: middle; display: table-cell;}.esriCTSymbolPopup .dijitTooltipContainer{padding: 0px;}.esriCTSymbolListContainer{max-height: 150px; overflow: auto; margin: 6px 0px; width: 170px;}.esriCTSymbolListContent{margin: 0px 6px;}.esriCTSelectedSymbol{width: 30px; height: 25px; overflow: hidden; margin-top: 4px; cursor: pointer;}.esriCTSymbolIcon{width: 35px; vertical-align: middle; margin: 2px 3px 0px 3px; overflow: hidden; display: inline-block;}.esriCTSymbolOption{height: 25px; width: 100%; cursor: pointer; margin-top: 1px; margin-bottom: 1px;}.esriCTSymbolOption:hover{background-color: #edf2f5;}.esriCTSymbolName{display: inline-block; white-space: nowrap; margin-left: 5px; overflow: hidden; text-overflow: ellipsis; width: 95px; color: #7989a0; vertical-align: middle;}.esriRtl .jimu-widget-ParcelDrafter .esriCTButtonLabel{float: right; padding: 5px 0px 5px 5px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTItemLeftArrow{float: right; margin: 0px 0px 00px 10px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTPlanSettingsIcon{float: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTItemLeftArrow{background-image: url('../images/right-arrow.png');}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseResultsDiv{float: right;}.esriRtl .jimu-widget-ParcelDrafter .dijitSelect .dijitInputField{margin-left: 8px; margin-right: 0;}.jimu-widget-ParcelDrafter .esriCTEditParcelDialog{position: absolute; width: 250px; z-index:100;}.jimu-widget-ParcelDrafter .esriCTParcelInfoPopup{display: table; border-collapse: collapse; width: 100%;}.jimu-widget-ParcelDrafter .esriCTParcelInfoLabels{height: 20px; display: table-cell; text-align: center; text-overflow: ellipsis; overflow: hidden; word-wrap: nowrap; margin-right: 5px;}.jimu-widget-ParcelDrafter .esriCTLabelRows{display: table-row;}.jimu-widget-ParcelDrafter .esriCTParcelInfoPopup .esriCTRowContainer{display: table-row;}.jimu-widget-ParcelDrafter .jimu-widget-ParcelDrafter-XYInput .xyRowWrapper {margin: 5px;}.jimu-widget-ParcelDrafter .atiButton, .jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiLayerName {display: none;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiButtons {display: none;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer td {display: block; clear: both; height: auto; width: 100%; float: left;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer table {width: 100%;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiField {width: 100%;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiLabel {margin-top: 6px !important; margin-bottom: 3px !important; text-align: left;}.jimu-rtl .jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiLabel {text-align: right;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .dijitTextBox {width: 100% !important;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .dijitTextArea {width: 100% !important; min-height: 70px; resize: vertical; overflow: auto; font-family: inherit; line-height: 20px !important; font-size: 14px;}.jimu-widget-ParcelDrafter .atiAttributes {height: 100%; padding-right: 2px;}.jimu-rtl .jimu-widget-ParcelDrafter .atiAttributes {padding-right: 0px; padding-left: 2px;}.jimu-widget-ParcelDrafter .esriCTCompassRuleAppliedHintContainer {display: inline-block; line-height: 25px; width: 10%;}.jimu-widget-ParcelDrafter .esriCTCompassRuleAppliedHintIcon {background: url(../images/warning.png) center center no-repeat; background-size: 18px 18px; height: 20px; width: 30px; float: left; cursor: pointer; padding-right: 5px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTCompassRuleAppliedHintIcon {float: right; padding-left: 5px;}.LaunchpadTheme .jimu-widget-ParcelDrafter .dijitTextBox .dijitInputField .dijitPlaceHolder {padding: 0; margin-top: 5px;}.LaunchpadTheme .jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .esriAttributeInspector .dijitComboBox\x3ediv.dijitArrowButton.dijitDownArrowButton{height: 30px;}",
"*now":function(H){H(['dojo/i18n!*preload*widgets/ParcelDrafter/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/on ./PlanSettings ./XYInput ./NewTraverse ./MapTooltipHandler ./layerUtils esri/tasks/GeometryService jimu/dijit/Message jimu/dijit/LoadingIndicator esri/tasks/query esri/geometry/Extent esri/request jimu/utils dijit/focus dojo/keys".split(" "),function(H,d,h,l,n,g,p,e,x,D,y,k,r,O,B,t,v,C,Q,N,T,U,m){return H([d],{baseClass:"jimu-widget-ParcelDrafter",_prevOpenPanel:"mainPage",
_newTraverseInstance:null,_planSettingsInstance:null,_mapTooltipHandler:null,_startPoint:null,geometryService:null,_lineLayerSpatialReference:null,_polygonLayerSpatialReference:null,_isUpdateStartPoint:null,_featureReductionEnabledLayers:[],postMixInProperties:function(){this.nls.common={};l.mixin(this.nls.common,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.openAtStartAysn=!0;if(this.appConfig.geometryService){this.geometryService=new B(this.appConfig.geometryService);
if(!this._isValidConfig())return this._showErrorInWidgetPanel(this.nls.invalidConfigMsg),!1;this._layerUtils=new O({map:this.map,getPopupInfo:!0,getRenderer:!1});l.mixin(this.config.polylineLayer,this._layerUtils.getLayerDetailsFromMap(this.config.polylineLayer.baseURL,this.config.polylineLayer.layerId,this.config.polylineLayer.id));l.mixin(this.config.polygonLayer,this._layerUtils.getLayerDetailsFromMap(this.config.polygonLayer.baseURL,this.config.polygonLayer.layerId,this.config.polygonLayer.id));
this._initLoading();this._getSpatialReferenceOfParcelLayers();this._setFirstLastNodeInWidget()}else this._showErrorInWidgetPanel(this.nls.geometryServiceURLNotFoundMSG)},startup:function(){this.inherited(arguments);n.add(this.domNode.parentElement,"esriCTOverridePanelStyle");this._featureReductionEnabledLayers=[];h.forEach(this.config.snappingLayers,function(u){u=this.map.getLayer(u.id);u.isFeatureReductionEnabled&&u.isFeatureReductionEnabled()&&this._featureReductionEnabledLayers.push(u)},this)},
onOpen:function(){this._mapTooltipHandler&&"mainPage"!==this._prevOpenPanel&&(this._isUpdateStartPoint=!0,this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint),this._toggleSnapping(!0));T.isAutoFocusFirstNodeWidget(this)&&T.focusFirstFocusNode(this.domNode)},onActive:function(){h.forEach(this._featureReductionEnabledLayers,function(u){u.disableFeatureReduction()})},onDeActive:function(){h.forEach(this._featureReductionEnabledLayers,function(u){u.enableFeatureReduction()})},
onClose:function(){if("planSettingsPage"===this._prevOpenPanel)this._planSettingsInstance.onClose();this._mapTooltipHandler&&(this._toggleSnapping(!1),this._mapTooltipHandler.disconnectEventHandler(),n.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),n.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),g.set(this.newTraverseButton,"aria-pressed","false"),g.set(this.editTraverseButton,"aria-pressed","false"),this.newTraverseSelectMessageNode.innerHTML=
"",n.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden"),this._newTraverseInstance.deActivateDigitizationTool(),this._newTraverseInstance.deactivateParcelTools(),this._newTraverseInstance.closePopup())},destroy:function(){h.forEach(this._featureReductionEnabledLayers,function(u){u.enableFeatureReduction()});this.inherited(arguments)},_initWidgetWorkFlow:function(){this._handleClickEvents();this._createMapTooltipHandler();this._createNewTraverse();this._createPlanSettings();this._createXYInput()},
_isValidConfig:function(){var u=!0;this.config?(this.config.polygonLayer&&this.map.getLayer(this.config.polygonLayer.id)||(u=!1),this.config.polylineLayer&&this.map.getLayer(this.config.polylineLayer.id)||(u=!1)):u=!1;return u},_initLoading:function(){this.loading=new v({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()},_getSpatialReferenceOfParcelLayers:function(){var u;this.loading.show();N({url:this.config.polylineLayer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(l.hitch(this,
function(M){this._lineLayerSpatialReference=M.extent.spatialReference;u=N({url:this.config.polygonLayer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});u.then(l.hitch(this,function(I){this.loading.hide();this._polygonLayerSpatialReference=I.extent.spatialReference;this._initWidgetWorkFlow()}))}))},_newTraverseButtonClicked:function(){this._mapTooltipHandler.disconnectEventHandler();this._newTraverseInstance.clearAll();n.contains(this.newTraverseButton,"esriCTNewTraverseActive")?
(this._toggleSnapping(!1),n.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),g.set(this.newTraverseButton,"aria-pressed","false"),this.newTraverseSelectMessageNode.innerHTML="",n.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")):(n.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),n.replace(this.newTraverseButton,"esriCTNewTraverseActive","esriCTNewTraverseButton"),g.set(this.newTraverseButton,"aria-pressed","true"),
g.set(this.editTraverseButton,"aria-pressed","false"),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForStartNewTraverse),this._isUpdateStartPoint=!0,this._toggleSnapping(!0),this.newTraverseSelectMessageNode.innerHTML=this.nls.mapTooltipForStartNewTraverse,n.remove(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden"),this._xyInputInstance.resetXYTextBoxes());this._setFirstLastNodeInWidget()},_editTraverseButtonClicked:function(){this._mapTooltipHandler.disconnectEventHandler();
this._newTraverseInstance.clearAll();n.contains(this.editTraverseButton,"esriCTEditTraverseActive")?(n.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),g.set(this.editTraverseButton,"aria-pressed","false"),this.newTraverseSelectMessageNode.innerHTML="",n.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")):(n.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),n.replace(this.editTraverseButton,"esriCTEditTraverseActive",
"esriCTEditTraverseButton"),g.set(this.editTraverseButton,"aria-pressed","true"),g.set(this.newTraverseButton,"aria-pressed","false"),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForEditNewTraverse),this.newTraverseSelectMessageNode.innerHTML=this.nls.mapTooltipForEditNewTraverse);this._setFirstLastNodeInWidget()},_handleClickEvents:function(){this.own(x(this.planSettingsButton,"click",l.hitch(this,function(){this._showPanel("planSettingsPage")})));this.own(x(this.planSettingsButton,
"keydown",l.hitch(this,function(u){u.keyCode!==m.ENTER&&u.keyCode!==m.SPACE||this._showPanel("planSettingsPage")})));this.own(x(this.newTraverseButton,"click",l.hitch(this,this._newTraverseButtonClicked)));this.own(x(this.newTraverseButton,"keydown",l.hitch(this,function(u){u.keyCode!==m.ENTER&&u.keyCode!==m.SPACE||this._newTraverseButtonClicked()})));this.own(x(this.editTraverseButton,"click",l.hitch(this,this._editTraverseButtonClicked)));this.own(x(this.editTraverseButton,"keydown",l.hitch(this,
function(u){u.keyCode!==m.ENTER&&u.keyCode!==m.SPACE||this._editTraverseButtonClicked()})));this.own(x(this.planSettingsPanelBackButton,"click",l.hitch(this,function(){this._planSettingsInstance.onClose();this._showPanel("traversePage")})));this.own(x(this.planSettingsPanelBackButton,"keydown",l.hitch(this,function(u){if(u.keyCode===m.ENTER||u.keyCode===m.SPACE)this._planSettingsInstance.onClose(),this._showPanel("traversePage"),U.focus(this.planSettingsButton)})));this.own(x(this.traversePanelBackButton,
"click",l.hitch(this,this._confirmCancelTraverse)));this.own(x(this.traversePanelBackButton,"keydown",l.hitch(this,function(u){u.keyCode!==m.ENTER&&u.keyCode!==m.SPACE||this._confirmCancelTraverse()})))},_setSnappingLayers:function(){var u=[],M,I;if(this.config.snappingLayers&&this.config.snappingLayers.length)for(I=0;I<this.config.snappingLayers.length;I++)(M=this.map.getLayer(this.config.snappingLayers[I].id))&&u.push({layer:M});this._isUpdateStartPoint||this._newTraverseInstance.parcelPointsGraphicsLayer&&
u.push({layer:this._newTraverseInstance.parcelPointsGraphicsLayer});this.map.snappingManager&&this.map.snappingManager.setLayerInfos(u)},_toggleSnapping:function(u){this.map.snappingManager&&(this.map.snappingManager._deactivateSnapping(),this.map.disableSnapping());u&&!this.map.snappingManager&&(this.map.enableSnapping({tolerance:this.config.snappingTolerance,snapToEdge:!0,snapToPoint:!0,snapToVertex:!0,alwaysSnap:!0}),this._setSnappingLayers(),this.map.snappingManager._setUpSnapping())},_confirmCancelTraverse:function(){this._newTraverseInstance.closePopup();
var u=new t({message:this.nls.clearingDataConfirmationMessage,type:"question",buttons:[{label:this.nls.common.yes,onClick:l.hitch(this,function(){u.close();this._resetOnBackToMainPage(!0)})},{label:this.nls.common.no}]})},_resetOnBackToMainPage:function(u){this._startPoint=null;n.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive");n.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive");g.set(this.newTraverseButton,"aria-pressed","false");
g.set(this.editTraverseButton,"aria-pressed","false");this.newTraverseSelectMessageNode.innerHTML="";n.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden");this._toggleSnapping(!1);this._mapTooltipHandler.disconnectEventHandler();this._newTraverseInstance.clearAll();this._showPanel("mainPage");u&&U.focus(this.newTraverseButton)},_createMapTooltipHandler:function(){this._mapTooltipHandler=new r({toolTipText:this.nls.mapTooltipForStartNewTraverse,map:this.map});this._isUpdateStartPoint=!0;this.own(this._mapTooltipHandler.on("clicked",
l.hitch(this,function(u){if(this.map&&this.map.snappingManager){var M=this.map.snappingManager.getSnappingPoint(u.screenPoint);M.then(l.hitch(this,function(I){this._onMapPointSelected(I?I:u.mapPoint)}))}else this._onMapPointSelected(u.mapPoint)})));this.own(this._mapTooltipHandler.on("dragging",l.hitch(this,function(u){this._startPoint&&(this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForRotate?this._newTraverseInstance.setRotation(u.mapPoint):this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForScale&&
this._newTraverseInstance.setScaling(u.mapPoint))})));this.own(this._mapTooltipHandler.on("moving",l.hitch(this,function(u){this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForUpdateStartPoint&&this._startPoint&&this._newTraverseInstance._showParcelPopup(u).then(l.hitch(this,function(M){M&&e.set(this._mapTooltipHandler._mapTooltip,"display","none")}))})));this._mapTooltipHandler.startup()},_onMapPointSelected:function(u,M){this._mapTooltipHandler.toolTipText!==this.nls.mapTooltipForUpdatingRotaionPoint&&
(this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForScreenDigitization?this._newTraverseInstance.pointAddedFromDigitization(u):(this._startPoint||(this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForEditNewTraverse?(this._startPoint=u,this._getPolygonForEdits(u)):(g.set(this.traverseTitleNode,"innerHTML",this.nls.newTraverseTitle),g.set(this.traverseTitleNode,"title",this.nls.newTraverseTitle),this._showPanel("traversePage"),U.focus(this.traversePanelBackButton),this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint))),
this._startPoint=u,this._newTraverseInstance.setStartPoint(this._startPoint,!0,!0,M),U.focus(this.traversePanelBackButton)))},_getPolygonForEdits:function(u,M){this.loading.show();var I=(new Date).getTime();var S=new C;var E=this.map.getLayer(this.config.polygonLayer.id);S.geometry=u;S.outSpatialReference=this.map.spatialReference;S.returnGeometry=!1;S.outFields=["*"];S.where=I+"\x3d"+I;E?E.queryFeatures(M?M:S,l.hitch(this,function(W){this.loading.hide();W&&0<W.features.length?(this._newTraverseInstance.polygonDeleteArr=
[W.features[0]],this._getLinesForEdits(W.features[0])):M?(this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage)):this._getPolygonFromLinesForEdits(u)}),l.hitch(this,function(){this.loading.hide();this._startPoint=null;this._showMessage(this.nls.unableToFetchParcelMessage)})):(this.loading.hide(),this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage))},pointToExtent:function(u,M,I){if(0===I)return M;var S=u.extent.getWidth()/u.width;I*=S;return new Q(M.x-
I,M.y-I,M.x+I,M.y+I,u.spatialReference)},_getPolygonFromLinesForEdits:function(u){this.loading.show();var M=(new Date).getTime();var I=new C;var S=this.map.getLayer(this.config.polylineLayer.id);I.geometry=this.pointToExtent(this.map,u,5);I.outSpatialReference=this.map.spatialReference;I.returnGeometry=!1;I.outFields=["*"];I.where=M+"\x3d"+M;S?S.queryFeatures(I,l.hitch(this,function(E){this.loading.hide();if(E&&0<E.features.length&&E.features[0].attributes&&E.features[0].attributes[this.config.polylineLayer.relatedGUID.name]){var W=
new C,A=(new Date).getTime();W.where=A+"\x3d"+A+" and "+this.config.polygonLayer.relatedGUID.name+"\x3d'"+E.features[0].attributes[this.config.polylineLayer.relatedGUID.name]+"'";this._getPolygonForEdits(u,W)}else this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage)}),l.hitch(this,function(){this.loading.hide();this._startPoint=null;this._showMessage(this.nls.unableToFetchParcelMessage)})):(this.loading.hide(),this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage))},
_sortFeatureAccToSequenceID:function(u){var M=this.config.polylineLayer.sequenceId.name;u.sort(function(I,S){return I.attributes[M]-S.attributes[M]});return u},_getLinesForEdits:function(u){this.loading.show();var M=u.attributes[this.config.polygonLayer.relatedGUID.name];u=new C;u.outSpatialReference=this.map.spatialReference;u.returnGeometry=!0;u.outFields=["*"];u.where=this.config.polylineLayer.relatedGUID.name+"\x3d'"+M+"'";(M=this.map.getLayer(this.config.polylineLayer.id))?M.queryFeatures(u,
l.hitch(this,function(I){this.loading.hide();I&&0<I.features.length?(I.features=this._sortFeatureAccToSequenceID(I.features),this._newTraverseInstance.polylineDeleteArr=I.features,this._startPoint=I.features[0].geometry.getPoint(0,0),g.set(this.traverseTitleNode,"innerHTML",this.nls.editTraverseTitle),g.set(this.traverseTitleNode,"title",this.nls.editTraverseTitle),this._newTraverseInstance.initEditing(this._startPoint,I,this._lineLayerSpatialReference),this._toggleSnapping(!0),this._showPanel("traversePage"),
U.focus(this.traversePanelBackButton),this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint)):(this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelLinesMessage))}),l.hitch(this,function(){this.loading.hide();this._startPoint=null;this._showMessage(this.nls.unableToFetchParcelLinesMessage)})):(this.loading.hide(),this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelLinesMessage))},_createNewTraverse:function(){this._newTraverseInstance=new k({nls:this.nls,
config:this.config,map:this.map,loading:this.loading,geometryService:this.geometryService,appConfig:this.appConfig,lineLayerSpatialReference:this._lineLayerSpatialReference,polygonLayerSpatialReference:this._polygonLayerSpatialReference,widgetDomNode:this.domNode},this.traverseNode);this.own(this._newTraverseInstance.on("showMessage",l.hitch(this,this._showMessage)));this.own(this._newTraverseInstance.on("showParcelSavedAndDeleteMsg",l.hitch(this,this._showParcelSavedAndDeleteMsg)));this.own(this._newTraverseInstance.on("activateDigitizationTool",
l.hitch(this,function(){this._onActivateDigitization()})));this.own(this._newTraverseInstance.on("deActivateDigitizationTool",l.hitch(this,function(){this._onDeactivateDigitization()})));this.own(this._newTraverseInstance.on("activateUpdateRotationPointTool",l.hitch(this,function(){this._onActivateUpdateRotationPoint()})));this.own(this._newTraverseInstance.on("deActivateUpdateRotationPointTool",l.hitch(this,function(){this._onDeactivateUpdateRotationPoint()})));this.own(this._newTraverseInstance.on("cancelTraverse",
l.hitch(this,function(){this._confirmCancelTraverse()})));this.own(this._newTraverseInstance.on("displayMainPageAfterSave",l.hitch(this,function(u){this._resetOnBackToMainPage(u)})));this.own(this._newTraverseInstance.on("toggleRotating",l.hitch(this,function(u){this._toggleRotating(u)})));this.own(this._newTraverseInstance.on("toggleScaling",l.hitch(this,function(u){this._toggleScaling(u)})))},_toggleRotating:function(u){u?(this._mapTooltipHandler.connectMouseDragHandler(this.nls.mapTooltipForRotate),
this._newTraverseInstance.deActivateDigitizationTool(),this._newTraverseInstance.deActivateUpdateRotationPointTool()):(this._isUpdateStartPoint=!0,this._mapTooltipHandler.disconnectEventHandler(),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint));this._toggleSnapping(!u)},_toggleScaling:function(u){u?(this._mapTooltipHandler.connectMouseDragHandler(this.nls.mapTooltipForScale),this._newTraverseInstance.deActivateDigitizationTool(),this._newTraverseInstance.deActivateUpdateRotationPointTool()):
(this._newTraverseInstance.distance=null,this._isUpdateStartPoint=!0,this._mapTooltipHandler.disconnectEventHandler(),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint));this._toggleSnapping(!u)},_onActivateDigitization:function(){this._mapTooltipHandler.disconnectEventHandler();this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForScreenDigitization);this._newTraverseInstance.deactivateParcelTools();this._isUpdateStartPoint=!1;this._toggleSnapping(!0)},
_onDeactivateDigitization:function(){this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint);this._isUpdateStartPoint=!0;this._toggleSnapping(!0)},_onActivateUpdateRotationPoint:function(){this._mapTooltipHandler.disconnectEventHandler();this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdatingRotaionPoint);this._newTraverseInstance.deactivateParcelTools();this._isUpdateStartPoint=!1;this._toggleSnapping(!0)},_onDeactivateUpdateRotationPoint:function(){this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint);
this._isUpdateStartPoint=!0;this._toggleSnapping(!0)},_createPlanSettings:function(){this._planSettingsInstance=new D({nls:this.nls,config:this.config,appConfig:this.appConfig,widgetId:this.id,widgetDomNode:this.domNode},p.create("div",{},this.planSettingsNode));this.own(this._planSettingsInstance.on("planSettingsChanged",l.hitch(this,function(u){this._newTraverseInstance.updateAccordingToPlanSettings(u)})));this._planSettingsInstance.startup()},_createXYInput:function(){this._xyInputInstance=(new y({nls:this.nls,
config:this.config,appConfig:this.appConfig,map:this.map,widgetDomNode:this.domNode})).placeAt(this.newTraverseSelectMessageNodeWrapper,"last");this.own(this._xyInputInstance.on("newPoint",l.hitch(this,function(u){this._onMapPointSelected(u,!0)})));this._xyInputInstance.startup()},_showPanel:function(u){if(this._prevOpenPanel){var M=this._getNodeByName(this._prevOpenPanel);n.add(M,"esriCTHidden")}M=this._getNodeByName(u);n.remove(M,"esriCTHidden");this._prevOpenPanel=u;setTimeout(l.hitch(this,function(){this._setFirstLastNodeInWidget()}),
100)},_showMessage:function(u){(new t({message:u,buttons:[{label:this.nls.common.ok}]})).message=u},_showErrorInWidgetPanel:function(u){g.set(this.widgetErrorNode,"innerHTML",u);n.add(this.widgetMainNode,"esriCTHidden");n.remove(this.widgetErrorNode,"esriCTHidden")},_getNodeByName:function(u){switch(u){case "mainPage":var M=this.mainPageNode;break;case "traversePage":M=this.traversePageNode;break;case "planSettingsPage":M=this.planSettingsPageNode}return M},_setFirstLastNodeInWidget:function(){!n.contains(this.mainPageNode,
"esriCTHidden")&&n.contains(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")?(T.initFirstFocusNode(this.domNode,this.newTraverseButton),T.initLastFocusNode(this.domNode,this.editTraverseButton)):n.contains(this.mainPageNode,"esriCTHidden")||n.contains(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")?n.contains(this.traversePageNode,"esriCTHidden")?n.contains(this.planSettingsPageNode,"esriCTHidden")||(T.initFirstFocusNode(this.domNode,this.planSettingsPanelBackButton),U.focus(this.planSettingsPanelBackButton),
this._planSettingsInstance.updateLastNodeInPlanSetting()):(T.initFirstFocusNode(this.domNode,this.traversePanelBackButton),this._newTraverseInstance.updateLastNodeInTraversePanel()):(T.initFirstFocusNode(this.domNode,this.newTraverseButton),this._xyInputInstance._updateLastFocusNode())},_showParcelSavedAndDeleteMsg:function(u){var M=new t({message:u,buttons:[{label:this.nls.common.ok,onClick:l.hitch(this,function(){M.close();setTimeout(l.hitch(this,function(){U.focus(this.newTraverseButton)}),100)})}]});
M.message=u}})});