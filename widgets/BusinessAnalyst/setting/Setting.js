// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),function(v,A,B,t,h,c,
f,e,d,a,b,g,p,k,r,m,u,G,H,C,E,K,D,z,y){function x(q){return new C({command:q.name})}function n(q){return new C({buttonClass:H,command:q.name})}B=B("dijit.Editor",z,{plugins:null,extraPlugins:null,constructor:function(){b.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",E]);this._plugins=[];this._editInterval=
1E3*this.editActionInterval;if(g("ie")||g("trident")||g("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new t;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);b.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=h.getLocalization("dijit._editor","commands",this.lang);
g("webkit")&&d.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new m({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));A.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);f.add(this.iframe.parentNode,"dijitEditorIFrameContainer");f.add(this.iframe,"dijitEditorIFrame");c.set(this.iframe,"allowTransparency",!0);this.toolbar.startup();
this.onNormalizedDisplayChanged()},destroy:function(){A.forEach(this._plugins,function(q){q&&q.destroy&&q.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(q,F){var J=b.isString(q)?{name:q}:b.isFunction(q)?{ctor:q}:q;if(!J.setEditor){var l={args:J,plugin:null,editor:this};J.name&&(C.registry[J.name]?l.plugin=C.registry[J.name](J):k.publish(y._scopeName+".Editor.getPlugin",l));if(!l.plugin)try{var w=J.ctor||b.getObject(J.name)||
v(J.name);w&&(l.plugin=new w(J))}catch(I){throw Error(this.id+": cannot find plugin ["+J.name+"]");}if(!l.plugin)throw Error(this.id+": cannot find plugin ["+J.name+"]");q=l.plugin}1<arguments.length?this._plugins[F]=q:this._plugins.push(q);q.setEditor(this);b.isFunction(q.setToolbar)&&q.setToolbar(this.toolbar)},resize:function(q){q&&G.prototype.resize.apply(this,arguments)},layout:function(){var q=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+e.getPadBorderExtents(this.iframe.parentNode).h+
e.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=q+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(q){var F,J=this.document.body,l=J.clientWidth,w=J.clientHeight,I=J.clientLeft,M=J.offsetWidth,L=J.offsetHeight,P=J.offsetLeft;/^rtl$/i.test(J.dir||"")?l<M&&q.x>l&&q.x<M&&(F=!0):q.x<I&&q.x>P&&(F=!0);F||w<L&&q.y>w&&q.y<L&&(F=!0);F||(delete this._cursorToStart,delete this._savedSelection,"BODY"==q.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(q){this.customUndo&&this.endEditing(!0);"BODY"!=q.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(q){this._inEditing||(this._inEditing=!0,this._beginEditing(q));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(q){if(!this.customUndo||
"undo"!=q&&"redo"!=q){this.customUndo&&(this.endEditing(),this._beginEditing());var F=this.inherited(arguments);this.customUndo&&this._endEditing();return F}return this[q]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(q){try{var F=this.document.execCommand(q,!1,null);if(g("webkit")&&!F)throw{};}catch(J){F=p.substitute,alert(F(this.commands.systemShortcut,
[this.commands[q],F(this.commands[g("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[q]])])),F=!1}return F},queryCommandEnabled:function(q){return!this.customUndo||"undo"!=q&&"redo"!=q?this.inherited(arguments):"undo"==q?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(q){var F=q.mark,J=q.mark;q=q.isCollapsed;var l;if(J)if(9>g("ie")||9===g("ie")&&g("quirks"))if(b.isArray(J))F=[],A.forEach(J,function(M){F.push(D.getNode(M,this.editNode))},this),this.selection.moveToBookmark({mark:F,
isCollapsed:q});else{if(J.startContainer&&J.endContainer&&(l=D.getSelection(this.window))&&l.removeAllRanges){l.removeAllRanges();q=D.create(this.window);var w=D.getNode(J.startContainer,this.editNode);var I=D.getNode(J.endContainer,this.editNode);w&&I&&(q.setStart(w,J.startOffset),q.setEnd(I,J.endOffset),l.addRange(q))}}else(l=D.getSelection(this.window))&&l.removeAllRanges&&(l.removeAllRanges(),q=D.create(this.window),w=D.getNode(J.startContainer,this.editNode),I=D.getNode(J.endContainer,this.editNode),
w&&I&&(q.setStart(w,J.startOffset),q.setEnd(I,J.endOffset),l.addRange(q)))},_changeToStep:function(q,F){this.setValue(F.text);(q=F.bookmark)&&this._moveToBookmark(q)},undo:function(){var q=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var F=this._steps.pop();F&&0<this._steps.length&&(this.focus(),this._changeToStep(F,this._steps[this._steps.length-1]),this._undoedSteps.push(F),this.onDisplayChanged(),delete this._undoRedoActive,q=!0);delete this._undoRedoActive}return q},
redo:function(){var q=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var F=this._undoedSteps.pop();F&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],F),this._steps.push(F),this.onDisplayChanged(),q=!0);delete this._undoRedoActive}return q},endEditing:function(q){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(q),this._inEditing=!1)},_getBookmark:function(){var q=this.selection.getBookmark(),
F=[];if(q&&q.mark){var J=q.mark;if(9>g("ie")||9===g("ie")&&g("quirks")){var l=D.getSelection(this.window);if(b.isArray(J))A.forEach(q.mark,function(I){F.push(D.getIndex(I,this.editNode).o)},this),q.mark=F;else if(l){var w;l.rangeCount&&(w=l.getRangeAt(0));q.mark=w?w.cloneRange():this.selection.getBookmark()}}try{q.mark&&q.mark.startContainer&&(F=D.getIndex(q.mark.startContainer,this.editNode).o,q.mark={startContainer:F,startOffset:q.mark.startOffset,endContainer:q.mark.endContainer===q.mark.startContainer?
F:D.getIndex(q.mark.endContainer,this.editNode).o,endOffset:q.mark.endOffset})}catch(I){q.mark=null}}return q},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:K.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var q=K.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:q,bookmark:this._getBookmark()})},onKeyDown:function(q){g("ie")||this.iframe||q.keyCode!=a.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var F=
q.keyCode;if(q.ctrlKey&&!q.shiftKey&&!q.altKey){if(90==F||122==F){q.stopPropagation();q.preventDefault();this.undo();return}if(89==F||121==F){q.stopPropagation();q.preventDefault();this.redo();return}}this.inherited(arguments);switch(F){case a.ENTER:case a.BACKSPACE:case a.DELETE:this.beginEditing();break;case 88:case 86:if(q.ctrlKey&&!q.altKey&&!q.metaKey){this.endEditing();88==q.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!q.ctrlKey&&!q.altKey&&
!q.metaKey&&(q.keyCode<a.F1||q.keyCode>a.F15)){this.beginEditing();break}case a.ALT:this.endEditing();break;case a.UP_ARROW:case a.DOWN_ARROW:case a.LEFT_ARROW:case a.RIGHT_ARROW:case a.HOME:case a.END:case a.PAGE_UP:case a.PAGE_DOWN:this.endEditing(!0);case a.CTRL:case a.SHIFT:case a.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(q){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(q){this.customUndo?this.isClosed?this.setValue(q):(this.beginEditing(),q||(q="\x26#160;"),this.setValue(q),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(q){this.setValueDeferred.then(b.hitch(this,function(){!this.disabled&&q||!this._buttonEnabledPlugins&&q?
A.forEach(this._plugins,function(F){F.set("disabled",!0)}):this.disabled&&!q&&A.forEach(this._plugins,function(F){F.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(d.set(this.document.body,"color",d.get(this.iframe,"color")),d.set(this.document.body,"background-color",d.get(this.iframe,"background-color")))}catch(q){}}});b.mixin(C.registry,{undo:x,redo:x,cut:x,copy:x,paste:x,insertOrderedList:x,insertUnorderedList:x,
indent:x,outdent:x,justifyCenter:x,justifyFull:x,justifyLeft:x,justifyRight:x,"delete":x,selectAll:x,removeFormat:x,unlink:x,insertHorizontalRule:x,bold:n,italic:n,underline:n,strikethrough:n,subscript:n,superscript:n,"|":function(){return new C({setEditor:function(q){this.editor=q;this.button=new u({ownerDocument:q.ownerDocument})}})}});return B})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(v,A,B,t,h,c,f,e){B("dijit-legacy-requires")&&h(0,function(){v(["dijit/ToolbarSeparator"])});return A("dijit.Toolbar",[c,e,f],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(v,A,B,t){return v("dijit.ToolbarSeparator",[B,t],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);A.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(v,A,B,t,h){A=A("dijit._editor._Plugin",t,{constructor:function(c){this.params=
c||{};B.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:h,disabled:!1,getLabel:function(c){return this.editor.commands[c]},_initButton:function(){if(this.command.length){var c=this.getLabel(this.command),f=this.editor,e=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(c=B.mixin({label:c,ownerDocument:f.ownerDocument,dir:f.dir,
lang:f.lang,showLabel:!1,iconClass:e,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete c.name,this.button=new this.buttonClass(c))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(c,f,e){this.own(v.connect(c,f,this,e))},updateState:function(){var c=this.editor,f=this.command;if(c&&c.isLoaded&&f.length){var e=this.get("disabled");if(this.button)try{var d=
c._implCommand(f);var a=!e&&(this[d]?this[d](f):c.queryCommandEnabled(f));this.enabled!==a&&(this.enabled=a,this.button.set("disabled",!a));if(a&&"boolean"==typeof this.button.checked){var b=c.queryCommandState(f);this.checked!==b&&(this.checked=b,this.button.set("checked",c.queryCommandState(f)))}}catch(g){console.log(g)}}},setEditor:function(c){this.editor=c;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",B.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",B.hitch(this,"updateState")))},setToolbar:function(c){this.button&&c.addChild(this.button)},set:function(c,f){if("object"===typeof c){for(var e in c)this.set(e,c[e]);return this}e=this._getAttrNames(c);if(this[e.s])var d=this[e.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(c,f);return d||this},get:function(c){var f=this._getAttrNames(c);
return this[f.g]?this[f.g]():this[c]},_setDisabledAttr:function(c){this._set("disabled",c);this.updateState()},_getAttrNames:function(c){var f=this._attrPairNames;if(f[c])return f[c];var e=c.charAt(0).toUpperCase()+c.substr(1);return f[c]={s:"_set"+e+"Attr",g:"_get"+e+"Attr"}},_set:function(c,f){this[c]=f}});A.registry={};return A})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b){return v("dijit._editor.plugins.EnterKeyHandling",d,{blockNodeForEnter:"BR",constructor:function(g){g&&("blockNodeForEnter"in g&&(g.blockNodeForEnter=g.blockNodeForEnter.toUpperCase()),t.mixin(this,g))},setEditor:function(g){if(this.editor!==g)if(this.editor=g,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,g.onLoadDeferred.then(t.hitch(this,function(k){this.own(h(g.document,"keydown",t.hitch(this,function(r){if(r.keyCode==B.ENTER){var m=t.mixin({},r);m.shiftKey=
!0;this.handleEnterKey(m)||(r.stopPropagation(),r.preventDefault())}})));9<=c("ie")&&10>=c("ie")&&this.own(h(g.document,"paste",t.hitch(this,function(r){setTimeout(t.hitch(this,function(){var m=this.editor.document.selection.createRange();m.move("character",-1);m.select();m.move("character",1);m.select()}),0)})));return k}));else if(this.blockNodeForEnter){var p=t.hitch(this,"handleEnterKey");g.addKeyHandler(13,0,0,p);g.addKeyHandler(13,0,1,p);this.own(this.editor.on("KeyPressed",t.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var g=this.editor.selection.getAncestorElement("LI");if(g){c("mozilla")&&"LI"==g.parentNode.parentNode.nodeName&&(g=g.parentNode.parentNode);var p=g.firstChild;!p||1!=p.nodeType||"UL"!=p.nodeName&&"OL"!=p.nodeName||(g.insertBefore(p.ownerDocument.createTextNode("\u00a0"),p),p=b.create(this.editor.window),p.setStart(g.firstChild,0),g=b.getSelection(this.editor.window,!0),g.removeAllRanges(),g.addRange(p))}else a.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(g=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(g.innerHTML=this.bogusHtmlContent,9>=c("ie")&&(g=this.editor.document.selection.createRange(),g.move("character",-1),g.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(g){var p,k=this.editor.document,r;if(g.shiftKey){g=this.editor.selection.getParentElement();if(p=b.getAncestor(g,this.blockNodes)){if("LI"==p.tagName)return!0;g=b.getSelection(this.editor.window);var m=g.getRangeAt(0);m.collapsed||(m.deleteContents(),g=b.getSelection(this.editor.window),m=g.getRangeAt(0));if(b.atBeginningOfContainer(p,m.startContainer,m.startOffset)){var u=k.createElement("br");m=b.create(this.editor.window);p.insertBefore(u,
p.firstChild);m.setStartAfter(u);g.removeAllRanges();g.addRange(m)}else if(b.atEndOfContainer(p,m.startContainer,m.startOffset))m=b.create(this.editor.window),u=k.createElement("br"),p.appendChild(u),p.appendChild(k.createTextNode("\u00a0")),m.setStart(p.lastChild,0),g.removeAllRanges(),g.addRange(m);else{if((r=m.startContainer)&&3==r.nodeType){var G=r.nodeValue;var H=k.createTextNode(G.substring(0,m.startOffset));var C=k.createTextNode(G.substring(m.startOffset));p=k.createElement("br");""==C.nodeValue&&
c("webkit")&&(C=k.createTextNode("\u00a0"));A.place(H,r,"after");A.place(p,H,"after");A.place(C,p,"after");A.destroy(r);m=b.create(this.editor.window);m.setStart(C,0);g.removeAllRanges();g.addRange(m);return!1}return!0}}else g=b.getSelection(this.editor.window),g.rangeCount?(m=g.getRangeAt(0))&&m.startContainer&&(m.collapsed||(m.deleteContents(),g=b.getSelection(this.editor.window),m=g.getRangeAt(0)),(r=m.startContainer)&&3==r.nodeType?(p=m.startOffset,r.length<p&&(C=this._adjustNodeAndOffset(r,p),
r=C.node,p=C.offset),G=r.nodeValue,H=k.createTextNode(G.substring(0,p)),C=k.createTextNode(G.substring(p)),p=k.createElement("br"),C.length||(C=k.createTextNode("\u00a0")),H.length?A.place(H,r,"after"):H=r,A.place(p,H,"after"),A.place(C,p,"after"),A.destroy(r)):(0<=m.startOffset&&(u=r.childNodes[m.startOffset]),p=k.createElement("br"),C=k.createTextNode("\u00a0"),u?(A.place(p,u,"before"),A.place(C,p,"after")):(r.appendChild(p),r.appendChild(C))),m=b.create(this.editor.window),m.setStart(C,0),m.setEnd(C,
C.length),g.removeAllRanges(),g.addRange(m),this.editor.selection.collapse(!0)):a.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var E=!0;g=b.getSelection(this.editor.window);m=g.getRangeAt(0);m.collapsed||(m.deleteContents(),g=b.getSelection(this.editor.window),m=g.getRangeAt(0));u=b.getBlockAncestor(m.endContainer,null,this.editor.editNode);var K=u.blockNode;if(this._checkListLater=K&&("LI"==K.nodeName||"LI"==K.parentNode.nodeName))return c("mozilla")&&(this._pressedEnterInBlock=
K),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(K.innerHTML)&&(K.innerHTML="",c("webkit")&&(m=b.create(this.editor.window),m.setStart(K,0),g.removeAllRanges(),g.addRange(m)),this._checkListLater=!1),!0;if(!u.blockNode||u.blockNode===this.editor.editNode){try{a.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(D){}u={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(u.blockNode){if(u.blockNode!=this.editor.editNode&&!(u.blockNode.textContent||u.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(u.blockNode),!1}else u.blockNode=this.editor.editNode;g=b.getSelection(this.editor.window);m=g.getRangeAt(0)}K=k.createElement(this.blockNodeForEnter);K.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(u.blockNode);C=m.endOffset;E=m.endContainer;E.length<C&&(C=this._adjustNodeAndOffset(E,C),E=
C.node,C=C.offset);if(b.atEndOfContainer(u.blockNode,E,C))u.blockNode===u.blockContainer?u.blockNode.appendChild(K):A.place(K,u.blockNode,"after"),E=!1,m=b.create(this.editor.window),m.setStart(K,0),g.removeAllRanges(),g.addRange(m),this.editor.height&&e.scrollIntoView(K);else if(b.atBeginningOfContainer(u.blockNode,m.startContainer,m.startOffset))A.place(K,u.blockNode,u.blockNode===u.blockContainer?"first":"before"),K.nextSibling&&this.editor.height&&(m=b.create(this.editor.window),m.setStart(K.nextSibling,
0),g.removeAllRanges(),g.addRange(m),e.scrollIntoView(K.nextSibling)),E=!1;else{u.blockNode===u.blockContainer?u.blockNode.appendChild(K):A.place(K,u.blockNode,"after");E=!1;u.blockNode.style&&K.style&&u.blockNode.style.cssText&&(K.style.cssText=u.blockNode.style.cssText);if((r=m.startContainer)&&3==r.nodeType){C=m.endOffset;r.length<C&&(C=this._adjustNodeAndOffset(r,C),r=C.node,C=C.offset);G=r.nodeValue;H=k.createTextNode(G.substring(0,C));C=k.createTextNode(G.substring(C,G.length));A.place(H,r,
"before");A.place(C,r,"after");A.destroy(r);for(m=H.parentNode;m!==u.blockNode;){G=k.createElement(m.tagName);m.style&&G.style&&m.style.cssText&&(G.style.cssText=m.style.cssText);"FONT"===m.tagName&&(m.color&&(G.color=m.color),m.face&&(G.face=m.face),m.size&&(G.size=m.size));for(;C;)r=C.nextSibling,G.appendChild(C),C=r;A.place(G,m,"after");H=m;C=G;m=m.parentNode}if(1==C.nodeType||3==C.nodeType&&C.nodeValue)K.innerHTML="";for(H=C;C;)r=C.nextSibling,K.appendChild(C),C=r}m=b.create(this.editor.window);
k=H;if("BR"!==this.blockNodeForEnter){for(;k;)p=k,k=r=k.firstChild;p&&p.parentNode?(K=p.parentNode,m.setStart(K,0),g.removeAllRanges(),g.addRange(m),this.editor.height&&e.scrollIntoView(K),c("mozilla")&&(this._pressedEnterInBlock=u.blockNode)):E=!0}else m.setStart(K,0),g.removeAllRanges(),g.addRange(m),this.editor.height&&e.scrollIntoView(K),c("mozilla")&&(this._pressedEnterInBlock=u.blockNode)}return E},_adjustNodeAndOffset:function(g,p){for(;g.length<p&&g.nextSibling&&3==g.nextSibling.nodeType;)p-=
g.length,g=g.nextSibling;return{node:g,offset:p}},removeTrailingBr:function(g){if(g=/P|DIV|LI/i.test(g.tagName)?g:this.editor.selection.getParentOfType(g,["P","DIV","LI"]))g.lastChild&&(1<g.childNodes.length&&3==g.lastChild.nodeType&&/^[\s\xAD]*$/.test(g.lastChild.nodeValue)||"BR"==g.lastChild.tagName)&&A.destroy(g.lastChild),g.childNodes.length||(g.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k,r,m,u,G,H,C,E,K,D,z,y,x,n,q,F){var J=B("dijit._editor.RichText",[D,z],{constructor:function(l){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};l&&p.isString(l.value)&&(this.value=l.value);this.onLoadDeferred=new t},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[p.trim,p.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);u("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));u("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(u("ie")||u("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[p.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[p.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);H.publish(F._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var l=p.hitch(this,function(M,L){return function(){return!this.execCommand(M,L)}}),w={b:l("bold"),i:l("italic"),u:l("underline"),a:l("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:l("formatblock",
"h1"),2:l("formatblock","h2"),3:l("formatblock","h3"),4:l("formatblock","h4"),"\\":l("insertunorderedlist")};u("ie")||(w.Z=l("redo"));for(var I in w)this.addKeyHandler(I,!0,!1,w[I])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(J._editorCommandsLocalized)this._local2NativeFormatNames=J._local2NativeFormatNames,this._native2LocalFormatNames=J._native2LocalFormatNames;else{J._editorCommandsLocalized=!0;J._local2NativeFormatNames={};
J._native2LocalFormatNames={};this._local2NativeFormatNames=J._local2NativeFormatNames;this._native2LocalFormatNames=J._native2LocalFormatNames;for(var l="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),w="",I,M=0;I=l[M++];)w="l"!==I.charAt(1)?w+("\x3c"+I+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+I+"\x3e\x3cbr/\x3e"):w+("\x3c"+I+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+I+"\x3e\x3cbr/\x3e");var L=e.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:w});this.ownerDocumentBody.appendChild(L);
l=p.hitch(this,function(){for(var P=L.firstChild;P;)try{this.selection.selectElement(P.firstChild);var O=P.tagName.toLowerCase();this._local2NativeFormatNames[O]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[O]]=O;P=P.nextSibling.nextSibling}catch(Q){}e.destroy(L)});this.defer(l)}},open:function(l){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new t;this.isClosed||this.close();H.publish(F._scopeName+"._editor.RichText::open",
this);1===arguments.length&&l.nodeName&&(this.domNode=l);var w=this.domNode;if(p.isString(this.value)){var I=this.value;w.innerHTML=""}else if(w.nodeName&&"textarea"==w.nodeName.toLowerCase()){var M=this.textarea=w;this.name=M.name;I=M.value;w=this.domNode=this.ownerDocument.createElement("div");w.setAttribute("widgetId",this.id);M.removeAttribute("widgetId");w.cssText=M.cssText;w.className+=" "+M.className;e.place(w,M,"before");var L=p.hitch(this,function(){a.set(M,{display:"block",position:"absolute",
top:"-1000px"});if(u("ie")){var N=M.style;this.__overflow=N.overflow;N.overflow="hidden"}});u("ie")?this.defer(L,10):L();if(M.form){var P=M.value;this.reset=function(){this.getValue()!==P&&this.replaceValue(P)};k(M.form,"submit",p.hitch(this,function(){c.set(M,"disabled",this.disabled);M.value=this.getValue()}))}}else I=n.getChildrenHtml(w),w.innerHTML="";this.value=I;w.nodeName&&"LI"===w.nodeName&&(w.innerHTML=" \x3cbr\x3e");this.header=w.ownerDocument.createElement("div");w.appendChild(this.header);
this.editingArea=w.ownerDocument.createElement("div");w.appendChild(this.editingArea);this.footer=w.ownerDocument.createElement("div");w.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!A.useXDomain||A.allowXdRichTextSave)){if((I=h.byId(F._scopeName+"._editor.RichText.value"))&&""!==I.value){L=I.value.split(this._SEPARATOR);for(var O=0,Q;Q=L[O++];)if(Q=Q.split(this._NAME_CONTENT_SEP),Q[0]===this.name){this.value=Q[1];L=L.splice(O,1);I.value=L.join(this._SEPARATOR);
break}}J._globalSaveHandler||(J._globalSaveHandler={},C.addOnUnload(function(){for(var N in J._globalSaveHandler){var R=J._globalSaveHandler[N];p.isFunction(R)&&R()}}));J._globalSaveHandler[this.id]=p.hitch(this,"_saveContent")}this.isClosed=!1;I=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");I.id=this.id+"_iframe";I.style.border="none";I.style.width="100%";this._layoutMode?I.style.height="100%":7<=u("ie")?(this.height&&(I.style.height=this.height),this.minHeight&&(I.style.minHeight=
this.minHeight)):I.style.height=this.height?this.height:this.minHeight;I.frameBorder=0;I._loadFunc=p.hitch(this,function(N){this.window=N;this.document=N.document;this.selection=new y.SelectionManager(N);u("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});L=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");L=11>u("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+L+"');document.close()":"javascript: '"+
L+"'";this.editingArea.appendChild(I);I.src=L;"LI"===w.nodeName&&(w.lastChild.style.marginTop="-1.2em");f.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var l=a.getComputedStyle(this.domNode);if(this["aria-label"])var w=this["aria-label"];else{var I=r('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||h.byId(this["aria-labelledby"],this.ownerDocument);I&&(w=I.textContent||I.innerHTML||"")}I="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(w?" aria-label\x3d'"+G.escape(w)+"'":"")+"\x3e\x3c/div\x3e";var M=[l.fontWeight,l.fontSize,l.fontFamily].join(" "),L=l.lineHeight;L=0<=L.indexOf("px")?parseFloat(L)/parseFloat(l.fontSize):0<=L.indexOf("em")?parseFloat(L):"normal";var P="",O=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(Q){Q=Q.replace(/^;/ig,"")+";";var N=Q.split(":")[0];if(N){N=p.trim(N);N=N.toLowerCase();var R,S="";for(R=0;R<N.length;R++){var T=N.charAt(R);switch(T){case "-":R++,T=N.charAt(R).toUpperCase();default:S+=
T}}a.set(O.domNode,S,"")}P+=Q+";"});this.iframe.setAttribute("title",w);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||b.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",w?"\x3ctitle\x3e"+G.escape(w)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",M,";\n",this.height||u("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",L,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",u("ie")||u("trident")||u("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",w?" aria-label\x3d'"+G.escape(w)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+P+"'\x3e",I,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var l=[];this.styleSheets&&(l=this.styleSheets.split(";"),this.styleSheets=
"");l=l.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var w="",I=0,M,L=K.get(this.ownerDocument);M=l[I++];)M=(new E(L.location,M)).toString(),this.editingAreaStyleSheets.push(M),w+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+M+'"/\x3e';return w},addStyleSheet:function(l){var w=l.toString(),I=K.get(this.ownerDocument);if("."===w.charAt(0)||"/"!==w.charAt(0)&&!l.host)w=(new E(I.location,w)).toString();-1<v.indexOf(this.editingAreaStyleSheets,w)||(this.editingAreaStyleSheets.push(w),
this.onLoadDeferred.then(p.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(w);else{var M=this.document.getElementsByTagName("head")[0],L=this.document.createElement("link");L.rel="stylesheet";L.type="text/css";L.href=w;M.appendChild(L)}})))},removeStyleSheet:function(l){var w=l.toString(),I=K.get(this.ownerDocument);if("."===w.charAt(0)||"/"!==w.charAt(0)&&!l.host)w=(new E(I.location,w)).toString();l=v.indexOf(this.editingAreaStyleSheets,w);-1!==l&&(delete this.editingAreaStyleSheets[l],
r('link[href\x3d"'+w+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(l){l=!!l;this._set("disabled",l);if(this.isLoaded){var w=u("ie")&&(this.isLoaded||!this.focusOnLoad);w&&(this.editNode.unselectable="on");this.editNode.contentEditable=!l;this.editNode.tabIndex=l?"-1":this.tabIndex;w&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(u("mozilla")&&!l&&this._mozSettingProps){l=this._mozSettingProps;for(var I in l)if(l.hasOwnProperty(I))try{this.document.execCommand(I,
!1,l[I])}catch(M){}}this._disabledOK=!0}},onLoad:function(l){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=q.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var w=this;this.beforeIframeNode=e.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=e.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){w.editNode.focus()};this.focusNode=
this.editNode;var I=this.events.concat(this.captureEvents),M=this.iframe?this.document:this.editNode;this.own.apply(this,v.map(I,function(L){var P=L.toLowerCase().replace(/^on/,"");return k(M,P,p.hitch(this,L))},this));this.own(k(M,"mouseup",p.hitch(this,"onClick")));u("ie")&&(this.own(k(this.document,"mousedown",p.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);u("webkit")&&(this._webkitListener=this.own(k(this.document,"mouseup",p.hitch(this,"onDisplayChanged")))[0],this.own(k(this.document,
"mousedown",p.hitch(this,function(L){L=L.target;!L||L!==this.document.body&&L!==this.document||this.defer("placeCursorAtEnd")}))));if(u("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(L){}this.isLoaded=!0;this.set("disabled",this.disabled);I=p.hitch(this,function(){this.setValue(l);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&m(p.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(I):I()},onKeyDown:function(l){if(l.keyCode===g.SHIFT||l.keyCode===g.ALT||l.keyCode===g.META||l.keyCode===g.CTRL)return!0;l.keyCode===g.TAB&&this.isTabIndent&&(l.stopPropagation(),l.preventDefault(),this.queryCommandEnabled(l.shiftKey?"outdent":"indent")&&this.execCommand(l.shiftKey?"outdent":"indent"));if(l.keyCode==g.TAB&&!this.isTabIndent&&!l.ctrlKey&&!l.altKey)return l.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>u("ie")&&l.keyCode===g.BACKSPACE&&"Control"===this.document.selection.type&&(l.stopPropagation(),l.preventDefault(),this.execCommand("delete"));u("ff")&&(l.keyCode===g.PAGE_UP||l.keyCode===g.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&l.preventDefault();var w=this._keyHandlers[l.keyCode],I=arguments;w&&!l.altKey&&v.some(w,function(M){if(!(M.shift^l.shiftKey||M.ctrl^(l.ctrlKey||l.metaKey)))return M.handler.apply(this,I)||l.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(l){b.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",l)},_setValueAttr:function(l){this.setValue(l)},_setDisableSpellCheckAttr:function(l){this.document?c.set(this.document.body,"spellcheck",!l):this.onLoadDeferred.then(p.hitch(this,function(){c.set(this.document.body,"spellcheck",!l)}));this._set("disableSpellCheck",l)},addKeyHandler:function(l,w,I,M){"string"==
typeof l&&(l=l.toUpperCase().charCodeAt(0));p.isArray(this._keyHandlers[l])||(this._keyHandlers[l]=[]);this._keyHandlers[l].push({shift:I||!1,ctrl:w||!1,handler:M})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(l){this.onDisplayChanged(l)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(l){(u("ie")||u("trident"))&&this.defer(function(){q.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var w=this.getValue(!0);if(w!==this.value)this.onChange(w);
this._set("value",w)},_onFocus:function(l){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!u("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>u("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(l,w){l=l.toLowerCase();"formatblock"===l?u("safari")&&void 0===w&&(l="heading"):"hilitecolor"!==l||u("mozilla")||(l="backcolor");return l},_implCommand:function(l){return"_"+this._normalizeCommand(l)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(l){var w=this._qcaCache[l];return void 0!==w?w:this._qcaCache[l]=this._queryCommandAvailable(l)},_queryCommandAvailable:function(l){switch(l.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return u("ie")||u("trident")||u("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!u("webkit");default:return!1}},execCommand:function(l,w){this.focused&&this.focus();l=this._normalizeCommand(l,w);if(void 0!==w){if("heading"===l)throw Error("unimplemented");"formatblock"===
l&&(u("ie")||u("trident"))&&(w="\x3c"+w+"\x3e")}var I="_"+l+"Impl";if(this[I])var M=this[I](w);else if((w=1<arguments.length?w:null)||"createlink"!==l)M=this.document.execCommand(l,!1,w);this.onDisplayChanged();return M},queryCommandEnabled:function(l){if(this.disabled||!this._disabledOK)return!1;l=this._normalizeCommand(l);var w=this._implCommand(l);return this[w]?this[w](l):this._browserQueryCommandEnabled(l)},queryCommandState:function(l){if(this.disabled||!this._disabledOK)return!1;l=this._normalizeCommand(l);
try{return this.document.queryCommandState(l)}catch(w){return!1}},queryCommandValue:function(l){if(this.disabled||!this._disabledOK)return!1;l=this._normalizeCommand(l);if(u("ie")&&"formatblock"===l)l=this._native2LocalFormatNames[this.document.queryCommandValue(l)];else if(u("mozilla")&&"hilitecolor"===l){try{var w=this.document.queryCommandValue("styleWithCSS")}catch(I){w=!1}this.document.execCommand("styleWithCSS",!1,!0);l=this.document.queryCommandValue(l);this.document.execCommand("styleWithCSS",
!1,w)}else l=this.document.queryCommandValue(l);return l},_sCall:function(l,w){return this.selection[l].apply(this.selection,w)},placeCursorAtStart:function(){this.focus();var l=!1;if(u("mozilla"))for(var w=this.editNode.firstChild;w;){if(3===w.nodeType){if(0<w.nodeValue.replace(/^\s+|\s+$/g,"").length){l=!0;this.selection.selectElement(w);break}}else if(1===w.nodeType){l=!0;var I=w.tagName?w.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(I)?this.selection.selectElement(w):
this.selection.selectElementChildren(w);break}w=w.nextSibling}else l=!0,this.selection.selectElementChildren(this.editNode);l&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var l=!1;if(u("mozilla"))for(var w=this.editNode.lastChild;w;){if(3===w.nodeType){if(0<w.nodeValue.replace(/^\s+|\s+$/g,"").length){l=!0;this.selection.selectElement(w);break}}else if(1===w.nodeType){l=!0;this.selection.selectElement(w.lastChild||w);break}w=w.previousSibling}else l=!0,this.selection.selectElementChildren(this.editNode);
l&&this.selection.collapse(!1)},getValue:function(l){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,l):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(l){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){l=this._preFilterContent(l);var w=this.isClosed?this.domNode:this.editNode;w.innerHTML=l;this._preDomFilterContent(w)}else this.textarea.value=l;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(p.hitch(this,function(){this.setValue(l)}))},replaceValue:function(l){this.isClosed?this.setValue(l):this.window&&this.window.getSelection&&!u("mozilla")?this.setValue(l):this.window&&this.window.getSelection?(l=this._preFilterContent(l),this.execCommand("selectall"),this.execCommand("inserthtml",l),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(l);this._set("value",this.getValue(!0))},_preFilterContent:function(l){var w=
l;v.forEach(this.contentPreFilters,function(I){I&&(w=I(w))});return w},_preDomFilterContent:function(l){l=l||this.editNode;v.forEach(this.contentDomPreFilters,function(w){w&&p.isFunction(w)&&w(l)},this)},_postFilterContent:function(l,w){if(p.isString(l))var I=l;else l=l||this.editNode,this.contentDomPostFilters.length&&(w&&(l=p.clone(l)),v.forEach(this.contentDomPostFilters,function(M){l=M(l)})),I=n.getChildrenHtml(l);p.trim(I.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(I="");v.forEach(this.contentPostFilters,
function(M){I=M(I)});return I},_saveContent:function(){var l=h.byId(F._scopeName+"._editor.RichText.value");l&&(l.value&&(l.value+=this._SEPARATOR),l.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(l,w){l=l.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");w||(l=l.replace(/'/gm,"\x26#39;"));return l},getNodeHtml:function(l){b.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return n.getNodeHtml(l)},getNodeChildrenHtml:function(l){b.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return n.getChildrenHtml(l)},close:function(l){if(!this.isClosed){arguments.length||(l=!0);l&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);u("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var w=this.textarea.style;w.position="";w.left=w.top="";u("ie")&&(w.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;e.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;f.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);J._globalSaveHandler&&delete J._globalSaveHandler[this.id]},_removeMozBogus:function(l){return l.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(l){l=l.replace(/\sclass="webkit-block-placeholder"/gi,"");l=l.replace(/\sclass="apple-style-span"/gi,
"");return l=l.replace(/<meta charset="utf-8" \/>/gi,"")},_normalizeFontStyle:function(l){return l.replace(/<(\/)?strong([ >])/gi,"\x3c$1b$2").replace(/<(\/)?em([ >])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(l){return l.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(l){if(!l)return!1;
var w=9>u("ie")?this.document.selection.createRange():this.document;try{return w.queryCommandEnabled(l)}catch(I){return!1}},_createlinkEnabledImpl:function(){var l=!0;return l=u("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var l=!0;return l=u("mozilla")||u("webkit")?this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var l=
!0;return l=u("mozilla")||u("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var l=!0;u("webkit")?((l=this.window.getSelection())&&(l=l.toString()),l=!!l):l=this._browserQueryCommandEnabled("cut");return l},_copyEnabledImpl:function(){var l=!0;u("webkit")?((l=this.window.getSelection())&&(l=l.toString()),l=!!l):l=this._browserQueryCommandEnabled("copy");return l},_pasteEnabledImpl:function(){var l=!0;return u("webkit")?!0:l=this._browserQueryCommandEnabled("paste")},
_inserthorizontalruleImpl:function(l){return u("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,l)},_unlinkImpl:function(l){return this.queryCommandEnabled("unlink")&&(u("mozilla")||u("webkit"))?(l=this.selection.getAncestorElement("a"),this.selection.selectElement(l),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",!1,l)},_hilitecolorImpl:function(l){if(!this._handleTextColorOrProperties("hilitecolor",l))if(u("mozilla")){this.document.execCommand("styleWithCSS",
!1,!0);console.log("Executing color command.");var w=this.document.execCommand("hilitecolor",!1,l);this.document.execCommand("styleWithCSS",!1,!1)}else w=this.document.execCommand("hilitecolor",!1,l);return w},_backcolorImpl:function(l){u("ie")&&(l=l?l:null);var w=this._handleTextColorOrProperties("backcolor",l);w||(w=this.document.execCommand("backcolor",!1,l));return w},_forecolorImpl:function(l){u("ie")&&(l=l?l:null);var w=!1;(w=this._handleTextColorOrProperties("forecolor",l))||(w=this.document.execCommand("forecolor",
!1,l));return w},_inserthtmlImpl:function(l){l=this._preFilterContent(l);var w=!0;if(9>u("ie")){var I=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var M=I.item(0);I.length;)I.remove(I.item(0));M.outerHTML=l}else I.pasteHTML(l);I.select()}else if(8>u("trident")){var L=x.getSelection(this.window);if(L&&L.rangeCount&&L.getRangeAt){I=L.getRangeAt(0);I.deleteContents();var P=e.create("div");P.innerHTML=l;for(M=this.document.createDocumentFragment();l=
P.firstChild;)var O=M.appendChild(l);I.insertNode(M);O&&(I=I.cloneRange(),I.setStartAfter(O),I.collapse(!1),L.removeAllRanges(),L.addRange(I))}}else u("mozilla")&&!l.length?this.selection.remove():w=this.document.execCommand("inserthtml",!1,l);return w},_boldImpl:function(l){var w=!1;if(u("ie")||u("trident"))this._adaptIESelection(),w=this._adaptIEFormatAreaAndExec("bold");w||(w=this.document.execCommand("bold",!1,l));return w},_italicImpl:function(l){var w=!1;if(u("ie")||u("trident"))this._adaptIESelection(),
w=this._adaptIEFormatAreaAndExec("italic");w||(w=this.document.execCommand("italic",!1,l));return w},_underlineImpl:function(l){var w=!1;if(u("ie")||u("trident"))this._adaptIESelection(),w=this._adaptIEFormatAreaAndExec("underline");w||(w=this.document.execCommand("underline",!1,l));return w},_strikethroughImpl:function(l){var w=!1;if(u("ie")||u("trident"))this._adaptIESelection(),w=this._adaptIEFormatAreaAndExec("strikethrough");w||(w=this.document.execCommand("strikethrough",!1,l));return w},_superscriptImpl:function(l){var w=
!1;if(u("ie")||u("trident"))this._adaptIESelection(),w=this._adaptIEFormatAreaAndExec("superscript");w||(w=this.document.execCommand("superscript",!1,l));return w},_subscriptImpl:function(l){var w=!1;if(u("ie")||u("trident"))this._adaptIESelection(),w=this._adaptIEFormatAreaAndExec("subscript");w||(w=this.document.execCommand("subscript",!1,l));return w},_fontnameImpl:function(l){if(u("ie")||u("trident"))var w=this._handleTextColorOrProperties("fontname",l);w||(w=this.document.execCommand("fontname",
!1,l));return w},_fontsizeImpl:function(l){if(u("ie")||u("trident"))var w=this._handleTextColorOrProperties("fontsize",l);w||(w=this.document.execCommand("fontsize",!1,l));return w},_insertorderedlistImpl:function(l){var w=!1;if(u("ie")||u("trident")||u("edge"))w=this._adaptIEList("insertorderedlist",l);w||(w=this.document.execCommand("insertorderedlist",!1,l));return w},_insertunorderedlistImpl:function(l){var w=!1;if(u("ie")||u("trident")||u("edge"))w=this._adaptIEList("insertunorderedlist",l);
w||(w=this.document.execCommand("insertunorderedlist",!1,l));return w},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(l){var w=0;if(l&&l.childNodes){var I;for(I=0;I<l.childNodes.length;I++){var M=d.position(l.childNodes[I]);w+=M.h}}return w},_isNodeEmpty:function(l,w){return 1===l.nodeType?0<l.childNodes.length?this._isNodeEmpty(l.childNodes[0],w):!0:3===l.nodeType?
""===l.nodeValue.substring(w):!1},_removeStartingRangeFromRange:function(l,w){if(l.nextSibling)w.setStart(l.nextSibling,0);else{for(l=l.parentNode;l&&null==l.nextSibling;)l=l.parentNode;l&&w.setStart(l.nextSibling,0)}return w},_adaptIESelection:function(){var l=x.getSelection(this.window);if(l&&l.rangeCount&&!l.isCollapsed){for(var w=l.getRangeAt(0),I=w.startContainer,M=w.startOffset;3===I.nodeType&&M>=I.length&&I.nextSibling;)M-=I.length,I=I.nextSibling;for(var L=null;this._isNodeEmpty(I,M)&&I!==
L;)L=I,w=this._removeStartingRangeFromRange(I,w),I=w.startContainer,M=0;l.removeAllRanges();l.addRange(w)}},_adaptIEFormatAreaAndExec:function(l){var w=x.getSelection(this.window),I=this.document,M;if(l&&w&&w.isCollapsed){if(this.queryCommandValue(l)){l=this._tagNamesForCommand(l);var L=w.getRangeAt(0);var P=L.startContainer;if(3===P.nodeType){var O=L.endOffset;P.length<O&&(O=this._adjustNodeAndOffset(Q,O),P=O.node,O=O.offset)}for(;P&&P!==this.editNode;){var Q=P.tagName?P.tagName.toLowerCase():"";
if(-1<v.indexOf(l,Q)){var N=P;break}P=P.parentNode}if(N&&(Q=L.startContainer,l=I.createElement(N.tagName),e.place(l,N,"after"),Q&&3===Q.nodeType)){O=L.endOffset;Q.length<O&&(O=this._adjustNodeAndOffset(Q,O),Q=O.node,O=O.offset);P=Q.nodeValue;L=I.createTextNode(P.substring(0,O));var R=P.substring(O,P.length);R&&(M=I.createTextNode(R));e.place(L,Q,"before");if(M){var S=I.createElement("span");S.className="ieFormatBreakerSpan";e.place(S,Q,"after");e.place(M,S,"after");M=S}e.destroy(Q);O=L.parentNode;
for(Q=[];O!==N;){P=O.tagName;L={tagName:P};Q.push(L);P=I.createElement(P);O.style&&P.style&&O.style.cssText&&(P.style.cssText=O.style.cssText,L.cssText=O.style.cssText);"FONT"===O.tagName&&(O.color&&(P.color=O.color,L.color=O.color),O.face&&(P.face=O.face,L.face=O.face),O.size&&(P.size=O.size,L.size=O.size));O.className&&(P.className=O.className,L.className=O.className);if(M)for(;M;)L=M.nextSibling,P.appendChild(M),M=L;P.tagName==O.tagName?(S=I.createElement("span"),S.className="ieFormatBreakerSpan",
e.place(S,O,"after"),e.place(P,S,"after")):e.place(P,O,"after");L=O;M=P;O=O.parentNode}if(M){if(1===M.nodeType||3===M.nodeType&&M.nodeValue)l.innerHTML="";for(;M;)L=M.nextSibling,l.appendChild(M),M=L}if(Q.length){L=Q.pop();M=I.createElement(L.tagName);L.cssText&&M.style&&(M.style.cssText=L.cssText);L.className&&(M.className=L.className);"FONT"===L.tagName&&(L.color&&(M.color=L.color),L.face&&(M.face=L.face),L.size&&(M.size=L.size));for(e.place(M,l,"before");Q.length;)L=Q.pop(),N=I.createElement(L.tagName),
L.cssText&&N.style&&(N.style.cssText=L.cssText),L.className&&(N.className=L.className),"FONT"===L.tagName&&(L.color&&(N.color=L.color),L.face&&(N.face=L.face),L.size&&(N.size=L.size)),M.appendChild(N),M=N;N=I.createTextNode(".");S.appendChild(N);M.appendChild(N)}else S=I.createElement("span"),S.className="ieFormatBreakerSpan",N=I.createTextNode("."),S.appendChild(N),e.place(S,l,"before");M=x.create(this.window);M.setStart(N,0);M.setEnd(N,N.length);w.removeAllRanges();w.addRange(M);this.selection.collapse(!1);
N.parentNode.innerHTML="";l.firstChild||e.destroy(l);return!0}return!1}L=w.getRangeAt(0);if((Q=L.startContainer)&&3===Q.nodeType)return O=L.startOffset,Q.length<O&&(O=this._adjustNodeAndOffset(Q,O),Q=O.node,O=O.offset),P=Q.nodeValue,L=I.createTextNode(P.substring(0,O)),R=P.substring(O),""!==R&&(M=I.createTextNode(P.substring(O))),S=I.createElement("span"),N=I.createTextNode("."),S.appendChild(N),L.length?e.place(L,Q,"after"):L=Q,e.place(S,L,"after"),M&&e.place(M,S,"after"),e.destroy(Q),M=x.create(this.window),
M.setStart(N,0),M.setEnd(N,N.length),w.removeAllRanges(),w.addRange(M),I.execCommand(l),e.place(S.firstChild,S,"before"),e.destroy(S),M.setStart(N,0),M.setEnd(N,N.length),w.removeAllRanges(),w.addRange(M),this.selection.collapse(!1),N.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(l){var w=x.getSelection(this.window);if(w.isCollapsed&&w.rangeCount&&!this.queryCommandValue(l)){var I=w.getRangeAt(0),M=I.startContainer;if(M&&3==M.nodeType&&!I.startOffset)return I="ul","insertorderedlist"===
l&&(I="ol"),l=this.document.createElement(I),I=e.create("li",null,l),e.place(l,M,"before"),I.appendChild(M),e.create("br",null,l,"after"),l=x.create(this.window),l.setStart(M,0),l.setEnd(M,M.length),w.removeAllRanges(),w.addRange(l),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(l,w){var I=x.getSelection(this.window),M=this.document,L,P;w=w||null;if(l&&I&&I.isCollapsed&&I.rangeCount){var O=I.getRangeAt(0);if((L=O.startContainer)&&3===L.nodeType){var Q=O.startOffset;
L.length<Q&&(O=this._adjustNodeAndOffset(L,Q),L=O.node,Q=O.offset);var N=L.nodeValue;O=M.createTextNode(N.substring(0,Q));""!==N.substring(Q)&&(P=M.createTextNode(N.substring(Q)));N=M.createElement("span");Q=M.createTextNode(".");N.appendChild(Q);M=M.createElement("span");N.appendChild(M);O.length?e.place(O,L,"after"):O=L;e.place(N,O,"after");P&&e.place(P,N,"after");e.destroy(L);L=x.create(this.window);L.setStart(Q,0);L.setEnd(Q,Q.length);I.removeAllRanges();I.addRange(L);if(u("webkit")){I="color";
if("hilitecolor"===l||"backcolor"===l)I="backgroundColor";a.set(N,I,w);this.selection.remove();e.destroy(M);N.innerHTML="\x26#160;";this.selection.selectElement(N);this.focus()}else this.execCommand(l,w),e.place(N.firstChild,N,"before"),e.destroy(N),L.setStart(Q,0),L.setEnd(Q,Q.length),I.removeAllRanges(),I.addRange(L),this.selection.collapse(!1),Q.parentNode.removeChild(Q);return!0}}return!1},_adjustNodeAndOffset:function(l,w){for(;l.length<w&&l.nextSibling&&3===l.nextSibling.nodeType;)w-=l.length,
l=l.nextSibling;return{node:l,offset:w}},_tagNamesForCommand:function(l){return"bold"===l?["b","strong"]:"italic"===l?["i","em"]:"strikethrough"===l?["s","strike"]:"superscript"===l?["sup"]:"subscript"===l?["sub"]:"underline"===l?["u"]:[]},_stripBreakerNodes:function(l){if(this.isLoaded)return r(".ieFormatBreakerSpan",l).forEach(function(w){for(;w.firstChild;)e.place(w.firstChild,w,"before");e.destroy(w)}),l},_stripTrailingEmptyNodes:function(l){function w(I){return/^(p|div|br)$/i.test(I.nodeName)&&
0==I.children.length&&/^[\s\xA0]*$/.test(I.textContent||I.innerText||"")||3===I.nodeType&&/^[\s\xA0]*$/.test(I.nodeValue)}for(;l.lastChild&&w(l.lastChild);)e.destroy(l.lastChild);return l},_setTextDirAttr:function(l){this._set("textDir",l);this.onLoadDeferred.then(p.hitch(this,function(){this.editNode.dir=l}))}});return J})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(v,A,B){var t={getIndex:function(f,e){for(var d=[],a=[],b=f,g,p;f!=
e;){var k=0;for(g=f.parentNode;p=g.childNodes[k++];)if(p===f){--k;break}d.unshift(k);a.unshift(k-g.childNodes.length);f=g}if(0<d.length&&3==b.nodeType){for(p=b.previousSibling;p&&3==p.nodeType;)d[d.length-1]--,p=p.previousSibling;for(p=b.nextSibling;p&&3==p.nodeType;)a[a.length-1]++,p=p.nextSibling}return{o:d,r:a}},getNode:function(f,e){if(!B.isArray(f)||0==f.length)return e;var d=e;v.every(f,function(a){if(0<=a&&a<d.childNodes.length)d=d.childNodes[a];else return d=null,!1;return!0});return d},getCommonAncestor:function(f,
e,d){d=d||f.ownerDocument.body;var a=function(p){for(var k=[];p;)if(k.unshift(p),p!==d)p=p.parentNode;else break;return k};f=a(f);e=a(e);a=Math.min(f.length,e.length);for(var b=f[0],g=1;g<a;g++)if(f[g]===e[g])b=f[g];else break;return b},getAncestor:function(f,e,d){for(d=d||f.ownerDocument.body;f&&f!==d;){var a=f.nodeName.toUpperCase();if(e.test(a))return f;f=f.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(f,e,d){d=d||f.ownerDocument.body;
e=e||t.BlockTagNames;for(var a=null,b;f&&f!==d;){var g=f.nodeName.toUpperCase();!a&&e.test(g)&&(a=f);!b&&/^(?:BODY|TD|TH|CAPTION)$/.test(g)&&(b=f);f=f.parentNode}return{blockNode:a,blockContainer:b||f.ownerDocument.body}},atBeginningOfContainer:function(f,e,d){var a=!1,b=0==d;b||3!=e.nodeType||/^[\s\xA0]+$/.test(e.nodeValue.substr(0,d))&&(b=!0);if(b)for(a=!0;e&&e!==f;){if(e.previousSibling){a=!1;break}e=e.parentNode}return a},atEndOfContainer:function(f,e,d){var a=!1,b=d==(e.length||e.childNodes.length);
b||3!=e.nodeType||/^[\s\xA0]+$/.test(e.nodeValue.substr(d))&&(b=!0);if(b)for(a=!0;e&&e!==f;){if(e.nextSibling){a=!1;break}e=e.parentNode}return a},adjacentNoneTextNode:function(f,e){var d=f;f=0-f.length||0;for(e=e?"nextSibling":"previousSibling";d&&3==d.nodeType;)f+=d.length,d=d[e];return[d,f]},create:function(f){f=f||window;return f.getSelection?f.document.createRange():new c},getSelection:function(f,e){if(f.getSelection)return f.getSelection();f=new h.selection(f);e||f._getCurrentSelection();return f}};
if(!window.getSelection)var h=t.ie={cachedSelection:{},selection:function(f){this._ranges=[];this.addRange=function(e,d){this._ranges.push(e);d||e._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(e){return this._ranges[e]};this._getCurrentSelection=function(){this.removeAllRanges();var e=f.document.selection.createRange();e="CONTROL"==f.document.selection.type.toUpperCase()?new c(h.decomposeControlRange(e)):
new c(h.decomposeTextRange(e));this.addRange(e,!0),this.isCollapsed=e.collapsed}},decomposeControlRange:function(f){var e=f.item(0),d=f.item(f.length-1);f=e.parentNode;var a=d.parentNode;e=t.getIndex(e,f).o[0];d=t.getIndex(d,a).o[0]+1;return[f,e,a,d]},getEndPoint:function(f,e){var d=f.duplicate();d.collapse(!e);var a="EndTo"+(e?"End":"Start"),b=d.parentElement(),g;if(0<b.childNodes.length)v.every(b.childNodes,function(r,m){if(3!=r.nodeType)if(d.moveToElementText(r),0<d.compareEndPoints(a,f))if(g&&
3==g.nodeType){p=g;var u=!0}else return p=b,k=m,!1;else{if(m==b.childNodes.length-1)return p=b,k=b.childNodes.length,!1}else m==b.childNodes.length-1&&(p=r,u=!0);if(u&&p)return p=(r=t.adjacentNoneTextNode(p)[0])?r.nextSibling:b.firstChild,m=t.adjacentNoneTextNode(p),r=m[0],m=m[1],r?(d.moveToElementText(r),d.collapse(!1)):d.moveToElementText(b),d.setEndPoint(a,f),k=d.text.length-m,!1;g=r;return!0});else{var p=b;var k=0}e||1!=p.nodeType||k!=p.childNodes.length||(e=p.nextSibling)&&3==e.nodeType&&(p=
e,k=0);return[p,k]},setEndPoint:function(f,e,d){f=f.duplicate();var a;if(3!=e.nodeType)if(0<d){if(a=e.childNodes[d-1])if(3==a.nodeType)e=a,d=a.length;else if(a.nextSibling&&3==a.nextSibling.nodeType)e=a.nextSibling,d=0;else{f.moveToElementText(a.nextSibling?a:e);var b=a.parentNode;a=b.insertBefore(a.ownerDocument.createTextNode(" "),a.nextSibling);f.collapse(!1);b.removeChild(a)}}else f.moveToElementText(e),f.collapse(!0);3==e.nodeType&&(a=t.adjacentNoneTextNode(e),b=a[0],a=a[1],b?(f.moveToElementText(b),
f.collapse(!1),"inherit"!=b.contentEditable&&a++):(f.moveToElementText(e.parentNode),f.collapse(!0),f.move("character",1),f.move("character",-1)),d+=a,0<d&&f.move("character",d)!=d&&console.error("Error when moving!"));return f},decomposeTextRange:function(f){var e=h.getEndPoint(f),d=e[0],a=e[1],b=e[0];e=e[1];f.htmlText.length&&(f.htmlText==f.text?e=a+f.text.length:(e=h.getEndPoint(f,!0),b=e[0],e=e[1]));return[d,a,b,e]},setRange:function(f,e,d,a,b,g){e=h.setEndPoint(f,e,d);f.setEndPoint("StartToStart",
e);if(!g)var p=h.setEndPoint(f,a,b);f.setEndPoint("EndToEnd",p||e);return f}},c=t.W3CRange=A(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?t.getCommonAncestor(this.startContainer,
this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(f,e){e=parseInt(e);if(this.startContainer!==f||this.startOffset!=e)delete this._cachedBookmark,this.startContainer=f,this.startOffset=e,this.endContainer?this._updateInternal():this.setEnd(f,e)},setEnd:function(f,e){e=parseInt(e);if(this.endContainer!==f||this.endOffset!=e)delete this._cachedBookmark,this.endContainer=f,this.endOffset=e,this.startContainer?
this._updateInternal():this.setStart(f,e)},setStartAfter:function(f,e){this._setPoint("setStart",f,e,1)},setStartBefore:function(f,e){this._setPoint("setStart",f,e,0)},setEndAfter:function(f,e){this._setPoint("setEnd",f,e,1)},setEndBefore:function(f,e){this._setPoint("setEnd",f,e,0)},_setPoint:function(f,e,d,a){d=t.getIndex(e,e.parentNode).o;this[f](e.parentNode,d.pop()+a)},_getIERange:function(){var f=(this._body||this.endContainer.ownerDocument.body).createTextRange();h.setRange(f,this.startContainer,
this.startOffset,this.endContainer,this.endOffset,this.collapsed);return f},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var f=this.startContainer,e=this._getIERange();3!==f.nodeType||this.startOffset||this.setStartBefore(f);e.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var f=new c([this.startContainer,this.startOffset,
this.endContainer,this.endOffset]);f._body=this._body;return f},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});B.setObject("dijit.range",t);return t})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(v,A,B){var t={};A.setObject("dijit._editor.html",t);var h=t.escapeXml=function(c,f){c=c.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,
"\x26gt;").replace(/"/gm,"\x26quot;");f||(c=c.replace(/'/gm,"\x26#39;"));return c};t.getNodeHtml=function(c){var f=[];t.getNodeHtmlHelper(c,f);return f.join("")};t.getNodeHtmlHelper=function(c,f){switch(c.nodeType){case 1:var e=c.nodeName.toLowerCase();if(!e||"/"==e.charAt(0))return"";f.push("\x3c",e);var d=[],a={},b;if(B("dom-attributes-explicit")||B("dom-attributes-specified-flag"))for(var g=0;b=c.attributes[g++];){var p=b.name;"_dj"===p.substr(0,3)||B("dom-attributes-specified-flag")&&!b.specified||
p in a||(b=b.value,("src"==p||"href"==p)&&c.getAttribute("_djrealurl")&&(b=c.getAttribute("_djrealurl")),8===B("ie")&&"style"===p&&(b=b.replace("HEIGHT:","height:").replace("WIDTH:","width:")),d.push([p,b]),a[p]=b)}else{var k=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML;a=k.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi);k=k.substr(0,k.indexOf("\x3e"));v.forEach(a,function(r){if(r){var m=r.indexOf("\x3d");if(0<m&&(r=r.substring(0,m),"_dj"!=r.substr(0,3)))if("src"!=r&&"href"!=r||!c.getAttribute("_djrealurl")){switch(r){case "style":var u=
c.style.cssText.toLowerCase();break;case "class":u=c.className;break;case "width":if("img"===e){(m=/width=(\S+)/i.exec(k))&&(u=m[1]);break}case "height":if("img"===e){(m=/height=(\S+)/i.exec(k))&&(u=m[1]);break}default:u=c.getAttribute(r)}null!=u&&d.push([r,u.toString()])}else d.push([r,c.getAttribute("_djrealurl")])}},this)}d.sort(function(r,m){return r[0]<m[0]?-1:r[0]==m[0]?0:1});for(a=0;b=d[a++];)f.push(" ",b[0],'\x3d"',"string"===typeof b[1]?h(b[1],!0):b[1],'"');switch(e){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":f.push(" /\x3e");
break;case "script":f.push("\x3e",c.innerHTML,"\x3c/",e,"\x3e");break;default:f.push("\x3e"),c.hasChildNodes()&&t.getChildrenHtmlHelper(c,f),f.push("\x3c/",e,"\x3e")}break;case 4:case 3:f.push(h(c.nodeValue,!0));break;case 8:f.push("\x3c!--",h(c.nodeValue,!0),"--\x3e");break;default:f.push("\x3c!-- Element not recognized - Type: ",c.nodeType," Name: ",c.nodeName,"--\x3e")}};t.getChildrenHtml=function(c){var f=[];t.getChildrenHtmlHelper(c,f);return f.join("")};t.getChildrenHtmlHelper=function(c,f){if(c)for(var e=
c.childNodes||c,d=!B("ie")||e!==c,a,b=0;a=e[b++];)d&&a.parentNode!=c||t.getNodeHtmlHelper(a,f)};return t})},"esri/dijit/geoenrichment/SelectableTree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented ./when dojo/store/util/QueryResults dojo/store/util/SimpleQueryEngine dstore/QueryResults".split(" "),function(v,A,B,t,h,c,f,e){var d=function(a,b){this.storage=a;this.data=b};d.prototype={storage:null,data:null,filter:function(a){return this.storage._filter(this.data,
a)},sort:function(a,b){return this.storage._sort(this.data,a,b)},fetch:function(){return this.storage._fetchRange(this.data)},fetchRange:function(a){return this.storage._fetchRange(this.data,a)},mayHaveChildren:function(a){return this.storage.mayHaveChildren(a)},getChildren:function(a){return this.storage.getChildren(a,{returnCollection:!0})}};return v(t,{idProperty:"id",bindingProperty:null,autoIdentify:!0,queryEngine:f,isDstoreTree:!1,root:null,data:null,_hash:null,_autoId:null,storage:null,constructor:function(a,
b){A.mixin(this,b);this.storage=this;this.root={children:a||[]};A.mixin(this._provideBinding(this.root),{deepness:-1,selectCount:0,leafCount:0});this._hash={};this.idProperty&&this.autoIdentify&&(this._autoId=1);this._initializeNode(this.root,0);this.data=this.root.children},_provideBinding:function(a){var b=this._getBinding(a);b||(a[this.bindingProperty]=b={});return b},_getBinding:function(a){return this.bindingProperty?a[this.bindingProperty]:a},_initializeNode:function(a,b){var g=this._provideBinding(a);
g.selected=!!g.selected;a.children?(g.selectCount=0,g.leafCount=0,B.forEach(a.children,function(p){this._registerNode(p);var k=this._provideBinding(p);k.parent=a;k.deepness=b;this._initializeNode(p,b+1);g.selectCount+=k.selectCount;g.leafCount+=k.leafCount},this),g.selectCount)?g.selectCount===g.leafCount&&(g.selected=!0):g.selected=!1:("number"!==typeof g.leafCount&&(g.leafCount=1),g.selectCount=g.selected?g.leafCount:0)},isOwned:function(a,b){return b||a!==this.root?this.get(this.getIdentity(a))===
a:!0},_registerNode:function(a){this._autoId&&void 0===a[this.idProperty]&&(a[this.idProperty]=this._autoId++);this.idProperty&&(this._hash[a[this.idProperty]]=a)},_unregisterNode:function(a){this.isOwned(a,!0)&&delete this._hash[a[this.idProperty]]},clear:function(){this.root.children.length&&(B.forEach(this.root.children,function(a){this._unbindNode(a)},this),this.data=this.root.children=[])},destroy:function(){this.clear()},_unbindNode:function(a){a.children&&B.forEach(a.children,function(g){delete this._getBinding(g).parent;
this._unbindNode(g)},this);this._unregisterNode(a);var b=this._getBinding(a);b.parent&&(this._incrementCounts(b.parent,-b.selectCount,-b.leafCount),delete b.parent);b!==a&&delete a[this.bindingProperty]},removeNodes:function(a,b){B.forEach(a&&a.slice(),function(g){if(this.isOwned(g,!0)){var p=this._getBinding(g).parent,k=B.indexOf(p.children,g);0<=k&&p.children.splice(k,1);this._unbindNode(g)}},this);!b&&this.emit("updated")},addNodes:function(a,b,g){if(!b)b=this.root;else if(!this.isOwned(b)||!b.children)return!1;
var p=this._getBinding(b).deepness+1,k=0,r=0;B.forEach(a,function(m){if(!this.isOwned(m)){b.children.push(m);this._registerNode(m);var u=this._provideBinding(m);u.parent=b;u.deepness=p;this._initializeNode(m,p+1);k+=u.selectCount;r+=u.leafCount}},this);this._incrementCounts(b,k,r);!g&&this.emit("updated");return!0},select:function(a,b){return this.changeSelect(a,!0,b)},deselect:function(a){this.changeSelect(a,!1)},changeSelect:function(a,b,g){g=g||this.root.leafCount;var p=a&&this._getBinding(a);
if(p){b=!!b;var k=(b?p.leafCount:0)-p.selectCount,r=0>k||this.root.selectCount+k<=g;if(!a.children)return r&&(p.selected=b,k&&this._incrementCounts(a,k)),r;r&&(p.selected=b);B.forEach(a.children,function(m){this.changeSelect(m,b,g)},this);return r}},_incrementCounts:function(a,b,g){a=this._getBinding(a);a.selectCount+=b;g&&(a.leafCount+=g);a.selectCount?a.selectCount==a.leafCount&&(a.selected=!0):a.selected=!1;a.parent&&this._incrementCounts(a.parent,b,g)},getSelectionState:function(a){if(!this.isOwned(a))return!1;
a=this._getBinding(a);return a.selectCount&&a.selectCount!=a.leafCount?"mixed":a.selected=!!a.selectCount},getSelectedNodes:function(a){return this.getDescendingNodes(this.root,!0,a)},getDescendingNodes:function(a,b,g){if(!this.isOwned(a))return[];var p=[];this._collectNodes(a.children,p,b,g);return p},_collectNodes:function(a,b,g,p){B.forEach(a,function(k){var r=this._getBinding(k),m=null===g||void 0===g?r.leafCount:g?r.selectCount:r.leafCount-r.selectCount;m&&(!k.children||!p&&m==r.leafCount?b.push(k):
this._collectNodes(k.children,b,g,p))},this)},inspectChildren:function(a,b,g,p){p&&(b=A.hitch(p,b));a=a||this.root;(a=a.children)&&g&&(a=a.slice(),a.sort(g));return B.every(a,function(k){var r=b(k);return null===r?!1:!1!==r&&k.children?this.inspectChildren(k,b,g):!0},this)},updateExpandedNodes:function(a,b){for(var g in this._hash)this.updateExpand(this._hash[g],!!a[g]);this._updateOddEven(null,b)},updateExpand:function(a,b,g,p){if(a){var k=!1;a.children&&(a=this._getBinding(a),a.expanded!==b&&(k=
!0,a.expanded=b));b={};k&&g&&this._updateOddEven(b,p);return b}},_updateOddEven:function(a,b){var g=1;this.inspectChildren(null,function(p){!1!==p.visible&&(g=1-g);var k=this._getBinding(p);a&&k.isOdd!==g&&(a[this.getIdentity(p)]=g);k.isOdd=g;return!(!p.children||!k.expanded)},b,this)},isOdd:function(a){return(a=this._getBinding(a))&&a.isOdd},get:function(a){return this._hash[a]},getIdentity:function(a){return this.idProperty?a[this.idProperty]:null},query:function(a,b){return c(this._query(this.data,
a,b))},_query:function(a,b,g){return this.queryEngine(b,g)(a)},filter:function(a){return this._filter(this.data,a)},_filter:function(a,b){a=this._query(a,b);return new d(this.storage,a)},sort:function(a,b){return this._sort(this.data,a,b)},_sort:function(a,b,g){"function"===typeof b?(a=a.slice(),a.sort(b)):(b=Array.isArray(b)?b.map(function(p){return{attribute:p.property,descending:p.descending}}):[{attribute:b,descending:g}],a=this._query(a,{},{sort:b}));return new d(this.storage,a)},mayHaveChildren:function(a){return!!a.children},
getChildren:function(a,b){var g=this.isOwned(a,!0)?a.children:null;a=this.isDstoreTree||b&&b.returnCollection;b=this.queryEngine({},a?null:b)(g||[]);return a?new d(this.storage,b):c(b)},fetch:function(){return this._fetchRange(this.data)},fetchRange:function(a){return this._fetchRange(this.data,a)},_fetchRange:function(a,b){return e(h(b?a.slice(b.start,b.end):a.slice()),{totalLength:h(a.length)})}})})},"esri/dijit/geoenrichment/when":function(){define(["dojo/when"],function(v){return v})},"dstore/QueryResults":function(){define(["dojo/_base/lang",
"dojo/when"],function(v,A){function B(t,h){return A(this,function(c){for(var f=0,e=c.length;f<e;f++)t.call(h,c[f],f,c)})}return function(t,h){var c=h&&"totalLength"in h;if(t.then){t=v.delegate(t);var f=t.then(function(e){var d=c?h.totalLength:e.totalLength||e.length;e.totalLength=d;return!c&&d});t.totalLength=c?h.totalLength:f;t.response=h&&h.response}else t.totalLength=c?h.totalLength:t.length;t.forEach=B;return t}})},"widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/SelectableTreeGrid":function(){define("dojo/_base/declare dojo/aspect dojo/Evented dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on dojo/query dijit/Tooltip dijit/_WidgetBase ../../dijit/_TemplatedMixin dgrid/OnDemandGrid dgrid/tree esri/dijit/geoenrichment/utils/KeyboardUtil esri/dijit/geoenrichment/TriStateItem ../../dijit/utils/DgridUtil ../../dijit/utils/DomUtil ../../dijit/utils/MouseUtil ../../dijit/tooltips/TooltipUtil dojo/text!./templates/SelectableTreeGrid.html xstyle/css!./css/SelectableTreeGrid.css".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k,r,m,u,G,H,C){var E=v(null,{_selectedRowInfos:null,_lastSelectedRowInfo:null,_outsideHandler:null,_isSelectionFrozen:!1,keepSelectionOnOutsideClick:!1,_previouslySelectedRowsByNode:null,constructor:function(){this._previouslySelectedRowsByNode=new WeakMap},buildRendering:function D(){this._selectedRowInfos={};this.inherited(D,arguments)},postCreate:function z(){this.inherited(z,arguments);t.add(this.domNode,"esriMapsAnalystXNonSelectable")},_reselectSingleNode:function(z){this.selectSingleRow(this._previouslySelectedRowsByNode.get(z),
z)},selectSingleRow:function(z,y){this.unselectAllRows();this._selectRow(z,y)},_selectRow:function(z,y){t.add(z,this.selectedRowClass);t.add(z,"row-level-"+this._getNodeLevel(y));var x=this.tree.getIdentity(y),n={row:z,node:y,nodeId:x,index:y.parent&&y.parent.children.indexOf(y)};this._lastSelectedRowInfo=this._selectedRowInfos[x]=n;this._previouslySelectedRowsByNode.set(y,z);var q=this;this._outsideHandler=this._outsideHandler||f(document.body,"click",function(){G.isMouseOver(q.domNode)||q._isSelectionFrozen||
q.keepSelectionOnOutsideClick||q.unselectAllRows()})},_unselectRow:function(z,y){delete this._selectedRowInfos[this.tree.getIdentity(y)];t.remove(z,this.selectedRowClass)},unselectAllRows:function(){for(var z in this._selectedRowInfos)t.remove(this._selectedRowInfos[z].row,this.selectedRowClass);this._selectedRowInfos={};this._lastSelectedRowInfo=null;this._outsideHandler&&this._outsideHandler.remove();this._outsideHandler=null},getSelectedRowNodes:function(){return this._getSelectedNodesRows().nodes},
selectRowNodes:function(z){var y=this;z&&z.forEach(function(x){var n=y.grid.row(x);n&&n.element&&y._selectRow(n.element,x)})},freezeRowSelection:function(){this._isSelectionFrozen=!0},unfreezeRowSelection:function(){this._isSelectionFrozen=!1},_getSelectedNodesRows:function(){var z=[],y=[],x=[],n;for(n in this._selectedRowInfos)x.push(this._selectedRowInfos[n]);x.sort(function(q,F){return q.index-F.index});x.forEach(function(q){z.push(q.node);y.push(q.row)});return{nodes:z,rows:y}},_emitSelectedRowsEvent:function(){var z=
this._getSelectedNodesRows();if(z.nodes.length)this.onRowsSelected(z.nodes,z.rows)}});return v([a,b,B,E],{templateString:C,tree:null,grid:null,gridClass:"",highlightSelected:!0,firstColumns:null,additionalColumns:null,showRootCheckbox:!0,showCheckboxColumn:!0,showHeader:!0,labelColumnField:"label",gridParams:null,keepContentUnderScroll:void 0,hideInvisibleExpandoIcons:!1,expandOnNodeClick:!1,checkLimit:0,checkLimitMessage:null,checkLimitMessageTimeout:5E3,handleMultipleCheck:!1,enableRowSelection:!1,
enableMultipleRowSelection:!1,allowSelectionFromManyParents:!1,selectedRowFilter:null,selectedRowClass:"row-selected",enableHeaderLabelToggleClick:!0,defaultExpand:null,fitParentSize:!1,renderAllRows:!1,rowPostProcessor:null,_rootCheckbox:null,_checkboxes:null,_lastCheckedNode:null,updateSelectionCountDiv:function(z,y){},getLabel:function(z,y){return z.label},postCreate:function y(){this.inherited(y,arguments);this._createGrid()},resize:function(){this.grid.resize();this._updateCheckboxState(this._rootCheckbox);
for(var y in this._checkboxes)this._updateCheckboxState(this._checkboxes[y]);this._emitSelectionChanged()},setWidth:function(y){this.grid&&this.grid.domNode&&c.set(this.grid.domNode,"width",y+"px")},setHeight:function(y){this.grid&&this.grid.domNode&&c.set(this.grid.domNode,"height",y+"px")},row:function(y){return this.grid.row(y)},cell:function(y){return this.grid.cell(y)},_labelColumn:null,_createGrid:function(){var y=this;this._checkboxes={};var x={label:this.getLabel(this.tree.root,!0),sortable:!1,
field:this.labelColumnField,renderCell:this._renderLabel.bind(this),renderHeaderCell:this._renderLabelHeader.bind(this,this.tree.root)},n;if(this.additionalColumns&&this.additionalColumns.length&&(n=this.additionalColumns.filter(function(F){return F.field===y.labelColumnField})[0])){for(var q in x)void 0===n[q]&&(n[q]=x[q]);x=n}x.indentWidth=x.indentWidth||16;this._labelColumn=x=this._prepareTreeColumn(x);q=[];this.firstColumns&&(q=q.concat(this.firstColumns));this.showCheckboxColumn&&q.push({label:"",
field:"checkbox",sortable:!1,renderCell:this._renderCheckboxForColumn.bind(this),renderHeaderCell:this._renderCheckboxForColumn.bind(this,this.tree.root)});n||q.push(x);this.additionalColumns&&(q=q.concat(this.additionalColumns));x=["esriMapsAnalystXSelectableTreeGrid"];this.gridClass&&x.push(this.gridClass);this.fitParentSize&&x.push("fitParentSize");x=Object.assign({class:x.join(" "),keepScrollPosition:!0,store:this.tree,columns:q},this.gridParams);this.grid=this._createGridObject(x,this.gridContainer);
this.own(this.grid);this.grid._expanded=this.defaultExpand||this.grid._expanded||{};m.oddEvenFix(this.grid);this.own(f(this.tree,"updated",this._onStoreUpdated.bind(this)));this._addKeepScrollHandlers();this._addGridHandlers();this.renderAllRows&&(this.grid.minRowsPerPage=1E4,this.grid.maxRowsPerPage=10250);this.grid.startup();H.autoTooltip(this.domNode);this.showHeader||t.add(this.domNode,"esriMapsAnalystXGridNoHeader");f(this.grid.domNode,".dgrid-expando-icon:click,.dgrid-content .dgrid-column-labelColumn:dblclick,.dgrid-content .dgrid-column-labelColumn:keydown",
function(F){(F=y.grid.row(F))&&y.onExpandChangedUser(F.data)})},_createGridObject:function(y,x){return new g(y,x)},onRowInserted:function(y,x){},_addGridHandlers:function(){function y(n,q){x.enableRowSelection&&q.parent&&(!x.selectedRowFilter||x.selectedRowFilter(q))&&(t.add(n,"esriMapsAnalystXClickable"),f(n,"click",function(F){setTimeout(function(){if(!x._isSelectionFrozen){if(F.shiftKey&&x.enableMultipleRowSelection){if(x._lastSelectedRowInfo&&x._lastSelectedRowInfo.row.parentNode&&x._lastSelectedRowInfo.node.parent===
q.parent){var J=u.getChildIndex(x._lastSelectedRowInfo.row.parentNode,x._lastSelectedRowInfo.row),l=u.getChildIndex(n.parentNode,n),w=J<=l?x._lastSelectedRowInfo.row:n;J=J<=l?n:x._lastSelectedRowInfo.row;l=w;if(w.id!==J.id){do{w=x.grid.row(l).data;x._selectRow(l,w);if(l.id===J.id)break;l=l.nextSibling}while(l)}}else x.selectSingleRow(n,q);u.stealFocus()}else k.isCtrl(F)&&x.enableMultipleRowSelection?x._lastSelectedRowInfo&&x._lastSelectedRowInfo.row.parentNode&&x._lastSelectedRowInfo.node.parent===
q.parent||x.allowSelectionFromManyParents?x._selectedRowInfos[q.id]?x._unselectRow(n,q):x._selectRow(n,q):x.selectSingleRow(n,q):x.selectSingleRow(n,q);x._emitSelectedRowsEvent()}})}))}var x=this;this.own(A.after(this.grid,"insertRow",function(n){var q=n&&x.grid._rowIdToObject[n.id];if(n){if(q&&x.hideInvisibleExpandoIcons&&(!q.children||!q.children.length)){var F=e(".dgrid-expando-icon",n)[0];F&&(F.style.width="0")}u[q&&!1===q.visible?"hide":"show"](n);y(n,q)}q&&(x._updateRowHighlighting(q,n),x.onRowInserted(n,
q));x.rowPostProcessor&&x.rowPostProcessor(n,q);return n}))},_addKeepScrollHandlers:function(){function y(n){if(!x.grid.contentNode)return n;if(x.fitParentSize){var q=u.hasScrollbars(x.grid.bodyNode);x.grid.headerNode.style[x.isLeftToRight()?"right":"left"]=q.w?"":"0px";x._lastContentWidth=x.grid.contentNode.style.width||x._lastContentWidth||"";x.grid.contentNode.style.width=q.h?x._lastContentWidth:""}else x.keepContentUnderScroll?x.grid.contentNode.style.width=x.grid.headerNode.firstChild.offsetWidth+
"px":!1===x.keepContentUnderScroll&&(x.grid.contentNode.style.width="");return n}var x=this;if(this.fitParentSize||void 0!==this.keepContentUnderScroll)A.before(this.grid,"refresh",function(){x.hideCheckLimitMessage();x._lastCheckedNode=null}),A.after(this.grid,"resize",y),A.after(this.grid,"refresh",y)},_getNodeLevel:function(y){var x=-1;for(y=y&&y.parent;y;)x++,y=y.parent;return x},_prepareTreeColumn:function(y){return this._wrapTreeColumn(p(y))},_wrapTreeColumn:function(y){return y},_onStoreUpdated:function(){this._checkboxes=
{};this._refreshGrid();this._rootCheckbox&&this._updateCheckboxState(this._rootCheckbox);this._emitSelectionChanged()},_emitSelectionChanged:function(y){var x=this.tree.root.selectCount;this.updateSelectionCountDiv(this.selectionCounter,x);this.emit("SelectionChanged",{selected:x,toggledTreeNode:y})},refresh:function(){this._refreshGrid();this.refreshCheckboxes()},_isRefreshSuspended:!1,setRefreshSuspended:function(y){this._isRefreshSuspended=y},_refreshGrid:function(){if(!this._isRefreshSuspended){var y=
this.grid.getScrollPosition();this.grid.refresh();this.grid.scrollTo(y);for(var x in this._selectedRowInfos)this.grid.row(this._selectedRowInfos[x].node).element&&this._selectRow(this.grid.row(this._selectedRowInfos[x].node).element,this._selectedRowInfos[x].node)}},getScrollPosition:function(){return this.grid&&this.grid.getScrollPosition()},setScrollPosition:function(y){return this.grid&&this.grid.scrollTo(y)},_renderCheckbox:function(y){if(!y.leafCount&&y!==this.tree.root||!this.showCheckboxColumn||
!1===y.selectable&&void 0===y.indepSelection)return document.createTextNode("");var x=new r(null,{class:"esriStyleInTable"});x.autoToggle=!1;x.node=y;this._updateCheckboxState(x,y);!1===y.enabled&&x.set("disabled",!0);y===this.tree.root?(this._rootCheckbox=x,u[this.showRootCheckbox?"show":"hide"](x.domNode)):this._checkboxes[this.tree.getIdentity(y)]=x;x.onClick=this._onCheckboxClick.bind(this,y,x);return x},_renderCheckboxForColumn:function(y){return(y=this._renderCheckbox(y))&&y.domNode},refreshCheckboxes:function(){this._rootCheckbox&&
this._updateCheckboxState(this._rootCheckbox);for(var y in this._checkboxes)this._updateCheckboxState(this._checkboxes[y])},clearLastCheckInfo:function(){this._lastCheckedNode=null},_onCheckboxClick:function(y,x,n){n.stopPropagation();this.hideCheckLimitMessage();var q=this.handleMultipleCheck&&("function"!==typeof this.handleMultipleCheck||this.handleMultipleCheck(y));q&&n.shiftKey&&this._tryToggleMultipleNodes(this._lastCheckedNode,y,x||n)?this._lastCheckedNode=y:(this._lastCheckedNode=q?y:null,
this._toggleNodeSelection(y,x||n),this.refreshCheckboxes())},_tryToggleMultipleNodes:function(y,x,n){if(!y||y===x||y.parent!==x.parent)return!1;var q=x.parent.children,F=q.indexOf(y);x=q.indexOf(x);y=F<x?1:-1;var J=[],l=[];for(F+=y;;F+=y){var w=q[F];((void 0===w.indepSelection?w.selected:w.indepSelection)?J:l).push(w);if(F===x)break}J.forEach(function(I){this._toggleNodeSelection(I,n)},this);l.every(function(I){return this._toggleNodeSelection(I,n)},this);this.refreshCheckboxes();return!0},_toggleNodeSelection:function(y,
x){var n=void 0===y.indepSelection?!y.selected:!y.indepSelection;if(n&&this.checkLimit){var q=this.getSelectedNodes().length,F="function"===typeof this.checkLimit?this.checkLimit(this.tree,q):this.checkLimit;if(q>=F)if(void 0===y.indepSelection&&y.children&&!1!==this.tree.getSelectionState(y))n=!1;else return this.showCheckLimitMessage(x),!1}q=!0;void 0===y.indepSelection?(q=this.tree.changeSelect(y,n,F),!q&&this.showCheckLimitMessage(x)):y.indepSelection=n;this._emitSelectionChanged(y);return q},
_checkLimitHandler:null,showCheckLimitMessage:function(y){if(this.checkLimitMessage){var x=y&&(y.domNode||y.target);x&&(d.show(this.checkLimitMessage,x,["above","below"]),y=function(){x&&d.hide(x);x=null},setTimeout(y,this.checkLimitMessageTimeout),this._checkLimitHandler=y,this.onCheckLimitReached(y))}},hideCheckLimitMessage:function(){this._checkLimitHandler&&this._checkLimitHandler();this._checkLimitHandler=null},onCheckLimitReached:function(y){},_updateCheckboxState:function(y){if(y){var x=this._getNodeSelection(y.node);
y.set("checked",x);this._updateRowHighlighting(y.node,null,x)}},_getNodeSelection:function(y){return void 0!==y.indepSelection?y.indepSelection:this.tree.getSelectionState(y)},_updateRowHighlighting:function(y,x,n){this.highlightSelected&&y&&(n=void 0!==n?n:this._getNodeSelection(y),(x=x||this.grid&&this.row(y).element)&&(!0!==n||void 0===y.indepSelection&&!1===y.selectable?t.remove(x,"selected"):t.add(x,"selected")))},_renderLabel:function(y,x,n){x=this._renderLabelNode(y,n);this._provideLabelClickAction(x,
n,y);return x},_provideLabelClickAction:function(y,x,n){var q=this.expandOnNodeClick&&n.children?n.children.length&&(y=x,function(){this.toggleExpand(n);this.onExpandChangedUser(n)}.bind(this)):!1!==n.enabled&&this.showCheckboxColumn?this._onCheckboxClick.bind(this,n,null):null;q&&(t.add(y,"esriMapsAnalystXClickable"),f(y,"click",function(F){F.stopPropagation();q(F)}))},_renderLabelNode:function(y){return h.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(y)})},
_renderLabelHeader:function(y){var x=h.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(y)||this._labelColumn&&this._labelColumn.label||""});this.enableHeaderLabelToggleClick&&this.showRootCheckbox&&(t.add(x,"esriMapsAnalystXClickable"),f(x,"click",this._onCheckboxClick.bind(this,y,null)));return x},onRowsSelected:function(y,x){},isNodeSelected:function(y){return y&&(y.selected||y.indepSelection)},getSelectedNodes:function(){var y=this.tree.getSelectedNodes(!1),
x=this._getIndepSelectedNodes();return y.concat(x)},_getIndepSelectedNodes:function(){function y(n){n&&(n.indepSelection&&x.push(n),n.children&&n.children.forEach(y))}var x=[];y(this.tree.root);return x},getSelectedState:function(){if(!this.tree)return null;var y={normalSelection:{},indepSelection:{}},x=this.tree.getSelectedNodes(!1);x&&x.forEach(function(n){y.normalSelection[n.id]=!0});(x=this._getIndepSelectedNodes())&&x.forEach(function(n){y.indepSelection[n.id]=!0});return y},setSelectedState:function(y){if(this.tree){this.tree.changeSelect(this.tree.root,
!1);if(y){for(var x in y.normalSelection){var n=this.tree.get(x);n&&this.tree.changeSelect(n,!0)}for(x in y.indepSelection)if(n=this.tree.get(x))n.indepSelection=!0}this.refreshCheckboxes()}},setNodeSelected:function(y,x,n){y&&(void 0!==y.indepSelection?y.indepSelection=x:this.tree.changeSelect(y,x),!1!==n&&this.refreshCheckboxes())},isExpanded:function(y){y="string"===typeof y?y:y[this.tree.idProperty];return this.grid._expanded&&this.grid._expanded[y]},setExpanded:function(y,x,n){y="string"==typeof y?
y:y[this.tree.idProperty];void 0!==y&&(!1!==n?(n=this.grid.row(y))&&n.element&&this.grid.expand(y,x):this.grid._expanded[y]=x)},toggleExpand:function(y){this.setExpanded(y,!this.isExpanded(y))},getExpandedState:function(){return Object.assign({},this.grid._expanded)},setExpandedState:function(y){this.grid._expanded=y||{}},onExpandChangedUser:function(y){},destroy:function(){this.unselectAllRows();this.inherited(arguments)}})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_TemplatedMixin":function(){define(["dojo/_base/declare",
"dijit/_TemplatedMixin","./_EscapeValueMixin"],function(v,A,B){return v([A,B],{})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_EscapeValueMixin":function(){define(["dojo/_base/declare"],function(v){return v(null,{_escapeValue:function(A){return A.replace(/"/g,"\x26quot;")}})})},"dgrid/tree":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/Deferred dojo/_base/lang dojo/query dojo/on dojo/aspect ./util/has-css3 ./Grid dojo/has!touch?./util/touch put-selector/put".split(" "),function(v,
A,B,t,h,c,f,e,d,a,b){function g(r,m,u,G){G=this.grid.isRTL?"right":"left";var H=".dgrid-expando-icon";m&&(H+=".ui-icon.ui-icon-triangle-1-"+(u?"se":"e"));r=b("div"+H+"[style\x3dmargin-"+G+": "+r*(this.indentWidth||9)+"px; float: "+G+"]");r.innerHTML="\x26nbsp;";return r}function p(r){var m=this,u=this.style.height;u&&(this.style.display="0px"==u?"none":"block");r&&(b(this,".dgrid-tree-resetting"),setTimeout(function(){b(m,"!dgrid-tree-resetting")}));this.style.height=""}function k(r){var m=r.renderCell||
d.defaultRenderCell,u,G;r||(r={});r.shouldExpand=r.shouldExpand||function(H,C,E){return E};f.after(r,"init",function(){var H=r.grid,C=".dgrid-content .dgrid-column-"+r.id,E=[];H.cleanEmptyObservers=!1;if(!H.store)throw Error("dgrid tree column plugin requires a store to operate.");r.renderExpando||(r.renderExpando=g);E.push(H.on(r.expandOn||".dgrid-expando-icon:click,"+C+":dblclick,"+C+":keydown",function(K){var D=H.row(K);H.store.mayHaveChildren&&!H.store.mayHaveChildren(D.data)||"keydown"==K.type&&
32!=K.keyCode||"dblclick"==K.type&&G&&1<G.count&&D.id==G.id&&-1<K.target.className.indexOf("dgrid-expando-icon")||H.expand(D);-1<K.target.className.indexOf("dgrid-expando-icon")&&(G&&G.id==H.row(K).id?G.count++:G={id:H.row(K).id,count:1})}));e("touch")&&E.push(H.on(a.selector(C,a.dbltap),function(){H.expand(this)}));H._expanded||(H._expanded={});E.push(f.after(H,"insertRow",function(K){var D=this.row(K);r.shouldExpand(D,u,this._expanded[D.id])&&this.expand(K,!0,!0);return K}));E.push(f.before(H,"removeRow",
function(K,D){if(K=K.connected)h("\x3e.dgrid-row",K).forEach(function(z){H.removeRow(z,!0)}),D||b(K,"!")}));r.collapseOnRefresh&&E.push(f.after(H,"cleanup",function(){this._expanded={}}));H._calcRowHeight=function(K){var D=K.connected;return K.offsetHeight+(D?D.offsetHeight:0)};H.expand=function(K,D,z){var y=K.element?K:H.row(K),x=e("transitionend");K=new B;var n=K.promise;K.resolve();K=y.element;K=-1<K.className.indexOf("dgrid-expando-icon")?K:h(".dgrid-expando-icon",K)[0];z=z||!1===r.enableTransitions;
if(K&&K.mayHaveChildren&&(z||D!==!!this._expanded[y.id])){var q=void 0===D?!this._expanded[y.id]:D;b(K,".ui-icon-triangle-1-"+(q?"se":"e")+"!ui-icon-triangle-1-"+(q?"e":"se"));D=y.element;var F=D.connected,J={originalQuery:this.query};if(!F){F=J.container=D.connected=b(D,"+div.dgrid-tree-container");var l=function(M){return H.store.getChildren(y.data,M)};r.allowDuplicates&&(J.parentId=y.id);"level"in K&&(l.level=K.level);n=n.then(function(){if(H.renderQuery)return H.renderQuery(l,J);var M=b(F,"div"),
L=H.renderArray(l(J),M,"level"in l?{queryLevel:l.level}:{});B.when(L,function(){b(M,"!")});return L});x?c(F,x,p):p.call(F)}F.hidden=!q;var w=F.style;if(!x||z)w.display=q?"block":"none",w.height="";else{if(q){w.display="block";var I=F.scrollHeight;w.height="0px"}else b(F,".dgrid-tree-resetting"),w.height=F.scrollHeight+"px";setTimeout(function(){b(F,"!dgrid-tree-resetting");w.height=q?I?I+"px":"auto":"0px"})}q?this._expanded[y.id]=!0:delete this._expanded[y.id]}return n};f.after(r,"destroy",function(){A.forEach(E,
function(K){K.remove()});delete H.expand;delete H._calcRowHeight})});r.renderCell=function(H,C,E,K){var D=r.grid,z=Number(K&&K.queryLevel)+1,y=!D.store.mayHaveChildren||D.store.mayHaveChildren(H),x=K.parentId;z=u=isNaN(z)?0:z;D=r.renderExpando(z,y,D._expanded[(x?x+"-":"")+D.store.getIdentity(H)],H);D.level=z;D.mayHaveChildren=y;(H=m.call(r,H,C,E,K))&&H.nodeType?(b(E,D),b(E,H)):E.insertBefore(D,E.firstChild)};return r}k.defaultRenderExpando=g;t.getObject("dgrid.tree",!0);return dgrid.tree=k})},"dgrid/util/has-css3":function(){define(["dojo/has"],
function(v){function A(t,h){t=t.style;var c;if(h in t)return!0;h=h.slice(0,1).toUpperCase()+h.slice(1);for(c=B.length;c--;)if(B[c]+h in t)return B[c];return!1}var B=["ms","O","Moz","Webkit"];v.add("css-transitions",function(t,h,c){return A(c,"transitionProperty")});v.add("css-transforms",function(t,h,c){return A(c,"transform")});v.add("css-transforms3d",function(t,h,c){return A(c,"perspective")});v.add("transitionend",function(){var t=v("css-transitions");return t?!0===t?"transitionend":{ms:"MSTransitionEnd",
O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[t]:!1});return v})},"esri/dijit/geoenrichment/utils/KeyboardUtil":function(){define(["dojo/on","dojo/sniff","./DomUtil"],function(v,A,B){var t={listenToKeyboardCombinationOverNode:function(h){return v(document.body,"keydown",function(c){if(!h.isCtrl||t.isCtrl(c))if(!h.isShift||c.shiftKey)if(!h.isAlt||c.altKey)String.fromCharCode(c.keyCode).toLowerCase()!==h["char"]||h.node&&!B.isNodeInLayout(h.node)||h.callback(c)})},isCtrl:function(h){return A("mac")?
h.metaKey:h.ctrlKey}};return t})},"esri/dijit/geoenrichment/utils/DomUtil":function(){define("dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/query esri/dijit/geoenrichment/Deferred dojo/domReady!".split(" "),function(v,A,B,t,h,c,f){function e(k,r){Array.isArray(k)?k.forEach(r):r(k);return k}function d(k,r,m){var u=!1,G=function(H){!H||m&&!m(H)||(H.parentNode===r?u=!0:G(H.parentNode))};G(k);return u}function a(k){return!b.isHidden(k)&&"none"!==h.get(k,"display")&&
!A.contains(k,"dijitHidden")}var b={isHidden:function(k){return k&&A.contains(k,"esriGEHidden")},hasVisibleChildren:function(k){if(!k||!k.children.length)return!1;for(var r=0;r<k.children.length;r++)if(!b.isHidden(k.children[r]))return!0;return!1},hide:function(k){return b.addTag(k,"esriGEHidden")},show:function(k){return b.removeTag(k,"esriGEHidden")},display:function(k,r){return b[r?"show":"hide"](k)},addTag:function(k,r){return e(k,function(m){m&&A.add(m,r)})},removeTag:function(k,r){return e(k,
function(m){m&&A.remove(m,r)})},getChildIndex:function(k,r){if(!k||!k.children||!r)return-1;for(var m=0;m<k.children.length;m++)if(k.children[m]===r)return m;return-1},isChildOf:function(k,r){return d(k,r)},isNodeInLayout:function(k){return d(k,document.body,function(r){return a(r)})},isNodeVisible:function(k){return d(k,document.body,function(r){return a(r)&&"hidden"!==h.get(r,"visibility")})},isNodeOnscreen:function(k){return d(k,document.body,function(r){return!A.contains(r,"esriGEOffscreen")})},
enableContent:function(k,r,m){if(k){m=m||{};var u=k.children.length-1;if(!(0>u||(u=k.children[u],A.contains(u,"esriGEDisabledContent")||(u=null),u&&k.removeChild(u),r)))return u=B.create("div",{"class":"esriGEDisabledContent"+(m.overlayClass?" "+m.overlayClass:"")},k),m.textContent&&(u.textContent=m.textContent),!1!==m.fitParent&&(k=t[m.marginBox?"getMarginBox":"getContentBox"](k).h)&&h.set(u,{height:k+"px",marginTop:-k+"px"}),u}},enableContentAbsolute:function(k,r,m){if(k){m=m||{};var u=h.get(k,
"position");"relative"===u||"absolute"===u||r||h.set(k,"position","relative");return b.enableContent(k,r,{overlayClass:"esriGEAbsoluteStretched"+(m.overlayClass?" "+m.overlayClass:"")+(m.isTransparent?" esriGEDisabledContentTransparent":""),fitParent:!1,textContent:m.textContent})}}},g;b.hideNodeInBackground=function(k,r){if(k){if(k._hideNodeInBackgroundUndoController)return k._hideNodeInBackgroundUndoController;var m=B.create("div",null,k,"after"),u=B.create;g||(g=B.create("div",{"class":"esriGEOffscreen"},
document.body));var G=u.call(B,"div",{style:"position: absolute; left: 0px; top: 0px;"},g);B.place(k,G);r="DomUtil.hideNodeInBackground"+(r?"."+r:"");v.set(m,"_bg_memo_node",r);v.set(G,"_bg_temp_node",r);r={remove:function(){m&&(m.parentNode&&B.place(k,m,"replace"),B.destroy(m),B.destroy(G),g.children.length||(B.destroy(g),g=null),m=null,delete k._hideNodeInBackgroundUndoController)}};return k._hideNodeInBackgroundUndoController=r}};b.showNodeFromBackground=function(k){k&&k._hideNodeInBackgroundUndoController&&
k._hideNodeInBackgroundUndoController.remove()};b.noTransformPosition=function(k){function r(H){for(var C={x:0,y:0};H.offsetParent;)C.x+=H.offsetLeft,C.y+=H.offsetTop,H=H.offsetParent,C.x+=h.get(H,"borderLeftWidth"),C.y+=h.get(H,"borderTopWidth");return C}function m(H){return h.get(H,"width")+h.get(H,"paddingLeft")+h.get(H,"paddingRight")+h.get(H,"borderLeftWidth")+h.get(H,"borderRightWidth")}function u(H){return h.get(H,"height")+h.get(H,"paddingTop")+h.get(H,"paddingBottom")+h.get(H,"borderTopWidth")+
h.get(H,"borderBottomWidth")}if(k){if(k instanceof SVGElement&&k.getBBox){var G=(G=k.ownerSVGElement&&k.ownerSVGElement.parentNode)&&r(G);k=k.getBBox();return{x:(k.x||0)+G.x,y:(k.y||0)+G.y,w:k.width||0,h:k.height||0}}G=r(k);return{x:G.x,y:G.y,w:m(k),h:u(k)}}};b.getNodesBox=function(k,r){if(!k||!k.length)return null;r=r||{};for(var m=1E6,u=-1E6,G=1E6,H=-1E6,C=0;C<k.length;C++){var E=k[C];E=r.ignoreTransformation?b.noTransformPosition(E):t.position(E);m=Math.min(m,E.x);G=Math.min(G,E.y);u=Math.max(u,
E.x+E.w);H=Math.max(H,E.y+E.h)}k={x:m,y:G,w:u-m,h:H-G};r.originNode&&(r=r.ignoreTransformation?b.noTransformPosition(r.originNode):t.position(r.originNode),k.x-=r.x,k.y-=r.y);return k};b.traverseChildren=function(k,r){function m(u){if(u&&u.children)for(var G=0;G<u.children.length;G++){var H=u.children[G];if(r(H))break;m(H)}}m(k)};b.scrollToListNode=function(k,r,m){var u=r.offsetTop+r.clientHeight,G=u-(k.scrollTop+k.clientHeight);0<G&&(k.scrollTop+=G);m&&(u-=r.clientHeight-m.offsetTop,G=k.scrollTop-
u,0<G&&(k.scrollTop-=G))};var p;b.getScrollbarSize=function(){if(!p){var k=B.create("div",null,document.body);k.style.width="100px";k.style.height="100px";k.style.overflow="scroll";k.style.position="absolute";k.style.top="9999px";p={w:k.offsetWidth-k.clientWidth,h:k.offsetHeight-k.clientHeight};B.destroy(k)}return p};b.hasScrollbars=function(k){var r=h.getComputedStyle(k);return{w:"scroll"===r.overflowX||k.offsetWidth>k.clientWidth&&"auto"===r.overflowX,h:"scroll"===r.overflowY||k.offsetHeight>k.clientHeight&&
"auto"===r.overflowY}};b.getMeasureContext=function(k){k=k||{};k.style=k.style?k.style+" ":"";k.style+="display: inline-block; position: absolute; left: 0; top: 0;";return{div:B.create("div",k,document.body),measureText:function(r){this.div.innerHTML=r;r=t.getMarginBox(this.div);delete r.l;delete r.t;return r},destroy:function(){B.destroy(this.div)}}};b.getTextBox=function(k,r){r=b.getMeasureContext(r);k=r.measureText(k);r.destroy();return k};b.getNodeFontFamily=function(k){return(k=h.get(k,"fontFamily")||
h.getComputedStyle(k).fontFamily)&&k.replace(/'|"/g,"").split(",")[0]};b.getNodeFontSize=function(k){return h.toPixelValue(k,h.get(k,"fontSize"))};b.stealFocus=function(){var k=new f;try{var r=B.create("input",{type:"text",style:"position: absolute; left: 0px; top: 0px;"});B.place(r,document.body);r.select();B.destroy(r)}catch(m){}setTimeout(k.resolve,0);return k.promise};b.getWindowBox=function(){for(var k=[],r=0,m=document.body.children.length;r<m;r++){var u=document.body.children[r];b.isHidden(u)||
(b.hide(u),k.push(u))}r={w:document.body.clientWidth,h:document.body.clientHeight};k.forEach(function(G){b.show(G)});return r};b.isBodyLtr=function(){return"ltr"===(document.body.dir||"ltr").toLowerCase()};b.setAttribute=function(k,r,m){return 2===arguments.length?v.set(k,r):v.set(k,r,m)};b.getAttribute=function(k,r,m){return 2===arguments.length?v.get(k,r):v.get(k,r,m)};b.addClass=function(k,r){A.add(k,r)};b.removeClass=function(k,r){A.remove(k,r||"")};b.toggleClass=function(k,r,m){A[m?"add":"remove"](k,
r||"")};b.replaceClass=function(k,r,m){return A.replace(k,r,m)};b.containsClass=function(k,r){return A.contains(k,r)};b.getStyle=function(k,r){return h.get(k,r)};b.setStyle=function(k,r,m){return 2===arguments.length?h.set(k,r):h.set(k,r,m)};b.setFullTextStyle=function(k,r){r.fontSize&&(r=Object.assign({},r),r.fontSize+="px");b.setStyle(k,r)};b.getStylePixelValue=function(k,r){k=b.getStyle(k,r);return"number"===typeof k?k:parseFloat(k)||0};b.getComputedStyle=function(k){return k&&1===k.nodeType&&
window.getComputedStyle(k)};b.position=function(k,r){return t.position(k,r)};b.getMarginBox=function(k,r){return t.getMarginBox(k,r)};b.getMarginExtents=function(k,r){return t.getMarginExtents(k,r)};b.getContentBox=function(k,r){return t.getContentBox(k,r)};b.getPadBorderExtents=function(k,r){return t.getPadBorderExtents(k,r)};b.getPadExtents=function(k,r){return t.getPadExtents(k,r)};b.getBorderExtents=function(k,r){return t.getBorderExtents(k,r)};b.docScroll=function(){return t.docScroll()};b.create=
function(k,r,m,u){return B.create(k,r,m,u)};b.toDom=function(k){return B.toDom(k)};b.place=function(k,r,m){return B.place(k,r,m)};b.empty=function(k){return B.empty(k)};b.destroy=function(k){return B.destroy(k)};b.query=function(k,r){k=c(k,r);r=[];for(var m=0,u=k.length;m<u;m++)r.push(k[m]);return r};return b})},"esri/dijit/geoenrichment/Deferred":function(){define(["dojo/Deferred"],function(v){return v})},"esri/dijit/geoenrichment/TriStateItem":function(){define("dojo/_base/declare dojo/_base/event dojo/_base/lang dojo/Stateful dojo/on dojo/dom-construct dojo/dom-class ./utils/DeviceUtil ./utils/AccessibilitySupport".split(" "),
function(v,A,B,t,h,c,f,e,d){return v(t,{domNode:null,checkboxNode:null,checked:!1,disabled:!1,autoToggle:!0,_currentClass:null,_lastChecked:!1,constructor:function(a,b,g,p){var k=e.isMobileDevice()?"touchstart":"click";b=b||{};var r=b["class"];b["class"]=(r?r+" ":"")+"esriTriStateCheckBoxIcon";if(r=b.label){if(a instanceof HTMLLabelElement)a.innerHTML="\x26nbsp;"+r;else{var m=b.labelAttrs||{};m.innerHTML="\x26nbsp;"+r;m=c.create("label",m);a&&c.place(m,a);a=m}b=B.mixin({},b);delete b.label;delete b.labelAttrs}this.checkboxNode=
c.create("div",b,a,a instanceof HTMLLabelElement?"first":g);this._currentClass=this._composeClass();f.add(this.checkboxNode,this._currentClass);a instanceof HTMLLabelElement?(h(a,k,B.hitch(this,this._onClick)),f.add(a,"esriTriStateCheckBoxLabel"),p&&d.registerButton(a,this._onClick.bind(this),r)):(h(this.checkboxNode,k,B.hitch(this,this._onClick)),p&&d.registerButton(this.checkboxNode,this._onClick.bind(this),r));this.domNode=r?a:this.checkboxNode},postscript:function(){},_onClick:function(a){this.disabled||
(this.autoToggle&&this.toggle(),a&&(a.checked=this.checked),this.onClick(A.fix(a)))},onClick:function(a){},toggle:function(){this.set("checked",!this._lastChecked);return this.checked},_checkedSetter:function(a){a!==this.checked&&(this.checked="mixed"===a?a:this._lastChecked=!!a,this._updateClass())},_disabledSetter:function(a){this.disabled=!!a;this._updateClass()},_updateClass:function(){var a=this._composeClass();a!==this._currentClass&&(f.replace(this.checkboxNode,a,this._currentClass),this._currentClass=
a)},_composeClass:function(){var a="esriTriStateCheckBox"+("mixed"==this.checked?"Mixed":this.checked?"Checked":"");return this.disabled?a+"Disabled":a}})})},"esri/dijit/geoenrichment/utils/DeviceUtil":function(){define(["dojo/sniff","dojo/domReady!"],function(v){var A={},B=function(){var h=window,c=h.navigator.platform,f=h.navigator.userAgent,e={ios:!1,android:!1,androidChrome:!1,desktop:!1,iphone:!1,ipod:!1,ipad:!1,edge:!1,ie:!1,firefox:!1,macos:!1,windows:!1,cordova:!(!h.cordova&&!h.phonegap),
phonegap:!(!h.cordova&&!h.phonegap),electron:!1,nwjs:!1},d=h.screen.width,a=h.screen.height,b=f.match(/(Android);?[\s\/]+([\d.]+)?/),g=f.match(/(iPad).*OS\s([\d_]+)/),p=f.match(/(iPod)(.*OS\s([\d_]+))?/),k=!g&&f.match(/(iPhone\sOS|iOS)\s([\d_]+)/),r=0<=f.indexOf("MSIE ")||0<=f.indexOf("Trident/"),m=0<=f.indexOf("Edge/"),u=0<=f.indexOf("Gecko/")&&0<=f.indexOf("Firefox/"),G="Win32"===c,H=0<=f.toLowerCase().indexOf("electron"),C="undefined"!==typeof nw&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&
"undefined"!==typeof process.versions.nw;c="MacIntel"===c;var E="1024x1366 1366x1024 834x1194 1194x834 834x1112 1112x834 768x1024 1024x768".split(" ");!g&&c&&v("touch")&&0<=E.indexOf(d+"x"+a)&&((g=f.match(/(Version)\/([\d.]+)/))||(g=[0,1,"13_0_0"]),c=!1);e.ie=r;e.edge=m;e.firefox=u;b&&!G&&(e.os="android",e.osVersion=b[2],e.android=!0,e.androidChrome=0<=f.toLowerCase().indexOf("chrome"));if(g||k||p)e.os="ios",e.ios=!0;k&&!p&&(e.osVersion=k[2].replace(/_/g,"."),e.iphone=!0);g&&(e.osVersion=g[2].replace(/_/g,
"."),e.ipad=!0);p&&(e.osVersion=p[3]?p[3].replace(/_/g,"."):null,e.ipod=!0);e.ios&&e.osVersion&&0<=f.indexOf("Version/")&&"10"===e.osVersion.split(".")[0]&&(e.osVersion=f.toLowerCase().split("version/")[1].split(" ")[0]);e.webView=!(!(k||g||p)||!f.match(/.*AppleWebKit(?!.*Safari)/i)&&!h.navigator.standalone)||h.matchMedia&&h.matchMedia("(display-mode: standalone)").matches;e.webview=e.webView;e.standalone=e.webView;e.desktop=!(e.ios||e.android)||H||C;e.desktop&&(e.electron=H,e.nwjs=C,e.macos=c,e.windows=
G,e.macos&&(e.os="macos"),e.windows&&(e.os="windows"));e.pixelRatio=h.devicePixelRatio||1;return e}();A.device=B;A.isMobileDevice=function(){return!B.desktop};A.isPCWithTouchScreen=function(){return B.desktop&&v("touch")};A.isLandscape=function(){return 90===Math.abs(window.orientation)};var t=null;A.isWebLayout=function(){if(!t){var h=document.createElement("div");h.style="visibility:hidden;height:1in;width:1in;position:absolute;left: -100%;top:-100%;";document.body.appendChild(h);t=h.offsetHeight;
h.parentNode.removeChild(h)}h=t;h*=7;var c=document.body.offsetWidth;if(c>=h)return!0;var f=document.body.offsetHeight;return c>=f&&Math.sqrt(c*c+f*f)>=h?!0:!1};A.press=B.desktop?"mousedown":"touchstart";A.release=B.desktop?"mouseup":"touchend";A.click=B.desktop?"click":"touchend";A.clickOrRelease=B.desktop?"click, mouseup":"touchend";A.move=B.desktop?"mousemove":"touchmove";return A})},"esri/dijit/geoenrichment/utils/AccessibilitySupport":function(){define([],function(){var v=null;return{initialize:function(A){v=
A},registerButton:function(A,B,t){v&&v(A,B,t)}}})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DgridUtil":function(){define(["dojo/aspect","dojo/dom-class","dojo/query","../../utils/ArrayUtil"],function(v,A,B,t){function h(d,a,b){if(void 0===b){var g=d._rowIdToObject[a.id];g&&(b=(d=d.store)&&d.isOdd&&d.isOdd(g))}0!==b&&1!==b||A.replace(a,e[b],e[1-b])}function c(d,a,b){var g=d.store;if(g&&g.updateExpand){b=g.updateExpand(a.data,b,!0,d.getSortingFunction());for(var p in b)a=d.row(g.get(p)),a.element&&
h(d,a.element,b[p])}}var f=["ui-icon-triangle-1-e","ui-icon-triangle-1-se"],e=["dgrid-row-even","dgrid-row-odd"];return{createExpando:function(d){A.add(d,"dgrid-expando-icon ui-icon ui-icon-triangle-1-e esriMapsAnalystXClickable");return{expando:d,update:function(a){a=a?1:0;A.replace(d,f[a],f[1-a])}}},oddEvenFix:function(d){d.expand&&(d.getSortingFunction=function(){var a=this.get("sort");return a&&a.length?t.getSorting(a):null},v.after(d,"insertRow",function(a){h(d,a);return a}),v.before(d,"refresh",
function(){var a=d.store;a&&a.updateExpandedNodes&&a.updateExpandedNodes(d._expanded,d.getSortingFunction())}),v.around(d,"expand",function(a){return function(b,g){var p=b.element?b:d.row(b);void 0===g&&(g=!d._expanded[p.id]);!0===g&&c(d,p,!0);var k=a.apply(this,arguments);!1===g&&c(d,p,!1);return k}}),v.around(d,"adjustRowIndices",function(a){return function(){var b=d.store;b&&b.updateExpandedNodes&&b.updateExpand&&b.isOdd||a.apply(this,arguments)}}))},makeContentNeverGoUnderScroll:function(d){function a(){var b=
d.headerNode.firstChild,g=d.contentNode;g&&b&&b.offsetWidth!==g.offsetWidth&&(g.style.width="",b.style.width="",b.style.width=g.offsetWidth+"px")}v.after(d,"resize",a);v.after(d,"refresh",a);v.after(d,"expand",function(b){setTimeout(a,100);setTimeout(a,300);return b})},inlineSortArrow:function(d,a,b){a=t.arrayToObject(t.listToArray(a));v.after(d,"updateSortArrow",function(g,p){if((p=g[0]&&g[0].attribute)&&a[p]){var k=(p=d._sortNode||d._findSortArrowParent(p))&&B(".dgrid-sort-arrow",p)[0];g=g[0].descending;
if(k){k.remove();A.remove(p,"dgrid-sort-down dgrid-sort-up");var r=b?B(b,p)[0]:p.lastChild.append?p.lastChild:p;r.append||(r=p);A.add(r,g?"dgrid-sort-down":"dgrid-sort-up");r.append(k)}}},!0)}}})},"widgets/BusinessAnalyst/esriAnalystX/utils/ArrayUtil":function(){define("require exports ../../baUtil/array dojo/store/util/SimpleQueryEngine ./ObjectUtil esri/dijit/geoenrichment/utils/ArrayUtil".split(" "),function(v,A,B,t,h,c){function f(a,b){a.some(function(g,p){b.func(g,p,b,a);if(b.stop)return!0});
return b}function e(a){var b=a.split(" "),g=b[1];a={};switch(b[0]){case "max":a.result=-Infinity;b=function(p,k,r){r.result=Math.max(r.result,h.getObject(p,g))};break;case "min":a.result=Infinity;b=function(p,k,r){r.result=Math.min(r.result,h.getObject(p,g))};break;case "sum":a.result=0;b=function(p,k,r){r.result+=h.getObject(p,g)};break;case "random":a.result=void 0;b=function(p,k,r,m){r.result=m[Math.round((m.length-1)*Math.random())];r.stop=!0};break;default:throw Error("Unsupported query.");}a.func=
b;return a}var d={getSorting:function(a,b){if(!a)return h.compare;if("function"===typeof a)return a;var g=Array.isArray(a)?a:a.sort||[a];var p={};"string"===typeof b&&(b=[b]);Array.isArray(b)?b.forEach(function(k){p[k]=h.compareNames}):b&&(p=b);return function(k,r){for(var m=void 0,u=0;m=g[u];u++){var G=k[m.attribute],H=r[m.attribute];if(G=(p[m.attribute]||(p["*"]?p["*"].bind(null,m.attribute):h.compare))(G,H,!1,!1,k,r))return m.descending?-G:G}return 0}},sort:function(a,b,g){return a.sort(d.getSorting(b,
g))},sortIndices:function(a,b,g){a=B.map(a,function(k,r){return{value:k,index:r}});var p=d.getSorting(b,g);a.sort(function(k,r){return p(k.value,r.value)});return B.map(a,function(k){return k.index})},getQueryEngine:function(a,b){return function(g,p){p&&p.sort&&(p=Object.assign({},p),p.sort=d.getSorting(p.sort,a));return(b||t)(g,p)}},objectToArray:function(a,b){void 0===b&&(b=null);var g=[],p=b?function(m){return a[m]?a[m][b]:void 0}:function(m){return a[m]},k;for(k in a){var r=p(k);"undefined"!==
typeof r&&g.push(r)}return g},arrayToObject:function(a,b){var g={},p=c.composeIdentityFunction(b);B.forEach(a,function(k){g[p(k)]=k});return g},composeIdentityFunction:c.composeIdentityFunction,removeDuplicates:c.removeDuplicates,splitArrayToBunches:c.splitArrayToBunches,contains:function(a,b){return-1!==B.indexOfLoose(a,b)},remove:function(a,b){b=B.indexOfLoose(a,b);-1!==b&&a.splice(b,1);return-1!==b},merge:function(a,b){a=a||[];null!=b&&Array.prototype.push.apply(a,b);return a},listToArray:function(a,
b){if(null==a)return[];void 0===b&&(b=",");a="string"===typeof a?a.split(b):a.slice();for(b=0;b<a.length;b++)"string"===typeof a[b]&&(a[b]=a[b].trim());return a},reorderArray:function(a,b){var g=a.length,p=0,k=Array(g),r={},m={},u;for(u in b){var G=Math.round(u);if(0<=G&&G<g&&!r[G]){var H=Math.round(b[u]);0<=H&&H<g&&!m[H]&&(k[H]=a[G],r[G]=1,m[H]=1,p++)}}p!==g&&(k=k.filter(function(C,E){return m[E]}),a.forEach(function(C,E){!r[E]&&k.push(C)}));return k},mapIndices:function(a,b,g,p){p=null==p?null:
p;if(1===a)g.call(p,0,Math.floor(b/2));else{b=(b-1)/(a-1);for(var k=0;k<a;k++)g.call(p,k,Math.floor(.5+k*b))}},moveElement:function(a,b,g,p){var k=Array.isArray(b)?b:[b];if(-1!==k.indexOf(g))return a.slice();var r=[];a.forEach(function(m){-1===k.indexOf(m)&&(m==g?"before"===p?(k.forEach(function(u){r.push(u)}),r.push(g)):"after"===p&&(r.push(g),k.forEach(function(u){r.push(u)})):r.push(m))});return r},min:function(a,b){var g=a.length;switch(g){case 0:return null;case 1:return a[0];default:for(var p=
a[0],k=b(p),r=0,m=1;m<g;m++){var u=b(a[m]);k>u&&(p=a[m],k=u,r=m)}return{key:r,value:p,comparisonValue:k}}},max:function(a,b){var g=a.length;switch(g){case 0:return null;case 1:return a[0];default:for(var p=a[0],k=b(p),r=0,m=1;m<g;m++){var u=b(a[m]);k<u&&(p=a[m],k=u,r=m)}return{key:r,value:p,comparisonValue:k}}},query:function(a,b){if("object"===typeof b)return f(a,b);if("string"===typeof b)return b=e(b),f(a,b).result},everyEqualProperty:function(a,b){if(2>a.length)return!0;var g;return!a.some(function(p,
k){if(0===k)g=p[b];else if(g!==p[b])return!0})}};return d})},"widgets/BusinessAnalyst/baUtil/array":function(){define(["require","exports"],function(v,A){var B=Array.prototype,t={every:function(h,c,f){return null==h?!0:"string"===typeof h?B.every.call(h.split(""),c,f):B.every.call(h,c,f)},some:function(h,c,f){return null==h?!1:"string"===typeof h?B.some.call(h.split(""),c,f):B.some.call(h,c,f)},forEach:function(h,c,f){if(null!=h)return"string"===typeof h?B.forEach.call(h.split(""),c,f):B.forEach.call(h,
c,f)},map:function(h,c,f){return null==h?[]:"string"===typeof h?B.map.call(h.split(""),c,f):B.map.call(h,c,f)},filter:function(h,c,f){return null==h?[]:"string"===typeof h?B.filter.call(h.split(""),c,f):B.filter.call(h,c,f)},indexOf:function(h,c){return null==h?-1:"string"===typeof h?B.indexOf.call(h.split(""),c):B.indexOf.call(h,c)},indexOfLoose:function(h,c){if(null==h||void 0===h.length)return-1;if("string"===typeof h)return t.indexOfLoose(h.split(""),c);for(var f=0,e=h.length;f<e;f++)if(h[f]==
c)return f;return-1},lastIndexOf:function(h,c){return null==h?-1:"string"===typeof h?B.lastIndexOf.call(h.split(""),c):B.lastIndexOf.call(h,c)},lastIndexOfLoose:function(h,c){if(null==h||void 0===h.length)return-1;if("string"===typeof h)return t.lastIndexOfLoose(h.split(""),c);for(var f=h.length-1;0<=f;f--)if(h[f]==c)return f;return-1}};return t})},"widgets/BusinessAnalyst/esriAnalystX/utils/ObjectUtil":function(){define(["../../baUtil/ObjectUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/utils/SortUtil"],
function(v,A,B){var t=Object.assign({},v,A,B);t.getPrototypeOf=function(h){try{return Object.getPrototypeOf?Object.getPrototypeOf(h):h.__proto__||h.constructor&&h.constructor.prototype}catch(c){return null}};t.isJson=function(h){return"object"===typeof h&&t.getPrototypeOf(h)===Object.prototype};t.copyJson=function(h){return void 0===h||null===h?null:JSON.parse(JSON.stringify({object:h})).object};t.convert=function(h,c,f){var e=c||function(){};c=e(h);if("undefined"!==typeof c)return c;if(Array.isArray(h)){var d=
[];h.forEach(function(p){d.push(t.convert(p,e,f))},this);return d}if(!t.isJson(h))return h;c={};for(var a in h){var b=h[a],g=f?e(a):a;"undefined"===typeof g&&(g=a);c[g]=t.convert(b,e,f)}return c};t.getDeepCopy=function(h){return t.convert(h)};t.getRange=function(h,c,f){c="function"===typeof c?c.bind(null==f?null:f):null;var e,d;for(d in h)if(f=h[d],f=Number(null===c?f:c(f,d)),!isNaN(f))if(void 0===a)var a=e=f;else a=Math.min(a,f),e=Math.max(e,f);return void 0===a?{}:{min:a,max:e}};t.removeEmptyObjects=
function(h){function c(e){e&&"object"===typeof e&&Object.keys(e).forEach(function(d){var a=e[d];!a||"object"!==typeof a||Array.isArray(a)||Object.keys(a).length?c(a):(f=!0,delete e[d])})}for(var f=!0;f;)f=!1,c(h);return h};t.removeValues=function(h,c){function f(e){e&&"object"===typeof e&&Object.keys(e).forEach(function(d){c(d,e[d])?f(e[d]):delete e[d]})}f(h);return h};t.isEqual=function(h,c){if(null===h||"object"!==typeof h||null===c||"object"!==typeof c)return h===c;if(Object.keys(h).length!==Object.keys(c).length)return!1;
var f={},e;for(e in h)f[e]=!0;for(e in c)if(void 0!==f[e])delete f[e];else return!1;for(e in h)if(!t.isEqual(h[e],c[e]))return!1;return!0};t.getObject=function(h,c){if(!c)return h;c=c.split(".");for(var f=0;f<c.length;f++)h=h&&h[c[f]];return h};t.formatNumber=function(h,c){c="number"===typeof c?{places:c}:c||{};if(null==c.places||0>c.places)c.places=t.getPlaces(h,!0),c.maxPlaces&&c.places>c.maxPlaces&&(c.places=c.maxPlaces);return A.formatNumber(h,c)};t.getPlaces=function(h,c){function f(g,p){var k=
h.indexOf(g,e);if(0>k)return d;g=h.charAt(k+g.length);return!g||0>p.indexOf(g)?d:k-e}h=+h;if(isNaN(h))return-1;h+="";var e=h.indexOf(".")+1,d=e?h.length-e:0;if(2>=d||!c)return d;c=0;if(!+h.substr(0,e-1))for(;"0"===h.charAt(e);)e++,c++,d--;for(var a=d-1;2<=a;a--){var b=Math.min(f("000000000000000".substr(0,a),"01234"),f("999999999999999".substr(0,a),"56789"));if(b!==d){d=b;break}}return d+c};return t})},"widgets/BusinessAnalyst/baUtil/ObjectUtil":function(){define(["require","exports"],function(v,
A){function B(t,h){for(var c=0,f=Object.keys(h);c<f.length;c++){var e=f[c];"object"!==typeof t[e]||null===t[e]||"object"!==typeof h[e]||null===h[e]?t[e]=h[e]:Array.isArray(t[e])?Array.isArray(h[e])?t[e].concat(h[e]):t[e]=h[e]:Array.isArray(h[e])?t[e]=h[e]:B(t[e],h[e])}}return{map:function(t,h,c){void 0!==c&&(h=h.bind(c));if("object"!==typeof t)throw Error("Object or array expected");if(Array.isArray(t)){c=[];for(var f=0,e=t.length;f<e;f++)c.push(h(t[f],f));return c}c={};f=0;for(e=Object.keys(t);f<
e.length;f++){var d=e[f];Object.hasOwnProperty.call(t,d)&&(c[d]=h(t[d],d))}return c},deepAssign:function(t){for(var h=[],c=1;c<arguments.length;c++)h[c-1]=arguments[c];for(c=0;c<h.length;c++)B(t,h[c]);return t}}})},"esri/dijit/geoenrichment/utils/ObjectUtil":function(){define(["dojo/number","./DateUtil"],function(v,A){var B={};Math.log10=Math.log10||function(h){return Math.log(h)*Math.LOG10E};B.populateObject=function(h,c,f){function e(d,a){function b(p){var k=d[p],r=a[p],m=k&&"object"===typeof k;
void 0!==k&&(void 0===r?a[p]=k:r&&"object"===typeof r&&m?e(k,r):f&&(m?(r=a[p]={},e(k,r)):a[p]=d[p]))}if(d&&a&&!(Array.isArray(d)&&!Array.isArray(a)||Array.isArray(a)&&!Array.isArray(d)))if(Array.isArray(d))d.forEach(function(p,k){b(k)});else for(var g in d)b(g)}e(c,h);return h};B.filterByPattern=function(h,c){function f(d,a,b){for(var g in d){var p=d[g],k=a[g];if(Array.isArray(p)){var r=p[0];if(k&&Array.isArray(k)){var m=b[g]=[];k.forEach(function(G){if(G&&"object"===typeof G){var H=Array.isArray(G)?
[]:{};f(r,G,H);m.push(H)}})}}else if("object"===typeof p){if(k&&"object"===typeof k){var u=b[g]={};f(p,k,u)}}else void 0!==k&&(b[g]=k)}}var e={};f(c,h,e);return e};B.traverseObject=function(h,c){for(var f in h){var e=h[f];c(e,f,h);e&&"object"===typeof e&&B.traverseObject(e,c)}};B.copyOwnJsonProperties=function(h,c,f){c=c||{};for(var e in h){var d=h[e];h.hasOwnProperty(e)&&"function"!=typeof d&&(d&&"object"==typeof d&&f&&(d=f(e,d)),void 0!==d&&(c[e]=d))}return c};B.removeUndefinedProperties=function(h){h&&
Object.keys(h).forEach(function(c){void 0===h[c]&&delete h[c]});return h};B.getValue=function(h,c){if("string"!==typeof c)return h;c=c.split(".");for(var f=0;f<c.length;f++)h=h&&h[c[f]];return h};B.setValue=function(h,c,f){if("string"===typeof c&&(c=c.split("."),c.length)){for(var e=0;e<c.length-1;e++)h=h&&h[c[e]];h&&(h[c[c.length-1]]=f)}};B.isNumber=function(h){return!isNaN(parseFloat(h))&&isFinite(h)};B.roundNumber=function(h,c){return"number"!==typeof h?h:parseFloat(h.toFixed(void 0!==c?c:0))};
B.getBestPrecision=function(h){return 0===h?0:Math.max(0,Math.round(Math.log10(3E3/Math.abs(h))))};B.getPlaces=function(h,c){function f(g,p){var k=h.indexOf(g,e);if(0>k)return d;g=h.charAt(k+g.length);return!g||0>p.indexOf(g)?d:k-e}h=+h;if(isNaN(h))return-1;h+="";var e=h.indexOf(".")+1,d=e?h.length-e:0;if(2>=d||!c)return d;c=0;if(!+h.substr(0,e-1))for(;"0"===h.charAt(e);)e++,c++,d--;for(var a=d-1;2<=a;a--){var b=Math.min(f("000000000000000".substr(0,a),"01234"),f("999999999999999".substr(0,a),"56789"));
if(b!==d){d=b;break}}return d+c};B.formatNumber=function(h,c){c="number"===typeof c?{places:c}:c||{};var f=c.places,e={};0<=f?e.places=f:f=-1;e.locale=c.locale||A.getDateNumberLocale();h=v.format(h,e);if(c.noSeparator){e=B.getSeparator();var d;if(e)for(;0<=(d=h.indexOf(e));)h=h.substr(0,d)+h.substr(d+1)}if(c.preserveTrailingZeroes||0>=f||!h)return h;for(c=h.length;0<f&&"0"==h.charAt(c-1);)c--,--f||c--;return h.substr(0,c)};B.formatNumberAsCurrency=function(h,c,f){return c?c.split(";")[0>h?1:0].replace("0",
B.formatNumber(Math.abs(h),f)):B.formatNumber(h,f)};var t;B.getSeparator=function(){void 0===t&&(t=v.format(9999,{places:0}).replace(/9/g,""));return t};B.parseNumber=function(h,c,f,e){if(""===h)return"undefined"!==typeof f?f:NaN;if(null==h||"string"!==typeof h&&isNaN(h))return NaN;h=String(h);if(!h.trim())return void 0!==f?f:NaN;f=v.parse(h,{strict:e,locale:A.getDateNumberLocale()});isNaN(f)&&h.trim().length&&(f=e?v.parse(h,{strict:e,locale:"en-US"}):Number(h));return isNaN(f)||void 0===c||0>c?f:
v.round(f,c)};B.parsePercentOrCurrency=function(h,c,f,e,d){"string"===typeof h&&(h=h.replace("%",""),c&&(c=c.split(";")[0].replace("0",""),h=h.replace(c,"")));return B.parseNumber(h,f,e,d)};B.compareEqual=function(h,c,f){return void 0===f?h===c:Number(Number(h).toFixed(f))===Number(Number(c).toFixed(f))};return B})},"esri/dijit/geoenrichment/utils/DateUtil":function(){define(["dojo/date/locale","esri/moment"],function(v,A){var B={formatDate:function(t,h){t=B.objectToDate(t);h.locale=h.locale||B.getDateNumberLocale();
return t?v.format(t,h):""},formatMoment:function(t,h){return(t=B.objectToTime(t))?A(t).format(h):""},formatDateShort:function(t){return B.formatMoment(t,"L")},formatDateTimeShort:function(t){return B.formatMoment(t,"L LT")},formatLiveTime:function(t){var h=B.formatMoment(t,"l, LT").replace(/\d\d\d\d/,function(c){return c.substr(2)});return h?h+" "+B.formatDate(t,{datePattern:"ZZZZ",selector:"date"}):""},formatTypicalTime:function(t){return B.formatMoment(t,"ddd LT")},parseDateShort:function(t){return(t=
+A(t,"L"))?new Date(t):null},getReportFooterDate:function(t){return v.format(t||new Date,{datePattern:"MMMM d, yyyy",selector:"date"})},getFullYear:function(){return(new Date).getFullYear()},objectToTime:function(t){if(!t)return null;t="string"===typeof t?new Date(t):t;return t.getTime?t.getTime():Number(t)||null},objectToDate:function(t){return t?t.getTime?t:new Date(t):null},getDateNumberLocale:function(){return window.dojoConfig&&window.dojoConfig.extraLocale&&window.dojoConfig.extraLocale[0]||
window.dojo.locale}};return B})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(v,A,B){return B})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(v,A,B,t){Object.defineProperty(A,"__esModule",{value:!0});var h={ar:1,"ar-dz":1,"ar-kw":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bg:1,bs:1,ca:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-il":1,"en-in":1,"en-nz":1,"en-sg":1,
es:1,"es-do":1,"es-mx":1,"es-us":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hr:1,hu:1,id:1,it:1,"it-ch":1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sk:1,sl:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,uk:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-mo":1,"zh-tw":1};A.load=function(c,f,e){c=B.locale;var d=c in h;if(!d){var a=c.split("-");1<a.length&&a[0]in h&&(c=a[0],d=!0)}d?f(["moment/locale/"+c],function(){e(t)}):e(t)}})},"esri/dijit/geoenrichment/utils/SortUtil":function(){define([],function(){function v(h,
c,f,e){h=void 0===h||null===h;return h!=(void 0===c||null===c)?(c=h?-1:1,(void 0===e?f:e)?-c:c):h?0:null}function A(h){var c=/^(.+)\s([1-9]\d*)$/.exec(h);return c?{base:c[1],number:c[2]}:/^[1-9]\d*$/.test(h)?{base:"",number:+h}:{base:h,number:0}}var B={NEWEST:"newest",OLDEST:"oldest",ALPHABETICAL:"alphabetical",UNALPHABETICAL:"unalphabetical",compareNumeric:function(h,c,f,e){e=v(h,c,f,e);if(null!==e)return e;h=Number(h);c=Number(c);e=h>c?1:h<c?-1:0;return f?-e:e},compareString:function(h,c,f,e){e=
v(h,c,f,e);if(null!==e)return e;h=String(h);c=String(c);e=h.localeCompare(c);return f?-e:e}},t=/^(.+)\s([1-9]\d*)(\D*)$/;B.compareNames=function(h,c,f,e){var d=A("string"===typeof h?h.toLowerCase():h),a=A("string"===typeof c?c.toLowerCase():c),b=null;if(d.base===a.base)b=B.compareNumeric(d.number,a.number,f,e);else{var g=t.exec(d.base);if(g){var p=t.exec(a.base);p&&g[1]===p[1]&&g[3]===p[3]&&(b=B.compareNumeric(g[2],p[2],f,e))}null===b&&(b=B.compareString(d.base,a.base,f,e))}return b||B.compareString(h,
c,f,e)};B.compare=function(h,c,f,e){var d=v(h,c,f,e);if(null!==d)return d;d=typeof h;typeof c!=d&&(d="");switch(d){case "number":case "boolean":break;case "object":h=h.valueOf();c=c.valueOf();break;default:return B.compareString(h,c,f,e)}d=h>c?1:h<c?-1:0;return f?-d:d};return B})},"esri/dijit/geoenrichment/utils/ArrayUtil":function(){define(["dojo/_base/array"],function(v){var A={},B={}.toString();A.arraysEqual=function(t,h){if(!t&&!h)return!0;if(!t||!h||t.length!==h.length)return!1;for(var c=0;c<
t.length;c++)if(t[c]!==h[c])return!1;return!0};A.composeIdentityFunction=function(t,h){var c="function"===typeof t?t:t?function(f){return f[t]}:function(f){return f};return function(f){return(f=c(f))&&f.toString?f.toString():h&&void 0===f?f:String(f)}};A.removeDuplicates=function(t,h){var c=[],f={};h=A.composeIdentityFunction(h,!0);v.forEach(t,function(e,d){var a=h(e);a===B&&(void 0===e["__ArrayUtil.js_uniqueKey__"]&&(e["__ArrayUtil.js_uniqueKey__"]="__ArrayUtil.js_uniqueKey__"+d),a=e["__ArrayUtil.js_uniqueKey__"]);
void 0===a||a in f||(f[a]=e,c.push(e))});return c};A.splitArrayToBunches=function(t,h){h=h||100;for(var c=[],f,e=0,d=t.length;e<d;e++)f&&f.length!==h||(f=[],c.push(f)),f.push(t[e]);return c};return A})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DomUtil":function(){define("dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/on ../../utils/ObjectUtil esri/dijit/geoenrichment/utils/DomUtil".split(" "),function(v,A,B,t,h,c,f){var e=Object.assign({},f);e.select=function(d){return e.addTag(d,
"selected")};e.unselect=function(d){return e.removeTag(d,"selected")};e.floatStart=function(d){return e.addTag(d,"esriMapsAnalystXFloatStart")};e.floatEnd=function(d){return e.addTag(d,"esriMapsAnalystXFloatEnd")};e.addSpacer=function(d,a){d=v.create("div",{"class":"esriMapsAnalystXSpacer",innerHTML:"\x26nbsp;"},d);if(a)e[a](d);return d};e.getAndUpdateNumber=function(d,a){if(!d)return NaN;var b=d.get&&d.set;void 0===a&&(a=0);var g=c.parseNumber(b?d.get("value"):d.value,a);isNaN(g)||(b?d.set("value",
c.formatNumber(g,a)):d.value=c.formatNumber(g,a));return g};e.getAndUpdateString=function(d){if(!d)return null;if(d.get&&d.set){var a=d.get("value").trim();d.set("value",a)}else a=d.value.trim(),d.value=a;return a};e.getScreenScaleFactor=function(){return e.getTextBox("",{style:"width: 72pt; height: 72pt"}).w/96};e.positionAtCenter=function(d,a){if(d&&a){var b=A.position(d);a=A.position(a);b.w&&b.h&&a.w&&a.h&&B.set(d,{left:(a.w-b.w)/2+"px",top:(a.h-b.h)/2+"px"})}};e.showAroundOverlay=function(d,a){a=
a||{};e.removeAroundOverlay(d);var b={w:"width",h:"height",l:"left",t:"top",r:"right",b:"bottom"},g=A.position(d);if(a.viewPortContainer){var p=A.position(a.viewPortContainer),k=g.x,r=g.y;g.x=Math.max(g.x,p.x);g.w-=g.x-k;g.y=Math.max(g.y,p.y);g.h-=g.y-r;g.w=Math.min(g.w,p.x+p.w-g.x);g.h=Math.min(g.h,p.y+p.h-g.y)}d.__aroundOverlays=(a.placeInNode?[{l:0,t:-g.y,w:g.w,h:g.y},{l:g.w,t:-g.y,w:document.body.clientWidth-(g.x+g.w),h:document.body.clientHeight},{l:0,t:g.h,w:g.w,h:document.body.clientHeight-
(g.y+g.h)},{l:-g.x,t:-g.y,w:g.x,h:document.body.clientHeight}]:[{l:g.x,t:0,w:g.w,h:g.y},{w:document.body.clientWidth-(g.x+g.w),r:0,t:0,b:0},{l:g.x,h:document.body.clientHeight-(g.y+g.h),w:g.w,b:0},{l:0,t:0,w:g.x,b:0}]).map(function(u){var G=v.create("div",{"class":a.overlayClass||"esriMapsAnalystXNodeAroundOverlay"},a.placeInNode?d:document.body),H={position:"absolute"},C;for(C in b)void 0!==u[C]&&(H[b[C]]=Math.round(u[C])+"px");B.set(G,H);return G});g=function(){e.removeAroundOverlay(d)};a.removeOnClick&&
(d.__aroundOverlaysRemoveHandle=h.once(document.body,"click",g));d.__aroundOverlaysResizeHandle=h(window,"resize",function(){e.showAroundOverlay(d,a)});var m;d.__aroundOverlaysSetIntervalHandle=setInterval(function(){if(m){var u=A.position(d);u.x==m.x&&u.y==m.y&&u.w==m.w&&u.h==m.h||e.showAroundOverlay(d,a)}else m=A.position(d)},50);return{remove:g}};e.removeAroundOverlay=function(d){d.__aroundOverlays&&d.__aroundOverlays.forEach(function(a){v.destroy(a)});delete d.__aroundOverlays;d.__aroundOverlaysRemoveHandle&&
d.__aroundOverlaysRemoveHandle.remove();delete d.__aroundOverlaysRemoveHandle;d.__aroundOverlaysResizeHandle&&d.__aroundOverlaysResizeHandle.remove();delete d.__aroundOverlaysResizeHandle;clearInterval(d.__aroundOverlaysSetIntervalHandle);delete d.__aroundOverlaysSetIntervalHandle};e.getDocumentStyleDeclaration=function(d){function a(p){try{var k=p.rules||p.cssRules}catch(m){k=null}if(k)for(p=0;p<k.length;p++){var r=k[p];if(r.styleSheet){if(r=a(r.styleSheet))return r}else if(r.selectorText==d)return r.style}}
for(var b=0;b<document.styleSheets.length;b++){var g=a(document.styleSheets[b]);if(g)return g}return null};e.getNodeFontFamily=function(d){return(d=B.get(d,"fontFamily")||B.getComputedStyle(d)["font-family"])?d.replace(/'|"/g,"").split(",")[0]:d};e.getNodeFontSize=function(d){return B.toPixelValue(d,B.get(d,"fontSize"))};e.listenToNodeAdded=function(d,a,b){if(e.isNodeInLayout(d))a();else{d.__listenToNodeAddedHandle&&d.__listenToNodeAddedHandle.remove();var g=setInterval(function(){e.isNodeInLayout(d)&&
(d.__listenToNodeAddedHandle&&d.__listenToNodeAddedHandle.remove(),a())},b||100);d.__listenToNodeAddedHandle={remove:function(){clearInterval(g);delete d.__listenToNodeAddedHandle}};return d.__listenToNodeAddedHandle}};e.isNodeVisible=function(d){return e.isChildOf(d,document.body,function(a){return!t.contains(a,"dijitHidden")&&"hidden"!=B.get(a,"visibility")})};e.enableHyperlink=function(d,a){a?t.replace(d,"esriMapsAnalystXLink","esriMapsAnalystXLinkDisabled"):t.replace(d,"esriMapsAnalystXLinkDisabled",
"esriMapsAnalystXLink")};return e})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/MouseUtil":function(){define(["dojo/dom-geometry","esri/dijit/geoenrichment/utils/MouseUtil"],function(v,A){var B;A.unitTesting_setCursorOverNode=function(t){t=v.position(t);A.unitTesting_setCursorPosition(t.x+t.w/2,t.y+t.h/2)};A.unitTesting_setCursorPosition=function(t,h){A._latestEvent={clientX:t,pageX:t,clientY:h,pageY:h}};A.unitTesting_lockPosition=function(t){B=t};A.unitTesting_shiftMousePosition=function(t,
h){A.unitTesting_setCursorPosition(A._latestEvent.clientX+(t||0),A._latestEvent.clientY+(h||0))};A._setLatestEvent=function(t){B||(A._latestEvent=t)};return A})},"esri/dijit/geoenrichment/utils/MouseUtil":function(){define("dojo/_base/lang dojo/on dojo/sniff dojo/touch dojo/dom-geometry ./DomUtil dojo/domReady!".split(" "),function(v,A,B,t,h,c){var f={_latestEvent:null,_setLatestEvent:function(b){f._latestEvent=b},_getLatestEvent:function(){return f._latestEvent}};B("touch")?(A(document.body,t.press,
function(b){f._setLatestEvent(a(b))}),A(document.body,t.move,function(b){f._setLatestEvent(a(b))})):A(document.body,"mousemove",function(b){f._setLatestEvent(a(b))});var e;A(document.body,"mousedown",function(){e||(e=!0,A.once(document.body,"mouseup, click",function(){e=!1}))});f.getCursorPosition=function(){return f._latestEvent};f.isMouseOver=function(b,g){var p=g&&g.event||f._latestEvent;if(!(b&&b.parentNode&&b.getBoundingClientRect&&p))return!1;if(g&&g.checkAllChildren){g=v.mixin({},g);delete g.checkAllChildren;
var k=!1;c.traverseChildren(b,function(r){if(f.isMouseOver(r,g))return k=!0});return k}return f.isMouseOverBox(h.position(b),g)};f.isMouseOverBox=function(b,g){if(!b)return!1;var p=g&&g.event||f._latestEvent;g&&g.ignoreBorderTolerance&&(g=g.ignoreBorderTolerance,b=v.mixin({},b),b.x+=g,b.y+=g,b.w-=2*g,b.h-=2*g);return b.x<=p.clientX&&b.x+b.w>=p.clientX&&b.y<=p.clientY&&b.y+b.h>=p.clientY};var d=function(b){if(b.touches){if(!b.touches.length)return b.changedTouches[0];for(var g=b.touches[0].identifier,
p,k=0;k<b.changedTouches.length;k++)if(b.changedTouches[k].identifier===g){p=b.changedTouches[k];break}return p||b.touches[0]}},a=function(b){var g=d(b);g&&(g.type=b.type);return g||b};f.fixTouchEvent=function(b){var g=d(b);g&&(b.screenX=g.screenX,b.screenY=g.screenY,b.clientX=g.clientX,b.clientY=g.clientY,b.pageX=g.pageX,b.pageY=g.pageY);return b};f.isBeingDragged=function(){return e};f.addOverOutHandler=function(b){function g(){clearTimeout(k);p&&p.remove()}var p,k,r=A(b.node,"mouseover",function(m){function u(){f.isMouseOver(b.node)&&
(b.onMouseOver(m),p=A(document.body,"mousemove",function(G){f.isMouseOver(b.node)||(g(),b.onMouseOut(G))}))}g();b.delayTimeout?k=setTimeout(u,b.delayTimeout):u()});return{remove:function(){r.remove();g()}}};f.addOutHandler=function(b,g){return A(document.body,"mousemove",function(p){f.isMouseOver(b,{checkAllChildren:!0})||g(p)})};return f})},"widgets/BusinessAnalyst/esriAnalystX/dijit/tooltips/TooltipUtil":function(){define("dojo/dom-construct dojo/dom-style dojo/dom-geometry dojo/dom-class dojo/query dojo/on dojox/gfx dojo/sniff dojo/aspect dojox/uuid/generateRandomUuid dijit/Tooltip ../utils/DomUtil ../utils/MouseUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/domReady!".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k){function r(){D&&(D.isMultilineContainer?C.hideTooltipForNode(D):(clearInterval(D.__autoTooltipInLayoutCheckHandle),delete D.__autoTooltipInLayoutCheckHandle,b.hide(D)),D=null)}function m(z,y){y=y||"";var x=v.create("div",{class:"esriMapsAnalystXValidationTooltip"+y},document.body);!y&&v.create("div",{class:"esriMapsAnalystXValidationTooltipTip"+y},x);v.create("div",{innerHTML:z,class:"esriMapsAnalystXValidationTooltipBody"+y},x);A.set(x,"position","fixed");return x}
function u(z,y){function x(){z&&(document.body.removeChild(z),F.forEach(function(J){J.remove()}),z=F=null)}y=y.textbox||y;var n=B.getMarginBox(z),q=B.position(y);"rtl"===document.dir?A.set(z,{left:q.x-n.w+"px",top:q.y+q.h/2-n.h/2+"px"}):A.set(z,{left:q.x+q.w+"px",top:q.y+q.h/2-n.h/2+"px"});var F=[c(document.body,"mousedown, keydown",x),c(y,"blur",x)];return{remove:x}}function G(z,y,x){function n(){var w=v.create("div",{class:"esriMapsAnalystXClosableTooltipTip"},F);t.add(w,"right"===x?"esriMapsAnalystXClosableTooltipTipRight":
"esriMapsAnalystXClosableTooltipTipLeft")}function q(){J=v.create("div",{class:"esriMapsAnalystXClosableTooltipBody"},F);v.create("div",{innerHTML:z,class:"esriMapsAnalystXClosableTooltipLabel"},J);l=v.create("div",{class:"esriMapsAnalystXClosableTooltipCloseButton esriMapsAnalystXCloseWindow esriMapsAnalystXCloseWindowWhite"},J)}y={class:"esriMapsAnalystXClosableTooltip "+(y||"")};y.id=a();var F=v.create("div",y,document.body),J,l;"right"!==x?(q(),n()):(n(),q());A.set(F,"position","fixed");return{tooltip:F,
body:J,closeButton:l}}function H(z,y,x,n){var q=B.getMarginBox(z.tooltip),F=B.position(y);"rtl"===document.dir&&"right"!==n||"rtl"!==document.dir&&"right"===n?A.set(z.tooltip,{left:F.x+F.w+"px",top:F.y+F.h/2-q.h/2+"px"}):A.set(z.tooltip,{left:F.x-q.w+"px",top:F.y+F.h/2-q.h/2+"px"});var J,l=function(){J&&clearTimeout(J);w&&clearInterval(w);I&&I.remove();z.tooltip.parentNode===document.body&&document.body.removeChild(z.tooltip)};var w=setInterval(function(){g.isNodeInLayout(y)||l();g.isNodeVisible(y)?
g.show(z.tooltip):g.hide(z.tooltip)},300);x&&(J=setTimeout(l,x));var I=c(z.closeButton,"click",function(){l()});z.tooltip._removeFunc=l;return z.tooltip}var C={},E={};C.hideTooltipForNode=k.hideTooltipForNode;C.setTooltipToNode=k.setTooltipToNode;C.createTooltip=function(z,y,x){var n={orientation:B.isBodyLtr(document)?"right":"left",offset:{x:15,y:0}};y&&(n.innerHTML=y);x&&(n=Object.assign(n,x));n.id=a();n.toMouseCursor&&(n.mouseEvent=p.getCursorPosition(),delete n.toMouseCursor);y=n.mouseEvent;delete n.mouseEvent;
x=n.htmlFragment;delete n.htmlFragment;var q=n.widget;delete n.widget;var F=n.orientation;delete n.orientation;var J=n.offset;delete n.offset;var l=n.horizontalOffset;delete n.horizontalOffset;var w=v.create("div",n,z?z.container:document.body);x?v.place(x,w):q&&q.placeAt(w);A.set(w,"position","fixed");var I=B.getMarginBox(w),M=function(L,P){var O=L.touches?event.touches[0].clientX:L.clientX;L=L.touches?event.touches[0].clientY:L.clientY;var Q,N,R=J.x,S=J.y;"left"===F?0>O-I.w-R&&(Q="right"):O+I.w+
R>document.body.clientWidth&&(Q="left");L+I.h+S>document.body.clientHeight&&(N="above");Q=Q||F;A.set(w,{left:P?P+"px":O+("left"===Q?-I.w-R:R)+"px",top:L+("above"===N?-I.h-S:S)+"px"});w.style.display=""};y&&M(y,l);n=[];n.push(c(z?z:document.body,z?"mouse-move, mousemove":"mousemove, touchmove",function(L){M(L,l)}));n.push(c(z?z:document.body,z?"mouse-out, mouseout":"mouseout, touchend",function(L){w.style.display="none"}));z={};z.handlers=n;z.tooltip=w;E[w.id]=z;return w};C.removeTooltip=function(z){if(z){z=
"string"===typeof z?z:z.id;var y=E[z];delete E[z];y&&(y.handlers.forEach(function(x){x.remove()}),v.destroy(y.tooltip))}};var K={};C.registerTooltipForSlider=function(z,y,x,n){var q={offsetX:0,offsetY:0,class:"esriMapsAnalystXTooltip"};y&&(q=Object.assign(q,y));q.id=a();var F=v.create("div",q,document.body);F.style.display="none";A.set(F,"position","fixed");var J=!1,l=function(I,M){if(!J){J=!0;F.style.display="";F.innerHTML=M();var L=B.getMarginBox(F),P=B.position(I);A.set(F,{left:P.x+P.w/2-L.w/2+
q.offsetX+"px",top:P.y-L.h-5+q.offsetY+"px"});var O=[];O.push(d.after(z,"onChange",function(){F.innerHTML=M();P=B.position(I);A.set(F,{left:P.x+P.w/2-L.w/2+"px",top:P.y-L.h-5+"px"})}));var Q=function(){F.style.display="none";O.forEach(function(R){R.remove()});J=!1},N=!1;O.push(c(I,"mousedown, mouseDown, mouse-down",function(){N=!0;O.push(c(document,"mouseup, mouseUp, mouse-up",function(){Q()}))}));O.push(c(I,"mouseout, mouseOut, mouse-out",function(){N||Q()}))}};y=[];y.push(c(z.sliderHandle,"mouseover, mouseOver, mouse-over",
function(){n&&z.isSliderDisabled&&z.isSliderDisabled()||l(z.sliderHandle,function(){var I=n?z.get("value")[0]:z.get("value");return x?x(I):I})}));n&&y.push(c(z.sliderHandleMax,"mouseover, mouseOver, mouse-over",function(){z.isSliderDisabled&&z.isSliderDisabled()||l(z.sliderHandleMax,function(){return x?x(z.get("value")[1]):z.get("value")[1]})}));y.push(d.before(z,"destroy",function(){C.unregisterTooltipForSlider(z)}));z.tooltipId=F.id;var w={};w.tooltip=F;w.handlers=y;K[F.id]=w};C.unregisterTooltipForSlider=
function(z){var y=K[z.tooltipId];y&&(y.handlers.forEach(function(x){x.remove()}),v.destroy(y.tooltip));delete K[z.tooltipId];delete z.tooltipId};var D=null;C.autoTooltip=function(z,y,x){"string"===typeof y&&(y=y.split(" ").filter(function(q){return q&&!!q.trim().length}));y=y||[];y.push("TrimWithEllipses");x=x||[];x.push("esriMapsAnalystXInfoIcon");for(var n=0;n<y.length;n++)c(z,"."+y[n]+":mouseover, "+y[n]+":touchstart, ",function(q){this!==D&&this.offsetWidth<this.scrollWidth&&!this.noAutoTooltip&&
(q=getComputedStyle(this).width,q=Number(q.substr(0,q.length-2)),0>q-Math.round(q)&&this.offsetWidth==this.scrollWidth-1||(r(),D=this,q=D.autoTooltip||D.textContent||D.value,D.title&&(q+=" ("+D.title+")"),q&&b.show(q,D,["above","below"]),c.once(D,"mouseout, touchstart, touchout",function(){r()}),D.__autoTooltipInLayoutCheckHandle=setInterval(function(){g.isNodeInLayout(D)||r()},500)))});if(e("touch"))for(n=0;n<x.length;n++)c(z,"."+x[n]+":touchstart ",function(q){this!==D&&(D=this,D.title&&(b.show(D.title,
D,["above","below"]),c.once(D,"touchstart, touchout",function(){b.hide(D);D=null})))})};C.addAutoTooltipsToTabContainer=function(z){h(".tabLabel",z.domNode).forEach(function(y){t.add(y,"TrimWithEllipses")});C.autoTooltip(z)};C.setMultilineText=function(z,y,x,n){x=x||2;y=y.trim();n=n||["above","below"];t.remove(z,"TrimWithEllipses");z.style.overflow="hidden";z.innerHTML="";for(var q=y,F=!1;q;){x--;var J=v.create("div",null,z);J.style.overflow="hidden";J.style.whiteSpace="nowrap";for(var l=q;l;)if(J.textContent=
l,J.offsetWidth<J.scrollWidth-1)l=(l=l.match(/^(.*[^\s]+)\s+[^\s]+$/))&&l[1]||"";else break;!l||!x&&l!==q?(J.textContent=q,q="",J.style.textOverflow="ellipsis",F=!0):q=q.substr(l.length).trim()}F&&C.setTooltipToNode(z,function(){r();D=z;D.isMultilineContainer=!0;return y},{position:n})};C.showErrorTip=function(z,y){return u(m(y),z.domNode||z)};C.showNewStyleErrorTip=function(z,y,x){return u(m(y,"NewStyle"+(x?" esriMapsAnalystXWarningStyle":"")),z.domNode||z)};C.showAlertTooltip=function(z){z&&z.node&&
z.message&&(b.show(z.message,z.node,z.position||["above","below"]),setTimeout(function(){b.hide(z.node)},z.timeout||5E3))};C.showClosableTooltip=function(z){var y=G(z.message,z.tooltipClass,z.position);return H(y,z.component,z.timeout,z.position)};C.removeClosableTooltip=function(z){z&&z._removeFunc&&z._removeFunc()};C.showClosableTooltipOnVerticalBracket=function(z){var y=z.below||z.above,x=B.position(z.above,!0),n=B.position(y,!0),q="rtl"!==document.dir?"start"===z.direction:"end"===z.direction,
F=x.x+x.w*(q?0:1);x=x.y;var J=n.y+n.h,l=v.create("div",{class:"esriMapsAnalystFlexibleTooltip_tooltip esriMapsAnalystXNonSelectable"},document.body),w=v.create("div",{class:"esriMapsAnalystFlexibleTooltip_surfaceContainer"},l);n={};F={top:x-2,left:F+(q?-3:3),height:J-x+4,width:10};for(var I in F)n[I]=F[I]+"px";A.set(l,n);var M=f.createSurface(w,F.width,F.height);M.clear();M.createPolyline([{x:q?F.width:0,y:0},{x:q?0:F.width,y:0},{x:q?0:F.width,y:F.height},{x:q?F.width:0,y:F.height}]).setStroke({color:"#6E6E6E",
width:6});z.component=l;q=G(z.message,z.tooltipClass,z.position);var L=function(){clickHandler&&clickHandler.remove();P&&clearInterval(P);M&&M.clear();v.destroy(w);v.destroy(l)},P=setInterval(function(){g.isNodeInLayout(y)||L();g.isNodeVisible(y)?A.set(l,"visibility","visible"):A.set(l,"visibility","hidden")},300);z.timeout&&setTimeout(L,z.timeout);clickHandler=c(q.closeButton,"click",L);tooltip=H(q,z.component,z.timeout,z.position);var O=tooltip._removeFunc;tooltip._removeFunc=function(){O();L()};
return tooltip};return C})},"dojox/uuid/generateRandomUuid":function(){define(["./_base"],function(){dojox.uuid.generateRandomUuid=function(){function v(){for(var c=Math.floor(Math.random()%1*Math.pow(2,32)).toString(16);8>c.length;)c="0"+c;return c}var A=v(),B=v();B=B.substring(0,4)+"-4"+B.substring(5,8);var t=v();t="8"+t.substring(1,4)+"-"+t.substring(4,8);var h=v();return(A+"-"+B+"-"+t+h).toLowerCase()};return dojox.uuid.generateRandomUuid})},"dojox/uuid/_base":function(){define(["dojo/_base/kernel",
"dojo/_base/lang"],function(v){v.getObject("uuid",!0,dojox);dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};dojox.uuid.assert=function(A,B){if(!A)throw B||(B="An assert statement failed.\nThe method dojox.uuid.assert() was called with a 'false' value.\n"),Error(B);};dojox.uuid.generateNilUuid=function(){return dojox.uuid.NIL_UUID};
dojox.uuid.isValid=function(A){A=A.toString();var B=v.isString(A)&&36==A.length&&A==A.toLowerCase();if(B){A=A.split("-");B=5==A.length&&8==A[0].length&&4==A[1].length&&4==A[2].length&&4==A[3].length&&12==A[4].length;for(var t in A){var h=parseInt(A[t],16);B=B&&isFinite(h)}}return B};dojox.uuid.getVariant=function(A){if(!dojox.uuid._ourVariantLookupTable){var B=dojox.uuid.variant,t=[];t[0]=B.NCS;t[1]=B.NCS;t[2]=B.NCS;t[3]=B.NCS;t[4]=B.NCS;t[5]=B.NCS;t[6]=B.NCS;t[7]=B.NCS;t[8]=B.DCE;t[9]=B.DCE;t[10]=
B.DCE;t[11]=B.DCE;t[12]=B.MICROSOFT;t[13]=B.MICROSOFT;t[14]=B.UNKNOWN;t[15]=B.UNKNOWN;dojox.uuid._ourVariantLookupTable=t}A=A.toString();A=A.charAt(19);A=parseInt(A,16);dojox.uuid.assert(0<=A&&16>=A);return dojox.uuid._ourVariantLookupTable[A]};dojox.uuid.getVersion=function(A){dojox.uuid.assert(dojox.uuid.getVariant(A)==dojox.uuid.variant.DCE,"dojox.uuid.getVersion() was not passed a DCE Variant UUID.");A=A.toString();A=A.charAt(14);return parseInt(A,16)};dojox.uuid.getNode=function(A){dojox.uuid.assert(dojox.uuid.getVersion(A)==
dojox.uuid.version.TIME_BASED,"dojox.uuid.getNode() was not passed a TIME_BASED UUID.");A=A.toString();return A.split("-")[4]};dojox.uuid.getTimestamp=function(A,B){dojox.uuid.assert(dojox.uuid.getVersion(A)==dojox.uuid.version.TIME_BASED,"dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.");A=A.toString();B||(B=null);switch(B){case "string":case String:return dojox.uuid.getTimestamp(A,Date).toUTCString();case "hex":var t=A.split("-");A=t[0];B=t[1];t=t[2];t=t.slice(1);A=t+B+A;dojox.uuid.assert(15==
A.length);return A;case null:case "date":case Date:return t=A.split("-"),A=parseInt(t[0],16),B=parseInt(t[1],16),t=(parseInt(t[2],16)&4095)<<16,t=4294967296*(t+B),t+=A,new Date(t/1E4-122192928E5);default:dojox.uuid.assert(!1,"dojox.uuid.getTimestamp was not passed a valid returnType: "+B)}};return dojox.uuid})},"esri/dijit/geoenrichment/utils/TooltipUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/on dojo/mouse dojo/sniff dijit/Tooltip dijit/place dojox/gfx ./DeviceUtil ./DnDUtil ./DomUtil ./MouseUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/domReady!".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k,r,m,u){function G(){}var H={},C=v(a._MasterTooltip,{_customClasses:null,_customStyle:null,_orientKey:null,addCustomClasses:function(x){x&&(B.add(this.domNode,x),this._customClasses=x)},setCustomStyle:function(x){this._customStyle=x},show:function(x,n,q,F,J,l,w){if(!this.aroundNode||this.aroundNode!==n||this.containerNode.innerHTML!=x)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{"string"===typeof x?this.containerNode.innerHTML=x:(this.containerNode.innerHTML=
"",t.place(x.domNode||x,this.containerNode));J&&this.set("textDir",J);this.containerNode.align=F?"right":"left";var I=b.around(this.domNode,n,q&&q.length?q:a.defaultPosition,!F,A.hitch(this,"orient")),M=I.aroundNodePos;"M"==I.corner.charAt(0)&&"M"==I.aroundCorner.charAt(0)?(this.connectorNode.style.top=M.y+(M.h-this.connectorNode.offsetHeight>>1)-I.y+"px",this.connectorNode.style.left=""):"M"==I.corner.charAt(1)&&"M"==I.aroundCorner.charAt(1)?this.connectorNode.style.left=M.x+(M.w-this.connectorNode.offsetWidth>>
1)-I.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");this._drawBackground();this.domNode.style.opacity="0";this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=n;this.onMouseEnter=l||G;this.onMouseLeave=w||G}},orient:function(x,n,q,F,J){this.connectorNode.style.top="";var l=F.h;F=F.w;x.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft",
"TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[this._orientKey=n+"-"+q];this.addCustomClasses(this._customClasses);this.domNode.style.width="auto";var w=h.position(this.domNode);w.w=Math.ceil(w.w);if(d("ie")||d("trident"))w.w+=2;h.setMarginBox(this.domNode,{w:Math.min(Math.max(F,1),w.w)});"B"==q.charAt(0)&&"B"==n.charAt(0)?(x=h.position(x),n=this.connectorNode.offsetHeight,
x.h>l?(this.connectorNode.style.top=l-(J.h+n>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(J.h/2-n/2,0),x.h-n)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");this._drawBackground();return Math.max(0,w.w-F)},_surface:null,_surfaceContainer:null,_drawBackground:function(){if(this._orientKey){var x=this.domNode.clientWidth,n=this.domNode.clientHeight,q=h.position(this.domNode),F=h.position(this.connectorNode),
J=h.position(this.containerNode);F.x-=q.x;F.y-=q.y;J.x-=q.x;J.y-=q.y;J.x+=1;J.y+=1;J.w-=2;J.h-=2;this._surface&&this._surface.destroy();this._surfaceContainer&&t.destroy(this._surfaceContainer);q=this._surfaceContainer=t.create("div",{"class":"esriGEAbsoluteStretched"},this.domNode,"first");q.style.pointerEvents="none";x=this._surface=g.createSurface(q,x,n);n=[{x:J.x,y:J.y},{x:J.x+J.w,y:J.y},{x:J.x+J.w,y:J.y+J.h},{x:J.x,y:J.y+J.h},{x:J.x,y:J.y}];q=F.x+F.w/2;F=F.y+F.h/2;switch(this._orientKey){case "BL-TL":case "BM-TM":case "BR-TR":J=
[{x:q-5,y:J.y},{x:q,y:F},{x:q+5,y:J.y}];n.splice.apply(n,[1,0].concat(J));break;case "ML-MR":case "BL-BR":J=[{x:J.x+J.w,y:F-5},{x:q,y:F},{x:J.x+J.w,y:F+5}];n.splice.apply(n,[2,0].concat(J));break;case "TM-BM":case "TL-BL":case "TR-BR":J=[{x:q+5,y:J.y+J.h},{x:q,y:F},{x:q-5,y:J.y+J.h}];n.splice.apply(n,[3,0].concat(J));break;case "MR-ML":case "BR-BL":J=[{x:J.x,y:F+5},{x:q,y:F},{x:J.x,y:F-5}],n.splice.apply(n,[4,0].concat(J))}J=x.createPolyline(n);F="function"===typeof this._customStyle?this._customStyle():
this._customStyle;J.setFill(F&&F.backgroundColor||"white").setStroke({color:"#d3d3d3",width:1,join:"round"});F&&F.color&&(this.containerNode.style.color=F.color)}}}),E={show:function(x,n,q,F,J){"string"===typeof q&&(q=[q]);q=q&&q.map(function(w){return{after:"after-centered",before:"before-centered"}[w]||w});var l=new C;J&&l.setCustomStyle(J);l.addCustomClasses(F);l.show(x,n,q);return l}};H.setTooltipToNode=function(x,n,q){function F(){!J&&H.showTooltipForNode(x,n,q)}q=q||{};if(x&&!u.isPlayerOnServer&&
(H.hideTooltipForNode(x),x.__setTooltipToNodeMouseEnterHandle&&x.__setTooltipToNodeMouseEnterHandle.remove(),n)){var J=!1;p.isMobileDevice()?x.__setTooltipToNodeMouseEnterHandle=k.addNoDragClickHandler(x,F):x.__setTooltipToNodeMouseEnterHandle=f(x,e.enter,F);q.showTooltip&&F();return{remove:function(){n=null;H.hideTooltipForNode(x)},suspend:function(){H.hideTooltipForNode(x);J=!0},resume:function(){J=!1},refresh:function(){x._shownTooltip&&F()}}}};H.showTooltipForNode=function(x,n,q){function F(){H.hideTooltipForNode(x);
var I=Array.isArray(q.classes)?q.classes.join(" "):q.classes;I=(I||"")+" esriGETooltip";q.notRestricted&&(I+=" notRestricted");x._shownTooltip=l=E.show(J,x,q.position||["after","before"],I,q.style)}q=q||{};if(x&&!u.isPlayerOnServer){x.title="";H.hideTooltipForNode(x);var J="function"==typeof n?n():n;if(J){"string"===typeof J&&q.textAlign&&(J="\x3cdiv class\x3d'"+("start"===q.textAlign?"esriGEStart":"end"===q.textAlign?"esriGEEnd":"")+"'\x3e"+J+"\x3c/div\x3e");B.add(x,"esriGESimpleTextTooltip");var l;
F();var w=H.hideTooltipForNode.bind(H,x);n=function(I,M){var L=setInterval(I,M);l.own({remove:function(){clearInterval(L)}})};p.isMobileDevice()?l.own(f(document.body,"touchstart",function(I){!m.isMouseOver(x,{event:I})&&w()})):l.own(f.once(x,e.leave,function(){!q.stayOnHover&&w()}));q.ignoreNodeRemoval||n(function(){!r.isNodeInLayout(x)&&w()},300);p.isMobileDevice()||(n(function(){q.stayOnHover&&m.isMouseOver(l.domNode)||m.isMouseOver(x)||w()},300),l.own(f(x,"click",function(I){q.hideOnClick?w():
!x._shownTooltip&&F()})),q.stayOnHover&&l.own(f(l.domNode,e.leave,w)));return x._shownTooltip}}};H.hideTooltipForNode=function(x){x&&x._shownTooltip&&(B.remove(x,"esriGESimpleTextTooltip"),x._shownTooltip.destroy(),delete x._shownTooltip)};var K,D;H.autoTooltip=function(x){u.isPlayerOnServer||f(x,".TrimWithEllipses:mouseover",function(){if(this!==K&&this.offsetWidth<this.scrollWidth){var n=function(){K=null;D&&(D.tooltip.destroy(),D.mouseOutH.remove(),D.mouseMoveH.remove(),D=null)};n();K=this;D={tooltip:E.show(K.textContent,
K,["above","below"]),mouseOutH:f.once(K,"mouseout, mousedown, touchstart",n),mouseMoveH:f(document.body,"mousemove",function(){m.isMouseOver(K)||n()})}}})};H.showClosableTooltip=function(x){var n="rtl"===document.dir&&"after"!==x.position||"rtl"!==document.dir&&"after"===x.position,q=z(x.message,x.tooltipClass,x.position,n);return y(q,x.node,x.timeout,n,x.onClosed)};H.removeClosableTooltip=function(x){x&&x._removeFunc&&x._removeFunc()};var z=function(x,n,q,F){function J(){var L=t.create("div",{"class":"esriGEClosableTooltipTip"},
w);B.add(L,F?"esriGEClosableTooltipTipRight":"esriGEClosableTooltipTipLeft")}function l(){I=t.create("div",{"class":"esriGEClosableTooltipBody"},w);t.create("div",{innerHTML:x,"class":"esriGEClosableTooltipLabel"},I);M=t.create("div",{"class":"esriGEClosableTooltipCloseButton"},I)}var w=t.create("div",{"class":"esriGEClosableTooltip esriGENonSelectable"+(n?" "+n:"")},document.body),I,M;"after"!==q?(l(),J()):(J(),l());w.style.position="fixed";return{tooltip:w,body:I,closeButton:M}},y=function(x,n,
q,F,J){function l(){var N=h.position(n),R=N.x+";"+N.y+";"+N.w+";"+N.h;R!==w&&(w=R,R=h.getMarginBox(x.tooltip),c.set(x.tooltip,{left:(F?N.x+N.w:N.x-R.w)+"px",top:N.y+N.h/2-R.h/2+"px"}))}var w;l();var I,M,L=function(){I&&clearTimeout(I);P&&clearInterval(P);O&&clearInterval(O);Q&&Q.remove();x.tooltip.parentNode&&x.tooltip.parentNode.removeChild(x.tooltip)};var P=setInterval(function(){r.isNodeInLayout(n)&&n.parentNode||(M=!1,L());r.isNodeVisible(n)&&r.isNodeOnscreen(n)?(M=!0,r.show(x.tooltip)):(M=!1,
r.hide(x.tooltip))},0);var O=setInterval(function(){M&&l()},0);q&&(I=setTimeout(L,q));var Q=f(x.closeButton,"click",function(){L();J&&J()});x.tooltip._removeFunc=L;return x.tooltip};H.showTooltipForNode(document.body,"Normal \x3cb\x3eBold\x3c/b\x3e \x3ci\x3eItalic\x3c/i\x3e",{});H.hideTooltipForNode(document.body);return H})},"esri/dijit/geoenrichment/utils/DnDUtil":function(){define(["dojo/on","dojo/sniff","./DeviceUtil","./KeyboardUtil"],function(v,A,B,t){var h={MOBILE_TOLERANCE:10,LONG_PRESS_TIMEOUT:500,
addNoDragClickHandler:function(c,f,e){e=e||{};return B.isMobileDevice()?h._addMobile(c,f,e):h._addPC(c,f,e)},_addPC:function(c,f,e){var d=e.tolerance||0,a,b,g=v(c,"mousedown",function(p){b&&b.remove();var k=p.clientX,r=p.clientY,m;a=v(document.body,"mousemove",function(u){if(!u.shiftKey&&!t.isCtrl(u)){var G=u.clientY;if(0<Math.abs(u.clientX-k)||0<Math.abs(G-r))m=!0}});b=v.once(document.body,"mouseup",function(u){a.remove();var G=u.clientX,H=u.clientY;!m&&Math.abs(G-k)<=d&&Math.abs(H-r)<=d&&f(u)})});
return{remove:function(){a&&a.remove();b&&b.remove();g&&g.remove()}}},_addMobile:function(c,f,e){function d(){b&&b.remove();g&&g.remove();p&&p.remove();clearTimeout(k)}var a=e.tolerance||h.MOBILE_TOLERANCE,b,g,p,k;var r=v(c,"touchstart",function(m){function u(C){return Math.abs(m.clientX-C.clientX)<a&&Math.abs(m.clientY-C.clientY)<a}d();var G;if(e.detectLongPress){var H;g=v(c,"touchmove",function(C){H=C});k=setTimeout(function(){u(H||m)&&(e.ignoreReleaseIfLongPressHappened&&(G=!0),e.longPressCallback(m))},
e.longPressTimeout||h.LONG_PRESS_TIMEOUT)}b=v.once(c,"touchend",function(C){!G&&u(C)&&f(C);d()});p=v.once(c,"touchcancel",d)});return{remove:function(){r&&r.remove();d()}}},addGlobalDragHanlder:function(c){function f(){e&&e.remove();d&&d.remove();a&&a.remove();b&&b.remove();g&&c.destroyDnDBox&&c.destroyDnDBox(g)}c.tolerance=0<c.tolerance?c.tolerance:5;var e,d,a,b,g;return v(c.node,c.downEventName||B.press,function(p){f();if(!c.onMouseDown||c.onMouseDown(p)){var k=p.clientX,r=p.clientY,m=k,u=r;e=v(document.body,
B.move,function(G){function H(){f();c.dragEnded&&c.dragEnded()}G.shiftKey||t.isCtrl(G)||!(Math.abs(k-G.clientX)>=c.tolerance||Math.abs(r-G.clientY)>=c.tolerance)||(e.remove(),c.dragStarted&&!c.dragStarted(G,G.clientX-m,G.clientY-u))||(m=G.clientX,u=G.clientY,g=c.createDnDBox&&c.createDnDBox(),d=v(document.body,B.move,function(C){c.dragMoved&&c.dragMoved(C,C.clientX-m,C.clientY-u,H);m=C.clientX;u=C.clientY}),a=v.once(document.body,A("ie")||A("trident")?"mouseup, touchend, click":"mouseup, touchend",
function(){H()}),b=v(document.body,"keyup",function(C){27==C.keyCode&&(f(),c.dragCanceled&&c.dragCanceled())}))});v.once(document.body,A("ie")||A("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){e.remove()})}})}};return h})},"esri/dijit/geoenrichment/ReportPlayer/config":function(){define(["esri/kernel"],function(v){function A(B){B=B.split(".");return Number((Number(B[0])+Number(B[1])/100).toFixed(2))}v=Math.max(A("3.37"),A(v.version)).toFixed(2);return{jsapiVersion:v,esriDijitCssUrl:"https://js.arcgis.com/"+
v+"/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/"+v+"/esri/css/esri.css",playerSourceRootUrl:"https://js.arcgis.com/"+v+"/",configScriptText:null,env:"prod",isPlayerOnServer:!1,updateVariableInfoFromDataXml:!0,runReportTask:{cacheResult:!0,ignoreErrors:!0,secondAttempt:!0},maps:{maxNumberOfMapsShownAtTheSameTime:6},charts:{showErrorIfHasUnavailableData:!1},tables:{leaveEmptyCellsUponError:!0,showUnavailableData:!0},createImageCommand:{skipSavingFile:!1},createPDFCommand:{skipSavingFile:!1,
skipCreditConsumption:!1},createPlayerCommand:{loadMapPortalItems:!0,compressData:!1,prettifyDataJson:!1,skipCreditConsumption:!1},exportToExcel:{skipSavingFile:!1},modules:{exportCommands:!0,complexCellTooltips:!0,paths:{panoramicViewer:null}},generalization:{factor:-1,maxVerticesInAllFeatures:1E5,numVerticesPerFeature:5E4}}})},"widgets/BusinessAnalyst/utils/GEUtil":function(){define("dojo/_base/array dojo/when esri/request ./GeocodeUtil esri/geometry/webMercatorUtils esri/dijit/geoenrichment/utils/FileUtil jimu/portalUtils".split(" "),
function(v,A,B,t,h,c,f){var e={},d={};return{getAvailableCountries:function(){return f.getPortal(portalUrl).loadSelfInfo().then(function(a){return B({url:(a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Countries",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},handleAs:"json"}).then(function(b){v.forEach(b.countries,function(g){v.forEach(g.hierarchies,
function(p){p.default&&(e[g.id]=p.ID)});d[g.id]=!!g.disableMultiHierarchySupport});return b})})},createRingOrDriveTimes:function(a){return f.getPortal(portalUrl).loadSelfInfo().then(function(b){return B({url:(b&&b.helperServices&&b.helperServices.geoenrichment&&b.helperServices.geoenrichment.url?b.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",useData:JSON.stringify({sourceCountry:a.sourceCountry}),
studyAreasOptions:JSON.stringify(a.studyAreasOptions),dataCollections:JSON.stringify(["GlobalIntersect"]),returnGeometry:!0,outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:a.geometry}]),token:esri.id.credentials[0].token},handleAs:"json"})})},createReport:function(a){var b={appID:"webappbuilder",langCode:"en-us",report:"string"===typeof a.report?a.report:JSON.stringify(a.report),format:"pdf",f:"bin",token:esri.id.credentials[0].token,useData:JSON.stringify({sourceCountry:a.sourceCountry}),
studyAreas:JSON.stringify(a.studyAreas),reportFields:JSON.stringify({locationname:a.locationName,latitude:a.lat,longitude:a.long,subtitle:"Prepared by Esri",areadesc2:a.areadesc2})};return f.getPortal(portalUrl).loadSelfInfo().then(function(g){return B({url:(g&&g.helperServices&&g.helperServices.geoenrichment&&g.helperServices.geoenrichment.url?g.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/createReport",content:b,
handleAs:"blob"}).then(function(p){return c.saveAs(p,a.reportDownloadName+".pdf")}).otherwise(function(p){alert("Error: "+p)})})},checkCapabilities:function(a){return f.getPortal(portalUrl).loadSelfInfo().then(function(b){var g=!1,p=!1,k=b&&b.user&&b.user.privileges,r=b&&b.helperServices;b=r.geoenrichment&&r.geoenrichment.url;r=r.routingUtilities&&r.routingUtilities.url;var m=b?b:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!a.mode&&a.appProxies&&
0<a.appProxies.length&&v.some(a.appProxies,function(u){return m.toLowerCase()===u.sourceUrl.toLowerCase()})?p=g=!0:v.forEach(k,function(u){"premium:user:geoenrichment"===u?g=!0:"premium:user:networkanalysis"===u&&(p=!0)});return{hasPrivilege:g&&p,geServiceConfigured:!!b,dirRoutingServiceConfigured:!!r}})},getCountryForPolygon:function(a,b,g){return f.getPortal(portalUrl).loadSelfInfo().then(function(p){return B({url:(p&&p.helperServices&&p.helperServices.geoenrichment&&p.helperServices.geoenrichment.url?
p.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",dataCollections:JSON.stringify(["GlobalIntersect"]),outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:a.toJson()}]),token:esri.id.credentials[0].token},handleAs:"json"}).then(function(k){if(k&&k.results&&1===k.results.length&&1===k.results[0].value.FeatureSet[0].features.length)return k.results[0].value.FeatureSet[0].features[0].attributes.sourceCountry;
if(k&&k.results&&1===k.results.length&&1<k.results[0].value.FeatureSet[0].features.length){var r=a.getCentroid();r=h.xyToLngLat(r.x,r.y);var m=function(u){var G="";v.forEach(u,function(H){H.attributes.sourceCountry==g&&(G=g)});if(G)return G;v.forEach(u,function(H){H.attributes.sourceCountry==b.defaultCountryID&&(G=defaultCountryID)});return G?G:u[0].attributes.sourceCountry};return A(t.reverseGeocode({x:r[0],y:r[1]})).then(function(u){return u&&u.address&&u.address.CountryCode?u.address.CountryCode:
m(k.results[0].value.FeatureSet[0].features)}).otherwise(function(){return m(k.results[0].value.FeatureSet[0].features)})}return b.defaultCountryID})})},getGEProxyUrl:function(a){var b=!1;return f.getPortal(portalUrl).loadSelfInfo().then(function(g){geUrl=g&&g.helperServices&&g.helperServices.geoenrichment&&g.helperServices.geoenrichment.url?g.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!a.mode&&a.appProxies&&0<
a.appProxies.length&&v.forEach(a.appProxies,function(p){geUrl.toLowerCase()===p.sourceUrl.toLowerCase()&&(b=p.proxyUrl)});return b})},getCountryHierarchies:function(){return e},getCountryDisableMultiHierarchySupport:function(){return d}}})},"widgets/BusinessAnalyst/utils/GeocodeUtil":function(){define(["esri/request","jimu/portalUtils"],function(v,A){return{reverseGeocode:function(B){return A.getPortal(portalUrl).loadSelfInfo().then(function(t){return v({url:(t&&t.isPortal&&t.helperServices&&t.helperServices.geocode&&
0<t.helperServices.geocode.length?t.helperServices.geocode[0].url:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer")+"/reverseGeocode",content:{appID:"webappbuilder",f:"json",langCode:"en-us",location:JSON.stringify({x:B.x,y:B.y}),distance:250},handleAs:"json"})})}}})},"esri/dijit/geoenrichment/utils/FileUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","./DataUtil","./ImageUtil"],function(v,A,B,t){function h(){return new v.reject(Error("Saving not supported."))}
var c=h,f=/[\\/:*?"<>|]/g,e={savingSupported:function(){return void 0!==window.Blob},saveTextFile:function(b,g,p,k){return e.savingSupported()?e.saveAs(new Blob([b],{type:p||"text/plain"}),g||"text.txt",k):h()},saveImageFile:function(b,g){if(e.savingSupported()){if("string"===typeof b){var p=t.base64DataFromDataURL(b);p=B.binaryStringToByteArray(atob(p)).buffer}else b instanceof ArrayBuffer&&(p=b);return e.saveAs(p?B.arrayBuffersToBlob([p],"image/png"):b,g)}h()},_queue:[],_isSavePendingFlag:!1,_saveTimeoutH:null,
saveAs:function(b,g,p){return p&&p.addDownloadIntervals?(p=new v,e._queue.push({blob:b,name:g||"download",dfd:p}),e._trySaveAsNext(),p.promise):c(b,e.validateName(g||"download"))},_trySaveAsNext:function(){if(e._queue.length&&!e._isSavePendingFlag){var b=e._queue.shift();e._isSavePendingFlag=!0;A(c(b.blob,e.validateName(b.name))).then(b.dfd.resolve,b.dfd.reject).always(function(){setTimeout(function(){e._isSavePendingFlag=!1;e._trySaveAsNext()},100)})}},validateName:function(b){return String(b).trim().replace(f,
"")}};if(!e.savingSupported())return e;if(window.navigator&&window.navigator.msSaveOrOpenBlob)return c=function(b,g){var p=new v;window.navigator.msSaveOrOpenBlob(b,g)?p.resolve():p.reject(Error("Failed to save or open downloaded file."));return p.promise},e;var d=window.URL||window.webkitURL;if("download"in window.document.createElement("a")){var a=function(b){if(void 0!==window.MouseEvent)var g=new MouseEvent("click",{bubbles:!0,cancelable:!1});else g=document.createEvent("MouseEvent"),g.initMouseEvent("click",
!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);b.dispatchEvent(g)};c=function(b,g){var p=new v,k=d.createObjectURL(b),r=window.document.createElement("a");r.href=k;r.download=g;a(r);setTimeout(function(){d.revokeObjectURL(k);r=null;p.resolve();p=null},1E3);return p.promise};return e}c=function(b,g){var p=new v;b=new File([b],g,{type:b.type});var k=d.createObjectURL(b);window.open(k,"_blank");setTimeout(function(){d.revokeObjectURL(k);p.resolve()},1E3);return p.promise};return e})},"esri/dijit/geoenrichment/utils/DataUtil":function(){define(["esri/dijit/geoenrichment/Deferred",
"esri/dijit/geoenrichment/when"],function(v,A){function B(f){return"string"==typeof f?{source:f,getLength:function(){return this.source.length},getByte:function(e){return this.source.charCodeAt(e)&255}}:window.ArrayBuffer&&f instanceof ArrayBuffer?{source:new Uint8Array(f),getLength:function(){return this.source.byteLength},getByte:function(e){return this.source[e]}}:f}function t(f){for(var e=f.length,d=new Uint8Array(f.length),a=0;a<e;a++)d[a]=f.charCodeAt(a);return d}function h(f,e){f=new Uint8Array(f);
e=Math.min(e,f.byteLength);for(var d="",a=0;a<e;a++)d+=String.fromCharCode(f[a]);return d}var c={arrayBufferFromBlob:function(f){var e=new v,d=new FileReader;d.onloadend=function(){d.error?e.reject(d.error):e.resolve(d.result)};d.readAsArrayBuffer(f);return e.promise},arrayBuffersToBlob:function(f,e){return new Blob(f,{type:e||"application/octet-stream"})},binaryStringFromByteSource:function(f){if("string"==typeof f)return f;f=B(f);var e=f.getLength(),d=e%4;e-=d;for(var a="",b=0,g,p,k,r;b<e;)g=f.getByte(b++),
p=f.getByte(b++),k=f.getByte(b++),r=f.getByte(b++),a+=String.fromCharCode(g,p,k,r);1==d?a+=String.fromCharCode(f.getByte(b)):2==d?a+=String.fromCharCode(f.getByte(b),f.getByte(b+1)):3==d&&(a+=String.fromCharCode(f.getByte(b),f.getByte(b+1),f.getByte(b+2)));return a},base64FromByteSource:function(f){f=B(f);var e=f.getLength(),d=e%3;e-=d;for(var a,b,g,p,k="",r=0;r<e;r+=3)p=f.getByte(r)<<16|f.getByte(r+1)<<8|f.getByte(r+2),a=p>>18&63,b=p>>12&63,g=p>>6&63,p&=63,k+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a]+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[b]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p];1==d?(p=f.getByte(r),k+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>2&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p<<4&63]+"\x3d\x3d"):2==d&&(p=f.getByte(r)<<8|f.getByte(r+1),k+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>
10&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>4&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p<<2&63]+"\x3d");return k},base64FromJson:function(f){return btoa(unescape(encodeURIComponent("string"===typeof f?f:JSON.stringify(f))))}};c.binaryStringToByteArray=t;c.base64ToByteArray=function(f){return t(atob(f))};c.getFirstBytes=function(f,e){if("string"==typeof f)var d=f.substr(0,e);else if(window.ArrayBuffer&&f instanceof ArrayBuffer)d=h(f,e);
else if(window.Blob&&f instanceof Blob){d=new v;var a=new FileReader;a.onloadend=function(){a.error?d.resolve(""):d.resolve(h(a.result,e))};a.readAsArrayBuffer(f.slice(0,e))}return A(d||"")};c.isBase64=function(f){return f&&0==f.length%4&&/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/]+$/.test(f.replace(/={0,2}$/,""))};c.base64ToJson=function(f){return JSON.parse(decodeURIComponent(escape(atob(f))))};c.getContentType=function(f){f=c.getFileExtension(f);if(null===f)return null;
switch(f){case "png":return"image/png";case "jpg":case "jpeg":return"image/jpeg";case "gif":return"image/gif";case "svg":return"image/svg+xml";case "json":return"application/json";case "txt":return"text/plain";case "xml":return"text/xml";default:return null}};c.getFileExtension=function(f){var e=f.lastIndexOf(".")+1;return e?f.substr(e).toLowerCase():null};return c})},"esri/dijit/geoenrichment/utils/ImageUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when",
"./UrlUtil"],function(v,A,B){var t={base64DataToDataURL:function(h,c){if(/^data:image/.test(h))return h;c||(c=atob(h.substr(0,16)),c=t.getImageContentType(c));return"data:"+(c||"image/png")+";base64,"+h},getImageContentType:function(h){if("\u00ff\u00d8\u00ff"===h.substr(0,3)&&"JFIF"===h.substr(6,4))return"image/jpeg";if("\u0089PNG\r\n\u001a\n"===h.substr(0,8))return"image/png";if("GIF89a"===h.substr(0,6)||"GIF87a"===h.substr(0,6))return"image/gif"},base64DataFromDataURL:function(h){0==h.indexOf("data:")&&
(h=h.substr(h.indexOf(",")+1));return h},getBase64DataIndex:function(h){h=0==h.indexOf("data:")?h.indexOf(";base64,"):-1;return 0<h?h+8:0},getContentType:function(h){var c=t.getBase64DataIndex(h);return c?h.substring(5,c-8):null},checkBase64FileSize:function(h,c){return t.getBase64FileSize(h)<=c},getBase64FileSize:function(h){return.75*h.length},imageToDataURL:function(h,c){c=c||{};var f=document.createElement("canvas"),e=f.getContext("2d");f.width=c.width||h.width;f.height=c.height||h.height;var d=
c.opacity;null!=d&&!isNaN(d)&&0<=d&&1>d&&(e.globalAlpha=+d,c.format="image/png");(d=c.pos)?e.drawImage(h,d.x||0,d.y||0):e.drawImage(h,0,0,f.width,f.height);return f.toDataURL(c.format)},imageFromUrl:function(h,c){var f=new v,e=new Image;0!==h.indexOf("data:")&&c&&c.crossOrigin&&e.setAttribute("crossOrigin",c.crossOrigin);e.onload=function(){if(e.width&&e.height)f.resolve(e);else{var d=Error("Error of reading an image from URL.");c&&c.ignoreError?f.resolve(null):f.reject(d)}e.onload=e.onerror=null};
e.onerror=function(d){c&&c.ignoreError?f.resolve(null):f.reject(d);e.onload=e.onerror=null};h=require.toUrl(h);/^http:/i.test(h)&&/^https/i.test(window.location.protocol)&&(h=B.toHttpsUrl(h));e.src=h;return f.promise},scaleImage:function(h,c){if("string"===typeof h){var f=t.base64DataToDataURL(h),e=t.getContentType(f);f=t.imageFromUrl(f)}return A(f||h).then(function(d){var a=1,b=d.width,g=d.height;if(c.factor)a=c.factor;else if(c.maxDim)a=c.maxDim/Math.max(b,g);else if(c.imageDim){var p=c.imageDim.w,
k=c.imageDim.h;c.imageDim.preserveRatio?(a=Math.min(p/b,k/g),c.imageDim.reduceOnly&&1<a&&(a=1)):c.imageDim.reduceOnly?(b=Math.min(b,p),g=Math.min(g,k)):(b=p,g=k)}return t.imageToDataURL(d,{width:b*a,height:g*a,format:c.format||e,opacity:c.opacity})})},getImageViewType:function(h,c){return 1E3<=c?(h/=c,.025>=Math.abs(h-2)?"360":2<h?"pano":null):null}};return t})},"esri/dijit/geoenrichment/utils/UrlUtil":function(){define(["dojo/_base/url","esri/config","esri/kernel","esri/urlUtils","esri/arcgis/utils"],
function(v,A,B,t,h){var c={getDomain:function(e){if("string"!==typeof e)return null;e=e.replace(/^(http:\/\/|https:\/\/)/i,"");var d=e.indexOf("/");return 0>d?e:e.substr(0,d)},getPortalUrl:function(e){if("string"!==typeof e)return null;e=e.replace(/\?.*$/,"");var d=e.match(/^(.+)\/sharing(\/|$)/i);return d||(d=e.match(/^(.+)\/home$/i))?d[1]:(d=e.match(/^(.+)\/portal(\/|$)/i))?d[1]+"/portal":e},getProxyUrl:function(e){var d=A.defaults.io.proxyUrl;d&&!/^http/i.test(d)&&(d=t.getAbsoluteUrl(d));d&&e&&
(d=c.toHttpsUrl(d));return d},registerCORS:function(e){(e=c.getDomain(e))&&-1==A.defaults.io.corsEnabledServers.indexOf(e)&&A.defaults.io.corsEnabledServers.push(e);c._fixCORS()},_fixCORS:function(){A.defaults.io.corsEnabledServers=A.defaults.io.corsEnabledServers.filter(function(e){return e.indexOf&&0===e.indexOf("null://")?(console.log("WARNING: incorrect CORS URL detected: "+e),!1):!0})},indexOfQuery:function(e){var d=e.indexOf("?");0<=d&&(e=e.substr(d+1),/^(http:\/\/|https:\/\/)/i.test(e)&&(e=
e.indexOf("?"),d=0<=e?d+1+e:-1));return d},removeQuery:function(e){var d=c.indexOfQuery(e);return 0>d?e:e.substr(0,d)},addQueryPart:function(e,d){var a=0>c.indexOfQuery(e)?"?":"\x26";return e+a+d},getVariableValue:function(e,d){if(e&&"string"===typeof d){var a=t.urlToObject(e);if(a.query){var b={};Object.keys(a.query).forEach(function(g){b[g.toLowerCase()]=a.query[g]});return b[d.toLowerCase()]}}},addUrlVariable:function(e,d,a){d=encodeURIComponent(d);a=encodeURIComponent(a);return c.addQueryPart(e,
d+"\x3d"+a)},securePortsMap:{80:"443",8080:"8443"},toHttpUrl:function(e){return!e||/^http/i.test(e)?e:"http://"+e},toHttpsUrl:function(e){e&&(e=c.toHttpUrl(e));if(!e||!/^http:\/\//i.test(e))return e;var d=new v(e);e=e.replace(/^http/i,"https");var a=c.securePortsMap[d.port];a&&(e=e.replace(":"+d.port,":"+a));return e},combine:function(e,d){"number"===typeof d&&(d+="");if(d){if(/^(http:\/\/|https:\/\/)/i.test(d)||!e)return d;"/"!=d.charAt(0)&&(d="/"+d);if(1==d.length)return e;var a=e.length-1;"/"==
e.charAt(a)&&(e=e.substr(0,a));var b=t.urlToObject(e);e=c.removeQuery(e);a=e.length-d.length;0<=a&&e.substr(a).toLowerCase()==d.toLowerCase()&&(e=e.substr(0,a));e+=d;for(var g in b.query)c.addQueryPart(e,b.query[g])}return e},combineMulti:function(e){for(var d=e[0],a=1;a<e.length;a++)d=c.combine(d,e[a]);return d},openUrl:function(e,d){if(d)return window.open(e,"_blank");d=window.open();d.opener=null;d.referrer=null;d.location=e;return d},isPageRunOnWebService:function(){return/^http/i.test(window.location.protocol)},
getToken:function(e){return(e=e&&B.id.findCredential(e)||B.id.credentials[0])&&e.token}},f;c.getArcgisUrl=function(){return f};c.setArcgisUrl=function(e){e&&(f=e,h.arcgisUrl=c.combine(e,"/sharing/rest/content/items"))};return c})},"widgets/BusinessAnalyst/utils/ReportUtil":function(){define("dojo/Deferred dojo/promise/all dojo/when dojo/_base/array esri/request ./GEUtil jimu/portalUtils dojo/i18n!../nls/strings".split(" "),function(v,A,B,t,h,c,f,e){STANDARD_INFOGRAPHIC_TYPEKEYWORD="esriReportPlayerStandardInfographic";
return{_ownedCachedCustomReports:null,_sharedCachedCustomReports:null,_cachedCountryClassicReports:[],_cachedInfographicReports:null,_countryInitDfds:[],getAvailableClassicReports:function(d,a){var b=this,g=[],p=new v,k;a&&t.forEach(a.countryConfig,function(G){d==G.countryID&&(k=G)});k||(k={countryID:d,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,
allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var r=null,m=null,u=null;B(this._initReports(d),function(){if(!a||k.allowAllEsriReports||b._hasEnabledReports(b._cachedCountryClassicReports[d],k.enabledEsriReports))r=g.length,g.push({value:"esriReports",label:e.esriReports,children:[]});if(!a||k.allowAllOrgReports&&b._hasReportsForCountry(b._ownedCachedCustomReports,d)||b._hasEnabledReportsForCountry(b._ownedCachedCustomReports,
d,k.enabledOrgReports))m=g.length,g.push({value:"myReports",label:e.myReports,children:[]});if(!a||k.allowAllOrgReports&&b._hasReportsForCountry(b._sharedCachedCustomReports,d)||b._hasEnabledReportsForCountry(b._sharedCachedCustomReports,d,k.enabledOrgReports))u=g.length,g.push({value:"sharedReports",label:e.sharedReports,children:[]});(k.allowAllEsriReports||b._hasEnabledReports(b._cachedCountryClassicReports[d],k.enabledEsriReports))&&b._cachedCountryClassicReports[d]&&0<b._cachedCountryClassicReports[d].length&&
t.forEach(b._cachedCountryClassicReports[d],function(C){(k.allowAllEsriReports||k.enabledEsriReports.includes(C.reportID))&&g[r].children.push(b._formatClassicReportsForDropDown(C))});var G=["esriWebInfographicReport","esriWebSingleInfographic","esriWebBlankInfographic","esriWebHiddenInfographic","esriWebComparisonReport"];(k.allowAllOrgReports&&b._hasReportsForCountry(b._ownedCachedCustomReports,d)||b._hasEnabledReportsForCountry(b._ownedCachedCustomReports,d,k.enabledOrgReports))&&t.forEach(b._ownedCachedCustomReports,
function(C){C.properties.countries.includes(d)&&(k.allowAllOrgReports||k.enabledOrgReports.includes(C.id))&&(C.typeKeywords.some(function(E){return 0<=G.indexOf(E)})||(c.getCountryDisableMultiHierarchySupport()[d]?C.properties.hierarchy===c.getCountryHierarchies()[d]&&g[m].children.push(b._formatClassicReportsForDropDown(C)):g[m].children.push(b._formatClassicReportsForDropDown(C))))});(k.allowAllOrgReports&&b._hasReportsForCountry(b._sharedCachedCustomReports,d)||b._hasEnabledReportsForCountry(b._sharedCachedCustomReports,
d,k.enabledOrgReports))&&t.forEach(b._sharedCachedCustomReports,function(C){C.properties.countries.includes(d)&&(k.allowAllOrgReports||k.enabledOrgReports.includes(C.id))&&(C.typeKeywords.some(function(E){return 0<=G.indexOf(E)})||(c.getCountryDisableMultiHierarchySupport()[d]?C.properties.hierarchy===c.getCountryHierarchies()[d]&&g[u].children.push(b._formatClassicReportsForDropDown(C)):g[u].children.push(b._formatClassicReportsForDropDown(C))))});var H=function(C,E){C=C.label.toUpperCase();E=E.label.toUpperCase();
var K=0;C>E?K=1:C<E&&(K=-1);return K};0<g.length&&g[0].children.sort(H);1<g.length&&g[1].children.sort(H);2<g.length&&g[2].children.sort(H);p.resolve(g)});return p},_hasEnabledReports:function(d,a){return d&&a?t.some(d,function(b){return a.includes(b.reportID)}):!1},_hasReportsForCountry:function(d,a){return d&&a?t.some(d,function(b){return b.properties.countries.includes(a)}):!1},_hasEnabledReportsForCountry:function(d,a,b){return d&&a&&b?t.some(d,function(g){return g.properties.countries.includes(a)?
b.includes(g.id):!1}):!1},_formatClassicReportsForDropDown:function(d){return d.metadata?{label:d.metadata.title,value:d.reportID,reportType:d.metadata.type}:{label:d.title,value:d.id,reportType:d.properties.type,item:{itemid:d.id,url:portalUrl,token:esri.id.credentials[0].token}}},getAvailableInfographicReports:function(d,a){var b=this,g=[],p=new v,k;a&&t.forEach(a.countryConfig,function(G){d==G.countryID&&(k=G)});k||(k={countryID:d,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,
allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var r=null,m=null,u=null;B(this._initReports(d),function(){if(!a||k.allowAllEsriInfographics||b._hasEnabledInfographics(b._cachedInfographicReports,k.enabledEsriInfographics))r=g.length,g.push({value:"esriReports",
label:e.esriInfographics,children:[]});if(!a||k.allowAllOrgInfographics&&0<b._ownedCachedCustomReports.length||b._hasEnabledInfographics(b._ownedCachedCustomReports,k.enabledOrgInfographics))m=g.length,g.push({value:"myReports",label:e.myInfographics,children:[]});if(!a||k.allowAllOrgInfographics&&0<b._sharedCachedCustomReports.length||b._hasEnabledInfographics(b._sharedCachedCustomReports,k.enabledOrgInfographics))u=g.length,g.push({value:"sharedReports",label:e.sharedInfographics,children:[]});
(k.allowAllEsriInfographics||b._hasEnabledInfographics(b._cachedInfographicReports,k.enabledEsriInfographics))&&t.forEach(b._cachedInfographicReports,function(H){if(H.properties.countries.includes(d)&&(k.allowAllEsriInfographics||k.enabledEsriInfographics.includes(H.id))){var C=b._getIndexOfInfographicByTitle(H.title,g[r].children);if(-1===C)g[r].children.push(b._formatInfographicReportsForDropDown(H));else{var E=c.getCountryHierarchies()[d];H.properties.hierarchy===E&&(g[r].children[C]=b._formatInfographicReportsForDropDown(H))}}});
(k.allowAllOrgInfographics&&0<b._ownedCachedCustomReports.length||b._hasEnabledInfographics(b._ownedCachedCustomReports,k.enabledOrgInfographics))&&t.forEach(b._ownedCachedCustomReports,function(H){H.properties.countries.includes(d)&&(k.allowAllOrgInfographics||k.enabledOrgInfographics.includes(H.id))&&(H.typeKeywords.includes("esriWebInfographicReport")||b._isOldPortalInfographic(H))&&(c.getCountryDisableMultiHierarchySupport()[d]?H.properties.hierarchy===c.getCountryHierarchies()[d]&&g[m].children.push(b._formatInfographicReportsForDropDown(H)):
g[m].children.push(b._formatInfographicReportsForDropDown(H)))});(k.allowAllOrgInfographics&&0<b._sharedCachedCustomReports.length||b._hasEnabledInfographics(b._sharedCachedCustomReports,k.enabledOrgInfographics))&&t.forEach(b._sharedCachedCustomReports,function(H){H.properties.countries.includes(d)&&(k.allowAllOrgInfographics||k.enabledOrgInfographics.includes(H.id))&&(H.typeKeywords.includes("esriWebInfographicReport")||b._isOldPortalInfographic(H))&&(c.getCountryDisableMultiHierarchySupport()[d]?
H.properties.hierarchy===c.getCountryHierarchies()[d]&&g[u].children.push(b._formatInfographicReportsForDropDown(H)):g[u].children.push(b._formatInfographicReportsForDropDown(H)))});var G=function(H,C){H=H.label.toUpperCase();C=C.label.toUpperCase();var E=0;H>C?E=1:H<C&&(E=-1);return E};0<g.length&&g[0].children.sort(G);1<g.length&&g[1].children.sort(G);2<g.length&&g[2].children.sort(G);p.resolve(g)});return p},_hasEnabledInfographics:function(d,a){return t.some(d,function(b){return a.includes(b.id)})},
_isOldPortalInfographic:function(d){return d.properties&&d.properties.isHidden&&"true"===d.properties.isHidden?!1:d.properties&&d.properties.isGraphicReport&&"true"===d.properties.isGraphicReport?!0:!1},_formatInfographicReportsForDropDown:function(d){return{label:d.title,value:d.id}},_getIndexOfInfographicByTitle:function(d,a){var b=-1;t.some(a,function(g,p){if(g.label===d)return b=p,!1});return b},_initReports:function(d){var a=[],b=this;if(this._countryInitDfds[d])return this._countryInitDfds[d];
this._countryInitDfds[d]=new v;var g=function(p,k){return h(p).then(function(r){t.forEach(r.results,function(m){k.push(m)});if(-1!=r.nextStart)return p.content.start=r.nextStart,g(p,k)},function(r){alert(r)})};f.getPortal(portalUrl).loadSelfInfo().then(function(p){var k=p&&p.helperServices&&p.helperServices.geoenrichment&&p.helperServices.geoenrichment.url?p.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";b._cachedCountryClassicReports[d]||
a.push(h({url:k+"/Geoenrichment/reports/"+d,content:{appID:"webappbuilder",f:"json",langCode:"en-us"}}).then(function(r){b._cachedCountryClassicReports[d]=r.reports},function(r){alert(r)}));b._cachedInfographicReports||(b._cachedInfographicReports=[],a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:"typekeywords:(esriWebStandardInfographicReport)"}},b._cachedInfographicReports)));b._ownedCachedCustomReports||
(b._ownedCachedCustomReports=[],a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) owner:'+esri.id.credentials[0].userId}},b._ownedCachedCustomReports)));b._sharedCachedCustomReports||(b._sharedCachedCustomReports=[],a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",
sortOrder:"desc",q:'access:shared type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},b._sharedCachedCustomReports)),a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:org type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},b._sharedCachedCustomReports)),
p&&p.appInfo&&p.appInfo.orgId&&a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:public type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId+" orgid: "+p.id}},b._sharedCachedCustomReports)));0===a.length?b._countryInitDfds[d].resolve():A(a).then(function(){b._countryInitDfds[d].resolve()})});return this._countryInitDfds[d]}}})},
"widgets/BusinessAnalyst/utils/ValidationUtil":function(){define(["dojo/dom-class"],function(v){return{MIN_RINGS_VALUE:0,MAX_RINGS_VALUE:1E3,MIN_DTWT_VALUE:0,MAX_DTWT_VALUE:300,validateInvalidValues:function(A,B,t,h,c){var f=A.get("value"),e=B.get("value"),d=t.get("value"),a=!0;0<f.length&&null===this._tryParseFloat(f)?(a=!1,v.remove(h,"hidden"),h.innerHTML=c,v.add(A.domNode,"invalidValue")):v.remove(A.domNode,"invalidValue");0<e.length&&null===this._tryParseFloat(e)?(a=!1,v.remove(h,"hidden"),h.innerHTML=
c,v.add(B.domNode,"invalidValue")):v.remove(B.domNode,"invalidValue");0<d.length&&null===this._tryParseFloat(d)?(a=!1,v.remove(h,"hidden"),h.innerHTML=c,v.add(t.domNode,"invalidValue")):v.remove(t.domNode,"invalidValue");a&&v.add(h,"hidden");return a},validateMinMaxValues:function(A,B,t,h,c,f,e){var d=A.get("value"),a=B.get("value"),b=t.get("value"),g=!0;0<d.length?(d=parseFloat(d),d<h||d>c?(g=!1,v.remove(f,"hidden"),f.innerHTML=e,v.add(A.domNode,"invalidValue")):v.remove(A.domNode,"invalidValue")):
v.remove(A.domNode,"invalidValue");0<a.length?(d=parseFloat(a),d<h||d>c?(g=!1,v.remove(f,"hidden"),f.innerHTML=e,v.add(B.domNode,"invalidValue")):v.remove(B.domNode,"invalidValue")):v.remove(B.domNode,"invalidValue");0<b.length?(d=parseFloat(b),d<h||d>c?(g=!1,v.remove(f,"hidden"),f.innerHTML=e,v.add(t.domNode,"invalidValue")):v.remove(t.domNode,"invalidValue")):v.remove(t.domNode,"invalidValue");g&&v.add(f,"hidden");return g},_tryParseFloat:function(A){var B=null;null!==A&&0<A.length&&(isNaN(A)||
(B=parseFloat(A)));return B}}})},"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),function(v,A,B,t,h,c){var f=null,e=v([B,h],{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new c({whiteList:this.whiteList,
safeAttrValue:t.hitch(this,function(d,a,b,g){return"style"===a?this.xss.friendlyAttrValue(b).replace(/"/g,"'"):"img"===d&&"src"===a?this.xss.escapeAttrValue(b):this.xss.safeAttrValue(d,a,b,g)}),onTag:t.hitch(this,function(d,a,b){if(b.isWhite&&this._isInWhiteList(d,this.graphicsWhiteList))return a}),onIgnoreTagAttr:t.hitch(this,function(d,a,b,g){if("data-"===a.substr(0,5))return a+'\x3d"'+this.xss.escapeAttrValue(b)+'"'}),onIgnoreTag:t.hitch(this,function(d,a,b){if("o:"===d.substr(0,2)||"!--[if"===
d||"!--[endif]--"===d)return a})},!0);this.xss=this.sanitizer.xss},sanitize:function(d){return this.sanitizer.sanitize(d)},_getWhiteList:function(){var d="title height width class style font-family id align text-align".split(" "),a={div:d,h1:d,h2:d,h3:d,h4:d,h5:d,h6:d,span:d,p:d,s:d,strong:d,em:d,u:d,ol:d,ul:d,li:d,a:["href","target"].concat(d),img:["src","alt","border"].concat(d),blockquote:d,font:["face","size","color"].concat(d),pre:d,code:d,b:d,i:d,wbr:d,video:"autoplay controls loop muted poster preload".split(" ").concat(d),
audio:["autoplay","controls","loop","muted","preload"].concat(d),source:["media","src","type"].concat(d),table:["cellpadding","cellspacing","border"].concat(d),tbody:[].concat(d),tr:["valign"].concat(d),td:["valign","colspan","rowspan","nowrap"].concat(d),th:["valign","colspan","rowspan","nowrap"].concat(d),hr:d,html:d,title:d,link:["rel","href"],style:["type"].concat(d),body:d};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],
desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],feFuncA:[],feFuncB:[],feFuncG:[],feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],
mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],textPath:[],title:[],tspan:[],use:[],view:[],object:[],canvas:d};return this._extendObjectOfArrays([a,{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],
blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align",
"valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},_extendObjectOfArrays:function(d){var a={};A.forEach(d,function(b){var g=Object.keys(b);A.forEach(g,function(p){Array.isArray(b[p])&&Array.isArray(a[p])?a[p]=a[p].concat(b[p]):
a[p]=b[p]},this)},this);return a},_isInWhiteList:function(d,a){a=Object.keys(a);var b=!1;A.forEach(a,function(g){d===g&&(b=!0)},this);return b}});e.getInstance=function(){null===f&&(f=new e);return f};return e})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(v,A,B,t,h,c,f,e,d,a,b,g,p){var k=B("dijit._editor.plugins.LinkDialog",
b,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:g,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=c.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(m){v("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),c.hitch(this,function(u,G,H){var C=this;this.tag="insertImage"==this.command?"img":"a";u=c.delegate(u.getLocalization("dijit","common",this.lang),u.getLocalization("dijit._editor",
"LinkDialog",this.lang));var E=this.dropDown=this.button.dropDown=new G({title:u[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:c.hitch(this,"setValue"),onOpen:function(){C._onOpenDialog();G.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(c.hitch(C,"_onCloseDialog"),0)}});u.urlRegExp=this.urlRegExp;u.id=H.getUniqueId(this.editor.id);this._uniqueId=u.id;this._setContent(E.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
a.substitute(this.linkDialogTemplate,u));E.startup();this._urlInput=H.byId(this._uniqueId+"_urlInput");this._textInput=H.byId(this._uniqueId+"_textInput");this._setButton=H.byId(this._uniqueId+"_setButton");this.own(H.byId(this._uniqueId+"_cancelButton").on("click",c.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",c.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",c.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=c.hitch(this,function(){var K=this._urlInput.get("value");return this._urlRegExp.test(K)||this._emailRegExp.test(K)});this.own(f(E.domNode,"keydown",c.hitch(this,c.hitch(this,function(K){!K||K.keyCode!=h.ENTER||K.shiftKey||K.metaKey||K.ctrlKey||K.altKey||this._setButton.get("disabled")||(E.onExecute(),E.execute(E.get("value")))}))));m()}))},_checkAndFixInput:function(){var m=this,u=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var G=u,H=!1,C=!1;G&&1<G.length&&(G=c.trim(G),0!==G.indexOf("mailto:")&&(0<G.indexOf("/")?-1===G.indexOf("://")&&"/"!==G.charAt(0)&&G.indexOf("./")&&0!==G.indexOf("../")&&m._hostRxp.test(G)&&(H=!0):m._userAtRxp.test(G)&&(C=!0)));H&&m._urlInput.set("value","http://"+G);C&&m._urlInput.set("value","mailto:"+G);m._setButton.set("disabled",!m._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(c.hitch(this,
function(){this.own(f(this.editor.editNode,"mouseup",c.hitch(this,"_onMouseUp")));this.own(f(this.editor.editNode,"dblclick",c.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(m){this.dropDown.set({parserScope:"dojo",content:m})},_checkValues:function(m){m&&m.urlInput&&(m.urlInput=m.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&m&&m.textInput&&("function"===typeof this.linkFilter?m.textInput=this.linkFilter(m.textInput):
A.forEach(this.linkFilter,function(u){m.textInput=m.textInput.replace(u[0],u[1])}));return m},_createlinkEnabledImpl:function(){return!0},setValue:function(m){this._onCloseDialog();if(9>e("ie")){var u=p.getSelection(this.editor.window).getRangeAt(0).endContainer;3===u.nodeType&&(u=u.parentNode);u&&u.nodeName&&u.nodeName.toLowerCase()!==this.tag&&(u=this.editor.selection.getSelectedElement(this.tag));u&&u.nodeName&&u.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(u),
this.editor.execCommand("unlink"))}m=this._checkValues(m);this.editor.execCommand("inserthtml",a.substitute(this.htmlTemplate,m));d("a",this.editor.document).forEach(function(G){G.innerHTML||t.has(G,"name")||G.parentNode.removeChild(G)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(m){if(m&&m.tagName.toLowerCase()===this.tag){var u=m.getAttribute("_djrealurl")||m.getAttribute("href");var G=m.getAttribute("target")||"_self";var H=m.textContent||
m.innerText;this.editor.selection.selectElement(m,!0)}else H=this.editor.selection.getSelectedText();return{urlInput:u||"",textInput:H||"",targetSelect:G||""}},_onOpenDialog:function(){if(e("ie")){var m=p.getSelection(this.editor.window);if(m.rangeCount){var u=m.getRangeAt(0);var G=u.endContainer;3===G.nodeType&&(G=G.parentNode);G&&G.nodeName&&G.nodeName.toLowerCase()!==this.tag&&(G=this.editor.selection.getSelectedElement(this.tag));if(!G||G.nodeName&&G.nodeName.toLowerCase()!==this.tag)(m=this.editor.selection.getAncestorElement(this.tag))&&
m.nodeName&&m.nodeName.toLowerCase()==this.tag?(G=m,this.editor.selection.selectElement(G)):u.startContainer===u.endContainer&&(m=u.startContainer.firstChild)&&m.nodeName&&m.nodeName.toLowerCase()==this.tag&&(G=m,this.editor.selection.selectElement(G))}}else G=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(G))},_onDblClick:function(m){if(m&&m.target&&(m=m.target,(m.tagName?m.tagName.toLowerCase():
"")===this.tag&&t.get(m,"href"))){var u=this.editor;this.editor.selection.selectElement(m);u.onDisplayChanged();u._updateTimer&&(u._updateTimer.remove(),delete u._updateTimer);u.onNormalizedDisplayChanged();var G=this.button;setTimeout(function(){G.set("disabled",!1);G.loadAndOpenDropDown().then(function(){G.dropDown.focus&&G.dropDown.focus()})},10)}},_onMouseUp:function(){if(e("ff")){var m=this.editor.selection.getAncestorElement(this.tag);if(m){var u=p.getSelection(this.editor.window).getRangeAt(0);
if(u.collapsed&&m.childNodes.length){var G=u.cloneRange();G.selectNodeContents(m.childNodes[m.childNodes.length-1]);G.setStart(m.childNodes[0],0);1!==u.compareBoundaryPoints(G.START_TO_START,G)?u.setStartBefore(m):-1!==u.compareBoundaryPoints(G.END_TO_START,G)&&u.setStartAfter(m)}}}}}),r=B("dijit._editor.plugins.ImgLinkDialog",[k],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(m){if(m&&m.tagName.toLowerCase()===this.tag){var u=m.getAttribute("_djrealurl")||m.getAttribute("src");var G=m.getAttribute("alt");this.editor.selection.selectElement(m,!0)}else G=this.editor.selection.getSelectedText();return{urlInput:u||"",textInput:G||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(c.hitch(this,function(){this.own(f(this.editor.editNode,"mousedown",c.hitch(this,"_selectTag")))}))},_selectTag:function(m){m&&m.target&&(m=m.target,(m.tagName?m.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(m))},_checkValues:function(m){m&&m.urlInput&&(m.urlInput=m.urlInput.replace(/"/g,"\x26quot;"));m&&m.textInput&&(m.textInput=m.textInput.replace(/"/g,"\x26quot;"));return m},_onDblClick:function(m){if(m&&m.target&&(m=m.target,(m.tagName?
m.tagName.toLowerCase():"")===this.tag&&t.get(m,"src"))){var u=this.editor;this.editor.selection.selectElement(m);u.onDisplayChanged();u._updateTimer&&(u._updateTimer.remove(),delete u._updateTimer);u.onNormalizedDisplayChanged();var G=this.button;setTimeout(function(){G.set("disabled",!1);G.loadAndOpenDropDown().then(function(){G.dropDown.focus&&G.dropDown.focus()})},10)}}});b.registry.createLink=function(m){var u={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in m?m.allowUnsafeHtml:!1};
"linkFilter"in m&&(u.linkFilter=m.linkFilter);return new k(u)};b.registry.insertImage=function(){return new r({command:"insertImage"})};k.ImgLinkDialog=r;return k})},"dijit/_editor/plugins/ViewSource":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k,r,m,u,G){var H=B("dijit._editor.plugins.ViewSource",r,{stripScripts:!0,stripComments:!0,stripIFrames:!0,stripEventHandlers:!0,readOnly:!1,_fsPlugin:null,toggle:function(){g("webkit")&&(this._vsFocused=!0);this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var C=e.getLocalization("dijit._editor","commands"),E=this.editor;this.button=new m({label:C.viewSource,ownerDocument:E.ownerDocument,dir:E.dir,lang:E.lang,showLabel:!1,iconClass:this.iconClassPrefix+
" "+this.iconClassPrefix+"ViewSource",tabIndex:"-1",onChange:a.hitch(this,"_showSource")});this.button.set("readOnly",!1)},setEditor:function(C){this.editor=C;this._initButton();this.removeValueFilterHandles();this._setValueFilterHandle=A.before(this.editor,"setValue",a.hitch(this,function(E){return[this._filter(E)]}));this._getValueFilterHandle=A.after(this.editor,"getValue",a.hitch(this,function(E){return this._filter(E)}));this.editor.addKeyHandler(d.F12,!0,!0,a.hitch(this,function(E){this.button.focus();
this.toggle();E.stopPropagation();E.preventDefault();setTimeout(a.hitch(this,function(){this.editor.focused&&this.editor.focus()}),100)}))},_showSource:function(C){var E=this.editor,K=E._plugins;this._sourceShown=C;var D=this;try{this.sourceArea||this._createSourceView();if(C)E._sourceQueryCommandEnabled=E.queryCommandEnabled,E.queryCommandEnabled=function(y){return"viewsource"===y.toLowerCase()},this.editor.onDisplayChanged(),v.forEach(K,function(y){!y||y instanceof H||!y.isInstanceOf(r)||y.set("disabled",
!0)}),this._fsPlugin&&(this._fsPlugin._getAltViewNode=function(){return D.sourceArea}),this.sourceArea.value=E.get("value"),this.sourceArea.style.height=E.iframe.style.height,this.sourceArea.style.width=E.iframe.style.width,E.iframe.parentNode.style.position="relative",f.set(E.iframe,{position:"absolute",top:0,visibility:"hidden"}),f.set(this.sourceArea,{display:"block"}),this._resizeHandle=b(window,"resize",a.hitch(this,function(){var y=p.getBox(E.ownerDocument);"_prevW"in this&&"_prevH"in this&&
y.w===this._prevW&&y.h===this._prevH||(this._prevW=y.w,this._prevH=y.h,this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(a.hitch(this,function(){delete this._resizer;this._resize()}),10))})),setTimeout(a.hitch(this,this._resize),100),this.editor.onNormalizedDisplayChanged(),this.editor.__oldGetValue=this.editor.getValue,this.editor.getValue=a.hitch(this,function(){var y=this.sourceArea.value;return y=this._filter(y)}),this._setListener=A.after(this.editor,
"setValue",a.hitch(this,function(y){this.sourceArea.value=y||""}),!0);else{if(!E._sourceQueryCommandEnabled)return;this._setListener.remove();delete this._setListener;this._resizeHandle.remove();delete this._resizeHandle;this.editor.__oldGetValue&&(this.editor.getValue=this.editor.__oldGetValue,delete this.editor.__oldGetValue);E.queryCommandEnabled=E._sourceQueryCommandEnabled;if(!this._readOnly){var z=this.sourceArea.value;E.beginEditing();E.set("value",z);E.endEditing()}v.forEach(K,function(y){y&&
y.isInstanceOf(r)&&y.set("disabled",!1)});f.set(this.sourceArea,"display","none");f.set(E.iframe,{position:"relative",visibility:"visible"});delete E._sourceQueryCommandEnabled;this.editor.onDisplayChanged()}setTimeout(a.hitch(this,function(){var y=E.domNode.parentNode;y&&(y=G.getEnclosingWidget(y))&&y.resize&&y.resize();E.resize()}),300)}catch(y){console.log(y)}},updateState:function(){this.button.set("disabled",this.get("disabled"))},_resize:function(){var C=this.editor,E=C.getHeaderHeight(),K=
C.getFooterHeight(),D=c.position(C.domNode),z=c.getPadBorderExtents(C.iframe.parentNode),y=c.getMarginExtents(C.iframe.parentNode),x=c.getPadBorderExtents(C.domNode),n=D.w-x.w;D=D.h-(E+x.h+K);this._fsPlugin&&this._fsPlugin.isFullscreen&&(C=p.getBox(C.ownerDocument),n=C.w-x.w,D=C.h-(E+x.h+K));c.setMarginBox(this.sourceArea,{w:Math.round(n-(z.w+y.w)),h:Math.round(D-(z.h+y.h))})},_createSourceView:function(){var C=this.editor,E=C._plugins;this.sourceArea=h.create("textarea");this.readOnly&&(t.set(this.sourceArea,
"readOnly",!0),this._readOnly=!0);f.set(this.sourceArea,{padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});t.set(this.sourceArea,"aria-label",this.editor.id);h.place(this.sourceArea,C.iframe,"before");g("ie")&&C.iframe.parentNode.lastChild!==C.iframe&&f.set(C.iframe.parentNode.lastChild,{width:"0px",height:"0px",padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});C._viewsource_oldFocus=C.focus;var K=this;C.focus=function(){if(K._sourceShown)K.setSourceAreaCaret();else try{this._vsFocused?
(delete this._vsFocused,k.focus(C.editNode)):C._viewsource_oldFocus()}catch(y){console.log("ViewSource focus code error: "+y)}};var D,z;for(D=0;D<E.length;D++)if((z=E[D])&&("dijit._editor.plugins.FullScreen"===z.declaredClass||z.declaredClass===u._scopeName+"._editor.plugins.FullScreen")){this._fsPlugin=z;break}this._fsPlugin&&(this._fsPlugin._viewsource_getAltViewNode=this._fsPlugin._getAltViewNode,this._fsPlugin._getAltViewNode=function(){return K._sourceShown?K.sourceArea:this._viewsource_getAltViewNode()});
this.own(b(this.sourceArea,"keydown",a.hitch(this,function(y){this._sourceShown&&y.keyCode==d.F12&&y.ctrlKey&&y.shiftKey&&(this.button.focus(),this.button.set("checked",!1),setTimeout(a.hitch(this,function(){C.focus()}),100),y.stopPropagation(),y.preventDefault())})))},_stripScripts:function(C){C&&(C=C.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig,""),C=C.replace(/<\s*script\b([^<>]|\s)*>?/ig,""),C=C.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig,""));return C},_stripComments:function(C){C&&
(C=C.replace(/\x3c!--(.|\s){1,}?--\x3e/g,""));return C},_stripIFrames:function(C){C&&(C=C.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig,""));return C},_stripEventHandlers:function(C){if(C){var E=C.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);if(E)for(var K=0,D=E.length;K<D;K++){var z=E[K],y=z.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm,"");C=C.replace(z,y)}}return C},_filter:function(C){C&&(this.stripScripts&&(C=this._stripScripts(C)),this.stripComments&&(C=this._stripComments(C)),
this.stripIFrames&&(C=this._stripIFrames(C)),this.stripEventHandlers&&(C=this._stripEventHandlers(C)));return C},removeValueFilterHandles:function(){this._setValueFilterHandle&&(this._setValueFilterHandle.remove(),delete this._setValueFilterHandle);this._getValueFilterHandle&&(this._getValueFilterHandle.remove(),delete this._getValueFilterHandle)},setSourceAreaCaret:function(){var C=this.sourceArea;k.focus(C);this._sourceShown&&!this.readOnly&&(C.setSelectionRange?C.setSelectionRange(0,0):this.sourceArea.createTextRange&&
(C=C.createTextRange(),C.collapse(!0),C.moveStart("character",-99999),C.moveStart("character",0),C.moveEnd("character",0),C.select()))},destroy:function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer);this._resizeHandle&&(this._resizeHandle.remove(),delete this._resizeHandle);this._setListener&&(this._setListener.remove(),delete this._setListener);this.removeValueFilterHandles();this.inherited(arguments)}});r.registry.viewSource=r.registry.viewsource=function(C){return new H({readOnly:"readOnly"in
C?C.readOnly:!1,stripComments:"stripComments"in C?C.stripComments:!0,stripScripts:"stripScripts"in C?C.stripScripts:!0,stripIFrames:"stripIFrames"in C?C.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in C?C.stripEventHandlers:!0})};return H})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k,r){v=B("dijit._editor.plugins._FontDropDown",[a,b,g],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:v,postMixInProperties:function(){this.inherited(arguments);this.strings=h.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=d.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new e({idProperty:"value",data:A.map(this.values,function(C){var E=this.strings[C]||C;return{label:this.getLabel(C,E),name:E,value:C}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(C,E){E=!1!==E;this.select.set("value",0>A.indexOf(this.values,C)?"":C,E);E||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(C){this._set("disabled",C);this.select.set("disabled",C)}});var m=B("dijit._editor.plugins._FontNameDropDown",v,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(C,E){return this.plainText?E:"\x3cdiv style\x3d'font-family: "+C+"'\x3e"+E+"\x3c/div\x3e"},_normalizeFontName:function(C){var E=this.values;if(!C||!E)return C;var K=C.split(",");if(1<K.length)for(var D=0,z=K.length;D<z;D++){var y=f.trim(K[D]);if(-1<A.indexOf(E,y))return y}return C},_setValueAttr:function(C,E){E=!1!==
E;C=this._normalizeFontName(C);this.generic&&(C={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[C]||C);this.inherited(arguments,[C,E])}}),u=B("dijit._editor.plugins._FontSizeDropDown",v,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(C,
E){return this.plainText?E:"\x3cfont size\x3d"+C+"'\x3e"+E+"\x3c/font\x3e"},_setValueAttr:function(C,E){E=!1!==E;C.indexOf&&-1!=C.indexOf("px")&&(C={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(C,10)]||C);this.inherited(arguments,[C,E])}}),G=B("dijit._editor.plugins._FormatBlockDropDown",v,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(C,E){return this.plainText||
"noFormat"==C?E:"\x3c"+C+"\x3e"+E+"\x3c/"+C+"\x3e"},_execCommand:function(C,E,K){if("noFormat"===K){var D;if((E=r.getSelection(C.window))&&0<E.rangeCount&&(K=E.getRangeAt(0),K)){E=K.startContainer;for(D=K.endContainer;E&&E!==C.editNode&&E!==C.document.body&&1!==E.nodeType;)E=E.parentNode;for(;D&&D!==C.editNode&&D!==C.document.body&&1!==D.nodeType;)D=D.parentNode;var z=c.hitch(this,function(q,F){if(q.childNodes&&q.childNodes.length){var J;for(J=0;J<q.childNodes.length;J++){var l=q.childNodes[J];if(1==
l.nodeType&&C.selection.inSelection(l)){var w=l.tagName?l.tagName.toLowerCase():"";-1!==A.indexOf(this.values,w)&&F.push(l);z(l,F)}}}});K=c.hitch(this,function(q){if(q&&q.length){for(C.beginEditing();q.length;)this._removeFormat(C,q.pop());C.endEditing()}});var y=[];if(E==D){for(D=E;D&&D!==C.editNode&&D!==C.document.body;){if(1==D.nodeType){var x=D.tagName?D.tagName.toLowerCase():"";if(-1!==A.indexOf(this.values,x)){var n=D;break}}D=D.parentNode}z(E,y);n&&(y=[n].concat(y))}else for(D=E;C.selection.inSelection(D);)1==
D.nodeType&&(x=D.tagName?D.tagName.toLowerCase():"",-1!==A.indexOf(this.values,x)&&y.push(D),z(D,y)),D=D.nextSibling;K(y);C.onDisplayChanged()}}else C.execCommand(E,K)},_removeFormat:function(C,E){if(C.customUndo){for(;E.firstChild;)t.place(E.firstChild,E,"before");E.parentNode.removeChild(E)}else{C.selection.selectElementChildren(E);var K=C.selection.getSelectedHtml();C.selection.selectElement(E);C.execCommand("inserthtml",K||"")}}}),H=B("dijit._editor.plugins.FontChoice",k,{useDefaultCommand:!1,
_initButton:function(){var C={fontName:m,fontSize:u,formatBlock:G}[this.command],E=this.params;this.params.custom&&(E.values=this.params.custom);var K=this.editor;this.button=new C(c.delegate({dir:K.dir,lang:K.lang},E));this.own(this.button.select.on("change",c.hitch(this,function(D){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=D.indexOf(" ")&&(D="'"+D+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,D):this.editor.execCommand(this.command,
D)})))},updateState:function(){var C=this.editor,E=this.command;if(C&&C.isLoaded&&E.length&&this.button){var K=this.get("disabled");this.button.set("disabled",K);if(!K){try{var D=C.queryCommandValue(E)||""}catch(y){D=""}(K=c.isString(D)&&(D.match(/'([^']*)'/)||D.match(/"([^"]*)"/)))&&(D=K[1]);"fontSize"!==E||D||(D=3);if("formatBlock"===E)if(D&&"p"!=D)0>A.indexOf(this.button.values,D)&&(D="noFormat");else{D=null;if((E=r.getSelection(this.editor.window))&&0<E.rangeCount&&(E=E.getRangeAt(0)))var z=E.endContainer;
for(;z&&z!==C.editNode&&z!==C.document;){if((E=z.tagName?z.tagName.toLowerCase():"")&&-1<A.indexOf(this.button.values,E)){D=E;break}z=z.parentNode}D||(D="noFormat")}D!==this.button.get("value")&&this.button.set("value",D,!1)}}}});A.forEach(["fontName","fontSize","formatBlock"],function(C){k.registry[C]=function(E){return new H({command:C,plainText:E.plainText})}});H._FontDropDown=v;H._FontNameDropDown=m;H._FontSizeDropDown=u;H._FormatBlockDropDown=G;return H})},"dojox/editor/plugins/Preview":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/Button dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Preview".split(" "),
function(v,A,B,t){var h=v.declare("dojox.editor.plugins.Preview",t,{useDefaultCommand:!1,styles:"",stylesheets:null,iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=v.i18n.getLocalization("dojox.editor.plugins","Preview");this.button=new A.form.Button({label:this._nlsResources.preview,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Preview",tabIndex:"-1",onClick:v.hitch(this,"_preview")})},setEditor:function(c){this.editor=c;this._initButton()},
updateState:function(){this.button.set("disabled",this.get("disabled"))},_preview:function(){try{var c=this.editor.get("value"),f="\t\t\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dUTF-8'\x3e\n",e;if(this.stylesheets)for(e=0;e<this.stylesheets.length;e++)f+="\t\t\x3clink rel\x3d'stylesheet' type\x3d'text/css' href\x3d'"+this.stylesheets[e]+"'\x3e\n";this.styles&&(f+="\t\t\x3cstyle\x3e"+this.styles+"\x3c/style\x3e\n");c="\x3chtml\x3e\n\t\x3chead\x3e\n"+f+"\t\x3c/head\x3e\n\t\x3cbody\x3e\n"+
c+"\n\t\x3c/body\x3e\n\x3c/html\x3e";var d=window.open("javascript: ''",this._nlsResources.preview,"status\x3d1,menubar\x3d0,location\x3d0,toolbar\x3d0");d.document.open();d.document.write(c);d.document.close()}catch(a){console.warn(a)}}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(c){c.plugin||"preview"!==c.args.name.toLowerCase()||(c.plugin=new h({styles:"styles"in c.args?c.args.styles:"",stylesheets:"stylesheets"in c.args?c.args.stylesheets:null}))});return h})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),
function(v,A,B,t,h,c){var f=B("dijit._editor.plugins.TextColor",h,{buttonClass:c,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var e=this;this.button.loadDropDown=function(d){function a(b){e.button.dropDown=new b({dir:e.editor.dir,ownerDocument:e.editor.ownerDocument,value:e.value,onChange:function(g){e.editor.execCommand(e.command,g)},onExecute:function(){e.editor.execCommand(e.command,this.get("value"))}});d()}"string"==
typeof e.colorPicker?v([e.colorPicker],a):a(e.colorPicker)}},updateState:function(){var e=this.editor,d=this.command;if(e&&e.isLoaded&&d.length){if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{var b=e.queryCommandValue(d)||""}catch(g){b=""}}""==b&&(b="#000000");"transparent"==b&&(b="#ffffff");"string"==typeof b?-1<b.indexOf("rgb")&&(b=A.fromRgb(b).toHex()):(b=((b&255)<<16|b&65280|(b&16711680)>>>16).toString(16),b="#000000".slice(0,7-b.length)+b);this.value=
b;(e=this.button.dropDown)&&e.get&&b!==e.get("value")&&e.set("value",b,!1)}}});h.registry.foreColor=function(e){return new f(e)};h.registry.hiliteColor=function(e){return new f(e)};return f})},"dojox/editor/plugins/ToolbarLineBreak":function(){define("dojo dijit dojox dijit/_Widget dijit/_TemplatedMixin dijit/_editor/_Plugin dojo/_base/declare".split(" "),function(v,A,B,t,h,c,f){var e=f("dojox.editor.plugins.ToolbarLineBreak",[t,h],{templateString:"\x3cspan class\x3d'dijit dijitReset'\x3e\x3cbr\x3e\x3c/span\x3e",
postCreate:function(){v.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(d){if(!d.plugin){var a=d.args.name.toLowerCase();if("||"===a||"toolbarlinebreak"===a)d.plugin=new c({button:new e,setEditor:function(b){this.editor=b}})}});return e})},"dojox/editor/plugins/FindReplace":function(){define("dojo dijit dojox dijit/_base/manager dijit/_base/popup dijit/_Widget dijit/_TemplatedMixin dijit/_KeyNavContainer dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/Toolbar dijit/form/CheckBox dijit/form/_TextBoxMixin dijit/form/TextBox dijit/_editor/_Plugin dijit/form/Button dijit/form/DropDownButton dijit/form/ToggleButton ./ToolbarLineBreak dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/FindReplace".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k,r){v.experimental("dojox.editor.plugins.FindReplace");var m=v.declare("dojox.editor.plugins._FindReplaceCloseBox",[c,f,d],{btnId:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'float: right' class\x3d'dijitInline' tabindex\x3d'-1'\x3e\x3cbutton class\x3d'dijit dijitReset dijitInline' id\x3d'${btnId}' dojoAttachPoint\x3d'button' dojoType\x3d'dijit.form.Button' tabindex\x3d'-1' iconClass\x3d'dijitEditorIconsFindReplaceClose' showLabel\x3d'false'\x3eX\x3c/button\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=A.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.btnId=this.id+"_close";this.inherited(arguments)},startup:function(){this.connect(this.button,"onClick","onClick")},onClick:function(){}}),u=v.declare("dojox.editor.plugins._FindReplaceTextBox",[c,f,d],{textId:"",label:"",toolTip:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceTextBox' title\x3d'${tooltip}' tabindex\x3d'-1'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${textId}' tabindex\x3d'-1'\x3e${label}\x3c/label\x3e\x3cinput dojoType\x3d'dijit.form.TextBox' intermediateChanges\x3d'true' class\x3d'focusTextBox' tabIndex\x3d'0' id\x3d'${textId}' dojoAttachPoint\x3d'textBox, focusNode' value\x3d'' dojoAttachEvent\x3d'onKeyPress: _onKeyPress'/\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=A.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.textId=this.id+"_text";this.inherited(arguments)},postCreate:function(){this.textBox.set("value","");this.disabled=this.textBox.get("disabled");this.connect(this.textBox,"onChange","onChange");v.attr(this.textBox.textbox,"formnovalidate","true")},_setValueAttr:function(E){this.value=E;this.textBox.set("value",E)},focus:function(){this.textBox.focus()},_setDisabledAttr:function(E){this.disabled=E;this.textBox.set("disabled",
E)},onChange:function(E){this.value=E},_onKeyPress:function(E){var K=0,D=0;!E.target||E.ctrlKey||E.altKey||E.shiftKey||(E.keyCode==v.keys.LEFT_ARROW?(K=E.target.selectionStart,D=E.target.selectionEnd,K<D&&(A.selectInputText(E.target,K,K),v.stopEvent(E))):E.keyCode==v.keys.RIGHT_ARROW&&(K=E.target.selectionStart,D=E.target.selectionEnd,K<D&&(A.selectInputText(E.target,D,D),v.stopEvent(E))))}}),G=v.declare("dojox.editor.plugins._FindReplaceCheckBox",[c,f,d],{checkId:"",label:"",tooltip:"",widget:null,
widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' tabindex\x3d'-1' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceCheckBox' title\x3d'${tooltip}' \x3e\x3cinput dojoType\x3d'dijit.form.CheckBox' tabIndex\x3d'0' id\x3d'${checkId}' dojoAttachPoint\x3d'checkBox, focusNode' value\x3d''/\x3e\x3clabel tabindex\x3d'-1' class\x3d'dijitLeft dijitInline' for\x3d'${checkId}'\x3e${label}\x3c/label\x3e\x3c/span\x3e",postMixInProperties:function(){this.id=A.getUniqueId(this.declaredClass.replace(/\./g,
"_"));this.checkId=this.id+"_check";this.inherited(arguments)},postCreate:function(){this.checkBox.set("checked",!1);this.disabled=this.checkBox.get("disabled");this.checkBox.isFocusable=function(){return!1}},_setValueAttr:function(E){this.checkBox.set("value",E)},_getValueAttr:function(){return this.checkBox.get("value")},focus:function(){this.checkBox.focus()},_setDisabledAttr:function(E){this.disabled=E;this.checkBox.set("disabled",E)}}),H=v.declare("dojox.editor.plugins._FindReplaceToolbar",b,
{postCreate:function(){this.connectKeyNavHandlers([],[]);this.connect(this.containerNode,"onclick","_onToolbarEvent");this.connect(this.containerNode,"onkeydown","_onToolbarEvent");v.addClass(this.domNode,"dijitToolbar")},addChild:function(E,K){A._KeyNavContainer.superclass.addChild.apply(this,arguments)},_onToolbarEvent:function(E){E.stopPropagation()}}),C=v.declare("dojox.editor.plugins.FindReplace",[r],{buttonClass:A.form.ToggleButton,iconClassPrefix:"dijitEditorIconsFindReplace",editor:null,button:null,
_frToolbar:null,_closeBox:null,_findField:null,_replaceField:null,_findButton:null,_replaceButton:null,_replaceAllButton:null,_caseSensitive:null,_backwards:null,_promDialog:null,_promDialogTimeout:null,_strings:null,_bookmark:null,_initButton:function(){this._strings=v.i18n.getLocalization("dojox.editor.plugins","FindReplace");this.button=new A.form.ToggleButton({label:this._strings.findReplace,showLabel:!1,iconClass:this.iconClassPrefix+" dijitEditorIconFindString",tabIndex:"-1",onChange:v.hitch(this,
"_toggleFindReplace")});v.isOpera&&this.button.set("disabled",!0);this.connect(this.button,"set",v.hitch(this,function(E,K){"disabled"===E&&this._toggleFindReplace(!K&&this._displayed,!0,!0)}))},setEditor:function(E){this.editor=E;this._initButton()},toggle:function(){this.button.set("checked",!this.button.get("checked"))},_toggleFindReplace:function(E,K,D){var z=v.marginBox(this.editor.domNode);E&&!v.isOpera?(v.style(this._frToolbar.domNode,"display","block"),this._populateFindField(),K||(this._displayed=
!0)):(v.style(this._frToolbar.domNode,"display","none"),K||(this._displayed=!1),D||this.editor.focus());this.editor.resize({h:z.h})},_populateFindField:function(){var E=this.editor._sCall("getSelectedText",[null]);this._findField&&this._findField.textBox&&(E&&this._findField.textBox.set("value",E),this._findField.textBox.focus(),A.selectInputText(this._findField.textBox.focusNode))},setToolbar:function(E){this.inherited(arguments);if(!v.isOpera){var K=this._frToolbar=new H;v.style(K.domNode,"display",
"none");v.place(K.domNode,E.domNode,"after");K.startup();this._closeBox=new m;K.addChild(this._closeBox);this._findField=new u({label:this._strings.findLabel,tooltip:this._strings.findTooltip});K.addChild(this._findField);this._replaceField=new u({label:this._strings.replaceLabel,tooltip:this._strings.replaceTooltip});K.addChild(this._replaceField);K.addChild(new B.editor.plugins.ToolbarLineBreak);this._findButton=new A.form.Button({label:this._strings.findButton,showLabel:!0,iconClass:this.iconClassPrefix+
" dijitEditorIconFind"});this._findButton.titleNode.title=this._strings.findButtonTooltip;K.addChild(this._findButton);this._replaceButton=new A.form.Button({label:this._strings.replaceButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplace"});this._replaceButton.titleNode.title=this._strings.replaceButtonTooltip;K.addChild(this._replaceButton);this._replaceAllButton=new A.form.Button({label:this._strings.replaceAllButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplaceAll"});
this._replaceAllButton.titleNode.title=this._strings.replaceAllButtonTooltip;K.addChild(this._replaceAllButton);this._caseSensitive=new G({label:this._strings.matchCase,tooltip:this._strings.matchCaseTooltip});K.addChild(this._caseSensitive);this._backwards=new G({label:this._strings.backwards,tooltip:this._strings.backwardsTooltip});K.addChild(this._backwards);this._findButton.set("disabled",!0);this._replaceButton.set("disabled",!0);this._replaceAllButton.set("disabled",!0);this.connect(this._findField,
"onChange","_checkButtons");this.connect(this._findField,"onKeyDown","_onFindKeyDown");this.connect(this._replaceField,"onKeyDown","_onReplaceKeyDown");this.connect(this._findButton,"onClick","_find");this.connect(this._replaceButton,"onClick","_replace");this.connect(this._replaceAllButton,"onClick","_replaceAll");this.connect(this._closeBox,"onClick","toggle");this._promDialog=new A.TooltipDialog;this._promDialog.startup();this._promDialog.set("content","")}},_checkButtons:function(){this._findField.get("value")?
(this._findButton.set("disabled",!1),this._replaceButton.set("disabled",!1),this._replaceAllButton.set("disabled",!1)):(this._findButton.set("disabled",!0),this._replaceButton.set("disabled",!0),this._replaceAllButton.set("disabled",!0))},_onFindKeyDown:function(E){E.keyCode==v.keys.ENTER&&(this._find(),v.stopEvent(E))},_onReplaceKeyDown:function(E){E.keyCode==v.keys.ENTER&&(this._replace()||this._replace(),v.stopEvent(E))},_find:function(E){var K=this._findField.get("value")||"";if(K){var D=this._caseSensitive.get("value"),
z=this._backwards.get("value");K=this._findText(K,D,z);!K&&E&&(this._promDialog.set("content",v.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextFind})),A.popup.open({popup:this._promDialog,around:this._findButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;A.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this.editor.focus()}),0));return K}return!1},_replace:function(E){var K=
!1,D=this.editor;D.focus();var z=this._findField.get("value")||"",y=this._replaceField.get("value")||"";if(z){var x=this._caseSensitive.get("value"),n=this._backwards.get("value"),q=D._sCall("getSelectedText",[null]);v.isMoz&&(z=v.trim(z),q=v.trim(q));z=this._filterRegexp(z,!x);q&&z.test(q)&&(D.execCommand("inserthtml",y),K=!0,n&&(this._findText(y,x,n),D._sCall("collapse",[!0])));!this._find(!1)&&E&&(this._promDialog.set("content",v.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextReplace})),
A.popup.open({popup:this._promDialog,around:this._replaceButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;A.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this.editor.focus()}),0));return K}return null},_replaceAll:function(E){var K=0;this._backwards.get("value")?this.editor.placeCursorAtEnd():this.editor.placeCursorAtStart();this._replace(!1)&&K++;var D=v.hitch(this,function(){this._replace(!1)?
(K++,setTimeout(D,10)):E&&(this._promDialog.set("content",v.string.substitute(this._strings.replaceDialogText,{0:""+K})),A.popup.open({popup:this._promDialog,around:this._replaceAllButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;A.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this._findField.focus();this._findField.textBox.focusNode.select()}),0))});D()},_findText:function(E,K,
D){var z=this.editor,y=z.window,x=!1;if(E)if(y.find)x=y.find(E,K,D,!1,!1,!1,!1);else{var n=z.document;if(n.selection||y.getSelection)if(this.editor.focus(),z=n.body.createTextRange(),x=z.duplicate(),y.getSelection().getRangeAt(0),(n=n.selection?n.selection.createRange():null)?D?z.setEndPoint("EndToStart",n):z.setEndPoint("StartToEnd",n):this._bookmark&&(y=y.getSelection().toString(),z.moveToBookmark(this._bookmark),z.text!=y?(z=x.duplicate(),this._bookmark=null):(D?x.setEndPoint("EndToStart",z):x.setEndPoint("StartToEnd",
z),z=x.duplicate())),K=K?4:0,D&&(K|=1),x=z.findText(E,z.text.length,K))z.select(),this._bookmark=z.getBookmark()}return x},_filterRegexp:function(E,K){for(var D="",z=null,y=0;y<E.length;y++)switch(z=E.charAt(y),z){case "\\":D+=z;y++;D+=E.charAt(y);break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":D+="\\";default:D+=z}D="^"+D+"$";return K?new RegExp(D,"mi"):new RegExp(D,"m")},updateState:function(){this.button.set("disabled",this.get("disabled"))},
destroy:function(){this.inherited(arguments);this._promDialogTimeout&&(clearTimeout(this._promDialogTimeout),this._promDialogTimeout=null,A.popup.close(this._promDialog));this._frToolbar&&(this._frToolbar.destroyRecursive(),this._frToolbar=null);this._promDialog&&(this._promDialog.destroyRecursive(),this._promDialog=null)}});C._FindReplaceCloseBox=m;C._FindReplaceTextBox=u;C._FindReplaceCheckBox=G;C._FindReplaceToolbar=H;v.subscribe(A._scopeName+".Editor.getPlugin",null,function(E){E.plugin||"findreplace"!==
E.args.name.toLowerCase()||(E.plugin=new C({}))});return C})},"dojox/editor/plugins/PasteFromWord":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/RichText dijit/form/Button dijit/Dialog dojox/html/format dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/PasteFromWord dojo/i18n!dijit/nls/common dojo/i18n!dijit/_editor/nls/commands".split(" "),function(v,A,B,t){var h=v.declare("dojox.editor.plugins.PasteFromWord",
t,{iconClassPrefix:"dijitAdditionalEditorIcon",width:"400px",height:"300px",_template:"\x3cdiv class\x3d'dijitPasteFromWordEmbeddedRTE'\x3e\x3cdiv style\x3d'width: ${width}; padding-top: 5px; padding-bottom: 5px;'\x3e${instructions}\x3c/div\x3e\x3cdiv id\x3d'${uId}_rte' style\x3d'width: ${width}; height: ${height}'\x3e\x3c/div\x3e\x3ctable style\x3d'width: ${width}' tabindex\x3d'-1'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_paste'\x3e${paste}\x3c/button\x3e\x26nbsp;\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_cancel'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",
_filters:[{regexp:/(<meta\s*[^>]*\s*>)|(<\s*link\s* href="file:[^>]*\s*>)|(<\/?\s*\w+:[^>]*\s*>)/gi,handler:""},{regexp:/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,handler:""},{regexp:/(class="Mso[^"]*")|(\x3c!--(.|\s){1,}?--\x3e)/gi,handler:""},{regexp:/(<p[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/p[^>]*>)|(<p[^>]*>\s*<font[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/\s*font\s*>\s<\/p[^>]*>)/ig,handler:""},{regexp:/(style="[^"]*mso-[^;][^"]*")|(style="margin:\s*[^;"]*;")/gi,
handler:""},{regexp:/(<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>)|(<\s*script\b([^<>]|\s)*>?)|(<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>)/ig,handler:""},{regexp:/<(\/?)o:p[^>]*>/gi,handler:""}],_initButton:function(){this._filters=this._filters.slice(0);var c=v.i18n.getLocalization("dojox.editor.plugins","PasteFromWord");v.mixin(c,v.i18n.getLocalization("dijit","common"));v.mixin(c,v.i18n.getLocalization("dijit._editor","commands"));this.button=new A.form.Button({label:c.pasteFromWord,
showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"PasteFromWord",tabIndex:"-1",onClick:v.hitch(this,"_openDialog")});this._uId=A.getUniqueId(this.editor.id);c.uId=this._uId;c.width=this.width||"400px";c.height=this.height||"300px";this._dialog=(new A.Dialog({title:c.pasteFromWord})).placeAt(v.body());this._dialog.set("content",v.string.substitute(this._template,c));v.style(v.byId(this._uId+"_rte"),"opacity",.001);this.connect(A.byId(this._uId+"_paste"),"onClick","_paste");this.connect(A.byId(this._uId+
"_cancel"),"onClick","_cancel");this.connect(this._dialog,"onHide","_clearDialog")},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(c){this.editor=c;this._initButton()},_openDialog:function(){this._dialog.show();this._rte||setTimeout(v.hitch(this,function(){this._rte=new A._editor.RichText({height:this.height||"300px"},this._uId+"_rte");this._rte.startup();this._rte.onLoadDeferred.addCallback(v.hitch(this,function(){v.animateProperty({node:this._rte.domNode,
properties:{opacity:{start:.001,end:1}}}).play()}))}),100)},_paste:function(){var c=B.html.format.prettyPrint(this._rte.get("value"));this._dialog.hide();var f;for(f=0;f<this._filters.length;f++){var e=this._filters[f];c=c.replace(e.regexp,e.handler)}c=B.html.format.prettyPrint(c);this.editor.focus();this.editor.execCommand("inserthtml",c)},_cancel:function(){this._dialog.hide()},_clearDialog:function(){this._rte.set("value","")},destroy:function(){this._rte&&this._rte.destroy();this._dialog&&this._dialog.destroyRecursive();
delete this._dialog;delete this._rte;this.inherited(arguments)}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(c){c.plugin||"pastefromword"!==c.args.name.toLowerCase()||(c.plugin=new h({width:"width"in c.args?c.args.width:"400px",height:"height"in c.args?c.args.width:"300px"}))});return h})},"dojox/html/format":function(){define(["dojo/_base/kernel","./entities","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(v,A,B,t,h){var c=v.getObject("dojox.html.format",!0);c.prettyPrint=
function(f,e,d,a,b){var g=[],p=0,k=[],r="\t",m="",u=[],G,H=/[=]([^"']+?)(\s|>)/g,C=/style=("[^"]*"|'[^']*'|\S*)/gi,E=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;if(e&&0<e&&10>e)for(r="",G=0;G<e;G++)r+=" ";e=t.doc.createElement("div");e.innerHTML=f;var K=A.encode,D=A.decode,z=e.ownerDocument.createElement("div"),y=function(l){l=l.cloneNode(!1);z.appendChild(l);l=z.innerHTML;z.innerHTML="";return l},x=function(){var l;for(l=0;l<p;l++)g.push(r)},n=function(){g.push("\n")},q=function(l){var w;l=l.split("\n");for(w=
0;w<l.length;w++)l[w]=v.trim(l[w]);l=l.join(" ");l=v.trim(l);if(""!==l){var I=[];if(d&&0<d){var M="";for(w=0;w<p;w++)M+=r;w=M.length;M=d;for(d>w&&(M-=w);l;)if(l.length>d){for(w=M;0<w&&" "!==l.charAt(w);w--);if(!w)for(w=M;w<l.length&&" "!==l.charAt(w);w++);var L=l.substring(0,w);L=v.trim(L);l=v.trim(l.substring(w==l.length?l.length:w+1,l.length));if(L){var P="";for(w=0;w<p;w++)P+=r;L=P+L+"\n"}I.push(L)}else{P="";for(w=0;w<p;w++)P+=r;l=P+l+"\n";I.push(l);l=null}return I.join("")}P="";for(w=0;w<p;w++)P+=
r;return l=P+l+"\n"}return""},F=function(l){var w=l.nodeName.toLowerCase(),I=v.trim(y(l));l=I.substring(0,I.indexOf("\x3e")+1);l=l.replace(H,'\x3d"$1"$2');l=l.replace(C,function(L){var P=L.substring(0,6);L=L.substring(6,L.length);var O=L.charAt(0);L=v.trim(L.substring(1,L.length-1));L=L.split(";");var Q=[];B.forEach(L,function(R){if(R=v.trim(R))R=R.substring(0,R.indexOf(":")).toLowerCase()+R.substring(R.indexOf(":"),R.length),Q.push(R)});Q=Q.sort();L=Q.join("; ");var N=v.trim(L);return N&&";"!==N?
P+O+(L+";")+O:""});var M=[];l=l.replace(E,function(L){M.push(v.trim(L));return""});M=M.sort();l="\x3c"+w;M.length&&(l+=" "+M.join(" "));-1!=I.indexOf("\x3c/")?(k.push(w),l+="\x3e"):(l=b?l+" /\x3e":l+"\x3e",k.push(!1));a:switch(w){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "small":w=!0;break a;default:w=!1}u.push(w);m&&!w&&(g.push(q(m)),m="");w?m+=l:(x(),g.push(l),n(),p++)},J=
function(l){var w=l.childNodes;if(w){var I;for(I=0;I<w.length;I++){var M=w[I];if(1===M.nodeType){var L=v.trim(M.tagName.toLowerCase());if(!h("ie")||M.parentNode==l)if(!L||"/"!==L.charAt(0)){F(M);if("script"===L){L=g;var P=L.push,O=void 0,Q=O=void 0,N=void 0;if(N=M.innerHTML){N&&(N=N.replace(/&quot;/gi,'"'),N=N.replace(/&gt;/gi,"\x3e"),N=N.replace(/&lt;/gi,"\x3c"),N=N.replace(/&amp;/gi,"\x26"));M=0;var R=N.split("\n"),S=[];for(N=0;N<R.length;N++){var T=R[N],U=-1<T.indexOf("\n");if(T=v.trim(T)){U=M;
for(O=0;O<T.length;O++)Q=T.charAt(O),"{"===Q?M++:"}"===Q&&(M--,U=M);O="";for(Q=0;Q<p+U;Q++)O+=r;S.push(O+T+"\n")}else U&&0===N&&S.push("\n")}N=S.join("")}P.call(L,N)}else"pre"===L?(L=M.innerHTML,h("mozilla")&&(L=L.replace("\x3cbr\x3e","\n"),L=L.replace("\x3cpre\x3e",""),L=L.replace("\x3c/pre\x3e","")),"\n"!==L.charAt(L.length-1)&&(L+="\n"),g.push(L)):J(M);L=u.pop();m&&!L&&(g.push(q(m)),m="");(P=k.pop())?(P="\x3c/"+P+"\x3e",L?m+=P:(p--,x(),g.push(P),n())):p--}}else 3===M.nodeType||4===M.nodeType?m+=
K(M.nodeValue,a):8===M.nodeType&&(L=D(M.nodeValue,a),x(),g.push("\x3c!--"),n(),p++,g.push(q(L)),p--,x(),g.push("--\x3e"),n())}}};J(e);m&&(g.push(q(m)),m="");return g.join("")};return c})},"dojox/editor/plugins/InsertAnchor":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/range dijit/_Templated dijit/TooltipDialog dijit/form/ValidationTextBox dijit/form/Select dijit/form/Button dijit/form/DropDownButton dojo/_base/declare dojo/i18n dojo/string dojo/NodeList-dom dojox/editor/plugins/ToolbarLineBreak dojo/i18n!dojox/editor/plugins/nls/InsertAnchor dojo/i18n!dijit/nls/common".split(" "),
function(v,A,B,t){var h=v.declare("dojox.editor.plugins.InsertAnchor",t,{htmlTemplate:'\x3ca name\x3d"${anchorInput}" class\x3d"dijitEditorPluginInsertAnchorStyle"\x3e${textInput}\x3c/a\x3e',iconClassPrefix:"dijitAdditionalEditorIcon",_template:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_anchorInput'\x3e${anchor}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_anchorInput' name\x3d'anchorInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${cancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){var c=this,f=v.i18n.getLocalization("dojox.editor.plugins","InsertAnchor",this.lang),e=this.dropDown=new A.TooltipDialog({title:f.title,execute:v.hitch(this,"setValue"),onOpen:function(){c._onOpenDialog();A.TooltipDialog.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(v.hitch(c,"_onCloseDialog"),0)}});this.button=new A.form.DropDownButton({label:f.insertAnchor,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"InsertAnchor",tabIndex:"-1",
dropDown:this.dropDown});f.id=A.getUniqueId(this.editor.id);this._uniqueId=f.id;this.dropDown.set("content",e.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+v.string.substitute(this._template,f));e.startup();this._anchorInput=A.byId(this._uniqueId+"_anchorInput");this._textInput=A.byId(this._uniqueId+"_textInput");this._setButton=A.byId(this._uniqueId+"_setButton");this.connect(A.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel()});
this._anchorInput&&this.connect(this._anchorInput,"onChange","_checkInput");this._textInput&&this.connect(this._anchorInput,"onChange","_checkInput");this.editor.contentDomPreFilters.push(v.hitch(this,this._preDomFilter));this.editor.contentDomPostFilters.push(v.hitch(this,this._postDomFilter));this._setup()},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(c){this.editor=c;this._initButton()},_checkInput:function(){var c=!0;this._anchorInput.isValid()&&
(c=!1);this._setButton.set("disabled",c)},_setup:function(){this.editor.onLoadDeferred.addCallback(v.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);setTimeout(v.hitch(this,function(){this._applyStyles()}),100)}))},getAnchorStyle:function(){var c=v.moduleUrl(B._scopeName,"editor/plugins/resources").toString();if(!c.match(/^https?:\/\//i)&&!c.match(/^file:\/\//i)){var f="/"===c.charAt(0)?v.doc.location.protocol+"//"+v.doc.location.host:this._calcBaseUrl(v.global.location.href);
"/"!==f[f.length-1]&&"/"!==c.charAt(0)&&(f+="/");c=f+c}return"@media screen {\n\t.dijitEditorPluginInsertAnchorStyle {\n\t\tbackground-image: url({MODURL}/images/anchor.gif);\n\t\tbackground-repeat: no-repeat;\n\t\tbackground-position: top left;\n\t\tborder-width: 1px;\n\t\tborder-style: dashed;\n\t\tborder-color: #D0D0D0;\n\t\tpadding-left: 20px;\n\t}\n}\n".replace(/\{MODURL\}/gi,c)},_applyStyles:function(){if(!this._styled)try{this._styled=!0;var c=this.editor.document,f=this.getAnchorStyle();if(v.isIE)c.createStyleSheet("").cssText=
f;else{var e=c.createElement("style");e.appendChild(c.createTextNode(f));c.getElementsByTagName("head")[0].appendChild(e)}}catch(d){}},_calcBaseUrl:function(c){var f=null;null!==c&&(f=c.indexOf("?"),-1!=f&&(c=c.substring(0,f)),f=c.lastIndexOf("/"),f=0<f&&f<c.length?c.substring(0,f):c);return f},_checkValues:function(c){c&&(c.anchorInput&&(c.anchorInput=c.anchorInput.replace(/"/g,"\x26quot;")),c.textInput||(c.textInput="\x26nbsp;"));return c},setValue:function(c){this._onCloseDialog();if(!this.editor.window.getSelection){var f=
A.range.getSelection(this.editor.window).getRangeAt(0).endContainer;3===f.nodeType&&(f=f.parentNode);f&&f.nodeName&&"a"!==f.nodeName.toLowerCase()&&(f=this.editor._sCall("getSelectedElement",["a"]));f&&f.nodeName&&"a"===f.nodeName.toLowerCase()&&this.editor.queryCommandEnabled("unlink")&&(this.editor._sCall("selectElementChildren",[f]),this.editor.execCommand("unlink"))}c=this._checkValues(c);this.editor.execCommand("inserthtml",v.string.substitute(this.htmlTemplate,c))},_onCloseDialog:function(){this.editor.focus()},
_getCurrentValues:function(c){if(c&&"a"===c.tagName.toLowerCase()&&v.attr(c,"name")){var f=v.attr(c,"name");var e=c.textContent||c.innerText;this.editor._sCall("selectElement",[c,!0])}else e=this.editor._sCall("getSelectedText");return{anchorInput:f||"",textInput:e||""}},_onOpenDialog:function(){if(this.editor.window.getSelection)var c=this.editor._sCall("getAncestorElement",["a"]);else c=A.range.getSelection(this.editor.window).getRangeAt(0).endContainer,3===c.nodeType&&(c=c.parentNode),c&&c.nodeName&&
"a"!==c.nodeName.toLowerCase()&&(c=this.editor._sCall("getSelectedElement",["a"]));this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(c))},_onDblClick:function(c){c&&c.target&&(c=c.target,"a"===(c.tagName?c.tagName.toLowerCase():"")&&v.attr(c,"name")&&(this.editor.onDisplayChanged(),this.editor._sCall("selectElement",[c]),setTimeout(v.hitch(this,function(){this.button.set("disabled",!1);this.button.openDropDown();this.button.dropDown.focus&&this.button.dropDown.focus()}),
10)))},_preDomFilter:function(c){v.query("a[name]:not([href])",this.editor.editNode).addClass("dijitEditorPluginInsertAnchorStyle")},_postDomFilter:function(c){c&&v.query("a[name]:not([href])",c).removeClass("dijitEditorPluginInsertAnchorStyle");return c}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin){var f=c.args.name;f&&(f=f.toLowerCase());"insertanchor"===f&&(c.plugin=new h)}});return h})},"dojox/editor/plugins/Blockquote":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/ToggleButton dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Blockquote".split(" "),
function(v,A,B,t){var h=v.declare("dojox.editor.plugins.Blockquote",t,{iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=v.i18n.getLocalization("dojox.editor.plugins","Blockquote");this.button=new A.form.ToggleButton({label:this._nlsResources.blockquote,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Blockquote",tabIndex:"-1",onClick:v.hitch(this,"_toggleQuote")})},setEditor:function(c){this.editor=c;this._initButton();this.connect(this.editor,
"onNormalizedDisplayChanged","updateState");c.customUndo=!0},_toggleQuote:function(c){try{var f=this.editor;f.focus();var e=this.button.get("checked"),d=A.range.getSelection(f.window),a,b,g,p;d&&0<d.rangeCount&&(a=d.getRangeAt(0));if(a){f.beginEditing();if(e)if(a.startContainer===a.endContainer){if(this._isRootInline(a.startContainer)){for(g=a.startContainer;g&&g.parentNode!==f.editNode;)g=g.parentNode;for(;g&&g.previousSibling&&(this._isTextElement(g)||1===g.nodeType&&this._isInlineFormat(this._getTagName(g)));)g=
g.previousSibling;g&&1===g.nodeType&&!this._isInlineFormat(this._getTagName(g))&&(g=g.nextSibling);if(g){var k=f.document.createElement("blockquote");v.place(k,g,"after");k.appendChild(g);for(p=k.nextSibling;p&&(this._isTextElement(p)||1===p.nodeType&&this._isInlineFormat(this._getTagName(p)));)k.appendChild(p),p=k.nextSibling}}else{for(var r=a.startContainer;(this._isTextElement(r)||this._isInlineFormat(this._getTagName(r))||"li"===this._getTagName(r))&&r!==f.editNode&&r!==f.document.body;)r=r.parentNode;
r!==f.editNode&&r!==r.ownerDocument.documentElement&&(k=f.document.createElement("blockquote"),v.place(k,r,"after"),k.appendChild(r))}k&&(f._sCall("selectElementChildren",[k]),f._sCall("collapse",[!0]))}else{var m;g=a.startContainer;for(p=a.endContainer;g&&this._isTextElement(g)&&g.parentNode!==f.editNode;)g=g.parentNode;for(m=g;m.nextSibling&&f._sCall("inSelection",[m]);)m=m.nextSibling;p=m;if(p===f.editNode||p===f.document.body){k=f.document.createElement("blockquote");v.place(k,g,"after");var u=
this._getTagName(g);if(this._isTextElement(g)||this._isInlineFormat(u))for(f=g;f&&(this._isTextElement(f)||1===f.nodeType&&this._isInlineFormat(this._getTagName(f)));)k.appendChild(f),f=k.nextSibling;else k.appendChild(g);return}p=p.nextSibling;for(m=g;m&&m!==p;){if(1===m.nodeType){if(u=this._getTagName(m),"br"!==u){if(!window.getSelection&&"p"===u&&this._isEmpty(m)){m=m.nextSibling;continue}this._isInlineFormat(u)?k||(k=f.document.createElement("blockquote"),v.place(k,m,"after")):(k&&this._isEmpty(k)&&
k.parentNode.removeChild(k),k=f.document.createElement("blockquote"),v.place(k,m,"after"));k.appendChild(m);m=k}}else this._isTextElement(m)&&(k||(k=f.document.createElement("blockquote"),v.place(k,m,"after")),k.appendChild(m),m=k);m=m.nextSibling}k&&(this._isEmpty(k)?k.parentNode.removeChild(k):(f._sCall("selectElementChildren",[k]),f._sCall("collapse",[!0])),k=null)}else if(k=!1,a.startContainer===a.endContainer){for(b=a.endContainer;b&&b!==f.editNode&&b!==f.document.body;){if("blockquote"===(b.tagName?
b.tagName.toLowerCase():"")){k=!0;break}b=b.parentNode}if(k){for(var G;b.firstChild;)G=b.firstChild,v.place(G,b,"before");b.parentNode.removeChild(b);G&&(f._sCall("selectElementChildren",[G]),f._sCall("collapse",[!0]))}}else{g=a.startContainer;for(p=a.endContainer;g&&this._isTextElement(g)&&g.parentNode!==f.editNode;)g=g.parentNode;for(a=[];g&&g.nextSibling&&f._sCall("inSelection",[g]);)g.parentNode&&"blockquote"===this._getTagName(g.parentNode)&&(g=g.parentNode),a.push(g),g=g.nextSibling;for(var H=
this._findBlockQuotes(a);H.length;){var C=H.pop();if(C.parentNode){for(;C.firstChild;)v.place(C.firstChild,C,"before");C.parentNode.removeChild(C)}}}f.endEditing()}f.onNormalizedDisplayChanged()}catch(E){}},updateState:function(){var c=this.editor,f=this.get("disabled");if(c&&c.isLoaded&&this.button&&(this.button.set("disabled",f),!f)){f=!1;var e=A.range.getSelection(c.window);if(e&&0<e.rangeCount&&(e=e.getRangeAt(0)))var d=e.endContainer;for(;d&&d!==c.editNode&&d!==c.document;){if("blockquote"===
(d.tagName?d.tagName.toLowerCase():"")){f=!0;break}d=d.parentNode}this.button.set("checked",f)}},_findBlockQuotes:function(c){var f=[];if(c){var e;for(e=0;e<c.length;e++){var d=c[e];1===d.nodeType&&("blockquote"===this._getTagName(d)&&f.push(d),d.childNodes&&0<d.childNodes.length&&(f=f.concat(this._findBlockQuotes(d.childNodes))))}}return f},_getTagName:function(c){var f="";c&&1===c.nodeType&&(f=c.tagName?c.tagName.toLowerCase():"");return f},_isRootInline:function(c){var f=this.editor;if(this._isTextElement(c)&&
c.parentNode===f.editNode||1===c.nodeType&&this._isInlineFormat(c)&&c.parentNode===f.editNode)return!0;if(this._isTextElement(c)&&this._isInlineFormat(this._getTagName(c.parentNode))){for(c=c.parentNode;c&&c!==f.editNode&&this._isInlineFormat(this._getTagName(c));)c=c.parentNode;if(c===f.editNode)return!0}return!1},_isTextElement:function(c){return c&&3===c.nodeType||4===c.nodeType?!0:!1},_isEmpty:function(c){if(c.childNodes){var f=!0,e;for(e=0;e<c.childNodes.length;e++){var d=c.childNodes[e];if(1===
d.nodeType){if("p"!==this._getTagName(d)||v.trim(d.innerHTML)){f=!1;break}}else if(this._isTextElement(d)){if((d=v.trim(d.nodeValue))&&"\x26nbsp;"!==d&&"\u00a0"!==d){f=!1;break}}else{f=!1;break}}return f}return!0},_isInlineFormat:function(c){switch(c){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "img":case "small":return!0;default:return!1}}});v.subscribe(A._scopeName+".Editor.getPlugin",
null,function(c){c.plugin||"blockquote"!==c.args.name.toLowerCase()||(c.plugin=new h({}))});return h})},"dojox/editor/plugins/UploadImage":function(){define("dojo dijit dojox dijit/_editor/_Plugin dojo/_base/connect dojo/_base/declare dojox/form/FileUploader dijit/_editor/_Plugin".split(" "),function(v,A,B,t){v.experimental("dojox.editor.plugins.UploadImage");var h=v.declare("dojox.editor.plugins.UploadImage",t,{tempImageUrl:"",iconClassPrefix:"editorIcon",useDefaultCommand:!1,uploadUrl:"",button:null,
label:"Upload",setToolbar:function(c){this.button.destroy();this.createFileInput();c.addChild(this.button)},_initButton:function(){this.command="uploadImage";this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",arguments);delete this.command},updateState:function(){this.button.set("disabled",this.get("disabled"))},createFileInput:function(){var c=v.create("span",{innerHTML:"."},document.body);v.style(c,{width:"40px",height:"20px",paddingLeft:"8px",paddingRight:"8px"});this.button=
new B.form.FileUploader({isDebug:!0,uploadUrl:this.uploadUrl,uploadOnChange:!0,selectMultipleFiles:!1,baseClass:"dojoxEditorUploadNorm",hoverClass:"dojoxEditorUploadHover",activeClass:"dojoxEditorUploadActive",disabledClass:"dojoxEditorUploadDisabled"},c);this.connect(this.button,"onChange","insertTempImage");this.connect(this.button,"onComplete","onComplete")},onComplete:function(c,f,e){c=c[0];f=v.byId(this.currentImageId,this.editor.document);e=this.downloadPath?this.downloadPath+c.name:c.file;
f.src=e;v.attr(f,"_djrealurl",e);c.width&&(f.width=c.width,f.height=c.height)},insertTempImage:function(){this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+this.tempImageUrl+'" width\x3d"32" height\x3d"32"/\x3e')}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin)switch(c.args.name){case "uploadImage":c.plugin=new h({url:c.args.url})}});return h})},"dojox/form/FileUploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/_base/sniff dojo/query dojo/dom dojo/dom-style dojo/dom-geometry dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-form dojo/_base/config dijit/_base/manager dojo/io/iframe dojo/_base/Color dojo/_base/unload dijit/_Widget dijit/_TemplatedMixin dijit/_Contained dojox/embed/Flash dojox/embed/flashVars dojox/html/styles".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p,k,r,m,u,G,H,C,E,K,D,z,y,x){v.deprecated("dojox.form.FileUploader","Use dojox.form.Uploader","2.0");return A("dojox.form.FileUploader",[E,K,D],{swfPath:m.uploaderPath||require.toUrl("dojox/form/resources/fileuploader.swf"),templateString:'\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d"progNode"\x3e\x3cdiv dojoAttachPoint\x3d"progTextNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d"insideNode" class\x3d"uploaderInsideNode"\x3e\x3c/div\x3e\x3c/div\x3e',uploadUrl:"",
isDebug:!1,devMode:!1,baseClass:"dojoxUploaderNorm",hoverClass:"dojoxUploaderHover",activeClass:"dojoxUploaderActive",disabledClass:"dojoxUploaderDisabled",force:"",uploaderType:"",flashObject:null,flashMovie:null,insideNode:null,deferredUploading:1,fileListId:"",uploadOnChange:!1,selectMultipleFiles:!0,htmlFieldName:"uploadedfile",flashFieldName:"flashUploadFiles",fileMask:null,minFlashVersion:9,tabIndex:-1,showProgress:!1,progressMessage:"Loading",progressBackgroundUrl:require.toUrl("dijit/themes/tundra/images/buttonActive.png"),
progressBackgroundColor:"#ededed",progressWidgetId:"",skipServerCheck:!1,serverTimeout:5E3,log:function(){this.isDebug&&console.log(Array.prototype.slice.call(arguments).join(" "))},constructor:function(){this._subs=[]},postMixInProperties:function(){this.fileList=[];this._cons=[];this.fileMask=this.fileMask||[];this.fileInputs=[];this.fileCount=0;this._disabled=this.flashReady=!1;this.force=this.force.toLowerCase();this.uploaderType=(z.available>=this.minFlashVersion||"flash"==this.force)&&"html"!=
this.force?"flash":"html";this.deferredUploading=!0===this.deferredUploading?1:this.deferredUploading;this._refNode=this.srcNodeRef;this.getButtonStyle()},startup:function(){},postCreate:function(){this.inherited(arguments);this.setButtonStyle();if("flash"==this.uploaderType)var n="createFlashUploader";else this.uploaderType="html",n="createHtmlUploader";this[n]();this.fileListId&&this.connect(d.byId(this.fileListId),"click",function(q){q=q.target.parentNode.parentNode.parentNode;q.id&&-1<q.id.indexOf("file_")&&
this.removeFile(q.id.split("file_")[1])});C.addOnUnload(this,this.destroy)},getHiddenNode:function(n){if(!n)return null;var q=null;for(n=n.parentNode;n&&"body"!=n.tagName.toLowerCase();){if("none"==a.get(n,"display")){q=n;break}n=n.parentNode}return q},getButtonStyle:function(){var n=this.srcNodeRef;(this._hiddenNode=this.getHiddenNode(n))&&a.set(this._hiddenNode,"display","block");if(!n&&this.button&&this.button.domNode){var q=!0;n=this.button.domNode.className+" dijitButtonNode";var F=this.getText(e(".dijitButtonText",
this.button.domNode)[0]);this.srcNodeRef=n=k.place('\x3cbutton id\x3d"'+this.button.id+'" class\x3d"'+n+'"\x3e'+F+"\x3c/button\x3e",this.button.domNode,"after");this.button.destroy();this.baseClass="dijitButton";this.hoverClass="dijitButtonHover";this.pressClass="dijitButtonActive";this.disabledClass="dijitButtonDisabled"}else!this.srcNodeRef&&this.button&&(n=this.button);g.get(n,"class")&&(this.baseClass+=" "+g.get(n,"class"));g.set(n,"class",this.baseClass);this.norm=this.getStyle(n);this.width=
this.norm.w;this.height=this.norm.h;"flash"==this.uploaderType?(this.over=this.getTempNodeStyle(n,this.baseClass+" "+this.hoverClass,q),this.down=this.getTempNodeStyle(n,this.baseClass+" "+this.activeClass,q),this.dsbl=this.getTempNodeStyle(n,this.baseClass+" "+this.disabledClass,q),this.fhtml={cn:this.getText(n),nr:this.norm,ov:this.over,dn:this.down,ds:this.dsbl}):(this.fhtml={cn:this.getText(n),nr:this.norm},"middle"==this.norm.va&&(this.norm.lh=this.norm.h));this.devMode&&(this.log("classes - base:",
this.baseClass," hover:",this.hoverClass,"active:",this.activeClass),this.log("fhtml:",this.fhtml),this.log("norm:",this.norm),this.log("over:",this.over),this.log("down:",this.down))},setButtonStyle:function(){a.set(this.domNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+"px",padding:"0px",lineHeight:"normal",position:"relative"});"html"==this.uploaderType&&"middle"==this.norm.va&&a.set(this.domNode,"lineHeight",this.norm.lh+"px");this.showProgress?(this.progTextNode.innerHTML=this.progressMessage,
a.set(this.progTextNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",lineHeight:this.fhtml.nr.h+0+"px",position:"absolute"}),a.set(this.progNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",position:"absolute",display:"none",backgroundImage:"url("+this.progressBackgroundUrl+")",backgroundPosition:"bottom",backgroundRepeat:"repeat-x",backgroundColor:this.progressBackgroundColor})):k.destroy(this.progNode);
a.set(this.insideNode,{position:"absolute",top:"0px",left:"0px",display:""});p.add(this.domNode,this.srcNodeRef.className);-1<this.fhtml.nr.d.indexOf("inline")&&p.add(this.domNode,"dijitInline");try{this.insideNode.innerHTML=this.fhtml.cn}catch(q){if("flash"==this.uploaderType){this.insideNode=this.insideNode.parentNode.removeChild(this.insideNode);c.body().appendChild(this.insideNode);this.insideNode.innerHTML=this.fhtml.cn;var n=h.connect(this,"onReady",this,function(){h.disconnect(n);this.insideNode=
this.insideNode.parentNode.removeChild(this.insideNode);this.domNode.appendChild(this.insideNode)})}else this.insideNode.appendChild(document.createTextNode(this.fhtml.cn))}this._hiddenNode&&a.set(this._hiddenNode,"display","none")},onChange:function(n){},onProgress:function(n){},onComplete:function(n){},onCancel:function(){},onError:function(n){},onReady:function(n){},onLoad:function(n){},submit:function(n){n=n?r.toObject(n):null;this.upload(n);return!1},upload:function(n){if(!this.fileList.length)return!1;
if(!this.uploadUrl)return console.warn("uploadUrl not provided. Aborting."),!1;this.showProgress||this.set("disabled",!0);if(this.progressWidgetId){var q=u.byId(this.progressWidgetId).domNode;"none"==a.get(q,"display")&&(this.restoreProgDisplay="none",a.set(q,"display","block"));"hidden"==a.get(q,"visibility")&&(this.restoreProgDisplay="hidden",a.set(q,"visibility","visible"))}n&&!n.target&&(this.postData=n);this.log("upload type:",this.uploaderType," - postData:",this.postData);for(n=0;n<this.fileList.length;n++)q=
this.fileList[n],q.bytesLoaded=0,q.bytesTotal=q.size||1E5,q.percent=0;"flash"==this.uploaderType?this.uploadFlash():this.uploadHTML();return!1},removeFile:function(n,q){var F;for(F=0;F<this.fileList.length;F++)if(this.fileList[F].name==n){q||this.fileList.splice(F,1);break}"flash"==this.uploaderType?this.flashMovie.removeFile(n):q||(k.destroy(this.fileInputs[F]),this.fileInputs.splice(F,1),this._renumberInputs());this.fileListId&&k.destroy("file_"+n)},destroy:function(){"flash"!=this.uploaderType||
this.flashMovie?(t.forEach(this._subs,h.unsubscribe,dojo),t.forEach(this._cons,h.disconnect,dojo),this.scrollConnect&&h.disconnect(this.scrollConnect),"flash"==this.uploaderType?(this.flashObject.destroy(),delete this.flashObject):(k.destroy(this._fileInput),k.destroy(this._formNode)),this.inherited(arguments)):this._cons.push(h.connect(this,"onLoad",this,"destroy"))},_displayProgress:function(n){!0===n?("flash"==this.uploaderType?a.set(this.insideNode,"top","-2500px"):a.set(this.insideNode,"display",
"none"),a.set(this.progNode,"display","")):!1===n?(a.set(this.insideNode,{display:"",top:"0"}),a.set(this.progNode,"display","none")):a.set(this.progNode,"width",n*this.fhtml.nr.w+"px")},_animateProgress:function(){this._displayProgress(!0);var n=!1,q=h.connect(this,"_complete",function(){h.disconnect(q);n=!0}),F=0,J=setInterval(B.hitch(this,function(){F+=5;F>this.fhtml.nr.w&&(F=0,n=!0);this._displayProgress(F/this.fhtml.nr.w);n&&(clearInterval(J),setTimeout(B.hitch(this,function(){this._displayProgress(!1)}),
500))}),50)},_error:function(n){"string"==typeof n&&(n=Error(n));this.onError(n)},_addToFileList:function(){if(this.fileListId){var n="";t.forEach(this.fileList,function(q){n+='\x3ctable id\x3d"file_'+q.name+'" class\x3d"fileToUpload"\x3e\x3ctr\x3e\x3ctd class\x3d"fileToUploadClose"\x3e\x3c/td\x3e\x3ctd class\x3d"fileToUploadName"\x3e'+q.name+'\x3c/td\x3e\x3ctd class\x3d"fileToUploadSize"\x3e'+(q.size?Math.ceil(.001*q.size)+"kb":"")+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"},this);d.byId(this.fileListId).innerHTML=
n}},_change:function(n){f("ie")&&t.forEach(n,function(q){q.name=q.name.split("\\")[q.name.split("\\").length-1]});this.selectMultipleFiles?this.fileList=this.fileList.concat(n):(this.fileList[0]&&this.removeFile(this.fileList[0].name,!0),this.fileList=n);this._addToFileList();this.onChange(n);this.uploadOnChange?("html"==this.uploaderType&&this._buildFileInput(),this.upload()):"html"==this.uploaderType&&this.selectMultipleFiles&&(this._buildFileInput(),this._connectInput())},_complete:function(n){n=
B.isArray(n)?n:[n];t.forEach(n,function(q){q.ERROR&&this._error(q.ERROR)},this);t.forEach(this.fileList,function(q){q.bytesLoaded=1;q.bytesTotal=1;q.percent=100;this._progress(q)},this);t.forEach(this.fileList,function(q){this.removeFile(q.name,!0)},this);this.onComplete(n);this.fileList=[];this._resetHTML();this.set("disabled",!1);this.restoreProgDisplay&&setTimeout(B.hitch(this,function(){a.set(u.byId(this.progressWidgetId).domNode,"none"==this.restoreProgDisplay?"display":"visibility",this.restoreProgDisplay)}),
500)},_progress:function(n){for(var q=0,F=0,J=0;J<this.fileList.length;J++){var l=this.fileList[J];l.name==n.name&&(l.bytesLoaded=n.bytesLoaded,l.bytesTotal=n.bytesTotal,l.percent=Math.ceil(l.bytesLoaded/l.bytesTotal*100),this.log(l.name,"percent:",l.percent));F+=Math.ceil(.001*l.bytesLoaded);q+=Math.ceil(.001*l.bytesTotal)}n=Math.ceil(F/q*100);this.progressWidgetId&&u.byId(this.progressWidgetId).update({progress:n+"%"});this.showProgress&&this._displayProgress(.01*n);this.onProgress(this.fileList)},
_getDisabledAttr:function(){return this._disabled},_setDisabledAttr:function(n){if(this._disabled!=n){if("flash"==this.uploaderType){if(!this.flashReady){var q=h.connect(this,"onLoad",this,function(){h.disconnect(q);this._setDisabledAttr(n)});return}this._disabled=n;this.flashMovie.doDisable(n)}else this._disabled=n,a.set(this._fileInput,"display",this._disabled?"none":"");p.toggle(this.domNode,this.disabledClass,n)}},_onFlashBlur:function(){this.flashMovie.blur();if(!this.nextFocusObject&&this.tabIndex)for(var n=
e("[tabIndex]"),q=0;q<n.length;q++)if(n[q].tabIndex>=Number(this.tabIndex)+1){this.nextFocusObject=n[q];break}this.nextFocusObject.focus()},_disconnect:function(){t.forEach(this._cons,h.disconnect,dojo)},uploadHTML:function(){this.selectMultipleFiles&&k.destroy(this._fileInput);this._setHtmlPostData();this.showProgress&&this._animateProgress();G.send({url:this.uploadUrl.toString(),form:this._formNode,handleAs:"json",error:B.hitch(this,function(n){this._error("HTML Upload Error:"+n.message)}),load:B.hitch(this,
function(n,q,F){this._complete(n)})})},createHtmlUploader:function(){this._buildForm();this._setFormStyle();this._buildFileInput();this._connectInput();this._styleContent();a.set(this.insideNode,"visibility","visible");this.onReady()},_connectInput:function(){this._disconnect();this._cons.push(h.connect(this._fileInput,"mouseover",this,function(n){p.add(this.domNode,this.hoverClass);this.onMouseOver(n)}));this._cons.push(h.connect(this._fileInput,"mouseout",this,function(n){setTimeout(B.hitch(this,
function(){p.remove(this.domNode,this.activeClass);p.remove(this.domNode,this.hoverClass);this.onMouseOut(n);this._checkHtmlCancel("off")}),0)}));this._cons.push(h.connect(this._fileInput,"mousedown",this,function(n){p.add(this.domNode,this.activeClass);p.remove(this.domNode,this.hoverClass);this.onMouseDown(n)}));this._cons.push(h.connect(this._fileInput,"mouseup",this,function(n){p.remove(this.domNode,this.activeClass);this.onMouseUp(n);this.onClick(n);this._checkHtmlCancel("up")}));this._cons.push(h.connect(this._fileInput,
"change",this,function(){this._checkHtmlCancel("change");var n=this._fileInput.value;n?this._change([{name:n,type:"",size:0}]):this._change([])}));0<=this.tabIndex&&g.set(this.domNode,"tabIndex",this.tabIndex)},_checkHtmlCancel:function(n){"change"==n&&(this.dialogIsOpen=!1);"up"==n&&(this.dialogIsOpen=!0);if("off"==n){if(this.dialogIsOpen)this.onCancel();this.dialogIsOpen=!1}},_styleContent:function(){var n=this.fhtml.nr;a.set(this.insideNode,{width:n.w+"px",height:"middle"==n.va?n.h+"px":"auto",
textAlign:n.ta,paddingTop:n.p[0]+"px",paddingRight:n.p[1]+"px",paddingBottom:n.p[2]+"px",paddingLeft:n.p[3]+"px"});try{a.set(this.insideNode,"lineHeight","inherit")}catch(q){}},_resetHTML:function(){"html"==this.uploaderType&&this._formNode&&(this.fileInputs=[],e("*",this._formNode).forEach(function(n){k.destroy(n)}),this.fileCount=0,this._buildFileInput(),this._connectInput())},_buildForm:function(){this._formNode||(9>f("ie")||f("ie")&&f("quirks")?(this._formNode=document.createElement('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e'),
this._formNode.encoding="multipart/form-data",this._formNode.id=u.getUniqueId("FileUploaderForm"),this.domNode.appendChild(this._formNode)):this._formNode=k.create("form",{enctype:"multipart/form-data",method:"post",id:u.getUniqueId("FileUploaderForm")},this.domNode))},_buildFileInput:function(){this._fileInput&&(this._disconnect(),this._fileInput.id+=this.fileCount,a.set(this._fileInput,"display","none"));this._fileInput=document.createElement("input");this.fileInputs.push(this._fileInput);var n=
this.htmlFieldName;this.selectMultipleFiles&&(n+=this.fileCount,this.fileCount++);g.set(this._fileInput,{id:this.id,name:n,type:"file"});p.add(this._fileInput,"dijitFileInputReal");this._formNode.appendChild(this._fileInput);n=b.getMarginBox(this._fileInput);a.set(this._fileInput,{position:"relative",left:this.fhtml.nr.w-n.w+"px",opacity:0})},_renumberInputs:function(){if(this.selectMultipleFiles){var n;this.fileCount=0;t.forEach(this.fileInputs,function(q){n=this.htmlFieldName+this.fileCount;this.fileCount++;
g.set(q,"name",n)},this)}},_setFormStyle:function(){x.insertCssRule("#"+this._formNode.id+" input","font-size:"+Math.max(2,Math.max(Math.ceil(this.fhtml.nr.w/60),Math.ceil(this.fhtml.nr.h/15)))+"em");a.set(this.domNode,{overflow:"hidden",position:"relative"});a.set(this.insideNode,"position","absolute")},_setHtmlPostData:function(){if(this.postData)for(var n in this.postData)k.create("input",{type:"hidden",name:n,value:this.postData[n]},this._formNode)},uploadFlash:function(){try{if(this.showProgress){this._displayProgress(!0);
var n=h.connect(this,"_complete",this,function(){h.disconnect(n);this._displayProgress(!1)})}var q={},F;for(F in this.postData)q[F]=this.postData[F];this.flashMovie.doUpload(q)}catch(J){this._error("FileUploader - Sorry, the SWF failed to initialize."+J)}},createFlashUploader:function(){if(this.uploadUrl=this.uploadUrl.toString())if(0>this.uploadUrl.toLowerCase().indexOf("http")&&0!=this.uploadUrl.indexOf("/")){var n=window.location.href.split("/");n.pop();n=n.join("/")+"/";this.uploadUrl=n+this.uploadUrl;
this.log("SWF Fixed - Relative loc:",n," abs loc:",this.uploadUrl)}else this.log("SWF URL unmodified:",this.uploadUrl);else console.warn("Warning: no uploadUrl provided.");n={expressInstall:!0,path:this.swfPath.uri||this.swfPath,width:this.fhtml.nr.w,height:this.fhtml.nr.h,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName,uploadUrl:this.uploadUrl,uploadOnSelect:this.uploadOnChange,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.selectMultipleFiles,
id:this.id,isDebug:this.isDebug,devMode:this.devMode,flashButton:y.serialize("fh",this.fhtml),fileMask:y.serialize("fm",this.fileMask),noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new z(n,this.insideNode);this.flashObject.onError=B.hitch(function(q){this._error("Flash Error: "+q)});this.flashObject.onReady=B.hitch(this,function(){a.set(this.insideNode,"visibility","visible");
this.log("FileUploader flash object ready");this.onReady(this)});this.flashObject.onLoad=B.hitch(this,function(q){this.flashMovie=q;this.flashReady=!0;this.onLoad(this)});this._connectFlash()},_connectFlash:function(){this._doSub("/filesSelected","_change");this._doSub("/filesUploaded","_complete");this._doSub("/filesProgress","_progress");this._doSub("/filesError","_error");this._doSub("/filesCanceled","onCancel");this._doSub("/stageBlur","_onFlashBlur");this._doSub("/up","onMouseUp");this._doSub("/down",
"onMouseDown");this._doSub("/over","onMouseOver");this._doSub("/out","onMouseOut");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&g.set(this.domNode,"tabIndex",this.tabIndex)},_doSub:function(n,q){this._subs.push(h.subscribe(this.id+n,this,q))},urlencode:function(n){return n&&"none"!=n?n.replace(/:/g,"||").replace(/\./g,"^^").replace("url(","").replace(")","").replace(/'/g,"").replace(/"/g,""):!1},isButton:function(n){n=n.tagName.toLowerCase();
return"button"==n||"input"==n},getTextStyle:function(n){var q={};q.ff=a.get(n,"fontFamily");if(q.ff){q.ff=q.ff.replace(", ",",");q.ff=q.ff.replace(/"|'/g,"");q.ff="sans-serif"==q.ff?"Arial":q.ff;q.fw=a.get(n,"fontWeight");q.fi=a.get(n,"fontStyle");q.fs=parseInt(a.get(n,"fontSize"),10);if(-1<a.get(n,"fontSize").indexOf("%"))for(var F=n;F.tagName;){if(-1==a.get(F,"fontSize").indexOf("%")){q.fs=parseInt(a.get(F,"fontSize"),10);break}"body"==F.tagName.toLowerCase()&&(q.fs=.16*parseInt(a.get(F,"fontSize"),
10));F=F.parentNode}q.fc=(new H(a.get(n,"color"))).toHex();q.fc=parseInt(q.fc.substring(1,Infinity),16)}q.lh=a.get(n,"lineHeight");q.ta=a.get(n,"textAlign");q.ta="start"!=q.ta&&q.ta?q.ta:"left";q.va=this.isButton(n)?"middle":q.lh==q.h?"middle":a.get(n,"verticalAlign");return q},getText:function(n){n=B.trim(n.innerHTML);-1<n.indexOf("\x3c")&&(n=escape(n));return n},getStyle:function(n){var q={},F=b.getContentBox(n),J=b.getPadExtents(n);q.p=[J.t,J.w-J.l,J.h-J.t,J.l];q.w=F.w+J.w;q.h=F.h+J.h;q.d=a.get(n,
"display");F=new H(a.get(n,"backgroundColor"));q.bc=0==F.a?"#ffffff":F.toHex();q.bc=parseInt(q.bc.substring(1,Infinity),16);if(F=this.urlencode(a.get(n,"backgroundImage")))q.bi={url:F,rp:a.get(n,"backgroundRepeat"),pos:escape(a.get(n,"backgroundPosition"))},q.bi.pos||(F=a.get(n,"backgroundPositionX"),J=a.get(n,"backgroundPositionY"),q.bi.pos=escape(("left"==F?"0%":"right"==F?"100%":F)+" "+("top"==J?"0%":"bottom"==J?"100%":J)));return B.mixin(q,this.getTextStyle(n))},getTempNodeStyle:function(n,q,
F){if(F){F=k.place("\x3c"+n.tagName+"\x3e\x3cspan\x3e"+n.innerHTML+"\x3c/span\x3e\x3c/"+n.tagName+"\x3e",n.parentNode);var J=F.firstChild;p.add(J,n.className);p.add(F,q);n=this.getStyle(J)}else F=k.place("\x3c"+n.tagName+"\x3e"+n.innerHTML+"\x3c/"+n.tagName+"\x3e",n.parentNode),p.add(F,n.className),p.add(F,q),F.id=n.id,n=this.getStyle(F);k.destroy(F);return n}})})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(v,A,B,t,h,c,f,e,d,a,b,g,p){B.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");c=p._iframeName;c=c.substring(0,c.lastIndexOf("_"));var k=t.delegate(p,{create:function(){return k._frame=p.create.apply(p,arguments)},get:null,post:null,send:function(r){var m=h._ioSetArgs(r,function(K){E&&E.cancel()},function(K){var D=null;K=K.ioArgs;try{var z=K.handleAs;"xml"===z||"html"===z?D=E.response.data:(D=E.response.text,"json"===z?D=A.fromJson(D):"javascript"===z&&(D=B.eval(D)))}catch(y){D=
y}return D},function(K,D){D.ioArgs._hasError=!0;return K}),u=m.ioArgs,G="GET",H=e.byId(r.form);r.method&&"POST"===r.method.toUpperCase()&&H&&(G="POST");r={method:G,handleAs:"json"===r.handleAs||"javascript"===r.handleAs?"text":r.handleAs,form:r.form,query:H?null:r.content,data:H?r.content:null,timeout:r.timeout,ioArgs:u};r.method&&(r.method=r.method.toUpperCase());if(v.ioPublish&&B.publish&&!1!==u.args.ioPublish)var C=g.after(p,"_notifyStart",function(K){K.options.ioArgs===u&&(C.remove(),h._ioNotifyStart(m))},
!0);var E=p(u.url,r,!0);u._callNext=E._callNext;E.then(function(){m.resolve(m)}).otherwise(function(K){m.ioArgs.error=K;m.reject(K)});return m},_iframeOnload:f.global[c+"_onload"]});t.setObject("dojo.io.iframe",k);return k})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),function(v,A,B,t,h,c,f,e,d){function a(m){m=v.delegate(g,m);if(!("path"in m))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),
null;"id"in m||(m.id="dojox-embed-flash-"+b++);return m}var b=0,g={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};if(h("ie")){var p=function(m){m=a(m);if(!m)return null;var u,G=m.path;if(m.vars){var H=[];for(u in m.vars)H.push(encodeURIComponent(u)+"\x3d"+encodeURIComponent(m.vars[u]));m.params.FlashVars=H.join("\x26");delete m.vars}G='\x3cobject id\x3d"'+d.escape(String(m.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+
d.escape(String(m.width))+'" height\x3d"'+d.escape(String(m.height))+'"'+(m.style?' style\x3d"'+d.escape(String(m.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+d.escape(String(G))+'" /\x3e';if(m.params)for(u in m.params)G+='\x3cparam name\x3d"'+d.escape(u)+'" value\x3d"'+d.escape(String(m.params[u]))+'" /\x3e';return{id:m.id,markup:G+"\x3c/object\x3e"}};var k=function(){for(var m=10,u=null;!u&&7<m;)try{u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+m--)}catch(G){}return u?(m=u.GetVariable("$version").split(" ")[1].split(","),
{major:null!=m[0]?parseInt(m[0]):0,minor:null!=m[1]?parseInt(m[1]):0,rev:null!=m[2]?parseInt(m[2]):0}):{major:0,minor:0,rev:0}}();A.addOnWindowUnload(function(){console.warn("***************UNLOAD");var m=function(){};t("object").reverse().style("display","none").forEach(function(u){for(var G in u)if("FlashVars"!=G&&"function"==typeof u[G])try{u[G]=m}catch(H){}})})}else p=function(m){m=a(m);if(!m)return null;var u,G=m.path;if(m.vars){var H=[];for(u in m.vars)H.push(encodeURIComponent(u)+"\x3d"+encodeURIComponent(m.vars[u]));
m.params.flashVars=H.join("\x26");delete m.vars}G='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+d.escape(String(G))+'" id\x3d"'+d.escape(String(m.id))+'" width\x3d"'+d.escape(String(m.width))+'" height\x3d"'+d.escape(String(m.height))+'"'+(m.style?' style\x3d"'+d.escape(String(m.style))+'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(m.params)for(u in m.params)G+=" "+d.escape(u)+'\x3d"'+d.escape(String(m.params[u]))+'"';return{id:m.id,markup:G+
" /\x3e"}},k=function(){var m=navigator.plugins["Shockwave Flash"];return m&&m.description?(m=m.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=m[0]?parseInt(m[0]):0,minor:null!=m[1]?parseInt(m[1]):0,rev:null!=m[2]?parseInt(m[2]):0}):{major:0,minor:0,rev:0}}();var r=function(m,u){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
this.available=k.major;this.minimumVersion=m.minimumVersion||9;this.domNode=this.movie=this.id=null;u&&(u=c.byId(u));setTimeout(v.hitch(this,function(){if(m.expressInstall||this.available&&this.available>=this.minimumVersion)if(m&&u)this.init(m,u);else this.onError("embed.Flash was not provided with the proper arguments.");else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),
100)};v.extend(r,{onReady:function(m){},onLoad:function(m){},onError:function(m){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(m,u){this.destroy();u=c.byId(u||this.domNode);if(!u)throw Error("dojox.embed.Flash: no domNode reference has been passed.");var G=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;r.initialized&&(this.id=r.place(m,u),this.domNode=u,setTimeout(v.hitch(this,
function(){this.movie=this.byId(this.id,m.doc);this.onReady(this.movie);this._poller=setInterval(v.hitch(this,function(){try{G=this.movie.PercentLoaded()}catch(H){console.warn("this.movie.PercentLoaded() failed",H,this.movie)}if(100==G)this._onload();else if(0==G&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(m){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var m=
v.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),u;for(u in this)m[u]||delete this[u];this._poller?f(this,"Load",this,"_destroy"):this._destroy()}},byId:function(m,u){u=u||document;return u.embeds[m]?u.embeds[m]:u[m]?u[m]:window[m]?window[m]:document[m]?document[m]:null}});v.mixin(r,{minSupported:8,available:k.major,supported:k.major>=k.required,minimumRequired:k.required,version:k,initialized:!1,onInitialize:function(){r.initialized=!0},__ie_markup__:function(m){return p(m)},proxy:function(m,
u){B.forEach(u instanceof Array?u:[u],function(G){this[G]=v.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+G+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+B.map(arguments,function(H){return __flash__toXML(H)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,arguments||[])})},m)}});r.place=function(m,u){m=p(m);u=c.byId(u);u||(u=e.doc.createElement("div"),u.id=m.id+"-container",e.body().appendChild(u));return m?(u.innerHTML=m.markup,
m.id):null};r.onInitialize();v.setObject("dojox.embed.Flash",r);return r})},"dojox/embed/flashVars":function(){define(["dojo"],function(v){v.deprecated("dojox.embed.flashVars","Will be removed in 2.0","2.0");var A={serialize:function(B,t){var h=function(d){"string"==typeof d&&(d=d.replace(/;/g,"_sc_"),d=d.replace(/\./g,"_pr_"),d=d.replace(/:/g,"_cl_"));return d},c=dojox.embed.flashVars.serialize,f="";if(v.isArray(t)){for(var e=0;e<t.length;e++)f+=c(B+"."+e,h(t[e]))+";";return f.replace(/;{2,}/g,";")}if(v.isObject(t)){for(e in t)f+=
c(B+"."+e,h(t[e]))+";";return f.replace(/;{2,}/g,";")}return B+":"+t}};v.setObject("dojox.embed.flashVars",A);return A})},"dojox/html/styles":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(v,A,B,t){var h=v.getObject("dojox.html",!0),c={},f={},e=[];h.insertCssRule=function(d,a,b){b=h.getDynamicStyleSheet(b);var g=d+" {"+a+"}";console.log("insertRule:",g);t("ie")?(b.cssText+=g,console.log("ss.cssText:",b.cssText)):b.sheet?b.sheet.insertRule(g,
b._indicies.length):b.appendChild(B.doc.createTextNode(g));b._indicies.push(d+" "+a);return d};h.removeCssRule=function(d,a,b){var g=-1,p,k;for(p in c)if(!b||b===p){var r=c[p];for(k=0;k<r._indicies.length;k++)if(d+" "+a===r._indicies[k]){g=k;break}if(-1<g)break}if(!r)return console.warn("No dynamic style sheet has been created from which to remove a rule."),!1;if(-1===g)return console.warn("The css rule was not found and could not be removed."),!1;r._indicies.splice(g,1);t("ie")?r.removeRule(g):r.sheet&&
r.sheet.deleteRule(g);return!0};h.modifyCssRule=function(d,a,b){};h.getStyleSheet=function(d){if(c[d||"default"])return c[d||"default"];if(!d)return!1;var a=h.getStyleSheets();if(a[d])return h.getStyleSheets()[d];for(var b in a)if(a[b].href&&-1<a[b].href.indexOf(d))return a[b];return!1};h.getDynamicStyleSheet=function(d){d||(d="default");c[d]||(B.doc.createStyleSheet?(c[d]=B.doc.createStyleSheet(),9>t("ie")&&(c[d].title=d)):(c[d]=B.doc.createElement("style"),c[d].setAttribute("type","text/css"),B.doc.getElementsByTagName("head")[0].appendChild(c[d]),
console.log(d," ss created: ",c[d].sheet)),c[d]._indicies=[]);return c[d]};h.enableStyleSheet=function(d){if(d=h.getStyleSheet(d))d.sheet?d.sheet.disabled=!1:d.disabled=!1};h.disableStyleSheet=function(d){if(d=h.getStyleSheet(d))d.sheet?d.sheet.disabled=!0:d.disabled=!0};h.activeStyleSheet=function(d){var a=h.getToggledStyleSheets(),b;if(1===arguments.length)A.forEach(a,function(g){g.disabled=g.title===d?!1:!0});else for(b=0;b<a.length;b++)if(!1===a[b].disabled)return a[b];return!0};h.getPreferredStyleSheet=
function(){};h.getToggledStyleSheets=function(){var d;if(!e.length){var a=h.getStyleSheets();for(d in a)a[d].title&&e.push(a[d])}return e};h.getStyleSheets=function(){if(f.collected)return f;A.forEach(B.doc.styleSheets,function(d){var a=d.sheet?d.sheet:d;d=a.title||a.href;if(t("ie"))-1===a.cssText.indexOf("#default#VML")&&(a.href?f[d]=a:a.imports.length?A.forEach(a.imports,function(b){f[b.title||b.href]=b}):f[d]=a);else{f[d]=a;f[d].id=a.ownerNode.id;d=[];try{d=a[a.cssRules?"cssRules":"rules"]}catch(b){console.warn("Reading css rules from stylesheet "+
a.href+" is forbidden due to same-origin policy. See http://www.w3.org/TR/CSP/#cascading-style-sheet-css-parsing",a)}A.forEach(d,function(b){b.href&&(f[b.href]=b.styleSheet,f[b.href].id=a.ownerNode.id)})}});f.collected=!0;return f};return h})},"jimu/dijit/EditorChooseImage":function(){define("dojo dijit dijit/_editor/_Plugin jimu/dijit/ImageChooser dojo/_base/html dojo/_base/lang dojo/i18n dojo/_base/connect dojo/_base/declare".split(" "),function(v,A,B,t,h,c,f){v.experimental("dojox.editor.plugins.ChooseImage");
var e=v.declare("dojox.editor.plugins.ChooseImage",B,{iconClassPrefix:"editorIcon",useDefaultCommand:!1,_initButton:function(){this.createFileInput();this.command="chooseImage";var d=f.getLocalization("dijit._editor","commands");this.button=new A.form.Button({label:d.insertImage,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"UploadImage",tabIndex:"-1",onClick:c.hitch(this,this._chooseImage)});this.button.set("readOnly",!1);this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",
arguments);delete this.command},updateState:function(){var d=this.get("disabled");this.button.set("disabled",this.get("disabled"));!0===d?(h.addClass(this.button,"dijitButtonDisabled"),this.imageChooser.disableChooseImage()):(h.removeClass(this.button,"dijitButtonDisabled"),this.imageChooser.enableChooseImage())},createFileInput:function(){var d=v.create("span",{innerHTML:"."},document.body);this.imageChooser=new t({showSelfImg:!1,cropImage:!1,format:[t.GIF,t.JPEG,t.PNG]},d);this.connect(this.imageChooser,
"onImageChange","insertTempImage")},_chooseImage:function(){h.setStyle(this.imageChooser.domNode,"display","none");this.imageChooser.triggerImgUpload()},onComplete:function(d){d=d[0];var a=v.byId(this.currentImageId,this.editor.document);var b=this.downloadPath?this.downloadPath+d.name:d.file;a.src=b;v.attr(a,"_djrealurl",b);d.width&&(a.width=d.width,a.height=d.height)},insertTempImage:function(d,a){a=a&&a.fileName?'alt\x3d"'+a.fileName+'"':"";this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",
'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+d+'" '+a+"/\x3e")},destroy:function(){this.imageChooser&&this.imageChooser.destroy();this.inherited(arguments)}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(d){if(!d.plugin)switch(d.args.name){case "chooseImage":d.plugin=new e({url:d.args.url})}});B.registry.chooseImage=function(d){return new e(d)};return e})},"jimu/dijit/EditorTextColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),
function(v,A,B,t,h,c){A.experimental("dijit.editor.plugins.EditorTextColor");var f=t("dijit.editor.plugins.EditorTextColor",h,{buttonClass:c,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorTextColor";this.hackCommand="foreColor";this.inherited(arguments);var e="",d=!1;this.params.custom&&(this.params.custom.recordUID&&(e=this.params.custom.recordUID),this.params.custom.forceAttr&&(d=this.params.custom.forceAttr));var a=this;this.button.set("iconClass",
this.iconClassPrefix+" "+this.iconClassPrefix+"ForeColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(b){function g(p){a.button.dropDown=new p({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,value:a.value,appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:e,onChange:function(k){a.editor.execCommand("useCSS",d);a.editor.execCommand("styleWithCSS",!d);a.editor.execCommand(a.hackCommand,
k)},onClose:function(){a.button.closeDropDown()}});b()}"string"===typeof a.colorPicker?v([a.colorPicker],g):g(a.colorPicker)}},updateState:function(){var e=this.editor,d=this.hackCommand;if(e&&e.isLoaded&&d.length){if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{var b=e.queryCommandValue(d)||""}catch(g){b=""}}""===b?b="#000000":"transparent"===b&&(b="rgba(0, 0, 0, 0)");this.value=b;(e=this.button.dropDown)&&e.getColor&&b!==e.getColor()&&(e.refreshRecords(),
e.setColor(b))}}});A.subscribe(B._scopeName+".Editor.getPlugin",null,function(e){if(!e.plugin)switch(e.args.name){case "editorTextColor":e.plugin=new f}});return f})},"jimu/dijit/EditorBackgroundColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),function(v,A,B,t,h,c){A.experimental("dijit.editor.plugins.EditorBackgroundColor");var f=t("dijit.editor.plugins.EditorBackgroundColor",h,{buttonClass:c,colorPicker:"jimu/dijit/ColorPalette",
useDefaultCommand:!1,_initButton:function(){this.command="editorBackgroundColor";this.hackCommand="hiliteColor";this.inherited(arguments);var e="";this.params.custom&&this.params.custom.recordUID&&(e=this.params.custom.recordUID);var d=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+"HiliteColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(a){function b(g){d.button.dropDown=new g({dir:d.editor.dir,ownerDocument:d.editor.ownerDocument,
value:d.value,appearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:e,onChange:function(p){d.editor.execCommand("useCSS",!1);d.editor.execCommand("styleWithCSS",!0);d.editor.execCommand(d.hackCommand,p)},onExecute:function(){d.editor.execCommand(d.hackCommand,this.get("value"))},onClose:function(){d.button.closeDropDown()}});a()}"string"===typeof d.colorPicker?v([d.colorPicker],b):b(d.colorPicker)}},updateState:function(){var e=
this.editor,d=this.hackCommand;if(e&&e.isLoaded&&d.length){if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{var b=e.queryCommandValue(d)||""}catch(g){b=""}}""===b?b="#000000":"transparent"===b&&(b="rgba(0, 0, 0, 0)");this.value=b;(e=this.button.dropDown)&&e.getColor&&b!==e.getColor()&&(e.refreshRecords(),e.setColor(b))}}});A.subscribe(B._scopeName+".Editor.getPlugin",null,function(e){if(!e.plugin)switch(e.args.name){case "editorBackgroundColor":e.plugin=new f}});
return f})},"widgets/BusinessAnalyst/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/templates/SelectableTreeGrid.html":'\x3cdiv class\x3d"esriMapsAnalystXNonSelectable"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"gridContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"selectionCounter" class\x3d"esriMapsAnalystXSelectableTreeCounter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/setting/Setting.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"reportInfographicTabContainer" style\x3d"width: 100%; height: 520px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"homeContentPane" title\x3d"${nls.home}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n                \x3cdiv class\x3d"editor-container" data-dojo-attach-point\x3d"editorContainer"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"editor"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n                    \x3cdiv style\x3d"float: left;"\x3e${nls.options}\x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"searchTextBoxOption"\r\n                            data-dojo-attach-point\x3d"searchTextBoxOption"\x3e\r\n                        \x3clabel for\x3d"searchTextBoxOption"\x3e${nls.searchTextBox}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"dropPinOption"\r\n                            data-dojo-attach-point\x3d"dropPinOption"\x3e\r\n                        \x3clabel for\x3d"dropPinOption"\x3e${nls.dropPin}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"drawPolygonOption"\r\n                            data-dojo-attach-point\x3d"drawPolygonOption"\x3e\r\n                        \x3clabel for\x3d"drawPolygonOption"\x3e${nls.drawPolygon}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"drawFreehandPolygonOption"\r\n                            data-dojo-attach-point\x3d"drawFreehandPolygonOption"\x3e\r\n                        \x3clabel for\x3d"drawFreehandPolygonOption"\x3e${nls.drawFreehandPolygon}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"infographicsContentPane" title\x3d"${nls.infographics}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledInfographicsOption"\r\n                        data-dojo-attach-point\x3d"disabledInfographicsOption"\x3e\r\n                    \x3clabel for\x3d"disabledInfographicsOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cdiv style\x3d"float: left;"\x3e${nls.exportOptions}\x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportPrintOption"\r\n                            data-dojo-attach-point\x3d"exportPrintOption"\x3e\r\n                        \x3clabel for\x3d"exportPrintOption"\x3e${nls.print}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportImageOption"\r\n                            data-dojo-attach-point\x3d"exportImageOption"\x3e\r\n                        \x3clabel for\x3d"exportImageOption"\x3e${nls.image}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportPDFOption"\r\n                            data-dojo-attach-point\x3d"exportPDFOption"\x3e\r\n                        \x3clabel for\x3d"exportPDFOption"\x3e${nls.pdf}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportDynamicHTMLOption"\r\n                            data-dojo-attach-point\x3d"exportDynamicHTMLOption"\x3e\r\n                        \x3clabel for\x3d"exportDynamicHTMLOption"\x3e${nls.dynamicHTML}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cspan style\x3d"float: left; margin-top: 3px;"\x3e${nls.selectCountryOrRegion}\x3c/span\x3e\r\n                \x3cdiv style\x3d"float:left; margin-left: 5px;" data-dojo-attach-point\x3d"countryDropDownContainerInfographics"\x3e\x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"infographicTreeGridContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"reportsContentPane" title\x3d"${nls.reports}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledReportsOption"\r\n                        data-dojo-attach-point\x3d"disabledReportsOption"\x3e\r\n                    \x3clabel for\x3d"disabledReportsOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cspan style\x3d"float: left; margin-top: 3px;"\x3e${nls.selectCountryOrRegion}\x3c/span\x3e\r\n                \x3cdiv style\x3d"float:left; margin-left: 5px;" data-dojo-attach-point\x3d"countryDropDownContainerReports"\x3e\x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"reportTreeGridContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"ringsContentPane" title\x3d"${nls.rings}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cspan\x3e${nls.defaultValues}\x3c/span\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                ${nls.radius}\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 1"\r\n                    data-dojo-attach-point\x3d"ringsBufferRadii1"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 3"\r\n                    data-dojo-attach-point\x3d"ringsBufferRadii2"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 5"\r\n                    data-dojo-attach-point\x3d"ringsBufferRadii3"\x3e\x3c/div\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"ringsBufferUnits"\x3e\r\n                    \x3coption value\x3d"esriMiles" selected\x3d"selected"\x3e${nls.miles}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"ringValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n                \x3cbr /\x3e\r\n                \x3cbr /\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledRingsOption"\r\n                        data-dojo-attach-point\x3d"disabledRingsOption"\x3e\r\n                    \x3clabel for\x3d"disabledRingsOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"driveTimeContentPane" title\x3d"${nls.driveTime}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cspan\x3e${nls.defaultValues}\x3c/span\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                ${nls.time}\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 5"\r\n                    data-dojo-attach-point\x3d"driveTimeBufferRadii1"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 10"\r\n                    data-dojo-attach-point\x3d"driveTimeBufferRadii2"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 15"\r\n                    data-dojo-attach-point\x3d"driveTimeBufferRadii3"\x3e\x3c/div\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"driveTimeBufferUnits"\x3e\r\n                    \x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"driveTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n                \x3cbr /\x3e\r\n                \x3cbr /\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"disabledDriveTimeOption"\r\n                        id\x3d"disabledDriveTimeOption"\x3e\r\n                    \x3clabel for\x3d"disabledDriveTimeOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"walkTimeContentPane" title\x3d"${nls.walkTime}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cspan\x3e${nls.defaultValues}\x3c/span\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                ${nls.time}\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 5"\r\n                    data-dojo-attach-point\x3d"walkTimeBufferRadii1"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 10"\r\n                    data-dojo-attach-point\x3d"walkTimeBufferRadii2"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 15"\r\n                    data-dojo-attach-point\x3d"walkTimeBufferRadii3"\x3e\x3c/div\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"walkTimeBufferUnits"\x3e\r\n                    \x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"walkTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n                \x3cbr /\x3e\r\n                \x3cbr /\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledWalkTimeOption"\r\n                        data-dojo-attach-point\x3d"disabledWalkTimeOption"\x3e\r\n                    \x3clabel for\x3d"disabledWalkTimeOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/setting/css/style.css":'.widget-setting-page .esriMapsAnalystXSelectableTreeGrid.dgrid {position: absolute; top: 33px; right: 0; left: -8px; bottom: 0; height: auto; width: auto;}.jimu-widget-business-analyst-setting .tabs {font-family: "Avenir Light"; color: #000000; height: 100%;} .jimu-widget-business-analyst-setting .tabs .tab-description {margin: 10px 0;} .jimu-widget-business-analyst-setting .jimu-tab\x3e.control\x3e.tab{background-color: #fff; border-top: 0; border-left: 0; border-right: 0; border-bottom: 1px solid #dedede; color:#898989; font-family: "Avenir Medium"; font-size: 14px;} .jimu-widget-business-analyst-setting .jimu-tab\x3e.control\x3e.tab.jimu-state-selected {border-bottom: 3px solid #24b5cc; font-family: "Avenir Heavy"; color: #000000;} .jimu-widget-business-analyst-setting .tabs .titles {font-weight: bold; font-family: "Avenir Medium"; font-size: 14px; margin: 20px 0 10px 0;} .jimu-widget-business-analyst-setting .tabs .hide{display: none;} .jimu-widget-business-analyst-setting .tabs .indent{margin-left: 20px; margin-top: 10px;} .jimu-widget-business-analyst-setting .tabs .unit-item{margin: 15px 5px 5px 5px; line-height: 18px; height: 18px; vertical-align: middle;} .jimu-widget-business-analyst-setting .tabs .clearFix {*overflow: hidden; *zoom: 1;} .jimu-widget-business-analyst-setting .tabs .clearFix:after {display: table; content: ""; width: 0; clear: both;} .jimu-widget-business-analyst-setting .tabs .view{height: 100%; overflow-y: auto;} .jimu-widget-business-analyst-setting .tabs .jimu-tab\x3e.jimu-viewstack{padding-bottom: 30px;} .jimu-widget-business-analyst-setting .validationErrorMessage {color: #FF0000; margin-top: 10px;} .jimu-widget-business-analyst-setting .validationErrorMessage.hidden {display: none;} .jimu-widget-business-analyst-setting .invalidValue {outline: 3px solid #FF0000;} .jimu-widget-business-analyst-setting .makeDefaultLink {cursor: pointer!important; color: #0079c1;} .jimu-widget-business-analyst-setting .makeDefaultLink:hover {text-decoration: underline; text-decoration-color: #0079c1;} .jimu-widget-business-analyst-setting .esriMapsAnalystXSelectableTreeLabel.default {color: #0079c1;} .jimu-widget-business-analyst-setting .editor-container {height: 325px;} .jimu-widget-business-analyst-setting .dijitEditorIFrameContainer {height: 262px;}',
"*now":function(v){v(['dojo/i18n!*preload*widgets/BusinessAnalyst/setting/nls/Setting*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/array dojo/_base/declare dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/mouse dojo/on dojo/query dojo/sniff jimu/BaseWidgetSetting jimu/utils dijit/_WidgetsInTemplateMixin dijit/Editor esri/dijit/geoenrichment/SelectableTree ../esriAnalystX/widgets/SelectableTreeGrid/SelectableTreeGrid ../utils/GEUtil ../utils/ReportUtil ../utils/ValidationUtil jimu/dijit/formSelect jimu/dijit/TabContainer jimu/dijit/EditorXssFilter dojo/NodeList-manipulate dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/ViewSource dijit/_editor/plugins/FontChoice dojox/editor/plugins/Preview dijit/_editor/plugins/TextColor dojox/editor/plugins/ToolbarLineBreak dijit/ToolbarSeparator dojox/editor/plugins/FindReplace dojox/editor/plugins/PasteFromWord dojox/editor/plugins/InsertAnchor dojox/editor/plugins/Blockquote dojox/editor/plugins/UploadImage jimu/dijit/EditorChooseImage jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor dijit/form/CheckBox dijit/layout/ContentPane".split(" "),function(v,
A,B,t,h,c,f,e,d,a,b,g,p,k,r,m,u,G,H,C,E,K){return A([b,p],{baseClass:"jimu-widget-business-analyst-setting",selectedCountryID:"",currentDefaultInfographicID:"",currentDefaultInfographicDiv:null,currentDefaultReportID:"",currentDefaultReportDiv:null,postCreate:function(){this.inherited(arguments);this.tab=new E({tabs:[{title:this.nls.home,content:this.homeContentPane},{title:this.nls.infographics,content:this.infographicsContentPane},{title:this.nls.reports,content:this.reportsContentPane},{title:this.nls.rings,
content:this.ringsContentPane},{title:this.nls.driveTime,content:this.driveTimeContentPane},{title:this.nls.walkTime,content:this.walkTimeContentPane}],selected:this.nls.home});this.tab.placeAt(this.reportInfographicTabContainer);this.tab.startup();this.editorXssFilter=K.getInstance()},startup:function(){this._started||(this.inherited(arguments),this.initEditor(),this.setConfig(this.config))},initEditor:function(){var D=document.getElementsByTagName("head")[0],z=window.apiUrl+"dojox/editor/plugins/resources/css/TextColor.css";
d('link[href\x3d"'+z+'"]',D)[0]||g.loadStyleLink("editor_plugins_resources_TextColor",z);z=window.apiUrl+"dojox/editor/plugins/resources/editorPlugins.css";d('link[href\x3d"'+z+'"]',D)[0]||g.loadStyleLink("editor_plugins_resources_editorPlugins",z);z=window.apiUrl+"dojox/editor/plugins/resources/css/PasteFromWord.css";d('link[href\x3d"'+z+'"]',D)[0]||g.loadStyleLink("editor_plugins_resources_PasteFromWord",z);this.editor=new k({plugins:["bold","italic","underline",g.getEditorTextColor("about"),g.getEditorBackgroundColor("about"),
"|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent"],extraPlugins:["|","createLink","unlink","pastefromword","|","undo","redo","|","chooseImage","|","viewsource","toolbarlinebreak",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize","formatBlock"],style:"font-family:Verdana;"},this.editor);B.setStyle(this.editor.domNode,
{width:"100%",height:"100%"});this.editor.startup();8!==a("ie")&&this.editor.resize({w:"100%",h:"100%"})},setConfig:function(D){var z=this;this.initializeNewConfigValues(D);u.getAvailableCountries().then(function(y){var x=[];v.forEach(y.countries,function(n){x.push({label:n.name,value:n.id,selected:n.id==z.config.defaultCountryID?"selected":""})});z.countryDropDownInfographics=(new C({options:x})).placeAt(z.countryDropDownContainerInfographics);z.countryDropDownInfographics.startup();z.selectedCountryID=
z.countryDropDownInfographics.get("value");e(z.countryDropDownInfographics,"change",function(){z._countryChangeInfographics()});z.countryDropDownReports=(new C({options:x})).placeAt(z.countryDropDownContainerReports);z.countryDropDownReports.startup();z.selectedCountryID=z.countryDropDownReports.get("value");e(z.countryDropDownReports,"change",function(){z._countryChangeReports()});z._loadConfigForCountry(z.selectedCountryID)});this._loadRingDTWTConfig();this._loadInfographicExportOptions();this._loadFirstPageOptions();
D=this.editorXssFilter.sanitize(D.firstPageText||this.nls.defaultFirstPageText);this.editor.set("value",D)},getConfig:function(){if(!this._validateRingDTWT())return!1;this._setConfigForCountry(this.selectedCountryID);this._setRingDTWTConfig();this._setInfographicExportOptions();this._setFirstPageOptions();this.config.defaultCountryID=this.selectedCountryID;this.config.firstPageText=this.editor.get("value");return this.config},_countryChangeInfographics:function(){this.countryDropDownReports.get("value")!=
this.countryDropDownInfographics.get("value")&&(this.countryDropDownReports.set("value",this.countryDropDownInfographics.get("value")),this._countryChange())},_countryChangeReports:function(){this.countryDropDownInfographics.get("value")!=this.countryDropDownReports.get("value")&&(this.countryDropDownInfographics.set("value",this.countryDropDownReports.get("value")),this._countryChange())},_countryChange:function(){this._setConfigForCountry(this.selectedCountryID);this.selectedCountryID=this.countryDropDownInfographics.get("value");
this._loadConfigForCountry(this.selectedCountryID)},_setConfigForCountry:function(D){var z=null;v.forEach(this.config.countryConfig,function(x){x.countryID==D&&(z=x)});z||(z={countryID:D,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],
enabledEsriInfographics:[],enabledOrgInfographics:[]});z.allowEsriInfographics=0<this.infographicsTreeGrid.tree.data[0].leafCount?0!=this.infographicsTreeGrid.tree.data[0].selectCount:!0;z.allowMyInfographics=0<this.infographicsTreeGrid.tree.data[1].leafCount?0!=this.infographicsTreeGrid.tree.data[1].selectCount:!0;z.allowSharedInfographics=0<this.infographicsTreeGrid.tree.data[2].leafCount?0!=this.infographicsTreeGrid.tree.data[2].selectCount:!0;z.allowAllEsriInfographics=this.infographicsTreeGrid.tree.data[0].leafCount===
this.infographicsTreeGrid.tree.data[0].selectCount;z.allowAllOrgInfographics=this.infographicsTreeGrid.tree.data[1].leafCount===this.infographicsTreeGrid.tree.data[1].selectCount&&this.infographicsTreeGrid.tree.data[2].leafCount===this.infographicsTreeGrid.tree.data[2].selectCount;z.allowAllEsriInfographics||(z.enabledEsriInfographics=this._getEnabledReports(this.infographicsTreeGrid.tree.data[0].children));z.allowAllOrgInfographics||(z.enabledOrgInfographics=this._getEnabledReports(this.infographicsTreeGrid.tree.data[1].children.concat(this.infographicsTreeGrid.tree.data[2].children)));
z.defaultInfographicID=this.currentDefaultInfographicID;z.allowEsriReports=0<this.reportsTreeGrid.tree.data[0].leafCount?0!=this.reportsTreeGrid.tree.data[0].selectCount:!0;z.allowMyReports=0<this.reportsTreeGrid.tree.data[1].leafCount?0!=this.reportsTreeGrid.tree.data[1].selectCount:!0;z.allowSharedReports=0<this.reportsTreeGrid.tree.data[2].leafCount?0!=this.reportsTreeGrid.tree.data[2].selectCount:!0;z.allowAllEsriReports=this.reportsTreeGrid.tree.data[0].leafCount===this.reportsTreeGrid.tree.data[0].selectCount;
z.allowAllOrgReports=this.reportsTreeGrid.tree.data[1].leafCount===this.reportsTreeGrid.tree.data[1].selectCount&&this.reportsTreeGrid.tree.data[2].leafCount===this.reportsTreeGrid.tree.data[2].selectCount;z.allowAllEsriReports||(z.enabledEsriReports=this._getEnabledReports(this.reportsTreeGrid.tree.data[0].children));z.allowAllOrgReports||(z.enabledOrgReports=this._getEnabledReports(this.reportsTreeGrid.tree.data[1].children.concat(this.reportsTreeGrid.tree.data[2].children)));z.defaultReportID=
this.currentDefaultReportID;var y=-1;v.forEach(this.config.countryConfig,function(x,n){x.countryID==D&&(y=n)});-1!=y?this.config.countryConfig[y]=z:this.config.countryConfig.push(z)},_loadConfigForCountry:function(D){var z=this;G.getAvailableInfographicReports(D).then(function(y){v.forEach(y,function(n){v.forEach(n.children,function(q){q.selected=!0})});z.infographicsTreeGrid||(z.infographicsTreeGrid=new m({tree:new r(y),showHeader:!1,_renderLabelNode:function(n,q){var F=h.create("div"),J=h.create("div",
{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(n),style:"float: left"},F);if(1===n.deepness){n.value===z.currentDefaultInfographicID&&(t.add(J,"default"),z.currentDefaultInfographicDiv=J);var l=h.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",innerHTML:z.nls.makeDefault,style:"margin-left: 10px; display: none"},F),w=h.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",innerHTML:z.nls.removeDefault,style:"margin-left: 10px; display: none"},
F);n.makeDefaultDiv=l;n.unselectDefaultDiv=w;e(l,"click",function(I){I.stopPropagation();z.currentDefaultInfographicDiv&&t.remove(z.currentDefaultInfographicDiv,"default");t.add(J,"default");z.currentDefaultInfographicID=n.value;z.currentDefaultInfographicDiv=J;c.set(l,"display","none");c.set(w,"display","")});e(w,"click",function(I){I.stopPropagation();z.currentDefaultInfographicDiv&&t.remove(z.currentDefaultInfographicDiv,"default");z.currentDefaultInfographicID="";z.currentDefaultInfographicDiv=
null;c.set(w,"display","none");c.set(l,"display","")});e(q,f.enter,function(){n.selected&&(n.value!==z.currentDefaultInfographicID?c.set(l,"display",""):c.set(w,"display",""))});e(q,f.leave,function(){c.set(l,"display","none");c.set(w,"display","none")})}return F}},z.infographicTreeGridContainer));z.own(e(z.infographicsTreeGrid,"SelectionChanged",function(n){n.toggledTreeNode&&0==n.toggledTreeNode.deepness?n.toggledTreeNode.selected||v.forEach(n.toggledTreeNode.children,function(q){q.value===z.currentDefaultInfographicID&&
z.currentDefaultInfographicDiv&&(t.remove(z.currentDefaultInfographicDiv,"default"),z.currentDefaultInfographicID="",z.currentDefaultInfographicDiv=null)}):n.toggledTreeNode&&!n.toggledTreeNode.selected&&n.toggledTreeNode.value===z.currentDefaultInfographicID?z.currentDefaultInfographicDiv&&(t.remove(z.currentDefaultInfographicDiv,"default"),z.currentDefaultInfographicID="",z.currentDefaultInfographicDiv=null,c.set(n.toggledTreeNode.makeDefaultDiv,"display","none"),c.set(n.toggledTreeNode.unselectDefaultDiv,
"display","none")):n.toggledTreeNode&&!n.toggledTreeNode.selected?c.set(n.toggledTreeNode.makeDefaultDiv,"display","none"):n.toggledTreeNode&&n.toggledTreeNode.selected&&c.set(n.toggledTreeNode.makeDefaultDiv,"display","")}));var x=-1;v.forEach(z.config.countryConfig,function(n,q){n.countryID==D&&(x=q)});z.currentDefaultInfographicID="";z.currentDefaultReportID="";-1!=x&&(z.currentDefaultInfographicID=z.config.countryConfig[x].defaultInfographicID,z.currentDefaultReportID=z.config.countryConfig[x].defaultReportID,
z.config.countryConfig[x].allowAllEsriInfographics||v.forEach(y[0].children,function(n){v.some(z.config.countryConfig[x].enabledEsriInfographics,function(q){return n.value===q})||(n.selected=!1)}),z.config.countryConfig[x].allowAllOrgInfographics||v.forEach(y[1].children.concat(y[2].children),function(n){v.some(z.config.countryConfig[x].enabledOrgInfographics,function(q){return n.value===q})||(n.selected=!1)}));z.infographicsTreeGrid.tree.clear();z.infographicsTreeGrid.tree.addNodes(y)});G.getAvailableClassicReports(D).then(function(y){v.forEach(y,
function(n){v.forEach(n.children,function(q){q.selected=!0})});z.reportsTreeGrid||(z.reportsTreeGrid=new m({tree:new r(y),showHeader:!1,_renderLabelNode:function(n,q){var F=h.create("div"),J=h.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(n),style:"float: left"},F);if(1===n.deepness){n.value===z.currentDefaultReportID&&(t.add(J,"default"),z.currentDefaultReportDiv=J);var l=h.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",
innerHTML:z.nls.makeDefault,style:"margin-left: 10px; display: none"},F),w=h.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",innerHTML:z.nls.removeDefault,style:"margin-left: 10px; display: none"},F);n.makeDefaultDiv=l;n.unselectDefaultDiv=w;e(l,"click",function(I){I.stopPropagation();z.currentDefaultReportDiv&&t.remove(z.currentDefaultReportDiv,"default");t.add(J,"default");z.currentDefaultReportID=n.value;z.currentDefaultReportDiv=J;c.set(l,"display","none");c.set(w,"display",
"")});e(w,"click",function(I){I.stopPropagation();z.currentDefaultReportDiv&&t.remove(z.currentDefaultReportDiv,"default");z.currentDefaultReportID="";z.currentDefaultReportDiv=null;c.set(w,"display","none");c.set(l,"display","")});e(q,f.enter,function(){n.selected&&(n.value!==z.currentDefaultReportID?c.set(l,"display",""):c.set(w,"display",""))});e(q,f.leave,function(){c.set(l,"display","none");c.set(w,"display","none")})}return F}},z.reportTreeGridContainer));z.own(e(z.reportsTreeGrid,"SelectionChanged",
function(n){n.toggledTreeNode&&0==n.toggledTreeNode.deepness?n.toggledTreeNode.selected||v.forEach(n.toggledTreeNode.children,function(q){q.value===z.currentDefaultReportID&&z.currentDefaultReportDiv&&(t.remove(z.currentDefaultReportDiv,"default"),z.currentDefaultReportID="",z.currentDefaultReportDiv=null)}):n.toggledTreeNode&&!n.toggledTreeNode.selected&&n.toggledTreeNode.value===z.currentDefaultReportID?z.currentDefaultReportDiv&&(t.remove(z.currentDefaultReportDiv,"default"),z.currentDefaultReportID=
"",z.currentDefaultReportDiv=null,c.set(n.toggledTreeNode.makeDefaultDiv,"display","none"),c.set(n.toggledTreeNode.unselectDefaultDiv,"display","none")):n.toggledTreeNode&&!n.toggledTreeNode.selected?c.set(n.toggledTreeNode.makeDefaultDiv,"display","none"):n.toggledTreeNode&&n.toggledTreeNode.selected&&c.set(n.toggledTreeNode.makeDefaultDiv,"display","")}));var x=-1;v.forEach(z.config.countryConfig,function(n,q){n.countryID==D&&(x=q)});-1!=x&&(z.config.countryConfig[x].allowAllEsriReports||v.forEach(y[0].children,
function(n){v.some(z.config.countryConfig[x].enabledEsriReports,function(q){return n.value===q})||(n.selected=!1)}),z.config.countryConfig[x].allowAllOrgReports||v.forEach(y[1].children.concat(y[2].children),function(n){v.some(z.config.countryConfig[x].enabledOrgReports,function(q){return n.value===q})||(n.selected=!1)}));z.reportsTreeGrid.tree.clear();z.reportsTreeGrid.tree.addNodes(y)})},_getClassicReportId:function(D){return D.value&&D.value.itemid?D.value.itemid:D.value},_getEnabledReports:function(D){var z=
[];v.forEach(D,function(y){y.selected&&(y.value&&y.value.itemid?z.push(y.value.itemid):z.push(y.value))});return z},_setRingDTWTConfig:function(){this.config.ringDefaults=this._getRadii(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3);this.config.driveTimeDefaults=this._getRadii(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3);this.config.walkTimeDefaults=this._getRadii(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3);
this.config.ringUnitDefault=this.ringsBufferUnits.get("value");this.config.driveTimeUnitDefault=this.driveTimeBufferUnits.get("value");this.config.walkTimeUnitDefault=this.walkTimeBufferUnits.get("value");this.config.ringDisabled=this.disabledRingsOption.checked;this.config.driveTimeDisabled=this.disabledDriveTimeOption.checked;this.config.walkTimeDisabled=this.disabledWalkTimeOption.checked;this.config.infographicsDisabled=this.disabledInfographicsOption.checked;this.config.reportsDisabled=this.disabledReportsOption.checked},
_loadRingDTWTConfig:function(){this._setRadii(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,this.config.ringDefaults);this.ringsBufferUnits.set("value",this.config.ringUnitDefault);this.disabledRingsOption.setChecked(this.config.ringDisabled);this._setRadii(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,this.config.driveTimeDefaults);this.driveTimeBufferUnits.set("value",this.config.driveTimeUnitDefault);this.disabledDriveTimeOption.setChecked(this.config.driveTimeDisabled);
this._setRadii(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,this.config.walkTimeDefaults);this.walkTimeBufferUnits.set("value",this.config.walkTimeUnitDefault);this.disabledWalkTimeOption.setChecked(this.config.walkTimeDisabled);this.disabledInfographicsOption.setChecked(this.config.infographicsDisabled);this.disabledReportsOption.setChecked(this.config.reportsDisabled)},_setInfographicExportOptions:function(){this.config.exportInfographicsPrintOption=this.exportPrintOption.checked;
this.config.exportInfographicsImageOption=this.exportImageOption.checked;this.config.exportInfographicsPDFOption=this.exportPDFOption.checked;this.config.exportInfographicsDynamicHTMLOption=this.exportDynamicHTMLOption.checked},_loadInfographicExportOptions:function(){this.exportPrintOption.setChecked(this.config.exportInfographicsPrintOption);this.exportImageOption.setChecked(this.config.exportInfographicsImageOption);this.exportPDFOption.setChecked(this.config.exportInfographicsPDFOption);this.exportDynamicHTMLOption.setChecked(this.config.exportInfographicsDynamicHTMLOption)},
_setFirstPageOptions:function(){this.config.searchTextBoxOption=this.searchTextBoxOption.checked;this.config.dropPinOption=this.dropPinOption.checked;this.config.drawPolygonOption=this.drawPolygonOption.checked;this.config.drawFreehandPolygonOption=this.drawFreehandPolygonOption.checked},_loadFirstPageOptions:function(){this.searchTextBoxOption.setChecked(this.config.searchTextBoxOption);this.dropPinOption.setChecked(this.config.dropPinOption);this.drawPolygonOption.setChecked(this.config.drawPolygonOption);
this.drawFreehandPolygonOption.setChecked(this.config.drawFreehandPolygonOption)},_getRadii:function(D,z,y){D=D.get("value");z=z.get("value");y=y.get("value");var x=[];""!=D&&x.push(D);""!=z&&x.push(z);""!=y&&x.push(y);return x},_setRadii:function(D,z,y,x){0<x.length?D.set("value",x[0]):D.set("value","");1<x.length?z.set("value",x[1]):z.set("value","");2<x.length?y.set("value",x[2]):y.set("value","")},_validateRingDTWT:function(){var D=!0,z=!0,y=!1;z=D=H.validateInvalidValues(this.ringsBufferRadii1,
this.ringsBufferRadii2,this.ringsBufferRadii3,this.ringValidationErrorMessage,this.nls.thisEntryIsNotValid);D||(this.tab.selectTab(this.nls.rings),y=!0);D=H.validateInvalidValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,this.driveTimeValidationErrorMessage,this.nls.thisEntryIsNotValid);z=z&&D;D||y||(this.tab.selectTab(this.nls.driveTime),y=!0);D=H.validateInvalidValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,this.walkTimeValidationErrorMessage,
this.nls.thisEntryIsNotValid);z=z&&D;D||y||(this.tab.selectTab(this.nls.walkTime),y=!0);if(!z)return z;tabChange=!1;z=D=H.validateMinMaxValues(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,H.MIN_RINGS_VALUE,H.MAX_RINGS_VALUE,this.ringValidationErrorMessage,this.nls.invalidValueRing);D||(this.tab.selectTab(this.nls.rings),y=!0);D=H.validateMinMaxValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,H.MIN_DTWT_VALUE,H.MAX_DTWT_VALUE,this.driveTimeValidationErrorMessage,
this.nls.invalidValueDTWT);z=z&&D;D||y||(this.tab.selectTab(this.nls.driveTime),y=!0);D=H.validateMinMaxValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,H.MIN_DTWT_VALUE,H.MAX_DTWT_VALUE,this.walkTimeValidationErrorMessage,this.nls.invalidValueDTWT);z=z&&D;D||y||(this.tab.selectTab(this.nls.walkTime),y=!0);return z},initializeNewConfigValues:function(D){"undefined"===typeof D.exportInfographicsPrintOption&&(D.exportInfographicsPrintOption=!0);"undefined"===typeof D.exportInfographicsImageOption&&
(D.exportInfographicsImageOption=!0);"undefined"===typeof D.exportInfographicsPDFOption&&(D.exportInfographicsPDFOption=!0);"undefined"===typeof D.exportInfographicsDynamicHTMLOption&&(D.exportInfographicsDynamicHTMLOption=!0);"undefined"===typeof D.firstPageText&&(D.firstPageText=this.nls.defaultFirstPageText);"undefined"===typeof D.searchTextBoxOption&&(D.searchTextBoxOption=!0);"undefined"===typeof D.dropPinOption&&(D.dropPinOption=!0);"undefined"===typeof D.drawPolygonOption&&(D.drawPolygonOption=
!0);"undefined"===typeof D.drawFreehandPolygonOption&&(D.drawFreehandPolygonOption=!0)}})});