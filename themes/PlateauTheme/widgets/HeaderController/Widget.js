// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"themes/PlateauTheme/widgets/HeaderController/PopupTileNodes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/dom-construct dojo/query dijit/_WidgetBase dijit/_TemplatedMixin jimu/dijit/ViewStack dojox/gesture/swipe dojox/gesture/tap jimu/utils".split(" "),function(z,m,A,b,n,e,l,t,G,g,u,q,x,C){var B=0;return z([G,g],{baseClass:"jimu-header-more-popup",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"close" tabindex\x3d"0" data-dojo-attach-point\x3d"closeNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"pages" data-dojo-attach-point\x3d"pagesNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"points jimu-corner-bottom"\x3e\x3cdiv class\x3d"points-inner"data-dojo-attach-point\x3d"pointsNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
margin:4,postCreate:function(){this.nodes=[];this.pages=[];this.createCloseBtn();this.own(n(this.domNode,"keydown",m.hitch(this,function(f){b.hasClass(f.target,"close-btn")||f.keyCode!==e.ESCAPE||this.closeNode.focus()})))},startup:function(){this.viewStack=new u({views:[],viewType:"dom"},this.pagesNode);this.viewStack.startup();n(this.pagesNode,q.end,m.hitch(this,function(f){B<this.maximumPages-1&&f.dx&&0>f.dx?(B++,this._selectPage(B)):f.dx&&0<f.dx&&0<B&&(B--,this._selectPage(B))}));this.resize();
this.nodes.length&&this.nodes[0].focus()},resize:function(){var f=this._calculateGridParam();if(null!==f){b.setStyle(this.domNode,C.getPositionStyle(f.position));this.nodeWidth=f.cellSize-this.margin;this.oldGridParam&&this.oldGridParam.rows===f.rows&&this.oldGridParam.cols===f.cols||(this.clearPages(),this.createPages(f));this.nodes.forEach(m.hitch(this,function(k,r){this.setItemNodePosition(k,r,f)}));this.oldGridParam=f;var w=t("div.close",this.domNode)[0];b.setStyle(w,{width:.25*this.nodeWidth+
"px",height:.25*this.nodeWidth+"px"})}else this.oldGridParam=null,b.setStyle(this.domNode,C.getPositionStyle({left:0,top:0,width:0,height:0,zIndex:111})),this.nodeWidth=0;!window.appInfo.isRunInMobile&&760<window.innerWidth&&this.numWidget&&8>=this.numWidget.length&&this.hide()},setItemNodePosition:function(f,w,k){var r=48,v=16;var y=0===w%k.cols?0:this.margin/2;var E=w%(k.rows*k.cols)<k.cols?0:this.margin/2;w={};"number"===typeof this.nodeWidth&&(w.width=this.nodeWidth+"px",w.height=this.nodeWidth+
"px");"number"===typeof y&&(window.isRTL?w.marginRight=y+"px":w.marginLeft=y+"px");"number"===typeof E&&(w.marginTop=E+"px");if(y=t("img",f)[0])k.iconScaled&&(r*=this.nodeWidth/120),b.setStyle(y,{width:r+"px",height:r+"px"});if(r=t("div.node-label",f)[0])k.showLabel?(k.iconScaled&&(v*=this.nodeWidth/120),b.setStyle(r,{"font-size":v+"px",display:"block"})):b.setStyle(r,{"font-size":v+"px",display:"none"});b.setStyle(f,w)},clearPages:function(){A.forEach(this.pages,function(f){this.viewStack.removeView(f.pageNode)},
this);l.empty(this.pointsNode);this.pages=[];this.nodes=[]},createPages:function(f){var w,k;this.maximumPages=w=Math.ceil(this.items.length/(f.rows*f.cols));for(k=0;k<w;k++){var r=l.create("div",{"class":"page"});this.createPageItems(k,r,f);this.viewStack.addView(r);if(1<w){var v=k===w-1;var y=l.create("div",{"class":"point",role:"button",tabindex:0},this.pointsNode);this.own(n(y,"click",m.hitch(this,this._onPageNodeClick,k)));this.own(n(y,"keydown",m.hitch(this,function(E,I,a){a.keyCode===e.ENTER||
a.keyCode===e.SPACE?(this._onPageNodeClick(E),t(".page.view",this.viewStack.domNode)[E].children[0].focus()):I&&!a.shiftKey&&a.keyCode===e.TAB&&a.preventDefault()},k,v)))}this.pages.push({pageNode:r,pointNode:y})}0<this.viewStack.views.length&&this._selectPage(0)},_onPageNodeClick:function(f){this._selectPage(f)},_selectPage:function(f){1<this.pages.length&&(t(".point",this.domNode).removeClass("point-selected jimu-main-background"),b.addClass(this.pages[f].pointNode,"point-selected jimu-main-background"));
this.viewStack.switchView(this.pages[f].pageNode)},createPageItems:function(f,w,k){var r=this.items.length;var v=k.rows*k.cols;k=(f+1)*v;var y=k-r;k=Math.min(k,r);for(f*=v;f<k;f++)this.createItemNode(f,w);for(f=r;f<r+y;f++)this.createEmptyItemNode(w)},createItemNode:function(f,w){f=this.items[f];var k=l.create("div",{"class":"icon-node jimu-float-leading jimu-main-background",title:f.label,"aria-label":f.label,settingId:f.id,"data-widget-name":f.name,role:"button",tabindex:0},w);w=l.create("img",
{src:f.icon},k);window.isRTL&&f.mirrorIconForRTL&&b.addClass(w,"jimu-flipx");l.create("div",{"class":"node-label",title:f.label,innerHTML:C.stripHTML(f.label)},k);k.config=f;this.own(n(k,x,m.hitch(this,function(){this.onNodeClicked(k)})));this.own(n(k,"keydown",m.hitch(this,function(r){if(r.keyCode===e.ENTER||r.keyCode===e.SPACE)this.onNodeClicked(k)})));this.nodes.push(k)},createEmptyItemNode:function(f){f=l.create("div",{"class":"icon-node jimu-float-leading jimu-main-background",tabindex:0},f);
this.own(n(f,"focus",m.hitch(this,function(w){C.isInNavMode()&&(1===this.viewStack.domNode.children.length?w.target.parentNode.children[0].focus():t(".point-selected",this.pointsNode)[0].previousSibling.focus())})));this.nodes.push(f);return f},createCloseBtn:function(){l.create("div",{role:"button","class":"close-inner jimu-main-background"},this.closeNode);this.own(n(this.closeNode,"click",m.hitch(this,function(){this.hide()})));this.own(n(this.closeNode,"keydown",m.hitch(this,function(f){f.keyCode===
e.ENTER||f.keyCode===e.SPACE||f.keyCode===e.ESCAPE?this.hide():f.shiftKey&&f.keyCode===e.TAB&&f.preventDefault()})));return this.closeNode},hide:function(){B=0;b.setStyle(this.domNode,"display","none")},show:function(){b.setStyle(this.domNode,"display","block")},onNodeClicked:function(f){this.hide()},openNodebyId:function(f){for(var w=0,k=this.nodes.length;w<k;w++){var r=this.nodes[w];if(f&&f===b.getAttr(r,"settingId"))return this.onNodeClicked(r),r}},_calculateGridParam:function(){var f=!1,w=!0;
var k=b.getContentBox(jimuConfig.mapId);var r=Math.min(k.w,k.h)-40;if(360<=r)var v=120;else{v=Math.floor(r/3);if(10>v)return null;f=!0;80>v&&(w=!1)}r=Math.floor((k.h-40)/v);var y=Math.floor((k.w-40)/v);r=4<r?4:r;r=3>r?3:r;y=3>r?3:4<y?4:y;return{rows:r,cols:y,cellSize:v,iconScaled:f,showLabel:w,position:{top:(k.h-v*r)/2,bottom:(k.h-v*r)/2,left:(k.w-v*y)/2,right:(k.w-v*y)/2,width:v*y-this.margin*(y-1)/2,height:v*r-this.margin*(r-1)/2,zIndex:111}}}})})},"dojox/gesture/swipe":function(){define(["dojo/_base/kernel",
"dojo/_base/declare","./Base","../main"],function(z,m,A,b){z.experimental("dojox.gesture.swipe");z=m(A,{defaultEvent:"swipe",subEvents:["end"],press:function(n,e){e.touches&&2<=e.touches.length?delete n.context:(n.context||(n.context={x:0,y:0,t:0}),n.context.x=e.screenX,n.context.y=e.screenY,n.context.t=(new Date).getTime(),this.lock(e.currentTarget))},move:function(n,e){this._recognize(n,e,"swipe")},release:function(n,e){this._recognize(n,e,"swipe.end");delete n.context;this.unLock()},cancel:function(n,
e){delete n.context;this.unLock()},_recognize:function(n,e,l){n.context&&(n=this._getSwipeInfo(n,e))&&(n.type=l,this.fire(e.target,n))},_getSwipeInfo:function(n,e){var l={},t=n.context;l.time=(new Date).getTime()-t.t;n=e.screenX-t.x;e=e.screenY-t.y;if(0===n&&0===e)return null;l.dx=n;l.dy=e;return l}});b.gesture.swipe=new z;b.gesture.swipe.Swipe=z;return b.gesture.swipe})},"dojox/gesture/Base":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom dojo/on dojo/touch dojo/has ../main".split(" "),
function(z,m,A,b,n,e,l,t,G){z.experimental("dojox.gesture.Base");b.getObject("gesture",!0,G);return m(null,{defaultEvent:" ",subEvents:[],touchOnly:!1,_elements:null,constructor:function(g){b.mixin(this,g);this.init()},init:function(){this._elements=[];if(!t("touch")&&this.touchOnly)console.warn("Gestures:[",this.defaultEvent,"] is only supported on touch devices!");else{var g=this.defaultEvent;this.call=this._handle(g);this._events=[g];A.forEach(this.subEvents,function(u){this[u]=this._handle(g+
"."+u);this._events.push(g+"."+u)},this)}},_handle:function(g){var u=this;return function(q,x){var C=arguments;2<C.length&&(q=C[1],x=C[2]);if(q&&(q.nodeType||q.attachEvent||q.addEventListener)){var B=u._add(q,g,x);return{remove:function(){B.remove();u._remove(q,g)}}}return e(q,g,x)}},_add:function(g,u,q){var x=this._getGestureElement(g);if(!x){x={target:g,data:{},handles:{}};var C=b.hitch(this,"_process",x,"press"),B=b.hitch(this,"_process",x,"move"),f=b.hitch(this,"_process",x,"release"),w=b.hitch(this,
"_process",x,"cancel"),k=x.handles;this.touchOnly?(k.press=e(g,"touchstart",C),k.move=e(g,"touchmove",B),k.release=e(g,"touchend",f),k.cancel=e(g,"touchcancel",w)):(k.press=l.press(g,C),k.move=l.move(g,B),k.release=l.release(g,f),k.cancel=l.cancel(g,w));this._elements.push(x)}x.handles[u]=x.handles[u]?++x.handles[u]:1;return e(g,u,q)},_getGestureElement:function(g){for(var u=0,q;u<this._elements.length;u++)if(q=this._elements[u],q.target===g)return q},_process:function(g,u,q){q._locking=q._locking||
{};q._locking[this.defaultEvent]||this.isLocked(q.currentTarget)||("INPUT"==q.target.tagName&&"radio"!=q.target.type&&"checkbox"!=q.target.type||"TEXTAREA"==q.target.tagName||q.preventDefault(),q._locking[this.defaultEvent]=!0,this[u](g.data,q))},press:function(g,u){},move:function(g,u){},release:function(g,u){},cancel:function(g,u){},fire:function(g,u){g&&u&&(u.bubbles=!0,u.cancelable=!0,e.emit(g,u.type,u))},_remove:function(g,u){if((g=this._getGestureElement(g))&&g.handles){g.handles[u]--;var q=
g.handles;A.some(this._events,function(x){return 0<q[x]})||(this._cleanHandles(q),u=A.indexOf(this._elements,g),0<=u&&this._elements.splice(u,1))}},_cleanHandles:function(g){for(var u in g)g[u].remove&&g[u].remove(),delete g[u]},lock:function(g){this._lock=g},unLock:function(){this._lock=null},isLocked:function(g){return this._lock&&g?this._lock!==g&&n.isDescendant(g,this._lock):!1},destroy:function(){A.forEach(this._elements,function(g){this._cleanHandles(g.handles)},this);this._elements=null}})})},
"dojox/gesture/tap":function(){define(["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","./Base","../main"],function(z,m,A,b,n){z.experimental("dojox.gesture.tap");z=m(b,{defaultEvent:"tap",subEvents:["hold","doubletap"],holdThreshold:500,doubleTapTimeout:250,tapRadius:10,press:function(e,l){if(l.touches&&2<=l.touches.length)clearTimeout(e.tapTimeOut),delete e.context;else{var t=l.target;this._initTap(e,l);e.tapTimeOut=setTimeout(A.hitch(this,function(){this._isTap(e,l)&&this.fire(t,{type:"tap.hold"});
delete e.context}),this.holdThreshold)}},release:function(e,l){if(e.context&&this._isTap(e,l))switch(e.context.c){case 1:this.fire(l.target,{type:"tap"});break;case 2:this.fire(l.target,{type:"tap.doubletap"})}clearTimeout(e.tapTimeOut)},_initTap:function(e,l){e.context||(e.context={x:0,y:0,t:0,c:0});var t=(new Date).getTime();t-e.context.t<=this.doubleTapTimeout?e.context.c++:(e.context.c=1,e.context.x=l.screenX,e.context.y=l.screenY);e.context.t=t},_isTap:function(e,l){if(!e.context)return!1;var t=
Math.abs(e.context.y-l.screenY);return Math.abs(e.context.x-l.screenX)<=this.tapRadius&&t<=this.tapRadius}});n.gesture.tap=new z;n.gesture.tap.Tap=z;return n.gesture.tap})},"themes/PlateauTheme/widgets/HeaderController/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:themes/PlateauTheme/widgets/HeaderController/Widget.html":'\x3cdiv data-a11y-label-by\x3d"plateau_label plateau_title plateau_subtitle"\x3e\r\n  \x3c!-- solve the bug of style delay loading --\x3e\r\n  \x3cdiv class\x3d"header-section jimu-float-leading" data-dojo-attach-point\x3d"headerNode"\x3e\r\n    \x3cdiv class\x3d"logo jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"logoNodeContainer"\x3e\r\n      \x3ca role\x3d"link" data-dojo-attach-point\x3d"logoLinkNode" target\x3d"_blank"\x3e\r\n        \x3cimg data-dojo-attach-point\x3d"logoNode" data-dojo-attach-event\x3d"onload:_onLogoLoad"\x3e\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"titles jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"titlesNode"\x3e\r\n      \x3cdiv class\x3d"screen-readers-only" data-a11y-label-id\x3d"plateau_label"\x3e${label}\x3c/div\x3e\r\n      \x3ch1 class\x3d"jimu-title jimu-float-leading" data-dojo-attach-point\x3d"titleNode" data-a11y-label-id\x3d"plateau_title"\x3e\x3c/h1\x3e\r\n      \x3ch2 class\x3d"jimu-subtitle jimu-float-leading jimu-leading-margin2" data-dojo-attach-point\x3d"subtitleNode" data-a11y-label-id\x3d"plateau_subtitle"\x3e\x3c/h2\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"links jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"linksNode"\x3e\r\n      \x3cdiv class\x3d"dynamic-section jimu-float-leading" data-dojo-attach-point\x3d"dynamicLinksNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"signin-section jimu-float-leading" data-dojo-attach-point\x3d"signInSectionNode"\x3e\r\n        \x3ca role\x3d"link" href\x3d"#" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onSigninClick" data-dojo-attach-point\x3d"signinLinkNode"\x3e${nls.signin}\x3c/a\x3e\r\n        \x3ca role\x3d"link" href\x3d"" target\x3d"_blank" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onUserNameClick" data-dojo-attach-point\x3d"userNameLinkNode"\x3e\x3c/a\x3e\r\n        \x3ca role\x3d"link" href\x3d"#" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onSignoutClick" data-dojo-attach-point\x3d"signoutLinkNode"\x3e${nls.signout}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-section jimu-float-leading jimu-main-background" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:themes/PlateauTheme/widgets/HeaderController/css/style.css":'.jimu-widget-header-controller {box-shadow: 0px 1px 8px 0px rgba(0, 0, 0, 0.4);}.jimu-widget-header-controller .header-section {height: 100%; overflow: hidden; width: calc(100% - 360px);}.jimu-widget-header-controller .container-section {height: 100%; min-width: 80px;}.jimu-widget-header-controller .logo {cursor: pointer;}.jimu-widget-header-controller .logo a{display: block;}.jimu-widget-header-controller .hide-logo {display: none;}.jimu-widget-header-controller .titles {height: 100%; overflow: hidden;}.jimu-widget-header-controller .jimu-title {text-align: center; height: 100%; margin-top: 0;}.jimu-widget-header-controller .jimu-subtitle {text-align: center; height: 100%; margin-top: 0;}.jimu-widget-header-controller .links {height: 100%; overflow: hidden;}.jimu-widget-header-controller .dynamic-section, .jimu-widget-header-controller .signin-section {height: 100%; display: flex;}.jimu-widget-header-controller .links .jimu-link {height: 100%;}.jimu-widget-header-controller .signin-section .jimu-link {color: #d9dde0;}.jimu-widget-header-controller .dynamic-section .jimu-link:last-child,.jimu-widget-header-controller .signin-section .jimu-link:last-child{margin-right: 1em;}.jimu-rtl .jimu-widget-header-controller .dynamic-section .jimu-link:last-child,.jimu-rtl .jimu-widget-header-controller .signin-section .jimu-link:last-child{margin-left: 1em;}.jimu-widget-header-controller .icon-node {cursor: pointer; opacity: 1; text-align: center; border-right: 1px solid #323e4f;}.jimu-widget-header-controller .icon-node img {height: 20px; width: 20px;}.jimu-widget-header-controller .icon-node:first-child {border: none;}.jimu-widget-header-controller .icon-node:hover {opacity: 1;}.jimu-widget-header-controller .icon-node.jimu-state-selected {background-color: #697a8c; opacity: 1; border: none; border-top: 2px solid #8491a1;}.jimu-widget-header-controller .drop-triangle {position: absolute; width: 0px; height: 0px; bottom: 1px; border-left: 4px solid transparent; border-right: 4px solid transparent; border-top: 4px solid white;}.jimu-widget-header-controller .jimu-drop-menu {box-shadow: 0px 1px 8px 0px rgba(0, 0, 0, 0.4);}.jimu-widget-header-controller .jimu-drop-menu .menu-item {overflow: hidden; border-top: 1px solid rgba(0, 0, 0, 0.2);}.jimu-widget-header-controller .jimu-drop-menu .menu-item:hover {background-color: rgba(0, 0, 0, 0.2);}.jimu-widget-header-controller .jimu-drop-menu .menu-item img {width: 24px; height: 24px; cursor: pointer; margin: 8px;}.jimu-widget-header-controller .jimu-drop-menu .menu-item .label {cursor: pointer; margin-top: 12px; font-size: 14px; color: white; min-width: 50px; text-align: center; white-space: nowrap; max-width: 300px; text-overflow: ellipsis; overflow: hidden; padding-right: 8px;}.jimu-rtl .jimu-widget-header-controller .jimu-drop-menu .menu-item .label{padding-left: 8px;}.popup-links {background-color: #fff;}.popup-links .popup-title {}.popup-links .logo {height: 30px;}.popup-links .title {color: #fff; text-align: center; font-size: 16px; width: 71.42857142857143%; overflow: hidden; white-space: nowrap; height: 100%;}.popup-links .line {width: 100%; height: 4px; border-bottom: 1px solid #393c40;}.popup-links .link-section {width: 100%; height: 66px;}.popup-links a {color: #fff; margin-left: 20px; font-size: 14px; height: 100%; width: 95%; overflow: hidden; display: inline-block;}.popup-links .link-section.signin a {color: #d9dde0;}.jimu-header-more-popup {position: absolute; border-radius: 2px; z-index: 111; background-color: #FFFFFF;}.jimu-header-more-popup .pages {position: relative; overflow: hidden; padding: 2px;}.jimu-header-more-popup .points {position: absolute; overflow: hidden; bottom: -15px; left: 0px; right: 0px; text-align: center; background-color: #bababa;}.jimu-header-more-popup .points-inner{overflow: hidden; display: flex; height: 20px; width: 100%; align-items: center; justify-content: center;}.jimu-header-more-popup .point {float: left; width: 8px; height: 8px; margin-left: 5px; border-radius: 4px; background-color: #f2f6f9; cursor: pointer;}.jimu-header-more-popup .point-selected {background-color: #485566;}.jimu-nav-mode .jimu-header-more-popup .point:focus{outline: none !important; border: 2px solid #24B5CC;}.jimu-header-more-popup .page {position: relative; overflow: hidden;}.jimu-header-more-popup .close {position: absolute; top: -04.46428571428571%; right: -04.46428571428571%; border-radius: 50%; background-color: #FFFFFF; cursor: pointer;}.jimu-rtl .jimu-header-more-popup .close {left: -04.46428571428571%; right: auto;}.jimu-header-more-popup .close-inner {width: 80%; height: 80%; margin-left: 10%; margin-top: 10%; border-radius: 50%; background-image: url("images/close.png"); background-repeat: no-repeat; background-position: center center; background-size: 13px;}.jimu-rtl .jimu-header-more-popup .close-inner{margin-left: 0; margin-right: 10%;}.jimu-header-more-popup .icon-node {cursor: pointer;}.jimu-header-more-popup .icon-node.jimu-state-selected {background-color: red;}.jimu-header-more-popup img {width: 48px; height: 48px; margin: auto; margin-top: 25%; display: block;}.jimu-header-more-popup .node-label {width: 100%; text-align: center; font-size: 16px; margin-top: 5px; color: white; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; display: inline-block; height: 20px;}@media screen and (max-width:320px){.jimu-header-more-popup .close-inner {background-size: 9px;}}@media screen and (max-width:760px) {.jimu-header-more-popup .node-label {font-size: 13px !important; height: 17px;} .jimu-widget-header-controller .header-section {width: calc(100% - 90px) !important;}}.jimu-more-icon-cover {z-index: 110; position: absolute; left: 0; top: 0; width: 100%; height: 100%;}.jimu-widget-header-controller .esriCTHidden {display: none;}.jimu-widget-header-controller .widget-open-symbol {height: 4px; width: 4px; border-radius: 4px; margin: auto; color: #FFF; background-color: #FFF;}.jimu-widget-frame.jimu-foldable-dijit\x3e.jimu-panel-content {padding: 14px;}',
"*now":function(z){z(['dojo/i18n!*preload*themes/PlateauTheme/widgets/HeaderController/nls/Widget*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/aspect dojo/query dojo/on dojo/keys dojo/Deferred dijit/Tooltip dojo/mouse dojo/topic dojo/dom-construct dojo/dom-geometry jimu/BaseWidget jimu/PoolControllerMixin jimu/tokenUtils jimu/portalUtils jimu/portalUrlUtils jimu/utils jimu/dijit/Message ./PopupTileNodes dijit/registry dojo/NodeList-manipulate".split(" "),function(z,m,A,b,n,e,l,t,G,g,u,q,x,C,B,f,w,k,r,v,y,E,I){return z([B,f],{baseClass:"jimu-widget-header-controller jimu-main-background",
maxIconCount:-1,createMoreIcon:!1,switchableElements:{},height:40,openedId:"",moveTopOnActive:!1,postMixInProperties:function(){this.inherited(arguments);this.isRenderIdForAttrs=!0;this.nls.common=m.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);b.setAttr(this.domNode,"aria-label",this.nls._widgetLabel);this._processGroupSetting();this.switchableElements.title=this.titleNode;this.position&&this.position.height&&(this.height=this.position.height);b.setStyle(this.signInSectionNode,
"display","none");this.appConfig&&this.appConfig.logo?(this.logoNode.src=this.appConfig.logo,b.removeClass(this.logoNode,"hide-logo")):(this.logoNode.src="",b.addClass(this.logoNode,"hide-logo"));this.appConfig.title&&(this.appConfig.title=v.sanitizeHTML(this.appConfig.title));this.appConfig.subtitle&&(this.appConfig.subtitle=v.sanitizeHTML(this.appConfig.subtitle));this.switchableElements.title.innerHTML=this.appConfig.title?this.appConfig.title:"";this.switchableElements.title.title=this.appConfig.title?
this.appConfig.title:"";this.appConfig.subtitle&&""!==m.trim(this.appConfig.subtitle)?(this.switchableElements.subtitle=this.subtitleNode,this.switchableElements.subtitle.innerHTML=this.appConfig.subtitle):(this.subtitleNode.innerHTML="",b.setStyle(this.subtitleNode,"display","none"));this._createDynamicLinks(this.appConfig.links);this._setElementsSize();this.own(l(this.domNode,u.enter,m.hitch(this,function(){var a="",c=r.getServerByUrl(this.appConfig&&this.appConfig.portalUrl||"");r.isArcGIScom(c)&&
(c="ArcGIS.com");c&&(a=this.nls.signInTo+" "+c);this.signinLinkNode.title=a})));this._handleLogoLink(this.appConfig)},startup:function(){this.inherited(arguments);this.resize()},onAction:function(a,c){"highLight"===a&&c&&(c=e('div[settingid\x3d"'+c.widgetId+'"]',this.domNode)[0],this._highLight(c));"removeHighLight"===a&&this._removeHighLight()},onSignIn:function(a){this.inherited(arguments);b.setStyle(this.signinLinkNode,"display","none");b.setStyle(this.userNameLinkNode,"display","");b.setStyle(this.signoutLinkNode,
"display","");this.userNameLinkNode.innerHTML=a.userId;b.setAttr(this.userNameLinkNode,"href",this.appConfig.portalUrl+"home/user.html");this.popupLinkNode&&(b.setStyle(this.popupSigninNode,"display","none"),b.setStyle(this.popupUserNameNode,"display",""),b.setStyle(this.popupSignoutNode,"display",""),e("a",this.popupUserNameNode).html(a.userId).attr("href",this.appConfig.portalUrl+"home/user.html"));this.resize()},onSignOut:function(){this.inherited(arguments);this._onSignOut(this.nls.signin);k.getPortal(this.appConfig.portalUrl).loadSelfInfo().then(m.hitch(this,
function(a){this._onSignOut(this.nls.signInTo+" "+a.name)}),m.hitch(this,function(a){console.error(a)}))},_onSignOut:function(a){b.setStyle(this.signinLinkNode,"display","");b.setAttr(this.signinLinkNode,"innerHTML",a);b.setStyle(this.userNameLinkNode,"display","none");b.setStyle(this.signoutLinkNode,"display","none");this.userNameLinkNode.innerHTML="";this.popupLinkNode&&(b.setStyle(this.popupSigninNode,"display",""),b.setAttr(this.popupSigninNode,"innerHTML",a),b.setStyle(this.popupUserNameNode,
"display","none"),b.setStyle(this.popupSignoutNode,"display","none"),e("a",this.popupUserNameNode).html(""));this.resize()},resize:function(){var a=0,c=b.getStyle(this.headerNode,"float"),d=b.getStyle(this.logoNodeContainer,"float"),h=b.getStyle(this.titlesNode,"float"),p=b.getStyle(this.linksNode,"float");c&&"none"!==c&&d&&"none"!==d&&h&&"none"!==h&&p&&"none"!==p?this._resize():setTimeout(m.hitch(this,this.resize),200);e(".jimu-widget-attributetable")[0]&&(a=e(".jimu-widget-attributetable")[0].clientHeight);
a?q.publish("changeMapPosition",{bottom:a}):q.publish("changeMapPosition",{bottom:"0px"})},_resize:function(){var a=b.getContentBox(this.domNode);this._showSwitchableElements(["title","links","subtitle"]);this._updateTitleNodeWidth();this._getTitleContainerWidth(a);this._createIconNodes(a);this._updateTitleNodeWidth();this.morePane&&this.morePane.resize();this.popupLinkNode&&b.setStyle(jimuConfig.layoutId,{left:b.getContentBox(this.popupLinkNode).w+"px"})},_updateTitleNodeWidth:function(){var a=b.getContentBox(this.domNode);
a=this._getHeaderContainerWidth(a)-this._getLogoWidth()-this._getTitlesWidth()-this._getSubtitleWidth()-this._getLinkWidth();a=this._getTitlesWidth()+a+40;"none"===b.getStyle(this.subtitleNode,"display")&&(a+=20,"none"===b.getStyle(this.linksNode,"display")&&(a+=20));150>a?b.setStyle(this.titleNode,"max-width","150px"):b.setStyle(this.titleNode,"max-width",a+"px")},destroy:function(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null);this.morePane&&this.morePane.destroy();
this.moreIconPaneCoverNode&&(b.destroy(this.moreIconPaneCoverNode),this.moreIconPaneCoverNode=null);this.popupLinkNode&&this.popupLinksVisible&&this._hidePopupLink();b.destroy(this.popupLinkNode);this.inherited(arguments)},onAppConfigChanged:function(a,c,d){switch(c){case "attributeChange":this._onAttributeChange(a,d);break;default:return}this.appConfig=a;this.resize()},getOpenedIds:function(){this.inherited(arguments);return""===this.openedId?[]:[this.openedId]},setOpenedIds:function(a){if(0!==a.length){var c=
this.getConfigById(a[0]);c&&(this.openedId&&this._switchNodeToClose(this.openedId),this.openedId=a[0],c.widgets&&"openAll"===c.openType?this._switchNodeToOpen(c.id):c.widgets||(this._getIconNodeById(c.id)?this._switchNodeToOpen(c.id):this._showIconContent(c)))}},_onLogoLoad:function(){this.resize()},_highLight:function(a){this.hlDiv&&this._removeHighLight();if(a){var c=C.getMarginBox(a);this.hlDiv=x.create("div",{style:{position:"absolute",left:c.l+"px",top:c.t+"px",width:c.w+"px",height:c.h+"px"},
"class":"icon-highlight"},a,"before")}},_removeHighLight:function(){this.hlDiv&&(x.destroy(this.hlDiv),this.hlDiv=null)},_onAttributeChange:function(a,c){if("title"in c&&c.title!==this.appConfig.title){var d=v.sanitizeHTML(c.title);this.titleNode.innerHTML=d;this.titleNode.title=d}"subtitle"in c&&c.subtitle!==this.appConfig.subtitle&&(this.subtitleNode.innerHTML=v.sanitizeHTML(c.subtitle));"logo"in c&&c.logo!==this.appConfig.logo&&(c.logo?(b.setAttr(this.logoNode,"src",c.logo),b.removeClass(this.logoNode,
"hide-logo")):(b.removeAttr(this.logoNode,"src"),b.addClass(this.logoNode,"hide-logo")));"links"in c&&this._createDynamicLinks(c.links);this._handleLogoLink(a)},_handleLogoLink:function(a){v.themesHeaderLogoA11y(a,this.tabIndex,{link:this.logoLinkNode,logo:this.logoNode,icon:this.logoNode})},_setElementsSize:function(){b.setStyle(this.logoNode,{height:"30px",marginTop:(this.height-30)/2+"px"});b.setStyle(this.titleNode,{lineHeight:this.height+"px"});b.setStyle(this.subtitleNode,{lineHeight:this.height+
"px"});e(".jimu-link",this.domNode).style({lineHeight:this.height+"px"})},_processGroupSetting:function(){this._setMapCanvasAreaToDefault();A.forEach(this.appConfig.widgetPool.groups,function(a){var c;a:{if(this.config.groupSetting)for(c=0;c<this.config.groupSetting.length;c++)if(this.config.groupSetting[c].label===a.label){c=this.config.groupSetting[c].type;break a}c="openAll"}a.openType=c},this)},_createDynamicLinks:function(a){var c=this.tabIndex+1;b.empty(this.dynamicLinksNode);0>=a.length?(b.setStyle(this.linksNode,
"display","none"),this.switchableElements.hasOwnProperty("links")&&delete this.switchableElements.links):(this.switchableElements.links=this.linksNode,A.forEach(a,function(d){b.create("a",{href:v.dynamicLinkXssFilter(d.url),target:"_blank",innerHTML:v.sanitizeHTML(d.label)+'\x3cdiv class\x3d"screen-readers-only-no-position"\x3e'+window.jimuNls.common.opensInNewWindow+"\x3c/div\x3e","class":"jimu-link jimu-align-leading jimu-leading-margin1",style:{lineHeight:this.height+"px"},tabindex:c++},this.dynamicLinksNode)},
this))},_showSwitchableElements:function(a){var c=this.switchableElements,d;for(d in c)if(c.hasOwnProperty(d))if(-1<a.indexOf(d)){var h=b.hasClass(c[d],"links")?"flex":"block";b.setStyle(c[d],"display",h);c[d].visible=!0}else b.setStyle(c[d],"display","none"),c[d].visible=!1;this.logoClickHandle&&this.logoClickHandle.remove();this.logoKeydownHandle&&this.logoKeydownHandle.remove();0>a.indexOf("links")?(b.setAttr(this.logoLinkNode,"tabIndex",this.tabIndex),this.logoClickHandle=l(this.logoNode,"click",
m.hitch(this,this._onLogoClick)),this.logoKeydownHandle=l(this.logoLinkNode,"keydown",m.hitch(this,this._onLogoKeydown))):(this.popupLinksVisible&&this._hidePopupLink(),this.appConfig.logoLink?b.setStyle(this.logoNode,"cursor","pointer"):b.setStyle(this.logoNode,"cursor","default"))},_switchSignin:function(){var a=w.getPortalCredential(this.appConfig.portalUrl);if(a)this.onSignIn(a);else this.onSignOut()},_onLogoClick:function(){this.popupLinkNode&&b.destroy(this.popupLinkNode);this.popupLinkNode=
this._createPopupLinkNode();this.popupLinksVisible?this._hidePopupLink():this._showPopupLink()},_onLogoKeydown:function(a){a.keyCode===t.ENTER&&this._onLogoClick()},_hidePopupLink:function(){b.setStyle(this.popupLinkNode,"display","none");window.isRTL?b.setStyle(jimuConfig.layoutId,{right:0}):b.setStyle(jimuConfig.layoutId,{left:0});this.popupLinksVisible=!1},_showPopupLink:function(){b.setStyle(this.popupLinkNode,"display","");window.isRTL?b.setStyle(jimuConfig.layoutId,{right:b.getContentBox(this.popupLinkNode).w+
"px"}):b.setStyle(jimuConfig.layoutId,{left:b.getContentBox(this.popupLinkNode).w+"px"});v.isInNavMode()&&(this.appConfig.links?e(".jimu-link a",this.popupLinkNode)[0].focus():e(".jimu-popup-link-close-btn",this.popupLinkNode)[0].focus());this.popupLinksVisible=!0},_createPopupLinkNode:function(){b.getContentBox(jimuConfig.mainPageId);var a=b.create("div",{"class":"popup-links",style:{position:"absolute",zIndex:100,top:0,bottom:0}},jimuConfig.mainPageId);window.isRTL?b.setStyle(a,{right:0,left:"50px"}):
b.setStyle(a,{left:0,right:"50px"});var c=b.create("div",{"class":"popup-title",style:{height:this.height+"px",width:"100%"}},a);var d=b.create("div",{"class":"jimu-float-leading jimu-leading-margin1 jimu-popup-link-close-btn",role:"button",tabindex:"0","aria-label":this.nls.common.close,style:{width:"30px",height:"30px",marginTop:(this.height-30)/2+"px"}},c);this.own(l(d,"click",m.hitch(this,function(){this._hidePopupLink()})));this.own(l(d,"keydown",m.hitch(this,function(p){v.isInNavMode()&&(p.keyCode===
t.ENTER||p.keyCode===t.SPACE||p.keyCode===t.ESCAPE?(this._hidePopupLink(),this.logoLinkNode.focus()):p.keyCode===t.TAB&&!p.shiftKey&&0<this.appConfig.links.length||p.preventDefault())})));this.own(l(a,"keydown",m.hitch(this,function(p){v.isInNavMode()&&p.keyCode===t.ESCAPE&&!b.hasClass(a,"jimu-popup-link-close-btn")&&d.focus()})));b.create("div",{"class":"title jimu-float-leading jimu-leading-margin1",innerHTML:v.sanitizeHTML(this.appConfig.title),style:{lineHeight:this.height+"px"}},c);var h=[];
A.forEach(this.appConfig.links,function(p){p=this._createLinkNode(a,p,!1);h.push(p)},this);h.length&&this.own(l(h[h.length-1],"keydown",m.hitch(this,function(p){v.isInNavMode()&&p.keyCode===t.TAB&&!p.shiftKey&&(p.preventDefault(),e("a",h[0])[0].focus())})));return a},_createLinkNode:function(a,c,d){a=b.place('\x3cdiv class\x3d"jimu-link"\x3e\x3c/div\x3e',a);b.place('\x3cdiv class\x3d"line"\x3e\x3c/div\x3e',a);d=b.place('\x3cdiv class\x3d"'+(d?"link-section signin":"link-section")+'"\x3e\x3c/div\x3e',
a);b.create("a",{href:c.url,tabindex:"0","class":"jimu-ellipsis",target:"_blank",rel:"noopener noreferrer",innerHTML:v.sanitizeHTML(c.label)+'\x3cdiv class\x3d"screen-readers-only-no-position"\x3e'+window.jimuNls.common.opensInNewWindow+"\x3c/div\x3e",title:v.sanitizeHTML(c.label),style:{lineHeight:"66px"}},d);return a},_onSigninClick:function(){w.signInPortal(this.appConfig.portalUrl,this.appConfig.appId)},_onSignoutClick:function(){this.appConfig.mode?new y({message:this.nls.cantSignOutTip}):w.signOutAll()},
_onUserNameClick:function(){},_getHeaderSectionWidth:function(){return b.getMarginBox(this.headerNode).w},_getIconContainerWidth:function(){return b.getMarginBox(this.containerNode).w},_getTitlesWidth:function(){return b.getMarginBox(this.titlesNode).w},_getLinkWidth:function(){return b.getMarginBox(this.linksNode).w},_getLogoWidth:function(){return b.getMarginBox(this.logoNode).w+12},_getSubtitleWidth:function(){return b.getMarginBox(this.subtitleNode).w},_getHeaderContainerWidth:function(a){var c=
this._getIconContainerWidth(),d=this._getLogoWidth();return a.w-c-d},_getTitleContainerWidth:function(a){a=this._getHeaderContainerWidth(a);var c=this._getTitlesWidth(),d=this._getLinkWidth();a<c+d&&(this.switchableElements.hasOwnProperty("links")&&this.switchableElements.links.visible?(this._showSwitchableElements(["title","subtitle"]),c=this._getTitlesWidth(),a<c&&this._showSwitchableElements(["title"])):this._showSwitchableElements(["title"]))},_createIconNodes:function(a,c){var d=this.tabIndex+
20;e(".icon-node",this.containerNode).remove();var h=this.getAllConfigs(),p;this.iconWidth=a.h;this._getTitleContainerWidth(a);var D=360;D=760>=window.innerWidth?90:360;a=[];b.setStyle(this.containerNode,{width:D+"px"});this.maxIconCount=760>=window.innerWidth?2:8;this.maxIconCount>=h.length?(this.headerIconCount=h.length,this.createMoreIcon=!1):(this.headerIconCount=this.maxIconCount-1,this.createMoreIcon=!0);if(this.createMoreIcon){var H=this._createIconNode({label:this.nls.more});a.push(H);if(!this.openAtStartWidget)for(D=
0;D<h.length;D++)h[D].openAtStart&&(p=h[D]);!c&&this.openedId&&this.getConfigById(this.openedId)&&(p=this.getConfigById(this.openedId));p&&this._moveConfigToHeader(p)}var F;for(D=this.headerIconCount-1;0<=D;D--)c=h[D],H=this._createIconNode(c),c.openAtStart&&(F=H),a.push(H);a.reverse().forEach(function(J){d+=200;b.setAttr(J,"tabindex",d);J.config.inPanel||(J.config.tabIndex=d)});F&&!this.openAtStartWidget&&(this.openAtStartWidget=F.config.id,this._onIconClick(F,!0));this.openedId&&this.getConfigById(this.openedId)&&
!1===this.getConfigById(this.openedId).inPanel&&(h=this._getIconNodeById(this.openedId),F=this.widgetManager.getWidgetById(this.openedId),h&&F?this._setOffPanelWidgetPosition(h,F):(this.widgetManager.closeWidget(this.openedId),this.openedId=""))},_createIconNode:function(a){var c=a.label===this.nls.more?this.folderUrl+"images/more_icon.png":a.icon;var d=b.create("div",{"class":"icon-node jimu-float-trailing",title:a.label,"aria-label":a.label,settingId:a.id,role:"button","aria-pressed":this.openedId===
a.id?"true":"false",style:{width:"45px",height:this.height+"px",textAlign:"center"}},this.containerNode);var h=b.create("div",{"class":"widget-symbol-div",style:{width:"100%"}},d);c=b.create("img",{src:c,alt:a.label,style:{marginTop:(this.height-30)/2+3+"px",marginBottom:"3px"}},h);window.isRTL&&a.mirrorIconForRTL&&b.addClass(c,"jimu-flipx");c=b.create("div",{"class":"widget-open-symbol esriCTHidden"},d);a.label===this.nls.more?(this._morePaneNode=d,l(d,"click",m.hitch(this,this._showMorePane,a)),
l(d,"keydown",m.hitch(this,function(p){p.keyCode!==t.ENTER&&p.keyCode!==t.SPACE||this._showMorePane()}))):(l(d,"click",m.hitch(this,function(){this._onIconClick(d)})),l(d,"keydown",m.hitch(this,function(p){p.keyCode!==t.ENTER&&p.keyCode!==t.SPACE||this._onIconClick(d)})),v.addTooltipByDomNode(g,d,a.label));d.config=a;d.config.widgets&&1<d.config.widgets.length&&"dropDown"===d.config.openType&&this._createDropTriangle(d);this.openedId===a.id&&(this._addSelectedStateForIcon(d),e(".widget-open-symbol",
this.domNode).addClass("esriCTHidden"),b.removeClass(c,"esriCTHidden"),d.config.widgets&&1<d.config.widgets.length&&"dropDown"===d.config.openType&&this._openDropMenu(d));return d},_createDropTriangle:function(a){var c=b.getMarginBox(a);b.create("div",{"class":"drop-triangle",style:{left:c.l+c.w/2-4+"px"}},a)},_onIconClick:function(a,c){a.config.widgets&&1!==a.config.widgets.length&&"openAll"!==a.config.openType?this.dropMenuNode?this._closeDropMenu():this._openDropMenu(a,c):this.openedId&&this.openedId===
a.config.id?this._switchNodeToClose(this.openedId):this.openedId?this._switchNodeToClose(this.openedId).then(m.hitch(this,function(){this._closeDropMenu();this._switchNodeToOpen(a.config.id)})):this._switchNodeToOpen(a.config.id)},_closeDropMenu:function(){this.dropMenuNode&&(b.destroy(this.dropMenuNode),this.dropMenuNode=null)},_openDropMenu:function(a,c){this.dropMenuNode=b.create("div",{"class":"jimu-drop-menu jimu-main-background",title:a.config.label,style:{position:"absolute",zIndex:"101"}});
b.place(this.dropMenuNode,this.containerNode);A.forEach(a.config.widgets,function(d){this._createDropMenuItem(d,a)},this);this._setDropMenuPosition(a);this.morePane&&this.morePane.hide();this._initDropMenuEvent(a,c)},_initDropMenuEvent:function(a,c){var d=e(".menu-item",this.dropMenuNode);this.own(l(d,"keydown",m.hitch(this,function(h){if(h.keyCode===t.TAB||h.keyCode===t.ESCAPE)h.stopPropagation(),h.preventDefault(),this._closeDropMenu(),a.focus();else{var p;h.keyCode===t.DOWN_ARROW?p=h.target.nextSibling?
h.target.nextSibling:h.target:h.keyCode===t.UP_ARROW?p=h.target.previousSibling?h.target.previousSibling:h.target:h.keyCode===t.HOME?p=d[0]:h.keyCode===t.END&&(p=d[d.length-1]);p&&p.focus()}})));c||d[0].focus()},_createDropMenuItem:function(a,c){var d=b.create("div",{"class":"menu-item",tabindex:"-1",title:v.sanitizeHTML(a.label),style:{height:this.height+"px"}},this.dropMenuNode);b.create("img",{"class":"jimu-float-leading",src:a.icon},d);b.create("div",{"class":"label jimu-float-leading",innerHTML:v.sanitizeHTML(a.label)},
d);this.own(l(d,"click",m.hitch(this,function(){this._dropMenuItemClick(d)})));this.own(l(d,"keydown",m.hitch(this,function(h){h.keyCode!==t.ENTER&&h.keyCode!==t.SPACE||this._dropMenuItemClick(d)})));d.config=a;d.config.groupNode=c;return d},_dropMenuItemClick:function(a){this._closeDropMenu();this.openedId?this._switchNodeToClose(this.openedId).then(m.hitch(this,function(){this._showIconContent(a.config)})):this._showIconContent(a.config)},_setDropMenuPosition:function(a){var c={};c=b.getMarginBox(this.dropMenuNode);
c=this._getDropdownPosition(a,c);c.zIndex=101;b.setStyle(this.dropMenuNode,v.getPositionStyle(c))},_getDropdownPosition:function(a,c){var d={};a=b.getMarginBox(a);var h=b.getMarginBox(this.domNode);d.top=this.height+1;window.isRTL?d.right=0>a.l+a.w-c.w?0:a.l+a.w-c.w:a.l+c.w>h.w?d.right=0:d.left=a.l;return d},_switchNodeToOpen:function(a){a=this._getIconNodeById(a);this._removeSelectedStateForIcons();e(".widget-open-symbol",this.domNode).addClass("esriCTHidden");this._addSelectedStateForIcon(a);b.removeClass(a.children[1],
"esriCTHidden");this._showIconContent(a.config)},_switchNodeToClose:function(a){this._removeSelectedStateForIcons();this._setMapCanvasAreaToDefault();e(".widget-open-symbol",this.domNode).addClass("esriCTHidden");var c=this.appConfig.getConfigElementById(a);if(c)return!1===c.inPanel?(this.widgetManager.closeWidget(a),this.openedId="",a=new G,a.resolve(),a):this.panelManager.closePanel(a+"_panel");a=new G;a.resolve();return a},_setMapCanvasAreaToDefault:function(){if(window.appInfo.isRunInMobile){var a=
0;e(".jimu-widget-attributetable")[0]&&(a=e(".jimu-widget-attributetable")[0].clientHeight);a?q.publish("changeMapPosition",{bottom:a}):q.publish("changeMapPosition",{bottom:"0px"})}else q.publish("changeMapPosition",{right:"0px"})},_setMapCanvasArea:function(){if(window.appInfo.isRunInMobile){var a=0;e(".jimu-widget-attributetable")[0]&&(a=e(".jimu-widget-attributetable")[0].clientHeight);if(this.panelManager&&this.panelManager.panels&&this.panelManager.panels[0]&&"normal"===this.panelManager.panels[0].windowState){var c=
this.panelManager.getPositionOnMobile(this);a&&a>c.top?q.publish("changeMapPosition",{bottom:a}):q.publish("changeMapPosition",{bottom:c.top})}else 36<a?q.publish("changeMapPosition",{bottom:a}):window.hasOwnProperty("ontouchstart")||void 0!==window.ontouchstart||760>=window.innerWidth?q.publish("changeMapPosition",{bottom:"36px"}):q.publish("changeMapPosition",{bottom:"0px"})}else this.panelManager&&this.panelManager.activePanel&&"minimized"===this.panelManager.activePanel.windowState?q.publish("changeMapPosition",
{right:"0px"}):(q.publish("changeMapPosition",{right:"360px"}),this._resizeAttributeTableinRTL())},_resizeAttributeTableinRTL:function(){e(".jimu-widget-attributetable")[0]&&(window.isRTL?b.setStyle(e(".jimu-widget-attributetable")[0],"right","0px"):b.setStyle(e(".jimu-widget-attributetable")[0],"left","0px"),e(".dijitTabContainer",e(".jimu-widget-attributetable")[0])[0]&&I.byId(e(".dijitTabContainer",e(".jimu-widget-attributetable")[0])[0].id).resize())},_getIconNodeById:function(a){a=e('.icon-node[settingId\x3d"'+
a+'"]',this.domNode);if(0!==a.length)return a[0]},_unSelectIcon:function(a){e('.icon-node[settingId\x3d"'+a+'"]',this.domNode).removeClass("jimu-state-selected");this.openedId=""},_removeSelectedStateForIcons:function(a){a=a||e(".icon-node",this.domNode);A.forEach(a,function(c){b.removeClass(c,"jimu-state-selected");b.setAttr(c,"aria-pressed","false")},this)},_addSelectedStateForIcon:function(a){b.addClass(a,"jimu-state-selected");b.setAttr(a,"aria-pressed","true")},_showIconContent:function(a){var c=
this._getIconNodeById(a.id);!1===a.inPanel?this.widgetManager.loadWidget(a).then(m.hitch(this,function(d){this.openedId=a.id;var h=this._getIconNodeById(a.id);h?(this._removeSelectedStateForIcons(),this._addSelectedStateForIcon(h),b.setStyle(d.domNode,"zIndex",101),this._setOffPanelWidgetPosition(h,d),this.widgetManager.openWidget(d),this.own(n.after(d,"onClose",m.hitch(this,function(){e(".widget-open-symbol",this.domNode).addClass("esriCTHidden");this._setMapCanvasAreaToDefault();this._unSelectIcon(a.id);
this._switchNodeToClose(h.config.id);h.focus()})))):(this.openedId="",this._moveConfigToHeader(a),this._createIconNodes(b.getContentBox(this.domNode),a.id),h=this._getIconNodeById(a.id),h.click())})):(this._setMapCanvasArea(),this.panelManager.showPanel(a).then(m.hitch(this,function(d){this.openedId=a.id;var h=this._getIconNodeById(this.openedId);this._removeSelectedStateForIcons();e(".widget-open-symbol",this.domNode).addClass("esriCTHidden");h&&(this._addSelectedStateForIcon(h),b.removeClass(h.children[1],
"esriCTHidden"));this.own(n.after(d,"onClose",m.hitch(this,function(){a.groupNode?(a.groupNode.focus(),this._setMapCanvasAreaToDefault()):(this._unSelectIcon(a.id),this._setMapCanvasAreaToDefault(),this._switchNodeToClose(a.id))})));this.own(l(d.closeNode,"keydown",m.hitch(this,function(p){p.keyCode!==t.ESCAPE&&p.keyCode!==t.ENTER&&p.keyCode!==t.SPACE||(a.groupNode?a.groupNode:c).focus()})))})))},_setOffPanelWidgetPosition:function(a,c){a=this._getDropdownPosition(a,this.widgetManager.getWidgetMarginBox(c));
c.setPosition(a,this.containerNode)},_showMorePane:function(){var a,c=[],d=this.getAllConfigs();for(a=this.headerIconCount;a<d.length;a++){var h=d[a];h.id!==this.openedId&&c.push(h)}this.morePane&&this.morePane.destroy();this.moreIconPaneCoverNode&&b.destroy(this.moreIconPaneCoverNode);this._closeDropMenu();this.morePane=new E({openedId:this.openedId,items:c,numWidget:d});this._createCoverNode();b.place(this.morePane.domNode,jimuConfig.mapId);this.morePane.startup();n.after(this.morePane,"onNodeClicked",
m.hitch(this,function(p){this._moveConfigToHeader(p.config);this._createIconNodes(b.getContentBox(this.domNode),p.config.id);this._onIconClick(this._getIconNodeById(p.config.id))}),!0);n.after(this.morePane,"hide",m.hitch(this,function(){b.destroy(this.moreIconPaneCoverNode);this._morePaneNode.focus()}),!0)},_moveConfigToHeader:function(a){var c=this.getAllConfigs(),d=a.index;a.index=c[this.headerIconCount-1].index;c[this.headerIconCount-1].index=d},_createCoverNode:function(){this.moreIconPaneCoverNode=
b.create("div",{"class":"jimu-more-icon-cover"},jimuConfig.layoutId)}})});